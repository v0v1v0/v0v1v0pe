<div class="container">

<table style="width: 100%;"><tr>
<td>surrogates_ews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Surrogates Early Warning Signals</h2>

<h3>Description</h3>

<p><code>surrogates_ews</code> is used to estimate distributions of trends in statistical moments from different surrogate timeseries generated after fitting an ARMA(p,q) model on the data. The trends are estimated by the nonparametric Kendall tau correlation coefficient and can be compared to the trends estimated in the original timeseries to produce probabilities of false positives.
</p>


<h3>Usage</h3>

<pre><code class="language-R">surrogates_ews(
  timeseries,
  indicator = c("ar1", "sd", "acf1", "sk", "kurt", "cv", "returnrate", "densratio"),
  winsize = 50,
  detrending = c("no", "gaussian", "loess", "linear", "first-diff"),
  bandwidth = NULL,
  span = NULL,
  degree = NULL,
  boots = 100,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indicator</code></td>
<td>
<p>is the statistic (leading indicator) selected for which the surrogate timeseries are produced. Currently, the indicators supported are: <code>ar1</code> autoregressive coefficient of a first order AR model, <code>sd</code> standard deviation, <code>acf1</code> autocorrelation at first lag, <code>sk</code> skewness, <code>kurt</code> kurtosis, <code>cv</code> coeffcient of variation, <code>returnrate</code>, and <code>densratio</code> density ratio of the power spectrum at low frequencies over high frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winsize</code></td>
<td>
<p>is the size of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default valuise 50%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered prior to analysis. There are three options: <code>gaussian</code> filtering, <code>loess</code> fitting, <code>linear</code> detrending and <code>first-diff</code>erencing. Default is <code>no</code> detrending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>is the bandwidth used for the Gaussian kernel when gaussian filtering is selected. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Alternatively it can be given by the bandwidth selector <code>bw.nrd0</code> (Default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>parameter that controls the degree of smoothing (numeric between 0 and 100, Default 25). see more on loessstats</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of polynomial to be used for when loess fitting is applied, normally 1 or 2 (Default). see more on loessstats</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boots</code></td>
<td>
<p>the number of surrogate data. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In addition, <code>surrogates_ews</code> returns a plot with the distribution of the surrogate Kendall tau estimates and the Kendall tau estimate of the original series. Vertical lines indicate the 5% and 95% significance levels.
</p>


<h3>Value</h3>

<p><code>surrogates_ews</code> returns a matrix that contains:
Kendall tau estimate original the trends of the original timeseries;
Kendall tau p-value original the p-values of the trends of the original timeseries;
Kendall tau estimate surrogates the trends of the surrogate timeseries;
Kendall tau p-value surrogates the associated p-values of the trends of the surrogate timeseries;
significance p the p-value for the original Kendall tau rank correlation estimate compared to the surrogates;
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2008). 'Slowing down as an early warning signal for abrupt climate change.' <em>Proceedings of the National Academy of Sciences</em> 105(38): 14308-14312 
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(foldbif) 
output &lt;- surrogates_ews(foldbif,indicator='sd',winsize=50,detrending='gaussian', bandwidth=10,
             boots=200, logtransform=FALSE,interpolate=FALSE)
</code></pre>


</div>