<div class="container">

<table style="width: 100%;"><tr>
<td>erlevd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Effective Return Levels
</h2>

<h3>Description</h3>

<p>Find the so-called effective return levels for non-stationary extreme value distributions (EVDs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">erlevd(x, period = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A list object of class “fevd”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>

<p>number stating for what return period the effective return levels should be calculated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Return levels are the same as the quantiles for the GEV df.  For the GP
df, they are very similar to the quantiles, but with the event frequency
taken into consideration.  Effective return levels are the return levels
obtained for given parameter/threshold values of a non-stationary model.
For example, suppose the df for data are modeled as a GEV(location(t) =
mu0 + mu1 * t, scale, shape), where ‘t’ is time.  Then for any
specific given time, ‘t’, return levels can be found.  This is
done for each value of the covariate(s) used to fit the model to the
data.  See, for example, Gilleland and Katz (2011) for more details. 
</p>
<p>This function is called by the <code>plot</code> method function for “fevd” objects when the models are non-stationary.
</p>


<h3>Value</h3>

<p>A vector of length equal to the length of the data used to obtain the
fit. When <code>x</code> is from a PP fit with blocks, a vector of length
equal to the number of blocks.
</p>


<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Gilleland, E. and Katz, R. W. (2011). New software to analyze how extremes change over time. <em>Eos</em>, 11 January, <b>92</b>, (2), 13–14.
</p>


<h3>See Also</h3>

<p><code>fevd</code>, <code>rlevd</code>, <code>rextRemes</code>, <code>pextRemes</code>, <code>plot.fevd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(PORTw)

fit &lt;- fevd(TMX1, PORTw, location.fun=~AOindex, units="deg C")
fit
tmp &lt;- erlevd(fit, period=20)

## Not run: 
# Currently, the ci function does not work for effective
# return levels.  There were coding issues encountered.
# But, could try:
#
z &lt;- rextRemes(fit, n=500)
dim(z)
# 500 randomly drawn samples from the
# fitted model.  Each row is a sample
# of data from the fitted model of the
# same length as the data.  Each column
# is a separate sample.

sam &lt;- numeric(0)
for( i in 1:500) {
    cat(i, " ")
    dat &lt;- data.frame(z=z[,i], AOindex=PORTw$AOindex)
    res &lt;- fevd(z, dat, location.fun=~AOindex)
    sam &lt;- cbind(sam, c(erlevd(res)))
}
cat("\n")

dim(sam)

a &lt;- 0.05
res &lt;- apply(sam, 1, quantile, probs=c(a/2, 1 - a/2))
nm &lt;- rownames(res)

res &lt;- cbind(res[1,], tmp, res[2,])
colnames(res) &lt;- c(nm[1], "Estimated 20-year eff. ret. level", nm[2])
res


## End(Not run)
</code></pre>


</div>