<div class="container">

<table style="width: 100%;"><tr>
<td>multinom.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multinomial Goodness-of-Fit Tests</h2>

<h3>Description</h3>

<p>Computes exact p-values for multinomial goodness-of-fit tests based on multiple test statistics, namely, 
Pearson's chi-square, the log-likelihood ratio and the probability mass statistic. 
Implements the algorithm detailed in Resin (2020). 
Estimates based on the classical asymptotic chi-square approximation or Monte-Carlo simulation can also be computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multinom.test(
  x,
  p,
  stat = "Prob",
  method = "exact",
  theta = 1e-04,
  timelimit = 10,
  N = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of non-negative integers - number of times each outcome was observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of positive numbers - the hypothesized probabilities for each outcome. Need not sum to 1, but only encode hypothesized proportions correctly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>Test statistic to be used. Can be "Prob" for the probability mass, "Chisq" for Pearson's chi-square and "LLR" for the log-likelihood ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used to compute the p-values. Can be "exact", "asymptotic" and "Monte-Carlo".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Parameter used with the exact method. p-values less than theta will not be determined precisely. 
Values &gt;= 10^-8 are recommended. Very small p-values (&lt; 10^-8) may be falsified by rounding errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timelimit</code></td>
<td>
<p>Time limit in seconds, after which the exact method is interrupted to avoid long runtime.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of samples generated by the Monte-Carlo approach.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "exact" method implements the algorithm detailed in Resin (2020). The method improves on the full enumeration implemented in some other R packages.
It should work well if the number of categories is small. To avoid long runtimes the exact computation is interrupted after <code>timelimit</code> seconds. 
However, it may take longer than the specified time limit for the actual interrupt to occur. Only p-values greater <code>theta</code> are determined precisely. 
For p-values less than <code>theta</code>, the algorithm will only determine that the p-value is smaller than <code>theta</code>.
</p>
<p>The "asymptotic" method returns classical chi-square approximations. The asymptotic approximation to the probability mass statistic is detailed in Section 2 of Resin (2020).
</p>
<p>The "Monte-Carlo" method returns estimates based on <code>N</code> random draws from the hypothesized distribution.
</p>


<h3>Value</h3>

<p>A list with class "mgof" containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>As input by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>As input by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>As input by user or default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>As input by user or default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>As input by user or default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvals_ex</code></td>
<td>
<p>Exact p-values or NA. WARNING: Values less than theta are NOT exact p-values, but only imply that the actual p-value is less than that value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvals_as</code></td>
<td>
<p>Asymptotic approximation to p-values or NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvals_mc</code></td>
<td>
<p>Monte-Carlo estimated p-values or NA.</p>
</td>
</tr>
</table>
<p>The first p-value (e.g., <code>pvals_ex[1]</code>) is obtained from the probability mass, the second from Pearson's chi-square and the third from the log-likelihood ratio.
</p>


<h3>Note</h3>

<p>Each method computes p-values for all three test statistics simultaneously.
</p>


<h3>References</h3>

<p>Resin, J. (2020), A Simple Algorithm for Exact Multinomial Tests, <em>Preprint</em> <a href="https://arxiv.org/abs/2008.12682">https://arxiv.org/abs/2008.12682</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test fairness of a die (that is, whether each side has the same probability)
p_fair = rep(1/6,6) # Hypothesized probabilities for each side
x = c(16,17,12,15,15,25) # Observed number of times each side appeared on 100 throws
# Exact multinomial test (using probability ordering by default):
multinom.test(x,p_fair)
# Exact multinomial test using log-likelihood ratio:
multinom.test(x,p_fair,stat = "LLR")
# Classical chi-square test (using asymptotics to estimate p-value and Pearson's chi-square):
multinom.test(x,p_fair,stat = "Chisq",method = "asymptotic")
# Using Monte-Carlo approach and probability ordering 
multinom.test(x,p_fair,stat = "Prob",method = "Monte-Carlo")
</code></pre>


</div>