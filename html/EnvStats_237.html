<div class="container">

<table style="width: 100%;"><tr>
<td>evNormOrdStats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Expected Value of Order Statistics for Random Sample from Standard Normal Distribution
</h2>

<h3>Description</h3>

<p>Compute the expected values of order statistics for a random sample from 
a standard normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  evNormOrdStats(n = 1, 
    method = "royston", lower = -9, inc = 0.025, warn = TRUE, 
    alpha = 3/8, nmc = 2000, seed = 47, approximate = NULL)

  evNormOrdStatsScalar(r = 1, n = 1, 
    method = "royston", lower = -9, inc = 0.025, warn = TRUE, 
    alpha = 3/8, nmc = 2000, conf.level = 0.95, seed = 47, approximate = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>positive integer indicating the sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>positive integer between <code>1</code> and <code>n</code> specifying the order statistic 
for which to compute the expected value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string indicating what method to use.  The possible values are:
</p>

<ul>
<li> <p><code>"royston"</code>.  Method based on approximating the exact integral as 
given in Royston (1982).
</p>
</li>
<li> <p><code>"blom"</code>.  Method based on the approximation formula proposed by 
Blom (1958).
</p>
</li>
<li> <p><code>"mc"</code>.  Method based on Monte Carlo simulation.
</p>
</li>
</ul>
<p>See the DETAILS section below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>

<p>numeric scalar <code class="reqn">\le -9</code> defining the lower bound used for approximating the 
integral when <code>method="royston"</code>.  The upper bound is automatically set 
to <code>-lower</code>.  The default value is <code>lower=-9</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc</code></td>
<td>

<p>numeric scalar between <code>.Machine$double.eps</code> and <code>0.025</code> that determines 
the width of each subdivision used to approximate the integral when <br><code>method="royston"</code>.  The default value is <code>inc=0.025</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>

<p>logical scalar indicating whether to issue a warning when 
<code>method="royston"</code> and the sample size is greater than 2000.  
The default value is <code>warn=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric scalar between 0 and 0.5 that determines the constant used when <br><code>method="blom"</code>.  The default value is <code>alpha=3/8</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmc</code></td>
<td>

<p>integer <code class="reqn">\ge 100</code> denoting the number of Monte Carlo simulations to use 
when <code>method="mc"</code>.  The default value is <code>nmc=2000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric scalar between 0 and 1 denoting the confidence level of 
the confidence interval for the expected value of the normal 
order statistic when <code>method="mc"</code>.  
The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>integer between <code class="reqn">-(2^31 - 1)</code> and <code class="reqn">2^31 - 1</code> specifying 
the argument to <code>set.seed</code> (the random number seed) 
when <code>method="mc"</code>.  The default value is <code>seed=47</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approximate</code></td>
<td>

<p>logical scalar included for backwards compatibility with versions of 
<span class="pkg">EnvStats</span> prior to version 2.3.0.  
When <code>method</code> is not supplied and <br><code>approximate=FALSE</code>, <code>method</code> is set to <code>method="royston"</code>.  
When <code>method</code> is not supplied and <code>approximate=TRUE</code>, 
<code>method</code> is set to <code>method="blom"</code>.  
This argument is ignored if <code>method</code> is supplied and/or 
<code>approxmiate=NULL</code> (the default).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\underline{z} = z_1, z_2, \ldots, z_n</code> denote a vector of <code class="reqn">n</code> 
observations from a normal distribution with parameters 
<code>mean=0</code> and <code>sd=1</code>.  That is, <code class="reqn">\underline{z}</code> denotes a vector of 
<code class="reqn">n</code> observations from a <em>standard</em> normal distribution.  Let 
<code class="reqn">z_{(r)}</code> denote the <code class="reqn">r</code>'th order statistic of <code class="reqn">\underline{z}</code>, 
for <code class="reqn">r = 1, 2, \ldots, n</code>.  The probability density function of 
<code class="reqn">z_{(r)}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">f_{r,n}(t) = \frac{n!}{(r-1)!(n-r)!} [\Phi(t)]^{r-1} [1 - \Phi(t)]^{n-r} \phi(t) \;\;\;\;\;\; (1)</code>
</p>

<p>where <code class="reqn">\Phi</code> and <code class="reqn">\phi</code> denote the cumulative distribution function and 
probability density function of the standard normal distribution, respectively 
(Johnson et al., 1994, p.93). Thus, the expected value of <code class="reqn">z_{(r)}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">E(r, n) = E[z_{(r)}] = \int_{-\infty}^{\infty} t f_{r,n}(t) dt \;\;\;\;\;\; (2)</code>
</p>

<p>It can be shown that if <code class="reqn">n</code> is odd, then
</p>
<p style="text-align: center;"><code class="reqn">E[(n+1)/2, n] = 0 \;\;\;\;\;\; (3)</code>
</p>

<p>Also, for all values of <code class="reqn">n</code>,
</p>
<p style="text-align: center;"><code class="reqn">E(r, n) = -E(n-r+1, n) \;\;\;\;\;\; (4)</code>
</p>

<p>The function <code>evNormOrdStatsScalar</code> computes the value of <code class="reqn">E(r,n)</code> for 
user-specified values of <code class="reqn">r</code> and <code class="reqn">n</code>.
</p>
<p>The function <code>evNormOrdStats</code> computes the values of <code class="reqn">E(r,n)</code> for all 
values of <code class="reqn">r</code> (i.e., for <code class="reqn">r = 1, 2, \ldots, n</code>) 
for a user-specified value of <code class="reqn">n</code>.
</p>
<p><b>Exact Method Based on Royston's Approximation to the Integral</b> (<code>method="royston"</code>) 
</p>
<p>When <code>method="royston"</code>, the integral in Equation (2) above is approximated by 
computing the value of the integrand between the values of <code>lower</code> and 
<code>-lower</code> using increments of <code>inc</code>, then summing these values and 
multiplying by <code>inc</code>.  In particular, the integrand is restructured as:
</p>
<p style="text-align: center;"><code class="reqn">t \; f_{r,n}(t) = t \; exp\{log(n!) - log[(r-1)!] - log[(n-r)!] +  (r-1)log[\Phi(t)] + (n-r)log[1 - \Phi(t)] + log[\phi(t)]\} \;\;\; (5)</code>
</p>

<p>By default, as per Royston (1982), the integrand is evaluated between -9 and 9 in 
increments of 0.025.  The approximation is computed this way for values of 
<code class="reqn">r</code> between <code class="reqn">1</code> and <code class="reqn">[n/2]</code>, where <code class="reqn">[x]</code> denotes the floor of <code class="reqn">x</code>.  
If <code class="reqn">r &gt; [n/2]</code>, then the approximation is computed for <code class="reqn">E(n-r+1, n)</code> and 
Equation (4) is used. 
</p>
<p>Note that Equation (1) in Royston (1982) differs from Equations (1) and (2) above 
because Royston's paper is based on the <code class="reqn">r^{th}</code> <em>largest</em> value, 
not the <code class="reqn">r^{th}</code> order statistic. 
</p>
<p>Royston (1982) states that this algorithm “is accurate to at least seven decimal 
places on a 36-bit machine,” that it has been validated up to a sample size 
of <code class="reqn">n=2000</code>, and that the accuracy for <code class="reqn">n &gt; 2000</code> may be improved by 
reducing the value of the argument <code>inc</code>.  Note that making 
<code>inc</code> smaller will increase the computation time.  <br></p>
<p><b>Approxmation Based on Blom's Method</b> (<code>method="blom"</code>) 
</p>
<p>When <code>method="blom"</code>, the following approximation to <code class="reqn">E(r,n)</code>, 
proposed by Blom (1958, pp. 68-75), is used:
</p>
<p style="text-align: center;"><code class="reqn">E(r, n) \approx \Phi^{-1}(\frac{r - \alpha}{n - 2\alpha + 1}) \;\;\;\;\;\; (5)</code>
</p>

<p>By default, <code class="reqn">\alpha = 3/8 = 0.375</code>.  This approximation is quite accurate.  
For example, for <code class="reqn">n \ge 2</code>, the approximation is accurate to the first decimal place, 
and for <code class="reqn">n \ge 9</code> it is accurate to the second decimal place.
</p>
<p>Harter (1961) discusses appropriate values of <code class="reqn">\alpha</code> for various sample sizes 
<code class="reqn">n</code> and values of <code class="reqn">r</code>. <br></p>
<p><b>Approximation Based on Monte Carlo Simulation</b> (<code>method="mc"</code>) 
</p>
<p>When <code>method="mc"</code>, Monte Carlo simulation is used to estmate the expected value 
of the <code class="reqn">r^{th}</code> order statistic.  That is, <code class="reqn">N =</code> <code>nmc</code> trials are run in which, 
for each trial, a random sample of <code class="reqn">n</code> standard normal observations is 
generated and the <code class="reqn">r^{th}</code> order statistic is computed.  Then, the average value 
of this order statistic over all <code class="reqn">N</code> trials is computed, along with a  
confidence interval for the expected value, assuming an approximately 
normal distribution for the mean of the order statistic (the confidence interval 
is computed by supplying the simulated values of the <code class="reqn">r^{th}</code> order statistic 
to the function <code>enorm</code>).
</p>
<p><b>NOTE:</b> This method has not been optimized for large sample sizes <code class="reqn">n</code> 
(i.e., large values of the argument <code>n</code>) and/or a large number of 
Monte Carlo trials <code class="reqn">N</code> (i.e., large values of the argument <code>nmc</code>) and 
may take a long time to execute in these cases.
</p>


<h3>Value</h3>

<p>For <code>evNormOrdStats</code>: a numeric vector of length <code>n</code> containing the 
expected values of all the order statistics for a random sample of <code>n</code> 
standard normal deviates.
</p>
<p>For <code>evNormOrdStatsScalar</code>: a numeric scalar containing the expected value 
of the <code>r</code>'th order statistic from a random sample of <code>n</code> standard 
normal deviates.  When <code>method="mc"</code>, the returned object also has a 
<code>cont.int</code> attribute that contains the 95
and a <code>nmc</code> attribute indicating the number of Monte Carlo trials run.  
</p>


<h3>Note</h3>

<p>The expected values of normal order statistics are used to construct normal 
quantile-quantile (Q-Q) plots (see <code>qqPlot</code>) and to compute 
goodness-of-fit statistics (see <code>gofTest</code>).  Usually, however, 
approximations are used instead of exact values.  The functions 
<code>evNormOrdStats</code> and <br><code>evNormOrdStatsScalar</code> have been included mainly 
because <code>evNormOrdStatsScalar</code> is called by <code>elnorm3</code> and 
<code>predIntNparSimultaneousTestPower</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Blom, G. (1958). <em>Statistical Estimates and Transformed Beta Variables</em>. 
John Wiley and Sons, New York.
</p>
<p>Harter, H. L. (1961). <em>Expected Values of Normal Order Statistics</em> 
<b>48</b>, 151–165.
</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994). 
<em>Continuous Univariate Distributions, Volume 1</em>. 
Second Edition. John Wiley and Sons, New York, pp. 93–99.
</p>
<p>Royston, J.P. (1982).  Algorithm AS 177.  Expected Normal Order Statistics 
(Exact and Approximate).  <em>Applied Statistics</em> <b>31</b>, 161–165.
</p>


<h3>See Also</h3>

<p>Normal, <code>ppoints</code>, <code>elnorm3</code>, 
<code>predIntNparSimultaneousTestPower</code>, <code>gofTest</code>, 
<code>qqPlot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Compute the expected value of the minimum for a random sample of size 10 
  # from a standard normal distribution:

  # Based on method="royston"
  #--------------------------
  evNormOrdStatsScalar(r = 1, n = 10) 
  #[1] -1.538753


  # Based on method="blom"
  #-----------------------
  evNormOrdStatsScalar(r = 1, n = 10, method = "blom") 
  #[1] -1.546635


  # Based on method="mc" with 10,000 Monte Carlo trials
  #----------------------------------------------------
  evNormOrdStatsScalar(r = 1, n = 10, method = "mc", nmc = 10000) 
  #[1] -1.544318
  #attr(,"confint")
  #   95%LCL    95%UCL 
  #-1.555838 -1.532797 
  #attr(,"nmc")
  #[1] 10000

  #====================

  # Compute the expected values of all of the order statistics 
  # for a random sample of size 10 from a standard normal distribution
  # based on Royston's (1982) method:
  #--------------------------------------------------------------------

  evNormOrdStats(10) 
  #[1] -1.5387527 -1.0013570 -0.6560591 -0.3757647 -0.1226678
  #[6]  0.1226678  0.3757647  0.6560591  1.0013570  1.5387527


  # Compare the above with Blom (1958) scores:
  #-------------------------------------------

  evNormOrdStats(10, method = "blom") 
  #[1] -1.5466353 -1.0004905 -0.6554235 -0.3754618 -0.1225808
  #[6]  0.1225808  0.3754618  0.6554235  1.0004905  1.5466353
</code></pre>


</div>