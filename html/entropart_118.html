<div class="container">

<table style="width: 100%;"><tr>
<td>DivEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diversity Estimation of a metacommunity
</h2>

<h3>Description</h3>

<p>Estimates diversity of a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DivEst(q = 0, MC, Biased = TRUE, Correction = "Best", Tree = NULL, 
  Normalize = TRUE, Z = NULL, Simulations = 100, 
  ShowProgressBar = TRUE, CheckArguments = TRUE)
is.DivEst(x)
## S3 method for class 'DivEst'
plot(x, ..., main = NULL, Which = "All",
  Quantiles = c(0.025, 0.975), colValue = "red", lwdValue = 2, ltyValue = 2,
  colQuantiles = "black", lwdQuantiles = 1, ltyQuantiles = 2)
## S3 method for class 'DivEst'
autoplot(object, ..., main = NULL, Which = "All",
  labels = NULL, font.label = list(size=11, face="plain"),
          Quantiles = c(0.025, 0.975), colValue = "red", 
          colQuantiles = "black", ltyQuantiles = 2)
## S3 method for class 'DivEst'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A number: the order of diversity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>

<p>A <code>MetaCommunity</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Biased</code></td>
<td>

<p>Logical; if <code>FALSE</code>, a bias correction is appplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correction</code></td>
<td>

<p>A string containing one of the possible corrections. The correction must be accepted by <code>DivPart</code>. <code>"Best"</code> is the default value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tree</code></td>
<td>

<p>An object of class <code>hclust</code>, "phylo" (see <code>read.tree</code>), <code>phylog</code> or <code>PPtree</code>. The tree must be ultrametric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree..<br>
If <code>FALSE</code>, diversity is proportional to the height of the tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Simulations</code></td>
<td>

<p>The number of simulations to build confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object to be tested or plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>The title of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Which</code></td>
<td>

<p>May be <code>"Alpha"</code>, <code>"Beta"</code> or <code>"Gamma"</code> to respectively plot the metacommunity's alpha, beta or gamma diversity. If <code>"All"</code> (default), all three plots are shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>Vector of labels to be added to multiple plots. <code>"auto"</code> is the same as <code>c("a", "b", "c", "d)"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.label</code></td>
<td>

<p>A list of arguments to customize labels. See <code>ggarrange</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>MCdiversity</code> object to be summarized or plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Quantiles</code></td>
<td>

<p>A vector containing the quantiles of interest.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colValue</code></td>
<td>

<p>The color of the line representing the real value on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwdValue</code></td>
<td>

<p>The width of the line representing the real value on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltyValue</code></td>
<td>

<p>The line type of the line representing the real value on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colQuantiles</code></td>
<td>

<p>The color of the lines representing the quantiles on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwdQuantiles</code></td>
<td>

<p>The width of the lines representing the quantiles on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltyQuantiles</code></td>
<td>

<p>The line type of the lines representing the quantiles on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>Divest</code> estimates the diversity of the metacommunity and partitions it into alpha and beta components.
</p>
<p>If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p>Bootstrap confidence intervals are calculated by drawing simulated communities from a multinomial distribution following the observed frequencies (Marcon et al, 2012; 2014).
</p>


<h3>Value</h3>

<p>A <code>Divest</code> object which is a <code>DivPart</code> object with an additional item in its list:
</p>
<table><tr style="vertical-align: top;">
<td><code>SimulatedDiversity</code></td>
<td>
<p>A matrix containing the simulated values of alpha, beta and gamma diversity.</p>
</td>
</tr></table>
<p><code>Divest</code> objects can be summarized and plotted.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannon's Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>


<h3>See Also</h3>

<p><code>DivPart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon diversity.
Estimation &lt;- DivEst(q = 1, Paracou618.MC, Biased = FALSE, Correction = "UnveilJ", 
Simulations = 20)
plot(Estimation)
summary(Estimation)
</code></pre>


</div>