<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc.diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct MCMC diagnostics on a model fit</h2>

<h3>Description</h3>

<p>This function prints diagnistic information and creates simple diagnostic
plots for MCMC sampled statistics produced from a fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc.diagnostics(object, ...)

## S3 method for class 'ergm'
mcmc.diagnostics(
  object,
  center = TRUE,
  esteq = TRUE,
  vars.per.page = 3,
  which = c("plots", "texts", "summary", "autocorrelation", "crosscorrelation", "burnin"),
  compact = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A model fit object to be diagnosed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments, to be passed to plotting functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Logical: If <code>TRUE</code>, center the samples on the observed
statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esteq</code></td>
<td>
<p>Logical: If <code>TRUE</code>, for statistics corresponding to
curved ERGM terms, summarize the curved statistics by their
negated estimating function values (evaluated at the MLE of any curved
parameters) (i.e., <code class="reqn">\eta'_{I}(\hat{\theta})\cdot (g_{I}(Y)-g_{I}(y))</code>
for <code class="reqn">I</code> being indices of the canonical parameters in
question), rather than the canonical (sufficient) vectors of the
curved statistics relative to the observed (<code class="reqn">g_{I}(Y)-g_{I}(y)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars.per.page</code></td>
<td>
<p>Number of rows (one variable per row) per
plotting page.  Ignored if <a href="https://CRAN.R-project.org/package=latticeExtra"><span class="pkg">latticeExtra</span></a> package is not
installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>A character vector specifying which diagnostics to
plot and/or print. Defaults to all of the below if meaningful:
</p>

<dl>
<dt><code>"plots"</code></dt>
<dd>
<p>Traceplots and density plots of sample values for all statistic or estimating function elements.</p>
</dd>
<dt><code>"texts"</code></dt>
<dd>
<p>Shorthand for the following text diagnostics.</p>
</dd>
<dt><code>"summary"</code></dt>
<dd>
<p>Summary of network statistic or estimating function elements as produced by <code>coda::summary.mcmc.list()</code>.</p>
</dd>
<dt><code>"autocorrelation"</code></dt>
<dd>
<p>Autocorrelation of each of the network statistic or estimating function elements.</p>
</dd>
<dt><code>"crosscorrelation"</code></dt>
<dd>
<p>Cross-correlations between each pair of the network statistic or estimating function elements.</p>
</dd>
<dt><code>"burnin"</code></dt>
<dd>
<p>Burn-in diagnostics, in particular, the Geweke test.</p>
</dd>
</dl>
<p> Partial matching is supported. (E.g., <code>which=c("auto","cross")</code>
will print autocorrelation and cross-correlations.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compact</code></td>
<td>
<p>Numeric: For diagnostics that print variables in
columns (e.g. correlations, hypothesis test p-values), try to
abbreviate variable names to this many characters and round the
numbers to <code>compact - 2</code> digits after the decimal point; 0 or
<code>FALSE</code> for no abbreviation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A pair of plots are produced for each statistic:a trace of the sampled
output statistic values on the left and density estimate for each variable
in the MCMC chain on the right.  Diagnostics printed to the console include
correlations and convergence diagnostics.
</p>
<p>For <code>ergm()</code> specifically, recent changes in the
estimation algorithm mean that these plots can no longer be used
to ensure that the mean statistics from the model match the
observed network statistics. For that functionality, please use
the GOF command: <code>gof(object, GOF=~model)</code>.
</p>
<p>In fact, an <code>ergm()</code> output object contains the sample of
statistics from the last MCMC run as element <code style="white-space: pre;">⁠$sample⁠</code>. If
missing data MLE is fit, the corresponding element is named
<code style="white-space: pre;">⁠$sample.obs⁠</code>. These are objects of <code>mcmc</code> and can be used
directly in the <a href="https://CRAN.R-project.org/package=coda"><span class="pkg">coda</span></a> package to assess MCMC
convergence.
</p>
<p>More information can be found by looking at the documentation of
<code>ergm()</code>.
</p>


<h3>Methods (by class)</h3>


<ul><li> <p><code>mcmc.diagnostics(ergm)</code>: 
</p>
</li></ul>
<h3>References</h3>

<p>Raftery, A.E. and Lewis, S.M. (1995).  The number of iterations, convergence
diagnostics and generic Metropolis algorithms.  In Practical Markov Chain
Monte Carlo (W.R. Gilks, D.J. Spiegelhalter and S. Richardson, eds.).
London, U.K.: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>ergm()</code>, <a href="https://CRAN.R-project.org/package=network"><span class="pkg">network</span></a> package, <a href="https://CRAN.R-project.org/package=coda"><span class="pkg">coda</span></a> package,
<code>summary.ergm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
#
data(florentine)
#
# test the mcmc.diagnostics function
#
gest &lt;- ergm(flomarriage ~ edges + kstar(2))
summary(gest)

#
# Plot the probabilities first
#
mcmc.diagnostics(gest)
#
# Use coda directly
#
library(coda)
#
plot(gest$sample, ask=FALSE)
#
# A full range of diagnostics is available
# using codamenu()
#

## End(Not run)

</code></pre>


</div>