<div class="container">

<table style="width: 100%;"><tr>
<td>spect_em_lmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectrum adapted ECM algorithm by LMM</h2>

<h3>Description</h3>

<p>Perform a peak fitting based on the spectrum adapted ECM algorithm by Lorentz mixture model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spect_em_lmm(x, y, mu, gam, mix_ratio, conv.cri, maxit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>measurement steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>intensity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>mean of the components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>scale parameter of the components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_ratio</code></td>
<td>
<p>mixture ratio of the components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv.cri</code></td>
<td>
<p>criterion of the convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of the iteration</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Peak fitting is conducted by spectrum adapted ECM algorithm.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>estimated mean of the components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>estimated scale parameter of the components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_ratio</code></td>
<td>
<p>estimated mixture ratio of the components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>number of the iteration to reach the convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LL</code></td>
<td>
<p>variation of the weighted log likelihood values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MU</code></td>
<td>
<p>variation of mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GAM</code></td>
<td>
<p>variation of gam</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIX_RATIO</code></td>
<td>
<p>variation of mix_ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W_K</code></td>
<td>
<p>decomposed component of the spectral data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>message for the convergence in the calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cal_time</code></td>
<td>
<p>calculation time to complete the peak fitting. Unit is seconds</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending highâ€“throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generating the synthetic spectral data based on three component Lorentz mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_gam        &lt;- c(3, 3, 3)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#Normalized Lorentz distribution
dCauchy &lt;- function(x, mu, gam) {
    (dcauchy(x, mu, gam)) / sum(dcauchy(x, mu, gam))
  }

y &lt;- c(true_mix_ratio[1] * dCauchy(x = x, mu = true_mu[1], gam = true_gam[1])*10^degree +
       true_mix_ratio[2] * dCauchy(x = x, mu = true_mu[2], gam = true_gam[2])*10^degree +
       true_mix_ratio[3] * dCauchy(x = x, mu = true_mu[3], gam = true_gam[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
gam_init        &lt;- c(2, 5, 4)

#Coducting calculation
SP_ECM_L_res &lt;- spect_em_lmm(x, y, mu = mu_init, gam = gam_init, mix_ratio = mix_ratio_init,
                             conv.cri = 1e-2, maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_lmm_curve(SP_ECM_L_res, x, y, mix_ratio_init, mu_init, gam_init)

#Showing the result of spect_em_lmm()
print(cbind(c(mu_init), c(gam_init), c(mix_ratio_init)))
print(cbind(SP_ECM_L_res$mu, SP_ECM_L_res$gam, SP_ECM_L_res$mix_ratio))
print(cbind(true_mu, true_gam, true_mix_ratio))

</code></pre>


</div>