<div class="container">

<table style="width: 100%;"><tr>
<td>rho_sampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R6 class for sampling the spatial autoregressive parameter <code class="reqn">\rho</code>
</h2>

<h3>Description</h3>

<p>An R6 class for sampling the spatial autoregressive parameter <code class="reqn">\rho</code>
</p>
<p>An R6 class for sampling the spatial autoregressive parameter <code class="reqn">\rho</code>
</p>


<h3>Format</h3>

<p>An <code>R6Class</code> generator object
</p>


<h3>Details</h3>

<p>This class samples the spatial autoregressive parameter using either a tuned random-walk
Metropolis-Hastings or a griddy Gibbs step. Use the <code>rho_priors</code> class for setup.
</p>
<p>For the Griddy-Gibbs algorithm see Ritter and Tanner (1992).
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>rho_prior</code></dt>
<dd>
<p>The current <code>rho_priors</code></p>
</dd>
<dt><code>curr_rho</code></dt>
<dd>
<p>The current value of <code class="reqn">\rho</code></p>
</dd>
<dt><code>curr_W</code></dt>
<dd>
<p>The current spatial weight matrix <code class="reqn">W</code>; an <code class="reqn">n</code> by <code class="reqn">n</code> matrix.</p>
</dd>
<dt><code>curr_A</code></dt>
<dd>
<p>The current spatial filter matrix <code class="reqn">I - \rho W</code>.</p>
</dd>
<dt><code>curr_AI</code></dt>
<dd>
<p>The inverse of <code>curr_A</code></p>
</dd>
<dt><code>curr_logdet</code></dt>
<dd>
<p>The current log-determinant of <code>curr_A</code></p>
</dd>
<dt><code>curr_logdets</code></dt>
<dd>
<p>A set of log-determinants for various values of <code class="reqn">\rho</code>. See the
<code>rho_priors</code> function for settings of step site and other parameters of the grid.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-rho_sampler-new"><code>rho_sampler$new()</code></a>
</p>
</li>
<li> <p><a href="#method-rho_sampler-stopMHtune"><code>rho_sampler$stopMHtune()</code></a>
</p>
</li>
<li> <p><a href="#method-rho_sampler-setW"><code>rho_sampler$setW()</code></a>
</p>
</li>
<li> <p><a href="#method-rho_sampler-sample"><code>rho_sampler$sample()</code></a>
</p>
</li>
<li> <p><a href="#method-rho_sampler-sample_Griddy"><code>rho_sampler$sample_Griddy()</code></a>
</p>
</li>
<li> <p><a href="#method-rho_sampler-sample_MH"><code>rho_sampler$sample_MH()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-rho_sampler-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>rho_sampler$new(rho_prior, W = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>rho_prior</code></dt>
<dd>
<p>The list returned by <code>rho_priors</code></p>
</dd>
<dt><code>W</code></dt>
<dd>
<p>An optional starting value for the spatial weight matrix <code class="reqn">W</code></p>
</dd>
</dl>
</div>


<hr>
<a id="method-rho_sampler-stopMHtune"></a>



<h4>Method <code>stopMHtune()</code>
</h4>

<p>Function to stop the tuning of the Metropolis-Hastings step. The tuning of the
Metropolis-Hastings step is usually carried out until half of the burn-in phase.
Call this function to turn it off.
</p>


<h5>Usage</h5>

<div class="r"><pre>rho_sampler$stopMHtune()</pre></div>


<hr>
<a id="method-rho_sampler-setW"></a>



<h4>Method <code>setW()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>rho_sampler$setW(newW, newLogdet = NULL, newA = NULL, newAI = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>newW</code></dt>
<dd>
<p>The updated spatial weight matrix <code class="reqn">W</code>.</p>
</dd>
<dt><code>newLogdet</code></dt>
<dd>
<p>An optional value for the log determinant corresponding to <code>newW</code> and <code>curr_rho</code>.</p>
</dd>
<dt><code>newA</code></dt>
<dd>
<p>An optional value for the spatial projection matrix using <code>newW</code> and <code>curr_rho</code>.</p>
</dd>
<dt><code>newAI</code></dt>
<dd>
<p>An optional value for the matrix inverse of <code>newA</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-rho_sampler-sample"></a>



<h4>Method <code>sample()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>rho_sampler$sample(Y, mu, sigma)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Y</code></dt>
<dd>
<p>The <code class="reqn">n</code> by <code class="reqn">T</code> matrix of responses.</p>
</dd>
<dt><code>mu</code></dt>
<dd>
<p>The <code class="reqn">n</code> by <code class="reqn">T</code> matrix of means.</p>
</dd>
<dt><code>sigma</code></dt>
<dd>
<p>The variance parameter <code class="reqn">\sigma^2</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-rho_sampler-sample_Griddy"></a>



<h4>Method <code>sample_Griddy()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>rho_sampler$sample_Griddy(Y, mu, sigma)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Y</code></dt>
<dd>
<p>The <code class="reqn">n</code> by <code class="reqn">T</code> matrix of responses.</p>
</dd>
<dt><code>mu</code></dt>
<dd>
<p>The <code class="reqn">n</code> by <code class="reqn">T</code> matrix of means.</p>
</dd>
<dt><code>sigma</code></dt>
<dd>
<p>The variance parameter <code class="reqn">\sigma^2</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-rho_sampler-sample_MH"></a>



<h4>Method <code>sample_MH()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>rho_sampler$sample_MH(Y, mu, sigma)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Y</code></dt>
<dd>
<p>The <code class="reqn">n</code> by <code class="reqn">T</code> matrix of responses.</p>
</dd>
<dt><code>mu</code></dt>
<dd>
<p>The <code class="reqn">n</code> by <code class="reqn">T</code> matrix of means.</p>
</dd>
<dt><code>sigma</code></dt>
<dd>
<p>The variance parameter <code class="reqn">\sigma^2</code>.</p>
</dd>
</dl>
</div>




<h3>References</h3>

<p>Ritter, C., and Tanner, M. A. (1992). Facilitating the Gibbs sampler: The Gibbs stopper
and the griddy-Gibbs sampler. <em>Journal of the American Statistical Association</em>,
<b>87(419)</b>, 861-868.
</p>


</div>