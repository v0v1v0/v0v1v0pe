<div class="container">

<table style="width: 100%;"><tr>
<td>lms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wrapper around lm for sibling design</h2>

<h3>Description</h3>

<p>Fits a linear model using demeaned data. Useful for sibling design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lms(formula, data, grp_id, obs_id = NULL, ...)

## S3 method for class 'lms'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula, used to create a model matrix with demeaned columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame, data frame extension (e.g. a tibble), or a lazy
data frame (e.g. from dbplyr or dtplyr).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp_id</code></td>
<td>
<p>&lt;<code>data-masking</code>&gt; One unquoted expression
naming the id variable in data defining the groups to demean,
e.g. sibling groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_id</code></td>
<td>
<p>&lt;<code>data-masking</code>&gt; Optional, One unquoted
expression naming an id variable to keep track of the input data order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to lm(). In print,
additional arguments are ignored without warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An S3 object with class lms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of significant digits to be passed to
format(coef(x), .) when print()ing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lms</code> estimates parameters in the linear model
</p>
<p style="text-align: center;"><code class="reqn">y_{ij_i}=\alpha_i+x_{ij_i}^T\beta + \varepsilon_{ij_i}</code>
</p>

<p>where <code class="reqn">\alpha_i</code> is a group (e.g. sibling group)
specific intercept and <code class="reqn">x_{ij_i}</code> are covariate values for
observation <code class="reqn">j_i</code> in group i.
<code class="reqn">\varepsilon_{ij_i}\sim N(0, \sigma^2)</code>
is a normally distributed error term. It is assumed that interest is in
estimating the vector <code class="reqn">\beta</code> while <code class="reqn">\alpha_{i}</code>
are nuisance parameters. Estimation of <code class="reqn">\beta</code> uses the mean deviation
method, where
</p>
<p style="text-align: center;"><code class="reqn">y_{ij_i}^{'}=y_{ij_i}-y_i</code>
</p>

<p>is regressed on
</p>
<p style="text-align: center;"><code class="reqn">x_{ij_i}^{'}=x_{ij_i}-x_i.</code>
</p>

<p>Here <code class="reqn">y_i</code> and <code class="reqn">x_i</code> refers to the mean of y and x in group i.
<br><code>lms</code> can keep track of observations by providing a unique identifier
column to <code>obs_id</code>. <code>lms</code> will return <code>obs_id</code> so it matches the order of
observations in model.<br><code>lms</code> only supports syntactic covariate names. Using a non-syntactic name
risks returning an error, e.g if names end in + or -.
</p>


<h3>Value</h3>

<p>A list with class <code>c("lms", "lm")</code>. Contains the output from <code>lm</code> applied
to demeaned data according to <code>formula</code>, as well as the original data and the
provided formula.
</p>


<h3>Author(s)</h3>

<p>KIJA
</p>


<h3>Examples</h3>

<pre><code class="language-R">
sib_id &lt;- sample(200, 1000, replace = TRUE)
sib_out &lt;- rnorm(200)
x1 &lt;- rnorm(1000)
x2 &lt;- rnorm(1000) + sib_out[sib_id] + x1
y &lt;- rnorm(1000, 1, 0.5) + 2 * sib_out[sib_id] - x1 + 2 * x2
data &lt;- data.frame(
  x1 = x1,
  x2 = x2,
  y = y,
  sib_id = sib_id,
  obs_id = 1:1000
)
mod_lm &lt;- lm(y ~ x1 + x2, data) # OLS model
mod_lm_grp &lt;- lm(y ~ x1 + x2 + factor(sib_id), data) # OLS with grp
mod_lms &lt;- lms(y ~ x1 + x2, data, sib_id, obs_id) # conditional model
summary(mod_lm)
coef(mod_lm_grp)[1:3]
summary(mod_lms)
print(mod_lms)

</code></pre>


</div>