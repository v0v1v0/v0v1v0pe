<div class="container">

<table style="width: 100%;"><tr>
<td>RankRegTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test the AFT model Rank Regression estimator by Empirical Likelihood</h2>

<h3>Description</h3>

<p>Use the empirical likelihood ratio and Wilks theorem to test if the
regression coefficient is equal to beta, based on the rank estimator
for the AFT model.
</p>
<p>The log empirical likelihood been maximized is
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{d=1} \log \Delta F(e_i) + \sum_{d=0} \log [1-F(e_i)];</code>
</p>

<p>where <code class="reqn">e_i</code> are the residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RankRegTest(y, d, x, beta, type="Gehan")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of length N, containing the censored responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a vector (length N) of either 1's or 0's. 
d=1 means y is uncensored;
d=0 means y is right censored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of size N by q. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a vector of length q. the value of the regression 
coefficient to be tested in the model 
<code class="reqn">y_i = \beta x_i  + \epsilon_i</code> </p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>default to Gehan type. 
The other option is Logrank type.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The estimator of beta can be obtained by function 
<code>rankaft( )</code>
in the package <code>rankreg</code>. But here you may test other values of 
beta. If you test the beta value that is obtained from the <code>rankaft( )</code>,
then the -2LLR should be 0 and the p-value should be 1.
</p>
<p>The above likelihood should be understood as the likelihood of the 
error term, so in the regression model the error <code class="reqn">e_i</code> should be iid.
</p>
<p>The estimation equation used when maximize the 
empirical likelihood is 
</p>
<p style="text-align: center;"><code class="reqn"> 0 = \sum_i \phi (e_i)  d_i \Delta F(e_i) (x_i - \bar x_i  )/(n w_i) </code>
</p>

<p>which was described in detail in the references below.
</p>
<p>See also the function <code>RankRegTestH</code>, which is based on the hazard likelihood.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"-2LLR"</code></td>
<td>
<p>the -2 loglikelihood ratio; should have approximate chisq 
distribution under <code class="reqn">H_o</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logel2</code></td>
<td>
<p>the log empirical likelihood, under estimating equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logel</code></td>
<td>
<p>the log empirical likelihood of the Kaplan-Meier of e's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the probabilities that max the empirical likelihood 
under rank estimating equation constraint.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou. </p>


<h3>References</h3>

<p>Kalbfleisch, J. and Prentice, R. (2002)
The Statistical Analysis of Failure Time Data. 2nd Ed.
Wiley, New York.  (Chapter 7)
</p>
<p>Jin, Z., Lin, D.Y., Wei, L. J. and Ying, Z. (2003).
Rank-based inference for the accelerated failure time model.
Biometrika, <b>90</b>, 341-53.
</p>
<p>Zhou, M. (2005). Empirical likelihood analysis of the rank
estimator for the censored accelerated failure time model. 
Biometrika, <b>92</b>, 492-98.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(myeloma)
RankRegTest(y=myeloma[,1], d=myeloma[,2], x=myeloma[,3], beta= -15.50147)
# you should get "-2LLR" = 9.050426e-05 (practically zero)
# The beta value, -15.50147, was obtained by rankaft() from the rankreg package.
</code></pre>


</div>