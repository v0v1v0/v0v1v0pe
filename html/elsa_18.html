<div class="container">

<table style="width: 100%;"><tr>
<td>elsa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Entropy-based Local indicator of Spatial Association</h2>

<h3>Description</h3>

<p>Calculate ELSA statistic for a categorical or continuous spatial dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">elsa(x,d,nc,categorical,dif,classes,stat,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> numeric local distance, or an object of class neighbours created by dneigh when x is SpatialPoints or SpatialPolygons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p> optional, for continuous data it specifies the number of classes through categorizing the variable. If missing, it is automatically calculated (recommended)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p> logical, specified whether x is a continuous or categorical. If missed the function tries to detect it</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dif</code></td>
<td>
<p>the difference between categories, only for categorical </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p>Optional, only when <code>x</code> is categorical is a character vector contains classes; would be useful when the dataset is part of a bigger dataset or when it does not contain all the categories, then by specifying the full set of categories, they will be taken into account to calculate ELSA, and therefore, it would be comparable with the other dataset with the same list of classes (these classes may alternatively introduce by <code>dif</code>, as the classes considered to specify dissimilarities in <code>dif</code> list, would be used as <code>classes</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>specifies which statistic should be calculated by the function; it can be "elsa" (default), or either of the two components of the statistic, "Ea", or "Ec"; ELSA is the product of Ea and Ec. (it is possible to select more than one statistic); this argument is ignored if <code>x</code> is <code>Spatial*</code> object as all the three statistics are returned (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments including: 
</p>
<p><code>cells</code> - a numeric vector to specify for which raster cells the ELSA statistic should be calculated; it works when <code>x</code> is <code>RasterLayer</code>, and if it is specified, ELSA is calculated only for the specified cells;
</p>
<p><code>filename</code> - only if <code>x</code> is <code>RasterLayer</code>, specifies the name of the raster file to be written in the working directory.
</p>
<p><code>zcol</code> - only if <code>x</code> is <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>, specifies the name of the column (variable) in the attribute table for which the elsa statistics are calcualted (i.e., ELSA, Ea, Ec).
</p>
<p><code>drop</code> - logical; only if <code>x</code> is <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>, specifies whether the output should be a data.frame or a <code>Spatial*</code> object.
</p>
<p><code>method</code> - only if <code>SpatialPolygonsDataFrame</code>, specifies the method for identifying the neighbourhood polygons; default: 'centroid' (see <code>dneigh</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>dif can be used when categorical values are sorted into hierarchical system (e.g., CORINE land cover). This make it possible to difine different weights of similarity between each pairs of categories when the level of similarity is not the same between different classes in the variable. For example, two categories belong to two forest types are more similar than two categories, one a forest type and the other one an agriculture type. So, it can take this differences into account when the spatial autocorrelation for categorical variables is quantified.
</p>
<p>the ELSA statistics has two terms, "Ea" and "Ec", in the reference. It can be specified in the <code>stat</code> argument if either of these terms should be returned from the function or ELSA ("E"), which is the product of these two terms, <code>Ea * Ec</code>. All three terms can also be selected.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Raster*</code></td>
<td>
<p>if <code>x</code> is a <code>RasterLayer</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spatial* or data.frame</code></td>
<td>
<p>if <code>x</code> is a <code>Spatial*</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class="language-R">file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)

plot(r, main='a continuous raster map')

e &lt;- elsa(r,d=2000,categorical=FALSE)

plot(e)
</code></pre>


</div>