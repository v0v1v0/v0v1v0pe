<div class="container">

<table style="width: 100%;"><tr>
<td>diversity.evaluate.core</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diversity Indices</h2>

<h3>Description</h3>

<p>Compute the following diversity indices and perform corresponding statistical
tests to compare the phenotypic diversity for qualitative traits between
entire collection (EC) and core set (CS). </p>
 <ul>
<li>
<p>Simpson's and
related indices </p>
 <ul>
<li>
<p>Simpson's Index (\(d\))
(Simpson 1949; Peet 1974)
</p>
</li>
<li>
<p>Simpson's Index of Diversity or Gini's Diversity Index or Gini-Simpson
Index or Nei's Diversity Index or Nei's Variation Index (\(D\))
(Gini 1912, 1912; Greenberg 1956; Berger and Parker 1970; Nei 1973; Peet 1974)
</p>
</li>
<li>
<p>Maximum Simpson's Index of Diversity or Maximum Nei's
Diversity/Variation Index (\(D_{max}\))
(Hennink and Zeven 1990) </p>
</li>
<li>
<p>Simpson's
Reciprocal Index or Hill's \(N_{2}\) (\(D_{R}\))
(Williams 1964; Hill 1973)
</p>
</li>
<li>
<p>Relative Simpson's Index of Diversity or Relative Nei's
Diversity/Variation Index (\(D'\))
(Hennink and Zeven 1990) </p>
</li>
</ul>
</li>
<li>
<p>Shannon-Weaver and related indices </p>
 <ul>
<li>
<p>Shannon or
Shannon-Weaver or Shannon-Weiner Diversity Index (\(H\))
(Shannon and Weaver 1949; Peet 1974)
</p>
</li>
<li>
<p>Maximum Shannon-Weaver Diversity Index (\(H_{max}\))
(Hennink and Zeven 1990) </p>
</li>
<li>
<p>Relative
Shannon-Weaver Diversity Index or Shannon Equitability Index (\(H'\))
(Hennink and Zeven 1990) </p>
</li>
</ul>
</li>
<li>
<p>McIntosh
Diversity Index </p>
 <ul><li>
<p>McIntosh Diversity Index (\(D_{Mc}\))
(McIntosh 1967; Peet 1974) </p>
</li></ul>
</li>
</ul>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><h3>Usage</h3>

<pre><code class="language-R">diversity.evaluate.core(data, names, qualitative, selected, base = 2, R = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data as a data frame object. The data frame should possess
one row per individual and columns with the individual names and multiple
trait/character data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>Name of column with the individual names as a character string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qualitative</code></td>
<td>
<p>Name of columns with the qualitative traits as a character
vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected</code></td>
<td>
<p>Character vector with the names of individuals selected in
core collection and present in the <code>names</code> column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>The logarithm base to be used for computation of Shannon-Weaver
Diversity Index (\(I\)). Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of bootstrap replicates. Default is 1000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with three data frames as follows. </p>
<table>
<tr style="vertical-align: top;">
<td><code>simpson</code></td>
<td>

<dl>
<dt>Trait</dt>
<dd>
<p>The qualitative trait.</p>
</dd>
<dt>EC_No.Classes</dt>
<dd>
<p>The number of classes in the trait for EC.</p>
</dd>
<dt>CS_No.Classes</dt>
<dd>
<p>The number of classes in the trait for CS.</p>
</dd>
<dt>EC_d</dt>
<dd>
<p>The Simpson's Index (\(d\)) for EC.</p>
</dd>
<dt>EC_D</dt>
<dd>
<p>The Simpson's Index of Diversity (\(D\)) for EC.</p>
</dd>
<dt>EC_D.max</dt>
<dd>
<p>The Maximum Simpson's Index of Diversity
(\(D_{max}\)) for EC.</p>
</dd> <dt>EC_D.inv</dt>
<dd>
<p>The Simpson's Reciprocal
Index (\(D_{R}\)) for EC.</p>
</dd> <dt>EC_D.rel</dt>
<dd>
<p>The Relative
Reciprocal Index (\(D'\)) for EC.</p>
</dd> <dt>EC_d.V</dt>
<dd>
<p>The variance
of \(d\) for EC according to
(Simpson 1949).</p>
</dd>
<dt>EC_d.boot.V</dt>
<dd>
<p>The bootstrap variance of \(d\) for EC.</p>
</dd>
<dt>CS_d</dt>
<dd>
<p>The Simpson's Index (\(d\)) for CS.</p>
</dd>
<dt>CS_D</dt>
<dd>
<p>The Simpson's Index of Diversity (\(D\)) for CS.</p>
</dd>
<dt>CS_D.max</dt>
<dd>
<p>The Maximum Simpson's Index of Diversity
(\(D_{max}\)) for CS.</p>
</dd> <dt>CS_D.inv</dt>
<dd>
<p>The Simpson's Reciprocal
Index (\(D_{R}\)) for CS.</p>
</dd> <dt>CS_D.rel</dt>
<dd>
<p>The Relative
Reciprocal Index (\(D'\)) for CS.</p>
</dd> <dt>CS_d.V</dt>
<dd>
<p>The variance
of \(d\) for CS according to
(Simpson 1949).</p>
</dd>
<dt>CS_d.boot.V</dt>
<dd>
<p>The bootstrap variance of \(d\) for CS.</p>
</dd>
<dt>d.t.df</dt>
<dd>
<p>The degrees of freedom for t test.</p>
</dd>
<dt>d.t.stat</dt>
<dd>
<p>The t statistic.</p>
</dd> <dt>d.t.pvalue</dt>
<dd>
<p>The p
value for t test.</p>
</dd> <dt>d.t.significance</dt>
<dd>
<p>The  significance of t
test for t-test</p>
</dd> <dt>d.boot.z.df</dt>
<dd>
<p>The degrees of freedom for
bootstrap z score.</p>
</dd> <dt>d.boot.z.stat</dt>
<dd>
<p>The bootstrap z score.</p>
</dd>
<dt>d.boot.z.pvalue</dt>
<dd>
<p>The p value of z score.</p>
</dd>
<dt>d.boot.z.significance</dt>
<dd>
<p>The significance of z score.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shannon</code></td>
<td>
 <dl>
<dt>Trait</dt>
<dd>
<p>The qualitative
trait.</p>
</dd> <dt>EC_No.Classes</dt>
<dd>
<p>The number of classes in the trait for
EC.</p>
</dd> <dt>CS_No.Classes</dt>
<dd>
<p>The number of classes in the trait for
CS.</p>
</dd> <dt>EC_I</dt>
<dd>
<p>The Shannon-Weaver Diversity Index (\(I\)) for
EC.</p>
</dd> <dt>EC_I.max</dt>
<dd>
<p>The Maximum Shannon-Weaver Diversity Index
(\(I_{max}\)) for EC.</p>
</dd> <dt>EC_I.rel</dt>
<dd>
<p>The Relative
Shannon-Weaver Diversity Index (\(I'\)) for EC.</p>
</dd>
<dt>EC_I.V</dt>
<dd>
<p>The variance of \(I\) for EC according to
(Hutcheson 1970).</p>
</dd>
<dt>EC_I.boot.V</dt>
<dd>
<p>The bootstrap variance of \(I\) for EC.</p>
</dd>
<dt>CS_I</dt>
<dd>
<p>The Shannon-Weaver Diversity Index (\(I\)) for CS.</p>
</dd>
<dt>CS_I.max</dt>
<dd>
<p>The Maximum Shannon-Weaver Diversity Index
(\(I_{max}\)) for CS.</p>
</dd> <dt>CS_I.rel</dt>
<dd>
<p>The Relative
Shannon-Weaver Diversity Index (\(I'\)) for CS.</p>
</dd>
<dt>CS_I.V</dt>
<dd>
<p>The variance of \(I\) for CS according to
(Hutcheson 1970).</p>
</dd>
<dt>CS_I.boot.V</dt>
<dd>
<p>The bootstrap variance of \(I\) for CS.</p>
</dd>
<dt>I.t.stat</dt>
<dd>
<p>The t statistic.</p>
</dd> <dt>I.t.df</dt>
<dd>
<p>The degrees
of freedom for t test.</p>
</dd> <dt>I.t.pvalue</dt>
<dd>
<p>The p value for t test.</p>
</dd>
<dt>I.t.significance</dt>
<dd>
<p>The  significance of t test for t-test</p>
</dd>
<dt>I.boot.z.df</dt>
<dd>
<p>The degrees of freedom for bootstrap z score.</p>
</dd>
<dt>I.boot.z.stat</dt>
<dd>
<p>The bootstrap z score.</p>
</dd>
<dt>I.boot.z.pvalue</dt>
<dd>
<p>The p value of z score.</p>
</dd>
<dt>I.boot.z.significance</dt>
<dd>
<p>The significance of z score.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcintosh</code></td>
<td>
 <dl>
<dt>EC_No.Classes</dt>
<dd>
<p>The number of
classes in the trait for EC.</p>
</dd> <dt>CS_No.Classes</dt>
<dd>
<p>The number of
classes in the trait for CS.</p>
</dd> <dt>EC_D.Mc</dt>
<dd>
<p>The McIntosh Index
(\(D_{Mc}\)) for EC.</p>
</dd> <dt>CS_D.Mc</dt>
<dd>
<p>The McIntosh Index
(\(D_{Mc}\)) for CS.</p>
</dd> <dt>M.boot.z.stat</dt>
<dd>
<p>The bootstrap z
score.</p>
</dd> <dt>M.boot.z.df</dt>
<dd>
<p>The degrees of freedom for bootstrap z
score.</p>
</dd> <dt>M.boot.z.pvalue</dt>
<dd>
<p>The p value of z score.</p>
</dd>
<dt>M.boot.z.significance</dt>
<dd>
<p>The significance of z score.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The diversity indices and the corresponding statistical
tests implemented in <code>diversity.evaluate.core</code> are as follows.
</p>


<h4>Simpson's and related indices</h4>

<p>Simpson's index (\(d\))
which estimates the probability that two accessions randomly selected will
belong to the same phenotypic class of a trait, is computed as follows
(Simpson 1949; Peet 1974).
</p>
\[d = \sum_{i = 1}^{k}p_{i}^{2}\]
<p>Where, \(p_{i}\) denotes the proportion/fraction/frequency of
accessions in the \(i\)th phenotypic class for a trait and \(k\)
is the number of phenotypic classes for the trait.
</p>
<p>The value of \(d\) can range from 0 to 1 with 0 representing maximum
diversity and 1, no diversity.
</p>
<p>\(d\) is subtracted from 1 to give Simpson's index of diversity
(\(D\))
(Greenberg 1956; Berger and Parker 1970; Peet 1974; Hennink and Zeven 1990)
originally suggested by
Gini (1912, 1912)
and described in literature as Gini's diversity index or Gini-Simpson
index. It is the same as Nei's diversity index or Nei's variation index
(Nei 1973; Hennink and Zeven 1990).
Greater the value of \(D\), greater the diversity with a range from 0
to 1.
</p>
\[D = 1 - d\]
<p>The maximum value of \(D\), \(D_{max}\) occurs when accessions
are uniformly distributed across the phenotypic classes and is computed as
follows (Hennink and Zeven 1990).
</p>
\[D_{max} = 1 - \frac{1}{k}\]
<p>Reciprocal of \(d\) gives the Simpson's reciprocal index
(\(D_{R}\))
(Williams 1964; Hennink and Zeven 1990)
and can range from 1 to \(k\). This was also described in
Hill (1973) as (\(N_{2}\)).
</p>
\[D_{R} = \frac{1}{d}\]
<p>Relative Simpson's index of diversity or Relative Nei's diversity/variation
index (\(H'\)) (Hennink and Zeven 1990)
is defined as follows (Peet 1974).
</p>
\[D' = \frac{D}{D_{max}}\]
<p>Differences in Simpson's diversity index for qualitative traits of EC and
CS can be tested by a t-test using the associated variance estimate
described in Simpson (1949)
(Lyons and Hutcheson 1978).
</p>
<p>The t statistic is computed as follows.
</p>
\[t = \frac{d_{EC} - d_{CS}}{\sqrt{V_{d_{EC}} + V_{d_{CS}}}}\]
<p>Where, the variance of \(d\) (\(V_{d}\)) is,
</p>
\[V_{d} = \frac{4N(N-1)(N-2)\sum_{i=1}^{k}(p_{i})^{3} +
  2N(N-1)\sum_{i=1}^{k}(p_{i})^{2} - 2N(N-1)(2N-3) \left(
  \sum_{i=1}^{k}(p_{i})^{2} \right)^{2}}{[N(N-1)]^{2}}\]
<p>The associated degrees of freedom is computed as follows.
</p>
\[df = (k_{EC} - 1) + (k_{CS} - 1)\]
<p>Where, \(k_{EC}\) and \(k_{CS}\) are the number of phenotypic
classes in the trait for EC and CS respectively.
</p>



<h4>Shannon-Weaver and related indices</h4>

<p>An index of information
\(H\), was described by
Shannon and Weaver (1949) as follows.
</p>
\[H = -\sum_{i=1}^{k}p_{i} \log_{2}(p_{i})\]
<p>\(H\) is described as Shannon or Shannon-Weaver or Shannon-Weiner
diversity index in literature.
</p>
<p>Alternatively, \(H\) is also computed using natural logarithm instead
of logarithm to base 2.
</p>
\[H = -\sum_{i=1}^{k}p_{i} \ln(p_{i})\]
<p>The maximum value of \(H\) (\(H_{max}\)) is \(\ln(k)\). This
value occurs when each phenotypic class for a trait has the same proportion
of accessions.
</p>
\[H_{max} = \log_{2}(k)\;\; \textrm{OR} \;\; H_{max} = \ln(k)\]
<p>The relative Shannon-Weaver diversity index or Shannon equitability index
(\(H'\)) is the Shannon diversity index (\(I\)) divided by the
maximum diversity (\(H_{max}\)).
</p>
\[H' = \frac{H}{H_{max}}\]
<p>Differences in Shannon-Weaver diversity index for qualitative traits of EC
and CS can be tested by Hutcheson t-test
(Hutcheson 1970).
</p>
<p>The Hutcheson t statistic is computed as follows.
</p>
\[t = \frac{H_{EC} - H_{CS}}{\sqrt{V_{H_{EC}} + V_{H_{CS}}}}\]
<p>Where, the variance of \(H\) (\(V_{H}\)) is,
</p>
\[V_{H} = \frac{\sum_{i=1}^{k}n_{i}(\log_{2}{n_{i}})^{2}
  \frac{(\sum_{i=1}^{k}\log_{2}{n_{i}})^2}{N}}{N^{2}}\]
\[\textrm{OR}\]
\[V_{H} = \frac{\sum_{i=1}^{k}n_{i}(\ln{n_{i}})^{2}
  \frac{(\sum_{i=1}^{k}\ln{n_{i}})^2}{N}}{N^{2}}\]
<p>The associated degrees of freedom is approximated as follows.
</p>
\[df = \frac{(V_{H_{EC}} +
  V_{H_{CS}})^{2}}{\frac{V_{H_{EC}}^{2}}{N_{EC}} +
  \frac{V_{H_{CS}}^{2}}{N_{CS}}}\]



<h4>McIntosh Diversity Index</h4>

<p>A similar index of diversity was
described by McIntosh (1967) as
follows (\(D_{Mc}\)) (Peet 1974).
</p>
\[D_{Mc} = \frac{N - \sqrt{\sum_{i=1}^{k}n_{i}^2}}{N - \sqrt{N}}\]
<p>Where, \(n_{i}\) denotes the number of accessions in the \(i\)th
phenotypic class for a trait and \(N\) is the total number of
accessions so that \(p_{i} = {n_{i}}/{N}\).</p>



<h4>Testing for difference with bootstrapping</h4>

<p>Bootstrap statistics
are employed to test the difference between the Simpson, Shannon-Weaver and
McIntosh indices for  qualitative traits of EC and CS
(Solow 1993).
</p>
<p>If \(I_{EC}\) and \(I_{CS}\) are the diversity indices with the
original number of accessions, then random samples of the same size as the
original are repeatedly generated (with replacement) \(R\) times and
the corresponding diversity index is computed for each sample.
</p>
\[I_{EC}^{*} = \lbrace H_{EC_{1}}, H_{EC_{}}, \cdots, H_{EC_{R}}
  \rbrace\]
\[I_{CS}^{*} = \lbrace H_{CS_{1}}, H_{CS_{}}, \cdots, H_{CS_{R}}
  \rbrace\]
<p>Then the bootstrap null sample \(I_{0}\) is computed as follows.
</p>
\[\Delta^{*} = I_{EC}^{*} - I_{CS}^{*}\]
\[I_{0} = \Delta^{*} - \overline{\Delta^{*}}\]
<p>Where, \(\overline{\Delta^{*}}\) is the mean of \(\Delta^{*}\).
</p>
<p>Now the original difference in diversity indices (\(\Delta_{0} =
  I_{EC} - I_{CS}\)) is tested against mean of bootstrap null sample
(\(I_{0}\)) by a z test. The z score test statistic is computed as
follows.
</p>
\[z = \frac{\Delta_{0} - \overline{H_{0}}}{\sqrt{V_{H_{0}}}}\]
<p>Where,  \(\overline{H_{0}}\) and \(V_{H_{0}}\) are the mean and
variance of the bootstrap null sample \(H_{0}\).
</p>
<p>The corresponding degrees of freedom is estimated as follows.
</p>
\[df = (k_{EC} - 1) + (k_{CS} - 1)\]



<h3>References</h3>

<p>Berger WH, Parker FL (1970).
“Diversity of planktonic foraminifera in deep-sea sediments.”
<em>Science</em>, <b>168</b>(3937), 1345–1347.<br><br> Gini C (1912).
<em>Variabilita e Mutabilita. Contributo allo Studio delle Distribuzioni e delle Relazioni Statistiche. [Fasc. I.]</em>.
Tipogr. di P. Cuppini, Bologna.<br><br> Gini C (1912).
“Variabilita e mutabilita.”
In Pizetti E, Salvemini T (eds.), <em>Memorie di Metodologica Statistica</em>.
Liberia Eredi Virgilio Veschi, Roma, Italy.<br><br> Greenberg JH (1956).
“The measurement of linguistic diversity.”
<em>Language</em>, <b>32</b>(1), 109.<br><br> Hennink S, Zeven AC (1990).
“The interpretation of Nei and Shannon-Weaver within population variation indices.”
<em>Euphytica</em>, <b>51</b>(3), 235–240.<br><br> Hill MO (1973).
“Diversity and evenness: A unifying notation and its consequences.”
<em>Ecology</em>, <b>54</b>(2), 427–432.<br><br> Hutcheson K (1970).
“A test for comparing diversities based on the Shannon formula.”
<em>Journal of Theoretical Biology</em>, <b>29</b>(1), 151–154.<br><br> Lyons NI, Hutcheson K (1978).
“C20. Comparing diversities: Gini's index.”
<em>Journal of Statistical Computation and Simulation</em>, <b>8</b>(1), 75–78.<br><br> McIntosh RP (1967).
“An index of diversity and the relation of certain concepts to diversity.”
<em>Ecology</em>, <b>48</b>(3), 392–404.<br><br> Nei M (1973).
“Analysis of gene diversity in subdivided populations.”
<em>Proceedings of the National Academy of Sciences</em>, <b>70</b>(12), 3321–3323.<br><br> Peet RK (1974).
“The measurement of species diversity.”
<em>Annual Review of Ecology and Systematics</em>, <b>5</b>(1), 285–307.<br><br> Shannon CE, Weaver W (1949).
<em>The Mathematical Theory of Communication</em>,  number v. 2 in The Mathematical Theory of Communication.
University of Illinois Press.<br><br> Simpson EH (1949).
“Measurement of diversity.”
<em>Nature</em>, <b>163</b>(4148), 688–688.<br><br> Solow AR (1993).
“A simple test for change in community structure.”
<em>The Journal of Animal Ecology</em>, <b>62</b>(1), 191.<br><br> Williams CB (1964).
<em>Patterns in the Balance of Nature and Related Problems in Quantitative Ecology</em>.
Academic Press.
</p>


<h3>See Also</h3>

<p><code>shannon</code>, <code>diversity</code>,
<code>boot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("cassava_CC")
data("cassava_EC")

ec &lt;- cbind(genotypes = rownames(cassava_EC), cassava_EC)
ec$genotypes &lt;- as.character(ec$genotypes)
rownames(ec) &lt;- NULL

core &lt;- rownames(cassava_CC)

quant &lt;- c("NMSR", "TTRN", "TFWSR", "TTRW", "TFWSS", "TTSW", "TTPW", "AVPW",
           "ARSR", "SRDM")
qual &lt;- c("CUAL", "LNGS", "PTLC", "DSTA", "LFRT", "LBTEF", "CBTR", "NMLB",
          "ANGB", "CUAL9M", "LVC9M", "TNPR9M", "PL9M", "STRP", "STRC",
          "PSTR")

ec[, qual] &lt;- lapply(ec[, qual],
                     function(x) factor(as.factor(x)))


diversity.evaluate.core(data = ec, names = "genotypes",
                        qualitative = qual, selected = core)


</code></pre>


</div>