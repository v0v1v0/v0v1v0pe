<div class="container">

<table style="width: 100%;"><tr>
<td>em.prec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM algorithm for multivariate normal, precision matrix parameterization</h2>

<h3>Description</h3>

<p>EM algorithm for multivariate normal, precision matrix parameterization
</p>


<h3>Usage</h3>

<pre><code class="language-R">em.prec(
  dat,
  max.iter = 500,
  tol = 1e-05,
  start = c("diag", "pairwise", "listwise", "full"),
  glassoversion = c("none", "glassoFast", "glasso", "glassonostart"),
  debug = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Data frame or matrix that contains the raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Max number of EM cycles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance for change in parameter estimates across EM Cycles. If
all changes are less than <code>tol</code>, the algorithm terminates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Starting value method (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glassoversion</code></td>
<td>
<p>Character indicating whether to do regularization (lasso),
and if so, using which package. "glasso" uses the <code>glasso</code>
function and uses the E-step covariance matrix for starting values,
"glassoFast" uses <code>glassoFast{glassoFast}</code> which also
penalizes the diagonal of the precision matrix by default (glasso does not),
"glassonostart" also uses <code>glasso</code> but no "warm" starting
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>(Experimental) set an integer value &gt; 1 for some information as the algorithm runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed down to any of the glasso functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes all means and the precision matrix (inverse of covariance
matrix) among a set of variables using the Expectation-Maximization (EM)
algorithm to handle missing values, and assuming multivariate normality. The
EM code was originally developed based on Stadler and Buhlmann (2012) and for
use with the graphical lasso (i.e., glasso). This version allows the possibility
of using a lasso by specifying something other than "none" for <code>glassoversion</code>.
However, it can also be used without regularization to just estimate the precision matrix.
</p>
<p>For starting values for the EM algorithm itself (not at the M-step), the
function accepts either a list that has <code>mu</code> and <code>S</code> slots
corresponding to the starting mean and covariance matrix. This is useful if
the user would like to use custom starting values. Otherwise, a character
corresponding to any of the options available in the <code>startvals.cov</code>
function will be used to take a guess at starting values.
</p>


<h3>Value</h3>

<p>A list with the following:
</p>

<ul>
<li>
<p><code>p.est</code>: all parameter estimates as a vector (means followed by unique elements of precision matrix).
</p>
</li>
<li>
<p><code>mu</code>: estimated means.
</p>
</li>
<li>
<p><code>S</code>: estimated covariance matrix.
</p>
</li>
<li>
<p><code>K</code>: estimated precision matrix.
</p>
</li>
<li>
<p><code>it</code>: number of EM cycles completed.
</p>
</li>
<li>
<p><code>conv</code>: boolean value indicating convergence (TRUE) or not (FALSE).
</p>
</li>
</ul>
<h3>References</h3>

<p>Städler, N., &amp; Bühlmann, P. (2012). Missing values: sparse inverse covariance estimation and an
extension to sparse regression. Statistics and Computing, 22, 219–235. <a href="https://doi.org/10.1007/s11222-010-9219-7">doi:10.1007/s11222-010-9219-7</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  library(psych)
  data(bfi)
  test &lt;- em.prec(bfi[,1:25])

</code></pre>


</div>