<div class="container">

<table style="width: 100%;"><tr>
<td>fitmgng</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLE Fitting of Normal Bulk and GPD for Both Tails Interval Transition Mixture Model</h2>

<h3>Description</h3>

<p>Maximum likelihood estimation for fitting the extreme value 
mixture model with normal for bulk distribution between thresholds, conditional
GPDs beyond thresholds and interval transition. With options for profile likelihood
estimation for both thresholds and interval half-width, which can also be fixed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitmgng(x, eseq = NULL, ulseq = NULL, urseq = NULL,
  fixedeu = FALSE, pvector = NULL, std.err = TRUE, method = "BFGS",
  control = list(maxit = 10000), finitelik = TRUE, ...)

litmgng(x, nmean = 0, nsd = 1, epsilon = nsd, ul = 0,
  sigmaul = 1, xil = 0, ur = 0, sigmaur = 1, xir = 0,
  log = TRUE)

nlitmgng(pvector, x, finitelik = FALSE)

profleuitmgng(eulr, pvector, x, method = "BFGS", control = list(maxit =
  10000), finitelik = TRUE, ...)

nleuitmgng(pvector, epsilon, ul, ur, x, finitelik = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of sample data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eseq</code></td>
<td>
<p>vector of epsilons (or scalar) to be considered in profile likelihood or
<code>NULL</code> for no profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ulseq</code></td>
<td>
<p>vector of lower thresholds (or scalar) to be considered in profile likelihood or
<code>NULL</code> for no profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>urseq</code></td>
<td>
<p>vector of upper thresholds (or scalar) to be considered in profile likelihood or
<code>NULL</code> for no profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedeu</code></td>
<td>
<p>logical, should threshold and epsilon be fixed
(at either scalar value in <code>useq</code> and <code>eseq</code>,
or estimated from maximum of profile likelihood evaluated at
grid of thresholds and epsilons in <code>useq</code> and <code>eseq</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvector</code></td>
<td>
<p>vector of initial values of parameters or <code>NULL</code> for default
values, see below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>logical, should standard errors be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimisation method (see <code>optim</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>optimisation control list (see <code>optim</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>finitelik</code></td>
<td>
<p>logical, should log-likelihood return finite value for invalid parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional inputs passed to <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmean</code></td>
<td>
<p>scalar normal mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsd</code></td>
<td>
<p>scalar normal standard deviation (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>interval half-width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ul</code></td>
<td>
<p>lower tail threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaul</code></td>
<td>
<p>lower tail GPD scale parameter (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xil</code></td>
<td>
<p>lower tail GPD shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ur</code></td>
<td>
<p>upper tail threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaur</code></td>
<td>
<p>upper tail GPD scale parameter (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xir</code></td>
<td>
<p>upper tail GPD shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if <code>TRUE</code> then log-likelihood rather than likelihood is output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eulr</code></td>
<td>
<p>vector of epsilon, lower and upper thresholds considered in profile likelihood</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The extreme value mixture model with the normal bulk and GPD for both tails interval
transition is fitted to the entire dataset using maximum likelihood estimation. The estimated
parameters, variance-covariance matrix and their standard errors are automatically
output.
</p>
<p>See <code>ditmgng</code> for explanation of GPD-normal-GPD interval
transition model, including mixing functions.
</p>
<p>See also help for <code>fnormgpd</code> for details, type <code>help fnormgpd</code>. 
Only the different features are outlined below for brevity.
</p>
<p>The full parameter vector is
(<code>nmean</code>, <code>nsd</code>, <code>epsilon</code>, <code>ul</code>, <code>sigmaul</code>, <code>xil</code>,
<code>ur</code>, <code>sigmaur</code>, <code>xir</code>)
if thresholds and interval half-width are also estimated and
(<code>nmean</code>, <code>nsd</code>, <code>sigmaul</code>, <code>xil</code>, <code>sigmaur</code>, <code>xir</code>)
for profile likelihood or fixed threshold approach.
</p>
<p>If the profile likelihood approach is used, then a grid search over all combinations of epsilons and both thresholds
are carried out. The combinations which lead to less than 5 in any component outside of the
intervals are not considered.
</p>
<p>A fixed pair of thresholds and epsilon approach is acheived by setting a single
scalar value to each in <code>ulseq</code>, <code>urseq</code> and <code>eseq</code> respectively.
</p>


<h3>Value</h3>

<p>Log-likelihood is given by <code>litmgng</code> and it's
wrappers for negative log-likelihood from <code>nlitmgng</code>
and <code>nluitmgng</code>. Profile likelihood for 
thresholds and interval half-width given by <code>profluitmgng</code>.
Fitting function <code>fitmgng</code> returns a simple list with the
following elements
</p>

<table>
<tr>
<td style="text-align: left;">
 <code>call</code>:      </td>
<td style="text-align: left;"> <code>optim</code> call</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>x</code>:         </td>
<td style="text-align: left;"> data vector <code>x</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>init</code>:      </td>
<td style="text-align: left;"> <code>pvector</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>fixedeu</code>:   </td>
<td style="text-align: left;"> fixed epsilon and threshold, logical</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>ulseq</code>:     </td>
<td style="text-align: left;"> lower threshold vector for profile likelihood or scalar for fixed threshold</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>urseq</code>:     </td>
<td style="text-align: left;"> upper threshold vector for profile likelihood or scalar for fixed threshold</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>eseq</code>:      </td>
<td style="text-align: left;"> interval half-width vector for profile likelihood or scalar for fixed threshold</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>nllheuseq</code>: </td>
<td style="text-align: left;"> profile negative log-likelihood at each combination in (eseq, ulseq, urseq)</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>optim</code>:     </td>
<td style="text-align: left;"> complete <code>optim</code> output</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>mle</code>:       </td>
<td style="text-align: left;"> vector of MLE of parameters</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>cov</code>:       </td>
<td style="text-align: left;"> variance-covariance matrix of MLE of parameters</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>se</code>:        </td>
<td style="text-align: left;"> vector of standard errors of MLE of parameters</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>nllh</code>:      </td>
<td style="text-align: left;"> minimum negative log-likelihood</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>n</code>:         </td>
<td style="text-align: left;"> total sample size</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>nmean</code>:     </td>
<td style="text-align: left;"> MLE of normal mean</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>nsd</code>:       </td>
<td style="text-align: left;"> MLE of normal standard deviation</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>epsilon</code>:   </td>
<td style="text-align: left;"> MLE of transition half-width</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>ul</code>:        </td>
<td style="text-align: left;"> lower threshold (fixed or MLE)</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>sigmaul</code>:   </td>
<td style="text-align: left;"> MLE of lower tail GPD scale</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>xil</code>:       </td>
<td style="text-align: left;"> MLE of lower tail GPD shape</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>ur</code>:        </td>
<td style="text-align: left;"> upper threshold (fixed or MLE)</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>sigmaur</code>:   </td>
<td style="text-align: left;"> MLE of upper tail GPD scale</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>xir</code>:       </td>
<td style="text-align: left;"> MLE of upper tail GPD shape</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Acknowledgments</h3>

<p>See Acknowledgments in
<code>fnormgpd</code>, type <code>help fnormgpd</code>. Based on code
by Xin Zhao produced for MATLAB.
</p>


<h3>Note</h3>

<p>When <code>pvector=NULL</code> then the initial values are:
</p>

<ul>
<li>
<p> MLE of normal parameters assuming entire population is normal; and
</p>
</li>
<li>
<p> lower threshold 10% quantile (not relevant for profile likelihood for threshold or fixed threshold approaches);
</p>
</li>
<li>
<p> upper threshold 90% quantile (not relevant for profile likelihood for threshold or fixed threshold approaches);
</p>
</li>
<li>
<p> MLE of GPD parameters beyond threshold. 
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Alfadino Akbar and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://www.math.canterbury.ac.nz/~c.scarrott/evmix">http://www.math.canterbury.ac.nz/~c.scarrott/evmix</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Normal_distribution">http://en.wikipedia.org/wiki/Normal_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>Holden, L. and Haug, O. (2013). A mixture model for unsupervised tail
estimation. arxiv:0902.4137
</p>


<h3>See Also</h3>

<p><code>fgng</code>, <code>dnorm</code>,
<code>fgpd</code> and <code>gpd</code>
</p>
<p>Other itmgng: <code>itmgng</code>
</p>
<p>Other itmnormgpd: <code>fitmnormgpd</code>,
<code>itmgng</code>, <code>itmnormgpd</code>
</p>
<p>Other gng: <code>fgngcon</code>, <code>fgng</code>,
<code>fnormgpd</code>, <code>gngcon</code>,
<code>gng</code>, <code>itmgng</code>,
<code>normgpd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(1, 1))

x = rnorm(1000)
xx = seq(-4, 4, 0.01)
y = dnorm(xx)

# MLE for complete parameter set (not recommended!)
fit = fitmgng(x)
hist(x, breaks = seq(-6, 6, 0.1), freq = FALSE, xlim = c(-4, 4))
lines(xx, y)
with(fit, lines(xx, ditmgng(xx, nmean, nsd, epsilon, ul, sigmaul, xil,
                                                     ur, sigmaur, xir), col="red"))
abline(v = fit$ul + fit$epsilon * seq(-1, 1), col = "red")
abline(v = fit$ur + fit$epsilon * seq(-1, 1), col = "darkred")
  
# Profile likelihood for threshold which is then fixed
fitfix = fitmgng(x, eseq = seq(0, 2, 0.1), ulseq = seq(-2.5, 0, 0.25), 
                                         urseq = seq(0, 2.5, 0.25), fixedeu = TRUE)
with(fitfix, lines(xx, ditmgng(xx, nmean, nsd, epsilon, ul, sigmaul, xil,
                                                      ur, sigmaur, xir), col="blue"))
abline(v = fitfix$ul + fitfix$epsilon * seq(-1, 1), col = "blue")
abline(v = fitfix$ur + fitfix$epsilon * seq(-1, 1), col = "darkblue")
legend("topright", c("True Density", "GPD-normal-GPD ITM", "Profile likelihood"),
  col=c("black", "red", "blue"), lty = 1)

## End(Not run)
  
</code></pre>


</div>