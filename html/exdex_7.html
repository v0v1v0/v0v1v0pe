<div class="container">

<table style="width: 100%;"><tr>
<td>choose_ud</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Threshold <code class="reqn">u</code> and runs parameter <code class="reqn">D</code> diagnostic for the <code class="reqn">D</code>-gaps
estimator</h2>

<h3>Description</h3>

<p>Creates data for a plot to aid the choice of the threshold and
run parameter <code class="reqn">D</code> for the <code class="reqn">D</code>-gaps estimator (see
<code>dgaps</code>).  <code>plot.choose_ud</code> creates the plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">choose_ud(data, u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code>split_by_NAs</code> is
used to divide the data into sequences of non-missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u, D</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of
extreme value thresholds applied to data.  <code>D</code> is a vector of values
of the run parameter <code class="reqn">D</code>, as defined in Holesovsky and Fusek (2020).
See <code>dgaps</code> for more details.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. It is known that these times are greater
than or equal to the time observed.
If <code>data</code> has multiple columns then there will be right-censored
first and last inter-exceedance times for each column.  See
<strong>Details</strong> in <code>dgaps</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each combination of threshold in <code>u</code> and <code class="reqn">D</code>
in <code>D</code> the functions <code>dgaps</code> and <code>dgaps_imt</code>
are called in order to estimate <code class="reqn">\theta</code> and to perform the
information matrix test of Holesovsky and Fusek (2020).
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("choose_ud", "exdex")</code>
containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>imt </code></td>
<td>
<p>an object of class <code>c("dgaps_imt", "exdex")</code> returned
from <code>dgaps_imt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>a <code>length(u)</code> by <code>length(D)</code> matrix.
Element (i,j) of <code>theta</code> contains an object (a list) of class
<code>c("dgaps", "exdex")</code>, a result of a call
<code>dgaps(data, u[j], D[i])</code> to <code>dgaps</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>


<h3>See Also</h3>

<p><code>dgaps</code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">D</code>-gaps model.
</p>
<p><code>dgaps_imt</code> for the information matrix test under the
<code class="reqn">D</code>-gaps model
</p>
<p><code>plot.choose_ud</code> to produce the diagnostic plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### S&amp;P 500 index

# Multiple thresholds and left-censoring parameters
u &lt;- quantile(sp500, probs = seq(0.2, 0.9, by = 0.1))
imt_theta &lt;- choose_ud(sp500, u = u, D = 1:5)
plot(imt_theta)
plot(imt_theta, uprob = TRUE)
plot(imt_theta, y = "theta")

# One left-censoring parameter D, many thresholds u
u &lt;- quantile(sp500, probs = seq(0.2, 0.9, by = 0.1))
imt_theta &lt;- choose_ud(sp500, u = u, D = 1)
plot(imt_theta)
plot(imt_theta, y = "theta")

# One threshold u, many left-censoring parameters D
u &lt;- quantile(sp500, probs = 0.9)
imt_theta &lt;- choose_ud(sp500, u = u, D = 1:5)
plot(imt_theta)
plot(imt_theta, y = "theta")

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt_theta &lt;- choose_ud(newlyn, u = u, D = 1:5)
plot(imt_theta, uprob = TRUE)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.95, by = 0.05), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt_theta &lt;- choose_ud(cheeseboro, u, D = 1:6)
plot(imt_theta, uprob = FALSE, lwd = 2)

### Uccle July temperatures

probs &lt;- c(seq(0.7, 0.95, by = 0.05), 0.99)
u &lt;- quantile(uccle720m, probs = probs, na.rm = TRUE)
imt_theta &lt;- choose_ud(uccle720m, u, D = 1:5)
plot(imt_theta, uprob = TRUE, lwd = 2)
</code></pre>


</div>