<div class="container">

<table style="width: 100%;"><tr>
<td>tidyst_kfs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tidy and geospatial kernel feature significance</h2>

<h3>Description</h3>

<p>Tidy and geospatial versions of kernel feature significance for 1- and 2-dimensional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tidy_kfs(data, ...)
st_kfs(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame/tibble of data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>sf object with point geometry</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters in <code>ks::kfs</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A significant kernel curvature region consist of all points whose density curvature value is significantly different less than zero (i.e. forms a bump surrounding a local maximum). A Hochberg procedure is employed to control the significance level for multiple significance tests. 
</p>
<p>For details of the computation of the significant kernel curvature regions, see <code>?ks::kfs</code>. The bandwidth matrix of smoothing parameters is computed as in <code>ks::kdde(deriv_order=2)</code>.  
</p>


<h3>Value</h3>

<p>The output from <code>tidy_kfs</code> has the same structure as the kernel density estimate from <code>tidy_kde</code>, except that all values of <code>estimate</code> outside of the significant curvature regions are set to zero, and the <code>label</code> indicates whether the corresponding <code>x,y</code> point is inside a significant curvature region. 
</p>
<p>The output from <code>st_kfs</code> has a single contour, with <code>contlabel=50</code>, as a multipolygon which delimits significant curvature regions. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## tidy significant curvature regions
library(ggplot2)
data(hsct, package="ks")
hsct &lt;- dplyr::as_tibble(hsct)
hsct &lt;- dplyr::filter(hsct, PE.Ly65Mac1&gt;0 &amp; APC.CD45.2&gt;0)
hsct12 &lt;- dplyr::filter(hsct, subject==12)   
hsct12 &lt;- dplyr::select(hsct12, PE.Ly65Mac1, APC.CD45.2)
t1 &lt;- tidy_kfs(hsct12)
gt &lt;- ggplot(t1, aes(x=PE.Ly65Mac1, y=APC.CD45.2)) 
gt + geom_contour_filled_ks(aes(colour=label), colour=1) +
    scale_fill_manual(values=7) 

## geospatial significant curvature regions
data(wa)
data(grevilleasf)
hakeoides &lt;- dplyr::filter(grevilleasf, species=="hakeoides")
s1 &lt;- st_kfs(hakeoides)

## base R plot
xlim &lt;- c(1.2e5, 1.1e6); ylim &lt;- c(6.1e6, 7.2e6)
plot(wa, xlim=xlim, ylim=ylim)
plot(s1, add=TRUE)

## geom_sf plot
gs &lt;- ggplot(s1) + geom_sf(data=wa, fill=NA) + ggthemes::theme_map() 
gs + geom_sf(data=st_get_contour(s1, cont=50), aes(fill=label)) +
    scale_fill_manual(values=7) + coord_sf(xlim=xlim, ylim=ylim)
</code></pre>


</div>