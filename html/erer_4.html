<div class="container">

<table style="width: 100%;"><tr>
<td>aiDynFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a Dynamic AIDS Model</h2>

<h3>Description</h3>

<p>Estimate a dynamic AIDS model for a system.</p>


<h3>Usage</h3>

<pre><code class="language-R">aiDynFit(w, dum.dif = FALSE, AR1 = FALSE,
  rho.sel = c("all", "mean"), ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w </code></td>
<td>
<p> a object of class <code>aiStaFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dum.dif </code></td>
<td>
<p> a logical value (default of FALSE) of whether to take a difference on the dummy variables passed from <code>w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR1 </code></td>
<td>
<p> whether first-degree autocorrelation should be corrected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.sel </code></td>
<td>
<p> if <code>AR1 = TRUE</code>, there are two ways of computing the autocorrelation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p> additional arguments to be passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This estimates a dynamic AIDS model. The residuals from the statis AIDS model are included. As it is programmed now, only one lag is allowed for the share variables on the right-hand side. Autocorrelation in the residuals can be corrected following the treatment in Berndt (1975).</p>


<h3>Value</h3>

<p>Return a list object of class "aiFit" and "aiDynFit" with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>w </code></td>
<td>
<p> a object of class <code>aiStaFit</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p> data for fitting the static AIDS model, passed down by <code>w</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dum.dif </code></td>
<td>
<p> a logical value (default of FALSE) of whether to take a difference on the dummy variables passed from <code>w</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>daDyn </code></td>
<td>
<p> data for fitting the dynamic AIDS model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>share </code></td>
<td>
<p> names of shares by commodity, used as depedent variables.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>price </code></td>
<td>
<p> names of prices by commodity, used as independent variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expen </code></td>
<td>
<p> names of expenditure variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift </code></td>
<td>
<p> names of the shifters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit </code></td>
<td>
<p> names of the omitted share variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nOmit </code></td>
<td>
<p> position of the omitted share variable in the name of share variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hom </code></td>
<td>
<p> a logical value of homogeneity test. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sym  </code></td>
<td>
<p> a logical value of symmetry test. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nShare </code></td>
<td>
<p> number of share variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nExoge </code></td>
<td>
<p> number of exogenous variables (lagged share, residual, expenditure, and shifters). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nParam </code></td>
<td>
<p> number of parameters in one equation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTotal </code></td>
<td>
<p> number of parameters in the whole system estimated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula </code></td>
<td>
<p> formula for estimating the system. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.matrix </code></td>
<td>
<p> restriction matrix for <code>hom</code> or <code>sym</code>, or both. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.rhs </code></td>
<td>
<p> right-hand values for tests of <code>hom</code> or <code>sym</code>, or both. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est </code></td>
<td>
<p> the dynamic AIDS model estimated. </p>
</td>
</tr>
</table>
<h3>Methods</h3>

<p>One method is defined as follows:
</p>

<dl>
<dt>
<code>print</code>:</dt>
<dd>
<p>print the first several observations of the final data.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Changyou Sun (<a href="mailto:edwinsun258@gmail.com">edwinsun258@gmail.com</a>)</p>


<h3>References</h3>

<p>Berndt, E.R., and N.E. Savin. 1975. Estimation and hypothesis testing in singular equation systems with autoregressive disturbances. Econometrica 43(5/6):937-957.
</p>
<p>Wan, Y., C. Sun, and D.L. Grebner. 2010. Analysis of import demand for wooden beds in the United States. Journal of Agricultural and Applied Economics 42(4):643-658.
</p>


<h3>See Also</h3>

<p><code>systemfitAR</code>; <code>aiStaFit</code>; <code>aiDiag</code>; <code>aiElas</code>; <code>summary.aiFit</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
# --- Step 1: Read data
data(daExp, daBedRaw, daBed)

# --- Step 2: Hausman Test 
# 2.1 Getting started with a static AIDS model 
sh  &lt;- c("sCN", "sVN", "sID", "sMY", "sCA", "sBR", "sIT", "sRW")
pr  &lt;- c("lnpCN", "lnpVN", "lnpID", "lnpMY",  
         "lnpCA", "lnpBR", "lnpIT", "lnpRW")
du3 &lt;- c("dum1","dum2","dum3")
rSta &lt;- aiStaFit(y = daBed, share = sh, price = pr, shift = du3, 
  expen = "rte", omit = "sRW", hom = TRUE, sym = TRUE)
summary(rSta)

# The following steps should work. It can take a few minutes.

# 2.2 The final Hausman test and new data
(dg &lt;- daExp[, "dg"])
rHau &lt;- aiStaHau(x = rSta, instr = dg, choice = FALSE)
names(rHau); colnames(rHau$daHau); colnames(rHau$daFit); rHau
two.exp &lt;- rHau$daFit[, c("rte", "rte.fit")] 
bsStat(two.exp, digits = 4)
plot(data.frame(two.exp)); abline(a = 0, b = 1)
daBedFit &lt;- rHau$daFit

# --- Step 3: Static and dynamic AIDS models 
# 3.1 Diagnostics and coefficients
hSta  &lt;- update(rSta, y = daBedFit, expen = "rte.fit")
hSta2 &lt;- update(hSta, hom = FALSE, sym = FALSE) 
hSta3 &lt;- update(hSta, hom = FALSE, sym = TRUE)
hSta4 &lt;- update(hSta, hom = TRUE,  sym = FALSE)
lrtest(hSta2$est, hSta$est) 
lrtest(hSta2$est, hSta3$est)
lrtest(hSta2$est, hSta4$est)

hDyn  &lt;- aiDynFit(hSta)
hDyn2 &lt;- aiDynFit(hSta2); lrtest(hDyn2$est, hDyn$est)
hDyn3 &lt;- aiDynFit(hSta3); lrtest(hDyn2$est, hDyn3$est)
hDyn4 &lt;- aiDynFit(hSta4); lrtest(hDyn2$est, hDyn4$est)

(table.2 &lt;- rbind(aiDiag(hSta), aiDiag(hDyn)))
(table.3 &lt;- summary(hSta))
(table.4 &lt;- summary(hDyn))
                          
# 3.2 Elasticity calculation
es &lt;- aiElas(hSta); esm &lt;- es$marsh
ed &lt;- aiElas(hDyn); edm &lt;- ed$marsh
esm2 &lt;- data.frame(c(esm[1:2, 2], esm[3:4, 3], 
  esm[5:6, 4], esm[7:8, 5], esm[9:10, 6], esm[11:12, 7], 
  esm[13:14, 8], esm[15:16, 9]))
edm2 &lt;- data.frame(c(edm[1:2, 2], edm[3:4, 3], 
  edm[5:6, 4], edm[7:8, 5], edm[9:10, 6], edm[11:12, 7], 
  edm[13:14, 8], edm[15:16, 9]))
eEM &lt;- cbind(es$expen, esm2, ed$expen[2], edm2) 
colnames(eEM) &lt;- c("Country", "LR.expen", "LR.Marsh", 
  "SR.expen", "SR.Marsh")
(table.5 &lt;- eEM[-c(15:16),])
(table.6a &lt;- es$hicks[-c(15:16), -9])
(table.6b &lt;- ed$hicks[-c(15:16), -9])

</code></pre>


</div>