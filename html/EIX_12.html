<div class="container">

<table style="width: 100%;"><tr>
<td>waterfall</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Explain prediction of a single observation</h2>

<h3>Description</h3>

<p>This function calculates a table with influence of variables and interactions
on the prediction of a given observation. It supports only xgboost models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">waterfall(
  xgb_model,
  new_observation,
  data,
  type = "binary",
  option = "interactions",
  baseline = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xgb_model</code></td>
<td>
<p>a xgboost model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_observation</code></td>
<td>
<p>a new observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>row from the original dataset with the new observation to explain (not one-hot-encoded).
The param above has to be set to merge categorical features.
If you dont wont to merge categorical features, set this parameter the same as <code>new_observation</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the learning task of the model. Available tasks: "binary" for binary classification  or "regression" for linear regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>if "variables", the plot includes only single variables,
if "interactions", then only interactions.
Default "interaction".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>a number or a character "Intercept" (for model intercept).
The baseline for the plot, where the rectangles should start.
Default 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function contains code or pieces of code
from <code>breakDown</code> code created by Przemys≈Çaw Biecek
and <code>xgboostExplainer</code> code created by David Foster.
</p>


<h3>Value</h3>

<p>an object of the broken class
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library("EIX")
library("Matrix")
sm &lt;- sparse.model.matrix(left ~ . - 1,  data = HR_data)

library("xgboost")
param &lt;- list(objective = "binary:logistic", max_depth = 2)
xgb_model &lt;- xgboost(sm, params = param, label = HR_data[, left] == 1, nrounds = 25, verbose=0)

data &lt;- HR_data[9,-7]
new_observation &lt;- sm[9,]

wf &lt;- waterfall(xgb_model, new_observation, data,  option = "interactions")
wf

plot(wf)


</code></pre>


</div>