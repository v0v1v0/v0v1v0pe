<div class="container">

<table style="width: 100%;"><tr>
<td>JohnsonSB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Johnson SB distribution.</h2>

<h3>Description</h3>

<p>Density, distribution, quantile, random number
generation, and parameter estimation functions for the Johnson SB (bounded support) distribution.
Parameter estimation can be based on a weighted or unweighted i.i.d. sample and can be performed numerically.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dJohnsonSB(
  x,
  gamma = -0.5,
  delta = 2,
  xi = -0.5,
  lambda = 2,
  params = list(gamma = -0.5, delta = 2, xi = -0.5, lambda = 2),
  ...
)

dJohnsonSB_ab(
  x,
  gamma = -0.5,
  delta = 2,
  a = -0.5,
  b = 1.5,
  params = list(gamma = -0.5, delta = 2, a = -0.5, b = 1.5),
  ...
)

pJohnsonSB(
  q,
  gamma = -0.5,
  delta = 2,
  xi = -0.5,
  lambda = 2,
  params = list(gamma = -0.5, delta = 2, xi = -0.5, lambda = 2),
  ...
)

qJohnsonSB(
  p,
  gamma = -0.5,
  delta = 2,
  xi = -0.5,
  lambda = 2,
  params = list(gamma = -0.5, delta = 2, xi = -0.5, lambda = 2),
  ...
)

rJohnsonSB(
  n,
  gamma = -0.5,
  delta = 2,
  xi = -0.5,
  lambda = 2,
  params = list(gamma = -0.5, delta = 2, xi = -0.5, lambda = 2),
  ...
)

eJohnsonSB(X, w, method = "numerical.MLE", ...)

lJohnsonSB(
  X,
  w,
  gamma = -0.5,
  delta = 2,
  xi = -0.5,
  lambda = 2,
  params = list(gamma = -0.5, delta = 2, xi = -0.5, lambda = 2),
  logL = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>A vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma, delta</code></td>
<td>
<p>Shape parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi, lambda, a, b</code></td>
<td>
<p>Location-scale parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A list that includes all named parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Sample observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>An optional vector of sample weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Parameter estimation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>logical, it is assumed that the log-likelihood is desired. Set to FALSE if the likelihood is wanted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Johnson system of distributions consists of families of distributions that, through specified transformations, can be
reduced to the standard normal random variable. It provides a very flexible system for describing statistical distributions
and is defined by
</p>
<p style="text-align: center;"><code class="reqn">z = \gamma + \delta f(Y)</code>
</p>

<p>with <code class="reqn">Y = (X-xi)/lambda</code>. The Johnson SB distribution arises when <code class="reqn">f(Y) = ln[Y/(1-Y)]</code>, where <code class="reqn">0 &lt; Y &lt; 1</code>.
This is the bounded Johnson family since the range of Y is <code class="reqn">(0,1)</code>, Karian &amp; Dudewicz (2011).<br><br>
The <code>dJohnsonSB()</code>, <code>pJohnsonSB()</code>, <code>qJohnsonSB()</code>,and <code>rJohnsonSB()</code> functions serve as wrappers of the
<code>dJohnson</code>, <code>pJohnson</code>, <code>qJohnson</code>, and
<code>rJohnson</code> functions in the <span class="pkg">SuppDists</span> package. They allow for the parameters to be declared not only as
individual numerical values, but also as a list so parameter estimation can be carried out. <br><br>
The JohnsonSB distribution has probability density function
</p>
<p style="text-align: center;"><code class="reqn">p_X(x) = \frac{\delta lambda}{\sqrt{2\pi}(x-xi)(1- x + xi)}exp[-0.5(\gamma + \delta ln((x-xi)/(1-x+xi)))^2].</code>
</p>



<h3>Value</h3>

<p>dJohnsonSB gives the density, pJohnsonSB the distribution function,
qJohnsonSB gives quantile function, rJohnsonSB generates random deviates, and
eJohnsonSB estimate the parameters. lJohnsonSB provides the log-likelihood function. The dJohnsonSB_ab provides
an alternative parameterisation of the JohnsonSB distribution.
</p>


<h3>Author(s)</h3>

<p>Haizhen Wu and A. Jonathan R. Godfrey.<br>
Updates and bug fixes by Sarah Pirikahu.
</p>


<h3>References</h3>

<p>Johnson, N. L., Kotz, S. and Balakrishnan, N. (1994) Continuous Univariate Distributions,
volume 1, chapter 12, Wiley, New York.<br><br>
Kotz, S. and van Dorp, J. R. (2004). Beyond Beta: Other Continuous
Families of Distributions with Bounded Support and Applications. Appendix B.
World Scientific: Singapore.<br><br>
Z. A. Karian and E. J. Dudewicz (2011) Handbook of Fitting Statistical Distributions with R, Chapman &amp; Hall.<br></p>


<h3>See Also</h3>

<p><span class="pkg">ExtDist</span> for other standard distributions.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Parameter estimation for a distribution with known shape parameters
X &lt;- rJohnsonSB(n=500, gamma=-0.5, delta=2, xi=-0.5, lambda=2)
est.par &lt;- eJohnsonSB(X); est.par
plot(est.par)

#  Fitted density curve and histogram
den.x &lt;- seq(min(X),max(X),length=100)
den.y &lt;- dJohnsonSB(den.x,params = est.par)
hist(X, breaks=10, probability=TRUE, ylim = c(0,1.2*max(den.y)))
lines(den.x, den.y, col="blue")
lines(density(X))

# Extracting location, scale and shape parameters
est.par[attributes(est.par)$par.type=="location"]
est.par[attributes(est.par)$par.type=="scale"]
est.par[attributes(est.par)$par.type=="shape"]

# Parameter Estimation for a distribution with unknown shape parameters
# Example from Karian, Z.A and Dudewicz, E.J. (2011) p.647.
# Original source of brain scan data Dudewich, E.J et.al (1989).
# Parameter estimates as given by Karian &amp; Dudewicz using moments are:
# gamma =-0.2081, delta=0.9167, xi = 95.1280 and lambda = 21.4607 with log-likelihood = -67.03579
brain &lt;- c(108.7, 107.0, 110.3, 110.0, 113.6, 99.2, 109.8, 104.5, 108.1, 107.2, 112.0, 115.5, 108.4,
           107.4, 113.4, 101.2, 98.4, 100.9, 100.0, 107.1, 108.7, 102.5, 103.3)
est.par &lt;- eJohnsonSB(brain); est.par

# Estimates calculated by eJohnsonSB differ from those given by Karian &amp; Dudewicz (2011).
# However, eJohnsonSB's parameter estimates appear to be an improvement, due to a larger
# log-likelihood of -66.35496 (as given by lJohnsonSB below).

# log-likelihood function
lJohnsonSB(brain, param = est.par)
</code></pre>


</div>