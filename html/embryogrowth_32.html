<div class="container">

<table style="width: 100%;"><tr>
<td>MovingIncubation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate incubation of a nest with the beginning of incubation varying</h2>

<h3>Description</h3>

<p>Simulate incubation of a nest with the beginning varying day by day<br>
Temperatures must be in a data.frame with one column (Time) being the time and the second the temperatures (Temperature). A third columns can indicate the temperature at the end of incubation (Temperature.end.incubation). Do not use FormatNests() for this dataframe.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MovingIncubation(
  NestsResult = NULL,
  resultmcmc = NULL,
  GTRN.CI = "Hessian",
  tsd = NULL,
  tsd.CI = NULL,
  tsd.mcmc = NULL,
  SexualisationTRN = NULL,
  SexualisationTRN.CI = "Hessian",
  SexualisationTRN.mcmc = NULL,
  temperatures.df = stop("A data.frame must be provided"),
  temperature.heterogeneity = 0,
  metabolic.heating = 0,
  average.incubation.duration = 60 * 1440,
  max.time = 100 * 24 * 60,
  skip = 1,
  parameters = NULL,
  fixed.parameters = NULL,
  SE = NULL,
  hessian = NULL,
  integral = NULL,
  derivate = NULL,
  hatchling.metric = NULL,
  M0 = NULL,
  embryo.stages = "Caretta caretta.SCL",
  TSP.borders = c(21, 26),
  TSP.begin = 0,
  TSP.end = 0.5,
  replicate.CI = 1,
  parallel = TRUE,
  progressbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>NestsResult</code></td>
<td>
<p>A result file generated by searchR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resultmcmc</code></td>
<td>
<p>A mcmc result. Will be used rather than SE if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GTRN.CI</code></td>
<td>
<p>How to estimate CI for embryo growth thermal reaction norm; can be NULL, "SE", "MCMC", "pseudohessianfrommcmc" or "Hessian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsd</code></td>
<td>
<p>A object from tsd() that describe the thermal react norm of sex ratio at constant temperatures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsd.CI</code></td>
<td>
<p>How to estimate CI for sex ratio thermal reaction norm; Can be NULL, "SE", "MCMC", "pseudohessianfrommcmc" or "Hessian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsd.mcmc</code></td>
<td>
<p>A object from tsd_MHmcmc()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SexualisationTRN</code></td>
<td>
<p>A model for sexualisation thermal reaction norm during TSP obtained using STRN()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SexualisationTRN.CI</code></td>
<td>
<p>How to estimate CI of sexualisation thermal reaction norm. Can be NULL, "SE", "MCMC", "pseudohessianfrommcmc" or "Hessian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SexualisationTRN.mcmc</code></td>
<td>
<p>MCMC object for STRN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperatures.df</code></td>
<td>
<p>A data.frame with 2 or 3 columns: Times, Temperatures and Temperatures.end.incubation (facultative)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperature.heterogeneity</code></td>
<td>
<p>SD of heterogeneity of temperatures. Can be 2 values, sd_low and sd_high and then HelpersMG::r2norm() is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metabolic.heating</code></td>
<td>
<p>Degrees Celsius to be added at the end of incubation due to metabolic heating</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average.incubation.duration</code></td>
<td>
<p>The average time to complete incubation (not used if metabolic heating is setup)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.time</code></td>
<td>
<p>Maximum time of incubation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>Number of data to skip between two runs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A set of parameters if result is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.parameters</code></td>
<td>
<p>Another set of parameters if result is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Standard error for each parameter if not present in result is not provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>A hessian matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivate</code></td>
<td>
<p>Function used to fit embryo growth: dydt.Gompertz, dydt.exponential or dydt.linear. It will replace the one in NestsResult.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatchling.metric</code></td>
<td>
<p>Mean and SD of size of hatchlings as a vector ie hatchling.metric=c(Mean=xx, SD=yy)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M0</code></td>
<td>
<p>Measure of hatchling size proxi at laying date</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embryo.stages</code></td>
<td>
<p>The embryo stages. At least TSP.borders stages must be provided to estimate TSP length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSP.borders</code></td>
<td>
<p>The limits of TSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSP.begin</code></td>
<td>
<p>Where TSP begin during the stage of beginning? In relative proportion of the stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSP.end</code></td>
<td>
<p>Where TSP begin during the stage of ending? In relative proportion of the stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicate.CI</code></td>
<td>
<p>Number of randomizations to estimate CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Should parallel computing be used. TRUE or FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>Should a progress bar be shown ? TRUE or FALSE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>MovingIncubation simulate incubation of a nest with the beginning varying day by day
</p>


<h3>Value</h3>

<p>A dataframe with informations about thermosensitive period length and incubation length day by day of incubation
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
ti &lt;- seq(from=0, to=(60*24*100), by=60)
temperatures &lt;- rnorm(length(ti), 29, 5)
temperatures &lt;- temperatures+ti/(60*24*100)/2
layout(mat=1:3)
parpre &lt;- par(mar=c(4, 4, 1, 1)+0.4)
plot(ti/(60*24), temperatures, type="l", xlab="Days", 
     ylab=expression("Nest temperature in "*degree*"C"), bty="n", las=1)
# The sexualisation thermal reaction norm is calculated for South Pacific RMU
out &lt;- MovingIncubation(NestsResult=resultNest_4p_SSM, 
     temperatures.df=data.frame(Time=ti, Temperature=temperatures),
     metabolic.heating = 0, 
     SexualisationTRN = structure(c(71.922411148397, 613.773055147801, 
     318.059753164125, 120.327257089974), 
     .Names = c("DHA", "DHH", "T12H", "Rho25")))
with(out, plot(Time/(60*24), Incubation.length.mean/(60*24), 
     xlab="Days along the season", 
     ylab="Incubation duration", 
     type="l", bty="n", las=1, ylim=c(70, 80)))
with(out, plot(Time/(60*24), TSP.GrowthWeighted.STRNWeighted.temperature.mean, 
     xlab="Days along the season", 
     ylab=expression("CTE for sex ratio in "*degree*"C"), 
      type="l", bty="n", las=1, ylim=c(30, 31)))
par(mar=parpre)
layout(mat=c(1))

## End(Not run)
</code></pre>


</div>