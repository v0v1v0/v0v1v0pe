<div class="container">

<table style="width: 100%;"><tr>
<td>elnormCensored</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Parameters for a Lognormal Distribution (Log-Scale) Based on Type I Censored Data
</h2>

<h3>Description</h3>

<p>Estimate the mean and standard deviation parameters of the logarithm of a
lognormal distribution given a
sample of data that has been subjected to Type I censoring,
and optionally construct a confidence interval for the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  elnormCensored(x, censored, method = "mle", censoring.side = "left",
    ci = FALSE, ci.method = "profile.likelihood", ci.type = "two-sided",
    conf.level = 0.95, n.bootstraps = 1000, pivot.statistic = "z",
    nmc = 1000, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censored</code></td>
<td>

<p>numeric or logical vector indicating which values of <code>x</code> are censored.
This must be the same length as <code>x</code>.  If the mode of <code>censored</code> is
<code>"logical"</code>, <code>TRUE</code> values correspond to elements of <code>x</code> that
are censored, and <code>FALSE</code> values correspond to elements of <code>x</code> that
are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to
<code>TRUE</code> and <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>)
values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimation.
</p>
<p>For singly censored data, the possible values are:  <br><code>"mle"</code> (maximum likelihood; the default), <br><code>"bcmle"</code> (bias-corrected maximum likelihood), <br><code>"ROS"</code> or <code>"qq.reg"</code> (quantile-quantile regression; also called
<em>regression on order statistics</em> and abbreviated ROS), <br><code>"qq.reg.w.cen.level"</code> (quantile-quantile regression including the
censoring level), <br><code>"rROS"</code> or <code>"impute.w.qq.reg"</code> (moment estimation based on imputation using
quantile-quantile regression; also called <em>robust regression on order statistics</em>
and abbreviated rROS), <br><code>"impute.w.qq.reg.w.cen.level"</code> (moment estimation based on imputation
using the <code>qq.reg.w.cen.level</code> method), <br><code>"impute.w.mle"</code> (moment estimation based on imputation using the mle), <br><code>"iterative.impute.w.qq.reg"</code> (moment estimation based on iterative
imputation using the <code>qq.reg</code> method), <br><code>"m.est"</code> (robust M-estimation), and <br><code>"half.cen.level"</code> (moment estimation based on setting the censored
observations to half the censoring level).
</p>
<p>For multiply censored data, the possible values are:  <br><code>"mle"</code> (maximum likelihood; the default), <br><code>"ROS"</code> or <code>"qq.reg"</code> (quantile-quantile regression; also called
<em>regression on order statistics</em> and abbreviated ROS), <br><code>"rROS"</code> or <code>"impute.w.qq.reg"</code> (moment estimation based on imputation using
quantile-quantile regression; also called <em>robust regression on order statistics</em>
and abbreviated rROS), and <br><code>"half.cen.level"</code> (moment estimation based on setting the censored
observations to half the censoring level).
</p>
<p>See the DETAILS section for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring.side</code></td>
<td>

<p>character string indicating on which side the censoring occurs.  The possible
values are <code>"left"</code> (the default) and <code>"right"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the
mean or variance.  The default value is <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>character string indicating what method to use to construct the confidence interval
for the mean.  The possible values are: <br><code>"profile.likelihood"</code> (profile likelihood; the default), <br><code>"normal.approx"</code> (normal approximation), <br><code>"normal.approx.w.cov"</code> (normal approximation taking into account the
covariance between the estimated mean and standard deviation; only available for
singly censored data), <br><code>"gpq"</code> (generalized pivotal quantity), and <br><code>"bootstrap"</code> (based on bootstrapping).
</p>
<p>See the DETAILS section for more information.
This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>

<p>character string indicating what kind of confidence interval to compute.  The
possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
<code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
The default value is <code>conf.level=0.95</code>. This argument is ignored if
<code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bootstraps</code></td>
<td>

<p>numeric scalar indicating how many bootstraps to use to construct the
confidence interval for the mean when <code>ci.type="bootstrap"</code>.  This
argument is ignored if <code>ci=FALSE</code> and/or <code>ci.method</code> does not
equal <code>"bootstrap"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivot.statistic</code></td>
<td>

<p>character string indicating which pivot statistic to use in the construction
of the confidence interval for the mean when <code>ci.method="normal.approx"</code> or
<code>ci.method="normal.approx.w.cov"</code> (see the DETAILS section).  The possible
values are <code>pivot.statistic="z"</code> (the default) and <code>pivot.statistic="t"</code>.
When <code>pivot.statistic="t"</code> you may supply the argument
<code>ci.sample size</code> (see below).  The argument <code>pivot.statistic</code> is
ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmc</code></td>
<td>

<p>numeric scalar indicating the number of Monte Carlo simulations to run when
<code>ci.method="gpq"</code>.  The default is <code>nmc=1000</code>.  This argument is ignored if <br><code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>integer supplied to the function <code>set.seed</code> and used when <br><code>ci.method="bootstrap"</code> or <code>ci.method="gpq"</code>.  The default value is
<code>seed=NULL</code>, in which case the current value of <code>.Random.seed</code> is used.
This argument is ignored when <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to pass to other functions.
</p>

<ul>
<li> <p><code>prob.method</code>.  Character string indicating what method to use to
compute the plotting positions (empirical probabilities) when <code>method</code>
is one of <code>"ROS"</code>, <code>"qq.reg"</code>, <code>"qq.reg.w.cen.level"</code>,
<code>"rROS"</code>, <code>"impute.w.qq.reg"</code>,
<code>"impute.w.qq.reg.w.cen.level"</code>, <code>"impute.w.mle"</code>, or <br><code>"iterative.impute.w.qq.reg"</code>.  Possible values are: <br><code>"kaplan-meier"</code> (product-limit method of Kaplan and Meier (1958)), <br><code>"nelson"</code> (hazard plotting method of Nelson (1972)), <br><code>"michael-schucany"</code> (generalization of the product-limit method due to Michael and Schucany (1986)), and <br><code>"hirsch-stedinger"</code> (generalization of the product-limit method due to Hirsch and Stedinger (1987)). <br>
The default value is <code>prob.method="hirsch-stedinger"</code>.  The <code>"nelson"</code>
method is only available for <code>censoring.side="right"</code>.
See the DETAILS section and the help file for <code>ppointsCensored</code>
for more information.
</p>
</li>
<li> <p><code>plot.pos.con</code>.  Numeric scalar between 0 and 1 containing the
value of the plotting position constant to use when <code>method</code> is one of
<code>"qq.reg"</code>, <code>"qq.reg.w.cen.level"</code>, <code>"impute.w.qq.reg"</code>, <br><code>"impute.w.qq.reg.w.cen.level"</code>, <code>"impute.w.mle"</code>, or <br><code>"iterative.impute.w.qq.reg"</code>.  The default value is <code>plot.pos.con=0.375</code>.
See the DETAILS section and the help file for <code>ppointsCensored</code>
for more information.
</p>
</li>
<li> <p><code>ci.sample.size</code>.  Numeric scalar indicating what sample size to
assume to construct the confidence interval for the mean if
<code>pivot.statistic="t"</code> and <code>ci.method="normal.approx"</code> or
<code>ci.method="normal.approx.w.cov"</code>.  When <code>method</code> equals
<code>"mle"</code> or <code>"bcmle"</code>, the default value is the expected number of
uncensored observations, otherwise it is the observed number of
uncensored observations.
</p>
</li>
<li> <p><code>lb.impute</code>.  Numeric scalar indicating the lower bound for imputed
observations when method is one of <code>"impute.w.qq.reg"</code>, <br><code>"impute.w.qq.reg.w.cen.level"</code>, <code>"impute.w.mle"</code>, or <br><code>"iterative.impute.w.qq.reg"</code>.  Imputed values smaller than this
value will be set to this value.  The default is <code>lb.impute=-Inf</code>.
</p>
</li>
<li> <p><code>ub.impute</code>.  Numeric scalar indicating the upper bound for imputed
observations when method is one of <code>"impute.w.qq.reg"</code>, <br><code>"impute.w.qq.reg.w.cen.level"</code>, <code>"impute.w.mle"</code>, or <br><code>"iterative.impute.w.qq.reg"</code>.  Imputed values larger than this value
will be set to this value.  The default is <code>ub.impute=Inf</code>.
</p>
</li>
<li> <p><code>convergence</code>.  Character string indicating the kind of convergence
criterion when <code>method="iterative.impute.w.qq.reg"</code>.  The possible values
are <code>"relative"</code> (the default) and <code>"absolute"</code>.  See the DETAILS
section for more information.
</p>
</li>
<li> <p><code>tol</code>.  Numeric scalar indicating the convergence tolerance when <br><code>method="iterative.impute.w.qq.reg"</code>.  The default value is <code>tol=1e-6</code>.
If <code>convergence="relative"</code>, then the relative difference in the old and
new estimates of the mean and the relative difference in the old and new estimates
of the standard deviation must be less than <code>tol</code> for convergence to be
achieved.  If <code>convergence="absolute"</code>, then the absolute difference in the
old and new estimates of the mean and the absolute difference in the old and new
estimates of the standard deviation must be less than <code>tol</code> for convergence
to be achieved.
</p>
</li>
<li> <p><code>max.iter</code>.  Numeric scalar indicating the maximum number of iterations
when <code>method="iterative.impute.w.qq.reg"</code>.
</p>
</li>
<li> <p><code>t.df</code>.  Numeric scalar greater than or equal to 1 that determines the
robustness and efficiency properties of the estimator when <code>method="m.est"</code>.
The default value is <code>t.df=3</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> or <code>censored</code> contain any missing (<code>NA</code>), undefined (<code>NaN</code>) or
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to
performing the estimation.
</p>
<p>Let <code class="reqn">X</code> denote a random variable with a
lognormal distribution with
parameters <code>meanlog=</code><code class="reqn">\mu</code> and <code>sdlog=</code><code class="reqn">\sigma</code>.  Then
<code class="reqn">Y = log(X)</code> has a normal (Gaussian) distribution with
parameters <code>mean=</code><code class="reqn">\mu</code> and <code>sd=</code><code class="reqn">\sigma</code>.  Thus, the function
<code>elnormCensored</code> simply calls the function <code>enormCensored</code> using the
log-transformed values of <code>x</code>.
</p>


<h3>Value</h3>

<p>a list of class <code>"estimateCensored"</code> containing the estimated parameters
and other information.  See <code>estimateCensored.object</code> for details.
</p>


<h3>Note</h3>

<p>A sample of data contains censored observations if some of the observations are
reported only as being below or above some censoring level.  In environmental
data analysis, Type I left-censored data sets are common, with values being
reported as “less than the detection limit” (e.g., Helsel, 2012).  Data
sets with only one censoring level are called <em>singly censored</em>; data sets with
multiple censoring levels are called <em>multiply</em> or <em>progressively censored</em>.
</p>
<p>Statistical methods for dealing with censored data sets have a long history in the
field of survival analysis and life testing.  More recently, researchers in the
environmental field have proposed alternative methods of computing estimates and
confidence intervals in addition to the classical ones such as maximum likelihood
estimation.
</p>
<p>Helsel (2012, Chapter 6) gives an excellent review of past studies of the
properties of various estimators based on censored environmental data.
</p>
<p>In practice, it is better to use a confidence interval for the mean or a
joint confidence region for the mean and standard deviation, rather than rely on a
single point-estimate of the mean.  Since confidence intervals and regions depend
on the properties of the estimators for both the mean and standard deviation, the
results of studies that simply evaluated the performance of the mean and standard
deviation separately cannot be readily extrapolated to predict the performance of
various methods of constructing confidence intervals and regions.  Furthermore,
for several of the methods that have been proposed to estimate the mean based on
type I left-censored data, standard errors of the estimates are not available,
hence it is not possible to construct confidence intervals
(El-Shaarawi and Dolan, 1989).
</p>
<p>Few studies have been done to evaluate the performance of methods for constructing
confidence intervals for the mean or joint confidence regions for the mean and
standard deviation when data are subjected to single or multiple censoring.
See, for example, Singh et al. (2006).
</p>
<p>Schmee et al. (1985) studied Type II censoring for a normal distribution and
noted that the bias and variances of the maximum likelihood estimators are of the
order <code class="reqn">1/N</code>, and that the bias is negligible for <code class="reqn">N=100</code> and as much as
90% censoring.  (If the proportion of censored observations is less than 90%,
the bias becomes negligible for smaller sample sizes.)  For small samples with
moderate to high censoring, however, the bias of the mle's causes confidence
intervals based on them using a normal approximation (e.g., <code>method="mle"</code>
and <code>ci.method="normal.approx"</code>) to be too short.  Schmee et al. (1985)
provide tables for exact confidence intervals for sample sizes up to <code class="reqn">N=100</code>
that were created based on Monte Carlo simulation.  Schmee et al. (1985) state
that these tables should work well for Type I censored data as well.
</p>
<p>Shumway et al. (1989) evaluated the coverage of 90% confidence intervals for the
mean based on using a Box-Cox transformation to induce normality, computing the
mle's based on the normal distribution, then computing the mean in the original
scale.  They considered three methods of constructing confidence intervals:  the
delta method, the bootstrap, and the bias-corrected bootstrap.
Shumway et al. (1989) used three parent distributions in their study:
Normal(3,1), the square of this distribuiton, and the exponentiation of this
distribution (i.e., a lognormal distribution).  Based on sample sizes of 10 and 50
with a censoring level at the 10'th or 20'th percentile, Shumway et al. (1989)
found that the delta method performed quite well and was superior to the
bootstrap method.
</p>
<p>Millard et al. (2014; in preparation) show that the coverage of profile likelihood
method is excellent.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Bain, L.J., and M. Engelhardt. (1991).  <em>Statistical Analysis of
Reliability and Life-Testing Models</em>.  Marcel Dekker, New York, 496pp.
</p>
<p>Cohen, A.C. (1959).  Simplified Estimators for the Normal Distribution When
Samples are Singly Censored or Truncated.  <em>Technometrics</em> <b>1</b>(3), 217–237.
</p>
<p>Cohen, A.C. (1963).  Progressively Censored Samples in Life Testing.
<em>Technometrics</em> <b>5</b>, 327–339
</p>
<p>Cohen, A.C. (1991).  <em>Truncated and Censored Samples</em>.  Marcel Dekker,
New York, New York, 312pp.
</p>
<p>Cox, D.R. (1970).  <em>Analysis of Binary Data</em>.  Chapman &amp; Hall, London.  142pp.
</p>
<p>Efron, B. (1979).  Bootstrap Methods: Another Look at the Jackknife.
<em>The Annals of Statistics</em> <b>7</b>, 1–26.
</p>
<p>Efron, B., and R.J. Tibshirani. (1993).  <em>An Introduction to the Bootstrap</em>.
Chapman and Hall, New York, 436pp.
</p>
<p>El-Shaarawi, A.H. (1989).  Inferences About the Mean from Censored Water Quality
Data.  <em>Water Resources Research</em> <b>25</b>(4) 685–690.
</p>
<p>El-Shaarawi, A.H., and D.M. Dolan. (1989).  Maximum Likelihood Estimation of
Water Quality Concentrations from Censored Data.
<em>Canadian Journal of Fisheries and Aquatic Sciences</em> <b>46</b>, 1033–1039.
</p>
<p>El-Shaarawi, A.H., and S.R. Esterby. (1992).  Replacement of Censored Observations
by a Constant: An Evaluation.  <em>Water Research</em> <b>26</b>(6), 835–844.
</p>
<p>El-Shaarawi, A.H., and A. Naderi. (1991).  Statistical Inference from Multiply
Censored Environmental Data.
<em>Environmental Monitoring and Assessment</em> <b>17</b>, 339–347.
</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
John Wiley &amp; Sons, Hoboken.
</p>
<p>Gilliom, R.J., and D.R. Helsel. (1986).  Estimation of Distributional Parameters for
Censored Trace Level Water Quality Data: 1. Estimation Techniques.
<em>Water Resources Research</em> <b>22</b>, 135–146.
</p>
<p>Gleit, A. (1985).  Estimation for Small Normal Data Sets with Detection Limits.
<em>Environmental Science and Technology</em> <b>19</b>, 1201–1206.
</p>
<p>Haas, C.N., and P.A. Scheff. (1990).  Estimation of Averages in Truncated Samples.
<em>Environmental Science and Technology</em> <b>24</b>(6), 912–919.
</p>
<p>Hashimoto, L.K., and R.R. Trussell. (1983).  Evaluating Water Quality Data Near
the Detection Limit.  Paper presented at the Advanced Technology Conference,
American Water Works Association, Las Vegas, Nevada, June 5-9, 1983.
</p>
<p>Helsel, D.R. (1990).  Less than Obvious: Statistical Treatment of Data Below the
Detection Limit.  <em>Environmental Science and Technology</em> <b>24</b>(12),
1766–1774.
</p>
<p>Helsel, D.R. (2012). <em>Statistics for Censored Environmental Data Using Minitab and R,
Second Edition</em>.  John Wiley &amp; Sons, Hoboken, New Jersey.
</p>
<p>Helsel, D.R., and T.A. Cohn. (1988).  Estimation of Descriptive Statistics for
Multiply Censored Water Quality Data.  <em>Water Resources Research</em>
<b>24</b>(12), 1997–2004.
</p>
<p>Hirsch, R.M., and J.R. Stedinger. (1987).  Plotting Positions for Historical
Floods and Their Precision.  <em>Water Resources Research</em> <b>23</b>(4), 715–727.
</p>
<p>Korn, L.R., and D.E. Tyler. (2001).  Robust Estimation for Chemical Concentration
Data Subject to Detection Limits.  In Fernholz, L., S. Morgenthaler, and W. Stahel,
eds.  <em>Statistics in Genetics and in the Environmental Sciences</em>.
Birkhauser Verlag, Basel, pp.41–63.
</p>
<p>Krishnamoorthy K., and T. Mathew. (2009).
<em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>.
John Wiley and Sons, Hoboken.
</p>
<p>Michael, J.R., and W.R. Schucany. (1986).  Analysis of Data from Censored Samples.
In D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
Marcel Dekker, New York, 560pp, Chapter 11, 461–496.
</p>
<p>Millard, S.P., P. Dixon, and N.K. Neerchal. (2014; in preparation).
<em>Environmental Statistics with R</em>.  CRC Press, Boca Raton, Florida.
</p>
<p>Nelson, W. (1982).  <em>Applied Life Data Analysis</em>.
John Wiley and Sons, New York, 634pp.
</p>
<p>Newman, M.C., P.M. Dixon, B.B. Looney, and J.E. Pinder. (1989).  Estimating Mean
and Variance for Environmental Samples with Below Detection Limit Observations.
<em>Water Resources Bulletin</em> <b>25</b>(4), 905–916.
</p>
<p>Pettitt, A. N. (1983).  Re-Weighted Least Squares Estimation with Censored and
Grouped Data: An Application of the EM Algorithm.
<em>Journal of the Royal Statistical Society, Series B</em> <b>47</b>, 253–260.
</p>
<p>Regal, R. (1982).  Applying Order Statistic Censored Normal Confidence Intervals
to Time Censored Data.  Unpublished manuscript, University of Minnesota, Duluth,
Department of Mathematical Sciences.
</p>
<p>Royston, P. (2007).  Profile Likelihood for Estimation and Confdence Intervals.
<em>The Stata Journal</em> <b>7</b>(3), pp. 376–387.
</p>
<p>Saw, J.G. (1961b).  The Bias of the Maximum Likelihood Estimators of Location and
Scale Parameters Given a Type II Censored Normal Sample.
<em>Biometrika</em> <b>48</b>, 448–451.
</p>
<p>Schmee, J., D.Gladstein, and W. Nelson. (1985).  Confidence Limits for Parameters
of a Normal Distribution from Singly Censored Samples, Using Maximum Likelihood.
<em>Technometrics</em> <b>27</b>(2) 119–128.
</p>
<p>Schneider, H. (1986).  <em>Truncated and Censored Samples from Normal Populations</em>.
Marcel Dekker, New York, New York, 273pp.
</p>
<p>Shumway, R.H., A.S. Azari, and P. Johnson. (1989).  Estimating Mean Concentrations
Under Transformations for Environmental Data With Detection Limits.
<em>Technometrics</em> <b>31</b>(3), 347–356.
</p>
<p>Singh, A., R. Maichle, and S. Lee. (2006).  <em>On the Computation of a 95%
Upper Confidence Limit of the Unknown Population Mean Based Upon Data Sets
with Below Detection Limit Observations</em>.  EPA/600/R-06/022, March 2006.
Office of Research and Development, U.S. Environmental Protection Agency,
Washington, D.C.
</p>
<p>Stryhn, H., and J. Christensen. (2003).  <em>Confidence Intervals by the Profile
Likelihood Method, with Applications in Veterinary Epidemiology</em>.  Contributed paper
at ISVEE X (November 2003, Chile).
<a href="https://gilvanguedes.com/wp-content/uploads/2019/05/Profile-Likelihood-CI.pdf">https://gilvanguedes.com/wp-content/uploads/2019/05/Profile-Likelihood-CI.pdf</a>.
</p>
<p>Travis, C.C., and M.L. Land. (1990).  Estimating the Mean of Data Sets with
Nondetectable Values.  <em>Environmental Science and Technology</em> <b>24</b>, 961–962.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
U.S. Environmental Protection Agency, Washington, D.C. Chapter 15.
</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>
<p>Venzon, D.J., and S.H. Moolgavkar. (1988).  A Method for Computing
Profile-Likelihood-Based Confidence Intervals.  <em>Journal of the Royal
Statistical Society, Series C (Applied Statistics)</em> <b>37</b>(1), pp. 87–94.
</p>


<h3>See Also</h3>

<p><code>enormCensored</code>, Lognormal, <code>elnorm</code>,
<code>estimateCensored.object</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Chapter 15 of USEPA (2009) gives several examples of estimating the mean
  # and standard deviation of a lognormal distribution on the log-scale using
  # manganese concentrations (ppb) in groundwater at five background wells.
  # In EnvStats these data are stored in the data frame
  # EPA.09.Ex.15.1.manganese.df.

  # Here we will estimate the mean and standard deviation using the MLE,
  # Q-Q regression (also called parametric regression on order statistics
  # or ROS; e.g., USEPA, 2009 and Helsel, 2012), and imputation with Q-Q
  # regression (also called robust ROS or rROS).

  # First look at the data:
  #-----------------------

  EPA.09.Ex.15.1.manganese.df

  #   Sample   Well Manganese.Orig.ppb Manganese.ppb Censored
  #1       1 Well.1                 &lt;5           5.0     TRUE
  #2       2 Well.1               12.1          12.1    FALSE
  #3       3 Well.1               16.9          16.9    FALSE
  #...
  #23      3 Well.5                3.3           3.3    FALSE
  #24      4 Well.5                8.4           8.4    FALSE
  #25      5 Well.5                 &lt;2           2.0     TRUE

  longToWide(EPA.09.Ex.15.1.manganese.df,
    "Manganese.Orig.ppb", "Sample", "Well",
    paste.row.name = TRUE)

  #         Well.1 Well.2 Well.3 Well.4 Well.5
  #Sample.1     &lt;5     &lt;5     &lt;5    6.3   17.9
  #Sample.2   12.1    7.7    5.3   11.9   22.7
  #Sample.3   16.9   53.6   12.6     10    3.3
  #Sample.4   21.6    9.5  106.3     &lt;2    8.4
  #Sample.5     &lt;2   45.9   34.5   77.2     &lt;2


  # Now estimate the mean and standard deviation on the log-scale
  # using the MLE:
  #---------------------------------------------------------------

  with(EPA.09.Ex.15.1.manganese.df,
    elnormCensored(Manganese.ppb, Censored))

  #Results of Distribution Parameter Estimation
  #Based on Type I Censored Data
  #--------------------------------------------
  #
  #Assumed Distribution:            Lognormal
  #
  #Censoring Side:                  left
  #
  #Censoring Level(s):              2 5
  #
  #Estimated Parameter(s):          meanlog = 2.215905
  #                                 sdlog   = 1.356291
  #
  #Estimation Method:               MLE
  #
  #Data:                            Manganese.ppb
  #
  #Censoring Variable:              Censored
  #
  #Sample Size:                     25
  #
  #Percent Censored:                24%

  # Now compare the MLE with the estimators based on
  # Q-Q regression (ROS) and imputation with Q-Q regression (rROS)
  #---------------------------------------------------------------

  with(EPA.09.Ex.15.1.manganese.df,
    elnormCensored(Manganese.ppb, Censored))$parameters
  # meanlog    sdlog
  #2.215905 1.356291

  with(EPA.09.Ex.15.1.manganese.df,
    elnormCensored(Manganese.ppb, Censored,
    method = "ROS"))$parameters
  # meanlog    sdlog
  #2.293742 1.283635

  with(EPA.09.Ex.15.1.manganese.df,
    elnormCensored(Manganese.ppb, Censored,
    method = "rROS"))$parameters
  # meanlog    sdlog
  #2.298656 1.238104

  #----------

  # The method used to estimate quantiles for a Q-Q plot is
  # determined by the argument prob.method.  For the functions
  # enormCensored and elnormCensored, for any estimation
  # method that involves Q-Q regression, the default value of
  # prob.method is "hirsch-stedinger" and the default value for the
  # plotting position constant is plot.pos.con=0.375.

  # Both Helsel (2012) and USEPA (2009) also use the Hirsch-Stedinger
  # probability method but set the plotting position constant to 0.

  with(EPA.09.Ex.15.1.manganese.df,
    elnormCensored(Manganese.ppb, Censored,
    method = "rROS", plot.pos.con = 0))$parameters
  # meanlog    sdlog
  #2.277175 1.261431

  #----------

  # Using the same data as above, compute a confidence interval
  # for the mean on the log-scale using the profile-likelihood
  # method.

  with(EPA.09.Ex.15.1.manganese.df,
    elnormCensored(Manganese.ppb, Censored, ci = TRUE))

  #Results of Distribution Parameter Estimation
  #Based on Type I Censored Data
  #--------------------------------------------
  #
  #Assumed Distribution:            Lognormal
  #
  #Censoring Side:                  left
  #
  #Censoring Level(s):              2 5
  #
  #Estimated Parameter(s):          meanlog = 2.215905
  #                                 sdlog   = 1.356291
  #
  #Estimation Method:               MLE
  #
  #Data:                            Manganese.ppb
  #
  #Censoring Variable:              Censored
  #
  #Sample Size:                     25
  #
  #Percent Censored:                24%
  #
  #Confidence Interval for:         meanlog
  #
  #Confidence Interval Method:      Profile Likelihood
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             LCL = 1.595062
  #                                 UCL = 2.771197
</code></pre>


</div>