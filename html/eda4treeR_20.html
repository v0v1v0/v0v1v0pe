<div class="container">

<table style="width: 100%;"><tr>
<td>Exam5.1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Example 5.1 from Experimental Design and Analysis for Tree Improvement</h2>

<h3>Description</h3>

<p>Exam5.1 presents the height of 27 seedlots from 4 sites.
</p>


<h3>Author(s)</h3>


<ol>
<li>
<p>  Muhammad Yaseen (<a href="mailto:myaseen208@gmail.com">myaseen208@gmail.com</a>)
</p>
</li>
<li>
<p>  Sami Ullah (<a href="mailto:samiullahuos@gmail.com">samiullahuos@gmail.com</a>)
</p>
</li>
</ol>
<h3>References</h3>


<ol><li>
<p> E.R. Williams, C.E. Harwood and A.C. Matheson (2023). <em>Experimental Design and Analysis for Tree Improvement</em>.
CSIRO Publishing (<a href="https://www.publish.csiro.au/book/3145/">https://www.publish.csiro.au/book/3145/</a>).
</p>
</li></ol>
<h3>See Also</h3>

<p><code>DataExam5.1</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(car)
library(dae)
library(dplyr)
library(emmeans)
library(ggplot2)
library(lmerTest)
library(magrittr)
library(predictmeans)

data(DataExam5.1)

# Pg.68
fm5.4 &lt;-
      lm(
          formula = ht ~ site*seedlot
        , data    = DataExam5.1
        )

# Pg. 73
anova(fm5.4)
# Pg. 73
emmeans(object = fm5.4, specs = ~ site)
emmeans(object = fm5.4, specs = ~ seedlot)

ANOVAfm5.4 &lt;- anova(fm5.4)

ANOVAfm5.4[4, 1:3] &lt;- c(208, 208*1040, 1040)
ANOVAfm5.4[3, 4]   &lt;- ANOVAfm5.4[3, 3]/ANOVAfm5.4[4, 3]
ANOVAfm5.4[3, 5]   &lt;-
           pf(
              q        = ANOVAfm5.4[3, 4]
          , df1        = ANOVAfm5.4[3, 1]
          , df2        = ANOVAfm5.4[4, 1]
          , lower.tail = FALSE
          )
# Pg. 73
ANOVAfm5.4

# Pg. 80
DataExam5.1 %&gt;%
  filter(seedlot %in% c("13653", "13871")) %&gt;%
  ggplot(
    data = .
  , mapping = aes(
                  x     = sitemean
                , y     = ht
                , color = seedlot
                , shape = seedlot
                )
  ) +
  geom_point() +
  geom_smooth(
     method    = lm
   , se        = FALSE
   , fullrange = TRUE
   ) +
  theme_classic() +
  labs(
      x = "SiteMean"
    , y = "SeedLot Mean"
    )



Tab5.10 &lt;-
  DataExam5.1 %&gt;%
  summarise(Mean = mean(ht), .by = seedlot) %&gt;%
  left_join(
     DataExam5.1 %&gt;%
     nest_by(seedlot) %&gt;%
     mutate(fm1 = list(lm(ht ~ sitemean, data = data))) %&gt;%
     summarise(Slope = coef(fm1)[2])
  , by = "seedlot"
     )

# Pg. 81
Tab5.10

ggplot(data = Tab5.10, mapping = aes(x = Mean, y = Slope)) +
 geom_point(size = 2) +
 theme_bw() +
 labs(
     x = "SeedLot Mean"
   , y = "Regression Coefficient"
   )

DevSS1 &lt;-
  DataExam5.1 %&gt;%
  nest_by(seedlot) %&gt;%
  mutate(fm1 = list(lm(ht ~ sitemean, data = data))) %&gt;%
  summarise(SSE = anova(fm1)[2, 2]) %&gt;%
  ungroup() %&gt;%
  summarise(Dev = sum(SSE)) %&gt;%
  as.numeric()

ANOVAfm5.4[2, 2]

length(levels(DataExam5.1$SeedLot))

ANOVAfm5.4.1 &lt;-
  rbind(
   ANOVAfm5.4[1:3, ]
  , c(
      ANOVAfm5.4[2, 1]
    , ANOVAfm5.4[3, 2] - DevSS1
    , (ANOVAfm5.4[3, 2] - DevSS1)/ANOVAfm5.4[2, 1]
    , NA
    , NA
    )
  , c(
      ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1]
    , DevSS1
    , DevSS1/(ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1])
    , DevSS1/(ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1])/ANOVAfm5.4[4, 3]
    , pf(
            q = DevSS1/(ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1])/ANOVAfm5.4[4, 3]
        , df1 = ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1]
        , df2 = ANOVAfm5.4[4, 1]
        , lower.tail = FALSE
        )
    )
  , ANOVAfm5.4[4, ]
  )

rownames(ANOVAfm5.4.1) &lt;-
  c(
    "Site"
  , "seedlot"
  , "site:seedlot"
  , "  regressions"
  , "  deviations"
  , "Residuals"
  )
# Pg. 82
ANOVAfm5.4.1

</code></pre>


</div>