<div class="container">

<table style="width: 100%;"><tr>
<td>controlMOScsg0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Control parameters for censored and shifted gamma EMOS models
</h2>

<h3>Description</h3>

<p>Specifies a list of values controling the censored and shifted gamma EMOS fit
of ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">controlMOScsg0(scoringRule = c("crps", "log"),
               optimRule = c("Nelder-Mead", "BFGS", "L-BFGS-B"),
               coefRule = c("square", "none", "positive"),
               varRule = c("square", "none"),
               start = list(a = NULL, B = NULL,
                            c = NULL, d = NULL, q = NULL),
               maxIter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scoringRule</code></td>
<td>

<p>The scoring rule to be used in optimum score estimation. Options
are "crps" for the continuous ranked probability score and "log" for
the logarithmic score.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimRule</code></td>
<td>

<p>Numerical optimization method to be supplied to <code>optim</code>. 
Options are "BFGS" for the
Broyden-Fletcher-Goldfarb-Shanno algorithm and "Nelder-Mead" for the
Nelder-Mead method, see optim for details. Note that these 
options are only available for <code>scoringRule = "log"</code>. 
In case of <code>scoringRule = "crps"</code>, the optimization method
is set to "L-BFGS-B" by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefRule</code></td>
<td>

<p>Method to control non-negativity of regression
estimates. Options are:
</p>

<ul>
<li> <p><code>"square"</code> EMOS coefficients are
parameterized as squares and thus gauranteed to be non-negative.
</p>
</li>
<li> <p><code>"positive"</code> finds non-negative coefficents
iteratively by setting negative estimates at the current iteration
to zero. 
</p>
</li>
<li> <p><code>"none"</code> no restriction on the coefficient
estimates.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varRule</code></td>
<td>

<p>Method to control non-negativity of the scale parameters.
Options <code>"square"</code> and <code>"none"</code> are the same as in
<code>coefRule</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>A list of starting parameters, <code>a</code>, <code>B</code>, <code>c</code>, <code>d</code> 
and <code>q</code> specifying initial values for the intercept coefficient
and variance parameters supplied to <code>optim</code>. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>

<p>An integer specifying the upper limit of the number of iterations
used to fit the model.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no value is assigned to an argument, the first entry of 
the list of possibly choices will be used by default.
Note that optimMethod options are only available for <code>scoringRule = "log"</code>. 
In case of <code>scoringRule = "crps"</code>, the optimization method
is set to "L-BFGS-B" by default.
</p>
<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following shifted gamma model left-censored at 0
is fit by <code>ensembleMOScsg0</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ Gamma_0(\kappa,\theta,q)</code>
</p>

<p>where <code class="reqn">Gamma_0</code> denotes the shifted gamma distribution left-censored at zero,
with shape <code class="reqn">\kappa</code>, scale <code class="reqn">\theta</code> and shift <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">\kappa\theta</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance <code class="reqn">\kappa\theta^2</code> is a linear
function of the ensemble mean <code class="reqn">c+d \overline{f}</code>, see ensembleMOScsg0
for details.
</p>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned
values.
</p>


<h3>References</h3>

<p>M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578–4596, 2015.
</p>
<p>S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280–292, 2016.
</p>


<h3>See Also</h3>

<p><code>ensembleMOScsg0</code>,
<code>fitMOScsg0</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

prcpTestFitCSG0 &lt;- ensembleMOScsg0(prcpTestData, trainingDays = 25,
                                   dates = "2008010100",
                                   control = controlMOScsg0(maxIter = as.integer(100),
                                                            scoringRule = "log",
                                                            optimRule = "Nelder-Mead",
                                                            coefRule= "none", 
                                                            varRule = "square"))

</code></pre>


</div>