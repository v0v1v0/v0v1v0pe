<div class="container">

<table style="width: 100%;"><tr>
<td>vdetect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Valley detection and centroidization</h2>

<h3>Description</h3>

<p>Checks envelopes calculated by <code>envelope</code> for valleys and extracts centroids or intensoids.</p>


<h3>Usage</h3>

<pre><code class="language-R">vdetect(profiles,detect="centroid",plotit=TRUE,verbose=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>profiles</code></td>
<td>
<p>List of stick profiles as generated by <code>envelope</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detect</code></td>
<td>
<p>To return either <code>"centroid"</code>, <code>"intensoid"</code> or <code>"valley"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>
<p>Should results be plotted, <code>TRUE/FALSE</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose, <code>TRUE/FALSE</code>?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with length equal to length of list <code>profiles</code>, with equal names of list entries.
Each entry in that list contains the centroids, intensoids or valleys of the envelope in two columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>m/z</code></td>
<td>
<p>m/z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p>Area (centroid) or abundance (intensoid, valley)</p>
</td>
</tr>
</table>
<h3>definitions</h3>

<p>Valley: local profile minimum, i.e. any envelope stick flanked by two other sticks of higher abundance. 
</p>
<p>Stick: see <code>envelope</code>.
</p>
<p>Centroid mass: intensity-weighted sum of the m/z of sticks between two valleys. 
</p>
<p>Centroid intensity: profile area between two valleys (mean of upper and lower sum of stick intensities),
normalized to the maximum centroid area of the envelope.
</p>
<p>Intensoid mass: m/z of the most intense stick between two valleys.
</p>
<p>Intensoid intensity: intensity of the most intensive stick between two valleys, normalized to the most intense intensoid.
</p>


<h3>Note</h3>

<p>Too low stick discretization leads to imprecision in valley, centroid and intensoid characteristics.</p>


<h3>Author(s)</h3>

<p>Martin Loos, Christian Gerber</p>


<h3>See Also</h3>

<p><code>isopattern</code>
<code>envelope</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############################
# batch of chemforms #######
data(isotopes)
data(chemforms)
chemforms&lt;-chemforms[1:5]

pattern&lt;-isopattern(
  isotopes,
  chemforms,
  threshold=0.1,
  plotit=TRUE,
  charge=FALSE,
  emass=0.00054858,
  algo=2
)

profiles&lt;-envelope(
    pattern,
    ppm=FALSE,
    dmz=0.0001,   
    frac=1/4,
    env="Gaussian",
    resolution=1E6,
    plotit=TRUE
)

centro&lt;-vdetect(
  profiles,
  detect="centroid",
  plotit=TRUE
)

############################

</code></pre>


</div>