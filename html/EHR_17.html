<div class="container">

<table style="width: 100%;"><tr>
<td>collapseDose</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Collapse Dose Data</h2>

<h3>Description</h3>

<p>Splits drug data and calls <code>makeDose</code> to collapse at the note and date level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">collapseDose(x, noteMetaData, naFreq = "most", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data.frame containing the output of <code>buildDose</code>, or the output of
<code>addLastDose</code> if last dose information is being incorporated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noteMetaData</code></td>
<td>
<p>data.frame containing identifying meta data for each
note, including patient ID, date of the note, and note ID. Column names
should be set to ‘filename’, ‘pid’, ‘date’,
‘note’. Date should have format YYYY-MM-DD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naFreq</code></td>
<td>
<p>Expression used to replace missing frequencies with, or by default use the most
common.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>drug formulations to split by</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If different formulations of the drug (e.g., extended release) exist, they can be
separated using a regular expression (e.g., ‘xr|er’). This function will call
<code>makeDose</code> on parsed and paired medication data to calculate dose intake
and daily dose and remove redundancies at the note and date level.
</p>
<p>See EHR Vignette for Extract-Med and Pro-Med-NLP as well as Dose Building Using Example Vanderbilt EHR Data for details.
</p>


<h3>Value</h3>

<p>A list containing two dataframes, one with the note level and one with the date level collapsed data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(lam_mxr_parsed)
data(lam_metadata)

lam_build_out &lt;- buildDose(lam_mxr_parsed)

lam_collapsed &lt;- collapseDose(lam_build_out, lam_metadata, naFreq = 'most', 'xr|er')
lam_collapsed$note # Note level collapsing
lam_collapsed$date # Date level collapsing
</code></pre>


</div>