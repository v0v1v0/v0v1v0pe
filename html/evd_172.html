<div class="container">

<table style="width: 100%;"><tr>
<td>qcbvnonpar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-parametric Estimates for Bivariate Quantile Curves</h2>

<h3>Description</h3>

<p>Calculate or plot non-parametric estimates for quantile curves
of bivariate extreme value distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qcbvnonpar(p = seq(0.75, 0.95, 0.05), data, epmar = FALSE, nsloc1 =
    NULL, nsloc2 = NULL, mint = 1, method = c("cfg", "pickands",
    "tdo"), convex = FALSE, madj = 0, kmar = NULL, plot = FALSE,
    add = FALSE, lty = 1, lwd = 1, col = 1, xlim = range(data[,1],
    na.rm = TRUE), ylim = range(data[,2], na.rm = TRUE), xlab =
    colnames(data)[1], ylab = colnames(data)[2], ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of lower tail probabilities. One quantile curve is
calculated or plotted for each probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data frame with two columns, which may contain
missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epmar</code></td>
<td>
<p>If <code>TRUE</code>, an empirical transformation of the
marginals is performed in preference to marginal parametric
GEV estimation, and the <code>nsloc</code> arguments are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsloc1, nsloc2</code></td>
<td>
<p>A data frame with the same number of rows as
<code>data</code>, for linear modelling of the location parameter on the
first/second margin. The data frames are treated as covariate
matrices, excluding the intercept. A numeric vector can be given
as an alternative to a single column data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mint</code></td>
<td>
<p>An integer <code class="reqn">m</code>. Quantile curves are plotted or
calculated using the lower tail probabilities <code class="reqn">p^m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method, kmar</code></td>
<td>
<p>Arguments for the non-parametric estimate of the
dependence function. See <code>abvnonpar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convex, madj</code></td>
<td>
<p>Other arguments for the non-parametric
estimate of the dependence function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical; if <code>TRUE</code> the data is plotted along
with the quantile curves. If <code>plot</code> and <code>add</code> are
<code>FALSE</code> (the default), the arguments following <code>add</code>
are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical; add quantile curves to an existing data plot?
The existing plot should have been created using either
<code>qcbvnonpar</code> or <code>plot.bvevd</code>, the latter of
which can plot quantile curves for parametric fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>
<p>Line types and widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Line colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>x and y-axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x and y-axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other high-level graphics parameters to be passed to
<code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let G be a fitted bivariate distribution function with
margins <code class="reqn">G_1</code> and <code class="reqn">G_2</code>. A quantile curve for a fitted
distribution function G at lower tail probability p is defined
by
</p>
<p style="text-align: center;"><code class="reqn">Q(G, p) = \{(y_1,y_1):G(y_1,y_2) = p\}.</code>
</p>

<p>For bivariate extreme value distributions, it consists
of the points
</p>
<p style="text-align: center;"><code class="reqn">\left\{G_1^{-1}(p_1),G_2^{-1}(p_2))\right\}</code>
</p>

<p>where <code class="reqn">p_1 = p^{t/A(t)}</code> and <code class="reqn">p_2 = p^{(1-t)/A(t)}</code>,
with <code class="reqn">A</code> being the estimated dependence function defined
in <code>abvevd</code>, and where <code class="reqn">t</code> lies in the interval
<code class="reqn">[0,1]</code>.
</p>
<p>By default the margins <code class="reqn">G_1</code> and <code class="reqn">G_2</code> are modelled using
estimated generalized extreme value distributions.
For non-stationary generalized extreme value margins the plotted
data are transformed to stationarity, and the plot corresponds
to the distribution obtained when all covariates are zero.
</p>
<p>If <code>epmar</code> is <code>TRUE</code>, empirical transformations
are used in preference to generalized extreme value models.
Note that the marginal empirical quantile functions are
evaluated using <code>quantile</code>, which linearly
interpolates between data points, hence the curve will not
be a step function.
</p>
<p>The idea behind the argument <code class="reqn">\code{mint} = m</code> is that if
G is fitted to a dataset of componentwise maxima, and the
underlying observations are <em>iid</em> distributed according
to F, then if <code class="reqn">m</code> is the size of the blocks over which the
maxima were taken, approximately <code class="reqn">F^m = G</code>, leading
to <code class="reqn">Q(F, p) = Q(G, p^m)</code>.
</p>


<h3>Value</h3>

<p><code>qcbvnonpar</code> calculates or plots non-parametric quantile
curve estimates for bivariate extreme value distributions.
If <code>p</code> has length one it returns a two column matrix
giving points on the curve, else it returns a list of
such matrices.
</p>


<h3>See Also</h3>

<p><code>abvevd</code>, <code>abvnonpar</code>,
<code>plot.bvevd</code></p>


<h3>Examples</h3>

<pre><code class="language-R">bvdata &lt;- rbvevd(100, dep = 0.7, model = "log")
qcbvnonpar(c(0.9,0.95), data = bvdata, plot = TRUE)
qcbvnonpar(c(0.9,0.95), data = bvdata, epmar = TRUE, plot = TRUE)
</code></pre>


</div>