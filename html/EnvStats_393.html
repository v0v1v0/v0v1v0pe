<div class="container">

<table style="width: 100%;"><tr>
<td>plotPredIntNormTestPowerCurve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power Curves for Sampling Design for Test Based on Prediction Interval for Normal Distribution
</h2>

<h3>Description</h3>

<p>Plot power vs. <code class="reqn">\Delta/\sigma</code> (scaled minimal detectable difference) for a 
sampling design for a test based on a prediction interval for a normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plotPredIntNormTestPowerCurve(n = 8, df = n - 1, n.mean = 1, k = 1, 
    range.delta.over.sigma = c(0, 5), pi.type = "upper", conf.level = 0.95, 
    plot.it = TRUE, add = FALSE, n.points = 20, plot.col = "black", 
    plot.lwd = 3 * par("cex"), plot.lty = 1, digits = .Options$digits, ..., 
    main = NULL, xlab = NULL, ylab = NULL, type = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>positive integer greater than 2 indicating the sample size upon which 
the prediction interval is based.  The default is value is <code>n=8</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>positive integer indicating the degrees of freedom associated with 
the sample size.  The default value is <code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mean</code></td>
<td>

<p>positive integer specifying the sample size associated with the future average(s).  
The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all 
future averages must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>positive integer specifying the number of future observations that the 
prediction interval should contain with confidence level <code>conf.level</code>.  The 
default value is <code>k=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.delta.over.sigma</code></td>
<td>

<p>numeric vector of length 2 indicating the range of the x-variable to use for the 
plot.  The default value is <code>range.delta.over.sigma=c(0,5)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>pi.type="upper"</code> (the default), and 
<code>pi.type="lower"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric scalar between 0 and 1 indicating the confidence level of the 
prediction interval.  The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>a logical scalar indicating whether to create a plot or add to the existing plot 
(see explanation of the argument <code>add</code> below) on the current graphics device.  
If <code>plot.it=FALSE</code>, no plot is produced, but a list of (x,y) values is returned 
(see the section VALUE).  The default value is <code>plot.it=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>a logical scalar indicating whether to add the design plot to the existing plot (<code>add=TRUE</code>), 
or to create a plot from scratch (<code>add=FALSE</code>).  The default value is <code>add=FALSE</code>.  
This argument is ignored if <code>plot.it=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>

<p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.  
There are <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>.  The default value is <code>n.points=100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the plotted line or points.  The default value 
is <code>plot.col="black"</code>.  See the entry for <code>col</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lwd</code></td>
<td>

<p>a numeric scalar determining the width of the plotted line.  The default value is 
<code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the plotted line.  The default value is 
<code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print out on the plot.  The default 
value is the current setting of <code>options("digits")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab, type, ...</code></td>
<td>

<p>additional graphical parameters (see <code>par</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help file for <code>predIntNormTestPower</code> for information on how to 
compute the power of a hypothesis test for the difference between two means of 
normal distributions based on a prediction interval for a normal distribution.
</p>


<h3>Value</h3>

<p><code>plotPredIntNormTestPowerCurve</code> invisibly returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x.var</code></td>
<td>
<p>x-coordinates of points that have been or would have been plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.var</code></td>
<td>
<p>y-coordinates of points that have been or would have been plotted.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>See the help files for <code>predIntNorm</code> and 
<code>predIntNormSimultaneous</code>.
</p>
<p>In the course of designing a sampling program, an environmental scientist may wish 
to determine the relationship between sample size, significance level, power, and 
scaled difference if one of the objectives of the sampling program is to determine 
whether two distributions differ from each other.  The functions 
<code>predIntNormTestPower</code> and <code>plotPredIntNormTestPowerCurve</code> can be 
used to investigate these relationships for the case of normally-distributed 
observations.  In the case of a simple shift between the two means, the test based 
on a prediction interval is not as powerful as the two-sample t-test.  However, the 
test based on a prediction interval is more efficient at detecting a shift in the 
tail.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help files for <code>predIntNorm</code> and 
<code>predIntNormSimultaneous</code>.
</p>


<h3>See Also</h3>

<p><code>predIntNorm</code>, <code>predIntNormK</code>, 
<code>predIntNormTestPower</code>, <code>predIntNormSimultaneous</code>, <br><code>predIntNormSimultaneousK</code>, 
<code>predIntNormSimultaneousTestPower</code>, Prediction Intervals, 
Normal.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Pages 6-16 to 6-17 of USEPA (2009) present EPA Reference Power Curves (ERPC)
  # for groundwater monitoring:
  #
  # "Since effect sizes discussed in the next section often cannot or have not been 
  # quantified, the Unified Guidance recommends using the ERPC as a suitable basis 
  # of comparison for proposed testing procedures.  Each reference power curve 
  # corresponds to one of three typical yearly statistical evaluation schedules - 
  # quarterly, semi-annual, or annual - and represents the cumulative power 
  # achievable during a single year at one well-constituent pair by a 99% upper 
  # (normal) prediction limit based on n = 10 background measurements and one new 
  # measurement from the compliance well.
  #
  # Here we will reproduce Figure 6-3 on page 6-17.

  dev.new()
  plotPredIntNormTestPowerCurve(n = 10, k = 1, conf.level = 0.99, 
    ylim = c(0, 1), main="")

  plotPredIntNormTestPowerCurve(n = 10, k = 2, conf.level = 0.99, 
    add = TRUE, plot.col = "red", plot.lty = 2)

  plotPredIntNormTestPowerCurve(n = 10, k = 4, conf.level = 0.99, 
    add = TRUE, plot.col = "blue", plot.lty = 3)

  legend("topleft", c("Quarterly", "Semi-Annual", "Annual"), lty = 3:1, 
    lwd = 3 * par("cex"), col = c("blue", "red", "black"), bty = "n") 

  title(main = paste("Power vs. Delta/Sigma for Upper Prediction Interval with",
    "n=10, Confidence=99%, and Various Sampling Frequencies", sep="\n"))

  #==========
## Not run: 
  # Plot power vs. scaled minimal detectable difference for various sample sizes 
  # using a 5

  dev.new()
  plotPredIntNormTestPowerCurve(n = 8, k = 1, ylim = c(0, 1), main="") 

  plotPredIntNormTestPowerCurve(n = 16, k = 1, add = TRUE, plot.col = "red") 

  plotPredIntNormTestPowerCurve(n = 32, k = 1, add = TRUE, plot.col = "blue") 

  legend("bottomright", c("n=32", "n=16", "n=8"), lty = 1, lwd = 3 * par("cex"), 
    col = c("blue", "red", "black"), bty = "n") 

  title(main = paste("Power vs. Delta/Sigma for Upper Prediction Interval with",
    "k=1, Confidence=95%, and Various Sample Sizes", sep="\n"))

  #==========

  # Clean up
  #---------
  graphics.off()

## End(Not run)
</code></pre>


</div>