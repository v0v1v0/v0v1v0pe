<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean estimation for open planar curves.</h2>

<h3>Description</h3>

<p>Fits an elastic full Procrustes mean for open, planar curves.
Is usually called from <code>compute_elastic_shape_mean</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mean(
  srv_data_curves,
  knots,
  penalty,
  var_type,
  pfit_method,
  max_iter,
  type,
  eps,
  cluster,
  verbose,
  smooth_warp
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>srv_data_curves</code></td>
<td>
<p>list of <code>data.frame</code>s with srv vectors in each row.curves</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>set of knots for the mean spline curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>the penalty to use in the covariance smoothing step. use '-1' for no penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_type</code></td>
<td>
<p>(experimental) assume "smooth", "constant" or "zero" measurement-error variance along t</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfit_method</code></td>
<td>
<p>(experimental) "smooth" or "polygon"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>maximal number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if "smooth" linear srv-splines are used which results in a differentiable mean curve
if "polygon" the mean will be piecewise linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the algorithm stops if L2 norm of coefficients changes less</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>a cluster object for use in the <code>bam</code> call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth_warp</code></td>
<td>
<p>(experimental) controls the weighting of original and smoothed observations
over the iterations, if pfit_method == "smooth".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>list</code> with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>"smooth" or "polygon"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p><code>coefs</code> srv spline coefficients of the estimated mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>spline knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>penalty used in the covariance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distances</code></td>
<td>
<p>distances to mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a <code>list</code> containing
<code>t_optims</code>optimal parametrizations
<code>G_optims</code>optimal rotations
<code>b_optims</code>optimal scalings
<code>n_optims</code>optimal re-normalization
<code>n_iter</code>number of iterations until convergence
<code>gram</code> the mean basis Gram matrix,
<code>cov_fit</code> the covariance smoothing objects in the final iteration,
<code>cov_pca</code> cov coef matrix pca object in the final iteration and
<code>pfit_coefs</code> the mean basis coefs of smoothed pfits in the final iteration</p>
</td>
</tr>
</table>
</div>