<div class="container">

<table style="width: 100%;"><tr>
<td>weibreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weibull Regression</h2>

<h3>Description</h3>

<p>Proportional hazards model with baseline hazard(s) from the Weibull family
of distributions.  Allows for stratification with different scale and shape
in each stratum, and left truncated and right censored data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weibreg(
  formula = formula(data),
  data = parent.frame(),
  na.action = getOption("na.action"),
  init,
  shape = 0,
  control = list(eps = 1e-04, maxiter = 10, trace = FALSE),
  singular.ok = TRUE,
  model = FALSE,
  x = FALSE,
  y = TRUE,
  center = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~
operator, and the terms on the right.  The response must be a survival
object as returned by the Surv function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the
formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a missing-data filter function, applied to the model.frame,
after any subset argument has been used.  Default is
<code>options()$na.action</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>vector of initial values of the iteration.  Default initial
value is zero for all variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>If positive, the shape parameter is fixed at that value (in
each stratum).  If zero or negative, the shape parameter is estimated.  If
more than one stratum is present in data, each stratum gets its own
estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with components <code>eps</code> (convergence criterion),
<code>maxiter</code> (maximum number of iterations), and <code>silent</code> (logical,
controlling amount of output).  You can change any component without mention
the other(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Return the design matrix in the model object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Return the response in the model object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Deprecated, and not used.  Will be removed in the future.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameterization is the same as in <code>coxreg</code> and
<code>coxph</code>, but different from the one used by
<code>survreg</code>. The model is </p>
<p style="text-align: center;"><code class="reqn">h(t; a, b, \beta, z) =
(a/b) (t/b)^{a-1} exp(z\beta)</code>
</p>
<p> This is in correspondence with <code>Weibull</code>. To
compare regression coefficients with those from <code>survreg</code> you need to
divide by estimated shape (<code class="reqn">\hat{a}</code>) and change sign. The p-values
and test statistics are however the same, with one exception; the score test
is done at maximized scale and shape in <code>weibreg</code>.
</p>
<p>This model is a Weibull distribution with shape parameter <code class="reqn">a</code> and scale
parameter <code class="reqn">b \exp(-z\beta / a)</code>
</p>


<h3>Value</h3>

<p>A list of class <code>c("weibreg", "coxreg")</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Fitted parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Covariance
matrix of the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Vector of length two; first
component is the value at the initial parameter values, the second componet
is the maximized value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>The score test statistic (at the
initial value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>The estimated linear predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>Means of the columns of the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.means</code></td>
<td>
<p>Weighted (against exposure time) means of covariates;
weighted relative frequencies of levels of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of
spells in indata (possibly after removal of cases with NA's).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>Number of events in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>Used by extractor
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign</code></td>
<td>
<p>Used by extractor functions.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>wald.test</code></td>
<td>
<p>The Wald test statistic (at the initial value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The Surv vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isF</code></td>
<td>
<p>Logical vector indicating the
covariates that are factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>The covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ttr</code></td>
<td>
<p>Total Time at Risk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>List of levels of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The calling formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Did the optimization
converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p>Did the optimization fail? (Is <code>NULL</code> if not).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfixed</code></td>
<td>
<p>TRUE if shape was fixed in the estimation.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>The print method <code>print.weibreg</code> doesn't work
if threeway or higher order interactions are present.
</p>
<p>Note further that covariates are internally centered, if <code>center =
TRUE</code>, by this function, and this is not corrected for in the output. This
affects the estimate of <code class="reqn">\log(scale)</code>, but nothing else. If
you don't like this, set <code>center = FALSE</code>.
</p>


<h3>Note</h3>

<p>This function is not maintained, and may behave in unpredictable ways.
Use <code>phreg</code> with <code>dist = "weibull"</code> (the default) instead!
Will soon be declared deprecated.
</p>


<h3>Author(s)</h3>

<p>Göran Broström
</p>


<h3>See Also</h3>

<p><code>phreg</code>, <code>coxreg</code>,
<code>print.weibreg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 dat &lt;- data.frame(time = c(4, 3, 1, 1, 2, 2, 3),
                status = c(1, 1, 1, 0, 1, 1, 0),
                x = c(0, 2, 1, 1, 1, 0, 0),
                sex = c(0, 0, 0, 0, 1, 1, 1))
 weibreg( Surv(time, status) ~ x + strata(sex), data = dat) #stratified model

</code></pre>


</div>