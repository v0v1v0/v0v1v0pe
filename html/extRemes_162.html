<div class="container">

<table style="width: 100%;"><tr>
<td>threshrange.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Threshold Selection Through Fitting Models to a Range of Thresholds
</h2>

<h3>Description</h3>

<p>Find an appropriate threshold for GP or PP models by fitting them to a sequence of thresholds in order to find the lowest threshold that yields roughly the same parameter estiamtes as any higher threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">threshrange.plot(x, r, type = c("GP", "PP", "Exponential"), nint = 10, alpha = 0.05,
    na.action = na.fail, set.panels = TRUE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>numeric vector of length two giving the range of thresholds.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>character string stating which model to fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>

<p>number of thresholds to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>number between zero and one stating which 1 - <code>alpha</code> confidence level to use for the confidence limits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>function to be called to handle missing values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.panels</code></td>
<td>

<p>logical; should the function set the panels on the device (TRUE) or not (FALSE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical; should progress information be printed to the screen?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>optional arguments to <code>fevd</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Several GP or PP (or exponential) models are fit to <code>x</code> according to a range of <code>nint</code> thresholds given by <code>r</code>.  The estimated parameters are plotted against these thresholds along with their associated (1 - <code>alpha</code>) * 100 percent CIs.
</p>
<p>Choice of threshold is a compromise between low variance (lower thresholds yield more data with which to fit the models) and bias (higher thresholds yield estimates that are less biased because model assumptions require very high thresholds, and it can happen that lower data values may be more abundant causing the model to be biased toward the wrong values) in the parameter estimates.  An appropriate threshold should yield the same parameter estimates (within uncertainty) as would be fit for any model fit to higher thresholds.  Therefore, the idea is to find the lowest possible threshold whereby a higher threshold would give the same results within uncertainty bounds.
</p>
<p>See Coles (2001) sec. 4.3.4 and 4.4 for more information.
</p>
<p>Note that the default uses maximum likelihood estimation.  While it is possible to use other methods, it is not recommended because of efficiency problems.
</p>


<h3>Value</h3>

<p>A matrix of parameter values and CI bounds for each threshold value is returned invisibly.  A plot is created.
</p>


<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Coles, S.  (2001). <em>An introduction to statistical modeling of extreme values</em>, London, United Kingdom: Springer-Verlag, 208 pp.
</p>


<h3>See Also</h3>

<p><code>fevd</code>, <code>mrlplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Fort)
threshrange.plot(Fort$Prec, r = c(1, 2.25), nint=5)

## Not run: 
threshrange.plot(Fort$Prec, r=c(0.01,1), nint=30, verbose=TRUE)

threshrange.plot(Fort$Prec, r=c(0.2,0.8), type="PP", nint=15,
    verbose=TRUE)

threshrange.plot(Fort$Prec, r=c(0.2,0.8), type="PP", nint=15,
    optim.args=list(method="Nelder-Mead"), verbose=TRUE)


## End(Not run)
</code></pre>


</div>