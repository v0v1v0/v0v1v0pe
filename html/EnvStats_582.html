<div class="container">

<table style="width: 100%;"><tr>
<td>tolIntPois</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Tolerance Interval for a Poisson Distribution
</h2>

<h3>Description</h3>

<p>Construct a <code class="reqn">\beta</code>-content or <code class="reqn">\beta</code>-expectation tolerance 
interval for a Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  tolIntPois(x, coverage = 0.95, cov.type = "content", ti.type = "two-sided", 
    conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations, or an object resulting from a call to an 
estimating function that assumes a Poisson distribution 
(i.e., <code>epois</code> or <code>epoisCensored</code>).  
If <code>cov.type="content"</code> then <code>x</code> must be a numeric vector.  
If <code>x</code> is a numeric vector, 
missing (<code>NA</code>), undefined (<code>NaN</code>), and 
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>

<p>a scalar between 0 and 1 indicating the desired coverage of the tolerance interval.  
The default value is <code>coverage=0.95</code>.  If <code>cov.type="expectation"</code>, 
this argument is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.type</code></td>
<td>

<p>character string specifying the coverage type for the tolerance interval.  
The possible values are <code>"content"</code> (<code class="reqn">\beta</code>-content; the default), and 
<code>"expectation"</code> (<code class="reqn">\beta</code>-expectation).  See the DETAILS section for more 
information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ti.type</code></td>
<td>

<p>character string indicating what kind of tolerance interval to compute.  
The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level associated with the tolerance 
interval.  The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or 
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to 
performing the estimation.
</p>
<p>A tolerance interval for some population is an interval on the real line constructed so as to 
contain <code class="reqn">100 \beta \%</code> of the population (i.e., <code class="reqn">100 \beta \%</code> of all 
future observations), where <code class="reqn">0 &lt; \beta &lt; 1</code>.  The quantity <code class="reqn">100 \beta \%</code> is called 
the <em>coverage</em>.
</p>
<p>There are two kinds of tolerance intervals (Guttman, 1970):
</p>
 
<ul>
<li>
<p> A <code class="reqn">\beta</code>-content tolerance interval with confidence level <code class="reqn">100(1-\alpha)\%</code> is 
constructed so that it contains at least <code class="reqn">100 \beta \%</code> of the population (i.e., the 
coverage is at least <code class="reqn">100 \beta \%</code>) with probability <code class="reqn">100(1-\alpha)\%</code>, where 
<code class="reqn">0 &lt; \alpha &lt; 1</code>. The quantity <code class="reqn">100(1-\alpha)\%</code> is called the confidence level or 
confidence coefficient associated with the tolerance interval.
</p>
</li>
<li>
<p> A <code class="reqn">\beta</code>-expectation tolerance interval is constructed so that the <em>average</em> coverage of 
the interval is <code class="reqn">100 \beta \%</code>.
</p>
</li>
</ul>
<p><b>Note:</b> A <code class="reqn">\beta</code>-expectation tolerance interval with coverage <code class="reqn">100 \beta \%</code> is 
equivalent to a prediction interval for one future observation with associated confidence level 
<code class="reqn">100 \beta \%</code>.  Note that there is no explicit confidence level associated with a 
<code class="reqn">\beta</code>-expectation tolerance interval.  If a <code class="reqn">\beta</code>-expectation tolerance interval is 
treated as a <code class="reqn">\beta</code>-content tolerance interval, the confidence level associated with this 
tolerance interval is usually around 50% (e.g., Guttman, 1970, Table 4.2, p.76).  
</p>
<p>Because of the discrete nature of the Poisson distribution, 
even true tolerance intervals (tolerance intervals based on the true value of 
<code class="reqn">\lambda</code>) will usually not contain exactly <code class="reqn">\beta\%</code> of the population.  
For example, for the Poisson distribution with parameter <code>lambda=2</code>, the 
interval [0, 4] contains 94.7% of this distribution and the interval [0, 5] 
contains 98.3% of this distribution.  Thus, no interval can contain exactly 95% 
of this distribution.
</p>
<p><em><code class="reqn">\beta</code>-Content Tolerance Intervals for a Poisson Distribution</em> <br>
Zacks (1970) showed that for monotone likelihood ratio (MLR) families of discrete 
distributions, a uniformly most accurate upper <code class="reqn">\beta100\%</code> <code class="reqn">\beta</code>-content 
tolerance interval with associated confidence level <code class="reqn">(1-\alpha)100\%</code> is 
constructed by finding the upper <code class="reqn">(1-\alpha)100\%</code> confidence limit for the 
parameter associated with the distribution, and then computing the <code class="reqn">\beta</code>'th 
quantile of the distribution assuming the true value of the parameter is equal to 
the upper confidence limit.  This idea can be extended to one-sided lower and 
two-sided tolerance limits.
</p>
<p>It can be shown that all distributions that are one parameter exponential families 
have the MLR property, and the Poisson distribution is a one-parameter exponential 
family, so the method of Zacks (1970) can be applied to a Poisson distribution.
</p>
<p>Let <code class="reqn">X</code> denote a Poisson random variable with parameter 
<code>lambda=</code><code class="reqn">\lambda</code>.  Let <code class="reqn">x_{p|\lambda}</code> denote the <code class="reqn">p</code>'th quantile 
of this distribution. That is,
</p>
<p style="text-align: center;"><code class="reqn">Pr(X &lt; x_{p|\lambda}) \le p \le Pr(X \le x_{p|\lambda}) \;\;\;\;\;\; (1)</code>
</p>

<p>Note that due to the discrete nature of the Poisson distribution, there will be 
several values of <code class="reqn">p</code> associated with one value of <code class="reqn">X</code>.  For example, for 
<code class="reqn">\lambda=2</code>, the value 1 is the <code class="reqn">p</code>'th quantile for any value of <code class="reqn">p</code> 
between 0.140 and 0.406.
</p>
<p>Let <code class="reqn">\underline{x}</code> denote a vector of <code class="reqn">n</code> observations from a 
Poisson distribution with parameter <code>lambda=</code><code class="reqn">\lambda</code>.  
When <code>ti.type="upper"</code>, the first step is to compute the one-sided upper 
<code class="reqn">(1-\alpha)100\%</code> confidence limit for <code class="reqn">\lambda</code> based on the observations 
<code class="reqn">\underline{x}</code> (see the help file for <code>epois</code>).  Denote this upper 
confidence limit by <code class="reqn">UCL</code>.  The one-sided upper <code class="reqn">\beta100\%</code> tolerance limit 
is then given by:
</p>
<p style="text-align: center;"><code class="reqn">[0, x_{\beta | \lambda = UCL}] \;\;\;\;\;\; (2)</code>
</p>

<p>Similarly, when <code>ti.type="lower"</code>, the first step is to compute the one-sided 
lower <code class="reqn">(1-\alpha)100\%</code> confidence limit for <code class="reqn">\lambda</code> based on the 
observations <code class="reqn">\underline{x}</code>.  Denote this lower confidence limit by <code class="reqn">LCL</code>.  
The one-sided lower <code class="reqn">\beta100\%</code> tolerance limit is then given by:
</p>
<p style="text-align: center;"><code class="reqn">[x_{1-\beta | \lambda = LCL}, \infty] \;\;\;\;\;\; (3)</code>
</p>

<p>Finally, when <code>ti.type="two-sided"</code>, the first step is to compute the two-sided 
<code class="reqn">(1-\alpha)100\%</code> confidence limits for <code class="reqn">\lambda</code> based on the 
observations <code class="reqn">\underline{x}</code>.  Denote these confidence limits by <code class="reqn">LCL</code> and 
<code class="reqn">UCL</code>. The two-sided <code class="reqn">\beta100\%</code> tolerance limit is then given by:
</p>
<p style="text-align: center;"><code class="reqn">[x_{\frac{1-\beta}{2} | \lambda = LCL}, x_{\frac{1+\beta}{2} | \lambda = UCL}] \;\;\;\;\;\; (4)</code>
</p>

<p>Note that the function <code>tolIntPois</code> uses the exact confidence limits for 
<code class="reqn">\lambda</code> when computing <code class="reqn">\beta</code>-content tolerance limits (see 
<code>epois</code>).
<br></p>
<p><em><code class="reqn">\beta</code>-Expectation Tolerance Intervals for a Poisson Distribution</em> <br>
As stated above, a <code class="reqn">\beta</code>-expectation tolerance interval with coverage 
<code class="reqn">\beta100\%</code> is equivalent to a prediction interval for one future observation 
with associated confidence level <code class="reqn">\beta100\%</code>.  This is because the probability 
that any single future observation will fall into this interval is <code class="reqn">\beta100\%</code>, 
so the distribution of the number of <code class="reqn">N</code> future observations that will fall into 
this interval is binomial with parameters 
<code>size=</code><code class="reqn">N</code> and <code>prob=</code><code class="reqn">\beta</code>.  Hence the expected proportion of 
future observations that fall into this interval is <code class="reqn">\beta100\%</code> and is 
independent of the value of <code class="reqn">N</code>.  See the help file for <code>predIntPois</code> 
for information on how these intervals are constructed.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a numeric vector, <code>tolIntPois</code> returns a list of class 
<code>"estimate"</code> containing the estimated parameters, a component called 
<code>interval</code> containing the tolerance interval information, and other 
information.  See <code>estimate.object</code> for details.
</p>
<p>If <code>x</code> is the result of calling an estimation function, <code>tolIntPois</code> 
returns a list whose class is the same as <code>x</code>.  The list contains the same 
components as <code>x</code>.  If <code>x</code> already has a component called 
<code>interval</code>, this component is replaced with the tolerance interval 
information.
</p>


<h3>Note</h3>

<p>Tolerance intervals have long been applied to quality control and 
life testing problems (Hahn, 1970b,c; Hahn and Meeker, 1991; Krishnamoorthy and 
Mathew, 2009).  References that discuss tolerance intervals in the context of 
environmental monitoring include:  Berthouex and Brown (2002, Chapter 21), 
Gibbons et al. (2009), Millard and Neerchal (2001, Chapter 6), Singh et al. (2010b), 
and USEPA (2009).
</p>
<p>Gibbons (1987b) used the Poisson distribution to model the number of detected 
compounds per scan of the 32 volatile organic priority pollutants (VOC), and 
also to model the distribution of chemical concentration (in ppb).  He explained 
the derivation of a one-sided upper <code class="reqn">\beta</code>-content tolerance limit for a 
Poisson distribution based on the work of Zacks (1970) using the Pearson-Hartley 
approximation to the confidence limits for the mean parameter <code class="reqn">\lambda</code> 
(see the help file for <code>epois</code>).  Note that there are several 
typographical errors in the derivation and examples on page 575 of Gibbons (1987b) 
because there is confusion between where the value of <code class="reqn">\beta</code> (the coverage) 
should be and where the value of <code class="reqn">1-\alpha</code> (the confidence level) should be.  
Gibbons et al. (2009, pp.103-104) gives correct formulas.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Gibbons, R.D. (1987b).  Statistical Models for the Analysis of Volatile Organic 
Compounds in Waste Disposal Sites.  <em>Ground Water</em> <b>25</b>, 572–580.
</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
John Wiley &amp; Sons, Hoboken.
</p>
<p>Guttman, I. (1970). <em>Statistical Tolerance Regions: Classical and Bayesian</em>. 
Hafner Publishing Co., Darien, CT.
</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for Practitioners</em>. 
John Wiley and Sons, New York.
</p>
<p>Johnson, N. L., S. Kotz, and A. Kemp. (1992).  <em>Univariate Discrete 
Distributions</em>.  Second Edition.  John Wiley and Sons, New York, Chapter 4.
</p>
<p>Krishnamoorthy K., and T. Mathew. (2009). 
<em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>. 
John Wiley and Sons, Hoboken.
</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>. 
CRC Press, Boca Raton.
</p>
<p>Zacks, S. (1970).  Uniformly Most Accurate Upper Tolerance Limits for Monotone 
Likelihood Ratio Families of Discrete Distributions.  <em>Journal of the 
American Statistical Association</em> <b>65</b>, 307–316.
</p>


<h3>See Also</h3>

<p><code>Poisson</code>, <code>epois</code>, <code>eqpois</code>, 
<code>estimate.object</code>, Tolerance Intervals, 
Estimating Distribution Parameters, Estimating Distribution Quantiles.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a Poisson distribution with parameter 
  # lambda=2. The interval [0, 4] contains 94.7% of this distribution and 
  # the interval [0,5] contains 98.3% of this distribution.  Thus, because 
  # of the discrete nature of the Poisson distribution, no interval contains 
  # exactly 95% of this distribution.  Use tolIntPois to estimate the mean 
  # parameter of the true distribution, and construct a one-sided upper 95% 
  # beta-content tolerance interval with associated confidence level 90%. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  dat &lt;- rpois(20, 2) 
  tolIntPois(dat, conf.level = 0.9)

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Poisson
  #
  #Estimated Parameter(s):          lambda = 1.8
  #
  #Estimation Method:               mle/mme/mvue
  #
  #Data:                            dat
  #
  #Sample Size:                     20
  #
  #Tolerance Interval Coverage:     95%
  #
  #Coverage Type:                   content
  #
  #Tolerance Interval Method:       Zacks
  #
  #Tolerance Interval Type:         two-sided
  #
  #Confidence Level:                90%
  #
  #Tolerance Interval:              LTL = 0
  #                                 UTL = 6

  #------

  # Clean up
  rm(dat)
</code></pre>


</div>