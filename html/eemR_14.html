<div class="container">

<table style="width: 100%;"><tr>
<td>eem_inner_filter_effect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inner-filter effect correction</h2>

<h3>Description</h3>

<p>Inner-filter effect correction
</p>


<h3>Usage</h3>

<pre><code class="language-R">eem_inner_filter_effect(eem, absorbance, pathlength = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absorbance</code></td>
<td>
<p>A data frame with:
</p>
 <dl>
<dt>wavelength</dt>
<dd>
<p>A numeric vector containing wavelengths.</p>
</dd>
<dt>...</dt>
<dd>
<p>One or more numeric vectors containing absorbance spectra.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathlength</code></td>
<td>
<p>A numeric value indicating the pathlength (in cm) of the
cuvette used for absorbance measurement. Default is 1 (1cm).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The inner-filter effect correction procedure is assuming that
fluorescence has been measured in 1 cm cuvette. Hence, absorbance will be
converted per cm. Note that absorbance spectra should be provided (i.e. not
absorption).
</p>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>An object of class <code>eem</code> containing: </p>
 <ul>
<li>
<p> sample The
file name of the eem. </p>
</li>
<li>
<p> x A matrix with fluorescence values. </p>
</li>
<li>
<p> em
Emission vector of wavelengths. </p>
</li>
<li>
<p> ex Excitation vector of wavelengths.
</p>
</li>
</ul>
<h3>Names matching</h3>

<p>The names of <code>absorbance</code> variables are expected to match those of the
eems. If the appropriate absorbance spectrum is not found, an uncorrected
eem will be returned and a warning message will be printed.
</p>


<h3>Sample dilution</h3>

<p>Kothawala et al. 2013 have shown that a 2-fold dilution was required for
sample presenting total absorbance &gt; 1.5 in a 1 cm cuvette. Accordingly, a
message will warn the user if total absorbance is greater than this
threshold.
</p>


<h3>References</h3>

<p>Parker, C. a., &amp; Barnes, W. J. (1957). Some experiments with
spectrofluorometers and filter fluorimeters. The Analyst, 82(978), 606.
<a href="http://doi.org/10.1039/an9578200606">http://doi.org/10.1039/an9578200606</a>
</p>
<p>Kothawala, D. N., Murphy, K. R., Stedmon, C. A., Weyhenmeyer, G. A., &amp;
Tranvik, L. J. (2013). Inner filter correction of dissolved organic matter
fluorescence. Limnology and Oceanography: Methods, 11(12), 616-630.
<a href="http://doi.org/10.4319/lom.2013.11.616">http://doi.org/10.4319/lom.2013.11.616</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(eemR)
data("absorbance")

folder &lt;- system.file("extdata/cary/scans_day_1", package = "eemR")
eems &lt;- eem_read(folder, import_function = "cary")
eems &lt;- eem_extract(eems, "nano") # Remove the blank sample

# Remove scattering (1st order)
eems &lt;- eem_remove_scattering(eems, "rayleigh")

eems_corrected &lt;- eem_inner_filter_effect(eems, absorbance = absorbance, pathlength = 1)

op &lt;- par(mfrow = c(2, 1))
plot(eems, which = 1)
plot(eems_corrected, which = 1)
par(op)
</code></pre>


</div>