<div class="container">

<table style="width: 100%;"><tr>
<td>generic_ews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic Early Warning Signals</h2>

<h3>Description</h3>

<p><code>generic_ews</code> is used to estimate statistical moments within rolling windows along a timeseries.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generic_ews(
  timeseries,
  winsize = 50,
  detrending = c("no", "gaussian", "loess", "linear", "first-diff"),
  bandwidth = NULL,
  span = NULL,
  degree = NULL,
  logtransform = FALSE,
  interpolate = FALSE,
  AR_n = FALSE,
  powerspectrum = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings. If the powerspectrum is to be plotted as well, the timeseries lenght should be even number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winsize</code></td>
<td>
<p>is the size of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 50%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered prior to analysis. There are four options: gaussian filtering, loess fitting, linear detrending and first-differencing. Default is no detrending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>for the Gaussian kernel when gaussian filtering is applied. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Alternatively it can be given by the bandwidth selector bw.nrd0 (Default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>parameter that controls the degree of smoothing (numeric between 0 and 100, Default 25).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of polynomial to be used for when loess fitting is applied, normally 1 or 2 (Default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR_n</code></td>
<td>
<p>logical. If TRUE the best fitted AR(n) model is fitted to the data. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powerspectrum</code></td>
<td>
<p>logical. If TRUE the power spectrum within each rolling window is plotted. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In addition, <code>generic_ews</code> returns three plots. The first plot contains the original data, the detrending/filtering applied and the residuals (if selected), and all the moment statistics. For each statistic trends are estimated by the nonparametric Kendall tau correlation. The second plot, if asked, quantifies resilience indicators fitting AR(n) selected by the Akaike Information Criterion. The third plot, if asked, is the power spectrum estimated by spec.ar for all frequencies within each rolling window.
</p>


<h3>Value</h3>

<p><code>generic_ews</code> returns a matrix that contains:
tim the time index.
ar1 the autoregressive coefficient ar(1) of a first order AR model fitted on the data within the rolling window.
sd the standard deviation of the data estimated within each rolling window.
sk the skewness of the data estimated within each rolling window.
kurt the kurtosis of the data estimated within each rolling window.
cv the coefficient of variation of the data estimated within each rolling window.
returnrate the return rate of the data estimated as 1-ar(1) cofficient within each rolling window.
densratio the density ratio of the power spectrum of the data estimated as the ratio of low frequencies over high frequencies within each rolling window; acf1 the autocorrelation at first lag of the data estimated within each rolling window.
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Ives, A. R. (1995). 'Measuring resilience in stochastic systems.' <em>Ecological Monographs</em> 65: 217-233
</p>
<p>Dakos, V., et al (2008). 'Slowing down as an early warning signal for abrupt climate change.' <em>Proceedings of the National Academy of Sciences</em> 105(38): 14308-14312 
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(foldbif)
out=generic_ews(foldbif,winsize=50,detrending='gaussian',
bandwidth=5,logtransform=FALSE,interpolate=FALSE)
</code></pre>


</div>