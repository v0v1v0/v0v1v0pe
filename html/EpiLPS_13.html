<div class="container">

<table style="width: 100%;"><tr>
<td>nowcasting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nowcasting and estimation of occurred but not yet reported events</h2>

<h3>Description</h3>

<p>This routine can be used to estimate cases that have not yet been reported also known as
occurred-but-not-yet-reported-events. Daily cases are typically subject to reporting
delays, so that the reported number of infected individuals is not always reflecting the
true epidemic status. Nowcasting aims to correct this underreporting phenomenon by estimating
the number of infections that have occurred but that have not yet been reported. The
latter number is then combined with the already reported cases and interpreted as a nowcast or
prediction for the true epidemic status regarding the number of daily cases. The routine
is anchored around Laplacian-P-splines in an epidemic context (Gressani et al. 2022) and the
detailed methodology can be found in Sumalinab et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">nowcasting(data, day.effect = TRUE, ref.day = "Monday", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the data for each time and delay combination with
the following 6 columns. The first column is a numeric variable associated to the calendar date.
The second column is a numeric variable indicating the delay of reporting. The third column
corresponds to the calendar date of the event (e.g. death) and the fourth column to the
calendar date at which the event of interest was reported. The fifth column indicates the
number of cases for each time and delay combination. Finally, the sixth column indicates whether
the cases are already reported or not yet reported. To see an example of such a data structure
type <code>data("cov19mort2021")</code> and then <code>head(cov19mort2021)</code>. This will illustrate the
data structure used for nowcasting the daily number of cases based on mortality data for Belgium
in 2021.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>day.effect</code></td>
<td>
<p>If TRUE (defaut), include the day of the week effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.day</code></td>
<td>
<p>If <code>day.effect = TRUE</code>, then the reference category for
the day of the week must be specified. The default is "Monday".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Show summary output of nowcast in console? Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li>
<p> data: The data frame used as an input.
</p>
</li>
<li>
<p> cases.now: A data frame containing the nowcasting results with <code class="reqn">95\%</code> prediction intervals.
</p>
</li>
<li>
<p> delay: A data frame containing the two-dimensional delay distribution.
</p>
</li>
<li>
<p> lambda_estim: Estimated penalty parameters of the P-splines model.
</p>
</li>
<li>
<p> phi_estim: Estimated overdispersion parameter from the negative binomial model.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Bryan Sumalinab (writing) and Oswaldo Gressani (editing).
</p>


<h3>References</h3>

<p>Gressani, O., Wallinga, J., Althaus, C. L., Hens, N. and Faes, C.
(2022). EpiLPS: A fast and flexible Bayesian tool for estimation of the
time-varying reproduction number. <em>Plos Computational Biology</em>,
<strong>18</strong>(10): e1010618.
</p>
<p>Sumalinab, B., Gressani, O., Hens, N. and Faes, C. (2023). Bayesian
nowcasting with Laplacian-P-splines. MedRxiv preprint.
<a href="https://www.medrxiv.org/content/10.1101/2022.08.26.22279249v2">https://www.medrxiv.org/content/10.1101/2022.08.26.22279249v2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data("cov19mort2021")
# ncast &lt;- nowcasting(data = cov19mort2021, day.effect = FALSE)
# plot(ncast) # Show nowcasted cases
# plot(ncast, type = "delay") # Show contour of delay distribution

</code></pre>


</div>