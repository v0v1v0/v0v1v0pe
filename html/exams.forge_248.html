<div class="container">

<table style="width: 100%;"><tr>
<td>pprobability</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Polynomial Probability</h2>

<h3>Description</h3>

<p>Creates for each value of a discrete random variable, a polynomial and estimates the least squares and the maximum likelihood solution.
The following conditions stand:
</p>

<ul>
<li>
<p> If <code>sample</code> is not given then the sample contains each <code>x</code> value once.
</p>
</li>
<li>
<p> If <code>sample</code> is an integer, then it is interpreted as the sample size and a sample is generated by <code>rmultinom(1, sample, ddiscrete(runif(length(x))))</code>.
</p>
</li>
<li>
<p> If <code>sample</code> is a vector, it is interpreted in such a way that the corresponding <code>x[i]</code> value occurs <code>i</code> times in the sample. Thus, <code>sum(sample)</code> is the sample size.
</p>
</li>
<li>
<p> If <code>coeff</code> is a <code>polylist</code> of <code>length(x)</code>, then these polynomials are taken.
</p>
</li>
<li>
<p> If <code>coeff</code> is a <code>matrix</code> with <code>length(x)</code>, columns and <code>power+1</code> rows, then the columns are interpreted as the coefficients of a polynomial.
</p>
</li>
<li>
<p> Otherwise <code>coeff</code> is interpreted as a vector from which the coefficient is sampled. The intercepts are sampled via <code>ddiscrete(runif(length(x)), zero=zero)</code>.
If <code>coeff</code> is not given then it is ensured that the least squares and the maximum likelihood solution exists and the estimated probabilities are between zero and one.
Otherwise, the results may contain <code>NA</code> or the estimated probabilities are outside the interval <code class="reqn">[0;1]</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">pprobability(
  x,
  power = 1,
  zero = FALSE,
  coef = round(seq(-1, 1, by = 0.1), 1),
  sample = rep(1, length(x)),
  pl = NULL,
  tol = 1e-09
)

polynomial_probability(
  x,
  power = 1,
  zero = FALSE,
  coef = round(seq(-1, 1, by = 0.1), 1),
  sample = rep(1, length(x)),
  pl = NULL,
  tol = 1e-09
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric: values of a discrete random variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>integer: the degree for the polynomials (default: <code>1</code>), must be larger 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero</code></td>
<td>
<p>logical: are zero coefficients and zero samples allowed? (default: <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>matrix: for each degree coefficients to sample from (default: <code>seq(-1, 1, by=0.1)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>integer: number of <code class="reqn">x</code> values in the sample or sample size (default: <code>rep(1, length(x))</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>polylist: a list of polynomials which describes the probability for <code class="reqn">x</code> (default: <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric: tolerance to detect zero values (default: <code>1e-9</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the components:
</p>

<ul>
<li> <p><code>p</code>: the polynomials for the probabilities
</p>
</li>
<li> <p><code>ep</code>: the expected value as polynomial
</p>
</li>
<li> <p><code>x</code>: the values for the discrete random variable, the same as the input <code>x</code>
</p>
</li>
<li> <p><code>sample</code>: the sample given or generated
</p>
</li>
<li> <p><code>LS$pi</code>: the summands for the least squares problem
</p>
</li>
<li> <p><code>LS$pl</code>: the summands for the least squares problem in LaTeX
</p>
</li>
<li> <p><code>LS$pf</code>: the sum of <code>LS$pi</code>
</p>
</li>
<li> <p><code>LS$df</code>: the derivative of <code>LS$pf</code>
</p>
</li>
<li> <p><code>LS$pest</code>: the estimated parameter, minimum of <code>LS$pf</code>
</p>
</li>
<li> <p><code>LS$p</code>: the estimated probabilities
</p>
</li>
<li> <p><code>ML$pi</code>: the factors for the maximum likelihood problem
</p>
</li>
<li> <p><code>ML$pl</code>: the summands for the maximum likelihood problem in LaTeX
</p>
</li>
<li> <p><code>ML$pf</code>: the product of <code>ML$pi</code>
</p>
</li>
<li> <p><code>ML$df</code>: the derivative of <code>ML$pf</code>
</p>
</li>
<li> <p><code>ML$pest</code>: the estimated parameter, maximum of <code>ML$pf</code>
</p>
</li>
<li> <p><code>ML$p</code>: the estimated probabilities
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># linear polynomials
pprobability(0:2)
pprobability(0:2, power=1)
# constant polynomials, some NAs are generated
pprobability(0:3, power=0)
# polynomials generated from a different set
pprobability(0:2, coef=seq(-2, 2, by=0.1))
pprobability(0:2, 0, coef=seq(-2, 2, by=0.1))
# polynomials (x, x, 1-2*x) are used
pprobability(0:2, 0, coef=matrix(c(0.4, 0.4, 0.3), ncol=3))
pprobability(0:2, 1, coef=polylist(c(0,1), c(0,1), c(1, -2)))
</code></pre>


</div>