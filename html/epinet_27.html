<div class="container">

<table style="width: 100%;"><tr>
<td>write.epinet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Writes posterior samples from an epinet object to an output file</h2>

<h3>Description</h3>

<p>Outputs posterior samples of an object created by the
<code>epinet</code> inference routine; creates two output files.</p>


<h3>Usage</h3>

<pre><code class="language-R">write.epinet(out, filename)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>an object of class epinet, produced from the <code>epinet</code> inference function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>the name of the output file.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>Writes two output files corresponding to the output produced from the <code>epinet</code> 
inference function.  The first is a .log file, containing the posterior samples from the 
epidemic parameters in tab delimited form.  [This .log file can be read by Tracer, which calculates summary
statististics and diagnostics, and displays trace plots, histograms, etc.]  The second file
(which is only written if the transmission trees are returned from the inference routine),
is a .trees file, containing the inferred transmission trees, output in Newick format. 
</p>


<h3>Value</h3>

<p> Strictly invoked for side effect.</p>


<h3>Author(s)</h3>

<p> David Welch <a href="mailto:david.welch@auckland.ac.nz">david.welch@auckland.ac.nz</a>,
Chris Groendyke <a href="mailto:cgroendyke@gmail.com">cgroendyke@gmail.com</a> </p>


<h3>References</h3>

<p>Rambaut A., Suchard M., Xie D., Drummond A.J. 2014. Tracer v1.6. <a href="http://beast.community/tracer.html">http://beast.community/tracer.html</a>.
</p>


<h3>See Also</h3>

<p><code>epinet</code> for generating posterior samples of the parameters, 
<code>print.epinet</code> and <code>summary.epinet</code> for printing basic
summary information about an epinet object, <code>epi2newickmcmc</code> for
printing an inferred transmission tree to the screen in Newick format, and
<code>plot.epinet</code> for plotting the posterior samples of the transmission tree.</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate an epidemic through a network of 30
set.seed(3)
N &lt;- 30
# Build dyadic covariate matrix (X)
# Have a single covariate for overall edge density; this is the Erdos-Renyi model
nodecov &lt;- matrix(1:N, nrow = N)
dcm &lt;- BuildX(nodecov)
# Simulate network and then simulate epidemic over network
examplenet &lt;- SimulateDyadicLinearERGM(N, dyadiccovmat = dcm, eta = -1.8)
exampleepidemic &lt;- SEIR.simulator(examplenet, N = 30, 
    beta = 0.3, ki = 2, thetai = 5, latencydist = "gamma")
# Set inputs for MCMC algorithm
mcmcinput &lt;- MCMCcontrol(nsamp = 5000, thinning = 10, etapropsd = 0.2) 
priorcontrol &lt;- priorcontrol(bprior = c(0, 1), tiprior = c(1, 3), teprior = c(1, 3), 
    etaprior = c(0, 10), kiprior = c(2, 8), keprior = c(2, 8), priordists = "uniform")
# Run MCMC algorithm on this epidemic
# Note: Not enough data or iterations for any real inference
examplemcmc &lt;- epinet( ~ 1, exampleepidemic, dcm, mcmcinput, priorcontrol)
## Not run: write.epinet(examplemcmc, "examplemcmc")

## Not run: 
# Note: This may take a few minutes to run.
set.seed(1)
N &lt;- 50
mycov &lt;- data.frame(id = 1:N, xpos = runif(N), ypos = runif(N))
dyadCov &lt;- BuildX(mycov, binaryCol = list(c(2, 3)),binaryFunc = c("euclidean"))
# Build network
eta &lt;- c(0,-7)
net &lt;- SimulateDyadicLinearERGM(N = N, dyadiccovmat = dyadCov, eta = eta)
# Simulate epidemic
epi &lt;- SEIR.simulator(M = net, N = N, beta = 1, ki = 3, thetai = 7, ke = 3, latencydist = "gamma")
# Run MCMC routine on simulated epidemic
mcmcinput &lt;- MCMCcontrol(nsamp = 1000000, thinning = 100, etapropsd = c(1, 1))
priors &lt;- priorcontrol(bprior = c(0, 4), tiprior = c(1, 15), teprior = c(1, 15), 
	etaprior = c(0, 10, 0, 10), kiprior = c(1, 7), keprior = c(1, 7), priordists = "uniform")
out &lt;- epinet(~ xpos.ypos.L2Dist, epidata = epi, dyadiccovmat = dyadCov,
	mcmcinput = mcmcinput, priors = priors)
write.epinet(out, "SampleInferenceOutput")

## End(Not run)

</code></pre>


</div>