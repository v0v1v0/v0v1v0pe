<div class="container">

<table style="width: 100%;"><tr>
<td>rsaddle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate random variables from the Extended Empirical Saddlepoint density (ESS)</h2>

<h3>Description</h3>

<p>Simulate random variables from the Extended Empirical Saddlepoint density (ESS), using importance 
sampling and then resampling according to the importance weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsaddle(
  n,
  X,
  decay,
  ml = 2,
  multicore = !is.null(cluster),
  cluster = NULL,
  ncores = detectCores() - 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of simulated vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an m by d matrix containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decay</code></td>
<td>
<p>rate at which the ESS falls back on a normal density. Should be a positive number. See Fasiolo et al. (2016)
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml</code></td>
<td>
<p>n random variables are generated from a Gaussian importance density with covariance matrix 
<code>ml*cov(X)</code>. By default the inflation factor is <code>ml=2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicore</code></td>
<td>
<p>if TRUE the ESS densities corresponding the samples will be evaluated in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>an object of class <code>c("SOCKcluster", "cluster")</code>. This allowes the user to pass her own cluster,
which will be used if <code>multicore == TRUE</code>. The user has to remember to stop the cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>dsaddle</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Notice that, while importance sampling is used, the output is a matrix of unweighted samples, obtained by resampling
with probabilities proportional to the importance weights.
</p>


<h3>Value</h3>

<p>An n by d matrix containing the simulated vectors.
</p>


<h3>Author(s)</h3>

<p>Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.
</p>


<h3>References</h3>

<p>Fasiolo, M., Wood, S. N., Hartig, F. and Bravington, M. V. (2016). 
An Extended Empirical Saddlepoint Approximation for Intractable Likelihoods. ArXiv http://arxiv.org/abs/1601.01849.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate bivariate data, where each marginal distribution is Exp(2)
X &lt;- matrix(rexp(2 * 1e3), 1e3, 2)

# Simulate bivariate data from a saddlepoint fitted to X
Z &lt;- rsaddle(1000, X, decay = 0.5)

# Look at first marginal distribution
hist( Z[ , 1] )
</code></pre>


</div>