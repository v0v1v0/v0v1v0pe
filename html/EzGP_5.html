<div class="container">

<table style="width: 100%;"><tr>
<td>EzGP_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Fitting Function of <code>EzGP</code> Model</h2>

<h3>Description</h3>

<p>Fits an Easy-to-Interpret Gaussian process (EzGP) model to a dataset as described in <code>reference 1</code>.
The input variables are mixed (with both quantitative and qualitative inputs)
The output variable is quantitative and scalar.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EzGP_fit(
  X,
  Y,
  p,
  q,
  m,
  tau = 0,
  lb = "T",
  ub = "T",
  x0 = "T",
  xtol_rel = 1e-05,
  maxeval = 100,
  algorithm = "NLOPT_LD_LBFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector containing the outputs of training data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A vector containing numbers of levels in the qualitative factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>Vector with lower bounds of the parameter estimation. "T" for applying the default setting of lb (a vector of length number of parameters whose elements are all 0.1), otherwise one must provide a vector with length of the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>Vector with upper bounds of the parameter estimation. "T" for applying the default setting of ub (a vector of length number of parameters whose first <code>q+1</code> elements are 100 and the rest <code>number of parameters - q - 1</code> elements are 10), otherwise one must provide a vector with the length being the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>Vector with starting values for the optimization. "T" for applying the default setting of x0 (a vector made by <code>(lb + ub)/2</code>), otherwise one must provide a vector with the length being the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtol_rel</code></td>
<td>
<p>Stopping criterion for relative change reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxeval</code></td>
<td>
<p>Termination condition by specifying a maximum number of function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>Optimization algorithm. See <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">NLopt Algorithms</a> for more availiable algorithms.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A model of class "EzGP model" list of the following items:
</p>

<ul>
<li>
<p><code>param</code> A list containing the estimated parameters
</p>
</li>
<li>
<p><code>data</code> A list containing the dataset and the information for fitting
</p>
</li>
</ul>
<h3>References</h3>


<ol><li>
<p> "EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors", Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>
<h3>See Also</h3>

<p><code>EzGP_predict</code> to use the fitted EzGP model for prediction.<br></p>


<h3>Examples</h3>

<pre><code class="language-R"># Example with 3 quantitative and 3 qualitative variables (dataset included in the package):
#     Fit an EzGP model (with default settings), and then perform the prediction.
#     This example may run for a while.
p = 3
q = 3
m=c(3,3,3)
tau = 0
X = EzGP_data[1:15, 1:(p+q)]
Y = EzGP_data[1:15, p+q+1]
X_new = EzGP_data[16:20, 1:(p+q)]
# EzGP Model and Prediction
model &lt;- EzGP_fit(X, Y, p, q, m)
pred &lt;- EzGP_predict(X_new, model, MSE_on = 1)
result &lt;- LLF_gradients(X, Y, p, q, m, model$param)
# Results showing
model
pred
result
</code></pre>


</div>