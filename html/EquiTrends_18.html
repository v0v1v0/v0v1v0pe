<div class="container">

<table style="width: 100%;"><tr>
<td>rmsEquivTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Equivalence Test for Pre-trends based on the RMS Placebo Coefficient</h2>

<h3>Description</h3>

<p>This function performs an equivalence test for pre-trends based on the root mean squared placebo coefficient from Dette &amp; Schumann (2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmsEquivTest(
  Y,
  ID,
  G,
  period,
  X = NULL,
  data = NULL,
  equiv_threshold = NULL,
  pretreatment_period = NULL,
  base_period = NULL,
  alpha = 0.05,
  no_lambda = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A numeric vector with the variable of interest. If <code>data</code> is supplied, <code>Y</code> should be a scalar indicating the column number or column-name character string that corresponds to the numeric dependent (outcome) variable in ’data’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>A numeric vector identifying the different cross-sectional units in the dataset. If <code>data</code> is supplied, <code>ID</code> should be a scalar indicating the column number or column-name character string that corresponds to the cross-sectional units identifier in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A binary or logic vector (of the same dimension as <code>Y</code> and <code>ID</code>) indicating if the individual (e.g. as indicated by <code>ID</code>) receives treatment (e.g. 1 or TRUE) or not (0 or FALSE). f 'data' is supplied, <code>G</code> should be a scalar identifying the column number or column-name character string associated to <code>G</code> in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>A numeric vector (of the same dimension as Y) indicating time. If <code>data</code> is supplied, <code>period</code> should be a scalar indicating the column number or column-name character string that corresponds to the time identifier in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A vector, matrix, or data.frame containing the control variables. If <code>data</code> is supplied, <code>X</code> must be a vector of column numbers or column-name character strings that identifies the control variables’ columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional <code>data.frame</code> object containing the variables in Y, ID, G, T and, if supplied, X and cluster as its columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equiv_threshold</code></td>
<td>
<p>The scalar equivalence threshold (must be positive). The default is NULL, implying that the function must look for the minimum value for which the null hypothesis of ”non-negligible differences” can still be rejected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pretreatment_period</code></td>
<td>
<p>A numeric vector identifying the pre-treatment periods that should be used for testing. <code>pretreatment_period</code> must be a subset of the periods included through <code>period</code>. The default is to use all periods that are included in <code>period</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_period</code></td>
<td>
<p>The pre-treatment period to compare the post-treatment observation to. The default is to take the last period of the pre-treatment period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level of the test. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_lambda</code></td>
<td>
<p>Parameter specifying the number of incremental segments of the dataset over which a statistic is calculated. See <em>Details</em>. The default is 5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>no_lambda</code> determines the proportions lambda/<code>no.lambda</code> for lambda = 1,...,<code>no_lambda</code> of the cross-sectional units at which the placebo coefficients are estimated. The placebo coefficients are estimated for each of these proportions and the root mean squared (RMS) of the placebo coefficients is calculated, which are then used to construct the critical value at a significance level of <code>alpha</code>. See Dette &amp; Schumann (2024, s. 4.2.3.) for more details.
</p>
<p>One should note that rows containing <code>NA</code> values are removed from the panel before the testing procedure is performed.
</p>
<p>Please be aware that the equivalence test based on the root mean squared placebo coefficient uses a randomization technique (as described by Dette &amp; Schumann (2024)), leading to a stochastic critical value and minimum equivalence threshold. Therefore, the results may vary slightly between different runs of the function. For reproducibility, it is recommended to set a seed before using the function.
</p>


<h3>Value</h3>

<p>An object of class "rmsEquivTest" containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>placebo_coefficients</code></td>
<td>
<p>A numeric vector of the estimated placebo coefficients,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rms_placebo_coefs</code></td>
<td>
<p>the root mean squared value of the placebo coefficients,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>significance_level</code></td>
<td>
<p>the significance level of the test,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_period</code></td>
<td>
<p>the base period used in the testing procedure,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_individuals</code></td>
<td>
<p>the number of cross-sectional individuals in the panel used for testing,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_periods</code></td>
<td>
<p>the number of pre-treatment periods in the panel used for testing (if the panel is unbalanced, <code>num_periods</code> represents the range in the number of time periods covered by different individuals),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_observations</code></td>
<td>
<p>the total number of observations in the panel used for testing,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_panel_balanced</code></td>
<td>
<p>a logical value indicating whether the panel is balanced,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equiv_threshold_specified</code></td>
<td>
<p>a logical value indicating whether an equivalence threshold was specified.</p>
</td>
</tr>
</table>
<p>If <code>equiv_threshold_specified = FALSE</code>, then additionally <code>minimum_equiv_threshold</code>: the minimum equivalence threshold for which the null hypothesis of non-negligible (based on the equivalence threshold) trend-differences can be rejected. 
</p>
<p>If <code>equiv_threshold_specified = TRUE</code>, then additionally
</p>

<ul>
<li> <p><code>rms_critical_value</code>: the critical value at the alpha level,
</p>
</li>
<li> <p><code>reject_null_hypothesis</code>: A logical value indicating whether to reject the null hypothesis,
</p>
</li>
<li> <p><code>equiv_threshold</code>: the equivalence threshold specified.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ties Bos
</p>


<h3>References</h3>

<p>Dette, H., &amp; Schumann, M. (2024). "Testing for Equivalence of Pre-Trends in Difference-in-Differences Estimation." <em>Journal of Business &amp; Economic Statistics</em>, 1–13. DOI: <a href="https://doi.org/10.1080/07350015.2024.2308121">doi:10.1080/07350015.2024.2308121</a>
</p>


<h3>See Also</h3>

<p><code>print.rmsEquivTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a balanced panel dataset with 500 cross-sectional units (individuals), 
# 5 time periods (labeled 1-5), a binary variable indicating which individual 
# receives treatment and 2 control variables ("X_1" and "X_2"). 
# The error-terms are generated without  heteroscedasticity,  autocorrelation, 
# or any significant clusters. Furthermore, there are no fixed effects and 
# no pre-trends present in the data (all values in  beta are 0). 
# See sim_paneldata() for more details.

sim_data &lt;- sim_paneldata(N = 500, tt = 5, p = 2, beta = rep(0, 5), 
                          gamma = rep(1, 2), het = 0, phi = 0, sd = 1, 
                          burnins = 50)

# Perform the equivalence test using an equivalence threshold of 1 with periods 
# 1-4 as pre-treatment periods based on the RMS testing procedure:
#  - option 1: using column names in the panel
# One can use the names of the columns in the panel to specify the variables:
rmsEquivTest(Y = "Y", ID = "ID", G = "G", period = "period", X = c("X_1", "X_2"),
             data = sim_data, equiv_threshold = 1, pretreatment_period = 1:4,
             base_period = 4)

#  - option 2: using column numbers in the panel 
# Alternatively, one can use the column numbers in the panel to specify the variables:
rmsEquivTest(Y = 3, ID = 1, G = 4, period = 2, X = c(5, 6),
             data = sim_data, equiv_threshold = 1, pretreatment_period = 1:4,
             base_period = 4)
             
#  - option 3: using separate variables 
# One can also use the variables directly without specifying the data variable:
data_Y &lt;- sim_data$Y
data_ID &lt;- sim_data$ID
data_G &lt;- sim_data$G
data_period &lt;- sim_data$period
data_X &lt;- cbind(sim_data$X_1, sim_data$X_2)

rmsEquivTest(Y = data_Y, ID = data_ID, G = data_G, period = data_period, X = data_X,
             equiv_threshold = 1, pretreatment_period = 1:4,
             base_period = 4)

# The testing procedures can also be performed without specifying the 
# equivalence threshold specified. Then, the minimum equivalence threshold is returned
# for which the null hypothesis of non-negligible trend-differences can be rejected.
# Again, the three possible ways of entering the data as above can be used:
rmsEquivTest(Y = "Y", ID = "ID", G = "G", period = "period", X = c("X_1", "X_2"),
             data = sim_data, equiv_threshold = NULL, pretreatment_period = 1:4,
             base_period = 4)

rmsEquivTest(Y = 3, ID = 1, G = 4, period = 2, X = c(5, 6),
             data = sim_data, equiv_threshold = NULL, pretreatment_period = 1:4,
             base_period = 4)
             
rmsEquivTest(Y = data_Y, ID = data_ID, G = data_G, period = data_period, X= data_X,
             equiv_threshold = NULL, pretreatment_period = 1:4,
             base_period = 4)

# Finally, one should note that the test procedure also works for unbalanced panels.
# To illustrate this, we generate an unbalanced panel dataset by randomly selecting
# 70% of the observations from the balanced panel dataset:

random_indeces &lt;- sample(nrow(sim_data), 0.7*nrow(sim_data))
unbalanced_sim_data &lt;- sim_data[random_indeces, ]
#  With Equivalence Threshold:
rmsEquivTest(Y = 3, ID = 1, G = 4, period = 2, X = c(5, 6),
             data = unbalanced_sim_data, equiv_threshold = 1, 
             pretreatment_period = 1:4, base_period = 4)

#  Without Equivalence Threshold:
rmsEquivTest(Y = 3, ID = 1, G = 4, period = 2, X = c(5, 6),
             data = unbalanced_sim_data, equiv_threshold = NULL, 
             pretreatment_period = 1:4, base_period = 4)


</code></pre>


</div>