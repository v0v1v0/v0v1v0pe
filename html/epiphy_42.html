<div class="container">

<table style="width: 100%;"><tr>
<td>mapcomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map Comparison procedure.</h2>

<h3>Description</h3>

<p><code>mapcomp</code> performs a spatial pattern analysis based on the calculation
of a formal distance (the Hellinger distance) between the density map of
count or incidence data, and the density map of sampling effort. Statistical
tests of spatial homogeneity are based on permutations across sampling sites
and on valuable properties of the Hellinger distance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mapcomp(data, ...)

## S3 method for class 'data.frame'
mapcomp(
  data,
  delta,
  bandwidth,
  nperm = 100,
  edge_correction = FALSE,
  threads = 1,
  verbose = TRUE,
  ...
)

## S3 method for class 'matrix'
mapcomp(
  data,
  delta,
  bandwidth,
  nperm = 100,
  edge_correction = FALSE,
  threads = 1,
  verbose = TRUE,
  ...
)

## S3 method for class 'count'
mapcomp(
  data,
  delta,
  bandwidth,
  nperm = 100,
  edge_correction = FALSE,
  threads = 1,
  verbose = TRUE,
  ...
)

## S3 method for class 'incidence'
mapcomp(
  data,
  delta,
  bandwidth,
  nperm = 100,
  edge_correction = FALSE,
  threads = 1,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or a matrix with only three columns: the two first
ones must be the x and y coordinates of the sampling units, and the last
one, the corresponding disease intensity observations. It can also be a
<code>count</code> or an <code>incidence</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Mesh size of the grid over the geographical domain of the
sampling units used to compute the integral Hellinger distance between
the probability density function of observations and the probability
density function of sampling effort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>Bandwidth parameter for smoothing. It allows to test the
spatial extent of heterogeneity if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of random permutations to assess probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_correction</code></td>
<td>
<p>Apply edge correction to account for the fact that
bordering points intrinsically suffer from a lack of neighboring
observation sites. FALSE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>Number of threads to perform the computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Explain what is being done (TRUE by default).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>mapcomp</code>, which is a list containing the following
components:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>data</code>       </td>
<td style="text-align: left;"> The input data. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>coord</code>      </td>
<td style="text-align: left;"> The coordinates and normalized intensity for each point of the full grid. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>object</code>     </td>
<td style="text-align: left;"> The class of <code>data</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>bandwidth</code>  </td>
<td style="text-align: left;"> The <code>bandwidth</code> parameter. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>stat, pval</code> </td>
<td style="text-align: left;"> The statistic and corresponding p-value (see references for more details). </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Lavigne C, Ricci B, Franck P, Senoussi R. 2010. Spatial analyses of
ecological count data: A density map comparison approach. Basic and Applied
Ecology. 11:734â€“742.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
my_res &lt;- mapcomp(codling_moths, delta = 1, bandwidth = 11,
                  edge_correction = FALSE, nperm = 20)
my_res
plot(my_res)

set.seed(123)
my_count &lt;- count(codling_moths, mapping(x = xm, y = ym))
my_res &lt;- mapcomp(my_count, delta = 1, bandwidth = 11,
                  edge_correction = FALSE, nperm = 20)
my_res
plot(my_res, bins = 10)

</code></pre>


</div>