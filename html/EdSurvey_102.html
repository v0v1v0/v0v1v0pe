<div class="container">

<table style="width: 100%;"><tr>
<td>rq.sdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EdSurvey Quantile Regression Models</h2>

<h3>Description</h3>

<p>Fits a quantile regression model that uses weights and variance estimates appropriate for the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rq.sdf(
  formula,
  data,
  tau = 0.5,
  weightVar = NULL,
  relevels = list(),
  jrrIMax = 1,
  dropOmittedLevels = TRUE,
  defaultConditions = TRUE,
  recode = NULL,
  returnNumberOfPSU = FALSE,
  omittedLevels = deprecated(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code> for the
quantile regression model. See <code>rq</code>.
If <em>y</em> is left blank, the default subject scale or subscale variable
will be used. (You can find the default using
<code>showPlausibleValues</code>.)
If <em>y</em> is a variable for a subject scale or subscale (one of the
names shown by <code>showPlausibleValues</code>),
then that subject scale or subscale is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an <code>edsurvey.data.frame</code>, a <code>light.edsurvey.data.frame</code>,
or an <code>edsurvey.data.frame.list</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the quantile to be estimated. The value could be set between 0 and 1 with a default of 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightVar</code></td>
<td>
<p>a character indicating the weight variable to use.
The <code>weightVar</code> must be one of the weights for the
<code>edsurvey.data.frame</code>. If <code>NULL</code>, it  uses the default
for the <code>edsurvey.data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relevels</code></td>
<td>
<p>a list. Used to change the contrasts from the
default treatment contrasts to the treatment contrasts with a chosen omitted
group (the reference group). The name of each element should be the variable name, and the value
should be the group to be omitted (the reference group).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jrrIMax</code></td>
<td>
<p>when using the jackknife variance estimation method, the default estimation option, <code>jrrIMax=1</code>, uses the
sampling variance from the first plausible value as the component for sampling variance estimation. The <code class="reqn">V_{jrr}</code>
term can be estimated with any number of plausible values, and values larger than the number of
plausible values on the survey (including <code>Inf</code>) will result in all plausible values being used.
Higher values of <code>jrrIMax</code> lead to longer computing times and more accurate variance estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropOmittedLevels</code></td>
<td>
<p>a logical value. When set to the default value of <code>TRUE</code>, drops
those levels of all factor variables that are specified
in an <code>edsurvey.data.frame</code>. Use <code>print</code> on an
<code>edsurvey.data.frame</code> to see the omitted levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaultConditions</code></td>
<td>
<p>a logical value. When set to the default value of <code>TRUE</code>, uses
the default conditions stored in an <code>edsurvey.data.frame</code>
to subset the data. Use <code>print</code> on an
<code>edsurvey.data.frame</code> to see the default conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recode</code></td>
<td>
<p>a list of lists to recode variables. Defaults to <code>NULL</code>. Can be set as
<code>recode=</code><code>list(</code><code>var1</code> <code>=</code> <code>list(</code><code>from=</code>
<code>c("a",</code> <code>"b",</code> <code>"c"),</code> <code>to=</code> <code>"d"))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnNumberOfPSU</code></td>
<td>
<p>a logical value set to <code>TRUE</code> to return the number of
primary sampling units (PSUs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omittedLevels</code></td>
<td>
<p>this argument is deprecated. Use <code>dropOmittedLevels</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed from <code>rq</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes an estimate on the <code>tau</code>-th conditional quantile function of the response,
given the covariates, as specified by the formula argument. Like <code>lm.sdf()</code>, the
function presumes a linear specification for the quantile regression model (i.e., that the
formula defines a model that is linear in parameters). Unlike <code>lm.sdf()</code>, the jackknife is the
only applicable variance estimation method used by the function.
</p>
<p>For further details on quantile regression models and how they are implemented in R, see Koenker
and Bassett (1978), Koenker (2005), and the vignette from the <code>quantreg</code> package—
accessible by <code>vignette("rq",package="quantreg")</code>—on which this function is
built.
</p>
<p>For further details on how left-hand side variables, survey sampling weights, and estimated
variances are correctly handled, see <code>lm.sdf</code> or the vignette titled
<em><a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf">Statistical Methods Used in EdSurvey</a></em>.
</p>


<h3>Value</h3>

<p>An <code>edsurvey.rq</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula used to fit the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the quantile to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>the estimates of the coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the standard error estimates of the coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vimp</code></td>
<td>
<p>the estimated variance from uncertainty in the scores (plausible value variables)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vjrr</code></td>
<td>
<p>the estimated variance from sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the number of plausible values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varm</code></td>
<td>
<p>the variance estimates under the various plausible values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefm</code></td>
<td>
<p>the values of the coefficients under the various plausible values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefmat</code></td>
<td>
<p>the coefficient matrix (typically produced by the summary of a model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>the name of the weight variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npv</code></td>
<td>
<p>the number of plausible values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>njk</code></td>
<td>
<p>the number of the jackknife replicates used; set to <code>NA</code> when Taylor series variance
estimates are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the mean value of the objective function across the plausible values</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Trang Nguyen, Paul Bailey, and Yuqi Liao
</p>


<h3>References</h3>

<p>Binder, D. A. (1983). On the variances of asymptotically normal estimators from complex surveys.
<em>International Statistical Review</em>, <em>51</em>(3), 279–292.
</p>
<p>Johnson, E. G., &amp; Rust, K. F. (1992). Population inferences and variance estimation for NAEP
data. <em>Journal of Education Statistics</em>, <em>17</em>(2), 175–190.
</p>
<p>Koenker, R. W., &amp; Bassett, G. W. (1978). Regression quantiles, <em>Econometrica, 46,</em> 33–50.
</p>
<p>Koenker, R. W. (2005). <em>Quantile regression</em>. Cambridge, UK: Cambridge University Press.
</p>
<p>Rubin, D. B. (1987). <em>Multiple imputation for nonresponse in surveys</em>. New York, NY: Wiley.
</p>


<h3>See Also</h3>

<p><code>rq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# read in the example data (generated, not real student data)
sdf &lt;- readNAEP(path=system.file("extdata/data", "M36NT2PM.dat", package = "NAEPprimer"))

# conduct quantile regression at a given tau value (by default, tau is set to be 0.5) 
rq1 &lt;- rq.sdf(formula=composite ~ dsex + b017451, data=sdf, tau = 0.8)
summary(rq1)

## End(Not run)
</code></pre>


</div>