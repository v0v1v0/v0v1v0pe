<div class="container">

<table style="width: 100%;"><tr>
<td>predIntNormHalfWidth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Half-Width of a Prediction Interval for the next <code class="reqn">k</code> Observations from a Normal Distribution
</h2>

<h3>Description</h3>

<p>Compute the half-width of a prediction interval for the next <code class="reqn">k</code> observations 
from a normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntNormHalfWidth(n, df = n - 1, n.mean = 1, k = 1, sigma.hat = 1, 
    method = "Bonferroni", conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>numeric vector of positive integers greater than 1 indicating the sample size upon 
which the prediction interval is based.
Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
values are not allowed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>numeric vector of positive integers indicating the degrees of freedom associated 
with the prediction interval.  The default is <code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mean</code></td>
<td>

<p>numeric vector of positive integers specifying the sample size associated with 
the <code class="reqn">k</code> future <em>averages</em>.  The default value is 
<code>n.mean=1</code> (i.e., individual observations).  Note that all future averages 
must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>numeric vector of positive integers specifying the number of future observations 
or averages the prediction interval should contain with confidence level 
<code>conf.level</code>.  The default value is <code>k=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.hat</code></td>
<td>

<p>numeric vector specifying the value(s) of the estimated standard deviation(s).  
The default value is <code>sigma.hat=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method to use if the number of future observations 
(<code>k</code>) is greater than 1.  The possible values are <code>method="Bonferroni"</code> 
(approximate method based on Bonferonni inequality; the default), and <br><code>method="exact"</code> (exact method due to Dunnett, 1955).  
This argument is ignored if <code>k=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric vector of values between 0 and 1 indicating the confidence level of the 
prediction interval.  The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the arguments <code>n</code>, <code>k</code>, <code>n.mean</code>, <code>sigma.hat</code>, and 
<code>conf.level</code> are not all the same length, they are replicated to be the 
same length as the length of the longest argument.
</p>
<p>The help files for <code>predIntNorm</code> and <code>predIntNormK</code> 
give formulas for a two-sided prediction interval based on the sample size, the 
observed sample mean and sample standard deviation, and specified confidence level.  
Specifically, the two-sided prediction interval is given by:
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)</code>
</p>
 
<p>where <code class="reqn">\bar{x}</code> denotes the sample mean:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)</code>
</p>

<p><code class="reqn">s</code> denotes the sample standard deviation:
</p>
<p style="text-align: center;"><code class="reqn">s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)</code>
</p>

<p>and <code class="reqn">K</code> denotes a constant that depends on the sample size <code class="reqn">n</code>, the 
confidence level, the number of future averages <code class="reqn">k</code>, and the 
sample size associated with the future averages, <code class="reqn">m</code> (see the help file for 
<code>predIntNormK</code>).  Thus, the half-width of the prediction interval is 
given by:
</p>
<p style="text-align: center;"><code class="reqn">HW = Ks \;\;\;\;\;\; (4)</code>
</p>



<h3>Value</h3>

<p>numeric vector of half-widths.
</p>


<h3>Note</h3>

<p>See the help file for <code>predIntNorm</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>predIntNorm</code>.
</p>


<h3>See Also</h3>

<p><code>predIntNorm</code>, <code>predIntNormK</code>, 
<code>predIntNormN</code>, <code>plotPredIntNormDesign</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Look at how the half-width of a prediction interval increases with 
  # increasing number of future observations:

  1:5 
  #[1] 1 2 3 4 5 

  hw &lt;- predIntNormHalfWidth(n = 10, k = 1:5)

  round(hw, 2) 
  #[1] 2.37 2.82 3.08 3.26 3.41

  #----------

  # Look at how the half-width of a prediction interval decreases with 
  # increasing sample size:

  2:5 
  #[1] 2 3 4 5 

  hw &lt;- predIntNormHalfWidth(n = 2:5)

  round(hw, 2) 
  #[1] 15.56  4.97  3.56  3.04

  #----------

  # Look at how the half-width of a prediction interval increases with 
  # increasing estimated standard deviation for a fixed sample size:

  seq(0.5, 2, by = 0.5) 
  #[1] 0.5 1.0 1.5 2.0 

  hw &lt;- predIntNormHalfWidth(n = 10, sigma.hat = seq(0.5, 2, by = 0.5))

  round(hw, 2) 
  #[1] 1.19 2.37 3.56 4.75

  #----------

  # Look at how the half-width of a prediction interval increases with 
  # increasing confidence level for a fixed sample size:

  seq(0.5, 0.9, by = 0.1) 
  #[1] 0.5 0.6 0.7 0.8 0.9 

  hw &lt;- predIntNormHalfWidth(n = 5, conf = seq(0.5, 0.9, by = 0.1))

  round(hw, 2) 
  #[1] 0.81 1.03 1.30 1.68 2.34

  #==========

  # The data frame EPA.92c.arsenic3.df contains arsenic concentrations (ppb) 
  # collected quarterly for 3 years at a background well and quarterly for 
  # 2 years at a compliance well.  Using the data from the background well, compute 
  # the half-width associated with sample sizes of 12 (3 years of quarterly data), 
  # 16 (4 years of quarterly data), and 20 (5 years of quarterly data) for a 
  # two-sided 90% prediction interval for k=4 future observations.

  EPA.92c.arsenic3.df
  #   Arsenic Year  Well.type
  #1     12.6    1 Background
  #2     30.8    1 Background
  #3     52.0    1 Background
  #...
  #18     3.8    5 Compliance
  #19     2.6    5 Compliance
  #20    51.9    5 Compliance

  mu.hat &lt;- with(EPA.92c.arsenic3.df, 
    mean(Arsenic[Well.type=="Background"])) 

  mu.hat 
  #[1] 27.51667 

  sigma.hat &lt;- with(EPA.92c.arsenic3.df, 
    sd(Arsenic[Well.type=="Background"]))

  sigma.hat 
  #[1] 17.10119 

  hw &lt;- predIntNormHalfWidth(n = c(12, 16, 20), k = 4, sigma.hat = sigma.hat, 
    conf.level = 0.9)

  round(hw, 2) 
  #[1] 46.16 43.89 42.64

  #==========

  # Clean up
  #---------
  rm(hw, mu.hat, sigma.hat)
</code></pre>


</div>