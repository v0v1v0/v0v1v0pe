<div class="container">

<table style="width: 100%;"><tr>
<td>tcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generates Correlated Traits
</h2>

<h3>Description</h3>

<p>Create two random vectors of traits correlated between each other or a vector
of traits correlated to an existing one. The linear correlation is
defined by the parameter <code>rho</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcor(n, rho = 0.5, mar.fun = rnorm, x = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>the integer number of values to be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>a numeric parameter defining the linear correlation between the two
traits (default is 0.5).
It must belong to the interval [-1, 1].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an vector of numeric values. Default is NULL. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar.fun</code></td>
<td>

<p>a function defining the random generation for the trait distribution. Default is
<code>rnorm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments for the <code>mar.fun()</code> function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>rho</code> parameter is set to 0.5 by default. <code>x = NULL</code> by default.
Code adapted from: <a href="http://stats.stackexchange.com/questions/15011/generate-a-random-variable-with-a-defined-correlation-to-an-existing-variable">http://stats.stackexchange.com/questions/15011/generate-a-random-variable-with-a-defined-correlation-to-an-existing-variable</a>
</p>


<h3>Value</h3>

<p>Return a data.frame with two numeric columns, each column defining a trait.
</p>


<h3>Author(s)</h3>

<p>P. Denelle
F. Munoz
</p>


<h3>Examples</h3>

<pre><code class="language-R"># With no predefined trait
traits &lt;- tcor(n = 10000, rho = 0.8)
plot(traits[, 1], traits[, 2])
cor(traits[, 1], traits[, 2])

# With existing trait
existing_trait &lt;- rnorm(10000, 10, 1)
traits &lt;- tcor(n = 10000, rho = 0.8, x = existing_trait)
plot(traits[, 1], traits[, 2])
cor(traits[, 1], traits[, 2])
</code></pre>


</div>