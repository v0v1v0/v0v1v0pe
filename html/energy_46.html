<div class="container">

<table style="width: 100%;"><tr>
<td>Poisson Tests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Goodness-of-Fit Tests for Poisson Distribution</h2>

<h3>Description</h3>

<p>Performs the mean distance goodness-of-fit test and the energy goodness-of-fit test of Poisson distribution with unknown parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">poisson.e(x)
poisson.m(x)
poisson.etest(x, R)
poisson.mtest(x, R)
poisson.tests(x, R, test="all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> vector of nonnegative integers, the sample data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of bootstrap replicates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p> name of test(s) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two distance-based tests of Poissonity are applied in <code>poisson.tests</code>, "M" and "E". The default is to 
do all tests and return results in a data frame. 
Valid choices for <code>test</code> are "M", "E", or "all" with 
default "all". 
</p>
<p>If "all" tests, all tests are performed by a single parametric bootstrap computing all test statistics on each sample. 
</p>
<p>The "M" choice is two tests, one based on a Cramer-von Mises  distance and the other an Anderson-Darling distance. The "E" choice is the energy goodness-of-fit test. 
</p>
<p><code>R</code> must be a positive integer for a test. If <code>R</code> is missing or 0, a warning is printed but test statistics are computed (without testing). 
</p>
<p>The mean distance test of Poissonity (M-test) is based on the result that the sequence
of expected values E|X-j|, j=0,1,2,... characterizes the distribution of
the random  variable X. As an application of this characterization one can
get an estimator <code class="reqn">\hat F(j)</code> of the CDF. The test statistic
(see <code>poisson.m</code>) is a Cramer-von Mises type of distance, with
M-estimates replacing the usual EDF estimates of the CDF:
</p>
<p style="text-align: center;"><code class="reqn">M_n = n\sum_{j=0}^\infty (\hat F(j) - F(j\;; \hat \lambda))^2
 f(j\;; \hat \lambda).</code>
</p>
 
<p>In <code>poisson.tests</code>, an Anderson-Darling type of weight is also applied when <code>test="M"</code> or <code>test="all"</code>.
</p>
<p>The tests are implemented by parametric bootstrap with
<code>R</code> replicates.
</p>
<p>An energy goodness-of-fit test (E) is based on the test statistic
</p>
<p style="text-align: center;"><code class="reqn">Q_n = n (\frac{2}{n} \sum_{i=1}^n E|x_i - X| - E|X-X'| - \frac{1}{n^2} \sum_{i,j=1}^n |x_i - x_j|,
</code>
</p>

<p>where X and X' are iid with the hypothesized null distribution. For a test of H: X ~ Poisson(<code class="reqn">\lambda</code>), we can express E|X-X'| in terms of Bessel functions, and E|x_i - X| in terms of the CDF of Poisson(<code class="reqn">\lambda</code>).
</p>
<p>If test=="all" or not specified, all tests are run with a single parametric bootstrap. <code>poisson.mtest</code> implements only the Poisson M-test with Cramer-von Mises type distance. <code>poisson.etest</code> implements only the Poisson energy test.
</p>


<h3>Value</h3>

<p>The functions <code>poisson.m</code> and <code>poisson.e</code> return the test statistics. The function
<code>poisson.mtest</code> or <code>poisson.etest</code> return an <code>htest</code> object containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Description of test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>observed value of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>approximate p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>replicates R</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>sample mean</p>
</td>
</tr>
</table>
<p><code>poisson.tests</code> returns "M-CvM test", "M-AD test" and "Energy test" results in a data frame with columns 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>sample mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>observed value of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>approximate p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Description of test</p>
</td>
</tr>
</table>
<p>which can be coerced to a <code>tibble</code>.
</p>


<h3>Note</h3>

<p>The running time of the M test is much faster than the E-test.</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Szekely, G. J. and Rizzo, M. L. (2004) Mean Distance Test of Poisson Distribution, <em>Statistics and Probability Letters</em>,
67/3, 241-247. <a href="https://doi.org/10.1016/j.spl.2004.01.005">doi:10.1016/j.spl.2004.01.005</a>.
</p>
<p>Szekely, G. J. and Rizzo, M. L. (2005) A New Test for
Multivariate Normality, <em>Journal of Multivariate Analysis</em>,
93/1, 58-80,
<a href="https://doi.org/10.1016/j.jmva.2003.12.002">doi:10.1016/j.jmva.2003.12.002</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> x &lt;- rpois(50, 2)
 poisson.m(x)
 poisson.e(x)
 
 poisson.etest(x, R=199)
 poisson.mtest(x, R=199)
 poisson.tests(x, R=199)
 
</code></pre>


</div>