<div class="container">

<table style="width: 100%;"><tr>
<td>N2Y</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create risk time ("Person-Years") in Lexis triangles from population count data.
</h2>

<h3>Description</h3>

<p>Data on population size at equidistant dates and age-classes are
used to estimate person-time at risk in Lexis-triangles, i.e. classes
classified by age, period AND cohort (date of birth). Only works for
data where age-classes have the same width as the period-intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">N2Y( A, P, N,
     data = NULL,
     return.dfr = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Name of the age-variable, which should be numeric,
corresponding to the left endpoints of the age intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Name of the period-variable, which should be numeric,
corresponding to the date of population count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The population size at date <code>P</code> in age class <code>A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame in which arguments are interpreted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.dfr</code></td>
<td>
<p>Logical. Should the results be returned as a data frame
(default <code>TRUE</code>) or as a table.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calculation of the risk time from the population figures is
done as described in: B. Carstensen: Age-Period-Cohort models for the
Lexis diagram. Statistics in Medicine, 26: 3018-3045, 2007.
</p>
<p>The number of periods in the result is one less than the number
of dates (<code>nP=length(table(P))</code>) in the input, so the number of
distinct values is <code>2*(nP-1)</code>, because the <code>P</code> in the output
is coded differently for upper and lower Lexis triangles.
</p>
<p>The number of age-classes is the same as in the input
(<code>nA=length(table(A))</code>), so the number of distinct values is
<code>2*nA</code>, because the <code>A</code> in the output is coded differently
for upper and lower Lexis triangles.
</p>
<p>In the paper "Age-Period-Cohort models for the Lexis diagram" I
suggest that the risk time in the lower triangles in the first
age-class and in the upper triangles in the last age-class are
computed so that the total risk time in the age-class corresponds to
the average of the two population figures for the age-class at either
end of a period multiplied with the period length. This is the method
used.
</p>


<h3>Value</h3>

<p>A data frame with variables <code>A</code>, <code>P</code> and <code>Y</code>,
representing the mean age and period in the Lexis triangles and the
person-time in them, respectively. The person-time is in units of the
distance between population count dates.
</p>
<p>If <code>return.dfr=FALSE</code> a three-way table classified by the left end
point of the age-classes and the periods and a factor <code>wh</code> taking
the values <code>up</code> and <code>lo</code> corresponding to upper (early
cohort) and lower (late cohort) Lexis triangles.
</p>


<h3>Author(s)</h3>

<p>Bendix Carstensen, <a href="http://bendixcarstensen.com">http://bendixcarstensen.com</a>
</p>


<h3>References</h3>

<p>B. Carstensen: Age-Period-Cohort models for the
Lexis diagram. Statistics in Medicine, 26: 3018-3045, 2007.
</p>


<h3>See Also</h3>

<p><code>splitLexis</code>, <code>apc.fit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Danish population at 1 Jan each year by sex and age
data( N.dk )
# An illustrative subset
( Nx &lt;- subset( N.dk, sex==1 &amp; A&lt;5 &amp; P&lt;1975 ) )
# Show the data in tabular form
xtabs( N ~ A + P, data=Nx )
# Lexis triangles as data frame
Nt &lt;- N2Y( data=Nx, return.dfr=TRUE )
xtabs( Y ~ round(A,2) + round(P,2), data=Nt )
# Lexis triangles as a 3-dim array
ftable( N2Y( data=Nx, return.dfr=FALSE ) )

# Calculation of PY for persons born 1970 in 1972
( N.1.1972 &lt;- subset( Nx, A==1 &amp; P==1972)$N )
( N.2.1973 &lt;- subset( Nx, A==2 &amp; P==1973)$N )
N.1.1972/3 + N.2.1973/6
N.1.1972/6 + N.2.1973/3
# These numbers can be found in the following plot:

# Blue numbers are population size at 1 January
# Red numbers are the computed person-years in Lexis triangles:
Lexis.diagram(age=c(0,5), date=c(1970,1975), int=1, coh.grid=TRUE )
with( Nx, text(P,A+0.5,paste(N),srt=90,col="blue") )
with( Nt, text(P,A,formatC(Y,format="f",digits=1),col="red") )
text( 1970.5, 2, "Population count 1 January", srt=90, col="blue")
text( 1974.5, 2, "Person-\nyears", col="red")
</code></pre>


</div>