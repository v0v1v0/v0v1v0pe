<div class="container">

<table style="width: 100%;"><tr>
<td>WRegTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test the case weighted regression estimator by Empirical Likelihood</h2>

<h3>Description</h3>

<p>Use the empirical likelihood ratio and Wilks theorem to test if the
regression coefficient is equal to <code>beta0</code>, 
by the case weighted estimation method.
</p>
<p>The log empirical likelihood been maximized is
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{d=1} \log \Delta F(y_i) + \sum_{d=0} \log [1-F(y_i)].</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">WRegTest(x, y, delta, beta0, psifun=function(t){t})
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of size N by q. Random design matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of length N, containing the censored responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a vector (length N) of either 1's or 0's. 
delta=1 means y is uncensored;
delta=0 means y is right censored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>a vector of length q. The value of the regression 
coefficient to be tested in the linear model </p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>psifun</code></td>
<td>
<p>the estimating function. The definition of it determines
the type of estimator under testing. </p>
</td>
</tr></table>
<h3>Details</h3>

<p>The above likelihood should be understood as the likelihood of the 
censored responses <code>y</code> and <code>delta</code>. 
</p>
<p>This version can handle the model where beta is a vector (of length q).
</p>
<p>The estimation equations used when maximize the 
empirical likelihood is 
</p>
<p style="text-align: center;"><code class="reqn"> 0 = \sum \delta_i \Delta F(Y_i) X_i \psi( Y_i - X_i \beta0 ) </code>
</p>

<p>which was described in detail in the reference below.
</p>
<p>For median regression (Least Absolute Deviation) estimator, you should
define the 
<code>psifun</code> as <code class="reqn">+1, -1</code> or <code class="reqn">0</code> when <code class="reqn">t</code> is <code class="reqn">&gt;0, &lt;0 </code>
or <code class="reqn"> =0</code>.
</p>
<p>For ordinary least squares estimator, <code>psifun</code> should be the identity function psifun &lt;- function(t)t.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"-2LLR"</code></td>
<td>
<p>the -2 log likelihood ratio; have approximate chisq 
distribution under <code class="reqn">H_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P-val</code></td>
<td>
<p>the p-value using the chi-square approximation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou. </p>


<h3>References</h3>

<p>Zhou, M.; Kim, M. and Bathke, A. (2012). 
Empirical likelihood analysis of the case weighted estimator in 
heteroscastic AFT model.  
<em>Statistica Sinica</em>, <b>22</b>, 295-316.
</p>


<h3>Examples</h3>

<pre><code class="language-R">xx &lt;- c(28,-44,29,30,26,27,22,23,33,16,24,29,24,40,21,31,34,-2,25,19)
</code></pre>


</div>