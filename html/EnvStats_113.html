<div class="container">

<table style="width: 100%;"><tr>
<td>enpar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Mean, Standard Deviation, and Standard Error Nonparametrically
</h2>

<h3>Description</h3>

<p>Estimate the mean, standard deviation, and standard error of the mean
nonparametrically given a sample of data, and optionally construct
a confidence interval for the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  enpar(x, ci = FALSE, ci.method = "bootstrap", ci.type = "two-sided", 
      conf.level = 0.95, pivot.statistic = "z", n.bootstraps = 1000, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.
Missing (<code>NA</code>), undefined (<code>NaN</code>), and
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the
mean.  The default value is <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>character string indicating what method to use to construct the confidence interval
for the mean.  The possible values are
<code>"bootstrap"</code> (based on bootstrapping; the default), and 
<code>"normal.approx"</code> (normal approximation).  
See the <b>DETAILS</b> section for more information.
This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>

<p>character string indicating what kind of confidence interval to compute.  The
possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
<code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
The default value is <code>conf.level=0.95</code>. This argument is ignored if
<code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivot.statistic</code></td>
<td>

<p>character string indicating which statistic to use for the confidence interval
for the mean when <code>ci.method="normal.approx"</code>.  Possible values are
<code>"z"</code> (confidence interval based on the z-statistic; the default), and
<code>"t"</code> (confidence interval based on the t-statistic).
This argument is ignored if <code>ci=FALSE</code> or <br><code>ci.method="bootstrap"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bootstraps</code></td>
<td>

<p>numeric scalar indicating how many bootstraps to use to construct the
confidence interval for the mean.  This argument is ignored if 
<code>ci=FALSE</code> or <br><code>ci.method="normal.approx"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>integer supplied to the function <code>set.seed</code> and used when <br><code>ci=TRUE</code> and <code>ci.method="bootstrap"</code>.  The default value is
<code>seed=NULL</code>, in which case the current value of <code>.Random.seed</code> 
is used.  This argument is ignored if <code>ci=FALSE</code> or 
<code>ci.method="normal.approx"</code>.  This argument is necessary to create 
reproducible results for the bootstrapped confidence intervals 
(see the <b>EXAMPLES</b> section).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\underline{x} = (x_1, x_2, \ldots, x_N)</code> denote a vector of <code class="reqn">N</code>
observations from some distribution with mean <code class="reqn">\mu</code> and standard 
deviation <code class="reqn">\sigma</code>.
<br></p>
<p><b>Estimation</b> <br>
Unbiased and consistent estimators of the mean and variance are:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu} = \bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\; (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\sigma}^2 = s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (2)</code>
</p>

<p>A consistent (but not unbiased) estimate of the standard deviation is given by 
the square root of the estimated variance above:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma} = s \;\;\;\; (3)</code>
</p>

<p>It can be shown that the variance of the sample mean is given by:
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2_{\hat{\mu}} = \sigma^2_{\bar{x}} = \frac{\sigma^2}{n} \;\;\;\; (4)</code>
</p>

<p>so the standard deviation of the sample mean (usually called the <em>standard error</em>) 
can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{\hat{\mu}} = \hat{\sigma}_{\bar{x}} = \frac{s}{\sqrt{n}} \;\;\;\; (5)</code>
</p>

<p><br></p>
<p><b>Confidence Intervals</b> <br>
This section explains how confidence intervals for the mean <code class="reqn">\mu</code> are
computed.
<br></p>
<p><em>Normal Approximation</em> (<code>ci.method="normal.approx"</code>) <br>
This method constructs approximate <code class="reqn">(1-\alpha)100\%</code> confidence intervals for
<code class="reqn">\mu</code> based on the assumption that the estimator of <code class="reqn">\mu</code>, i.e., the 
sample mean, is approximately normally distributed.  That is, a two-sided 
<code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\mu</code> is constructed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\mu} - t_{1-\alpha/2, m-1}\hat{\sigma}_{\hat{\mu}}, \; \hat{\mu} + t_{1-\alpha/2, m-1}\hat{\sigma}_{\hat{\mu}}] \;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">\hat{\mu}</code> denotes the estimate of <code class="reqn">\mu</code>,
<code class="reqn">\hat{\sigma}_{\hat{\mu}}</code> denotes the estimated asymptotic standard
deviation of the estimator of <code class="reqn">\mu</code>, <code class="reqn">m</code> denotes the assumed sample
size for the confidence interval, and <code class="reqn">t_{p,\nu}</code> denotes the <code class="reqn">p</code>'th
quantile of Student's t-distribuiton with <code class="reqn">\nu</code>
degrees of freedom.  One-sided confidence intervals are computed in a
similar fashion.
</p>
<p>When <code>pivot.statistic="z"</code>, the <code class="reqn">p</code>'th quantile from the
standard normal distribution is used in place of the
<code class="reqn">p</code>'th quantile from Student's t-distribution.
<br></p>
<p><em>Bootstrap and Bias-Corrected Bootstrap Approximation</em> (<code>ci.method="bootstrap"</code>) <br>
The bootstrap is a nonparametric method of estimating the distribution
(and associated distribution parameters and quantiles) of a sample statistic,
regardless of the distribution of the population from which the sample was drawn.
The bootstrap was introduced by Efron (1979) and a general reference is
Efron and Tibshirani (1993).
</p>
<p>In the context of deriving an approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval
for the population mean <code class="reqn">\mu</code>, the bootstrap can be broken down into the
following steps:
</p>

<ol>
<li>
<p> Create a bootstrap sample by taking a random sample of size <code class="reqn">N</code> from
the observations in <code class="reqn">\underline{x}</code>, where sampling is done with
replacement.  Note that because sampling is done with replacement, the same
element of <code class="reqn">\underline{x}</code> can appear more than once in the bootstrap
sample.  Thus, the bootstrap sample will usually not look exactly like the
original sample.
</p>
</li>
<li>
<p> Estimate <code class="reqn">\mu</code> based on the bootstrap sample created in Step 1, using
the same method that was used to estimate <code class="reqn">\mu</code> using the original
observations in <code class="reqn">\underline{x}</code>. Because the bootstrap sample usually
does not match the original sample, the estimate of <code class="reqn">\mu</code> based on the
bootstrap sample will usually differ from the original estimate based on
<code class="reqn">\underline{x}</code>.  For the bootstrap-t method (see below), this step also
involves estimating the standard error of the estimate of the mean and
computing the statistic 
<code class="reqn">T = (\hat{\mu}_B - \hat{\mu}) / \hat{\sigma}_{\hat{\mu}_B}</code>
where <code class="reqn">\hat{\mu}</code> denotes the estimate of the mean based on the original sample,
and <code class="reqn">\hat{\mu}_B</code> and <code class="reqn">\hat{\sigma}_{\hat{\mu}_B}</code> denote the estimate of
the mean and estimate of the standard error of the estimate of the mean based on
the bootstrap sample.
</p>
</li>
<li>
<p> Repeat Steps 1 and 2 <code class="reqn">B</code> times, where <code class="reqn">B</code> is some large number.
For the function <code>enpar</code>, the number of bootstraps <code class="reqn">B</code> is
determined by the argument <code>n.bootstraps</code> (see the section <b>ARGUMENTS</b> above).
The default value of <code>n.bootstraps</code> is <code>1000</code>.
</p>
</li>
<li>
<p> Use the <code class="reqn">B</code> estimated values of <code class="reqn">\mu</code> to compute the empirical
cumulative distribution function of the estimator of <code class="reqn">\mu</code> or to compute
the empirical cumulative distribution function of the statistic <code class="reqn">T</code>
(see <code>ecdfPlot</code>), and then create a confidence interval for <code class="reqn">\mu</code>
based on this estimated cdf.
</p>
</li>
</ol>
<p>The two-sided percentile interval (Efron and Tibshirani, 1993, p.170) is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\frac{\alpha}{2}), \; \hat{G}^{-1}(1-\frac{\alpha}{2})] \;\;\;\;\;\; (7)</code>
</p>

<p>where <code class="reqn">\hat{G}(t)</code> denotes the empirical cdf of <code class="reqn">\hat{\mu}_B</code> evaluated at <code class="reqn">t</code>
and thus <code class="reqn">\hat{G}^{-1}(p)</code> denotes the <code class="reqn">p</code>'th empirical quantile of the
distribution of <code class="reqn">\hat{\mu}_B</code>, that is, the <code class="reqn">p</code>'th quantile associated with the
empirical cdf.  Similarly, a one-sided lower
confidence interval is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\alpha), \; \infty] \;\;\;\;\;\; (8)</code>
</p>

<p>and a one-sided upper confidence interval is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \; \hat{G}^{-1}(1-\alpha)] \;\;\;\;\;\; (9)</code>
</p>

<p>The function <code>enpar</code> calls the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>quantile</code>
to compute the empirical quantiles used in Equations (7)-(9).
</p>
<p>The percentile method bootstrap confidence interval is only first-order
accurate (Efron and Tibshirani, 1993, pp.187-188), meaning that the probability
that the confidence interval will contain the true value of <code class="reqn">\mu</code> can be
off by <code class="reqn">k/\sqrt{N}</code>, where <code class="reqn">k</code> is some constant.  Efron and Tibshirani
(1993, pp.184–188) proposed a bias-corrected and accelerated interval that is
second-order accurate, meaning that the probability that the confidence interval
will contain the true value of <code class="reqn">\mu</code> may be off by <code class="reqn">k/N</code> instead of
<code class="reqn">k/\sqrt{N}</code>.  The two-sided bias-corrected and accelerated confidence interval is
computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\alpha_1), \; \hat{G}^{-1}(\alpha_2)] \;\;\;\;\;\; (10)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\alpha_1 = \Phi[\hat{z}_0 + \frac{\hat{z}_0 + z_{\alpha/2}}{1 - \hat{a}(z_0 + z_{\alpha/2})}] \;\;\;\;\;\; (11)</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha_2 = \Phi[\hat{z}_0 + \frac{\hat{z}_0 + z_{1-\alpha/2}}{1 - \hat{a}(z_0 + z_{1-\alpha/2})}] \;\;\;\;\;\; (12)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{z}_0 = \Phi^{-1}[\hat{G}(\hat{\mu})] \;\;\;\;\;\; (13)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{a} = \frac{\sum_{i=1}^N (\hat{\mu}_{(\cdot)} - \hat{\mu}_{(i)})^3}{6[\sum_{i=1}^N (\hat{\mu}_{(\cdot)} - \hat{\mu}_{(i)})^2]^{3/2}} \;\;\;\;\;\; (14)</code>
</p>

<p>where the quantity <code class="reqn">\hat{\mu}_{(i)}</code> denotes the estimate of <code class="reqn">\mu</code> using
all the values in <code class="reqn">\underline{x}</code> except the <code class="reqn">i</code>'th one, and
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu}{(\cdot)} = \frac{1}{N} \sum_{i=1}^N \hat{\mu_{(i)}} \;\;\;\;\;\; (15)</code>
</p>

<p>A one-sided lower confidence interval is given by:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\alpha_1), \; \infty] \;\;\;\;\;\; (16)</code>
</p>

<p>and a one-sided upper confidence interval is given by:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \; \hat{G}^{-1}(\alpha_2)] \;\;\;\;\;\; (17)</code>
</p>

<p>where <code class="reqn">\alpha_1</code> and <code class="reqn">\alpha_2</code> are computed as for a two-sided confidence
interval, except <code class="reqn">\alpha/2</code> is replaced with <code class="reqn">\alpha</code> in Equations (11) and (12).
</p>
<p>The constant <code class="reqn">\hat{z}_0</code> incorporates the bias correction, and the constant
<code class="reqn">\hat{a}</code> is the acceleration constant.  The term “acceleration” refers
to the rate of change of the standard error of the estimate of <code class="reqn">\mu</code> with
respect to the true value of <code class="reqn">\mu</code> (Efron and Tibshirani, 1993, p.186).  For a
normal (Gaussian) distribution, the standard error of the estimate of <code class="reqn">\mu</code>
does not depend on the value of <code class="reqn">\mu</code>, hence the acceleration constant is not
really necessary.
</p>
<p>For the bootstrap-t method, the two-sided confidence interval
(Efron and Tibshirani, 1993, p.160) is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\mu} - t_{1-\alpha/2}\hat{\sigma}_{\hat{\mu}}, \; \hat{\mu} - t_{\alpha/2}\hat{\sigma}_{\hat{\mu}}] \;\;\;\;\;\; (18)</code>
</p>

<p>where <code class="reqn">\hat{\mu}</code> and <code class="reqn">\hat{\sigma}_{\hat{\mu}}</code> denote the estimate of the mean
and standard error of the estimate of the mean based on the original sample, and
<code class="reqn">t_p</code> denotes the <code class="reqn">p</code>'th empirical quantile of the bootstrap distribution of
the statistic <code class="reqn">T</code>.  Similarly, a one-sided lower confidence interval is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\mu} - t_{1-\alpha}\hat{\sigma}_{\hat{\mu}}, \; \infty] \;\;\;\;\;\; (19)</code>
</p>

<p>and a one-sided upper confidence interval is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \; \hat{\mu} - t_{\alpha}\hat{\sigma}_{\hat{\mu}}] \;\;\;\;\;\; (20)</code>
</p>

<p>When <code>ci.method="bootstrap"</code>, the function <code>enpar</code> computes
the percentile method, bias-corrected and accelerated method, and bootstrap-t
bootstrap confidence intervals.  The percentile method is transformation respecting,
but not second-order accurate.  The bootstrap-t method is second-order accurate, but not
transformation respecting.  The bias-corrected and accelerated method is both
transformation respecting and second-order accurate (Efron and Tibshirani, 1993, p.188).
</p>


<h3>Value</h3>

<p>a list of class <code>"estimate"</code> containing the estimated parameters
and other information.  See <code>estimate.object</code> for details.
</p>


<h3>Note</h3>

<p>The function <code>enpar</code> is related to the companion function 
<code>enparCensored</code> for censored data.  To estimate the median and 
compute a confidence interval, use <code>eqnpar</code>.
</p>
<p>The result of the call to <code>enpar</code> with <code>ci.method="normal.approx"</code> 
and <code>pivot.statistic="t"</code> produces the same result as the call to 
<code>enorm</code> with <code>ci.param="mean"</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Efron, B. (1979).  Bootstrap Methods: Another Look at the Jackknife.
<em>The Annals of Statistics</em> <b>7</b>, 1–26.
</p>
<p>Efron, B., and R.J. Tibshirani. (1993).  <em>An Introduction to the Bootstrap</em>.
Chapman and Hall, New York, 436pp.
</p>


<h3>See Also</h3>

<p><code>enparCensored</code>, <code>eqnpar</code>, <code>enorm</code>, 
<code>mean</code>, <code>sd</code>, <code>estimate.object</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # The data frame ACE.13.TCE.df contains observations on
  # Trichloroethylene (TCE) concentrations (mg/L) at
  # 10 groundwater monitoring wells before and after remediation.
  #
  # Compute the mean concentration for each period along with
  # a 95% bootstrap BCa confidence interval for the mean.
  #
  # NOTE: Use of the argument "seed" is necessary to reproduce this example.
  #
  # Before remediation: 21.6 [14.2, 30.1]
  # After remediation:   3.6 [ 1.6,  5.7]

  with(ACE.13.TCE.df,
    enpar(TCE.mg.per.L[Period=="Before"], ci = TRUE, seed = 476))

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            None
  #
  #Estimated Parameter(s):          mean    = 21.62400
  #                                 sd      = 13.51134
  #                                 se.mean =  4.27266
  #
  #Estimation Method:               Sample Mean
  #
  #Data:                            TCE.mg.per.L[Period == "Before"]
  #
  #Sample Size:                     10
  #
  #Confidence Interval for:         mean
  #
  #Confidence Interval Method:      Bootstrap
  #
  #Number of Bootstraps:            1000
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             Pct.LCL = 13.95560
  #                                 Pct.UCL = 29.79510
  #                                 BCa.LCL = 14.16080
  #                                 BCa.UCL = 30.06848
  #                                 t.LCL   = 12.41945
  #                                 t.UCL   = 32.47306
  
  #----------

  with(ACE.13.TCE.df, 
    enpar(TCE.mg.per.L[Period=="After"], ci = TRUE, seed = 543))

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            None
  #
  #Estimated Parameter(s):          mean    = 3.632900
  #                                 sd      = 3.554419
  #                                 se.mean = 1.124006
  #
  #Estimation Method:               Sample Mean
  #
  #Data:                            TCE.mg.per.L[Period == "After"]
  #
  #Sample Size:                     10
  #
  #Confidence Interval for:         mean
  #
  #Confidence Interval Method:      Bootstrap
  #
  #Number of Bootstraps:            1000
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             Pct.LCL = 1.833843
  #                                 Pct.UCL = 5.830230
  #                                 BCa.LCL = 1.631655
  #                                 BCa.UCL = 5.677514
  #                                 t.LCL   = 1.683791
  #                                 t.UCL   = 8.101829
</code></pre>


</div>