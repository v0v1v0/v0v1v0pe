<div class="container">

<table style="width: 100%;"><tr>
<td>perfRestim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Routine to measure the performance of estimR and estimRmcmc</h2>

<h3>Description</h3>

<p>This routine can be used to check the 'statistical performance' of the
<code>estimR()</code> and <code>estimRmcmc()</code> routines to estimate the reproduction
number <code class="reqn">R_t</code>. It simulates epidemics using the <code>episim()</code> function
and computes the Bias, MSE, coverage probability (CP) and width of <code class="reqn">90\%</code> and
<code class="reqn">95\%</code> credible intervals for <code class="reqn">R_t</code> averaged over days <code class="reqn">t=8,...,T</code>,
where <code class="reqn">T</code> is the total number of days of the simulated epidemics. As such,
it can be used to reproduce part of the results in Gressani et al. (2022)
Table 1 and Table 2, respectively. Small differences in results are due to a
restructuring of the code since version 1.0.6. If strict reproducible results
are required, please refer to version 1.0.6 of the EpiLPS package or visit
the GitHub repository <a href="https://github.com/oswaldogressani/EpiLPS-ArticleCode">https://github.com/oswaldogressani/EpiLPS-ArticleCode</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perfRestim(nsim = 100, scenario = 1, days = 40, K = 40,
 method = c("LPSMAP", "LPSMALA"), mcmciter = 3000, burnin = 1000,
 si = c("flu", "sars", "mers"), seed = 1325, overdisp = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Total number of simulated epidemics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>The scenario to be used in <code>episim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>days</code></td>
<td>
<p>Number of days for the simulated epidemics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of B-splines basis function in the P-spline model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for LPS, either LPSMAP or LPSMALA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmciter</code></td>
<td>
<p>Number of MCMC samples for method LPSMALA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Burn-in for method LPSMALA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si</code></td>
<td>
<p>The discrete serial interval distribution. Possible specifications
are "flu", "sars" or "mers".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A seed for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdisp</code></td>
<td>
<p>The value of the overdispersion parameter for the negative
binomial model in the <code>episim()</code> routine.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li>
<p> LPS: Results for the LPS approach.
</p>
</li>
<li>
<p> EpiEstim: Results for the EpiEstim approach with weekly sliding
windows.
</p>
</li>
<li>
<p> inciplot: The simulated incidence time series.
</p>
</li>
<li>
<p> Rlpsplot: Estimated <code class="reqn">R_t</code> trajectories with LPS.
</p>
</li>
<li>
<p> Repiestimplot: Estimated <code class="reqn">R_t</code> trajectories with EpiEstim.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>
</p>


<h3>References</h3>

<p>Gressani, O., Wallinga, J., Althaus, C. L., Hens, N. and Faes, C.
(2022). EpiLPS: A fast and flexible Bayesian tool for estimation of the
time-varying reproduction number. <em>Plos Computational Biology</em>,
<strong>18</strong>(10): e1010618.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># # FLU serial interval (Scenarios 1-4)
# S1 &lt;- perfRestim(si = "flu", scenario = 1, seed = 1325)
# S1mcmc &lt;- perfRestim(si = "flu", scenario = 1, seed = 1325, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S1$inciplot, S1$Rlpsplot, S1$Repiestimplot, nrow = 1))
# S2 &lt;- perfRestim(si = "flu", scenario = 2, seed = 1123)
# S2mcmc &lt;- perfRestim(si = "flu", scenario = 2, seed = 1123, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S2$inciplot, S2$Rlpsplot, S2$Repiestimplot, nrow = 1))
# S3 &lt;- perfRestim(si = "flu", scenario = 3, seed = 1314)
# S3mcmc &lt;- perfRestim(si = "flu", scenario = 3, seed = 1314, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S3$inciplot, S3$Rlpsplot, S3$Repiestimplot, nrow = 1))
# S4 &lt;- perfRestim(si = "flu", scenario = 4, seed = 1966)
# S4mcmc &lt;- perfRestim(si = "flu", scenario = 4, seed = 1966, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S4$inciplot, S4$Rlpsplot, S4$Repiestimplot, nrow = 1))
#
# # SARS serial interval (Scenarios 5-8)
# S5 &lt;- perfRestim(si = "sars", scenario = 1, seed = 1998, overdisp = 5)
# S5mcmc &lt;- perfRestim(si = "sars", scenario = 1, seed = 1998, overdisp = 5, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S5$inciplot, S5$Rlpsplot, S5$Repiestimplot, nrow = 1))
# S6 &lt;- perfRestim(si = "sars", scenario = 2, seed = 1870, overdisp = 5)
# S6mcmc &lt;- perfRestim(si = "sars", scenario = 2, seed = 1870, overdisp = 5, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S6$inciplot, S6$Rlpsplot, S6$Repiestimplot, nrow = 1))
# S7 &lt;- perfRestim(si = "sars", scenario = 3, seed = 115,  overdisp = 5)
# S7mcmc &lt;- perfRestim(si = "sars", scenario = 3, seed = 115,  overdisp = 5, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S7$inciplot, S7$Rlpsplot, S7$Repiestimplot, nrow = 1))
# S8 &lt;- perfRestim(si = "sars", scenario = 4, seed = 1464, overdisp = 5)
# S8mcmc &lt;- perfRestim(si = "sars", scenario = 4, seed = 1464, overdisp = 5, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S8$inciplot, S8$Rlpsplot, S8$Repiestimplot, nrow = 1))
#
# # MERS serial interval (Scenario 9)
# S9 &lt;- perfRestim(si = "mers", scenario = 5, days = 60,  seed = 1905, overdisp = 50)
# S9mcmc &lt;- perfRestim(si = "mers", scenario = 5, days = 60,
# seed = 1905, overdisp = 50, method = "LPSMALA")
# suppressWarnings(gridExtra::grid.arrange(S9$inciplot, S9$Rlpsplot,
# S9$Repiestimplot, nrow = 1))
#
# #(Partially recovering Table 2 and Table 3 of Gressani et al. 2022)
# simsummary &lt;- matrix(0, nrow = 36, ncol = 7)
# colnames(simsummary) &lt;- c("Method", "Bias", "MSE", "CP90%", "CP95%",
#                           "CIwidth90%", "CIwidth95%")
# simsummary &lt;- as.data.frame(simsummary)
#
# # Scenario 1
# simsummary[1,] &lt;- c(rownames(S1$LPS),S1$LPS)
# simsummary[2,] &lt;- c(rownames(S1mcmc$LPS),S1mcmc$LPS)
# simsummary[3,] &lt;- c(rownames(S1$EpiEstim),S1$EpiEstim)
# simsummary[4,] &lt;- rep("--",7)
# # Scenario 2
# simsummary[5,] &lt;- c(rownames(S2$LPS),S2$LPS)
# simsummary[6,] &lt;- c(rownames(S2mcmc$LPS),S2mcmc$LPS)
# simsummary[7,] &lt;- c(rownames(S2$EpiEstim),S2$EpiEstim)
# simsummary[8,] &lt;- rep("--",7)
# # Scenario 3
# simsummary[9,] &lt;- c(rownames(S3$LPS),S3$LPS)
# simsummary[10,] &lt;- c(rownames(S3mcmc$LPS),S3mcmc$LPS)
# simsummary[11,] &lt;- c(rownames(S3$EpiEstim),S3$EpiEstim)
# simsummary[12,] &lt;- rep("--",7)
# # Scenario 4
# simsummary[13,] &lt;- c(rownames(S4$LPS),S4$LPS)
# simsummary[14,] &lt;- c(rownames(S4mcmc$LPS),S4mcmc$LPS)
# simsummary[15,] &lt;- c(rownames(S4$EpiEstim),S4$EpiEstim)
# simsummary[16,] &lt;- rep("--",7)
# # Scenario 5
# simsummary[17,] &lt;- c(rownames(S5$LPS),S5$LPS)
# simsummary[18,] &lt;- c(rownames(S5mcmc$LPS),S5mcmc$LPS)
# simsummary[19,] &lt;- c(rownames(S5$EpiEstim),S5$EpiEstim)
# simsummary[20,] &lt;- rep("--",7)
# # Scenario 6
# simsummary[21,] &lt;- c(rownames(S6$LPS),S6$LPS)
# simsummary[22,] &lt;- c(rownames(S6mcmc$LPS),S6mcmc$LPS)
# simsummary[23,] &lt;- c(rownames(S6$EpiEstim),S6$EpiEstim)
# simsummary[24,] &lt;- rep("--",7)
# # Scenario 7
# simsummary[25,] &lt;- c(rownames(S7$LPS),S7$LPS)
# simsummary[26,] &lt;- c(rownames(S7mcmc$LPS),S7mcmc$LPS)
# simsummary[27,] &lt;- c(rownames(S7$EpiEstim),S7$EpiEstim)
# simsummary[28,] &lt;- rep("--",7)
# # Scenario 8
# simsummary[29,] &lt;- c(rownames(S8$LPS),S8$LPS)
# simsummary[30,] &lt;- c(rownames(S8mcmc$LPS),S8mcmc$LPS)
# simsummary[31,] &lt;- c(rownames(S8$EpiEstim),S8$EpiEstim)
# simsummary[32,] &lt;- rep("--",7)
# # Scenario 9
# simsummary[33,] &lt;- c(rownames(S9$LPS),S9$LPS)
# simsummary[34,] &lt;- c(rownames(S9mcmc$LPS),S9mcmc$LPS)
# simsummary[35,] &lt;- c(rownames(S9$EpiEstim),S9$EpiEstim)
# simsummary[36,] &lt;- rep("--",7)
# simsummary

</code></pre>


</div>