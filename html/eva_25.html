<div class="container">

<table style="width: 100%;"><tr>
<td>gpdSeqTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GPD Multiple Threshold Goodness-of-Fit Testing</h2>

<h3>Description</h3>

<p>Wrapper function to test multiple thresholds for goodness-of-fit to the Generalized Pareto model. Can choose which test to
run from the available tests in this package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpdSeqTests(
  data,
  thresholds = NULL,
  nextremes = NULL,
  method = c("ad", "cvm", "pbscore", "multscore", "imasym", "impb"),
  nsim = NULL,
  inner = NULL,
  outer = NULL,
  information = c("expected", "observed"),
  allowParallel = FALSE,
  numCores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Original, full dataset in vector form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>A set of threshold values (either this or a set of the number of extremes must be given, but not both). Must be provided as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nextremes</code></td>
<td>
<p>A set of the number of upper extremes to be used, provided as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Which test to run to sequentially test the thresholds. Must be one of ‘ad’, ‘cvm’, ‘pbscore’, ‘multscore’, ‘imasym’, or ‘impb’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of boostrap replicates for the ‘ad’, ‘cvm’, ‘pbscore’, ‘multscore’, and ‘imasym’ tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>Number of inner boostrap replicates if ‘impb’ test is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer</code></td>
<td>
<p>Number of outer boostrap replicates if ‘impb’ test is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>
<p>To use observed or expected (default) information for the ‘pbscore’ and ‘multscore’ tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowParallel</code></td>
<td>
<p>If selected, should the ‘cvm’, ‘ad’, ‘pbscore’, or ‘impb’ procedure be run in parallel or not. Defaults to false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCores</code></td>
<td>
<p>If allowParallel is true, specify the number of cores to use.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function returns a matrix containing the thresholds used, the number of observations above each threshold,
the corresponding test statistics, p-values (raw and transformed), and parameter estimates at each threshold. The user must provide
the data, a vector of thresholds or number of upper extremes to be used, and select the test.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>The threshold used for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.above</code></td>
<td>
<p>The number of observations above the given threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.values</code></td>
<td>
<p>Raw p-values for the thresholds tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ForwardStop</code></td>
<td>
<p>Transformed p-values according to the ForwardStop stopping rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StrongStop</code></td>
<td>
<p>Transformed p-values according to the StrongStop stopping rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Returned test statistics of each individual test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.scale</code></td>
<td>
<p>Estimated scale parameter for the given threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.shape</code></td>
<td>
<p>Estimated shape parameter for the given threshold.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(7)
x &lt;- rgpd(10000, loc = 0, scale = 5, shape = 0.2)
## A vector of thresholds to test
threshes &lt;- c(1.5, 2.5, 3.5, 4.5, 5.5)
gpdSeqTests(x, thresholds = threshes, method = "ad")
</code></pre>


</div>