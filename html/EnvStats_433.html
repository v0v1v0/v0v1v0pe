<div class="container">

<table style="width: 100%;"><tr>
<td>predIntNormSimultaneousTestPower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Probability That at Least One Set of Future Observations Violates the Given Rule Based on a Simultaneous Prediction Interval for a Normal Distribution
</h2>

<h3>Description</h3>

<p>Compute the probability that at least one set of future observations violates the 
given rule based on a simultaneous prediction interval for the next <code class="reqn">r</code> future 
sampling occasions for a normal distribution.  The three possible rules are: 
<code class="reqn">k</code>-of-<code class="reqn">m</code>, California, or Modified California.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntNormSimultaneousTestPower(n, df = n - 1, n.mean = 1, k = 1, m = 2, r = 1, 
    rule = "k.of.m", delta.over.sigma = 0, pi.type = "upper", conf.level = 0.95, 
    r.shifted = r, K.tol = .Machine$double.eps^0.5, integrate.args.list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>vector of positive integers greater than 2 indicating the sample size upon which 
the prediction interval is based.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>vector of positive integers indicating the degrees of freedom associated with 
the sample size.  The default value is <code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mean</code></td>
<td>

<p>positive integer specifying the sample size associated with the future averages.  
The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all 
future averages must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), vector of positive integers 
specifying the minimum number of observations (or averages) out of <code class="reqn">m</code> 
observations (or averages) (all obtained on one future sampling “occassion”) 
the prediction interval should contain with confidence level <code>conf.level</code>.  
The default value is <code>k=1</code>.  This argument is ignored when the argument 
<code>rule</code> is not equal to <code>"k.of.m"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>vector of positive integers specifying the maximum number of future observations (or 
averages) on one future sampling “occasion”.  
The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which 
case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>vector of positive integers specifying the number of future sampling “occasions”.  
The default value is <code>r=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>

<p>character string specifying which rule to use.  The possible values are 
<code>"k.of.m"</code> (<code class="reqn">k</code>-of-<code class="reqn">m</code> rule; the default), <code>"CA"</code> (California rule), 
and <code>"Modified.CA"</code> (modified California rule).  
See the DETAILS section below for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.over.sigma</code></td>
<td>

<p>numeric vector indicating the ratio <code class="reqn">\Delta/\sigma</code>.  The quantity 
<code class="reqn">\Delta</code> (delta) denotes the difference between the mean of the population 
that was sampled to construct the prediction interval, and the mean of the 
population that will be sampled to produce the future observations.  The quantity 
<code class="reqn">\sigma</code> (sigma) denotes the population standard deviation for both populations.  
See the DETAILS section below for more information.  The default value is 
<code>delta.over.sigma=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>pi.type="upper"</code> (the default), and 
<code>pi.type="lower"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>vector of values between 0 and 1 indicating the confidence level of the prediction interval.  
The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.shifted</code></td>
<td>

<p>vector of positive integers specifying the number of future sampling occasions for 
which the scaled mean is shifted by <code class="reqn">\Delta/\sigma</code>.  All values must be 
integeters between <code>1</code> and the corresponding element of <code>r</code>.  
The default value is <code>r.shifted=r</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.tol</code></td>
<td>

<p>numeric scalar indicating the tolerance to use in the nonlinear search algorithm to 
compute <code class="reqn">K</code>.  The default value is <code>K.tol=.Machine$double.eps^(1/2)</code>.  
For many applications, the value of <code class="reqn">K</code> needs to be known only to the second 
decimal place, in which case setting <code>K.tol=1e-4</code> will speed up computation a 
bit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate.args.list</code></td>
<td>

<p>a list of arguments to supply to the <code>integrate</code> function.  The 
default value is <code>integrate.args.list=NULL</code> which means that the 
default values of <code>integrate</code> are used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>What is a Simultaneous Prediction Interval?</b> <br>
A prediction interval for some population is an interval on the real line constructed 
so that it will contain <code class="reqn">k</code> future observations from that population 
with some specified probability <code class="reqn">(1-\alpha)100\%</code>, where 
<code class="reqn">0 &lt; \alpha &lt; 1</code> and <code class="reqn">k</code> is some pre-specified positive integer.  
The quantity <code class="reqn">(1-\alpha)100\%</code> is called  
the confidence coefficient or confidence level associated with the prediction 
interval.  The function <code>predIntNorm</code> computes a standard prediction 
interval based on a sample from a normal distribution.
</p>
<p>The function <code>predIntNormSimultaneous</code> computes a simultaneous prediction 
interval that will contain a certain number of future observations with probability 
<code class="reqn">(1-\alpha)100\%</code> for each of <code class="reqn">r</code> future sampling “occasions”, 
where <code class="reqn">r</code> is some pre-specified positive integer.  The quantity <code class="reqn">r</code> may 
refer to <code class="reqn">r</code> distinct future sampling occasions in time, or it may for example 
refer to sampling at <code class="reqn">r</code> distinct locations on one future sampling occasion, 
assuming that the population standard deviation is the same at all of the <code class="reqn">r</code> 
distinct locations.
</p>
<p>The function <code>predIntNormSimultaneous</code> computes a simultaneous prediction 
interval based on one of three possible rules:
</p>

<ul>
<li>
<p> For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), at least <code class="reqn">k</code> of 
the next <code class="reqn">m</code> future observations will fall in the prediction 
interval with probability <code class="reqn">(1-\alpha)100\%</code> on each of the <code class="reqn">r</code> future 
sampling occasions.  If obserations are being taken sequentially, for a particular 
sampling occasion, up to <code class="reqn">m</code> observations may be taken, but once 
<code class="reqn">k</code> of the observations fall within the prediction interval, sampling can stop.  
Note:  When <code class="reqn">k=m</code> and <code class="reqn">r=1</code>, the results of 
<code>predIntNormSimultaneous</code> are equivalent to the results of 
<code>predIntNorm</code>.
</p>
</li>
<li>
<p> For the California rule (<code>rule="CA"</code>), with probability 
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either 
the first observation will fall in the prediction interval, or else all of the next 
<code class="reqn">m-1</code> observations will fall in the prediction interval. That is, if the first 
observation falls in the prediction interval then sampling can stop.  Otherwise, 
<code class="reqn">m-1</code> more observations must be taken.
</p>
</li>
<li>
<p> For the Modified California rule (<code>rule="Modified.CA"</code>), with probability 
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either the 
first observation will fall in the prediction interval, or else at least 2 out of 
the next 3 observations will fall in the prediction interval.  That is, if the first 
observation falls in the prediction interval then sampling can stop.  Otherwise, up 
to 3 more observations must be taken.
</p>
</li>
</ul>
<p>Simultaneous prediction intervals can be extended to using averages (means) in place 
of single observations (USEPA, 2009, Chapter 19).  That is, you can create a 
simultaneous prediction interval 
that will contain a specified number of averages (based on which rule you choose) on 
each of <code class="reqn">r</code> future sampling occassions, where each each average is based on 
<code class="reqn">w</code> individual observations.  For the function <code>predIntNormSimultaneous</code>, 
the argument <code>n.mean</code> corresponds to <code class="reqn">w</code>.
<br></p>
<p><b>The Form of a Prediction Interval</b> <br>
Let <code class="reqn">\underline{x} = x_1, x_2, \ldots, x_n</code> denote a vector of <code class="reqn">n</code> 
observations from a normal distribution with parameters 
<code>mean=</code><code class="reqn">\mu</code> and <code>sd=</code><code class="reqn">\sigma</code>.  Also, let <code class="reqn">w</code> denote the 
sample size associated with the future averages (i.e., <code>n.mean=</code><code class="reqn">w</code>).  
When <code class="reqn">w=1</code>, each average is really just a single observation, so in the rest of 
this help file the term “averages” will replace the phrase 
“observations or averages”.
</p>
<p>For a normal distribution, the form of a two-sided <code class="reqn">(1-\alpha)100\%</code> 
prediction interval is: 
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)</code>
</p>
 
<p>where <code class="reqn">\bar{x}</code> denotes the sample mean:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)</code>
</p>

<p><code class="reqn">s</code> denotes the sample standard deviation:
</p>
<p style="text-align: center;"><code class="reqn">s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)</code>
</p>

<p>and <code class="reqn">K</code> denotes a constant that depends on the sample size <code class="reqn">n</code>, the 
confidence level, the number of future sampling occassions <code class="reqn">r</code>, and the 
sample size associated with the future averages, <code class="reqn">w</code>.  Do not confuse the 
constant <code class="reqn">K</code> (uppercase K) with the number of future averages <code class="reqn">k</code> 
(lowercase k) in the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule.  The symbol <code class="reqn">K</code> is used here 
to be consistent with the notation used for tolerance intervals 
(see <code>tolIntNorm</code>).  
</p>
<p>Similarly, the form of a one-sided lower prediction interval is: 
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)</code>
</p>
 
<p>and the form of a one-sided upper prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)</code>
</p>
 
<p><b>Note:</b>  For simultaneous prediction intervals, only lower 
(<code>pi.type="lower"</code>) and upper <br>
(<code>pi.type="upper"</code>) prediction 
intervals are available.
</p>
<p>The derivation of the constant <code class="reqn">K</code> is explained in the help file for 
<code>predIntNormSimultaneousK</code>.
<br></p>
<p><b>Computing Power</b> <br>
The "power" of the prediction interval is defined as the probability that 
at least one set of future observations violates the given rule based on a 
simultaneous prediction interval for the next <code class="reqn">r</code> future sampling occasions, 
where the population mean for the future observations is allowed to differ from 
the population mean for the observations used to construct the prediction interval.  
</p>
<p>The quantity <code class="reqn">\Delta</code> (upper case delta) denotes the difference between the 
mean of the population that was sampled to construct the prediction interval, and 
the mean of the population that will be sampled to produce the future observations.  
The quantity <code class="reqn">\sigma</code> (sigma) denotes the population standard deviation of both 
of these populations.  The argument <code>delta.over.sigma</code> corresponds to the 
quantity <code class="reqn">\Delta/\sigma</code>.
<br></p>
<p><em>Power Based on the k-of-m Rule</em> (<code>rule="k.of.m"</code>) <br>
For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>) with <code class="reqn">w=1</code> 
(i.e., <code>n.mean=1</code>), at least <code class="reqn">k</code> of the next <code class="reqn">m</code> future 
observations will fall in the prediction interval 
with probability <code class="reqn">(1-\alpha)100\%</code> on each of the <code class="reqn">r</code> future sampling 
occasions.  If observations are being taken sequentially, for a particular 
sampling occasion, up to <code class="reqn">m</code> observations may be taken, but once <code class="reqn">k</code> 
of the observations fall within the prediction interval, sampling can stop.  
Note: When <code class="reqn">k=m</code> and <code class="reqn">r=1</code>, this kind of simultaneous prediction 
interval becomes the same as a standard prediction interval for the next 
<code class="reqn">k</code> observations (see <code>predIntNorm</code>).
</p>
<p>Davis and McNichols (1987) show that for a one-sided upper prediction interval 
(<code>pi.type="upper"</code>), the probability <code class="reqn">p</code> that at least <code class="reqn">k</code> of the 
next <code class="reqn">m</code> future observations will be contained in the interval given in 
Equation (5) above, for each of <code class="reqn">r</code> 
future sampling occasions, is given by:
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r[I(v; k, m+1-k)]^{r-1} [\frac{v^{k-1}(1-v)^{m-k}}{B(k, m+1-k)}] dv \;\;\;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">T(x; \nu, \delta)</code> denotes the cdf of the 
non-central Student's t-distribution with parameters 
<code>df=</code><code class="reqn">\nu</code> and <code>ncp=</code><code class="reqn">\delta</code> evaluated at <code class="reqn">x</code>; 
<code class="reqn">\Phi(x)</code> denotes the cdf of the standard normal distribution 
evaluated at <code class="reqn">x</code>; <code class="reqn">I(x; \nu, \omega)</code> denotes the cdf of the 
beta distribution with parameters <code>shape1=</code><code class="reqn">\nu</code> and 
<code>shape2=</code><code class="reqn">\omega</code>; and <code class="reqn">B(\nu, \omega)</code> denotes the value of the 
beta function with parameters <code>a=</code><code class="reqn">\nu</code> and 
<code>b=</code><code class="reqn">\omega</code>.
</p>
<p>The quantity <code class="reqn">\Delta</code> (upper case delta) denotes the difference between the 
mean of the population that was sampled to construct the prediction interval, and 
the mean of the population that will be sampled to produce the future observations.  
The quantity <code class="reqn">\sigma</code> (sigma) denotes the population standard deviation of both 
of these populations.  Usually you assume <code class="reqn">\Delta=0</code> unless you are interested 
in computing the power of the rule to detect a change in means between the 
populations, as we are here.
</p>
<p>If we are interested in using averages instead of single observations, with 
<code class="reqn">w \ge 1</code> (i.e., <code>n.mean</code><code class="reqn">\ge 1</code>), the first 
term in the integral in Equation (6) that involves the cdf of the 
non-central Student's t-distribution becomes:
</p>
<p style="text-align: center;"><code class="reqn">T(\sqrt{n}K; n-1, \frac{\sqrt{n}}{\sqrt{w}}[\Phi^{-1}(v) + \frac{\sqrt{w}\Delta}{\sigma}]) \;\;\;\;\;\; (7)</code>
</p>

<p>For a given confidence level <code class="reqn">(1-\alpha)100\%</code>, the power of the rule to detect 
a change in means is simply given by:
</p>
<p style="text-align: center;"><code class="reqn">Power = 1 - p \;\;\;\;\;\; (8)</code>
</p>

<p>where <code class="reqn">p</code> is defined in Equation (6) above using the value of <code class="reqn">K</code> that 
corresponds to <code class="reqn">\Delta/\sigma = 0</code>.  Thus, when the argument 
<code>delta.over.sigma=0</code>, the value of <code class="reqn">p</code> is <code class="reqn">1-\alpha</code> and the power is 
simply <code class="reqn">\alpha 100\%</code>.  As <code>delta.over.sigma</code> increases above 0, the power 
increases.
</p>
<p>When <code>pi.type="lower"</code>, the same value of <code>K</code> is used as when 
<code>pi.type="upper"</code>, but Equation (4) is used to construct the prediction 
interval.  Thus, the power increases as <code>delta.over.sigma</code> decreases below 0.
<br></p>
<p><em>Power Based on the California Rule</em> (<code>rule="CA"</code>) <br>  
For the California rule (<code>rule="CA"</code>), with probability <code class="reqn">(1-\alpha)100\%</code>, 
for each of the <code class="reqn">r</code> future sampling occasions, either the first observation will 
fall in the prediction interval, or else all of the next <code class="reqn">m-1</code> observations will 
fall in the prediction interval.  That is, if the first observation falls in the 
prediction interval then sampling can stop.  Otherwise, <code class="reqn">m-1</code> more observations 
must be taken.
</p>
<p>The derivation of the power is the same as for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule, except 
that Equation (6) becomes the following (Davis, 1998b):
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r\{v[1+v^{m-2}(1-v)]\}^{r-1} [1+v^{m-2}(m-1-mv)] dv \;\;\;\;\;\; (9)</code>
</p>

<p><br></p>
<p><em>Power Based on the Modified California Rule</em> (<code>rule="Modified.CA"</code>) <br> 
For the Modified California rule (<code>rule="Modified.CA"</code>), with probability 
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either the 
first observation will fall in the prediction interval, or else at least 2 out of 
the next 3 observations will fall in the prediction interval.  That is, if the first 
observation falls in the prediction interval then sampling can stop.  Otherwise, up 
to 3 more observations must be taken.
</p>
<p>The derivation of the power is the same as for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule, except 
that Equation (6) becomes the following (Davis, 1998b):
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r\{v[1+v(3-v[5-2v])]\}^{r-1} \{1+v[6-v(15-8v)]\} dv \;\;\;\;\;\; (10)</code>
</p>



<h3>Value</h3>

<p>vector of values between 0 and 1 equal to the probability that 
the rule will be violated.
</p>


<h3>Note</h3>

<p>See the help file for <code>predIntNormSimultaneous</code>.
</p>
<p>In the course of designing a sampling program, an environmental scientist may wish 
to determine the relationship between sample size, significance level, power, and 
scaled difference if one of the objectives of the sampling program is to determine 
whether two distributions differ from each other.  The functions 
<code>predIntNormSimultaneousTestPower</code> and <br><code>plotPredIntNormSimultaneousTestPowerCurve</code> can be 
used to investigate these relationships for the case of normally-distributed 
observations. 
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>predIntNormSimultaneous</code>.
</p>


<h3>See Also</h3>

<p><code>predIntNormSimultaneous</code>, <code>predIntNormSimultaneousK</code>, <br><code>plotPredIntNormSimultaneousTestPowerCurve</code>, 
<code>predIntNorm</code>, <code>predIntNormK</code>, <br><code>predIntNormTestPower</code>, Prediction Intervals, 
Normal.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # For the k-of-m rule with n=4, k=1, m=3, and r=1, show how the power increases 
  # as delta.over.sigma increases. Assume a 95% upper prediction interval.

  predIntNormSimultaneousTestPower(n = 4, m = 3, delta.over.sigma = 0:2) 
  #[1] 0.0500000 0.2954156 0.7008558

  #----------

  # Look at how the power increases with sample size for an upper one-sided 
  # prediction interval using the k-of-m rule with k=1, m=3, r=20, 
  # delta.over.sigma=2, and a confidence level of 95%.

  predIntNormSimultaneousTestPower(n = c(4, 8), m = 3, r = 20, delta.over.sigma = 2) 
  #[1] 0.6075972 0.9240924

  #----------

  # Compare the power for the 1-of-3 rule with the power for the California and 
  # Modified California rules, based on a 95% upper prediction interval and 
  # delta.over.sigma=2.  Assume a sample size of n=8.  Note that in this case the 
  # power for the Modified California rule is greater than the power for the 
  # 1-of-3 rule and California rule.

  predIntNormSimultaneousTestPower(n = 8, k = 1, m = 3, delta.over.sigma = 2) 
  #[1] 0.788171 

  predIntNormSimultaneousTestPower(n = 8, m = 3, rule = "CA", delta.over.sigma = 2) 
  #[1] 0.7160434 

  predIntNormSimultaneousTestPower(n = 8, rule = "Modified.CA", delta.over.sigma = 2) 
  #[1] 0.8143687

  #----------

  # Show how the power for an upper 95% simultaneous prediction limit increases 
  # as the number of future sampling occasions r increases.  Here, we'll use the 
  # 1-of-3 rule with n=8 and delta.over.sigma=1.

  predIntNormSimultaneousTestPower(n = 8, k = 1, m = 3, r=c(1, 2, 5, 10), 
    delta.over.sigma = 1) 
  #[1] 0.3492512 0.4032111 0.4503603 0.4633773

  #==========

  # USEPA (2009) contains an example on page 19-23 that involves monitoring 
  # nw=100 compliance wells at a large facility with minimal natural spatial 
  # variation every 6 months for nc=20 separate chemicals.  
  # There are n=25 background measurements for each chemical to use to create
  # simultaneous prediction intervals.  We would like to determine which kind of
  # resampling plan based on normal distribution simultaneous prediction intervals to
  # use (1-of-m, 1-of-m based on means, or Modified California) in order to have
  # adequate power of detecting an increase in chemical concentration at any of the
  # 100 wells while at the same time maintaining a site-wide false positive rate
  # (SWFPR) of 10% per year over all 4,000 comparisons 
  # (100 wells x 20 chemicals x semi-annual sampling).

  # The function predIntNormSimultaneousTestPower includes the argument "r" 
  # that is the number of future sampling occasions (r=2 in this case because 
  # we are performing semi-annual sampling), so to compute the individual test 
  # Type I error level alpha.test (and thus the individual test confidence level), 
  # we only need to worry about the number of wells (100) and the number of 
  # constituents (20): alpha.test = 1-(1-alpha)^(1/(nw x nc)).  The individual 
  # confidence level is simply 1-alpha.test.  Plugging in 0.1 for alpha, 
  # 100 for nw, and 20 for nc yields an individual test confidence level of 
  # 1-alpha.test = 0.9999473.

  nc &lt;- 20
  nw &lt;- 100
  conf.level &lt;- (1 - 0.1)^(1 / (nc * nw))
  conf.level
  #[1] 0.9999473

  # Now we can compute the power of any particular sampling strategy using
  # predIntNormSimultaneousTestPower.  For example, here is the power of 
  # detecting an increase of three standard deviations in concentration using 
  # the prediction interval based on the "1-of-2" resampling rule:

  predIntNormSimultaneousTestPower(n = 25, k = 1, m = 2, r = 2, rule = "k.of.m", 
    delta.over.sigma = 3,  pi.type = "upper", conf.level = conf.level)
  #[1] 0.3900202

  # The following commands will reproduce the table shown in Step 2 on page
  # 19-23 of USEPA (2009).  Because these commands can take more than a few 
  # seconds to execute, we have commented them out here.  To run this example, 
  # just remove the pound signs (#) that are in front of R commands.

  #rule.vec &lt;- c(rep("k.of.m", 3), "Modified.CA",  rep("k.of.m", 3))

  #m.vec &lt;- c(2, 3, 4, 4, 1, 2, 1)

  #n.mean.vec &lt;- c(rep(1, 4), 2, 2, 3)

  #n.scenarios &lt;- length(rule.vec)

  #K.vec &lt;- numeric(n.scenarios)

  #Power.vec &lt;- numeric(n.scenarios)

  #K.vec &lt;- predIntNormSimultaneousK(n = 25, k = 1, m = m.vec,  n.mean = n.mean.vec, 
  #  r = 2, rule = rule.vec,  pi.type = "upper", conf.level = conf.level)

  #Power.vec &lt;- predIntNormSimultaneousTestPower(n = 25, k = 1, m = m.vec, 
  #  n.mean = n.mean.vec, r = 2, rule = rule.vec,  delta.over.sigma = 3, 
  #  pi.type = "upper",  conf.level = conf.level)

  #Power.df &lt;- data.frame(Rule = rule.vec, k = rep(1, n.scenarios),  m = m.vec, 
  #  N.Mean = n.mean.vec, K = round(K.vec, 2),  Power = round(Power.vec, 2),
  #  Total.Samples = m.vec * n.mean.vec)

  #Power.df

  #         Rule k m N.Mean    K Power Total.Samples
  #1      k.of.m 1 2      1 3.16  0.39             2
  #2      k.of.m 1 3      1 2.33  0.65             3
  #3      k.of.m 1 4      1 1.83  0.81             4
  #4 Modified.CA 1 4      1 2.57  0.71             4
  #5      k.of.m 1 1      2 3.62  0.41             2
  #6      k.of.m 1 2      2 2.33  0.85             4
  #7      k.of.m 1 1      3 2.99  0.71             3

  # The above table shows the K-multipliers for each prediction interval, along with
  # the power of detecting a change in concentration of three standard deviations at
  # any of the 100 wells during the course of a year, for each of the sampling
  # strategies considered.  The last three rows of the table correspond to sampling
  # strategies that involve using the mean of two or three observations.

  #==========

  # Clean up
  #---------
  rm(nc, nw, conf.level, rule.vec, m.vec, n.mean.vec, n.scenarios, K.vec, 
    Power.vec, Power.df)
</code></pre>


</div>