<div class="container">

<table style="width: 100%;"><tr>
<td>contourmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contour maps and contour map quality measures for latent Gaussian models</h2>

<h3>Description</h3>

<p><code>contourmap</code> is used for calculating contour maps and quality measures for contour maps for Gaussian models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">contourmap(
  mu,
  Q,
  vars,
  n.levels,
  ind,
  levels,
  type = c("standard", "pretty", "equalarea", "P0-optimal", "P1-optimal", "P2-optimal"),
  compute = list(F = TRUE, measures = NULL),
  use.marginals = TRUE,
  alpha,
  F.limit,
  n.iter = 10000,
  verbose = FALSE,
  max.threads = 0,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Expectation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>Precomputed marginal variances (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.levels</code></td>
<td>
<p>Number of levels in contour map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Indices of the nodes that should be analyzed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Levels to use in contour map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of contour map. One of:
</p>

<dl>
<dt>'standard' </dt>
<dd>
<p>Equidistant levels between smallest and largest value of the posterior mean (default).</p>
</dd>
<dt>'pretty' </dt>
<dd>
<p>Equally spaced 'round' values which cover the range of the values in the posterior mean.</p>
</dd>
<dt>'equalarea' </dt>
<dd>
<p>Levels such that different spatial regions are approximately equal in size.</p>
</dd>
<dt>'P0-optimal' </dt>
<dd>
<p>Levels chosen to maximize the P0 measure.</p>
</dd>
<dt>'P1-optimal' </dt>
<dd>
<p>Levels chosen to maximize the P1 measure.</p>
</dd>
<dt>'P2-optimal' </dt>
<dd>
<p>Levels chosen to maximize the P2 measure.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute</code></td>
<td>
<p>A list with quality indices to compute
</p>

<dl>
<dt>'F': </dt>
<dd>
<p>TRUE/FALSE indicating whether the contour map function should be computed (default TRUE).</p>
</dd>
<dt>'measures': </dt>
<dd>
<p>A list with the quality measures to compute ("P0", "P1", "P2") or corresponding bounds based only on the marginal probabilities ("P0-bound", "P1-bound", "P2-bound").</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.marginals</code></td>
<td>
<p>Only marginal distributions are used when finding P-optimal maps (default TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Maximal error probability in contour map function (default=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.limit</code></td>
<td>
<p>The limit value for the computation of the F function. F is set to NA for all nodes where F&lt;1-F.limit. Default is F.limit = <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Number or iterations in the MC sampler that is used for calculating the quantities in <code>compute</code>. The default value is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to TRUE for verbose mode (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.threads</code></td>
<td>
<p>Decides the number of threads the program can use. Set to 0 for using the maximum number of threads allowed by the system (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed (optional).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Gaussian model is specified using the mean <code>mu</code> and the precision matrix
<code>Q</code>. The contour map is then computed for the mean, using either the contour
levels specified in <code>levels</code>, or <code>n.levels</code> contours that are placed according
to the argument <code>type</code>.
</p>
<p>A number of quality measures can be computed based based on the specified contour map
and the Gaussian distribution. What should be computed is specified using the
<code>compute</code> argument. For details on these quanties, see the reference below.
</p>


<h3>Value</h3>

<p><code>contourmap</code> returns an object of class "excurobj" with the following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u </code></td>
<td>
<p>Contour levels used in the contour map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.levels </code></td>
<td>
<p>The number of contours used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.e </code></td>
<td>
<p>The values associated with the level sets G_k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G </code></td>
<td>
<p>A vector which shows which of the level sets G_k each node belongs to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map </code></td>
<td>
<p>Representation of the contour map with map[i]=u.e[k] if i is in G_k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F </code></td>
<td>
<p>The contour map function (if computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M </code></td>
<td>
<p>Contour avoiding sets (if <code>F</code> is computed). <code class="reqn">M=-1</code> for all non-significant nodes and  <code class="reqn">M=k</code> for nodes that belong to <code class="reqn">M_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0/P1/P2 </code></td>
<td>
<p>Calculated quality measures (if computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0bound/P1bound/P2bound </code></td>
<td>
<p>Calculated upper bounds quality measures (if computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta </code></td>
<td>
<p>A list containing various information about the calculation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a>
</p>


<h3>References</h3>

<p>Bolin, D. and Lindgren, F. (2017) <em>Quantifying the uncertainty of contour maps</em>, Journal of Computational and Graphical Statistics, vol 26, no 3, pp 513-524.
</p>
<p>Bolin, D. and Lindgren, F. (2018), <em>Calculating Probabilistic Excursion Sets and Related Quantities Using excursions</em>, Journal of Statistical Software, vol 86, no 1, pp 1-20.
</p>


<h3>See Also</h3>

<p><code>contourmap.inla</code>, <code>contourmap.mc</code>, <code>contourmap.colors</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 10
Q &lt;- Matrix(toeplitz(c(1, -0.5, rep(0, n - 2))))
mu &lt;- seq(-5, 5, length = n)
lp &lt;- contourmap(mu, Q,
  n.levels = 2,
  compute = list(F = FALSE, measures = c("P1", "P2")),
  max.threads = 1
)
# Plot the contourmap
plot(lp$map)
# Display the quality measures
cat(c(lp$P1, lp$P2))
</code></pre>


</div>