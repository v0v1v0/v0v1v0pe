<div class="container">

<table style="width: 100%;"><tr>
<td>ci_connorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ci_connorm .</h2>

<h3>Description</h3>

<p>Confidence intervals on normal mean, subject to linear constraints.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci_connorm(y, A, b, eta, Sigma = NULL, p = c(level/2, 1 - (level/2)),
  level = 0.05, Sigma_eta = Sigma %*% eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an <code class="reqn">n</code> vector, assumed multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>an <code class="reqn">k \times n</code> matrix of constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a <code class="reqn">k</code> vector of inequality limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of the test contrast, <code class="reqn">\eta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>an <code class="reqn">n \times n</code> matrix of the population covariance, <code class="reqn">\Sigma</code>.
Not needed if <code>Sigma_eta</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector of probabilities for which we return
equivalent <code class="reqn">\eta^{\top}\mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>if <code>p</code> is not given, we set it by default to
<code>c(level/2,1-level/2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of <code class="reqn">\Sigma \eta</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Inverts the constrained normal inference procedure described
by Lee <em>et al.</em>
</p>
<p>Let <code class="reqn">y</code> be multivariate normal with unknown mean <code class="reqn">\mu</code>
and known covariance <code class="reqn">\Sigma</code>. Conditional on <code class="reqn">Ay \le b</code>
for conformable matrix <code class="reqn">A</code> and vector <code class="reqn">b</code>, and given
constrast vector <code class="reqn">eta</code> and level <code class="reqn">p</code>, we compute
<code class="reqn">\eta^{\top}\mu</code> such that the cumulative distribution of
<code class="reqn">\eta^{\top}y</code> equals <code class="reqn">p</code>.
</p>


<h3>Value</h3>

<p>The values of <code class="reqn">\eta^{\top}\mu</code> which have the corresponding
CDF.
</p>


<h3>Note</h3>

<p>An error will be thrown if we do not observe <code class="reqn">A y \le b</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee, J. D., Sun, D. L., Sun, Y. and Taylor, J. E. "Exact post-selection inference, 
with application to the Lasso." Ann. Statist. 44, no. 3 (2016): 907-927.
doi:10.1214/15-AOS1371. <a href="https://arxiv.org/abs/1311.6238">https://arxiv.org/abs/1311.6238</a>
</p>


<h3>See Also</h3>

<p>the CDF function, <code>pconnorm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
n &lt;- 10
y &lt;- rnorm(n)
A &lt;- matrix(rnorm(n*(n-3)),ncol=n)
b &lt;- A%*%y + runif(nrow(A))
Sigma &lt;- diag(runif(n))
mu &lt;- rnorm(n)
eta &lt;- rnorm(n)

pval &lt;- pconnorm(y=y,A=A,b=b,eta=eta,mu=mu,Sigma=Sigma)
cival &lt;- ci_connorm(y=y,A=A,b=b,eta=eta,Sigma=Sigma,p=pval)
stopifnot(abs(cival - sum(eta*mu)) &lt; 1e-4)

</code></pre>


</div>