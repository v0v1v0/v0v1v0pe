<div class="container">

<table style="width: 100%;"><tr>
<td>earth.object</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An earth object</h2>

<h3>Description</h3>

<p>The object returned by the <code>earth</code> function.
</p>
<p>This is an <code>S3</code> model of <code>class</code> <code>"earth"</code>.
It is a list with the components listed below.
</p>
<p><em>Term</em> refers to a term created during the
forward pass (each line of the output from <code>format.earth</code>
is a term).
Term number 1 is always the intercept.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rss</code></td>
<td>

<p>Residual sum-of-squares (RSS) of the model (summed over all responses,
if <code>y</code> has multiple columns).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsq</code></td>
<td>

<p><code>1-rss/tss</code>.
R-Squared of the model (calculated over all responses,
and calculated using the <code>weights</code> argument if it was supplied).
A measure of how well the model fits the training data.
Note that <code>tss</code> is the total sum-of-squares, <code>sum((y - mean(y))^2)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcv</code></td>
<td>

<p>Generalized Cross Validation (GCV) of the model (summed over all responses).
The GCV is calculated using the <code>penalty</code> argument.
For details of the GCV calculation, see
equation 30 in Friedman's MARS paper and <code>earth:::get.gcv</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grsq</code></td>
<td>

<p><code>1-gcv/gcv.null</code>.
An estimate of the predictive power of the model (calculated over all responses,
and calculated using the <code>weights</code> argument if it was supplied).
<code>gcv.null</code> is the GCV of an intercept-only model.
See “<em>Can <code>GRSq</code> be negative?</em>” in the vignette.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bx</code></td>
<td>

<p>Matrix of basis functions applied to <code>x</code>.
Each column corresponds to a selected term.
Each row corresponds to a row in in the input matrix <code>x</code>,
after taking <code>subset</code>.
See <code>model.matrix.earth</code> for an example of <code>bx</code> handling.
Example <code>bx</code>:</p>
<pre>     (Intercept)  h(Girth-12.9)  h(12.9-Girth)  h(Girth-12.9)*h(...
[1,]           1            0.0            4.6                    0
[2,]           1            0.0            4.3                    0
[3,]           1            0.0            4.1                    0
...</pre>

</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirs</code></td>
<td>

<p>Matrix with one row per MARS term, and with with ij-th element equal to<br></p>
<p><code>0</code>  if predictor j is not in term i<br><code>-1</code> if an expression of the form <code>h(const - xj)</code> is in term i<br><code>1</code>  if an expression of the form <code>h(xj - const)</code> is in term i<br><code>2</code>  if predictor j should enter term i linearly
(either because specified by the <code>linpreds</code> argument or because earth
discovered that a knot was unnecessary).<br></p>
<p>This matrix includes all terms generated by the forward pass,
including those not in <code>selected.terms</code>.
Note that here the terms may not all be in pairs, because
although the forward pass add terms as hinged pairs (so both sides of
the hinge are available as building blocks for further terms), it also
deletes linearly dependent terms before handing control to the pruning pass.
Example <code>dirs</code>:</p>
<pre>                        Girth Height
(Intercept)                 0      0  # intercept
h(12.9-Girth)              -1      0  # 2nd term uses Girth
h(Girth-12.9)               1      0  # 3rd term uses Girth
h(Girth-12.9)*h(Height-76)  1      1  # 4th term uses Girth and Height
...
</pre>

</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>

<p>Matrix with ij-th element equal to the cut point (hinge value)
for predictor j in term i.
This matrix includes all terms generated by the forward pass,
including those not in <code>selected.terms</code>.
Note for programmers: the precedent is to use <code>dirs</code>
for term names etc. and to only use <code>cuts</code> where cut information needed.
Example <code>cuts</code>:</p>
<pre>                           Girth Height
(Intercept)                    0      0  # intercept, no cuts
h(12.9-Girth)               12.9      0  # 2nd term has cut at 12.9
h(Girth-12.9)               12.9      0  # 3rd term has cut at 12.9
h(Girth-12.9)*h(Height-76)  12.9     76  # 4th term has two cuts
...</pre>

</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prune.terms</code></td>
<td>

<p>A matrix specifying which terms appear in which pruning pass subsets.
The row index of <code>prune.terms</code> is the model size.
(The model size is the number of terms in the model.
The intercept is counted as a term.)
Each row is a vector of term numbers for the best model of that size.
An element is 0 if the term is not in the model, thus <code>prune.terms</code> is a
lower triangular matrix, with dimensions <code>nprune x nprune</code>.
The model selected by the pruning pass is at row number <code>length(selected.terms)</code>.
</p>
<p>Example <code>prune.terms</code>:</p>
<pre>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    0    0    0    0    0    0   # intercept-only model
[2,]    1    2    0    0    0    0    0   # best 2 term model uses terms 1,2
[3,]    1    2    4    0    0    0    0   # best 3 term model uses terms 1,2,4
[4,]    1    2    6    9    0    0    0   # and so on
...</pre>

</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.terms</code></td>
<td>

<p>Vector of term numbers in the selected model.
Can be used as a row index vector into <code>cuts</code> and <code>dirs</code>.
The first element <code>selected.terms[1]</code> is always 1, the intercept.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>

<p>Fitted values.
A matrix with dimensions <code>nrow(y) x ncol(y)</code>
after factors in <code>y</code> have been expanded.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>

<p>Residuals.
A matrix with dimensions <code>nrow(y) x ncol(y)</code>
after factors in <code>y</code> have been expanded.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>

<p>Regression coefficients.
A matrix with dimensions <code>length(selected.terms) x ncol(y)</code>
after factors in <code>y</code> have been expanded.
Each column holds the least squares coefficients from regressing that
column of <code>y</code> on <code>bx</code>.
The first row holds the intercept coefficient(s).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rss.per.response</code></td>
<td>

<p>A vector of the RSS for each response.
Length is the number of responses, i.e., <code>ncol(y)</code> after factors in <code>y</code> have been expanded.
The <code>rss</code> component above is  equal to <code>sum(rss.per.response)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsq.per.response</code></td>
<td>

<p>A vector of the R-Squared for each response
(where R-Squared is calculated using the <code>weights</code> argument if it was supplied).
Length is the number of responses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcv.per.response</code></td>
<td>

<p>A vector of the GCV for each response.
Length is the number of responses.
The <code>gcv</code> component above is equal to <code>sum(gcv.per.response)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grsq.per.response</code></td>
<td>

<p>A vector of the GRSq for each response
(calculated using the <code>weights</code> argument if it was supplied).
Length is the number of responses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rss.per.subset</code></td>
<td>

<p>A vector of the RSS
for each model subset generated by the pruning pass.
Length is <code>nprune</code>.
For multiple responses, the RSS is summed over all responses for each subset.
The <code>rss</code> above is<br><code>rss.per.subset[length(selected.terms)]</code>.
The RSS of an intercept only-model is <code>rss.per.subset[1]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcv.per.subset</code></td>
<td>

<p>A vector of the GCV for each model in <code>prune.terms</code>.
Length is <code>nprune</code>.
For multiple responses, the GCV is summed over all responses for each subset.
The <code>gcv</code> above is <code>gcv.per.subset[length(selected.terms)]</code>.
The GCV of an intercept-only model is <code>gcv.per.subset[1]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leverages</code></td>
<td>

<p>Diagonal of the hat matrix (from the linear regression of the response on <code>bx</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty,nk,thresh</code></td>
<td>

<p>Copies of the corresponding arguments to <code>earth</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmethod,nprune</code></td>
<td>

<p>Copies of the corresponding arguments to <code>earth</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights,wp</code></td>
<td>

<p>Copies of the corresponding arguments to <code>earth</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>termcond</code></td>
<td>

<p>Reason the forward pass terminated (an integer).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>

<p>The call used to invoke <code>earth</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>

<p>Model frame terms.
This component exists only if the model was built using <code>earth.formula</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modvars</code></td>
<td>

<p>A matrix specifying which input variables
are used in each column of the model matrix.
(This field is <b>new in earth 5.2.0</b>.)<br>
Columns correspond to columns of the model matrix (same as cols of <code>dirs</code>, see above).<br>
Rows correspond to variables in the formula.
</p>
<p>For example, the formula:</p>
<pre>    survived ~ age + pclass + sqrt(age) - sex
</pre>
<p>results in:
</p>
<p><code>attr(terms,"factors")</code>:</p>
<pre>                age  pclass  sqrt(age)
    survived      0       0          0  # the response will be dropped
    age           1       0          0
    pclass        0       1          0
    sqrt(age)     0       0          1  # sqrt(age) will be merged with age
    sex           0       0          0  # sex is unused and will be dropped
</pre>
<p><code>modvars</code>:</p>
<pre>            age pclass2nd pclass3rd sqrt(age)
    age       1         0         0         1  # age and sqrt(age) use "age"
    pclass    0         1         1         0  # pclass2nd and pclass3rd use "pclass"
</pre>
<p>Note that for models built with <code>earth.default</code> (<code>x,y</code> models),
“derived variables” are not combined in <code>modvars</code> as they are for formula models.
The row names of <code>modvars</code> match the column names of <code>x</code>,
after factor expansion.
Columns in <code>x</code> named <code>"age"</code> and <code>"sqrt(age)"</code>
will be treated as two separate variables.





</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>namesx</code></td>
<td>

<p>Variable names in the input data.  Deprecated (subsumed by <code>modvars</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>

<p>This component exists only if the model was built using <code>earth.formula</code>.<br>
Same as <code>lm</code>.  A record of the levels of the factors used in fitting,
needed under certain conditions by <code>predict.earth</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>

<p>This component exists only if the model was built using <code>earth.default</code>.<br>
Levels of <code>y</code> if <code>y</code> is a <code>factor</code>,<br><code>c(FALSE,TRUE)</code> if <code>y</code> is <code>logical</code>,<br>
Else <code>NULL</code>.
<br><br><b>The following fields appear only if <code>earth</code>'s argument <code>keepxy</code> is <code>TRUE</code>.</b>
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td>
<code>x</code>,<code>y</code>,<code>data</code>,<code>subset</code>
</td>
<td>

<p>Copies of the corresponding arguments to <code>earth</code>.
Only exist if <code>keepxy=TRUE</code>.
<br><br><b>The following fields appear only if <code>earth</code>'s <code>glm</code> argument is used.</b>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.list</code></td>
<td>

<p>List of GLM models. Each element is the value returned by <code>earth</code>'s
internal call to <code>glm</code> for each response.<br>
Thus if there is a single response (or a single binomial pair, see
“<em>Binomial pairs</em>” in the vignette)
this will be a one element list and you access the GLM model with
<code>earth.mod$glm.list[[1]]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.coefficients</code></td>
<td>

<p>GLM regression coefficients.
Analogous to the <code>coefficients</code> field described above but for the GLM model(s).
A matrix with dimensions <code>length(selected.terms) x ncol(y)</code>
after factors in <code>y</code> have been expanded.
Each column holds the coefficients from the GLM regression of that
column of <code>y</code> on <code>bx</code>.
This duplicates, for convenience, information buried in <code>glm.list</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.stats</code></td>
<td>

<p>GLM summary statistics such as <code>devratio</code>, <code>AIC</code>, and <code>iters</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.bpairs</code></td>
<td>

<p>Is <code>NULL</code> unless there are paired binomial columns.
Else a logical vector <code>c(TRUE, FALSE)</code>.
See “<em>Binomial pairs</em>” in the vignette.
Retained for backwards compatibility with old versions of earth.
<br><br><b>The following fields appear only if the <code>nfold</code> argument is greater than 1.</b>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.list</code></td>
<td>

<p>List of <code>earth</code> models, one model for each fold (<code>ncross * nfold</code> models).<br>
The fold models have two extra fields,
<code>icross</code> (an integer from <code>1</code> to <code>ncross</code>)
and <code>ifold</code> (an integer from <code>1</code> to <code>nfold</code>).<br>
To save memory, lengthy fields
in the fold models are removed unless you use <code>keepxy=TRUE</code>.
The “lengthy fields” are <code>$bx</code>, <code>$fitted.values</code>, and <code>$residuals</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.nterms</code></td>
<td>

<p>Vector of length <code>ncross * nfold + 1</code>.
Number of MARS terms in the model generated at each cross-validation fold,
with the final element being the mean of these.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.nvars</code></td>
<td>

<p>Vector of length <code>ncross * nfold + 1</code>.
Number of predictors in the model generated at each cross-validation fold,
with the final element being the mean of these.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.groups</code></td>
<td>

<p>Specifies which cases went into which folds.
Matrix with two columns and number of rows equal to the the number of cases <code>nrow(x)</code>
Elements of the first column specify the cross-validation number, <code>1:ncross</code>.
Elements of the second column specify the fold number, <code>1:nfold</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.rsq.tab</code></td>
<td>

<p>Matrix with <code>ncross * nfold + 1</code> rows and <code>nresponse+1</code> columns,
where <code>nresponse</code> is the number of responses,
i.e., <code>ncol(y)</code> after factors in <code>y</code> have been expanded.
The first <code>nresponse</code> elements of a row are the <code>cv.rsq</code>'s on
the out-of-fold data for each response of the model generated at that row's fold.
(A <code>cv.rsq</code> is calculated from predictions on the out-of-fold data
using the best model built from the in-fold data;
where “best” means the model was selected using the in-fold GCV.
The R-Squareds are calculated using the <code>weights</code> argument if it was supplied.
The final column holds the row mean (a weighted mean if <code>wp</code> if specified)).
The final row holds the column means.
The values in this final row is the mean <code>cv.rsq</code>
printed by <code>summary.earth</code>.
<br><br>
Example for a single response model (where the <code>mean</code> column
is redundant but included for uniformity with multiple response models):
</p>
<pre>           y  mean
fold1  0.909 0.909
fold2  0.869 0.869
fold3  0.952 0.952
fold4  0.157 0.157
fold5  0.961 0.961
mean   0.769 0.769
</pre>
<p>Example for a multiple response model:
</p>
<pre>         y1   y2    y3   mean
fold1 0.915 0.951 0.944 0.937
fold2 0.962 0.970 0.970 0.968
fold3 0.914 0.940 0.942 0.932
fold4 0.907 0.929 0.925 0.920
fold5 0.947 0.987 0.979 0.971
mean  0.929 0.955 0.952 0.946

</pre>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.class.rate.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the classification rate at each fold
i.e. the fraction of classes correctly predicted.
Models with discrete response only.
Calculated with <code>thresh=.5</code> for binary responses.
For responses with more than two
levels, the final row is the overall classification rate.  The other
rows are the classification rates for each level (the level
versus not-the-level), which are usually higher than the overall
classification rate (predicting the level versus not-the-level is
easier than correctly predicting one of many levels).
The <code>weights</code> argument is ignored for all cross-validation stats except R-Squareds.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.maxerr.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the <code>MaxErr</code> at each fold.
This is the signed max absolute value at each fold.
Results are aggregated for the final column and final row
using the signed max absolute value.
The <em>signed max absolute value</em> is defined
as the maximum of the absolute difference
between the predicted and observed response values, multiplied
by <code>-1</code> if the sign of that difference is negative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.auc.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the <code>AUC</code> at each fold.
Binomial models only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.cor.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the <code>cor</code> at each fold.
Poisson models only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.deviance.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the <code>MeanDev</code> at each fold.
Binomial models only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.calib.int.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the <code>CalibInt</code> at each fold.
Binomial models only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.calib.slope.tab</code></td>
<td>

<p>Like <code>cv.rsq.tab</code> but is the <code>CalibSlope</code> at each fold.
Binomial models only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.oof.rsq.tab</code></td>
<td>

<p>Generated only if <code>keepxy=TRUE</code> or <code>pmethod="cv"</code>.<br>
A matrix with <code>ncross * nfold + 1</code> rows and <code>max.nterms</code> columns,
Each element holds an out-of-fold RSq (<code>oof.rsq</code>),
calculated from predictions from the out-of-fold observations using
the model built with the in-fold data.  The final row is the mean over
all folds.
The R-Squareds are calculated using the <code>weights</code> argument if it was supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.infold.rsq.tab</code></td>
<td>

<p>Generated only if <code>keepxy=TRUE</code>.
Like <code>cv.oof.rsq.tab</code> but from predictions made on the in-fold observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.oof.fit.tab</code></td>
<td>

<p>Generated only if the <code>varmod.method</code> argument is used.
Predicted values on the out-of-fold data.
Dataframe with <code>nrow(data)</code> rows and <code>ncross</code> columns.
<br><br><b>The following field appears only if the <code>varmod.method</code> is specified.</b>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmod</code></td>
<td>

<p>An object of class <code>"varmod"</code>.
See the <code>varmod</code> help page for a description.
Only appears if the <code>varmod.method</code> argument is used.
</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>earth</code>
</p>


</div>