<div class="container">

<table style="width: 100%;"><tr>
<td>borrTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Boundary-Optimized Rejection Region Test</h2>

<h3>Description</h3>

<p>An unconditional exact test for the two-sample binomial problem 
when it is expected that theta1 (probability of an event in group 1)   
will be close to 1. Used for test versus control when all controls are 
expected to fail.
</p>


<h3>Usage</h3>

<pre><code class="language-R">borrTest(x1, n1, x2, n2, tuningParm = 0.025,
    parmtype = c("ratio", "difference", "oddsratio"), 
    nullparm = NULL, alternative = c("less", "greater", "two.sided"), 
    conf.int = TRUE, conf.level = 0.975,  
    controlUC = ucControl(), controlborr = borrControl(), ...)

borrPvals(n1,n2, tuningParm=0.025,    
    parmtype = c("ratio", "difference","oddsratio"), 
    nullparm = NULL, alternative = c("less", "greater","two.sided"),  
    conf.int = TRUE, conf.level = 0.975,
    controlUC=ucControl(), controlborr=borrControl(),...)

borrOrdering(n1,n2,tuningParm = .025,
            controlborr=borrControl())
            
powerBorr(n1,n2,p1,p2,alpha=0.025,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>

<p>number of events in group 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>sample size in group 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>

<p>number of events in group 2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>

<p>sample size in group 2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuningParm</code></td>
<td>

<p>tuning parameter, default is 0.025 and designs BORR tests with maximum power
for one-sided 0.025 tests
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmtype</code></td>
<td>

<p>parameter type, either 'ratio' for theta2/theta1, 
'difference' for theta2-theta1, or
'oddsratio' for theta2*(1-theta1)/(theta1*(1-theta2)).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullparm</code></td>
<td>

<p>null parameter value, default=NULL gives parameter value for 
theta1=theta2 (e.g., 1 for 'ratio' or 0 for 'difference' ).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>alternative hypothesis, BORR tests are designed for alternative='less' 
(see Note for other alternatives)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>

<p>logical, should confidence interval be calculated?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>confidence level, default is 0.975 (see note)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlUC</code></td>
<td>

<p>a list of control parameters to define algorithms in the call to <code>uncondExact2x2</code>, see <code>ucControl</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlborr</code></td>
<td>

<p>a list of control parameters to define algorithms, see <code>borrControl</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>

<p>probability of an event in group 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>

<p>probability of an event in group 2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>alpha-level for rejecting, reject when p-value </p>
<p style="text-align: center;"><code class="reqn">latex</code>
</p>
<p> alpha
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>extra arguments passed (only used for <code>powerBorr</code>, passes arguments to the <code>borrPvals</code> function)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The boundary-optimized rejection region test is designed to test the one-sided alternative that 
theta2 &lt; theta1, where X1 is binomial(n1,theta1), and X2 is binomial(n2,theta2). The test is 
designed to be optimal when theta1 is very close to 1. For example, in a vaccine malaria challenge study
where we expect all n1 individuals that got the control vaccine to have the event (get malaria when challenged with malaria). For details see Gabriel et al (2018). 
</p>
<p>The function <code>borrTest</code> tests the results of one study, and returns 
an <code>htest</code> object. The function <code>borrPvals</code> calculates the p-values for every possible result of a study. The function <code>borrOrdering</code> orders every possible result of the study.
See <code>borrOrderingInternal</code> for calculation details. The function <code>powerBorr</code> calculates the power
where p-values are calculated by <code>borrPvals</code> and rejection is when </p>
<p style="text-align: center;"><code class="reqn">latex</code>
</p>
<p> alpha.
</p>


<h3>Value</h3>

<p>The function <code>borrPvals</code> returns a (n1+1) by (n2+1) matrix of p-values for all possible x1 and x2 values. The function <code>borrOrdering</code> returns a matrix with the rank of all possible x1 and x2 values. The function <code>borrTest</code> returns a list of class <code>htest</code> with elements: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>proportion in sample 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>proportion in sample 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value from test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>confidence interval on parameter given by parmtype</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>MLE estimate of parameter given by parmtype</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>null hypothesis value of parameter given by parmtype</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>description of test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>description of data</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The tests are designed to have good power for the one-sided test that H0: theta2 <code class="reqn">\ge</code> theta1, with 
alternative H1: theta2 &lt; theta1 at significance level equal to <code>tuningParm</code>. Since the default <code>tuningParm</code> is 0.025, the default confidence level is 0.975 so that the confidence intervals will be compatible with the test where the one-sided p-values reject at level 0.025. 
</p>
<p>Sometimes you may want two-sided confidence intervals on the 
parameter of interest. If you ask for a two-sided alternative, then the confidence interval and the resulting p-value will be two-sided as well. The default is a 'central' interval, so the two-sided p-value should be twice the minimum of the one-sided p-values. Further, with a <code>conf.level</code> of 0.95 for the two-sided alternative, the error on each side will be bounded by 0.025. </p>


<h3>Author(s)</h3>

<p>Martha Nason, Erin Gabriel, Michael P. Fay
</p>


<h3>References</h3>

<p>Gabriel, EE, Nason, M, Fay, MP, and Follmann, DA. (2018). A boundary-optimized rejection region test for the two-sample binomial problem. Statistics in Medicine. 37(7): 1047-1058  (DOI: 10.1002/sim.7579).
</p>
<p>Gabriel, EE, Nason, M, Fay, MP, and Follmann, DA. (2018). Reply to letter from Martin Andres. Statistics in Medicine 37(14): 2303-2306.
</p>
<p>Martin Andres, Antonio. (2018). Letter to the editor about Gabriel et al. Statistics in Medicine 37(14) 2301-2302.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: borrTest(4,4,1,4)
# Note Figure 2 in Gabriel et al is incorrect. The correct value 
# is in the response letter, and given by 
borrOrdering(4,4,tuningParm=0.025)$rankMat
</code></pre>


</div>