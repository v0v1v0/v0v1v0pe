<div class="container">

<table style="width: 100%;"><tr>
<td>plot.cgr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot graph of direct species associations.</h2>

<h3>Description</h3>

<p>Plot graph of direct species associations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cgr'
plot(
  x,
  P = NULL,
  vary.edge.lwd = FALSE,
  edge.col = c("light blue", "pink"),
  label = colnames(x$obj$fitted),
  vertex.col = "blue",
  label.cex = 0.8,
  edge.lwd = ifelse(vary.edge.lwd, 10, 4),
  edge.lty = c(1, 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>is a cgr object, e.g. from output of <code>cgr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>locations of graph nodes, if NULL (default) these are generated with a Fruchterman Reingold algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vary.edge.lwd</code></td>
<td>
<p>is logical, TRUE will vary line width according to the strength of partial correlation, default (FALSE) uses fixed line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.col</code></td>
<td>
<p>takes two colours as arguments - the first is the colour used for positive partial correlations, the second is the colour of negative partial correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>is a vector of labels to apply to each variable, defaulting to the column names supplied in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.col</code></td>
<td>
<p>the colour of graph nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.cex</code></td>
<td>
<p>is the size of labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.lwd</code></td>
<td>
<p>is line width, defaulting to 10*partial correlation when varying edge width, and 4 otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.lty</code></td>
<td>
<p>is a vector of two integers specifying the line types for positive and negative partial correlations, respectively. Both default to solid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to be passed through to plotting gplot, in particular <code>pad</code>, the amount to pad the plotting range is useful if labels are being clipped. For details see the <code>gplot</code> help file.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a plot of species associations after accounting for the effect of all other species, positive/negative are blue/pink.
The matrix of node positions (<code>P</code>) is returned silently.
</p>


<h3>See Also</h3>

<p><code>gplot</code>, <code>cgr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">abund &lt;- spider$abund[,1:5]
spider_mod &lt;- stackedsdm(abund,~1, data = spider$x, ncores=2) 
spid_graph=cgr(spider_mod)
plot(spid_graph, edge.col=c("forestgreen","darkorchid4"), 
                 vertex.col = "black",vary.edge.lwd=TRUE)
                 

library(tidyr)
library(tidygraph)
library(ggraph)

igraph_out&lt;-spid_graph$best_graph$igraph_out

igraph_out %&gt;% ggraph('fr') + # see ?layout_tbl_graph_igraph
   geom_edge_fan0(aes( colour = partcor, width=partcor)) +
   scale_edge_width(range = c(0.5, 3))+
   scale_edge_color_gradient2(low="#b2182b",mid="white",high="#2166ac")+
   geom_node_text(aes(label=name), repel = TRUE)+
   geom_node_point(aes(size=1.3))+
   theme_void() +
   theme(legend.position = 'none')

</code></pre>


</div>