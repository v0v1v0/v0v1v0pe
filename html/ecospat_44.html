<div class="container">

<table style="width: 100%;"><tr>
<td>ecospat.niche.equivalency.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Niche Equivalency Test</h2>

<h3>Description</h3>

<p>Run a niche equivalency test (see Warren et al 2008) based on two species occurrence density grids.</p>


<h3>Usage</h3>

<pre><code class="language-R">ecospat.niche.equivalency.test (z1, z2, rep, intersection = 0, 
overlap.alternative = "higher", expansion.alternative = "lower", 
stability.alternative = "higher", unfilling.alternative = "lower", ncores = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>
<p>Species 1 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z2</code></td>
<td>
<p>Species 2 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The number of replications to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intersection</code></td>
<td>
<p>The quantile of the environmental density used to remove marginal climates. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expansion.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stability.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unfilling.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of cores used for parallelisation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compares the observed niche overlap, expansion, stability and unfilling between z1 and z2 to simulated values between random niches z1.sim and z2.sim, which are built from random reallocations of occurences of z1 and z2.
</p>
<p><code>intersection</code> allows setting if the niche dynamic indices (expansion, stability and unfilling) are measured across the full extent pooling the two study areas or not. If <code>intersection = NA</code>, the analysis is performed on the whole environmental extent (native and invaded). If <code>instersection = 0</code>, the analysis is performed at the intersection between native and invaded range. If <code>instersection = 0.05</code>, the analysis is performed at the intersection of the 5th quantile of both native and invaded environmental densities. Etc...
</p>
<p><code>overlap.alternative</code> specifies if you want to test for niche conservatism (<code>overlap.alternative = "higher"</code>, i.e. the niche overlap is more equivalent/similar than random) or for niche divergence (<code>overlap.alternative = "lower"</code>, i.e. the niche overlap is less equivalent/similar than random). You can also specifiy if you want to test if you have more, less or different observed niche dynamics than random niches(with <code>expansion.alternative</code>, <code>stability.alternative</code> and <code>unfilling.alternative</code>). If you want to test for niche conservatism, we recommande to set these niche dynamic hypotheses to <code>"lower"</code>, <code>"higher"</code> and <code>"lower"</code> respectively for expansion, stability and unfilling.
</p>
<p>If you encounter a problem during your analyses, please first read the FAQ section of "Niche overlap" in <a href="https://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html">https://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html</a>
</p>
<p>The arguments <code>ncores</code> allows choosing the number of cores used to parallelize the computation.  The default value is 1. On multicore computers, the optimal would be <code>ncores = detectCores() - 1</code>.
</p>


<h3>Value</h3>

<p>a list with $obs = observed overlap and dynamic indices, $sim = simulated overlap and dynamic indices, $p.D = p-value of the test on D, $p.I = p-value of the test on I, $p.expansion = p-value for the test on expansion, $p.stability = p-value for the test on stability, $p.unfilling = p-value for the test on unfilling.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a> with contributions of Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman,B.  Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.
</p>
<p>Warren, D.L., R.E. Glor and M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>, <b>62</b>, 2868-2883.
</p>


<h3>See Also</h3>

<p><code>ecospat.grid.clim.dyn</code>, <code>ecospat.niche.similarity.test</code></p>


</div>