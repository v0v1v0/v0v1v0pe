<div class="container">

<table style="width: 100%;"><tr>
<td>epois</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Parameter of a Poisson Distribution
</h2>

<h3>Description</h3>

<p>Estimate the mean of a Poisson distribution, and 
optionally construct a confidence interval for the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  epois(x, method = "mle/mme/mvue", ci = FALSE, ci.type = "two-sided", 
    ci.method = "exact", conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimation.  Currently the only possible 
value is <code>"mle/mme/mvue"</code> (maximum likelihood/method of moments/minimum variance unbiased; 
the default).  See the DETAILS section for more information. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the 
location or scale parameter.  The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>

<p>character string indicating what kind of confidence interval to compute.  The 
possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>character string indicating what method to use to construct the confidence interval 
for the location or scale parameter.  Possible values are <code>"exact"</code> 
(the default), <code>"pearson.hartley.approx"</code> (Pearson-Hartley approximation), and 
<code>"normal.approx"</code> (normal approximation).  See the DETAILS section for more 
information.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.  
The default value is <code>conf.level=0.95</code>. This argument is ignored if 
<code>ci=FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or 
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to 
performing the estimation.
</p>
<p>Let <code class="reqn">\underline{x} = (x_1, x_2, \ldots, x_n)</code> be a vector of 
<code class="reqn">n</code> observations from a Poisson distribution with 
parameter <code>lambda=</code><code class="reqn">\lambda</code>.  It can be shown (e.g., Forbes et al., 2009) 
that if <code class="reqn">y</code> is defined as:
</p>
<p style="text-align: center;"><code class="reqn">y = \sum_{i=1}^n x_i \;\;\;\; (1)</code>
</p>

<p>then <code class="reqn">y</code> is an observation from a Poisson distribution with parameter 
<code>lambda=</code><code class="reqn">n \lambda</code>.
</p>
<p><b>Estimation</b> <br>
The maximum likelihood, method of moments, and minimum variance unbiased estimator 
(mle/mme/mvue) of <code class="reqn">\lambda</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\lambda} = \bar{x} \;\;\;\; (2)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i = \frac{y}{n} \;\;\;\; (3)</code>
</p>

<p><br></p>
<p><b>Confidence Intervals</b> <br>
There are three possible ways to construct a confidence interval for 
<code class="reqn">\lambda</code>:  based on the exact distribution of the estimator of 
<code class="reqn">\lambda</code> (<code>ci.type="exact"</code>), based on an approximation of 
Pearson and Hartley (<code>ci.type="pearson.hartley.approx"</code>), or based on the 
normal approximation <br>
(<code>ci.type="normal.approx"</code>).
</p>
<p><em>Exact Confidence Interval</em> (<code>ci.method="exact"</code>) <br>
If <code>ci.type="two-sided"</code>, an exact <code class="reqn">(1-\alpha)100\%</code> confidence interval 
for <code class="reqn">\lambda</code> can be constructed as <code class="reqn">[LCL, UCL]</code>, where the confidence 
limits are computed such that:
</p>
<p style="text-align: center;"><code class="reqn">Pr[Y \ge y \| \lambda = LCL] = \frac{\alpha}{2} \;\;\;\; (4)</code>
</p>

<p style="text-align: center;"><code class="reqn">Pr[Y \le y \| \lambda = UCL] = \frac{\alpha}{2} \;\;\;\; (5)</code>
</p>

<p>where <code class="reqn">y</code> is defined in equation (1) and <code class="reqn">Y</code> denotes a Poisson random 
variable with parameter <code>lambda=</code><code class="reqn">n \lambda</code>.
</p>
<p>If <code>ci.type="lower"</code>, <code class="reqn">\alpha/2</code> is replaced with <code class="reqn">\alpha</code> in 
equation (4) and <code class="reqn">UCL</code> is set to <code class="reqn">\infty</code>.
</p>
<p>If <code>ci.type="upper"</code>, <code class="reqn">\alpha/2</code> is replaced with <code class="reqn">\alpha</code> in 
equation (5) and <code class="reqn">LCL</code> is set to 0.
</p>
<p>Note that an exact upper confidence bound can be computed even when all 
observations are 0.
<br></p>
<p><em>Pearson-Hartley Approximation</em> (<code>ci.method="pearson.hartley.approx"</code>) <br>
For a two-sided <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\lambda</code>, the 
Pearson and Hartley approximation (Zar, 2010, p.587; Pearson and Hartley, 1970, p.81) 
is given by:
</p>
<p style="text-align: center;"><code class="reqn">[\frac{\chi^2_{2n\bar{x}, \alpha/2}}{2n}, \frac{\chi^2_{2n\bar{x} + 2, 1 - \alpha/2}}{2n}] \;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">\chi^2_{\nu, p}</code> denotes the <code class="reqn">p</code>'th quantile of the 
chi-square distribution with <code class="reqn">\nu</code> degrees of freedom.
One-sided confidence intervals are computed in a similar fashion.
<br></p>
<p><em>Normal Approximation</em> (<code>ci.method="normal.approx"</code>)
An approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\lambda</code> can be 
constructed assuming the distribution of the estimator of <code class="reqn">\lambda</code> is 
approximately normally distributed.  A two-sided confidence interval is constructed 
as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\lambda} - z_{1-\alpha/2} \hat{\sigma}_{\hat{\lambda}}, \hat{\lambda} + z_{1-\alpha/2} \hat{\sigma}_{\hat{\lambda}}] \;\;\;\; (7)</code>
</p>

<p>where <code class="reqn">z_p</code> is the <code class="reqn">p</code>'th quantile of the standard normal distribution, and 
the quantity
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{\hat{\lambda}} = \sqrt{\hat{\lambda} / n} \;\;\;\; (8)</code>
</p>

<p>denotes the estimated asymptotic standard deviation of the estimator of 
<code class="reqn">\lambda</code>.
</p>
<p>One-sided confidence intervals are constructed in a similar manner.
</p>


<h3>Value</h3>

<p>a list of class <code>"estimate"</code> containing the estimated parameters and other information. <br> 
See <code>estimate.object</code> for details.
</p>


<h3>Note</h3>

<p>The Poisson distribution is named after Poisson, who 
derived this distribution as the limiting distribution of the 
binomial distribution with parameters <code>size=</code><code class="reqn">N</code> 
and <code>prob=</code><code class="reqn">p</code>, where <code class="reqn">N</code> tends to infinity, <code class="reqn">p</code> tends to 0, and 
<code class="reqn">Np</code> stays constant.
</p>
<p>In this context, the Poisson distribution was used by Bortkiewicz (1898) to model 
the number of deaths (per annum) from kicks by horses in Prussian Army Corps.  In 
this case, <code class="reqn">p</code>, the probability of death from this cause, was small, but the 
number of soldiers exposed to this risk, <code class="reqn">N</code>, was large.
</p>
<p>The Poisson distribution has been applied in a variety of fields, including quality 
control (modeling number of defects produced in a process), ecology (number of 
organisms per unit area), and queueing theory.  Gibbons (1987b) used the Poisson 
distribution to model the number of detected compounds per scan of the 32 volatile 
organic priority pollutants (VOC), and also to model the distribution of chemical 
concentration (in ppb).
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).  Statistical Distributions. 
Fourth Edition. John Wiley and Sons, Hoboken, NJ.
</p>
<p>Gibbons, R.D. (1987b).  Statistical Models for the Analysis of Volatile Organic 
Compounds in Waste Disposal Sites.  <em>Ground Water</em> <b>25</b>, 572-580.
</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
John Wiley &amp; Sons, Hoboken.
</p>
<p>Johnson, N. L., S. Kotz, and A. Kemp. (1992).  <em>Univariate Discrete 
Distributions</em>.  Second Edition.  John Wiley and Sons, New York, Chapter 4.
</p>
<p>Pearson, E.S., and H.O. Hartley, eds. (1970).  <em>Biometrika Tables for 
Statisticians, Volume 1</em>.  Cambridge Universtiy Press, New York, p.81.
</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. 
Fifth Edition. Prentice-Hall, Upper Saddle River, NJ, pp. 585â€“586.  
</p>


<h3>See Also</h3>

<p>Poisson.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a Poisson distribution with parameter 
  # lambda=2, then estimate the parameter and construct a 90% confidence 
  # interval. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  dat &lt;- rpois(20, lambda = 2) 
  epois(dat, ci = TRUE, conf.level = 0.9) 

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Poisson
  #
  #Estimated Parameter(s):          lambda = 1.8
  #
  #Estimation Method:               mle/mme/mvue
  #
  #Data:                            dat
  #
  #Sample Size:                     20
  #
  #Confidence Interval for:         lambda
  #
  #Confidence Interval Method:      exact
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                90%
  #
  #Confidence Interval:             LCL = 1.336558
  #                                 UCL = 2.377037

  #----------

  # Compare the different ways of constructing confidence intervals for 
  # lambda using the same data as in the previous example:

  epois(dat, ci = TRUE, ci.method = "pearson", 
    conf.level = 0.9)$interval$limits 
  #     LCL      UCL 
  #1.336558 2.377037

  epois(dat, ci = TRUE, ci.method = "normal.approx",  
    conf.level = 0.9)$interval$limits 
  #     LCL      UCL 
  #1.306544 2.293456 

  #----------

  # Clean up
  #---------

  rm(dat)
</code></pre>


</div>