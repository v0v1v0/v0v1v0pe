<div class="container">

<table style="width: 100%;"><tr>
<td>simconf.mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simultaneous confidence regions using Monte Carlo samples</h2>

<h3>Description</h3>

<p><code>simconf.mc</code> is used for calculating simultaneous confidence regions based
on Monte Carlo samples. The function returns upper and lower bounds <code class="reqn">a</code> and
<code class="reqn">b</code> such that <code class="reqn">P(a&lt;x&lt;b) = 1-\alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simconf.mc(samples, alpha, ind, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Matrix with model Monte Carlo samples. Each column contains a sample of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Error probability for the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Indices of the nodes that should be analyzed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to TRUE for verbose mode (optional).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>simconf</code> for details.
</p>


<h3>Value</h3>

<p>An object of class "excurobj" with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a </code></td>
<td>
<p>The lower bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b </code></td>
<td>
<p>The upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.marginal </code></td>
<td>
<p>The lower bound for pointwise confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.marginal </code></td>
<td>
<p>The upper bound for pointwise confidence bands.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>simconf</code>, <code>simconf.inla</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create mean and a tridiagonal precision matrix
n &lt;- 11
mu.x &lt;- seq(-5, 5, length = n)
Q.x &lt;- Matrix(toeplitz(c(1, -0.1, rep(0, n - 2))))
## Sample the model 100 times (increase for better estimate)
X &lt;- mu.x + solve(chol(Q.x), matrix(rnorm(n = n * 100), nrow = n, ncol = 100))
## calculate the confidence region
conf &lt;- simconf.mc(X, 0.2)
## Plot the region
plot(mu.x,
  type = "l", ylim = c(-10, 10),
  main = "Mean (black) and confidence region (red)"
)
lines(conf$a, col = 2)
lines(conf$b, col = 2)
</code></pre>


</div>