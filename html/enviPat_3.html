<div class="container">

<table style="width: 100%;"><tr>
<td>check_chemform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check chemical formulas</h2>

<h3>Description</h3>

<p>Checks chemical formulas (=a vector of character strings) for consistency with usage in <code>isopattern</code>; 
calculation of the molecular mass.</p>


<h3>Usage</h3>

<pre><code class="language-R">check_chemform(isotopes,chemforms,get_sorted=FALSE,get_list=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>isotopes</code></td>
<td>
<p><code>isotopes</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chemforms</code></td>
<td>
<p>Vector of character strings with chemical formulas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_sorted</code></td>
<td>
<p>Should elements in each formula be sorted according to their order in <code>isotopes</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_list</code></td>
<td>
<p>Return list with vectors of elementwise atom counts contained in each chemical formula?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Default checks if (1) a chemical formula contains only letters, numbers and square or round brackets, (2) elements can be found 
in <code>isotopes</code> and (3) letters and round brackets are all followed by a number of counts.
Where (3) are missing, they are set to 1.
</p>
<p>(2) must consist of an upper case letter, possibly followed by lower case letters; to refer to individual isotopes
(e.g., from isotope labelling of a molecule, e.g., N5 vs. [15]N2N3), square brackets may precede the capital letter.	
Any other symbols which may be part of a chemical formula (e.g., charges (+), dashes, asterisks, ...) are not permissible.
</p>
<p>The molecular mass will be calculated from isotope masses and abundances listed in <code>isotopes</code>.
</p>


<h3>Value</h3>

<p>Dataframe with 3 columns for <code>get_list=FALSE</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>warning</code></td>
<td>
<p>Correct chemical formula, <code>FALSE</code>/<code>TRUE</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_formula</code></td>
<td>
<p>Chemical formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monoisotopic_mass</code></td>
<td>
<p>Monoisotopic mass</p>
</td>
</tr>
</table>
<p>Or list containing vector of elements for <code>get_list=TRUE</code>.
</p>


<h3>Note</h3>

<p>Highly recommended for usage with <code>isopattern</code>
</p>


<h3>Author(s)</h3>

<p>Martin Loos, Christian Gerber
</p>


<h3>See Also</h3>

<p><code>isopattern</code>
<code>isotopes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Check package data set of chemical formulas #############
data(chemforms);
data(isotopes);
checked&lt;-check_chemform(isotopes,chemforms);
checked;

# Check for some senseless molecular formulas #############
chemforms&lt;-c("C900Cl4H49","O82394","C8G500Zn9","Br1","6DBr9889");
data(isotopes);
checked&lt;-check_chemform(isotopes,chemforms);
checked;

# Molecular mass with and without isotope labelling #######
chemforms&lt;-c("C10H5N4O5","[13]C2C8D2H3[15]N2N2[18]O2O3");
data(isotopes);
checked&lt;-check_chemform(isotopes,chemforms);
checked;

</code></pre>


</div>