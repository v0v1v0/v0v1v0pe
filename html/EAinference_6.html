<div class="container">

<table style="width: 100%;"><tr>
<td>PBsampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric bootstrap sampler for lasso, group lasso, scaled lasso or scaled group lasso estimator</h2>

<h3>Description</h3>

<p>Draw gaussian bootstrap or wild multiplier bootstrap samples for
lasso, group lasso, scaled lasso and scaled group lasso estimators along with their subgradients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PBsampler(X, PE_1, sig2_1, lbd_1, PE_2, sig2_2, lbd_2, weights = rep(1,
  max(group)), group = 1:ncol(X), niter = 2000, type, PEtype = "coeff",
  Btype = "gaussian", Y = NULL, parallel = FALSE, ncores = 2L,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PE_1, sig2_1, lbd_1</code></td>
<td>
<p>parameters of target distribution.
(point estimate of beta or <code>E(y)</code> depends on <code>PEtype</code>, variance estimate of error and lambda)
sig2_1 is only needed when <code>Btype = "wild"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PE_2, sig2_2, lbd_2</code></td>
<td>
<p>additional parameters of target distribution. This is required
only if mixture distribution is used. sig2_2 is only needed when <code>Btype = "wild"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weight vector with length equal to the number of groups. Default is
<code>rep(1, max(group))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p><code>p</code> x <code>1</code> vector of consecutive integers describing the group structure.
The number of groups should be the same as max(group). Default is <code>group = 1:p</code>
, where <code>p</code> is number of covariates. See examples for a guideline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>integer. The number of iterations. Default is <code>niter = 2000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of penalty. Must be specified to be one of the following:
<code>"lasso", "grlasso", "slasso"</code> or <code>"sgrlasso"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PEtype</code></td>
<td>
<p>Type of <code>PE</code> which is needed to characterize the target distribution.
Users can choose either <code>"coeff"</code> or <code>"mu"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Btype</code></td>
<td>
<p>Type of bootstrap method. Users can choose either <code>"gaussian"</code>
for gaussian bootstrap or <code>"wild"</code> for wild multiplier bootstrap. Default
is <code>"gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response vector. This is only required when <code>Btype = "wild"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. If <code>parallel = TRUE</code>, uses parallelization.
Default is <code>parallel = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>integer. The number of cores to use for parallelization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. This works only when
<code>parallel = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides bootstrap samples for lasso, group lasso,
scaled lasso or scaled group lasso estimator
and its subgradient. <br>
The sampling distribution is characterized by <code>(PE, sig2, lbd)</code>.
If <code>Btype = "gaussian"</code>, <code>error_new</code> is generated from <code>N(0, sig2)</code>.
If <code>Btype = "wild"</code>, we first generate <code>error_new</code> from <code>N(0, 1)</code>
and multiply with the residuals.
Then, if <code>PEtype = "coeff"</code>, <code>y_new</code> is generated by <code>X * PE + error_new</code>
and if <code>PEtype = "mu"</code>, <code>y_new</code> is generated by <code>PE + error_new</code>. <br>
By providing <code>(PE_2, sig2_2, lbd_2)</code>, this function simulates from a mixture distribution.
With 1/2 probability, samples will be drawn from the distribution with parameters
(PE_1, sig2_1, lbd_1) and with another 1/2 probability, they will be drawn from
the distribution with parameters (PE_2, sig2_2, lbd_2).
Four distinct penalties can be used; <code>"lasso"</code> for lasso, <code>"grlasso"</code> for group lasso,
<code>"slasso"</code> for scaled lasso and <code>"sgrlasso"</code> for scaled group lasso.
See Zhou(2014) and Zhou and Min(2017) for details.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>coefficient estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgrad</code></td>
<td>
<p>subgradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hsigma</code></td>
<td>
<p>standard deviation estimator, for type="slasso" or type="sgrlasso" only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X, PE, sig2, weights, group, type, PEtype, Btype, Y, mixture</code></td>
<td>
<p>model parameters.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhou, Q. (2014), "Monte Carlo simulation for Lasso-type problems by estimator augmentation,"
Journal of the American Statistical Association, 109, 1495-1516.
</p>
<p>Zhou, Q. and Min, S. (2017), "Estimator augmentation with applications in
high-dimensional group inference," Electronic Journal of Statistics, 11(2), 3039-3080.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
n &lt;- 10
p &lt;- 30
Niter &lt;-  10
Group &lt;- rep(1:(p/10), each = 10)
Weights &lt;- rep(1, p/10)
x &lt;- matrix(rnorm(n*p), n)
#
# Using non-mixture distribution
#
PBsampler(X = x, PE_1 = rep(0, p), sig2_1 = 1, lbd_1 = .5,
 weights = Weights, group = Group, type = "grlasso", niter = Niter, parallel = FALSE)
PBsampler(X = x, PE_1 = rep(0, p), sig2_1 = 1, lbd_1 = .5,
 weights = Weights, group = Group, type = "grlasso", niter = Niter, parallel = TRUE)
#
# Using mixture distribution
#
PBsampler(X = x, PE_1 = rep(0, p), sig2_1 = 1, lbd_1 = .5,
 PE_2 = rep(1, p), sig2_2 = 2, lbd_2 = .3, weights = Weights,
 group = Group, type = "grlasso", niter = Niter, parallel = TRUE)
</code></pre>


</div>