<div class="container">

<table style="width: 100%;"><tr>
<td>mvcontrast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate contrasts</h2>

<h3>Description</h3>

<p>This function displays tests of multivariate comparisons or contrasts.
The contrasts are constructed at each level of the variable in <code>mult.name</code>,
and then we do a multivariate test that the vector of estimates is equal to
<code>null</code> (zero by default). The <em>F</em> statistic and degrees
of freedom are determined via the Hotelling distribution. that is, if there are
<code class="reqn">m</code> error degrees of freedom and multivariate dimensionality <code class="reqn">d</code>, then
the resulting <code class="reqn">F</code> statistic has degrees of freedom <code class="reqn">(d, m - d + 1)</code>
as shown in Hotelling (1931).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvcontrast(object, method = "eff", mult.name = object@roles$multresp,
  null = 0, by = object@misc$by.vars, adjust = c("sidak",
  p.adjust.methods), show.ests = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>emmGrid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A contrast method, per <code>contrast.emmGrid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.name</code></td>
<td>
<p>Character vector of names of the factors whose levels
define the multivariate means to contrast. If the model itself has a
multivariate response, that is what is used. Otherwise, <code>mult.name</code>
<em>must</em> be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>Scalar or conformable vector of null-hypothesis values to test against</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>Any <code>by</code> variable(s). These should not include the primary
variables to be contrasted. For convenience, the <code>by</code> variable is
nulled-out if it would result in no primary factors being contrasted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>Character value of a multiplicity adjustment method
(<code>"none"</code> for no adjustment). The available adjustment methods are
more limited that in <code>contrast</code>, and any default adjustment returned
via <code>method</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.ests</code></td>
<td>
<p>Logical flag determining whether the multivariate means 
are displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>contrast</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>summary_emm</code> containing the multivariate
test results; or a list of the estimates and the tests if <code>show.ests</code>
is <code>TRUE</code>. The test results include the Hotelling <code class="reqn">T^2</code> statistic,
<code class="reqn">F</code> ratios, degrees of freedom, and <code class="reqn">P</code> values.
</p>


<h3>Note</h3>

<p>If some interactions among the primary and <code>mult.name</code> factors are
absent, the covariance of the multivariate means is singular; this situation
is accommodated, but the result has reduced degrees of freedom and a message
is displayed. If there are other abnormal conditions such as non-estimable
results, estimates are shown as <code>NA</code>.
</p>
<p>While designed primarily for testing contrasts, multivariate tests of the
mean vector itself can be implemented via <code>method = "identity")</code> (see
the examples).
</p>


<h3>References</h3>

<p>Hotelling, Harold (1931) "The generalization of Student's ratio", 
<em>Annals of Mathematical Statistics</em> 2(3), 360â€“378. doi:10.1214/aoms/1177732979
</p>


<h3>Examples</h3>

<pre><code class="language-R">MOats.lm &lt;- lm(yield ~ Variety + Block, data = MOats)
MOats.emm &lt;- emmeans(MOats.lm, ~ Variety | rep.meas)
mvcontrast(MOats.emm, "consec", show.ests = TRUE)  # mult.name defaults to rep.meas

# Test each mean against a specified null vector
mvcontrast(MOats.emm, "identity", name = "Variety", 
           null = c(80, 100, 120, 140), adjust = "none")
# (Note 'name' is passed to contrast() and overrides default name "contrast")

# 'mult.name' need not refer to a multivariate response
mvcontrast(MOats.emm, "trt.vs.ctrl1", mult.name = "Variety")

</code></pre>


</div>