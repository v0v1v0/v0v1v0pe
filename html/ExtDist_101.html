<div class="container">

<table style="width: 100%;"><tr>
<td>Normal_trunc_ab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The truncated normal distribution.</h2>

<h3>Description</h3>

<p>Density, distribution, quantile, random number 
generation and parameter estimation functions for the truncated normal distribution with parameters <code>mean</code>, <code>sd</code> and 
<code>a</code> and <code>b</code> which represent the lower and upper truncation points respectively. 
Parameter estimation can be based on a weighted or unweighted i.i.d. sample and is performed numerically.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dNormal_trunc_ab(
  x,
  mu = 0,
  sigma = 1,
  a = 0,
  b = 1,
  params = list(mu, sigma, a, b),
  ...
)

pNormal_trunc_ab(
  q,
  mu = 0,
  sigma = 1,
  a = 0,
  b = 1,
  params = list(mu = 2, sigma = 5, a = 0, b = 1),
  ...
)

qNormal_trunc_ab(
  p,
  mu = 0,
  sigma = 1,
  a = 0,
  b = 1,
  params = list(mu = 2, sigma = 5, a = 0, b = 1),
  ...
)

rNormal_trunc_ab(
  n,
  mu = 0,
  sigma = 1,
  a = 0,
  b = 1,
  params = list(mu, sigma, a, b),
  ...
)

eNormal_trunc_ab(X, w, method = "numerical.MLE", ...)

lNormal_trunc_ab(
  X,
  w,
  mu = 0,
  sigma = 1,
  a = 0,
  b = 1,
  params = list(mu, sigma, a, b),
  logL = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>A vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu, sigma</code></td>
<td>
<p>Shape parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>Boundary parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A list that includes all named parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Sample observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>An optional vector of sample weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Parameter estimation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>logical;if TRUE, lNormal_trunc_ab gives the log-likelihood, otherwise the likelihood is given.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the <code>mean</code>, <code>sd</code>, <code>a</code> or <code>b</code> are not specified they assume the default values of 0, 1, 0, 1 respectively.<br><br>
The <code>dNormal_trunc_ab()</code>, <code>pNormal_trunc_ab()</code>, <code>qNormal_trunc_ab()</code>,and <code>rNormal_trunc_ab()</code> functions serve
as wrappers of the <code>dtrunc</code>, <code>ptrunc</code>, <code>qtrunc</code>, and
<code>rtrunc</code> functions in the <span class="pkg">truncdist</span> package. They allow for the parameters to be declared not only as 
individual numerical values, but also as a list so parameter estimation can be carried out. <br><br>
The probability density function of the doubly truncated normal distribution is given by 
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \sigma^{-1} Z(x-\mu/\sigma)[\Phi(b-\mu/\sigma) - \Phi(a-\mu/\sigma)]^{-1}</code>
</p>

<p>where <code class="reqn">\infty &lt;a \le x \le b &lt; \infty</code>. The degrees of truncation are <code class="reqn">\Phi((a-\mu)/\sigma)</code> from below and <code class="reqn">1-\Phi((a-\mu)/\sigma)</code>
from above. If a is replaced by <code class="reqn">-\infty</code>, or b by <code class="reqn">\infty</code>, the distribution is singly truncated, (Johnson et.al, p.156).
The upper and lower limits of truncation <code class="reqn">a</code> and <code class="reqn">b</code> are normally known
parameters whereas <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> may be unknown. Crain (1979) discusses parameter estimation for the truncated normal 
distribution and the method of numerical maximum likelihood estimation is used for parameter estimation in <code>eNormal_trunc_ab</code>.<br><br></p>


<h3>Value</h3>

<p>dNormal_trunc_ab gives the density, pNormal_trunc_ab the distribution function,
qNormal_trunc_ab the quantile function, rNormal_trunc_ab generates random variables, and 
eNormal_trunc_ab estimates the parameters. lNormal_trunc_ab provides the log-likelihood function.
</p>


<h3>Author(s)</h3>

<p>Haizhen Wu and A. Jonathan R. Godfrey.<br>
Updates and bug fixes by Sarah Pirikahu.
</p>


<h3>References</h3>

<p>Johnson, N. L., Kotz, S. and Balakrishnan, N. (1994) Continuous Univariate Distributions,
volume 1, chapter 13, Wiley, New York.<br><br>
Crain, B.R (1979). Estimating the parameters of a truncated normal distribution, Applied Mathematics and Computation,
vol 4, pp. 149-156
</p>


<h3>See Also</h3>

<p><span class="pkg">ExtDist</span> for other standard distributions.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Parameter estimation for a distribution with known shape parameters
X &lt;- rNormal_trunc_ab(n= 500, mu= 2, sigma = 5, a = 1, b = 2)
est.par &lt;- eNormal_trunc_ab(X); est.par
plot(est.par)

#  Fitted density curve and histogram
den.x &lt;- seq(min(X),max(X),length=100)
den.y &lt;- dNormal_trunc_ab(den.x,params = est.par)
hist(X, breaks=10, probability=TRUE, ylim = c(0,1.2*max(den.y)))
lines(den.x, den.y, col="blue")
lines(density(X), lty = 2)

# Extracting boundary and shape parameters
est.par[attributes(est.par)$par.type=="boundary"]
est.par[attributes(est.par)$par.type=="shape"]

# log-likelihood function
lNormal_trunc_ab(X,param = est.par)
</code></pre>


</div>