<div class="container">

<table style="width: 100%;"><tr>
<td>meptransf2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale Two-dimensional Ensemble Patch Transforms of an Image</h2>

<h3>Description</h3>

<p>This function performs multiscale two-dimensional ensemble patch transforms of an image for a sequence of size parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">meptransf2d(x = NULL, y = NULL, z, type = "rectangle", taus, theta = 0, 
    process = c("average", "average"), pquantile = c(0, 1), equantile = c(0, 1),
    gamma = 1, boundary = "reflexive") 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of regular grid at which the values in image <code>z</code> are measured. When those are <code>NULL</code>, the image is supposed to be equally spaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>matrix of an image observed at location <code>(x, y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>patch type of <code>"rectangle"</code> or <code>"oval"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>a matrix or vector of size parameters for two-dimensional ensemble patch transform. When it is a matrix, the first and second columns specify
the horizontal and vertical sizes of a two-dimensional patch, respectively.
When it is a vector, the horizontal and vertical size of a two-dimensional patch are the same.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a degree of clockwise rotation of a patch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process</code></td>
<td>
<p>specifies transform types for patch and ensemble processes:
<code>process[1]</code> for patch process and process[2] for ensemble process.
Each process has options of <code>"average"</code>, <code>"median"</code>, or <code>"envelope"</code>.
Note that when <code>process[1]</code> is <code>"average"</code> or <code>"median"</code>, <code>process[2]</code> must be <code>"average"</code> or <code>"median"</code>. 
When <code>process[1]</code> is <code>"envelope"</code>, lower and upper envelopes are obtained by <code class="reqn">\code{pquantile[1]} \times 100 \%</code>-quantile 
and <code class="reqn">\code{pquantile[2]} \times 100 \%</code>-quantile of patches, respectively.
When <code>process[2]</code> is <code>"envelope"</code>, ensemble lower and upper envelopes are obtained as 
<code class="reqn">\code{equantile[1]} \times 100 \%</code>-quantile and <code class="reqn">\code{equantile[2]} \times 100 \%</code>-quantile  
of lower and upper envelopes of shifted patches, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pquantile</code></td>
<td>
<p>quantiles for lower and upper envelopes of patch transform. When it is <code>c(0, 1)</code>,
minimum and maximum of a patch are used for lower and upper envelopes, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equantile</code></td>
<td>
<p>quantiles for lower and upper envelopes of ensemble patch transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>controls the amount of envelope magnitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>specifies boundary condition from <code>"reflexive"</code>, <code>"periodic"</code> or <code>"none"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs multiscale two-dimensional ensemble patch transforms of an image for a sequence of size parameters <code>taus</code>, and 
produces statistics and envelopes for two-dimensional ensemble patch transform.
When <code>process[1]</code> is <code>"average"</code> or <code>"median"</code>, outputs related to envelopes are defined as <code>NULL</code>.
When <code>process[2]</code> is <code>"envelope"</code>, outputs, <code>pstat</code> and <code>Epstat</code>, are defined as <code>NULL</code>.
</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of regular grid at which the values in <code>z</code> are measured. When those are <code>NULL</code>, image is supposed to be equally spaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>matrix of an image observed at <code>(x, y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pstat</code></td>
<td>
<p>list of centrality of patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Epstat</code></td>
<td>
<p>list of centrality of ensemble patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psd</code></td>
<td>
<p>list of standard deviation of patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Epsd</code></td>
<td>
<p>list of standard deviation of ensemble patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pL</code></td>
<td>
<p>list of lower envelope of patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pU</code></td>
<td>
<p>list of upper envelope of patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pM</code></td>
<td>
<p>list of mean envelope, <code>(pL + pU) / 2</code>, of patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pR</code></td>
<td>
<p>list of distance between lower and upper envelopes, <code>(pU - pL)</code>, of patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpL</code></td>
<td>
<p>list of lower envelope of ensemble patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpU</code></td>
<td>
<p>list of upper envelope of ensemble patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpM</code></td>
<td>
<p>list of mean envelope, <code>(EpL + EpU) / 2</code>, of ensemble patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpR</code></td>
<td>
<p>list of distance between lower and upper envelopes, <code>(EpU - EpL)</code>, of ensemble patch transform for a sequence of size parameters <code>taus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>vector of correlations between <code>(z - ept)</code> component and <code>ept</code> component for a sequence of size parameters <code>taus</code>.    
The <code>ept</code> component is component obtained by ensemble patch transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>a list of input parameters of <code>type</code>, <code>taus</code>, <code>theta</code>, <code>process</code>, <code>pquantile</code>, <code>equantile</code>, <code>gamma</code>, and <code>boundary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevel</code></td>
<td>
<p>the number of size parameters <code>taus</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>eptransf2d</code>, <code>eptdecomp2d</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### example : composite of two components having different frequencies
nr &lt;- nc &lt;- 128; x &lt;- seq(0, 1, length=nr); y &lt;- seq(0, 1, length=nc)

coscomp1 &lt;- outer(cos(20 * pi * x), cos(20 * pi * y))
coscomp2 &lt;- outer(cos(5* pi * x), cos(5 * pi * y))
cosmeanf &lt;- coscomp1 + coscomp2

op &lt;- par(mfcol=c(3,1), mar=c(0,0.5,2,0.5))
image(cosmeanf, xlab="", ylab="", col=gray(0:100/100), axes=FALSE, main="a composite image")
image(coscomp1, xlab="", ylab="", col=gray(0:100/100), axes=FALSE, main="high-frequency component")
image(coscomp2, xlab="", ylab="", col=gray(0:100/100), axes=FALSE, main="low-frequency component")


#### Multiscale Ensemble Patch Transform according to tau's 
taus1 &lt;- seq(6, 12, by=2)
outcosmulti &lt;- meptransf2d(z=cosmeanf, taus=taus1)

par(mfrow=c(length(taus1), 2), mar=c(2,2,2,1))
for (i in 1:length(taus1)) {
    estlowfreq &lt;- outcosmulti$Epstat[[i]]
    image(estlowfreq, xlab="", ylab="", col=gray(0:100/100), axes=FALSE, 
        main=paste0("ensemble average of patch mean, tau=", taus1[i]))
    persp(estlowfreq, theta = -30, phi = 45, col = "white", xlab="X", ylab="Y", 
        main=paste0("ensemble average of patch mean, tau=", taus1[i]))
}

par(op)
</code></pre>


</div>