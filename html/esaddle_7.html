<div class="container">

<table style="width: 100%;"><tr>
<td>selectDecay</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tuning the Extended Empirical Saddlepoint (EES) density by cross-validation</h2>

<h3>Description</h3>

<p>Performs k-fold cross-validation to choose the EES's tuning parameter,
which determines the mixture between a consistent and a Gaussian estimator
of the Cumulant Generating Function (CGF).
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectDecay(
  decay,
  simulator,
  K,
  nrep = 1,
  normalize = FALSE,
  draw = TRUE,
  multicore = !is.null(cluster),
  cluster = NULL,
  ncores = detectCores() - 1,
  control = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>decay</code></td>
<td>
<p>Numeric vector containing the possible values of the tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulator</code></td>
<td>
<p>Function with prototype <code>function(...)</code> that will be called <code>nrep</code> times
to simulate <code>d</code>-dimensional random variables. 
Each time <code>simulator</code> is called, it will return a <code>n</code> by <code>d</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of folds to be used in cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of times the whole cross-validation procedure will be repeated, by calling
<code>simulator</code> to generate random variable and computing the cross-validation score
for every element of the <code>decay</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>if TRUE the normalizing constant of EES is normalized at each value of <code>decay</code>.
FALSE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>if <code>TRUE</code> the results of cross-validation will be plotted. <code>TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicore</code></td>
<td>
<p>if TRUE each fold will run on a different core.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>an object of class <code>c("SOCKcluster", "cluster")</code>. This allowes the user to pass her own cluster,
which will be used if <code>multicore == TRUE</code>. The user has to remember to stop the cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters, with entries:
</p>

<ul>
<li> <p><code>method</code> The method used to calculate the normalizing constant. 
Either "LAP" (laplace approximation) or "IS" (importance sampling).
</p>
</li>
<li> <p><code>tol</code> The tolerance used to assess the convergence of the solution to the saddlepoint equation.
The default is 1e-6.
</p>
</li>
<li> <p><code>nNorm</code>  Number of simulations to be used in order to estimate the normalizing constant of the saddlepoint density.
By default equal to 1e3.
</p>
</li>
<li> <p><code>ml</code>   if <code>method=="IS"</code> <code>nNorm</code>, random variables are generated from a Gaussian importance density 
with covariance matrix <code>ml*cov(X)</code>. By default the inflation factor is <code>ml=2</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments to be passed to <code>simulator</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with entries:
</p>

<ul>
<li> <p><code>negLogLik</code> A matrix <code>length{decay}</code> by <code>K*nrep</code> where the i-th row represent the negative loglikelihood
estimated for the i-th value of <code>decay</code>, while each column represents a different fold and repetition.
</p>
</li>
<li> <p><code>summary</code>  A matrix of summary results from the cross-validation procedure.  
</p>
</li>
<li> <p><code>normConst</code>  A matrix <code>length{decay}</code> by <code>nrep</code> where the i-th row contains the estimates of the normalizing constant.
</p>
</li>
</ul>
<p>The list is returned invisibly. If <code>control$draw == TRUE</code> the function will also plot the cross-validation curve.
</p>


<h3>Author(s)</h3>

<p>Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.
</p>


<h3>References</h3>

<p>Fasiolo, M., Wood, S. N., Hartig, F. and Bravington, M. V. (2016). 
An Extended Empirical Saddlepoint Approximation for Intractable Likelihoods. ArXiv http://arxiv.org/abs/1601.01849.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(esaddle)
# The data is far from normal: saddlepoint is needed and we expect 
# cross validation to be minimized at low "decay"
set.seed(4124)
selectDecay(decay = c(0.001, 0.01, 0.05, 0.1, 0.5, 1), 
            simulator = function(...) rgamma(500, 2, 1), 
            K = 5)
            
# The data is far from normal: saddlepoint is not needed and we expect 
#  the curve to be fairly flat for high "decay"
selectDecay(decay = c(0.001, 0.01, 0.05, 0.1, 0.5, 1), 
            simulator = function(...) rnorm(500, 0, 1), 
            K = 5)

</code></pre>


</div>