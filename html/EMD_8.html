<div class="container">

<table style="width: 100%;"><tr>
<td>emd2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bidimenasional Empirical Mode Decomposition</h2>

<h3>Description</h3>

<p>This function performs the bidimenasional empirical mode decomposition
utilizing extrema detection based
on the equivalence relation between neighboring pixels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">emd2d(z, x = NULL, y = NULL, tol = sd(c(z)) * 0.1^2, max.sift = 20, 
    boundary = "reflexive", boundperc = 0.3, max.imf = 5, sm = "none", 
    smlevels = 1, spar = NULL, weight = NULL, plot.imf = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>matrix of an image observed at (<code>x</code>, <code>y</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of regular grid at which the values in <code>z</code> are measured</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for stopping rule of sifting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sift</code></td>
<td>
<p>the maximum number of sifting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>specifies boundary condition from “none", “symmetric" or “reflexive".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundperc</code></td>
<td>
<p>expand an image by adding specified percentage of image at the boundary when boundary condition is 'symmetric' or 'reflexive'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.imf</code></td>
<td>
<p>the maximum number of IMF's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sm</code></td>
<td>
<p>specifies whether envelop is constructed by interpolation, thin-plate smoothing, Kriging, local polynomial smoothing, or loess. 
Use “none" for interpolation, “Tps" for thin-plate smoothing, “mKrig" for Kriging, “locfit" for local polynomial smoothing, or “loess" for loess.
See Kim et al. (2012) for detalis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smlevels</code></td>
<td>
<p>specifies which level of the IMF is obtained by smoothing other than interpolation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spar</code></td>
<td>
<p>specifies user-supplied smoothing parameter of thin-plate smoothing, Kriging, local polynomial smoothing, or loess.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.imf</code></td>
<td>
<p>specifies whether each IMF is displayed. If <code>plot.imf=TRUE</code>, click the plotting area to start the next step.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs the bidimenasional empirical mode decomposition
utilizing extrema detection based
on the equivalence relation between neighboring pixels. See Kim et al. (2012) for detalis.
</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>imf</code></td>
<td>
<p>two dimensional IMF's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residue</code></td>
<td>
<p>residue image after extracting the IMF's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxindex</code></td>
<td>
<p>index of maxima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minindex</code></td>
<td>
<p>index of minima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nimf</code></td>
<td>
<p>number of IMF's</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Huang, N. E., Shen, Z., Long, S. R., Wu, M. L. Shih, H. H.,
Zheng, Q., Yen, N. C., Tung, C. C. and Liu, H. H. (1998) The empirical
mode decomposition and Hilbert spectrum for nonlinear and
nonstationary time series analysis. <em>Proceedings of the Royal
Society London A</em>, <b>454</b>, 903–995.
</p>
<p>Kim, D., Park, M. and Oh, H.-S. (2012) Bidimensional Statistical Empirical Mode Decomposition. <em>IEEE Signal Processing Letters</em>, 
<b>19</b>, 191–194, doi: 10.1109/LSP.2012.2186566.
</p>


<h3>See Also</h3>

<p><code>extrema2dC</code>, <code>extractimf2d</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(lena)
z &lt;- lena[seq(1, 512, by=4), seq(1, 512, by=4)]
image(z, main="Lena", xlab="", ylab="", col=gray(0:100/100), axes=FALSE)

## Not run: 
lenadecom &lt;- emd2d(z, max.imf = 4)
imageEMD(z=z, emdz=lenadecom, extrema=TRUE, col=gray(0:100/100))
## End(Not run)

### Test Image
ndata &lt;- 128

x &lt;- y &lt;- seq(0, 9, length=ndata)
meanf1 &lt;- outer(sin(2 * pi * x), sin(2 * pi * y))
meanf2 &lt;- outer(sin(0.5 * pi * x), sin(0.5 * pi * y))
meanf &lt;- meanf1 + meanf2

snr &lt;- 2
set.seed(77)
zn &lt;- meanf + matrix(rnorm(ndata^2, 0, sd(c(meanf))/snr), ncol=ndata)

rangezn &lt;- range(c(meanf1, meanf2, meanf, zn))
par(mfrow=c(2,2), mar=0.1 + c(0, 0.25, 3, 0.25))
image(meanf1, main="high frequency component", xlab="", ylab="", zlim=rangezn, 
    col=gray(100:0/100), axes=FALSE)
image(meanf2, main="low frequency component", xlab="", ylab="", zlim=rangezn, 
    col=gray(100:0/100), axes=FALSE)
image(meanf, main="test image", xlab="", ylab="", zlim=rangezn, col=gray(100:0/100), axes=FALSE)
image(zn, main="noisy image", xlab="", ylab="", zlim=rangezn, col=gray(100:0/100), axes=FALSE)

## Not run: 
out &lt;- emd2d(zn, max.imf=3, sm="locfit", smlevels=1, spar=0.004125)
par(mfcol=c(3,1), mar=0.1 + c(0, 0.25, 0.25, 0.25)) 
image(out$imf[[1]], main="", xlab="", ylab="", col=gray(100:0/100), zlim=rangezn, axes=FALSE)
image(out$imf[[2]], main="", xlab="", ylab="", col=gray(100:0/100), zlim=rangezn, axes=FALSE)
image(out$imf[[3]], main="", xlab="", ylab="", col=gray(100:0/100), zlim=rangezn, axes=FALSE)
## End(Not run)
</code></pre>


</div>