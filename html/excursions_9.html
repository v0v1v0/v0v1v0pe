<div class="container">

<table style="width: 100%;"><tr>
<td>excursions.mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Excursion sets and contour credible regions using Monte Carlo samples</h2>

<h3>Description</h3>

<p><code>excursions.mc</code> is used for calculating excursion sets, contour credible
regions, and contour avoiding sets based on Monte Carlo samples of models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">excursions.mc(
  samples,
  alpha,
  u,
  type,
  rho,
  reo,
  ind,
  max.size,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Matrix with model Monte Carlo samples. Each column contains a
sample of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Error probability for the excursion set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Excursion or contour level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of region:
</p>

<dl>
<dt>'&gt;' </dt>
<dd>
<p>positive excursions</p>
</dd>
<dt>'&lt;' </dt>
<dd>
<p>negative excursions</p>
</dd>
<dt>'!=' </dt>
<dd>
<p>contour avoiding function</p>
</dd>
<dt>'=' </dt>
<dd>
<p>contour credibility function</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Marginal excursion probabilities (optional). For contour regions,
provide <code class="reqn">P(X&gt;u)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reo</code></td>
<td>
<p>Reordering (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Indices of the nodes that should be analysed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.size</code></td>
<td>
<p>Maximum number of nodes to include in the set of interest (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to TRUE for verbose mode (optional).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>excursions.mc</code> returns an object of class "excurobj" with the 
following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>E </code></td>
<td>
<p>Excursion set, contour credible region, or contour avoiding set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G </code></td>
<td>
<p> Contour map set. <code class="reqn">G=1</code> for all nodes where the <code class="reqn">mu &gt; u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M </code></td>
<td>
<p> Contour avoiding set. <code class="reqn">M=-1</code> for all non-significant nodes.
<code class="reqn">M=0</code> for nodes where the process is significantly below <code>u</code> and
<code class="reqn">M=1</code> for all nodes where the field is significantly above <code>u</code>.
Which values that should be present depends on what type of set that is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F </code></td>
<td>
<p>The excursion function corresponding to the set <code>E</code> calculated
for values up to <code>F.limit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho </code></td>
<td>
<p>Marginal excursion probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean </code></td>
<td>
<p>The mean <code>mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars </code></td>
<td>
<p>Marginal variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta </code></td>
<td>
<p>A list containing various information about the calculation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a> and Finn Lindgren
<a href="mailto:finn.lindgren@gmail.com">finn.lindgren@gmail.com</a>
</p>


<h3>References</h3>

<p>Bolin, D. and Lindgren, F. (2015) <em>Excursion and contour
uncertainty regions for latent Gaussian models</em>, JRSS-series B, vol 77, no 1,
pp 85-106.
</p>
<p>Bolin, D. and Lindgren, F. (2018), <em>Calculating Probabilistic Excursion Sets and Related Quantities Using excursions</em>, Journal of Statistical Software, vol 86, no 1, pp 1-20.
</p>


<h3>See Also</h3>

<p><code>excursions</code>, <code>excursions.inla</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create mean and a tridiagonal precision matrix
n &lt;- 101
mu.x &lt;- seq(-5, 5, length = n)
Q.x &lt;- Matrix(toeplitz(c(1, -0.1, rep(0, n - 2))))
## Sample the model 100 times (increase for better estimate)
X &lt;- mu.x + solve(chol(Q.x), matrix(rnorm(n = n * 1000), nrow = n, ncol = 1000))
## calculate the positive excursion function
res.x &lt;- excursions.mc(X, alpha = 0.05, type = "&gt;", u = 0)
## Plot the excursion function and the marginal excursion probabilities
plot(res.x$F,
  type = "l",
  main = "Excursion function (black) and marginal probabilites (red)"
)
lines(res.x$rho, col = 2)
</code></pre>


</div>