<div class="container">

<table style="width: 100%;"><tr>
<td>ehyper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Parameter of a Hypergeometric Distribution
</h2>

<h3>Description</h3>

<p>Estimate <code class="reqn">m</code>, the number of white balls in the urn, or 
<code class="reqn">m+n</code>, the total number of balls in the urn, for a 
hypergeometric distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ehyper(x, m = NULL, total = NULL, k, method = "mle")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>non-negative integer indicating the number of white balls out of a sample of 
size <code>k</code> drawn without replacement from the urn.  Missing (<code>NA</code>), 
undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not 
allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>non-negative integer indicating the number of white balls in the urn.  
You must supply <code>m</code> or <code>total</code>, but not both.  
Missing values (<code>NA</code>s) are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>

<p>positive integer indicating the total number of balls in the urn (i.e., 
<code>m+n</code>).  You must supply <code>m</code> or <code>total</code>, but not both.
Missing values (<code>NA</code>s) are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>positive integer indicating the number of balls drawn without replacement from the 
urn.  Missing values (<code>NA</code>s) are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimation.  Possible values are 
<code>"mle"</code> (maximum likelihood; the default) and <code>"mvue"</code> 
(minimum variance unbiased).  The mvue method is only available when you 
are estimating <code class="reqn">m</code> (i.e., when you supply the argument <code>total</code>).
See the DETAILS section for more information on these estimation methods. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
values are not allowed.
</p>
<p>Let <code class="reqn">x</code> be an observation from a 
hypergeometric distribution with 
parameters <code>m=</code><code class="reqn">M</code>, <code>n=</code><code class="reqn">N</code>, and <code>k=</code><code class="reqn">K</code>.  
In <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> nomenclature, <code class="reqn">x</code> represents the number of white balls drawn out of a 
sample of <code class="reqn">K</code> balls drawn <em>without</em> replacement from an urn containing 
<code class="reqn">M</code> white balls and <code class="reqn">N</code> black balls.  The total number of balls in the 
urn is thus <code class="reqn">M+N</code>.  Denote the total number of balls by <code class="reqn">T = M+N</code>.
</p>
<p><b>Estimation</b> <br></p>
<p><em>Estimating M, Given T and K are known</em> <br>
When <code class="reqn">T</code> and <code class="reqn">K</code> are known, the maximum likelihood estimator (mle) of 
<code class="reqn">M</code> is given by (Forbes et al., 2011):
</p>
<p style="text-align: center;"><code class="reqn">\hat{M}_{mle} = floor[(T + 1) x / K] \;\;\;\; (1)</code>
</p>

<p>where <code class="reqn">floor()</code> represents the <code>floor</code> function.  
That is, <code class="reqn">floor(y)</code> is the largest integer less than or equal to <code class="reqn">y</code>. 
</p>
<p>If the quantity <code class="reqn">floor[(T + 1) x / K]</code> is an integer, then the mle of 
<code class="reqn">M</code> is also given by (Johnson et al., 1992, p.263):
</p>
<p style="text-align: center;"><code class="reqn">\hat{M}_{mle} = [(T + 1) x / K] - 1 \;\;\;\; (2)</code>
</p>

<p>which is what the function <code>ehyper</code> uses for this case.
</p>
<p>The minimum variance unbiased estimator (mvue) of <code class="reqn">M</code> is given by 
(Forbes et al., 2011):
</p>
<p style="text-align: center;"><code class="reqn">\hat{M}_{mvue} = (T x / K) \;\;\;\; (3)</code>
</p>

<p><br></p>
<p><em>Estimating T, given M and K are known</em> <br>
When <code class="reqn">M</code> and <code class="reqn">K</code> are known, the maximum likelihood estimator (mle) of 
<code class="reqn">T</code> is given by (Forbes et al., 2011):
</p>
<p style="text-align: center;"><code class="reqn">\hat{T}_{mle} = floor(K M / x) \;\;\;\; (4)</code>
</p>



<h3>Value</h3>

<p>a list of class <code>"estimate"</code> containing the estimated parameters and other information.  
See <br><code>estimate.object</code> for details.
</p>


<h3>Note</h3>

<p>The hypergeometric distribution can be described by 
an urn model with <code class="reqn">M</code> white balls and <code class="reqn">N</code> black balls.  If <code class="reqn">K</code> balls 
are drawn <em>with</em> replacement, then the number of white balls in the sample 
of size <code class="reqn">K</code> follows a binomial distribution with 
parameters <code>size=</code><code class="reqn">K</code> and <code>prob=</code><code class="reqn">M/(M+N)</code>.  If <code class="reqn">K</code> balls are 
drawn <em>without</em> replacement, then the number of white balls in the sample of 
size <code class="reqn">K</code> follows a hypergeometric distribution 
with parameters <code>m=</code><code class="reqn">M</code>, <code>n=</code><code class="reqn">N</code>, and <code>k=</code><code class="reqn">K</code>.
</p>
<p>The name “hypergeometric” comes from the fact that the probabilities 
associated with this distribution can be written as successive terms in the 
expansion of a function of a Gaussian hypergeometric series.
</p>
<p>The hypergeometric distribution is applied in a variety of fields, including 
quality control and estimation of animal population size.  It is also the 
distribution used to compute probabilities for 
Fishers's exact test for a 2x2 contingency table.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).  Statistical Distributions. 
Fourth Edition. John Wiley and Sons, Hoboken, NJ.
</p>
<p>Johnson, N. L., S. Kotz, and A. Kemp. (1992).  
<em>Univariate Discrete Distributions</em>.  Second Edition. John Wiley and Sons, 
New York, Chapter 6.
</p>


<h3>See Also</h3>

<p>Hypergeometric.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate an observation from a hypergeometric distribution with 
  # parameters m=10, n=30, and k=5, then estimate the parameter m. 
  # Note: the call to set.seed simply allows you to reproduce this example. 
  # Also, the only parameter actually estimated is m; once m is estimated, 
  # n is computed by subtracting the estimated value of m (8 in this example) 
  # from the given of value of m+n (40 in this example).  The parameters 
  # n and k are shown in the output in order to provide information on 
  # all of the parameters associated with the hypergeometric distribution.

  set.seed(250) 
  dat &lt;- rhyper(nn = 1, m = 10, n = 30, k = 5) 
  dat 
  #[1] 1   

  ehyper(dat, total = 40, k = 5) 

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Hypergeometric
  #
  #Estimated Parameter(s):          m =  8
  #                                 n = 32
  #                                 k =  5
  #
  #Estimation Method:               mle for 'm'
  #
  #Data:                            dat
  #
  #Sample Size:                     1

  #----------

  # Use the same data as in the previous example, but estimate m+n instead. 
  # Note: The only parameter estimated is m+n. Once this is estimated, 
  # n is computed by subtracting the given value of m (10 in this case) 
  # from the estimated value of m+n (50 in this example).

  ehyper(dat, m = 10, k = 5)

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Hypergeometric
  #
  #Estimated Parameter(s):          m = 10
  #                                 n = 40
  #                                 k =  5
  #
  #Estimation Method:               mle for 'm+n'
  #
  #Data:                            dat
  #
  #Sample Size:                     1


  #----------

  # Clean up
  #---------
  rm(dat)
</code></pre>


</div>