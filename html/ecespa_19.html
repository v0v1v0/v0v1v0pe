<div class="container">

<table style="width: 100%;"><tr>
<td>K1K2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Differences between univariate and bivariate K-functions </h2>

<h3>Description</h3>

<p>Given two point patterns I and J, <code>K1K2</code>computes the differences between 
both univariate <code class="reqn">K</code>-functions (i.e. <code class="reqn">Ki(r)-Kj(r)</code>) as well as the differences between 
the univariate and the bivariate <code class="reqn">K</code>-function (i.e. <code class="reqn">Ki(r)-Kij(r)</code> and <code class="reqn">Kj(r)-Kij(r)</code>).
It also computes simulation envelopes to test  that that the observed differences are within the 
range expected asuming the random labelling hypothesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">K1K2(X, i, j, nsim = 99, nrank = 1, r = NULL,
	 correction = "isotropic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> Multitype marked point pattern. An object with the <code>ppp</code> format of <span class="pkg">spatstat</span>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p> Number or character string identifying the mark value of the  I pattern in X. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p> Number or character string identifying the mark value of the  J pattern in X. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p> Number of simulated point patterns to be generated when computing the envelopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrank</code></td>
<td>
<p> Integer. Rank of the envelope value amongst the <code>nsim</code> simulated values. 
A rank of 1 means that the minimum and maximum simulated values will be used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p> Numeric vector. The values of the argument <code class="reqn">r</code> at which the <code class="reqn">K(r)</code> functions  should be evaluated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p> A character item selecting any of the options "border", "bord.modif", "isotropic", "Ripley" or
"translate". It specifies the edge correction(s) to be applied. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The indiscriminate use of the raw bivariate functions (mainly the <code class="reqn">K</code> or the <code class="reqn">L</code>-bivariate functions) in ecological studies for testing the association/ repulsion
between different point patterns waste some of the most interesting properties of the <code class="reqn">K</code>-function. One of them is that under the random labelling hypothesis
every individual pattern would be a random thinning of the corresponding bivariate pattern and therefore <code class="reqn">Ki(r)=Kj(r)= Kij(r)=pi*r^2</code> (Diggle 2003). 
Dixon (2002) sugested that some differences of these functions could provide provide interesting ecological information. For example, <code class="reqn">D(r)= Ki(r)-Kj(r)</code>,
has an expected value of 0 for all <code class="reqn">r</code> distances under random labelling and evaluates the differences in the intensity of aggregation of the two point patterns
(e.g., in the example bellow, the pattern of drought and herbivory deaths). Other relevant function is <code class="reqn">D(r) = Ki(r)-Kij(r</code>) and the complementary <code class="reqn">D(r)= Kj(r)-Kij(r</code>)
which evaluate the degree of segregation of every individual pattern, i.e. if every point of the pattern is more -or less- surrounded by other points of the same type
than would be expected under the random labelling hypothesis. <code>K1K2</code> uses <code class="reqn">K^*ij(r)</code>, the combined estimator of Lotwick and Silverman (a weigthed mean of 
<code class="reqn">Kij(r)</code>  and <code class="reqn">Kji(r)</code>) as computed by <code>Kmulti.ls</code>.
</p>


<h3>Value</h3>

<p>A list with three elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>k1k2 </code></td>
<td>
<p>Difference between <code class="reqn">Ki(r)</code> and <code class="reqn">Kj(r)</code>, with simulation envelopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k1k12 </code></td>
<td>
<p>Difference between <code class="reqn">Ki(r)</code> and <code class="reqn">Kij(r)</code>, with simulation envelopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2k12 </code></td>
<td>
<p>Difference between <code class="reqn">Kj(r)</code> and <code class="reqn">Kij(r)</code>, with simulation envelopes.</p>
</td>
</tr>
</table>
<p>Each of the above elements is a <code>fv.object</code>, essentially a <code>data.frame</code> with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p>The values of the argument r at which the functions have been estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hi </code></td>
<td>
<p>Upper envelope of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D </code></td>
<td>
<p>The respective difference function <code class="reqn">D(r)</code>, i.e., respectively, <code class="reqn">Ki(r)-Kj(r)</code>,  <code class="reqn">Ki(r)-K^*ij(r)</code> or <code class="reqn">Kj(r)-K^*ij(r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lo </code></td>
<td>
<p>Lower envelope of simulations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Marcelino de la Cruz </p>


<h3>References</h3>

 
<p>De la Cruz, M. 2006. Introducción al análisis de datos mapeados o algunas de las (muchas) cosas  que puedo hacer si tengo coordenadas. <em>Ecosistemas</em>  15 (3): 19-39. 
</p>
<p>De la Cruz, M., Romao, R.L.,  Escudero, A. and Maestre, F.T. 2008. Where do seedlings go? A spatio-temporal analysis of
early mortality in a semiarid specialist. <em>Ecography</em>,31(6): 720-730. <a href="https://doi.org/10.1111/j.0906-7590.2008.05299.x">doi:10.1111/j.0906-7590.2008.05299.x</a>.
</p>
<p>Diggle, P.J. 2003. <em>Statistical analysis of spatial point patterns</em>. Arnold, London.
</p>
<p>Dixon, P. M. 2002. Ripley's K function. In <em>The encyclopedia of environmetrics</em> 
(eds. El-Shaarawi, A.H. &amp; Piergorsch, W.W.), pp. 1976-1803. John Wiley &amp; Sons Ltd, NY.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Helianthemum)

# set the number of simulations (nsim=199 or larger for real analyses)
nsim&lt;- 19

cosa12 &lt;- K1K2(Helianthemum, j="deadpl", i="survpl", r=seq(0,200,le=201),
		 nsim=nsim, correction="isotropic")

## plots of figure 9 in De la Cruz (2006) (they where made with nsim=999)
plot(cosa12$k1k2, lty=c(2, 1, 2), col=c(2, 1, 2), xlim=c(0, 200),
         main= "survival- death")

plot(cosa12$k1k12, lty=c(2, 1, 2), col=c(2, 1, 2), xlim=c(0, 200),
	 main="segregation of surviving seedlings")

plot(cosa12$k2k12, lty=c(2, 1, 2), col=c(2, 1, 2), xlim=c(0, 200),
         main= "segregation of dying seedlings", legend=FALSE)

</code></pre>


</div>