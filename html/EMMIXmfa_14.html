<div class="container">

<table style="width: 100%;"><tr>
<td>mfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Mixtures of Factor Analyzers
</h2>

<h3>Description</h3>

<p>Functions for fitting mixtures of factor analyzers (MFA) and
mixtures of <em>t</em>-factor analyzers (M<em>t</em>FA) to data.
Maximum Likelihood estimates of the model parameters are obtained
using the Alternating Expectation Conditional Maximization (AECM)
algorithm.
</p>
<p>In the case of MFA, component distributions belong to the family of
multivariate normal distributions, while with M<code class="reqn">t</code>FA
the component distributions correspond to multivariate
<em>t</em> distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mfa(Y, g, q, itmax = 500, nkmeans = 20, nrandom = 20,
  tol = 1.e-5, sigma_type = 'common', D_type = 'common', init_clust = NULL,
  init_para = NULL, conv_measure = 'diff', warn_messages = TRUE, ...)
mtfa(Y, g, q, itmax = 500, nkmeans = 20, nrandom = 20,
  tol = 1.e-5, df_init = rep(30, g), df_update = TRUE,
  sigma_type = 'common', D_type = 'common', init_clust = NULL,
  init_para = NULL, conv_measure = 'diff', warn_messages = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>A matrix or a data frame of which rows correspond to
observations and columns to variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>

<p>Number of components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>Number of factors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax</code></td>
<td>

<p>Maximum number of EM iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nkmeans</code></td>
<td>

<p>The number of times the k-means algorithm to be used in partition
the data into <code>g</code> groups. These groupings are then used in
initializing the parameters for the EM algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrandom</code></td>
<td>

<p>The number of random <code>g</code>-group partitions for the data to be used
initializing the EM algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>The EM algorithm terminates if the measure of convergence falls below
this value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_type</code></td>
<td>

<p>To specify whether the covariance matrices (for <code>mfa</code>)
or the scale matrices (for <code>mtfa</code>) of the components
are constrained 
to be the same (default, <code>sigma_type = "common"</code>)
or not (<code>sigma_type = "unique"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D_type</code></td>
<td>

<p>To specify whether the diagonal error covariance matrix is common to all
the components or not. If <code>sigma_type = "unique"</code>, then
<code>D_type</code> could either be <code>"common"</code>
(the default) to each component, or <code>"unique"</code>.
If the <code>sigma_type = "common"</code>, then
<code>D_type</code> must also be <code> "common"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_clust</code></td>
<td>

<p>A vector or matrix consisting of partition of samples to be used
in the EM algorithm. For matrix of partitions, columns must corresponds
individual partitions of the data. Optional.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_para</code></td>
<td>

<p>A list containing model parameters to be used as initial
parameter estimates for the EM algorithm. Optional.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv_measure</code></td>
<td>

<p>The default <code>'diff'</code> stops the EM iterations if
|<code class="reqn">l^{(k+1)}</code> - <code class="reqn">l^{(k)}</code>| &lt; <code>tol</code> where
<code class="reqn">l^{(k)}</code> is the log-likelihood at the <code class="reqn">k</code>th EM iteration.
If <code>'ratio'</code>, then the convergence of the EM steps is measured
using the |(<code class="reqn">l^{(k+1)}</code> - <code class="reqn">l^{(k)}</code>)/<code class="reqn">l^{(k+1)}</code>|.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_init</code></td>
<td>

<p>Initial values of the degree of freedom parameters for <code>mtfa</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_update</code></td>
<td>

<p>If <code>df_update = TRUE</code> (default), then the degree of freedom parameters
values will be updated during the EM iterations.
Otherwise, if <code>df_update = FALSE</code>, they will be fixed at the initial
values specified in <code>df_init</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn_messages</code></td>
<td>

<p>With <code>warn_messages = TRUE</code> (default), the output would
include some description of the reasons where, if any, the model fitting
function failed to provide a fit for a given set of initial
parameter values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Cluster a given data set using mixtures of factor analyzers or
approach or using mixtures of <em>t</em>-factor analyzers.
</p>


<h3>Value</h3>

<p>Object of class <code>c("emmix", "mfa")</code> or <code>c("emmix",
"mtfa")</code> containing the fitted model parameters is returned.
Details of the components are as fellows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>

<p>Number of mixture components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>Number of factors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivec</code></td>
<td>

<p>Mixing proportions of the components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>Matrix containing estimates of component means (in columns) 
of mixture component. Size <code class="reqn">p \times g</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Array containing component dependent loading matrices. Size
<code class="reqn">p \times q \times g</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>Estimates of error covariance matrices. If <code>D_type = "common"</code>
was used then <code>D</code> is <code class="reqn">p \times p</code> matrix common to
all components,  if <code>D_type = "unique"</code>, then <code>D</code> is a
size <code class="reqn">p \times p \times g</code> array.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>

<p>Degrees of freedom for each component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>

<p>Log-likelihood at the convergence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>

<p>Bayesian information criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>Matrix of posterior probabilities for the data
used based on the fitted values. Matrix of size <code>n by g</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>

<p>Vector of integers 1 to g indicating cluster allocations
of the observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uscores</code></td>
<td>

<p>Estimated conditional expected component scores of the
unobservable factors given the data and the component membership.
Size is Size <code class="reqn">n \times q \times g</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Umean</code></td>
<td>

<p>Means of the estimated conditional expected factors scores over
estimated posterior distributions. Size <code class="reqn">n \times q</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uclust</code></td>
<td>

<p>Alternative estimate of <code>Umean</code> where the posterior probabilities
for each sample are replaced by component indicator vectors
which contain one in the element corresponding to the highest posterior
probability while others zero.  Size <code class="reqn">n \times q</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ERRMSG</code></td>
<td>

<p>Description of messages, if any.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D_type</code></td>
<td>

<p>Whether common or unique error covariance is used, as specified in
model fitting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_update</code></td>
<td>

<p>Whether the degree of freedom parameter 
(<code>v</code>) was fixed or estimated (only for <code>mtfa</code>).
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Suren Rathnayake, Geoffrey McLachlan
</p>


<h3>References</h3>

<p>Ghahramani Z, and Hinton GE (1997). 
The EM algorithm for mixture of factor analyzers.
<em>Technical Report, CRG-TR-96-1</em>, University of Toronto, Toronto.
</p>
<p>McLachlan GJ, Bean RW, Ben-Tovim Jones L (2007). 
Extension of the mixture of factor analyzers model to incorporate the 
multivariate <em>t</em> distribution.
<em>Computational Statistics &amp; Data Analysis</em>, <strong>51</strong>, 5327–5338.
</p>
<p>McLachlan GJ, Baek J, and Rathnayake SI (2011). Mixtures of factor analyzers
for the analysis of high-dimensional data.
In <em>Mixture Estimation and Applications</em>,
KL Mengersen, CP Robert, and DM Titterington (Eds).
Hoboken, New Jersey: Wiley, pp. 171–191.
</p>
<p>McLachlan GJ, Peel D, and Bean RW (2003). 
Modelling high-dimensional data by mixtures of factor analyzers.
<em>Computational Statistics &amp; Data Analysis</em> <strong>41</strong>, 379–388.
</p>


<h3>See Also</h3>

<p><code>mcfa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">model &lt;- mfa(iris[, -5], g=3, q=2, itmax=200, nkmeans=1, nrandom=5)
summary(model)

model &lt;- mtfa(iris[, -5], g=3, q=2, itmax=200, nkmeans=1, nrandom=5)
  
</code></pre>


</div>