<div class="container">

<table style="width: 100%;"><tr>
<td>test.factors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the initial cumulative explained variance of factors.</h2>

<h3>Description</h3>

<p>This function performs eigenspace decomposition using the weight-transformed
matrix W to determine the explained variance with increasing number of 
factors. Depending on the number of provided weight transformation limits 
(<code>l</code>) a vector or a matrix is returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test.factors(X, l, c, r.min = 0.95, plot = FALSE, legend, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>Numeric</code> matrix, input data set with m samples (rows) 
and n variables (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p><code>Numeric</code> vector, weight tranformation limits, i.e.
quantiles; default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p><code>Numeric</code> scalar, constant sum scaling parameter, e.g.
1, 100, 1000; default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.min</code></td>
<td>
<p><code>Numeric</code> scalar, minimum value of explained variance to
be reached by the end-members included, default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>Logical</code> scalar, optional graphical output of the results,
default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p><code>Character</code> scalar, specify legend position (cf.
<code>legend</code>). If omitted, no legend will be plotted, default is no
legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the plot function. Use
<code>colour</code> instead of <code>col</code> to create different colours.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The results may be used to define a minimum number of end-members for
subsequent modelling steps, e.g. by using the Kaiser criterion, which
demands a minimum number of eigenvalues to reach a squared R of 0.95.
</p>


<h3>Value</h3>

<p><code>List</code> with objects </p>
<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Vector or matrix of cumulative
explained variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.min</code></td>
<td>
<p>Vector with number of factors that passed
r.min. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Dietze, Elisabeth Dietze
</p>


<h3>References</h3>

<p>Dietze E, Hartmann K, Diekmann B, IJmker J, Lehmkuhl F, Opitz S,
Stauch G, Wuennemann B, Borchers A. 2012. An end-member algorithm for
deciphering modern detrital processes from lake sediments of Lake Donggi
Cona, NE Tibetan Plateau, China. Sedimentary Geology 243-244: 169-180.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load example data set
data(example_X)

## create sequence of weight transformation limits
l &lt;- seq(from = 0, to = 0.2, 0.02)

## perform the test and show q.min
L &lt;- test.factors(X = X, l = l, c = 100, plot = TRUE)
L$q.min

## a visualisation with more plot parameters
L &lt;- test.factors(X = X, l = l, c = 100, plot = TRUE, 
                  ylim = c(0.5, 1), xlim = c(1, 7), 
                  legend = "bottomright", cex = 0.7)

## another visualisation, a close-up
plot(1:7, L$L[1,1:7], type = "l", 
     xlab = "q", ylab = "Explained variance")
for(i in 2:7) {lines(1:7, L$L[i,1:7], col = i)}

</code></pre>


</div>