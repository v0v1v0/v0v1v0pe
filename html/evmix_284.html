<div class="container">

<table style="width: 100%;"><tr>
<td>pickandsplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pickands Plot</h2>

<h3>Description</h3>

<p>Produces the Pickand's plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pickandsplot(data, orderlim = NULL, tlim = NULL, y.alpha = FALSE,
  alpha = 0.05, ylim = NULL, legend.loc = "topright",
  try.thresh = quantile(data, 0.9, na.rm = TRUE),
  main = "Pickand's Plot", xlab = "order", ylab = ifelse(y.alpha,
  " tail index - alpha", "shape  - xi"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>vector of sample data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderlim</code></td>
<td>
<p>vector of (lower, upper) limits of order statistics
to plot estimator, or <code>NULL</code> to use default values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>vector of (lower, upper) limits of range of threshold
to plot estimator, or <code>NULL</code> to use default values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.alpha</code></td>
<td>
<p>logical, should shape xi (<code>FALSE</code>) or tail index alpha (<code>TRUE</code>) be given on y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level over range (0, 1), or <code>NULL</code> for no CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-axis limits or <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.loc</code></td>
<td>
<p>location of legend (see <code>legend</code>) or <code>NULL</code> for no legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try.thresh</code></td>
<td>
<p>vector of thresholds to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the plotting functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces the Pickand's plot including confidence intervals.
</p>
<p>For an ordered iid sequence <code class="reqn">X_{(1)}\ge X_{(2)}\ge\cdots\ge X_{(n)}</code> 
the Pickand's estimator of the reciprocal of the shape parameter <code class="reqn">\xi</code> 
at the <code class="reqn">k</code>th order statistic is given by 
</p>
<p style="text-align: center;"><code class="reqn">\hat{\xi}_{k,n}=\frac{1}{\log(2)} \log\left(\frac{X_{(k)}-X_{(2k)}}{X_{(2k)}-X_{(4k)}}\right).</code>
</p>

<p>Unlike the Hill estimator it does not assume positive data, is valid for any <code class="reqn">\xi</code> and
is location and scale invariant.
The Pickands estimator is defined on orders <code class="reqn">k=1, \ldots, \lfloor n/4\rfloor</code>. 
</p>
<p>Once a sufficiently low order statistic is reached the Pickand's estimator will
be constant, upto sample uncertainty, for regularly varying tails. Pickand's
plot is a plot of </p>
<p style="text-align: center;"><code class="reqn">\hat{\xi}_{k,n}</code>
</p>
<p> against the <code class="reqn">k</code>. Symmetric asymptotic
normal confidence intervals assuming Pareto tails are provided.
</p>
<p>The Pickand's estimator is for the GPD shape <code class="reqn">\xi</code>, or the reciprocal of the
tail index <code class="reqn">\alpha=1/\xi</code>. The shape is plotted by default using
<code>y.alpha=FALSE</code> and the tail index is plotted when <code>y.alpha=TRUE</code>.
</p>
<p>A pre-chosen threshold (or more than one) can be given in
<code>try.thresh</code>. The estimated parameter (<code class="reqn">\xi</code> or <code class="reqn">\alpha</code>) at
each threshold are plot by a horizontal solid line for all higher thresholds. 
The threshold should be set as low as possible, so a dashed line is shown
below the pre-chosen threshold. If Pickand's estimator is similar to the
dashed line then a lower threshold may be chosen.
</p>
<p>If no order statistic (or threshold) limits are provided 
<code>orderlim = tlim = NULL</code> then the lowest order statistic is set to <code class="reqn">X_{(1)}</code> and
highest possible value <code class="reqn">X_{\lfloor n/4\rfloor}</code>. However, Pickand's estimator is always
output for all <code class="reqn">k=1, \ldots, \lfloor n/4\rfloor</code>.
</p>
<p>The missing (<code>NA</code> and <code>NaN</code>) and non-finite values are ignored.
</p>
<p>The lower x-axis is the order <code class="reqn">k</code>. The upper axis is for the corresponding threshold.
</p>


<h3>Value</h3>

<p><code>pickandsplot</code> gives Pickand's plot. It also 
returns a dataframe containing columns of the order statistics, order, Pickand's
estimator, it's standard devation and <code class="reqn">100(1 - \alpha)\%</code> confidence
interval (when requested).
</p>


<h3>Acknowledgments</h3>

<p>Thanks to Younes Mouatasim, Risk Dynamics, Brussels for reporting various bugs in these functions.
</p>


<h3>Note</h3>

<p>Asymptotic Wald type CI's are estimated for non-<code>NULL</code> signficance level <code>alpha</code>
for the shape parameter, assuming exactly GPD tails. When plotting on the tail index scale,
then a simple reciprocal transform of the CI is applied which may well be sub-optimal.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p>Pickands III, J.. (1975). Statistical inference using extreme order statistics. Annal of Statistics 3(1), 119-131.
</p>
<p>Dekkers A. and de Haan, S. (1989). On the estimation of the extreme-value index and large quantile estimation.
Annals of Statistics 17(4), 1795-1832.
</p>
<p>Resnick, S. (2007). Heavy-Tail Phenomena - Probabilistic and Statistical Modeling. Springer.
</p>


<h3>See Also</h3>

<p><code>pickands</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
par(mfrow = c(2, 1))

# Reproduce graphs from Figure 4.7 of Resnick (2007)
data(danish, package="evir")

# Pickand's plot
pickandsplot(danish, orderlim=c(1, 150), ylim=c(-0.1, 2.2),
 try.thresh=c(), alpha=NULL, legend.loc=NULL)
 
# Using default settings
pickandsplot(danish)

## End(Not run)
</code></pre>


</div>