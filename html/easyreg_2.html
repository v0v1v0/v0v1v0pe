<div class="container">

<table style="width: 100%;"><tr>
<td>bl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Analysis of broken line regression
</h2>

<h3>Description</h3>

<p>The function performs analysis of broken line regression 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bl(data, model=1, alpha=0.05, xlab = "Explanatory Variable", ylab = "Response Variable", 
    position = 1, digits = 6, mean = TRUE, sd=FALSE, legend = TRUE, lty=2, 
col="dark blue", pch=20, xlim="default.x",ylim="default.y", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data is a data.frame
The first column contain the treatments (explanatory variable) and the 
second column the response variable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>model for analysis: 1=two linear; 2=linear plateau (LRP); 3= model 1 with blocks random; 4 = model 2 with blocks random
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>significant level for cofidence intervals (parameters estimated)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>name of explanatory variable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>name of response variable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>

<p>position of equation in the graph
</p>
<p>top=1
</p>
<p>bottomright=2
</p>
<p>bottom=3
</p>
<p>bottomleft=4
</p>
<p>left=5
</p>
<p>topleft=6 (default)
</p>
<p>topright=7
</p>
<p>right=8
</p>
<p>center=9
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>number of digits (default=6)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>

<p>mean=TRUE (plot mean of data)
mean=FALSE (plot all data)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>

<p>sd=FALSE (plot without standard deviation)
sd=TRUE (plot with standard deviation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>

<p>legend=TRUE (plot legend)
legend=FALSE (not plot legend)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>line type
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>line color
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>point type
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>limits for x
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>limits for y
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>others graphical parameters (see par)
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns coefficients of the models, t test for coefficients, knot (break point), R squared, adjusted R squared, AIC, BIC, residuals and shapiro-wilk test for residuals.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Arnhold &lt;emmanuelarnhold@yahoo.com.br&gt;
</p>


<h3>References</h3>

<p>KAPS, M. and LAMBERSON, W. R. Biostatistics for Animal Science: an introductory text. 2nd Edition. CABI Publishing, Wallingford, Oxfordshire, UK, 2009. 504p.
</p>


<h3>See Also</h3>

<p>lm, ea1(easyanova package), er1
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# the growth of Zagorje turkeys (Kaps and Lamberson, 2009)

weight=c(44,66,100,150,265,370,455,605)
age=c(1,7,14,21,28,35,42,49)

data2=data.frame(age,weight)

# two linear
regplot(data2, model=5, start=c(25,6,10,20))

bl(data2, digits=2)


#linear and quadratic plateau
x=c(0,1,2,3,4,5,6)
y=c(1,2,3,6.1,5.9,6,6.1)

data=data.frame(x,y)

bl(data,model=2, lty=1, col=1, digits=2, position=8)


# effect os blocks
x=c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8)
y=c(4,12,9,20,16,25,21,31,28,42,33,46,33,46,34,44)
blocks=rep(c(1,2),8)

dat=data.frame(x,blocks,y)

bl(dat, 3)

bl(dat,4, sd=TRUE)

bl(dat,4, mean=FALSE)


</code></pre>


</div>