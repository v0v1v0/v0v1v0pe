<div class="container">

<table style="width: 100%;"><tr>
<td>Multiscale Quantiles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Quantile of the multiscale statistics
</h2>

<h3>Description</h3>

<p>Simulate quantiles of the multiscale statistics under any continuous distribution function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msQuantile(n, alpha = c(0.5), nsim = 5e3, is.sim = (n &lt; 1e4), 
            intv = genIntv(n), mode = c("Con", "Gen"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>significance level; default as 0.5, see also <code>essHistogram</code>. Like <code>quantile</code>, it can also be a vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>numer of Monte Carlo simulations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.sim</code></td>
<td>

<p>logical. If <code>TRUE</code> (default if <code>n</code> &lt; 10,000) the quantile is determined via Monte Carlo simulations, which might take a long time; otherwise (default if <code>n</code> &gt;= 10,000) it uses the quantile with <code>n</code> = 10,000, which has been precomputed and stored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intv</code></td>
<td>

<p>a data frame provides the system of intervals on which the multiscale statistic is defined. The data frame constains the following two columns   
</p>
<p><code>left</code> left index of an interval
</p>
<p><code>right</code> right index of an interval
</p>
<p>By default, it is set to the sparse interval system proposed by Rivera and Walther (2013), see <code>genIntv</code> and also Li et al. (2016).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>

<p><code>"Con"</code> for continuous distribution functions (default)
</p>
<p><code>"Gen"</code> for general (possibly with discontinuous) distribution functions
</p>
<p>See Li et al. (2016) for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments passed to function <code>quantile</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Empirically, it turns out that the quantile of the multiscale statistic converges fast to that of the limit distribution as the number of observations <code>n</code> increases. Thus, for the sake of computational efficiency, the quantile with <code>n</code> = 10,000 are used by default for that with <code>n</code> &gt; 10,000, which has already been precomputed and stored. Of course, for arbitrary sample size <code>n</code>, one can always simulate the quantile by setting  <code>is.sim = TRUE</code>, and use the precomputed value by setting <code>is.sim = FALSE</code>. For a given sample size <code>n</code>, simulations are once computed, and then automatically recorded in the R memory for later usage. For memory efficiency, only the last simulation is stored.  
</p>


<h3>Value</h3>

<p>A vector of length <code>length(alpha)</code> is returned, the same structure as returned by funtion <code>quantile</code> with option <code>names = FALSE</code>; The values are the (1-<code>alpha</code>)-quantile(s) of the null distribution of the multiscale statistic via Monte Carlo simulation, corresponding to (1-<code>alpha</code>)-confidence level(s). See Li et al. (2016) for further details.
</p>


<h3>Note</h3>

<p>All the printing messages can be disabled by calling <code>suppressMessages</code>.
</p>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216.
</p>
<p>Rivera, C., &amp; Walther, G. (2013). Optimal detection of a jump in the intensity of a Poisson process or in a density with likelihood ratio statistics. Scand. J. Stat. 40, 752â€“769.
</p>


<h3>See Also</h3>

<p><code>checkHistogram</code>,
<code>essHistogram</code>,
<code>genIntv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n    = 100 # number of observations
nsim = 100 # number of simulations

alpha = c(0.1, 0.9) # significance level
q     = msQuantile(n, alpha, nsim)

print(q)
</code></pre>


</div>