<div class="container">

<table style="width: 100%;"><tr>
<td>el2.test.wtm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes maximum-likelihood probability jumps for multiple mean-type hypotheses, based on two independent 
uncensored samples
</h2>

<h3>Description</h3>

<p>This function computes the maximum-likelihood probability jumps for multiple mean-type hypotheses, based on two samples
that are independent, uncensored, and weighted.  The target function for the maximization is the (Lagrangian)
constrained
log(empirical likelihood) which can be expressed as,
</p>
<p style="text-align: center;"><code class="reqn">
\sum_{dx_i=1} wx_i \log{\mu_i} + \sum_{dy_j=1} wy_j \log{\nu_j} - \eta ( 1 -\sum_{dx_i=1} \mu_i )
 - \delta ( 1 -\sum_{dy_j=1} \nu_j ) - \lambda ( \mu^T H_1 \nu, \ldots , \mu^T H_p \nu )^T </code>
</p>

<p>where the variables are defined as follows:
</p>
<p><code class="reqn">x</code> is a vector of uncensored data for the first sample
</p>
<p><code class="reqn">y</code> is a vector of uncensored data for the second sample
</p>
<p><code class="reqn">wx</code> is a vector of estimated weights for the first sample
</p>
<p><code class="reqn">wy</code> is a vector of estimated weights for the second sample
</p>
<p><code class="reqn">\mu</code> is a vector of estimated probability jumps for the first sample
</p>
<p><code class="reqn">\nu</code> is a vector of estimated probability jumps for the second sample
</p>
<p><code class="reqn">H_k = [ g_k(x_i, y_j) - mean_k ], k=1, \ldots , p</code>, where <code class="reqn">g_k(x,y)</code> is a user-chosen function
</p>
<p><code class="reqn">H = [H_1, ... , H_p]</code> (used as argument in <code>el.cen.EMm</code> function, which calls <code>el2.test.wtm</code>)
</p>
<p><code class="reqn">mean</code> is a vector of length <code class="reqn">p</code> of hypothesized means, such that <code class="reqn">mean_k</code> is the 
hypothesized value of <code class="reqn">E(g_k(x,y))</code>
</p>
<p><code class="reqn">E</code> indicates “expected value”
</p>


<h3>Usage</h3>

<pre><code class="language-R">el2.test.wtm(xd1,yd1,wxd1new, wyd1new, muvec, nuvec, Hu, Hmu, Hnu, p, mean, maxit=35)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xd1</code></td>
<td>
<p>a vector of uncensored data for the first sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yd1</code></td>
<td>
<p>a vector of uncensored data for the second sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wxd1new</code></td>
<td>
<p>a vector of estimated weights for <code>xd1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wyd1new</code></td>
<td>
<p>a vector of estimated weights for <code>yd1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muvec</code></td>
<td>
<p>a vector of estimated probability jumps for <code>xd1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuvec</code></td>
<td>
<p>a vector of estimated probability jumps for <code>yd1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hu</code></td>
<td>
<p><code class="reqn">H_u = [ H_1 - [mean_1], \ldots , H_p - [mean_p] ], dx_i=1, dy_j=1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hmu</code></td>
<td>
<p>a matrix, whose calculation is shown in the example below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hnu</code></td>
<td>
<p>a matrix, whose calculation is shown in the example below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a vector of hypothesized values of <code class="reqn">E(g_k(u,v)), k=1, \ldots,p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>a positive integer used to control the maximum number of iterations in the Newton-Raphson
algorithm; default is 35</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is called by <code>el2.cen.EMm</code>.  It is listed here because the user may find it useful elsewhere.
</p>
<p>The value of <code class="reqn">mean_k</code> should be chosen between the maximum and minimum values of <code class="reqn">g_k(xd1_i,yd1_j)</code>;
otherwise there may be no distributions for <code class="reqn">xd1</code> and <code class="reqn">yd1</code> that will satisfy the the mean-type hypothesis.  If
<code class="reqn">mean_k</code> is inside this interval, but the convergence is still not satisfactory, then the value of 
<code class="reqn">mean_k</code> should be moved  closer to the NPMLE for <code class="reqn">E(g(xd1,yd1))</code>.  (The NPMLE itself should always 
be a feasible value for <code class="reqn">mean_k</code>.)  The calculations for this function are derived in Owen (2001).
</p>


<h3>Value</h3>

<p><code>el2.test.wtm</code> returns a list of values as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>constmat</code></td>
<td>
<p>a matrix of row vectors, where the <code class="reqn">k</code>th row vector holds successive values of
<code class="reqn">\mu^T H_k \nu , k=1, \ldots, p</code>, generated by the Newton-Raphson algorith
m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>the vector of Lagrangian mulipliers used in the calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muvec1</code></td>
<td>
<p>the vector of probability jumps for the first sample that maximize the weighted empirical likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuvec1</code></td>
<td>
<p>the vector of probability jumps for the second sample that maximize the weighted empirical likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the vector of hypothesized means</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>William H. Barton &lt;bbarton@lexmark.com&gt;
</p>


<h3>References</h3>

<p>Owen, A.B. (2001). <code>Empirical Likelihood</code>. Chapman and Hall/CRC, Boca Raton, pp.223-227.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
#Ho1: P(X&gt;Y) = 0.5
#Ho2: P(X&gt;1060) = 0.5
#g1(x) = I[x &gt; y]
#g2(y) = I[x &gt; 1060]

mean&lt;-c(0.5,0.5)
p&lt;-2

xd1&lt;-c(10,85,209,273,279,324,391,566,852,881,895,954,1101,1393,1669,1823,1941)
nx1=length(xd1)
yd1&lt;-c(21,38,39,51,77,185,524,610,612,677,798,899,946,1010,1074,1147,1154,1329,1484,1602,1952)
ny1=length(yd1)

wxd1new&lt;-c(2.267983, 1.123600, 1.121683, 1.121683, 1.121683, 1.121683, 1.121683,
 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.261740, 2.912753,
 2.912753, 2.912753)
muvec&lt;-c(0.08835785, 0.04075290, 0.04012084, 0.04012084, 0.04012084, 0.04012084,
 0.04012084, 0.03538020, 0.03389263, 0.03389263, 0.03389263, 0.03322693, 0.04901516,
 0.05902008, 0.13065491, 0.13065491, 0.13065491)

wyd1new&lt;-c(1.431653, 1.431653, 1.431653, 1.431653, 1.431653, 1.438453, 1.079955, 1.080832,
 1.080832, 1.080832, 1.080832, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000,
 1.222883, 1.227865, 1.739636, 5.809616)
nuvec&lt;-c(0.04249966, 0.04249966, 0.04249966, 0.04249966, 0.04249966, 0.04316922, 0.03425722,
 0.03463312, 0.03463312, 0.03463312, 0.03463312, 0.03300598, 0.03300598, 0.03333333,
 0.03333333, 0.03382827, 0.03382827, 0.04136800, 0.04229270, 0.05992020, 0.22762676)


H1u&lt;-matrix(NA,nrow=nx1,ncol=ny1)
H2u&lt;-matrix(NA,nrow=nx1,ncol=ny1)
for (i in 1:nx1) {
   for (j in 1:ny1) {
        H1u[i,j]&lt;-(xd1[i]&gt;yd1[j])
        H2u[i,j]&lt;-(xd1[i]&gt;1060) } }
Hu=matrix(c(H1u,H2u),nrow=nx1,ncol=p*ny1)
for (k in 1:p) {
     M1 &lt;- matrix(mean[k], nrow=nx1, ncol=ny1)
     Hu[,((k-1)*ny1+1):(k*ny1)] &lt;- Hu[,((k-1)*ny1+1):(k*ny1)] - M1}
Hmu &lt;- matrix(NA,nrow=p, ncol=ny1*nx1)
Hnu &lt;- matrix(NA,nrow=p, ncol=ny1*nx1) 
for (i in 1:p) {
   for (k in 1:nx1) {
        Hmu[i, ((k-1)*ny1+1):(k*ny1)] &lt;-  Hu[k,((i-1)*ny1+1):(i*ny1)] } }
for (i in 1:p) {
   for (k in 1:ny1) {
        Hnu[i,((k-1)*nx1+1):(k*nx1)] &lt;- Hu[(1:nx1),(i-1)*ny1+k]} }

el2.test.wtm(xd1,yd1,wxd1new, wyd1new, muvec, nuvec, Hu, Hmu,
  Hnu, p, mean, maxit=10)

#muvec1
# [1] 0.08835789 0.04075290 0.04012083 0.04012083 0.04012083 0.04012083 0.04012083
# [8] 0.03538021 0.03389264 0.03389264 0.03389264 0.03322693 0.04901513 0.05902002
# [15] 0.13065495 0.13065495 0.13065495

#nuvec1
# [1] 0.04249967 0.04249967 0.04249967 0.04249967 0.04249967 0.04316920 0.03425722
# [8] 0.03463310 0.03463310 0.03463310 0.03463310 0.03300597 0.03300597 0.03333333
# [15] 0.03333333 0.03382827 0.03382827 0.04136801 0.04229269 0.05992018 0.22762677

#  $lam
#        [,1]      [,2]
#  [1,] 8.9549 -10.29119
</code></pre>


</div>