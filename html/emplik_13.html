<div class="container">

<table style="width: 100%;"><tr>
<td>el.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical likelihood ratio test for the means, uncensored data</h2>

<h3>Description</h3>

<p>Compute the empirical likelihood ratio with the
mean vector fixed at mu.
</p>
<p>The log empirical likelihood been maximized is
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{i=1}^n \log \Delta F(x_i).</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">el.test(x, mu, lam, maxit=25, gradtol=1e-7, 
                 svdtol = 1e-9, itertrace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or vector containing the data, one row
per observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a numeric vector (of length <code> = ncol(x)</code>)
to be tested as the mean vector of <code>x</code>
above, as <code class="reqn">H_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>an optional vector of length <code> = length(mu)</code>,
the starting value of Lagrange
multipliers, will use <code class="reqn">0</code> if missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer to control iteration when solve
constrained maximization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>an optional real value for convergence test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svdtol</code></td>
<td>
<p>an optional real value to detect singularity while
solve equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itertrace</code></td>
<td>
<p>a logical value. If the iteration history 
needs to be printed out.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>mu</code> is in the interior of the convex hull of the
observations <code>x</code>, then <code>wts</code> should sum to <code>n</code>. 
If <code>mu</code> is outside
the convex hull then <code>wts</code> should sum to nearly zero, and 
<code>-2LLR</code>
will be a large positive number.  It should be infinity,
but for inferential purposes a very large number is
essentially equivalent.  If mu is on the boundary of the convex
hull then <code>wts</code> should sum to nearly k where k is the number of
observations within that face of the convex hull which contains mu.
</p>
<p>When <code>mu</code> is interior to the convex hull, it is typical for
the algorithm to converge quadratically to the solution, perhaps
after a few iterations of searching to get near the solution.
When <code>mu</code> is outside or near the boundary of the convex hull, then
the solution involves a <code>lambda</code> of infinite norm.  The algorithm
tends to nearly double <code>lambda</code> at each iteration and the gradient
size then decreases roughly by half at each iteration.
</p>
<p>The goal in writing the algorithm was to have it “fail gracefully"
when <code>mu</code> is not inside the convex hull.  The user can 
either leave <code>-2LLR</code> “large and positive" or can replace
it by infinity when the weights do not sum to nearly n.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>-2LLR</code></td>
<td>
<p>the -2 loglikelihood ratio; approximate chisq distribution
under <code class="reqn">H_o</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval</code></td>
<td>
<p>the observed P-value by chi-square approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the final value of Lagrange multiplier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad</code></td>
<td>
<p>the gradient at the maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>the Hessian matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>weights on the observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nits</code></td>
<td>
<p>number of iteration performed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Original Splus code by Art Owen. Adapted to R by Mai Zhou. </p>


<h3>References</h3>

<p>Owen, A. (1990). Empirical likelihood ratio confidence regions. 
<em>Ann. Statist.</em> <b>18</b>, 90-120.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- matrix(c(rnorm(50,mean=1), rnorm(50,mean=2)), ncol=2,nrow=50)
el.test(x, mu=c(1,2))
## Suppose now we wish to test Ho: 2mu(1)-mu(2)=0, then
y &lt;- 2*x[,1]-x[,2]
el.test(y, mu=0)
xx &lt;- c(28,-44,29,30,26,27,22,23,33,16,24,29,24,40,21,31,34,-2,25,19)
el.test(xx, mu=15)  #### -2LLR = 1.805702
</code></pre>


</div>