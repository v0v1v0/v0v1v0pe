<div class="container">

<table style="width: 100%;"><tr>
<td>plot.RETRA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot representative trajectories of Ecological Dynamic Regimes</h2>

<h3>Description</h3>

<p>Plot representative trajectories of an Ecological Dynamic Regime (EDR) in the
state space distinguishing between the segments belonging to real trajectories
of the EDR and the artificial links between segments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'RETRA'
plot(
  x,
  d,
  trajectories,
  states,
  select_RT = NULL,
  traj.colors = NULL,
  RT.colors = NULL,
  sel.color = NULL,
  link.color = NULL,
  link.lty = 2,
  axes = c(1, 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>RETRA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Symmetric matrix or <code>dist</code> object containing the dissimilarities
between each pair of states of all trajectories in the EDR or data frame
containing the coordinates of all trajectory states in an ordination space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trajectories</code></td>
<td>
<p>Vector indicating the trajectory or site to which each
state in <code>d</code> belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>Vector of integers indicating the order of the states in <code>d</code> for
each trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_RT</code></td>
<td>
<p>Optional string indicating the name of a representative
trajectory that must be highlighted in the plot. By default (<code>select_RT</code> = <code>NULL</code>),
all representative trajectories are represented with the same color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traj.colors</code></td>
<td>
<p>Specification for the color of all individual trajectories
(defaults "grey") or a vector with length equal to the number of trajectories
indicating the color for each individual trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RT.colors</code></td>
<td>
<p>Specification for the color of representative trajectories
(defaults "black").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.color</code></td>
<td>
<p>Specification for the color of the selected representative
trajectory (defaults "red"). Only if <code>!is.null(select_RT)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.color</code></td>
<td>
<p>Specification for the color of the links between trajectory
segments forming representative trajectories. By default, the same color than
<code>RT.colors</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.lty</code></td>
<td>
<p>The line type of the links between trajectory segments forming
representative trajectories. Defaults 2 = "dashed" (See graphics::par).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>An integer vector indicating the pair of axes in the ordination
space to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments for generic <code>plot()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function <code>plot()</code> plots a set of individual trajectories and the
representative trajectories in an ordination space defined through <code>d</code> or
calculated by applying metric multidimensional scaling (mMDS; Borg and Groenen,
2005) to <code>d</code>.
</p>


<h3>Author(s)</h3>

<p>Martina Sánchez-Pinillos
</p>


<h3>References</h3>

<p>Borg, I., &amp; Groenen, P. J. F. (2005). Modern Multidimensional Scaling (2nd ed.).
Springer.
</p>
<p>Sánchez-Pinillos, M., Kéfi, S., De Cáceres, M., Dakos, V. 2023. Ecological Dynamic
Regimes: Identification, characterization, and comparison. <em>Ecological Monographs</em>.
<a href="doi:10.1002/ecm.1589">doi:10.1002/ecm.1589</a>
</p>


<h3>See Also</h3>

<p><code>retra_edr()</code> for identifying representative trajectories in EDRs applying
RETRA-EDR.
</p>
<p><code>define_retra()</code> for defining representative trajectories from a subset of
segments or trajectory features.
</p>
<p><code>summary()</code> for summarizing representative trajectories in EDRs.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 -----------------------------------------------------------------

# d contains the dissimilarities between trajectory states
d &lt;- EDR_data$EDR1$state_dissim

# trajectories and states are defined according to `d` entries.
trajectories &lt;- EDR_data$EDR1$abundance$traj
states &lt;- EDR_data$EDR1$abundance$state

# x defined from retra_edr(). We obtain three representative trajectories.
RT &lt;- retra_edr(d = d, trajectories = trajectories, states = states, minSegs = 5)
summary(RT)

# Plot individual trajectories in blue and representative trajectories in orange,
# "T2" will be displayed in green. Artificial links will be displayed with a
# dotted line.
plot(x = RT, d = d, trajectories = trajectories, states = states, select_RT = "T2",
     traj.colors = "lightblue", RT.colors = "orange", sel.color = "darkgreen",
     link.lty = 3, main = "Representative trajectories in EDR1")

# Example 2 -----------------------------------------------------------------

# d contains the coordinates in an ordination space. For example, we use
# the coordinates of the trajectory states after applying a principal component
# analysis (PCA) to an abundance matrix.
abun &lt;- EDR_data$EDR1$abundance
pca &lt;- prcomp(abun[, -c(1:3)])
coord &lt;- data.frame(pca$x)

# trajectories and states are defined according to the abundance matrix
# used in the PCA
trajectories &lt;- EDR_data$EDR1$abundance$traj
states &lt;- EDR_data$EDR1$abundance$state

# Instead of using the representative trajectories obtained from `retra_edr()`,
# we will define the set of trajectories that we want to highlight. For example,
# we can select the trajectories whose initial and final states are in the
# extremes of the first axis.
T1 &lt;- trajectories[which.max(coord[, 1])]
T2 &lt;- trajectories[which.min(coord[, 1])]
RT_traj &lt;- c(trajectories[trajectories %in% T1],
             trajectories[trajectories %in% T2])
RT_states &lt;- c(states[which(trajectories %in% T1)],
               states[which(trajectories %in% T2)])

# Create a data frame to generate a RETRA object using define_retra
RT_df &lt;- data.frame(RT = c(rep("T1", sum(trajectories %in% T1)),
                           rep("T2", sum(trajectories %in% T2))),
                 RT_traj = RT_traj,
                 RT_states = as.integer(RT_states))
RT_retra &lt;- define_retra(data = RT_df)

# Plot the defined trajectories with the default graphic values
plot(x = RT_retra, d = coord, trajectories = trajectories, states = states,
     main = "Extreme trajectories in EDR1")

</code></pre>


</div>