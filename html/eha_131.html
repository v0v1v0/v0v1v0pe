<div class="container">

<table style="width: 100%;"><tr>
<td>wfunk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Loglihood function of a Weibull regression</h2>

<h3>Description</h3>

<p>Calculates minus the log likelihood function and its first and second order
derivatives for data from a Weibull regression model. Is called by
<code>weibreg</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wfunk(
  beta = NULL,
  lambda,
  p,
  X = NULL,
  Y,
  offset = rep(0, length(Y)),
  ord = 2,
  pfixed = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The scale paramater</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design (covariate) matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The response, a survival object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Offset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>ord = 0 means only loglihood, 1 means score vector as well, 2
loglihood, score and hessian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfixed</code></td>
<td>
<p>Logical, if TRUE the shape parameter is regarded as a known
constant in the calculations, meaning that it is not cosidered in the
partial derivatives.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the function returns log likelihood, score vector and minus
hessian, i.e. the observed information. The model is 
</p>
<p style="text-align: center;"><code class="reqn">h(t; p, \lambda,\beta, z) = p / \lambda (t / \lambda)^{(p-1)}\exp{(-( t / \lambda)^p})\exp(z\beta)</code>
</p>
<p> This is in correspondence with <code>dweibull</code>.
</p>


<h3>Value</h3>

<p>A list with components </p>
<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>The log likelihood. Present if
<code>ord &gt;= 0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fp</code></td>
<td>
<p>The score vector. Present if <code>ord &gt;= 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpp</code></td>
<td>
<p>The negative of the hessian. Present if <code>ord &gt;= 2</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Göran Broström
</p>


<h3>See Also</h3>

<p><code>weibreg</code>
</p>


</div>