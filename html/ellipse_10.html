<div class="container">

<table style="width: 100%;"><tr>
<td>ellipse.profile.glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pairwise profile sketch	for GLM profiles
</h2>

<h3>Description</h3>

<p>This routine approximates a pairwise confidence region for a <code>glm</code>
model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'profile.glm'
ellipse(x, which = c(1, 2), level = 0.95, t, 
    npoints = 100, dispersion, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of class <code>profile.glm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>Which pair of parameters to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>The <code>level</code> argument
specifies the confidence level for an asymptotic confidence region.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>

<p>The square root of the value to be contoured.  By default, this is <code>qchisq(level, 2)</code>
for models with fixed dispersion (i.e. binomial and Poisson), and <code>2 * qf(level, 2, df)</code> for other models,
where <code>df</code> is the residual degrees of freedom.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>

<p>How many points to use in the ellipse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>

<p>If specified, fixed dispersion is assumed, otherwise the dispersion is taken from the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Extra parameters which are not used (for compatibility with the generic).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the 4 point approximation to the contour as described
in Appendix 6 of Bates and Watts (1988).  It produces the exact contour for
quadratic surfaces, and good approximations for mild deviations from
quadratic.  If the surface is multimodal, the algorithm is likely to
produce nonsense.
</p>


<h3>Value</h3>

<p>An <code>npoints</code> x <code>2</code> matrix with columns having the chosen parameter names, 
which approximates a contour of the function that was profiled.
</p>


<h3>References</h3>

<p>Bates and Watts (1988). Nonlinear Regression Analysis and Its Applications. Wiley. <a href="https://doi.org/10.1002/9780470316757">doi:10.1002/9780470316757</a>.
</p>


<h3>See Also</h3>

<p><code>profile</code>, <code>glm</code>, <code>ellipse.glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## MASS has a pairs.profile function that conflicts with ours, so
## do a little trickery here
	 noMASS &lt;- is.na(match('package:MASS', search()))
	 if (noMASS) require(MASS)

## Dobson (1990) Page 93: Randomized Controlled Trial :

     counts &lt;- c(18,17,15,20,10,20,25,13,12)
     outcome &lt;- gl(3,1,9)
     treatment &lt;- gl(3,3)
     glm.D93 &lt;- glm(counts ~ outcome + treatment, family=poisson())

##  Plot an approximate 95% confidence region for the two outcome variables
     prof.D93 &lt;- profile(glm.D93)
     plot(ellipse(prof.D93, which = 2:3), type = 'l')
     lines(ellipse(glm.D93, which = 2:3), lty = 2)
     params &lt;- glm.D93$coefficients
     points(params[2],params[3])
     
##  Clean up our trickery
	 if (noMASS) detach('package:MASS')
	 
</code></pre>


</div>