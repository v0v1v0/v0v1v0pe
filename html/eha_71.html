<div class="container">

<table style="width: 100%;"><tr>
<td>phreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric Proportional Hazards Regression</h2>

<h3>Description</h3>

<p>Proportional hazards model with parametric baseline hazard(s).  Allows for
stratification with different scale and shape in each stratum, and left
truncated and right censored data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phreg(
  formula = formula(data),
  data = parent.frame(),
  na.action = getOption("na.action"),
  dist = "weibull",
  cuts = NULL,
  init,
  shape = 0,
  param = c("canonical", "rate"),
  control = list(eps = 1e-08, maxiter = 20, trace = FALSE),
  singular.ok = TRUE,
  model = FALSE,
  x = FALSE,
  y = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~
operator, and the terms on the right.  The response must be a survival
object as returned by the Surv function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the
formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a missing-data filter function, applied to the model.frame,
after any subset argument has been used.  Default is
<code>options()$na.action</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Which distribution? Default is "weibull", with the alternatives
"ev" (Extreme value), "gompertz", "pch" (piecewise constant hazards
function), "loglogistic" and "lognormal". A special case like the
<code>exponential</code> can be obtained by choosing "weibull" in combination with
<code>shape = 1</code>, or "pch" without <code>cuts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>
<p>Only used with <code>dist = "pch"</code>. Specifies the points in time
where the hazard function jumps. If omitted, an exponential model is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>vector of initial values of the iteration.  Default initial
value is zero for all variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>If positive, the shape parameter is fixed at that value (in
each stratum).  If zero or negative, the shape parameter is estimated.  If
more than one stratum is present in data, each stratum gets its own
estimate. Only relevant for the Weibull and Extreme Value distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Applies only to the Gompertz distribution: "canonical" is
defined in the description of the <code>Gompertz</code> distribution;
"rate" transforms <code>scale</code> to 1/log(scale), giving the same
parametrization as in Stata and SAS. The latter thus allows for a negative
rate, or a "cure" (Gompertz) model. The default is "canonical"; if this
results in extremely large scale and/or shape estimates, consider trying
"rate".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with components <code>eps</code> (convergence criterion),
<code>maxiter</code> (maximum number of iterations), and <code>silent</code> (logical,
controlling amount of output).  You can change any component without mention
the other(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Return the design matrix in the model object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Return the response in the model object?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameterization is the same as in <code>coxreg</code> and
<code>coxph</code>, but different from the one used by
<code>survreg</code> (which is not a proportional hazards
modelling function). The model is </p>
<p style="text-align: center;"><code class="reqn">S(t; a, b, \beta, z) =
S_0((t/b)^a)^{\exp((z-mean(z))\beta)}</code>
</p>
<p> where S0 is some standardized survivor
function.
</p>


<h3>Value</h3>

<p>A list of class <code>c("phreg", "coxreg")</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Fitted parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>
<p>Cut points for
the "pch" distribution. <code>NULL</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazards</code></td>
<td>
<p>The estimated
constant levels in the case of the "pch" distribution. <code>NULL</code>
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Covariance matrix of the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Vector of length two; first component is the value at the
initial parameter values, the second componet is the maximized value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>The score test statistic (at the initial value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>The estimated linear predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>Means of the columns of the design matrix, except those columns
corresponding to a factor level. Otherwise all
zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.means</code></td>
<td>
<p>Weighted (against exposure time) means of covariates;
weighted relative frequencies of levels of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of
spells in indata (possibly after removal of cases with NA's).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.events</code></td>
<td>
<p>Number of events in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>Used by extractor functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign</code></td>
<td>
<p>Used by extractor functions.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>wald.test</code></td>
<td>
<p>The Wald test statistic (at the initial value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The Surv vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isF</code></td>
<td>
<p>Logical vector indicating the
covariates that are factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>The covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ttr</code></td>
<td>
<p>Total Time at Risk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>List of levels of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The calling formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Did the optimization
converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p>Did the optimization fail? (Is <code>NULL</code> if not).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfixed</code></td>
<td>
<p>TRUE if shape was fixed in the estimation.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>The lognormal and loglogistic distributions are included
on an experimental basis for the moment. Use with care, results may be
unreliable!
</p>
<p>The gompertz distribution has an exponentially increasing hazard function
under the canonical parametrization. This may cause instability in the
convergence of the fitting algorithm in the case of near-exponential data.
It may be resolved by using <code>param = "rate"</code>.
</p>


<h3>Note</h3>

<p>The lognormal and loglogistic baseline distributions are extended to a
three-parameter family by adding a "proportionality" parameter (multiplying
the baseline hazard function). The log of the estimated parameter turns up
as '(Intercept)' in the printed output. The reason for this extension is
that the standard lognormal and loglogistic distributions are not closed
under proportional hazards.
</p>


<h3>Author(s)</h3>

<p>Göran Broström
</p>


<h3>See Also</h3>

<p><code>coxreg</code>, <code>check.dist</code>,
<code>link{aftreg}</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mort)
fit &lt;- phreg(Surv(enter, exit, event) ~ ses, data = mort)
fit
plot(fit)
fit.cr &lt;- coxreg(Surv(enter, exit, event) ~ ses, data = mort)
check.dist(fit.cr, fit)

</code></pre>


</div>