<div class="container">

<table style="width: 100%;"><tr>
<td>mmd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Naive computation for Maximum Mean Discrepancy</h2>

<h3>Description</h3>

<p>Computes maximum mean discrepancy statistics with Laplacian
or Gaussian kernel.
Suitable for multivariate data. Naive approach, quadratic in number
of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmd(
  X,
  Y,
  beta = -0.1,
  pval = TRUE,
  kernel = c("Laplacian", "Gaussian"),
  numperm = 200,
  seednum = 0,
  alternative = c("greater", "two.sided"),
  allowzeropval = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix (or vector) of observations in first sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix (or vector) of observations in second sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>kernel parameter. Must be positive; if not, computes
median heuristic in quadratic time. Default value
is <code>-0.1</code>, which will force median heuristic to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Boolean for whether to compute p-value or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>String, either <code>"Laplacian"</code> or <code>"Gaussian"</code>.
Default is <code>"Laplacian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numperm</code></td>
<td>
<p>Number of permutations. Default is <code>200</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seednum</code></td>
<td>
<p>Seed number for generating permutations. Default is <code>0</code>,
which means seed is set randomly. For values larger than
<code>0</code>, results will be reproducible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis,
which must be either <code>"greater"</code> (default) or
<code>"two.sided"</code>. In Gretton et al., the
MMD test statistic is specified so that if it is
significantly larger than zero, then the null hypothesis
that the two samples come from the same distribution
should be rejected. For this reason, <code>"greater"</code>
is recommended. The test will still work
in many cases with <code>"two.sided"</code> specified, but this
could lead to problems in certain cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowzeropval</code></td>
<td>
<p>A boolean, specifying whether we will allow zero
p-values or not. Default is <code>FALSE</code>; then
a threshold of <code>0.5 / (numperm+1)</code> is used,
and if the computed p-value is less than this
threshold, it is then set to be this value.
this avoids the possibility of zero p-values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First checks number of columns (dimension) are equal.
Suppose matrix <code class="reqn">X</code> has <code class="reqn">n</code> rows and <code class="reqn">d</code> columns,
and matrix <code class="reqn">Y</code> has <code class="reqn">m</code> rows; checks that <code class="reqn">Y</code>
has <code class="reqn">d</code> columns (if not, then throws error).
Then flattens matrices to vectors (or, if <code class="reqn">d=1</code>, they are
already vectors.
Then calls C++ method. If the first sample has <code class="reqn">n</code>
<code class="reqn">d</code>-dimensional samples and the second sample has
<code class="reqn">m</code> <code class="reqn">d</code>-dimensional samples, then the algorithm
computes the statistic in <code class="reqn">O((n+m)^2)</code> time.
</p>
<p>Median difference is as follows:
</p>
<p style="text-align: center;"><code class="reqn"> m = \textnormal{median} \{ || x_i - x_j ||_1; \,\, i&gt;j, \,\, 
        i=1, 2,\dots, n+m,\,\,\textnormal{ and } j=1, 2,\dots, i-1 \}, </code>
</p>

<p>where <code class="reqn"> || x_i - x_j ||_1</code> is the 1-norm, and so if the data
are <code class="reqn">d</code>-dimensional then
</p>
<p style="text-align: center;"><code class="reqn"> || x_i - x_j ||_1 = \sum_{k=1}^{d} |x_{i,k} - x_{j,k}|, </code>
</p>

<p>and finally median heuristic is <code>beta = 1/m</code>.
This can be computed in <code class="reqn">O( (n+m)^2 )</code> time.
</p>
<p>The Laplacian kernel <code class="reqn">k</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn"> k(x,y) = \exp( -\beta || x_i - x_j ||_1 ). </code>
</p>

<p>Random seed is set for <code>std::mt19937</code> and <code>std::shuffle</code> in C++.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<dl>
<dt><code>pval</code></dt>
<dd>
<p>The p-value of the test, if it is
computed (<code>pval=TRUE</code>). </p>
</dd>
<dt><code>stat</code></dt>
<dd>
<p>The statistic of the test, which
is always computed. </p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>The kernel parameter used in the test.
If <code>beta</code> was not initialised or
negative, this will be the median heuristic
value.</p>
</dd>
</dl>
<h3>References</h3>

<p>Gretton, A., Borgwardt, K. M., Rasch M. J., Sch√∂lkopf, B. and Smola, A.
(2012) "A kernel two-sample test." The Journal of Machine Learning Research
13, no. 1, 723-773.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
X &lt;- matrix(c(1:12), ncol=2, byrow=TRUE)
Y &lt;- matrix(c(13:20), ncol=2, byrow=TRUE)
mmdList &lt;- mmd(X=X, Y=Y, beta=0.1, pval=FALSE)

#using median heuristic
mmdList &lt;- mmd(X=X, Y=Y, pval=FALSE)

#using median heuristic and computing p-value
mmdList &lt;- mmd(X=X, Y=Y)

#using median heuristic and computing p-value
#using 1000 permutations and seed 1 for reproducibility.
mmdList &lt;- mmd(X=X, Y=Y, numperm=1000, seednum=1)


</code></pre>


</div>