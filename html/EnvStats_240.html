<div class="container">

<table style="width: 100%;"><tr>
<td>ezmlnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Parameters of a Zero-Modified Lognormal (Delta) Distribution
</h2>

<h3>Description</h3>

<p>Estimate the parameters of a 
zero-modified lognormal distribution or a 
zero-modified lognormal distribution (alternative parameterization), 
and optionally construct a confidence interval for the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ezmlnorm(x, method = "mvue", ci = FALSE, ci.type = "two-sided", 
    ci.method = "normal.approx", conf.level = 0.95)

  ezmlnormAlt(x, method = "mvue", ci = FALSE, ci.type = "two-sided", 
    ci.method = "normal.approx", conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), 
and infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimation.  The only possible value is 
<code>"mvue"</code> (minimum variance unbiased; the default).  See the DETAILS section for 
more information on this estimation method. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the 
mean.  The default value is <code>FALSE</code>.  If <code>ci=TRUE</code> and there are less 
than three non-missing observations in <code>x</code>, or if all observations are 
zeros, a warning will be issued and no confidence interval will be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>

<p>character string indicating what kind of confidence interval to compute.  The 
possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>character string indicating what method to use to construct the confidence 
interval for the mean.  The only possible value is <code>"normal.approx"</code> 
(the default).  See the DETAILS section for more information. 
This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.  
The default value is <code>conf.level=0.95</code>. This argument is ignored if 
<code>ci=FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or 
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to 
performing the estimation.
</p>
<p>Let <code class="reqn">\underline{x} = (x_1, x_2, \ldots, x_n)</code> be a vector of 
<code class="reqn">n</code> observations from a 
zero-modified lognormal distribution with 
parameters <code>meanlog=</code><code class="reqn">\mu</code>, <code>sdlog=</code><code class="reqn">\sigma</code>, and 
<code>p.zero=</code><code class="reqn">p</code>.  Alternatively, let 
<code class="reqn">\underline{x} = (x_1, x_2, \ldots, x_n)</code> be a vector of 
<code class="reqn">n</code> observations from a 
zero-modified lognormal distribution 
(alternative parameterization) with parameters <code>mean=</code><code class="reqn">\theta</code>, 
<code>cv=</code><code class="reqn">\tau</code>, and <code>p.zero=</code><code class="reqn">p</code>.
</p>
<p>Let <code class="reqn">r</code> denote the number of observations in <code class="reqn">\underline{x}</code> that are equal 
to 0, and order the observations so that <code class="reqn">x_1, x_2, \ldots, x_r</code> denote 
the <code class="reqn">r</code> zero observations and <code class="reqn">x_{r+1}, x_{r+2}, \ldots, x_n</code> denote 
the <code class="reqn">n-r</code> non-zero observations.
</p>
<p>Note that <code class="reqn">\theta</code> is <em>not</em> the mean of the zero-modified lognormal 
distribution; it is the mean of the lognormal part of the distribution.  Similarly, 
<code class="reqn">\tau</code> is <em>not</em> the coefficient of variation of the zero-modified 
lognormal distribution; it is the coefficient of variation of the lognormal 
part of the distribution.
</p>
<p>Let <code class="reqn">\gamma</code>, <code class="reqn">\delta</code>, and <code class="reqn">\phi</code> denote the mean, standard deviation, 
and coefficient of variation of the overall zero-modified lognormal (delta) 
distribution.  Let <code class="reqn">\eta</code> denote the standard deviation of the lognormal 
part of the distribution, so that <code class="reqn">\eta = \theta \tau</code>.  Aitchison (1955) 
shows that:
</p>
<p style="text-align: center;"><code class="reqn">\gamma = (1 - p) \theta  \;\;\;\; (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">\delta^2 = (1 - p) \eta^2 + p (1 - p) \theta^2 \;\;\;\; (2)</code>
</p>

<p>so that
</p>
<p style="text-align: center;"><code class="reqn">\phi = \frac{\delta}{\gamma} = \frac{\sqrt{\tau^2 + p}}{\sqrt{1-p}} \;\;\;\; (3)</code>
</p>

<p><br></p>
<p><b>Estimation</b> <br></p>
<p><em>Minimum Variance Unbiased Estimation</em> (<code>method="mvue"</code>) <br>
Aitchison (1955) shows that the minimum variance unbiased estimators (mvue's) of 
<code class="reqn">\gamma</code> and <code class="reqn">\delta</code> are:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{\gamma}_{mvue} =</code> </td>
<td style="text-align: left;"> <code class="reqn">(1-\frac{r}{n}) e^{\bar{y}} g_{n-r-1}(\frac{s^2}{2})</code> </td>
<td style="text-align: left;"> if <code class="reqn">r &lt; n - 1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                </td>
<td style="text-align: left;"> <code class="reqn">x_n / n</code> </td>
<td style="text-align: left;"> if <code class="reqn">r = n - 1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> if <code class="reqn">r = n \;\;\;\; (4)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{\delta}^2_{mvue} =</code> </td>
<td style="text-align: left;"> <code class="reqn">(1-\frac{r}{n}) e^{2\bar{y}} \{g_{n-r-1}(2s^2) - \frac{n-r-1}{n-1} g_{n-r-1}[\frac{(n-r-2)s^2}{n-r-1}] \} </code> </td>
<td style="text-align: left;"> if <code class="reqn">r &lt; n - 1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                  </td>
<td style="text-align: left;"> <code class="reqn">x_n^2 / n</code> </td>
<td style="text-align: left;"> if <code class="reqn">r = n - 1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                  </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> if <code class="reqn">r = n \;\;\;\; (5)</code>
  </td>
</tr>
</table>
<p>where 
</p>
<p style="text-align: center;"><code class="reqn">y_i = log(x_i), \; r = r+1, r+2, \ldots, n \;\;\;\; (6)</code>
</p>

<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{n-r} \sum_{i=r+1}^n y_i \;\;\;\; (7)</code>
</p>

<p style="text-align: center;"><code class="reqn">s^2 = \frac{1}{n-r-1} \sum_{i=r+1}^n (y_i - \bar{y})^2 \;\;\;\; (8)</code>
</p>

<p style="text-align: center;"><code class="reqn">g_m(z) = \sum_{i=0}^\infty \frac{m^i (m+2i)}{m(m+2) \cdots (m+2i)} (\frac{m}{m+1})^i (\frac{z^i}{i!}) \;\;\;\; (9)</code>
</p>

<p>Note that when <code class="reqn">r=n-1</code> or <code class="reqn">r=n</code>, the estimator of <code class="reqn">\gamma</code> is simply the 
sample mean for all observations (including zero values), and the estimator for 
<code class="reqn">\delta^2</code> is simply the sample variance for all observations.
</p>
<p>The expected value and asymptotic variance of the mvue of <code class="reqn">\gamma</code> are 
(Aitchison and Brown, 1957, p.99; Owen and DeRouen, 1980):
</p>
<p style="text-align: center;"><code class="reqn">E(\hat{\gamma}_{mvue}) = \gamma \;\;\;\; (10)</code>
</p>

<p style="text-align: center;"><code class="reqn">AVar(\hat{\gamma}_{mvue}) = \frac{1}{n} exp(2\mu + \sigma^2) (1-p) (p + \frac{2\sigma^2 + \sigma^4}{2}) \;\;\;\; (11)</code>
</p>

<p><br></p>
<p><b>Confidence Intervals</b> <br></p>
<p><em>Based on Normal Approximation</em> (<code>ci.method="normal.approx"</code>) <br>
An approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\gamma</code> is 
constructed based on the assumption that the estimator of <code class="reqn">\gamma</code> is 
approximately normally distributed.  Thus, an approximate two-sided 
<code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\gamma</code> is constructed as:
</p>
<p style="text-align: center;"><code class="reqn">[ \hat{\gamma}_{mvue} - t_{n-2, 1-\alpha/2} \hat{\sigma}_{\hat{\gamma}}, \; \hat{\gamma}_{mvue} + t_{n-2, 1-\alpha/2} \hat{\sigma}_{\hat{\gamma}} ] \;\;\;\; (12)</code>
</p>

<p>where <code class="reqn">t_{\nu, p}</code> is the <code class="reqn">p</code>'th quantile of 
Student's t-distribution with <code class="reqn">\nu</code> degrees of freedom, and 
the quantity <code class="reqn">\hat{\sigma}_{\hat{\gamma}}</code> is the estimated standard deviation 
of the mvue of <code class="reqn">\gamma</code>, and is computed by replacing the values of 
<code class="reqn">\mu</code>, <code class="reqn">\sigma</code>, and <code class="reqn">p</code> in equation (11) above with their estimated 
values and taking the square root.
</p>
<p>Note that there must be at least 3 non-missing observations (<code class="reqn">n \ge 3</code>) and 
at least one observation must be non-zero (<code class="reqn">r \le n-1</code>) in order to construct 
a confidence interval.
</p>
<p>One-sided confidence intervals are computed in a similar fashion.
</p>


<h3>Value</h3>

<p>a list of class <code>"estimate"</code> containing the estimated parameters and other information.  
See <br><code>estimate.object</code> for details.
</p>
<p>For the function <code>ezmlnorm</code>, the component called <code>parameters</code> is a 
numeric vector with the following estimated parameters: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <b>Parameter Name</b> </td>
<td style="text-align: left;"> <b>Explanation</b> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>meanlog</code> </td>
<td style="text-align: left;"> mean of the log of the lognormal part of the distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sdlog</code>   </td>
<td style="text-align: left;"> standard deviation of the log of the lognormal part of the distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>p.zero</code>  </td>
<td style="text-align: left;"> probability that an observation will be 0. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mean.zmlnorm</code> </td>
<td style="text-align: left;"> mean of the overall zero-modified lognormal (delta) distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sd.zmlnorm</code> </td>
<td style="text-align: left;"> standard deviation of the overall zero-modified lognormal (delta) distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>For the function <code>ezmlnormAlt</code>, the component called <code>parameters</code> is a 
numeric vector with the following estimated parameters: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <b>Parameter Name</b> </td>
<td style="text-align: left;"> <b>Explanation</b> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mean</code> </td>
<td style="text-align: left;"> mean of the lognormal part of the distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>cv</code>   </td>
<td style="text-align: left;"> coefficient of variation of the lognormal part of the distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>p.zero</code>  </td>
<td style="text-align: left;"> probability that an observation will be 0. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mean.zmlnorm</code> </td>
<td style="text-align: left;"> mean of the overall zero-modified lognormal (delta) distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sd.zmlnorm</code> </td>
<td style="text-align: left;"> standard deviation of the overall zero-modified lognormal (delta) distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>Note</h3>

<p>The zero-modified lognormal (delta) distribution is sometimes used to 
model chemical concentrations for which some observations are reported as 
“Below Detection Limit” (the nondetects are assumed equal to 0).  
See, for example, Gilliom and Helsel (1986), Owen and DeRouen (1980), and 
Gibbons et al. (2009, Chapter 12).  USEPA (2009, Chapter 15) recommends this 
strategy only in specific situations, and Helsel (2012, Chapter 1) strongly 
discourages this approach to dealing with non-detects.
</p>
<p>A variation of the zero-modified lognormal (delta) distribution is the 
zero-modified normal distribution, in which a 
normal distribution is mixed with a positive probability mass at 0. 
</p>
<p>One way to try to assess whether a zero-modified lognormal (delta), 
zero-modified normal, censored normal, or censored lognormal is the best 
model for the data is to construct both censored and detects-only probability 
plots (see <code>qqPlotCensored</code>).
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Aitchison, J. (1955).  On the Distribution of a Positive Random Variable Having 
a Discrete Probability Mass at the Origin.  <em>Journal of the American 
Statistical Association</em> <b>50</b>, 901–908.
</p>
<p>Aitchison, J., and J.A.C. Brown (1957).  <em>The Lognormal Distribution 
(with special reference to its uses in economics)</em>.  Cambridge University Press, 
London. pp.94-99.
</p>
<p>Crow, E.L., and K. Shimizu. (1988).  <em>Lognormal Distributions: 
Theory and Applications</em>.  Marcel Dekker, New York, pp.47–51.
</p>
<p>Gibbons, RD., D.K. Bhaumik, and S. Aryal. (2009).  <em>Statistical Methods 
for Groundwater Monitoring</em>.  Second Edition.  John Wiley and Sons, Hoboken, NJ.
</p>
<p>Gilliom, R.J., and D.R. Helsel. (1986).  Estimation of Distributional Parameters 
for Censored Trace Level Water Quality Data: 1. Estimation Techniques.  
<em>Water Resources Research</em> <b>22</b>, 135–146.
</p>
<p>Helsel, D.R. (2012).  <em>Statistics for Censored Environmental Data Using 
Minitab and R</em>.  Second Edition.  John Wiley and Sons, Hoboken, NJ, Chapter 1.
</p>
<p>Johnson, N. L., S. Kotz, and A.W. Kemp. (1992).  <em>Univariate Discrete Distributions</em>. 
Second Edition. John Wiley and Sons, New York, p.312.
</p>
<p>Owen, W., and T. DeRouen. (1980).  Estimation of the Mean for Lognormal Data 
Containing Zeros and Left-Censored Values, with Applications to the Measurement 
of Worker Exposure to Air Contaminants.  <em>Biometrics</em> <b>36</b>, 707–719.
</p>
<p>USEPA (1992c).  <em>Statistical Analysis of Ground-Water Monitoring Data at 
RCRA Facilities: Addendum to Interim Final Guidance</em>.  Office of Solid Waste, 
Permits and State Programs Division, US Environmental Protection Agency, 
Washington, D.C.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
U.S. Environmental Protection Agency, Washington, D.C.
</p>


<h3>See Also</h3>

<p>Zero-Modified Lognormal, 
Zero-Modified Normal, Lognormal.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 100 observations from a zero-modified lognormal (delta) 
  # distribution with mean=2, cv=1, and p.zero=0.5, then estimate the 
  # parameters. According to equations (1) and (3) above, the overall mean 
  # is mean.zmlnorm=1 and the overall cv is cv.zmlnorm=sqrt(3). 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  dat &lt;- rzmlnormAlt(100, mean = 2, cv = 1, p.zero = 0.5) 
  ezmlnormAlt(dat, ci = TRUE) 

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Zero-Modified Lognormal (Delta)
  #
  #Estimated Parameter(s):          mean         = 1.9604561
  #                                 cv           = 0.9169411
  #                                 p.zero       = 0.4500000
  #                                 mean.zmlnorm = 1.0782508
  #                                 cv.zmlnorm   = 1.5307175
  #
  #Estimation Method:               mvue
  #
  #Data:                            dat
  #
  #Sample Size:                     100
  #
  #Confidence Interval for:         mean.zmlnorm
  #
  #Confidence Interval Method:      Normal Approximation
  #                                 (t Distribution)
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             LCL = 0.748134
  #                                 UCL = 1.408368

  #----------

  # Clean up
  rm(dat)
</code></pre>


</div>