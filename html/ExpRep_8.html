<div class="container">

<table style="width: 100%;"><tr>
<td>S_Integral_Theorem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulations of the Integral Theorem of DeMoivre-Laplace.
</h2>

<h3>Description</h3>

<p>Given n Bernoulli experiments with success probability p, this function calculates and plots the exact probability and the approximate probability that a successful event occurs between linf+i (0&lt;=i&lt;=lsup-linf-1) and lsup times. It also calculates the difference between these probabilities and shows all the computations in a table. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">S_Integral_Theorem(n = 200, p = 0.5, linf = 0, lsup = 100, Compare = TRUE, 
     Table = TRUE, Graph = TRUE, GraphE = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer vector with the numbers of repetitions of the Bernoulli experiment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A real value with the probability that a successful event will happen in any single Bernoulli experiment (called the probability of success).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linf</code></td>
<td>
<p>An integer vector, of the same length than n, with the minimum numbers of times that the successful event should happen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lsup</code></td>
<td>
<p>An integer vector, of the same length than n, with the maximum numbers of times that the successful event should happen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Compare</code></td>
<td>
<p>A logical value, if TRUE the function calculates both the exact probability and the approximate probability that a successful event occurs and compares these probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Table</code></td>
<td>
<p>A logical value, if TRUE the function shows a table with the carried out computations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph</code></td>
<td>
<p>A logical value, if TRUE the function plots both the exact probability and the approximate probability that a successful event occurs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GraphE</code></td>
<td>
<p>A logical value, if TRUE the function shows the graphic of the errors in the approximation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bernoulli experiments are sequences of events, in which successive experiments are independent and at each experiment the probability of appearance of a "successful" event (p) remains constant. It is necessary that linf &lt; lsup.
</p>


<h3>Value</h3>

<p>A graph and/or a table.
</p>


<h3>Note</h3>

<p>Department of Mathematics. University of Oriente. Cuba.
</p>


<h3>Author(s)</h3>

<p>Larisa Zamora and Jorge Diaz
</p>


<h3>References</h3>

<p>Gnedenko, B. V. (1978). The Theory of Probability. Mir Publishers. Moscow.
</p>


<h3>See Also</h3>

<p>Integral_Theorem, Local_Theorem.
</p>


<h3>Examples</h3>

<pre><code class="language-R">S_Integral_Theorem (n = 200, p = 0.5, linf = 0, lsup = 100, Compare = TRUE, Table = TRUE, 
    Graph = TRUE, GraphE = TRUE) 

## The function is currently defined as
function (n = 200, p = 0.5, linf = 0, lsup = 100, Compare = TRUE, 
    Table = TRUE, Graph = TRUE, GraphE = TRUE) 
  { Integral_Theorem &lt;- function(n = 100, p = 0.5, linf = 0, 
        lsup = 50) {
        A &lt;- (linf - n * p)/sqrt(n * p * (1 - p))
        B &lt;- (lsup - n * p)/sqrt(n * p * (1 - p))
        P &lt;- pnorm(B) - pnorm(A)
        return(P)
    }
    layout(matrix(1))
    PNormal &lt;- numeric()
    Dif &lt;- numeric()
    PBin &lt;- numeric()
    k &lt;- lsup - linf - 1
    PNormal[1] &lt;- Integral_Theorem(n, p, linf, lsup)
    PBin[1] &lt;- 0
    for (j in linf:lsup) PBin[1] &lt;- PBin[1] + dbinom(j, n, p)
    Dif[1] &lt;- abs(PBin[1] - PNormal[1])
    for (i in 1:k) {
        linf_i &lt;- linf + i
        PNormal[i + 1] &lt;- Integral_Theorem(n, p, linf_i, lsup)
        if (Compare == TRUE) {
            PBin[i + 1] &lt;- 0
            for (j in linf_i:lsup) PBin[i + 1] &lt;- PBin[i + 1] + 
                dbinom(j, n, p)
            Dif[i + 1] &lt;- abs(PBin[i + 1] - PNormal[i + 1])
        }
    }
    if (Graph == TRUE &amp; GraphE == TRUE) {
        layout(matrix(c(1, 1, 2, 2), 2, 2, byrow = TRUE))
    }
    if (Graph == TRUE) {
        ymini &lt;- min(PNormal[k + 1], PBin[k + 1]) - 0.05
        ymaxi &lt;- max(PNormal[1], PBin[1]) + 0.05
        mfg &lt;- c(1, 1, 2, 2)
        plot(PNormal, ylim = c(ymini, ymaxi), type = "l", main = "The Integral Limit Theorem", 
            xlab = "k (linf&lt;=k&lt;=lsup)", ylab = "Probability", 
            col = "red")
        mtext("Integral Theorem", line = -1, side = 1, adj = 1, 
            col = "red")
        if (Compare == TRUE) {
            points(PBin, type = "p", col = "blue")
            mtext("Binomial Probability", line = -2, side = 1, 
                adj = 1, col = "blue")
        }
    }
    if (GraphE == TRUE) {
        mfg &lt;- c(2, 1, 2, 2)
        dmini &lt;- min(Dif) - 0.01
        dmaxi &lt;- max(Dif) + 0.01
        plot(Dif, ylim = c(dmini, dmaxi), type = "b", main = "Errors", 
            xlab = "m", ylab = "Errors", col = "green")
        abline(a = 0, b = 0, col = "red")
    }
    if (Table == TRUE) {
        Ak &lt;- array(1:(k + 1))
        if (Compare == TRUE) 
            TablaR &lt;- data.frame(k = Ak, PBinomial = PBin, T_Integral = PNormal, 
                Difference = Dif)
        else TablaR &lt;- data.frame(K = Ak, T_Integral = PNormal)
        TablaR
    }
  }
</code></pre>


</div>