<div class="container">

<table style="width: 100%;"><tr>
<td>clusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify Clusters of Exceedences</h2>

<h3>Description</h3>

<p>Identify clusters of exceedences. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">clusters(data, u, r = 1, ulow = -Inf, rlow = 1, cmax = FALSE, keep.names
    = TRUE, plot = FALSE, xdata = seq(along = data), lvals = TRUE, lty =
    1, lwd = 1, pch = par("pch"), col = if(n &gt; 250) NULL else "grey",
    xlab = "Index", ylab = "Data", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector, which may contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A single value giving the threshold, unless a time varying
threshold is used, in which case <code>u</code> should be a vector of
thresholds, typically with the same length as <code>data</code> (or else
the usual recycling rules are applied).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A postive integer denoting the clustering interval
length. By default the interval length is one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ulow</code></td>
<td>
<p>A single value giving the lower threshold, unless a time
varying lower threshold is used, in which case <code>ulow</code> should
be a vector of lower thresholds, typically with the same length as
<code>data</code> (or else the usual recycling rules are applied).
By default there is no lower threshold (or equivalently, the
lower threshold is <code>-Inf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlow</code></td>
<td>
<p>A postive integer denoting the lower clustering interval
length. By default the interval length is one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmax</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default), a list
containing the clusters of exceedences is returned. If
<code>TRUE</code> a numeric vector containing the cluster maxima
is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.names</code></td>
<td>
<p>Logical; if <code>FALSE</code>, the function makes
no attempt to retain the names/indices of the observations
within the returned object. If <code>data</code> contains a large
number of observations, this can make the function run much
faster. The argument is mainly designed for internal use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical; if <code>TRUE</code> a plot is given that depicts
the identified clusters, and the clusters (if <code>cmax</code> is
<code>FALSE</code>) or cluster maxima (if <code>cmax</code> is <code>TRUE</code>)
are returned invisibly. If <code>FALSE</code> (the default), the
following arguments are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>A numeric vector with the same length as <code>data</code>,
giving the values to be plotted on the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lvals</code></td>
<td>
<p>Logical; should the values below the threshold and
the line depicting the lower threshold be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>
<p>Line type and width for the lines depicting the
threshold and the lower threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plotting character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Strips of colour <code>col</code> are used to identify the
clusters. An observation is contained in the cluster if the 
centre of the corresponding plotting character is contained
in the coloured strip. If <code>col</code> is <code>NULL</code> the strips
are omitted. By default the strips are coloured <code>"grey"</code>,
but are omitted whenever <code>data</code> contains more than 250
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for the x and y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphics parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The clusters of exceedences are identified as follows.
The first exceedence of the threshold initiates the first cluster.
The first cluster then remains active until either <code>r</code>
consecutive values fall below (or are equal to) the threshold,
or until <code>rlow</code> consecutive values fall below (or are equal
to) the lower threshold.
The next exceedence of the threshold (if it exists) then initiates
the second cluster, and so on.
Missing values are allowed, in which case they are treated as
falling below (or equal to) the threshold, but falling above the
lower threshold.
</p>


<h3>Value</h3>

<p>If <code>cmax</code> is <code>FALSE</code> (the default), a list with one
component for each identified cluster.
If <code>cmax</code> is <code>TRUE</code>, a numeric vector containing the
cluster maxima.
In any case, the returned object has an attribute <code>acs</code>,
giving the average cluster size (where the cluster size is
defined as the number of exceedences within a cluster), which
will be <code>NaN</code> if there are no values above the threshold
(and hence no clusters).
</p>
<p>If <code>plot</code> is <code>TRUE</code>, the list of clusters, or vector
of cluster maxima, is returned invisibly.
</p>


<h3>See Also</h3>

<p><code>exi</code>, <code>exiplot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">clusters(portpirie, 4.2, 3)
clusters(portpirie, 4.2, 3, cmax = TRUE)
clusters(portpirie, 4.2, 3, 3.8, plot = TRUE)
clusters(portpirie, 4.2, 3, 3.8, plot = TRUE, lvals = FALSE)
tvu &lt;- c(rep(4.2, 20), rep(4.1, 25), rep(4.2, 20))
clusters(portpirie, tvu, 3, plot = TRUE)
</code></pre>


</div>