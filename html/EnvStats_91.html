<div class="container">

<table style="width: 100%;"><tr>
<td>ecdfPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Empirical Cumulative Distribution Function Plot
</h2>

<h3>Description</h3>

<p>Produce an empirical cumulative distribution function plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ecdfPlot(x, discrete = FALSE, 
    prob.method = ifelse(discrete, "emp.probs", "plot.pos"), 
    plot.pos.con = 0.375, plot.it = TRUE, add = FALSE, ecdf.col = "black", 
    ecdf.lwd = 3 * par("cex"), ecdf.lty = 1, curve.fill = FALSE, 
    curve.fill.col = "cyan", ..., type = ifelse(discrete, "s", "l"), 
    main = NULL, xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and 
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>

<p>logical scalar indicating whether the assumed parent distribution of <code>x</code> is discrete 
(<code>discrete=TRUE</code>) or continuous (<code>discrete=FALSE</code>; the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.method</code></td>
<td>

<p>character string indicating what method to use to compute the plotting positions (empirical probabilities).  
Possible values are <code>plot.pos</code> (plotting positions, the default if <code>discrete=FALSE</code>) and 
<code>emp.probs</code> (empirical probabilities, the default if <code>discrete=TRUE</code>).  
See the DETAILS section for more explanation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pos.con</code></td>
<td>

<p>numeric scalar between 0 and 1 containing the value of the plotting position constant.  
The default value is <code>plot.pos.con=0.375</code>.  See the DETAILS section for more information.  
This argument is ignored if <code>prob.method="emp.probs"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>logical scalar indicating whether to produce a plot or add to the current plot (see <code>add</code>) 
on the current graphics device.  The default value is <code>plot.it=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical scalar indicating whether to add the empirical cdf to the current plot (<code>add=TRUE</code>) 
or generate a new plot (<code>add=FALSE</code>; the default).  This argument is ignored if 
<code>plot.it=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecdf.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the empirical cdf line or points.  
The default value is <code>ecdf.col=1</code>.  See the entry for <code>col</code> in the help file for 
<code>par</code> for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecdf.lwd</code></td>
<td>

<p>a numeric scalar determining the width of the empirical cdf line.  The default value is 
<code>ecdf.lwd=3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecdf.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the empirical cdf line.  The default value is 
<code>ecdf.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve.fill</code></td>
<td>

<p>a logical scalar indicating whether to fill in the area below the empirical cdf curve with the 
color specified by <code>curve.fill.col</code>. The default value is <br><code>curve.fill=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve.fill.col</code></td>
<td>

<p>a numeric scalar or character string indicating what color to use to fill in the area below the 
empirical cdf curve.  The default value is <code>curve.fill.col=5</code>.  This argument is ignored 
if <code>curve.fill=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type, main, xlab, ylab, xlim, ylim, ...</code></td>
<td>

<p>additional graphical parameters (see <code>lines</code> and <code>par</code>).  In particular, 
the argument <code>type</code> specifies the kind of line type.  By default, the function 
<code>ecdfPlot</code> plots a step function (<code>type="s"</code>) when <code>discrete=TRUE</code>, and 
plots a straight line between points (<code>type="l"</code>) when <code>discrete=FALSE</code>.  
The user may override these defaults by supplying the graphics parameter <code>type</code> 
(<code>type="s"</code> for a step function, <code>type="l"</code> for linear interpolation, 
<code>type="p"</code> for points only, etc.).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <b><em>cumulative distribution function (cdf)</em></b> of a random variable 
<code class="reqn">X</code> is the function <code class="reqn">F</code> such that 
</p>
<p style="text-align: center;"><code class="reqn">F(x) = Pr(X \le x) \;\;\;\;\;\; (1)</code>
</p>
 
<p>for all values of <code class="reqn">x</code>.  That is, if <code class="reqn">p = F(x)</code>, then <code class="reqn">p</code> is the 
proportion of the population that is less than or equal to <code class="reqn">x</code>, and 
<code class="reqn">x</code> is called the <code class="reqn">p</code>'th <b><em>quantile</em></b>, or the 100<code class="reqn">p</code>'th 
percentile.  A plot of quantiles 
on the <code class="reqn">x</code>-axis (i.e., the possible value for the random variable <code class="reqn">X</code>) vs. 
the fraction of the population less than or equal to that number on the 
<code class="reqn">y</code>-axis is called the <b><em>cumulative distribution function plot</em></b>, and 
the <code class="reqn">y</code>-axis is usually labeled as the 
“cumulative probability” or “cumulative frequency”.
</p>
<p>When we have a sample of data from some population, we usually do not
know what percentiles our observations correspond to because we do not
know the form of the cumulative distribution function <code class="reqn">F</code>, so we 
have to use the sample data to estimate the cdf <code class="reqn">F</code>.  An 
<b><em>emprical cumulative distribution function (ecdf) plot</em></b>, 
also called a <b><em>quantile plot</em></b>, is a plot of the observed 
quantiles (i.e., the ordered observations) on the <code class="reqn">x</code>-axis vs. 
the estimated cumulative probabilities on the <code class="reqn">y</code>-axis
(Chambers et al., 1983, pp. 11-19; Cleveland, 1993, pp. 17-20; 
Cleveland, 1994, pp. 136-139; Helsel and Hirsch, 1992, pp. 21-24).
</p>
<p>(Note:  Some authors (e.g., Chambers et al., 1983, pp.11-16; Cleveland, 1993, pp.17-20) 
reverse the axes on a quantile plot, i.e., the observed order statistics from the 
random sample are on the <code class="reqn">y</code>-axis and the estimated cumulative probabilities 
are on the <code class="reqn">x</code>-axis.)
</p>
<p>The <b><em>empirical cumulative distribution function (ecdf)</em></b>  
is an estimate of the cdf based on a random sample of <code class="reqn">n</code> observations 
from the distribution.  Let <code class="reqn">x_1, x_2, \ldots, x_n</code> denote the <code class="reqn">n</code> 
observations, and let <code class="reqn">x_{(1)}, x_{(2)}, \ldots, x_{(n)}</code> denote the ordered 
observations (i.e., the order statistics).  The cdf is usually estimated by either 
the <b><em>empirical probabilities estimator</em></b> or the 
<b><em>plotting-position estimator</em></b>.  The empirical probabilities estimator 
is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \hat{p}_i = \frac{\#[x_j \le x_{(i)}]}{n} \;\;\;\;\;\; (2)</code>
</p>
 
<p>where <code class="reqn">\#[x_j \le x_{(i)}]</code> denotes the number of observations less than 
or equal to <code class="reqn">x_{(i)}</code>.  The plotting-position estimator is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \hat{p}_i = \frac{i - a}{n - 2a + 1} \;\;\;\;\;\; (3)</code>
</p>

<p>where <code class="reqn">0 \le a \le 1</code> (Cleveland, 1993, p. 18; D'Agostino, 1986a, pp. 8,25).
</p>
<p>For any value <code class="reqn">x</code> such that <code class="reqn">x_{(1)} &lt; x &lt; x_{(n)}</code>, the ecdf is usually defined as either a step function:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}(x) = \hat{F}[x_{(i)}], \qquad x_{(i)} \le x &lt; x_{(i+1)} \;\;\;\;\;\; (4)</code>
</p>

<p>(e.g., D'Agostino, 1986a), or linear interpolation between order statistics is used:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}(x) = (1-r)\hat{F}[x_{(i)}] + r\hat{F}[x_{(i+1)}], \qquad x_{(i)} \le x &lt; x_{(i+1)} \;\;\;\;\;\; (5)</code>
</p>

<p>where 
</p>
<p style="text-align: center;"><code class="reqn">r = \frac{x - x_{(i)}}{x_{(i+1)} - x_{(i)}} \;\;\;\;\;\; (6)</code>
</p>

<p>(e.g., Chambers et al., 1983).  For the step function version, the ecdf stays flat until it hits a 
value on the <code class="reqn">x</code>-axis corresponding to one of the order statistics, then it makes a jump.  
For the linear interpolation version, the ecdf plot looks like lines connecting the points.  
By default, the function <code>ecdfPlot</code> uses the step function version when <code>discrete=TRUE</code>, and 
the linear interpolation version when <code>discrete=FALSE</code>.  The user may override these defaults by 
supplying the graphics parameter <code>type</code> (<code>type="s"</code> for a step function, <code>type="l"</code> 
for linear interpolation, <code>type="p"</code> for points only, etc.).
</p>
<p>The empirical probabilities estimator is intuitively appealing.  This is the estimator used when 
<code>prob.method="emp.probs"</code>.  The disadvantage of this estimator is that it implies the largest 
observed value is the maximum possible value of the distribution (i.e., the 100'th percentile).  This 
may be satisfactory if the underlying distribution is known to be discrete, but it is usually not 
satisfactory if the underlying distribution is known to be continuous.
</p>
<p>The plotting-position estimator with various values of <code class="reqn">a</code> is often used when the goal is 
to produce a probability plot (see <code>qqPlot</code>) rather than an empirical cdf plot.  It is used 
to compute the estimated expected values or medians of the order statistics for a probability plot.  
This is the estimator used when <code>prob.method="plot.pos"</code>.  The argument <code>plot.pos.con</code> refers 
to the variable <code class="reqn">a</code>.  Based on certain principles from statistical theory, certain 
values of the constant <code class="reqn">a</code> make sense for specific underlying distributions (see 
the help file for <code>qqPlot</code> for more information).
</p>
<p>Because <code class="reqn">x</code> is a random sample, the emprical cdf changes from sample to sample and the variability 
in these estimates can be dramatic for small sample sizes.
</p>


<h3>Value</h3>

<p><code>ecdfPlot</code> invisibly returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Order.Statistics</code></td>
<td>
<p>numeric vector of the ordered observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cumulative.Probabilities</code></td>
<td>
<p>numeric vector of the associated plotting positions.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>An empirical cumulative distribution function (ecdf) plot is a graphical tool that 
can be used in conjunction with other graphical tools such as histograms, 
strip charts, and boxplots to assess the characteristics of a set of data.  
It is easy to determine quartiles and the minimum and maximum 
values from such a plot.  Also, ecdf plots allow you to assess local density:  
a higher density of observations occurs where the slope is steep.
</p>
<p>Chambers et al. (1983, pp.11-16) plot the observed order statistics on the 
<code class="reqn">y</code>-axis vs. the ecdf on the <code class="reqn">x</code>-axis and call this a quantile plot.
</p>
<p>Empirical cumulative distribution function (ecdf) plots are often plotted with 
theoretical cdf plots (see <code>cdfPlot</code> and <code>cdfCompare</code>) to 
graphically assess whether a sample of observations comes from a particular 
distribution.  The Kolmogorov-Smirnov goodness-of-fit test 
(see <code>gofTest</code>) is the statistical companion of this kind of 
comparison; it is based on the maximum vertical distance between the empirical 
cdf plot and the theoretical cdf plot.  More often, however, 
quantile-quantile (Q-Q) plots are used instead of ecdf plots to graphically assess 
departures from an assumed distribution (see <code>qqPlot</code>).
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J.M., W.S. Cleveland, B. Kleiner, and P.A. Tukey. (1983). 
<em>Graphical Methods for Data Analysis</em>. Duxbury Press, Boston, MA, pp.11-16.
</p>
<p>Cleveland, W.S. (1993). <em>Visualizing Data</em>. Hobart Press, Summit, New Jersey, 360pp.
</p>
<p>D'Agostino, R.B. (1986a). Graphical Analysis. 
In: D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>. 
Marcel Dekker, New York, Chapter 2, pp.7-62.
</p>


<h3>See Also</h3>

<p><code>ppoints</code>, <code>cdfPlot</code>, <code>cdfCompare</code>, 
<code>qqPlot</code>, <code>ecdfPlotCensored</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a normal distribution with 
  # mean=0 and sd=1 and create an ecdf plot. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  x &lt;- rnorm(20) 
  dev.new()
  ecdfPlot(x)

  #----------

  # Repeat the above example, but fill in the area under the 
  # empirical cdf curve.

  dev.new()
  ecdfPlot(x, curve.fill = TRUE)

  #----------

  # Repeat the above example, but plot only the points.

  dev.new()
  ecdfPlot(x, type = "p")

  #----------

  # Repeat the above example, but force a step function.

  dev.new()
  ecdfPlot(x, type = "s")

  #----------

  # Clean up
  rm(x)

  #-------------------------------------------------------------------------------------

  # The guidance document USEPA (1994b, pp. 6.22--6.25) 
  # contains measures of 1,2,3,4-Tetrachlorobenzene (TcCB) 
  # concentrations (in parts per billion) from soil samples 
  # at a Reference area and a Cleanup area.  These data are strored 
  # in the data frame EPA.94b.tccb.df.  
  #
  # Create an empirical CDF plot for the reference area data.
  
  dev.new()
  with(EPA.94b.tccb.df, 
    ecdfPlot(TcCB[Area == "Reference"], xlab = "TcCB (ppb)"))

  #==========

  # Clean up
  #---------
  graphics.off()
</code></pre>


</div>