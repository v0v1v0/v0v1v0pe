<div class="container">

<table style="width: 100%;"><tr>
<td>par.eCAR.Leroux</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R wrapper that accesses C code to fit parametric Leroux CAR spatial regression model that accounts for spatial confounding</h2>

<h3>Description</h3>

<p><code>par.eCAR.Leroux</code> is the main function used to fit the parametric Leroux CAR model specified in the spectral domain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">par.eCAR.Leroux(y, x, W,
                E=NULL,
                C=NULL,
                model="Gaussian",
                joint_prior_lamx_lamz = FALSE,
                lamx.fix.val = NULL,
                sig2x.fix.val = NULL,
                mb=0,s2b=10,
                mg=0,s2g=10.0,
                alamx=1, blamx=1,
                alamz=1, blamz=1,
                asig=1, bsig=1,
                atau=1, btau=1,
                asigx=1, bsigx=1,
                mb0=0,s2b0=100,
                me=0,s2e=100,
                mx=0,s2x=100,
                tau_cand_sd = 1,
                sig2_cand_sd = 1,
                draws=10000, burn=5000, thin=5,
                verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate vector for which casual effect is desired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>neighborhood matrix comprised of zeros and ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>This argument is ignored if model is Gaussian.  For other models it takes on the following:
</p>

<ul>
<li>
<p> Poisson - E is vector that contains expected counts
</p>
</li>
<li>
<p> Binomial - E is vector that contains number of trials
</p>
</li>
<li>
<p> Negative Binomial - E is vector that contains an offset.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>design matrix for the covariates that are included as controls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Specifies the likelihood or data model.  Options are "Gaussian", "Poisson", "Binomial", "Negative Binomial"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint_prior_lamx_lamz</code></td>
<td>
<p>Logical.  If TRUE, then a uniform prior on space such that lamz &gt; lamx.  If FALSE, independent beta priors are used.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamx.fix.val</code></td>
<td>
<p>If a value is supplied then lambda_x is not updated in the MCMC algorithm, but rather treated as the fixed known supplied value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2x.fix.val</code></td>
<td>
<p>If a value is supplied then sigma2_x is not updated in the MCMC algorithm, but rather treated as the fixed known supplied value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mb</code></td>
<td>
<p>prior mean for beta.  default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2b</code></td>
<td>
<p>prior variance for beta. default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mg</code></td>
<td>
<p>prior mean for gamma, where gamma = rho*(sigz/sigx).  default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2g</code></td>
<td>
<p>prior variance for, gamma), where gamma = rho*(sigz/sigx). default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alamx</code></td>
<td>
<p>prior shape1 parameter for lam.x, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blamx</code></td>
<td>
<p>prior shape2 parameter for lam.x, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alamz</code></td>
<td>
<p>prior shape1 parameter for lam.z, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blamz</code></td>
<td>
<p>prior shape2 parameter for lam.z, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asig</code></td>
<td>
<p>prior shape parameter for sigma2, default is 1. Only used if model is Gaussian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsig</code></td>
<td>
<p>prior scale parameter for sigma2, default is 1. Only used if model is Gaussian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atau</code></td>
<td>
<p>prior shape parameter for tau, where tau = sigma2.z*(1-rho^2). default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btau</code></td>
<td>
<p>prior scale parameter for tau, where tau = sigma2.z*(1-rho^2).  default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asigx</code></td>
<td>
<p>prior shape parameter for sigma2.x, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsigx</code></td>
<td>
<p>prior scale parameter for sigma2.x, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mb0</code></td>
<td>
<p>prior mean parameter for beta0, default is 0.  Only used if model is not Gaussian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2b0</code></td>
<td>
<p>prior variance parameter for beta0, default is 100. Only used if model is not Gaussian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>me</code></td>
<td>
<p>prior mean parameter for eta, default is 0. Only used if C is not NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2e</code></td>
<td>
<p>prior variance parameter for eta, default is 100. Only used if C is not NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mx</code></td>
<td>
<p>prior mean parameter for xi, default is 0. Only used for negative binomial model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2x</code></td>
<td>
<p>prior variance parameter for eta, default is 100. Only used for negative binomial model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_cand_sd</code></td>
<td>
<p>standard deviation for candidate density in Metropolis step for tau.  Default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2_cand_sd</code></td>
<td>
<p>standard deviation for candidate density in Metropolis step for sig2.  Default is 1. Only used if model is Gaussian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draws</code></td>
<td>
<p>number of MCMC iterates to be collected. default is 10000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>number of MCMC iterates discared as burn-in. default is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>number by which the MCMC chain is thinned. default is 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE, then details associated with data being fit are printed to screen along with MCMC iterate counter</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns an <code>eCAR</code> object which is a list that contains the following
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data_model</code></td>
<td>
<p>Character indicating which model was fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_omega</code></td>
<td>
<p>Matrix that contains respectively, the posterior mean lower and upper quantiles of the (spatial scale)-varying beta at each omega value (for the non Gaussian cases it is the exponentiated beta).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior_draws</code></td>
<td>
<p>List containing posterior draws of the following parameters
</p>

<ol>
<li>
<p>beta: vector containing draws from the posterior distribution of exposure coefficient 
</p>
</li>
<li>
<p>gamma: vector containing draws from the posterior distribution of gamma=rho*(sigz/sigx)
</p>
</li>
<li>
<p>tau: vector containing draws from tau=sigma2.z*(1-rho^2)
</p>
</li>
<li>
<p>sig2x: vector containing draws from sig2x 
</p>
</li>
<li>
<p>lamx: vector containing draws from the posterior distribution of lamx 
</p>
</li>
<li>
<p>lamz: vector containing draws from the posterior distribution of lamz
</p>
</li>
<li>
<p>sigma2: vector containing draws from the posterior distribution of sigma2.  Only available if model is Gaussian
</p>
</li>
<li>
<p>rho: vector containing draws from the posterior distribution of rho
</p>
</li>
<li>
<p>sig2z: vector containing draws from the posterior distribution of sig2z
</p>
</li>
<li>
<p>theta: matrix containing draws from the posterior distribution of theta. Only available if model is not Gaussian
</p>
</li>
<li>
<p>beta0: vector containing draws from the posterior distribution of beta0. Only available if model is not Gaussian
</p>
</li>
<li>
<p>eta: matrix containing draws from the posterior distribution of eta, regression coefficients of additional confouner variables.  Only available if C is not NULL
</p>
</li>
<li>
<p>nb_r: matrix containing draws from the posterior distribution of nb_r.  0nly available if model is Negative Binomial
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIC</code></td>
<td>
<p>Not available from parametric model yet</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regrcoef</code></td>
<td>
<p>Not available from parametric model yet</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Guan, Y; Page, G.L.; Reich, B.J.; Ventrucci, M.; Yang, S; "A spectral adjustment for spatial confounding" &lt;arXiv:2012.11767&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Our R-package
library(eCAR)

data(lipcancer)


W &lt;- lipcancer$neighborhood.Matrix
M &lt;- diag(apply(W,1,sum))
R &lt;- M-W
e.dec &lt;- eigen(R)
e.val &lt;- e.dec$values
D.eigval = diag(e.val)


Y &lt;- lipcancer$data$observed
X &lt;- lipcancer$data$pcaff
E &lt;- lipcancer$data$expected

set.seed(101)
fit1 &lt;- par.eCAR.Leroux(y=Y, x=X, W=W, E=E, C=NULL, model="Poisson",
                         draws=10000, burn=5000, thin=1, verbose=FALSE,
                         joint_prior_lamx_lamz=FALSE)


plot(fit1)
</code></pre>


</div>