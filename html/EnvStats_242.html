<div class="container">

<table style="width: 100%;"><tr>
<td>ezmnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Parameters of a Zero-Modified Normal Distribution
</h2>

<h3>Description</h3>

<p>Estimate the mean and standard deviation of a 
zero-modified normal distribution, and 
optionally construct a confidence interval for the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ezmnorm(x, method = "mvue", ci = FALSE, ci.type = "two-sided", 
    ci.method = "normal.approx", conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimation.  Currently, the only possible 
value is <code>"mvue"</code> (minimum variance unbiased; the default).  See the DETAILS 
section for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the 
mean.  The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>

<p>character string indicating what kind of confidence interval to compute.  The 
possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>character string indicating what method to use to construct the confidence interval 
for the mean.  Currently the only possible value is <code>"normal.approx"</code> 
(the default).  See the DETAILS section for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.  
The default value is <code>conf.level=0.95</code>. This argument is ignored if 
<code>ci=FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or 
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to 
performing the estimation.
</p>
<p>Let <code class="reqn">\underline{x} = (x_1, x_2, \ldots, x_n)</code> be a vector of 
<code class="reqn">n</code> observations from a 
zero-modified normal distribution with 
parameters <code>mean=</code><code class="reqn">\mu</code>, <code>sd=</code><code class="reqn">\sigma</code>, and <code>p.zero=</code><code class="reqn">p</code>.  
Let <code class="reqn">r</code> denote the number of observations in <code class="reqn">\underline{x}</code> that are equal 
to 0, and order the observations so that <code class="reqn">x_1, x_2, \ldots, x_r</code> denote 
the <code class="reqn">r</code> zero observations, and <code class="reqn">x_{r+1}, x_{r+2}, \ldots, x_n</code> denote the 
<code class="reqn">n-r</code> non-zero observations.
</p>
<p>Note that <code class="reqn">\mu</code> is <em>not</em> the mean of the zero-modified normal distribution; 
it is the mean of the normal part of the distribution.  Similarly, <code class="reqn">\sigma</code> is 
<em>not</em> the standard deviation of the zero-modified normal distribution; it is 
the standard deviation of the normal part of the distribution.
</p>
<p>Let <code class="reqn">\gamma</code> and <code class="reqn">\delta</code> denote the mean and standard deviation of the 
overall zero-modified normal distribution.  Aitchison (1955) shows that:
</p>
<p style="text-align: center;"><code class="reqn">\gamma = (1 - p) \mu  \;\;\;\; (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">\delta^2 = (1 - p) \sigma^2 + p (1 - p) \mu^2 \;\;\;\; (2)</code>
</p>

<p><br></p>
<p><b>Estimation</b> <br></p>
<p><em>Minimum Variance Unbiased Estimation</em> (<code>method="mvue"</code>) <br>
Aitchison (1955) shows that the minimum variance unbiased estimators (mvue's) of 
<code class="reqn">\gamma</code> and <code class="reqn">\delta</code> are:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}_{mvue} = \bar{x} \;\;\;\; (3)</code>
</p>


<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{\delta}^2_{mvue} =</code> </td>
<td style="text-align: left;"> <code class="reqn">\frac{n-r-1}{n-1} (s^*)^2 + \frac{r}{n} (\frac{n-r}{n-1}) (\bar{x}^*)^2</code> </td>
<td style="text-align: left;"> if <code class="reqn">r &lt; n - 1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                  </td>
<td style="text-align: left;"> <code class="reqn">x_n^2 / n</code> </td>
<td style="text-align: left;"> if <code class="reqn">r = n - 1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                  </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> if <code class="reqn">r = n \;\;\;\; (4)</code>
  </td>
</tr>
</table>
<p>where 
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\; (5)</code>
</p>

<p style="text-align: center;"><code class="reqn">\bar{x}^* = \frac{1}{n-r} \sum_{i=r+1}^n x_i \;\;\;\; (6)</code>
</p>

<p style="text-align: center;"><code class="reqn">(s^*)^2 = \frac{1}{n-r-1} \sum_{i=r+1}^n (x_i - \bar{x}^*)^2 \;\;\;\; (7)</code>
</p>

<p>Note that the quantity in equation (5) is the sample mean of all observations 
(including 0 values), the quantity in equation (6) is the sample mean of all non-zero 
observations, and the quantity in equation (7) is the sample variance of all 
non-zero observations.  Also note that for <code class="reqn">r=n-1</code> or <code class="reqn">r=n</code>, the estimator 
of <code class="reqn">\delta^2</code> is the sample variance for all observations (including 0 values).
<br></p>
<p><b>Confidence Intervals</b> <br></p>
<p><em>Based on Normal Approximation</em> (<code>ci.method="normal.approx"</code>) <br>
An approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\gamma</code> is 
constructed based on the assumption that the estimator of <code class="reqn">\gamma</code> is 
approximately normally distributed.  Aitchison (1955) shows that 
</p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\gamma}_{mvue}) = Var(\bar{x}) = \frac{\delta^2}{n} \;\;\;\; (8)</code>
</p>

<p>Thus, an approximate two-sided <code class="reqn">(1-\alpha)100\%</code> confidence interval for 
<code class="reqn">\gamma</code> is constructed as:
</p>
<p style="text-align: center;"><code class="reqn">[ \hat{\gamma}_{mvue} - t_{n-2, 1-\alpha/2} \frac{\hat{\delta}_{mvue}}{\sqrt{n}}, \; \hat{\gamma}_{mvue} + t_{n-2, 1-\alpha/2} \frac{\hat{\delta}_{mvue}}{\sqrt{n}} ] \;\;\;\; (9)</code>
</p>

<p>where <code class="reqn">t_{\nu, p}</code> is the <code class="reqn">p</code>'th quantile of 
Student's t-distribution with <code class="reqn">\nu</code> degrees of freedom.
</p>
<p>One-sided confidence intervals are computed in a similar fashion.
</p>


<h3>Value</h3>

<p>a list of class <code>"estimate"</code> containing the estimated parameters and other information.  
See <br><code>estimate.object</code> for details.
</p>
<p>The component called <code>parameters</code> is a numeric vector with the following 
estimated parameters: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <b>Parameter Name</b> </td>
<td style="text-align: left;"> <b>Explanation</b> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mean</code> </td>
<td style="text-align: left;"> mean of the normal (Gaussian) part of the distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sd</code>   </td>
<td style="text-align: left;"> standard deviation of the normal (Gaussian) part of the distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>p.zero</code>  </td>
<td style="text-align: left;"> probability that an observation will be 0. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mean.zmnorm</code> </td>
<td style="text-align: left;"> mean of the overall zero-modified normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sd.zmnorm</code> </td>
<td style="text-align: left;"> standard deviation of the overall normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>Note</h3>

<p>The zero-modified normal distribution is sometimes 
used to model chemical concentrations for which some observations are reported 
as “Below Detection Limit”.  See, for example USEPA (1992c, pp.27-34).  
In most cases, however, the zero-modified lognormal (delta) distribution will be 
more appropriate, since chemical concentrations are bounded below at 0 
(e.g., Gilliom and Helsel, 1986; Owen and DeRouen, 1980).
</p>
<p>Once you estimate the parameters of the zero-modified normal distribution, it is 
often useful to characterize the uncertainty in the estimate of the mean.  This is 
done with a confidence interval.
</p>
<p>One way to try to assess whether a 
zero-modified lognormal (delta), 
zero-modified normal, censored normal, or 
censored lognormal is the best model for the data is to construct both 
censored and detects-only probability plots (see <code>qqPlotCensored</code>).
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Aitchison, J. (1955).  On the Distribution of a Positive Random Variable Having 
a Discrete Probability Mass at the Origin.  <em>Journal of the American 
Statistical Association</em> <b>50</b>, 901–908.
</p>
<p>Gilliom, R.J., and D.R. Helsel. (1986).  Estimation of Distributional Parameters 
for Censored Trace Level Water Quality Data: 1. Estimation Techniques.  
<em>Water Resources Research</em> <b>22</b>, 135–146.
</p>
<p>Owen, W., and T. DeRouen. (1980).  Estimation of the Mean for Lognormal Data 
Containing Zeros and Left-Censored Values, with Applications to the Measurement 
of Worker Exposure to Air Contaminants.  <em>Biometrics</em> <b>36</b>, 707–719.
</p>
<p>USEPA (1992c).  <em>Statistical Analysis of Ground-Water Monitoring Data at 
RCRA Facilities: Addendum to Interim Final Guidance</em>.  Office of Solid Waste, 
Permits and State Programs Division, US Environmental Protection Agency, 
Washington, D.C.
</p>


<h3>See Also</h3>

<p>ZeroModifiedNormal, Normal, 
<code>ezmlnorm</code>, ZeroModifiedLognormal, <code>estimate.object</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 100 observations from a zero-modified normal distribution 
  # with mean=4, sd=2, and p.zero=0.5, then estimate the parameters.  
  # According to equations (1) and (2) above, the overall mean is 
  # mean.zmnorm=2 and the overall standard deviation is sd.zmnorm=sqrt(6).  
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  dat &lt;- rzmnorm(100, mean = 4, sd = 2, p.zero = 0.5) 
  ezmnorm(dat, ci = TRUE) 

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Zero-Modified Normal
  #
  #Estimated Parameter(s):          mean        = 4.037732
  #                                 sd          = 1.917004
  #                                 p.zero      = 0.450000
  #                                 mean.zmnorm = 2.220753
  #                                 sd.zmnorm   = 2.465829
  #
  #Estimation Method:               mvue
  #
  #Data:                            dat
  #
  #Sample Size:                     100
  #
  #Confidence Interval for:         mean.zmnorm
  #
  #Confidence Interval Method:      Normal Approximation
  #                                 (t Distribution)
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             LCL = 1.731417
  #                                 UCL = 2.710088

  #----------

  # Following Example 9 on page 34 of USEPA (1992c), compute an 
  # estimate of the mean of the zinc data, assuming a 
  # zero-modified normal distribution. The data are stored in 
  # EPA.92c.zinc.df.

  head(EPA.92c.zinc.df) 
  #  Zinc.orig  Zinc Censored Sample Well
  #1        &lt;7  7.00     TRUE      1    1
  #2     11.41 11.41    FALSE      2    1
  #3        &lt;7  7.00     TRUE      3    1
  #4        &lt;7  7.00     TRUE      4    1
  #5        &lt;7  7.00     TRUE      5    1
  #6     10.00 10.00    FALSE      6    1

  New.Zinc &lt;- EPA.92c.zinc.df$Zinc 
  New.Zinc[EPA.92c.zinc.df$Censored] &lt;- 0 
  ezmnorm(New.Zinc, ci = TRUE) 

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            Zero-Modified Normal
  #
  #Estimated Parameter(s):          mean        = 11.891000
  #                                 sd          =  1.594523
  #                                 p.zero      =  0.500000
  #                                 mean.zmnorm =  5.945500
  #                                 sd.zmnorm   =  6.123235
  #
  #Estimation Method:               mvue
  #
  #Data:                            New.Zinc
  #
  #Sample Size:                     40
  #
  #Confidence Interval for:         mean.zmnorm
  #
  #Confidence Interval Method:      Normal Approximation
  #                                 (t Distribution)
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             LCL = 3.985545
  #                                 UCL = 7.905455

  #----------

  # Clean up
  rm(dat, New.Zinc)
</code></pre>


</div>