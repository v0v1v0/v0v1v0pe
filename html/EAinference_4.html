<div class="container">

<table style="width: 100%;"><tr>
<td>MHLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metropolis-Hastings lasso sampler under a fixed active set.</h2>

<h3>Description</h3>

<p>Metropolis-Hastings sampler to simulate from the sampling
distribution of lasso given a fixed active set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MHLS(X, PE, sig2, lbd, weights = rep(1, ncol(X)), B0, S0, A = which(B0 !=
  0), tau = rep(1, ncol(X)), niter = 2000, burnin = 0, PEtype = "coeff",
  updateS.itv = 1, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PE, sig2, lbd</code></td>
<td>
<p>parameters of target distribution.
(point estimate of beta or <code>E(y)</code> depends on <code>PEtype</code>, variance estimate of error and lambda).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weight vector with length <code>p</code>(the number of covariates).
Default is <code>weights = rep(1, p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>
<p>numeric vector with length <code>p</code>.
Initial value of lasso estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>numeric vector with length <code>p</code>.
Initial value of subgradients.
If not given, this will be generated in a default way.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>numeric vector. Active coefficient index.
Every active coefficient index in <code>B0</code> must be included.
Default is <code>A = which(B0 != 0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>numeric vector with length <code>p</code>.
Standard deviation of proposal distribution for each coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>integer. The number of iterations. Default is <code>niter = 2000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>integer. The length of burin-in periods. Default is <code>burnin = 0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PEtype</code></td>
<td>
<p>Type of <code>PE</code> which is needed to characterize the target distribution.
Users can choose either <code>"coeff"</code> or <code>"mu"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateS.itv</code></td>
<td>
<p>integer. Update subgradients every <code>updateS.itv</code> iterations.
Set this value larger than <code>niter</code> if one wants to skip updating subgradients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If true, print out the progress step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>complementary arguments.
</p>

<ul>
<li>
<p><code>FlipSA :</code> optional parameter.
This has to be a subset of active set, A. If the index is not listed in FlipSA,
the sign of coefficients which correspond to the listed index will remain fixed.
The default is <code>FlipSA=A</code>
</p>
</li>
<li>
<p><code>SFindex :</code> optional parameter. subgradient index for the free coordinate.
</p>
</li>
<li>
<p><code>randomSFindex :</code> logical. If <code>true</code>, resample <code>SFindex</code> every
<code>updateSF.itv</code> iterations.
</p>
</li>
<li>
<p><code>updateSF.itv :</code> integer. In every <code>updateSF.itv</code> iterations,
randomize <code>SFindex</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given appropriate initial value, provides Metropolis-Hastings samples
under the fixed active set. <br>
From the initial values, <code>B0</code> and S0, <code>MHLS</code> draws <code>beta</code> and <code>subgrad</code> samples.
In every iteration, given <code>t</code>-th iteration values, <code>t</code>-th <code>beta</code> and <code>t</code>-th <code>subgrad</code>,
a new set of proposed beta and subgradient is sampled. We either accept the proposed sample
and use that as <code>(t+1)</code>-th iteration values or reuse <code>t</code>-th iteration values. <br>
See Zhou(2014) for more details.
</p>


<h3>Value</h3>

<p><code>MHLS</code> returns an object of class <code>"MHLS"</code>.
The functions <code>summary.MHLS</code> and <code>plot.MHLS</code>
provide a brief summary and generate plots.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>lasso samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgrad</code></td>
<td>
<p>subgradient samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acceptHistory</code></td>
<td>
<p>numbers of acceptance and proposal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter, burnin, PE, type</code></td>
<td>
<p>same as function arguments.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhou, Q. (2014), "Monte Carlo simulation for Lasso-type problems by estimator augmentation,"
Journal of the American Statistical Association, 109, 1495-1516.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#-------------------------
# Low dim
#-------------------------
set.seed(123)
n &lt;- 10
p &lt;- 5
X &lt;- matrix(rnorm(n * p), n)
Y &lt;- X %*% rep(1, p) + rnorm(n)
sigma2 &lt;- 1
lbd &lt;- .37
weights &lt;- rep(1, p)
LassoResult &lt;- lassoFit(X = X, Y = Y, lbd = lbd, type = "lasso", weights = weights)
B0 &lt;- LassoResult$B0
S0 &lt;- LassoResult$S0
MHLS(X = X, PE = rep(0, p), sig2 = 1, lbd = 1,
     weights = weights, B0 = B0, S0 = S0, niter = 50, burnin = 0,
     PEtype = "coeff")
MHLS(X = X, PE = rep(0, n), sig2 = 1, lbd = 1,
     weights = weights, B0 = B0, S0 = S0, niter = 50, burnin = 0,
     PEtype = "mu")

#-------------------------
# High dim
#-------------------------
set.seed(123)
n &lt;- 5
p &lt;- 10
X &lt;- matrix(rnorm(n*p),n)
Y &lt;- X %*% rep(1,p) + rnorm(n)
weights &lt;- rep(1,p)
LassoResult &lt;- lassoFit(X = X,Y = Y,lbd = lbd, type = "lasso", weights = weights)
B0 &lt;- LassoResult$B0
S0 &lt;- LassoResult$S0
MHLS(X = X, PE = rep(0, p), sig2 = 1, lbd = 1,
     weights = weights, B0 = B0, S0 = S0, niter = 50, burnin = 0,
     PEtype = "coeff")
MHLS(X = X, PE = rep(0, n), sig2 = 1, lbd = 1,
     weights = weights, B0 = B0, S0 = S0, niter = 50, burnin = 0,
     PEtype = "mu")
</code></pre>


</div>