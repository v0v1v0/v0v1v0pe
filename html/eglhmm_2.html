<div class="container">

<table style="width: 100%;"><tr>
<td>bcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bootstrap covariance. </h2>

<h3>Description</h3>

<p>Creates an estimate of the covariance matrix of the parameter
estimates for an extended generalised linear hidden Markov model via
parametric bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   bcov(object, nsim = 50, itmax = 500, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> An object of class <code>eglhmm</code> as produced by
<code>eglhmm()</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p> The number of data sets to simulate, from which
to estimate parameters.  From each data set a vector of parameters
is estimated; the estimated covariance matrix is the empirical
covariance matrix of these <code>nsim</code> vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax</code></td>
<td>
<p> The maximum number of iterations to be used in attempting
to achieve convergence when fitting models to the simulated data sets.
Note that if convergence is not achieved, the simulated data set being
used is discarded (i.e. it “doesn't count”) and a replacement data set
is simulated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical scalar.  Should a “progress report”
be printed out at each step of the fitting procedure?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>C_hat</code></td>
<td>
<p>The parametric bootstrap estimate of the covariance
matrix of the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc.count</code></td>
<td>
<p>A count of the total number of times that the
algorithm failed to converge during the bootstrapping procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>an.count</code></td>
<td>
<p>A count of the “anomalies” that occurred,
i.e. the number of times that there was a decrease in the log
likelihood.  Present only if the <code>method</code> used in fitting
the models is <code>"em"</code>.
</p>
</td>
</tr>
</table>
<h3>Remarks</h3>

<p>Although this documentation refers to “extended
generalised linear models”, the only such models currently
(13/02/2024) available are the Gaussian model with the identity link,
the Poisson model, with the log link, the Binomial model with
the logit link, the Dbd (discretised beta distribution model),
and the Multinom model.  The latter two are generalised linear
models only in the “extended” sense.  Other models may be
added at a future date.
</p>
<p>When <code>eglhmm()</code> is called by <code>bcov()</code> the argument
<code>checkDecrLL</code> is set equal to <code>FALSE</code>.  This has an
effect only when the <code>method</code> used in fitting the models
is <code>"em"</code>.  In this case a decrease in the log likelihood
is treated as meaning that the algorithm has converged.   Setting
<code>checkDecrLL</code> equal to <code>FALSE</code> is done so as to decrease
the number of discarded data sets and thereby speed up the rate
at which the iterations proceed.
</p>


<h3>Author(s)</h3>

<p>Rolf Turner
<a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>References</h3>

<p>See the help for <code>eglhmm()</code> for references.
</p>


<h3>See Also</h3>

 <p><code>fitted.eglhmm()</code> <code>reglhmm()</code>
<code>reglhmm.default()</code> <code>reglhmm.eglhmm()</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">    ## Not run:  # Takes too long.
        fitP &lt;- eglhmm(y~locn+depth,data=SydColCount,distr="P",cells=c("locn","depth"),
                     K=2,contr="sum",verb=TRUE,itmax=300)
	cvrP &lt;- bcov(fitP)
        fitD &lt;- eglhmm(y~locn+depth,data=SydColCount,distr="D",cells=c("locn","depth"),
                     K=2,nbot=0,ntop=11,contr="sum",verb=TRUE)
	cvrD &lt;- bcov(fitD)
        fitM &lt;- eglhmm(y~locn+depth,data=SydColDisc,distr="M",cells=c("locn","depth"),
                     K=2,contr="sum",verb=TRUE)
	cvrM &lt;- bcov(fitM)
    
## End(Not run)
</code></pre>


</div>