<div class="container">

<table style="width: 100%;"><tr>
<td>tcplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Threshold Choice Plot</h2>

<h3>Description</h3>

<p>Plots of parameter estimates at various thresholds for peaks
over threshold modelling, using the Generalized Pareto or Point
Process representation. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcplot(data, tlim, model = c("gpd","pp"), pscale = FALSE, cmax =
    FALSE, r = 1, ulow = -Inf, rlow = 1, nt = 25, which = 1:npar,
    conf = 0.95, lty = 1, lwd = 1, type = "b", cilty = 1, vci =
    TRUE, xlab, xlim, ylabs, ylims, ask = nb.fig &lt; length(which) &amp;&amp;
    dev.interactive(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>A numeric vector of length two, giving the limits for
the thresholds at which the model is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model; either <code>"gpd"</code> (the default) or
<code>"pp"</code>, for the Generalized Pareto or Point Process
representations respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pscale</code></td>
<td>
<p>If <code>TRUE</code>, then the x-axis gives the threshold
exceedance probability rather than the threshold itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmax</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default), the models
are fitted using all exceedences over the thresholds. If
<code>TRUE</code>, the models are fitted using cluster maxima, using
clusters of exceedences derived from <code>clusters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r, ulow, rlow</code></td>
<td>
<p>Arguments used for the identification of
clusters of exceedences (see <code>clusters</code>).
Ignored if <code>cmax</code> is <code>FALSE</code> (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>
<p>The number of thresholds at which the model is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If a subset of the plots is required, specify a
subset of the numbers <code>1:npar</code>, where <code>npar</code> is
the number of parameters, so that <code>npar = 2</code> when
<code>model = "gpd"</code> (the default) and <code>npar = 3</code>
when <code>model = "pp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>The (pointwise) confidence coefficient for the
plotted confidence intervals. Use zero to suppress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>
<p>The line type and width of the line connecting
the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The form taken by the line connecting the parameter
estimates and the points denoting these estimates. Possible
values include <code>"b"</code> (the default) for points joined by
lines, <code>"o"</code> for overplotted points and lines, and
<code>"l"</code> for an unbroken line with no points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cilty</code></td>
<td>
<p>The line type of the lines depicting the
confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vci</code></td>
<td>
<p>If <code>TRUE</code> (the default), confidence intervals
are plotted using vertical lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, xlim</code></td>
<td>
<p>Label and limits for the x-axis; if given,
these arguments apply to every plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabs, ylims</code></td>
<td>
<p>A vector of y-axis labels and a matrix of
y-axis limits. If given, <code>ylabs</code> should have the same
length as <code>which</code>, and <code>ylims</code> should have two
columns and <code>length(which)</code> rows. If the length of
<code>which</code> is one, then <code>ylims</code> can be a vector of
length two.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the user is asked before
each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to the model fit
function <code>fpot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each of the <code>nt</code> thresholds a peaks over threshold model
is fitted using the function <code>fpot</code>. When <code>model = "gpd"</code>
(the default), the maximum likelihood estimates for the shape and the
modified scale parameter (modified by subtracting the shape multiplied
by the threshold) are plotted against the thresholds.
When <code>model = "pp"</code> the maximum likelihood estimates for the
location, scale and shape parameters are plotted against the
thresholds. (The modified scale parameter in the <code>"gpd"</code> case
is equivalent to the scale parameter in the <code>"pp"</code> case.)
If the threshold <code>u</code> is a valid threshold to be used for peaks
over threshold modelling, the parameter estimates depicted should
be approximately constant above <code>u</code>.
</p>


<h3>Value</h3>

<p>A list is invisibly returned. Each component is a matrix with
three columns giving parameter estimates and confidence limits.
</p>


<h3>Author(s)</h3>

<p>Stuart Coles and Alec Stephenson</p>


<h3>See Also</h3>

<p><code>fpot</code>, <code>mrlplot</code>,
<code>clusters</code></p>


<h3>Examples</h3>

<pre><code class="language-R">tlim &lt;- c(3.6, 4.2)
## Not run: tcplot(portpirie, tlim)
## Not run: tcplot(portpirie, tlim, nt = 100, lwd = 3, type = "l")
## Not run: tcplot(portpirie, tlim, model = "pp")
</code></pre>


</div>