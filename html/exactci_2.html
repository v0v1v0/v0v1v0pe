<div class="container">

<table style="width: 100%;"><tr>
<td>binom.exact</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exact tests with matching confidence intervals for single binomial parameter</h2>

<h3>Description</h3>

<p>Calculates exact p-values and confidence intervals for a single binomial parmeter. 
This is different from <code>binom.test</code> only when alternative='two.sided', in which 
case <code>binom.exact</code> gives three choices for tests based on the 'tsmethod' option. 
The resulting p-values and confidence intervals will match.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.exact(x, n, p = 0.5, 
   alternative = c("two.sided", "less", "greater"), 
   tsmethod = c("central", "minlike", "blaker"), 
   conf.level = 0.95, 
   control=binomControl(),plot=FALSE, midp=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>number of successes, or a vector of length 2 giving the
numbers of successes and failures, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of trials, ignored if x has length 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>hypothesized probability of success.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>indicates the alternative hypothesis and must be one of
"two.sided", "greater" or "less".  You can
specify just the initial letter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsmethod</code></td>
<td>

<p>indicates the method for a two-sided alternative hypothesis
and must be one of
"minlike", "central" or "blaker".  You can
specify just the initial letter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>confidence level for the returned confidence interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>list with settings to avoid problems with ties, etc, should not need to change this for normal use, 
see <code>binomControl</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, do basic plot of p-value function by null hypothesis value, see <code>exactbinomPlot</code> for more plot options
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midp</code></td>
<td>
<p>logical, use mid-p for p-values and confidence intervals? midp Confidence intervals are not available for tsmethod='minlike' and 'blaker'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Traditionally, hypothesis tests and confidence intervals are treated separately.
A more unified approach suggested by Hirji (2006) is to use the same p-value 
function to create confidence intervals. There is essentially only one way to 
calculate one-sided p-values and confidence intervals so these methods are the same 
in <code>binom.test</code> and <code>binom.exact</code>. However,  
there are three main ways that 
<code>binom.exact</code> allows for defining two-sided p-values.
</p>

<table>
<tr>
<td style="text-align: left;">
minlike: </td>
<td style="text-align: left;"> sum probabilities of all likelihoods equal or less than observed </td>
</tr>
<tr>
<td style="text-align: left;">
central: </td>
<td style="text-align: left;"> double minimum one-sided p-value </td>
</tr>
<tr>
<td style="text-align: left;">
blaker: </td>
<td style="text-align: left;"> combine smaller observed tail probability with opposite tail not greater than observed tail </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The 'minlike' method is the p-value that has been used in <code>binom.test</code>,
and 'blaker' is described in Blaker (2000) or Hirji (2006), where it is called the 
'combined tails' method. 
Once the p-value function is defined we can invert the test to create 'matching' 
confidence intervals defined as the smallest interval that contains all parameter values for which the two-sided
hypothesis test does not reject. There are some calculation issues for the 
'minlike' and 'blaker' methods which are the same as for exact tests 
for 2x2 tables (see Fay, 2010).
</p>
<p>All of the above traditional p-values can be thought of as estimating Pr[X=xobs or X is more extreme than xobs] under the null hypothesis, where more extreme is defined differently for different methods. The mid-p-value replaces this with 0.5*Pr[X=xobs]+ Pr[X is more extreme than xobs]. The mid-p p-values are not valid. In other words, for all parameter values under the null hypothesis we are not guaranteed to bound the type I error rate. However, the usual exact methods that guarantee the type I error rate are typically conservative for most parameter values in order to bound the type I error rate for all parameter values. So if you are interested in rejecting approximately on average about 5 percent of the time for arbitrary parameter values and n values under the null hypothesis, then use midp=TRUE. If you want to ensure bounding of the type I errror rate for all n and all parameter values use midp=FALSE. (See for example, Vollset, 1993, or Hirji, 2006). 
</p>
<p>The associated midp confidence intervals have not been programmed for tsmethod='blaker' and 'minlike'. 
</p>


<h3>Value</h3>

<p>An object of class 'htest': a list with items
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p> confidence interval, see attributes 'conf.level' and perhaps 'conf.limit.prec' </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p> number of successes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>number of trials</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>observed proportion of success</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>null hypothesis probability of success, 'p'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string  describing method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The 'central' method gives the Clopper-Pearson intervals, and the 'minlike'
method gives confidence intervals proposed by Stern (1954) (see Blaker, 2000).
The 'blaker' method is guaranteed to be more powerful than the 
'central' method (see Blaker, 2000, Corollary 1), 
but both the 'blaker' method and 'minlike' method may have 
some undesireable properties. For example, there are cases where adding an 
additional  Bernoulli observation REGARDLESS OF THE RESPONSE will increase the p-value,
see Vos and Hudson (2008). The 'central' method does not have 
those undesireable properties.
</p>
<p>The Blyth-Still-Casella intervals  given in StatXact (and not by <code>binom.exact</code>) are the shortest possible 
intervals, but those intervals are not nested. This means that the Blyth-Still-Casella 
intervals are not guaranteed 
to have the 95 percent interval contain the 90 percent interval. See Blaker (2000) Theorem 2.   
</p>


<h3>Author(s)</h3>

<p>M.P. Fay
</p>


<h3>References</h3>

<p>Blaker, H. (2000) Confidence curves and improved exact confidence intervals for discrete distributions.
Canadian Journal of Statistics 28: 783-798.
</p>
<p>Fay, M. P. (2010). Confidence intervals that Match Fisher's exact and Blaker's exact tests.
Biostatistics. 11:373-374.
</p>
<p>Fay, M.P. (2010). Two-sided Exact Tests and Matching Confidence Intervals for Discrete Data. R Journal 2(1): 53-58.
</p>
<p>Hirji K. F. (2006). Exact analysis of discrete data. Chapman and Hall/CRC. New York.
</p>
<p>Stern, T (1954). Some remarks on confidence and fiducial limits.
Biometrika, 275-278.
</p>
<p>Vollset, S. E. (1993). Confidence intervals for a binomial proportion. Statistics in medicine, 12(9), 809-824.
</p>
<p>Vos, P.W. and Hudson, S. (2008). Problems with binomial two-sided tests and the associated
confidence interals. Aust. N.Z. J. Stat. 50: 81-89.
</p>


<h3>See Also</h3>

<p><code>binom.test</code>, for two-sample exact binomial tests see <code>exact2x2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Notice how binom.test p-value is given by tsmethod='minlike'
## but the confidence interval is given by tsmethod='central'
## in binom.exact p-values and confidence intervals match
binom.test(10,12,p=20000/37877)
binom.exact(10,12,p=20000/37877,tsmethod="minlike")
binom.exact(10,12,p=20000/37877,tsmethod="central")
binom.exact(10,12,p=20000/37877,tsmethod="blaker")
## one-sided methods are also available
## as in binom.test

</code></pre>


</div>