<div class="container">

<table style="width: 100%;"><tr>
<td>STEP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Stepwise selection of logratios
</h2>

<h3>Description</h3>

<p>Stepwise selection of pairwise logratios that explain maximum variance in a target matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">STEP(data, datatarget=data, previous=NA, previous.wt=NA, weight=TRUE, 
     random=FALSE, nsteps=min(ncol(data), ncol(datatarget))-1, top=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame or matrix of compositional data on which pairwise logratios are computed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatarget</code></td>
<td>

<p>A matrix of interval-scale data, with as many rows as <code>data</code>, which serves as the target matrix whose variance is to be explained (by default it is the same matrix as data, in which case total logratio variance is to be explained)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous</code></td>
<td>

<p>A vector or matrix of variables to be forced in before logratios are sought
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous.wt</code></td>
<td>

<p>Possible weights of the variable(s) forced in before logratios are sought (if not specified, weights of 1 are assumed)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p><code>TRUE</code> (default) when weights are in data list object, <code>FALSE</code> for unweighted analysis, or a vector of user-defined part weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p><code>TRUE</code> if a random selection is made of tied logratios; <code>FALSE</code> (default) if logratio that maximizes Procrustes correlation is chosen  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps</code></td>
<td>

<p>Number of steps to take (by default, one less than the number of columns of data and of datatarget, whichever is smaller)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top</code></td>
<td>

<p>Number of top variance-explaining logratios returned after last step (by default, 1, i.e. the best) 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>STEP</code> sequentially computes the logratios in a data matrix (usually compositional) that best explain the variance in a second matrix, called the target matrix.  By default, the target matrix is the same matrix, in which case the logratios that best explain the logratio variance in the same matrix are computed.
In this case, weights for the data matrix are assumed by default, proportional to part means of the compositional data matrix.
For the unweighted logratio variance, specify the option <code>weight=FALSE</code>. 
User-specified weights on the columns of the data matrix (usually compositional parts) can be provided using the same <code>weight</code> option. 
</p>
<p>If the target matrix is a different matrix, it is the logratio variance of that matrix that is to be explained.
An option for the target matrix to be any response matrix will be in the next release.
</p>
<p>If <code>nsteps &gt; 1</code> and <code>top=1</code> the results are in the form of an optimal set of logratios that sequentially add maximum explained variance at each step.  
If <code>top&gt;1</code> then at the last step the ordered list of top variance-explaining logratios is returned, which allows users to make an alternative choice of the logratio based on substantive knowledge. Hence, if <code>nsteps=1</code> and <code>top=10</code>, for example, the procedure will move only one step, but list the top 10 logratios for that step.  If <code>top=1</code> then all results with extension <code>.top</code> related to the top ratios are omitted because they are already given.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>names        </code></td>
<td>
<p>Names of maximizing ratios in stepwise process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratios       </code></td>
<td>
<p>Indices of ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logratios    </code></td>
<td>
<p>Matrix of logratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2max        </code></td>
<td>
<p>Sequence of maximum cumulative explained variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pro.cor      </code></td>
<td>
<p>Corresponding sequence of Procrustes correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.top    </code></td>
<td>
<p>Names of "top" ratios at last step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratios.top   </code></td>
<td>
<p>Indices of "top" ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logratios.top</code></td>
<td>
<p>Matrix of "top" logratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2.top       </code></td>
<td>
<p>Sequence of "top" cumulative explained variances (in descending order)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pro.cor.top  </code></td>
<td>
<p>Corresponding sequence of "top" Procrustes correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totvar       </code></td>
<td>
<p>Total logratio variance of target matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Van den Wollenbergh, A. (1977), Redundancy analysis. An alternative to canonical correlation analysis, Psychometrika 42, 207-219.<br>
Greenacre, M. (2018), Variable selection in compositional data analysis using pairwise logratios, Mathematical Geosciences, DOI: 10.1007/s11004-018-9754-x. <br>
Greenacre, M. (2018), Compositional Data Analysis in Practice, Chapman &amp; Hall / CRC
</p>


<h3>See Also</h3>

<p><code>PLOT.RDA</code>, <code>CLR</code>, <code>LR</code>, <code>ALR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Stepwise selection of ratios for RomanCups data set
data(cups)
# Set seed to obtain same results as in Appendix C of Greenacre (2018)
set.seed(2872)
STEP(cups, random=TRUE)
# Select best ratio, but output "top 5"
STEP(cups, nsteps=1, top=5)
</code></pre>


</div>