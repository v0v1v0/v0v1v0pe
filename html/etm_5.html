<div class="container">

<table style="width: 100%;"><tr>
<td>closPseudo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pseudo Value Regression for the Extra Length-of-Stay
</h2>

<h3>Description</h3>

<p>Pseudo Value Regression for the Extra Length-of-Stay
</p>


<h3>Usage</h3>

<pre><code class="language-R">closPseudo(data, state.names, tra, cens.name, s = 0,
           formula, na.action,
           aw = FALSE, ratio = FALSE,
           ncores = 1,
           trick_ties = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data.frame of the form data.frame(id,from,to,time)
or (id,from,to,entry,exit)
</p>

<dl>
<dt>id:</dt>
<dd>
<p>patient id</p>
</dd>
<dt>from:</dt>
<dd>
<p>the state from where the transition occurs</p>
</dd>
<dt>to:</dt>
<dd>
<p>the state to which a transition occurs</p>
</dd>
<dt>time:</dt>
<dd>
<p>time when a transition occurs</p>
</dd>
<dt>entry:</dt>
<dd>
<p>entry time in a state</p>
</dd>
<dt>exit:</dt>
<dd>
<p>exit time from a state</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tra</code></td>
<td>
<p>A quadratic matrix of logical values describing the possible
transitions within the multistate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.name</code></td>
<td>
<p> A character giving the code for censored
observations in the column 'to' of <code>data</code>. If there is no
censored observations in your data, put 'NULL'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Starting value for computing the transition probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula with the covariates at the right of a
<code>~</code> operator. Leave the left part empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function which indicates what should happen when the data
contain 'NA's.  The default is set by the 'na.action' setting
of 'options', and is 'na.fail' if that is unset.  The
'factory-fresh' default is 'na.omit'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aw</code></td>
<td>
<p>Logical. Whether to compute the expected change of LOS using
alternative weighting. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>Logical. Compute the ratio of the expected length-of-stay
given instermediate event status instead of a difference. Default
value is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores used if doing parallel computation using
the <span class="pkg">parallel</span> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trick_ties</code></td>
<td>
<p>If <code>TRUE</code>, pseudo values are computed only one
per subject sharing the same entry, exit times / transition types.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates the pseudo-observations for the extra
length-of-stay for each individual. These pseudo-observations can then
be used to fit a direct regression model using generalized estimating
equation (e.g., package <span class="pkg">geepack</span>).
</p>
<p>Computation of the pseudo-observations can be parallelised using the
<code>mclapply</code> function of the <span class="pkg">parallel</span> package. See argument
<code>ncores</code>.
</p>
<p>Recent versions of R have changed the <code>data.frame</code> function,
where the default for the <code>stringsAsFactors</code>
argument from <code>TRUE</code> to <code>FALSE</code>. <code>etm</code> currently
depends on the states being factors, so that the user should use
<code>data.frame(..., stringsAsFactors=TRUE)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>closPseudo</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pseudoData</code></td>
<td>
<p>a data.frame containing <code>id</code>, computed pseudo
values (see details) and the covariates as specified in the formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Estimates of excess LoS in the whole sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aw</code></td>
<td>
<p>like in the function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Function call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>References</h3>

<p>Andersen, P.K, Klein, J.P, Rosthoj, S. (2003). Generalised
linear  models for correlated pseudo-observations,
with applications to multi-state models. <em>Biometrika</em>,
90(1):15â€“27.
</p>


<h3>See Also</h3>

<p><code>mclapply</code>, <code>clos</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require("kmi", quietly = TRUE)) {

    ## data in kmi package
    data(icu.pneu)
    my.icu.pneu &lt;- icu.pneu
    
    my.icu.pneu &lt;- my.icu.pneu[order(my.icu.pneu$id, my.icu.pneu$start), ]
    masque &lt;- diff(my.icu.pneu$id)
    
    my.icu.pneu$from &lt;- 0
    my.icu.pneu$from[c(1, masque) == 0] &lt;- 1
    
    my.icu.pneu$to2 &lt;- my.icu.pneu$event
    my.icu.pneu$to2[my.icu.pneu$status == 0] &lt;- "cens"
    my.icu.pneu$to2[c(masque, 1) == 0] &lt;- 1
    
    
    my.icu.pneu$to &lt;- ifelse(my.icu.pneu$to2 %in% c(2, 3), 2,
                             my.icu.pneu$to2)

    my.icu.pneu &lt;- my.icu.pneu[, c("id", "start", "stop", "from", "to",
                                   "to2", "age", "sex")]
    names(my.icu.pneu)[c(2, 3)] &lt;- c("entry", "exit")

    ## computation of the pseudo-observations
    ## Not run: 
        ps.icu.pneu &lt;- closPseudo(my.icu.pneu, c("0", "1", "2"), tra_ill(), "cens",
                                  formula = ~ sex + age)
        
        ## regression model using geepack
        require(geepack)
        fit &lt;- geeglm(ps.e.phi ~ sex + age, id = id, data = ps.icu.pneu$pseudoData,
                      family = gaussian)
        
        summary(fit)
    
## End(Not run)
} else {
    print("This example requires the kmi package")
}
</code></pre>


</div>