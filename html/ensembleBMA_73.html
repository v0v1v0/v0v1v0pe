<div class="container">

<table style="width: 100%;"><tr>
<td>fitBMAnormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
BMA mixture of normals fit to a training set
</h2>

<h3>Description</h3>

<p>Fits a Bayesian Model Averaging mixture of normals to a given training set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitBMAnormal( ensembleData, control = controlBMAnormal(),
              exchangeable = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and 
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAnormal</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal weights and parameters within each group.
If supplied, this argument will override any specification of 
exchangeability in <code>ensembleData</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a BMA model to a training data set. <br>
It is called by <code>ensembleBMAnormal</code>, which can produce a sequence
of fits over a larger data set.  <br>
Methods available for the output of <code>fitBMAnormal</code> include:
<code>cdf</code>, <code>quantileForecast</code>, and <code>modelParameters</code>. 
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>biasCoefs</code></td>
<td>

<p>The fitted bias-correction coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>

<p>The fitted standard deviations for the mixture of normals model
(equal or varying across components according to the <code>equalVariance</code>
setting in the <code>control</code> input).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the normal components for each ensemble member.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIter</code></td>
<td>

<p>The number of EM iterations.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian Model Averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155–1174, 2005</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190–202, 2010</em>.
</p>


<h3>See Also</h3>

<p><code>ensembleData</code>, 
<code>controlBMAnormal</code>, 
<code>ensembleBMAnormal</code>,
<code>cdf</code>,
<code>quantileForecast</code>,
<code>modelParameters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(ensBMAtest)

  ensNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                dates = ensBMAtest[,"vdate"],
                                forecastHour = 48,
                                initializationTime = "00")

  tempTrain &lt;- trainingData( tempTestData, trainingDays = 30,
                             date  = "2008010100")

  tempTrainFit &lt;- fitBMAnormal( tempTrain)
</code></pre>


</div>