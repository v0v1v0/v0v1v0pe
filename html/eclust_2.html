<div class="container">

<table style="width: 100%;"><tr>
<td>plot.eclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Heatmap of Cluster Summaries by Exposure Status</h2>

<h3>Description</h3>

<p>Plots cluster summaries such as the 1st principal component or
average by exposure status. This is a plot method for object of class
eclust returned by the <code>r_cluster_data</code> function. Two heatmaps,
side-by-side are returned, where the first heatmap corresponds to the
unexposed subjects and the second heatmap corresponds to the exposed
subjects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'eclust'
plot(x, type = c("ECLUST", "CLUST"), summary = c("pc",
  "avg"), sample = c("training", "test"), unexposed_title = "E=0",
  exposed_title = "E=1", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>eclust</code>, which is returned by the
<code>r_cluster_data</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>show results from the "ECLUST" (which considers the environment)
or "CLUST" (which ignores the environment) methods. Default is "ECLUST".
See <code>r_cluster_data</code> for details. This function uses the
<code>clustersAddon</code> object for "ECLUST" and the <code>clustersAll</code> for
"CLUST"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>show the 1st principal component or the average of each
cluster. Default is "pc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>which sample to show, the "training" or the "test" set. Default
is "training". This is determined by the <code>train_index</code> and
<code>test_index</code> arguments in the <code>r_cluster_data</code> function.
If you want to show all subjects, then provide the numeric vector 1:n to
either argument, where n is the entire sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unexposed_title</code></td>
<td>
<p>The title for the unexposed subjects heatmap. Default
is "E=0".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposed_title</code></td>
<td>
<p>The title for the exposed subjects heatmap. Default is
"E=1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to the
<code>Heatmap</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rows are the cluster summaries and columns are the subjects. This
function determines the minimum and maximum value for the whole dataset and
then creates a color scale using those values with the
<code>colorRamp2</code>. This is so that both heatmaps are on
the same color scale, i.e., each color represents the same value in both
heatmaps. This is done for being able to visually compare the results.
</p>


<h3>Value</h3>

<p>a plot of two Heatmaps, side-by-side, of the cluster summaries by exposure status
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("tcgaov")
tcgaov[1:5,1:6, with = FALSE]
Y &lt;- log(tcgaov[["OS"]])
E &lt;- tcgaov[["E"]]
genes &lt;- as.matrix(tcgaov[,-c("OS","rn","subtype","E","status"),with = FALSE])
trainIndex &lt;- drop(caret::createDataPartition(Y, p = 1, list = FALSE, times = 1))
testIndex &lt;- setdiff(seq_len(length(Y)),trainIndex)

cluster_res &lt;- r_cluster_data(data = genes,
                              response = Y,
                              exposure = E,
                              train_index = trainIndex,
                              test_index = testIndex,
                              cluster_distance = "tom",
                              eclust_distance = "difftom",
                              measure_distance = "euclidean",
                              clustMethod = "hclust",
                              cutMethod = "dynamic",
                              method = "average",
                              nPC = 1,
                              minimum_cluster_size = 60)

class(cluster_res)

plot(cluster_res, show_column_names = FALSE)

## End(Not run)
</code></pre>


</div>