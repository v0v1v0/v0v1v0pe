<div class="container">

<table style="width: 100%;"><tr>
<td>coef.ecpc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Obtain coefficients from 'ecpc' object
</h2>

<h3>Description</h3>


<p>Obtain regression coefficients or penalties from an existing model fit given in an 'ecpc' object,
re-estimate regression coefficients for a given 'ecpc' object and ridge
penalties, or obtain ridge penalties for given prior parameters and co-data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ecpc'
coef(object, penalties = NULL, 
          X = NULL, Y = NULL, 
          unpen = NULL, intrcpt = TRUE, 
          model = c("linear", "logistic", "cox"), 
          est_beta_method = c("glmnet", "multiridge"), ...)

penalties(object, tauglobal=NULL, sigmahat=NULL, gamma=NULL, gamma0=NULL, w=NULL,
          Z=NULL, groupsets=NULL,
          unpen=NULL, datablocks=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>


<p>An 'ecpc' object returned by <code>ecpc</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalties</code></td>
<td>


<p>Ridge penalties; p-dimensional vector. If provided to <code>coef.ecpc</code>, 'X' and 'Y' should be provided too.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauglobal</code></td>
<td>

<p>Estimated global prior variance; scalar (or vector with datatype-specific global prior variances when multiple ‘datablocks’ are given).) If provided to <code>penalties</code>, 'Z' or 'groupsets' should be provided too.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmahat</code></td>
<td>
<p>(linear model) Estimated sigma^2. If provided to <code>penalties</code>, 'Z' or 'groupsets' should be provided too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Estimated co-data variable weights; vector of dimension the total number of groups. If provided to <code>penalties</code>, 'Z' or 'groupsets' should be provided too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma0</code></td>
<td>
<p>Estimated co-data variable intercept; scalar. If provided to <code>penalties</code>, 'Z' or 'groupsets' should be provided too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Estimated group set weights; m-dimensional vector. If provided to <code>penalties</code>, 'Z' or 'groupsets' should be provided too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>


<p>Observed data; (nxp)-dimensional matrix (p: number of covariates) with each row the observed high-dimensional feature vector of a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>


<p>Response data; n-dimensional vector (n: number of samples) for linear and logistic outcomes, or <code>Surv</code> object for Cox survival.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>List with m co-data matrices. Each element is a (pxG)-dimensional co-data matrix containing co-data on the p   variables. Co-data should either be provided in ‘Z’ or ‘groupsets’. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupsets</code></td>
<td>


<p>Co-data group sets; list with m (m: number of group sets) group sets. Each group set is a list of all groups in that set. Each group is a vector containing the indices of the covariates in that group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unpen</code></td>
<td>


<p>Unpenalised covariates; vector with indices of covariates that should not be penalised.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intrcpt</code></td>
<td>


<p>Should an intercept be included? Included by default for linear and logistic, excluded for Cox for which the baseline hazard is estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>


<p>Type of model for the response; linear, logistic or cox.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_beta_method</code></td>
<td>

<p>Package used for estimating regression coefficients, either "glmnet" or "multiridge".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datablocks</code></td>
<td>


<p>(optional) for multiple data types, the corresponding blocks of data may be given in datablocks; a list of B vectors of the indices of covariates in ‘X’ that belong to each of the B data blocks. Unpenalised covariates should not be given as seperate block, but can be omitted or included in blocks with penalised covariates. Each datatype obtains a datatype-specific ‘tauglobal’ as in multiridge.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters</p>
</td>
</tr>
</table>
<h3>Value</h3>






<p>For <code>coef.ecpc</code>, a list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>If included, the estimated intercept; scalar.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>Estimated regression coefficients; p-dimensional vector.
</p>
</td>
</tr>
</table>
<p>For <code>penalties</code>: a p-dimensional vector with ridge penalties.
</p>


<h3>See Also</h3>


<p><code>penalties</code> for obtaining penalties for given prior parameters and co-data.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
#####################
# Simulate toy data #
#####################
p&lt;-300 #number of covariates
n&lt;-100 #sample size training data set
n2&lt;-100 #sample size test data set

#simulate all betas i.i.d. from beta_k~N(mean=0,sd=sqrt(0.1)):
muBeta&lt;-0 #prior mean
varBeta&lt;-0.1 #prior variance
indT1&lt;-rep(1,p) #vector with group numbers all 1 (all simulated from same normal distribution)

#simulate test and training data sets:
Dat&lt;-simDat(n,p,n2,muBeta,varBeta,indT1,sigma=1,model='linear') 
str(Dat) #Dat contains centered observed data, response data and regression coefficients

###################
# Provide co-data #
###################
continuousCodata &lt;- abs(Dat$beta) 
Z1 &lt;- cbind(continuousCodata,sqrt(continuousCodata))

#setting 2: splines for informative continuous
Z2 &lt;- createZforSplines(values=continuousCodata)
S1.Z2 &lt;- createS(orderPen=2, G=dim(Z2)[2]) #create difference penalty matrix
Con2 &lt;- createCon(G=dim(Z2)[2], shape="positive+monotone.i") #create constraints

#setting 3: 5 random groups
G &lt;- 5
categoricalRandom &lt;- as.factor(sample(1:G,p,TRUE))
#make group set, i.e. list with G groups:
groupsetRandom &lt;- createGroupset(categoricalRandom)
Z3 &lt;- createZforGroupset(groupsetRandom,p=p)
S1.Z3 &lt;- createS(G=G, categorical = TRUE) #create difference penalty matrix
Con3 &lt;- createCon(G=dim(Z3)[2], shape="positive") #create constraints

#fit ecpc for the three co-data matrices with following penalty matrices and constraints
#note: can also be fitted without paraPen and/or paraCon
Z.all &lt;- list(Z1=Z1,Z2=Z2,Z3=Z3)
paraPen.all &lt;- list(Z2=list(S1=S1.Z2), Z3=list(S1=S1.Z3))
paraCon &lt;- list(Z2=Con2, Z3=Con3)

############
# Fit ecpc #
############
tic&lt;-proc.time()[[3]]
fit &lt;- ecpc(Y=Dat$Y,X=Dat$Xctd,
           Z = Z.all, paraPen = paraPen.all, paraCon = paraCon,
           model="linear",maxsel=c(5,10,15,20),
           Y2=Dat$Y2,X2=Dat$X2ctd)
toc &lt;- proc.time()[[3]]-tic

#estimate coefficients for twice as large penalties
new_coefficients &lt;- coef(fit, penalties=fit$penalties*2, X=Dat$Xctd, Y=Dat$Y)

#change some prior parameters and find penalties
gamma2 &lt;- fit$gamma; gamma2[1:3] &lt;- 1:3
new_penalties &lt;- penalties(fit, gamma=gamma2, Z=Z.all)
new_coefficients2 &lt;- coef(fit, penalties=new_penalties, X=Dat$Xctd, Y=Dat$Y)


</code></pre>


</div>