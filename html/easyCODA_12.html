<div class="container">

<table style="width: 100%;"><tr>
<td>FINDALR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Find the best ALR transformation
</h2>

<h3>Description</h3>

<p>Searching over every possible reference part for choosing an optimal ALR transformation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FINDALR(data, weight=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Compositional data matrix, with the parts as columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>FALSE (default) for equally weighted parts, TRUE when weights are in data list object, or a vector of user-defined part weights
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>FINDALR</code> considers every possible set of additive logratio (ALR) transformations, by trying each of the references. For each set the closeness to isometry is measured by the Procrustes correlation. In addition, the variance of the log-transformed reference is also computed. The reference with highest Procrustes correlation and the reference with the lowest variance of its log-transform are identified. The number of ALRs computed is equal to 1 less than the number of rows or columns, whichever is the smallest.
</p>


<h3>Value</h3>

<p>An object which describes the tree produced by the clustering process on the n objects. The object is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>totvar</code></td>
<td>
<p>Total logratio variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>procrust.cor </code></td>
<td>
<p>The Procrustes correlations of the ALRs using each reference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>procrust.max</code></td>
<td>
<p>The value of the highest Procrustes correlation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>procrust.ref</code></td>
<td>
<p>The reference corresponding to the highest correlation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.log</code></td>
<td>
<p>Variances of the log-transformed references</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.min</code></td>
<td>
<p>The value of the lowest variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.ref</code></td>
<td>
<p>The reference corresponding to the lowest variance</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Greenacre, M., Martinez-Alvaro, M. and Blasco, A. (2021), Compositional data analysis of microbiome and any-omics datasets: a validation of the additive logratio transformation, Frontiers in Microbiology 12: 2625 <br>
Gower, J. and Dijksterhuis, G.B. (2004), Procrustes Problems. Oxford University Press   <br>
Greenacre, M. (2018), Compositional Data Analysis in Practice, Chapman &amp; Hall / CRC
</p>


<h3>See Also</h3>

<p><code>ALR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For the fish morphometric data, first close (normalize) 
# then loop over the 26 possible references
data(fish)
FINDALR(CLOSE(fish[,4:29]))
# Note that for the default option weight=FALSE closing the data is not necessary
</code></pre>


</div>