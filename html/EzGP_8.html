<div class="container">

<table style="width: 100%;"><tr>
<td>LEzGP_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Fitting Function of <code>LEzGP</code> Model</h2>

<h3>Description</h3>

<p>Fits a Localized Easy-to-Interpret Gaussian process (LEzGP) model to a dataset as described in <code>reference 1</code>.
The input variables are mixed (with both quantitative and qualitative inputs)
The output variable is quantitative and scalar.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LEzGP_fit(
  X,
  Y,
  p,
  q,
  m,
  tar_z,
  ns,
  models = 1,
  tau = 0,
  lb = "T",
  ub = "T",
  x0 = "T",
  xtol_rel = 1e-05,
  maxeval = 100,
  algorithm = "NLOPT_LD_LBFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector containing the outputs of training data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A vector containing numbers of levels in qualitative factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tar_z</code></td>
<td>
<p>A vector containing the qualitative part of the chosen target input (described in <code>reference 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>The chosen tuning parameter (described in <code>reference 1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>The model for fitting the selected proper subset of the dataset <code>X</code>. 0 for EzGP model, 1 for EEzGP model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>Vector with lower bounds of the parameter estimation. "T" for applying the default setting of lb (a vector of length number of parameters whose elements are all 0.1), otherwise one must provide a vector with the length being the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>Vector with upper bounds of the parameter estimation. "T" for applying the default setting of ub (a vector of length number of parameters whose first <code>q+1</code> elements are 100 and the rest <code>number of parameters - q - 1</code> elements are 10), otherwise one must provide a vector with length of the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>Vector with starting values for the optimization. "T" for applying the default setting of x0 (a vector made by <code>(lb + ub)/2</code>), otherwise one must provide a vector with length being the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtol_rel</code></td>
<td>
<p>Stopping criterion for relative change reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxeval</code></td>
<td>
<p>Termination condition by specifying a maximum number of function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>Optimization algorithm. See <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">NLopt Algorithms</a> for more availiable algorithms.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A model of class "LEzGP model" list of the following items:
</p>

<ul>
<li>
<p><code>param</code> A list containing the estimated parameters
</p>
</li>
<li>
<p><code>data</code> A list containing the fitted dataset and the information for fitting
</p>
</li>
</ul>
<h3>References</h3>


<ol><li>
<p> "EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors", Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>
<h3>See Also</h3>

<p><code>EzGP_predict</code> to use the fitted EzGP model for prediction if your LEzGP model is fitted based on the EzGP model.<br><code>EEzGP_predict</code> to use the fitted EEzGP model for prediction if your LEzGP model is fitted based on the EEzGP model.<br></p>


<h3>Examples</h3>

<pre><code class="language-R"># Example with 9 quantitative and 9 qualitative variables (dataset included in the package):
#     Fit a LEzGP model based on the EEzGP/EzGP model(with default settings), and then
#     perform the prediction.
p = 9
q = 9
m=rep(3,9)
tau = 0
X = LEzGP_data[1:60, 1:(p+q)]
Y = LEzGP_data[1:60, p+q+1]
X_new = LEzGP_data[61:70, 1:(p+q)]
tar_z = X_new[1, (p+1):(p+q)]
ns = 7
# LEzGP Model Based on EEzGP Model
model &lt;- LEzGP_fit(X, Y, p, q, m, tar_z, ns)
y_hat &lt;- EEzGP_predict(X_new, model)
# Results showing
model
y_hat
</code></pre>


</div>