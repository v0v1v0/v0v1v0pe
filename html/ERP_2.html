<div class="container">

<table style="width: 100%;"><tr>
<td>emfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expectation-Maximization (EM) estimation of a factor model.</h2>

<h3>Description</h3>

<p>This function implements the EM algorithm by Thayer and Rubin (1982) for the ML estimation of a factor model. It is an 
internal function used to estimate the factor model parameters in the factor-adjustment methods.</p>


<h3>Usage</h3>

<pre><code class="language-R">emfa(dta, nbf, min.err = 1e-06, verbose = FALSE, svd.method = c("fast.svd", "irlba"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dta</code></td>
<td>
<p>n x m matrix which rows are multivariate m-profiles for n individuals. n can be much smaller than m.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbf</code></td>
<td>
<p>number of factors. It has to be a positive integer, smaller than the rank of <code>dta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.err</code></td>
<td>
<p>stopping criterion for the iterative algorithm. Maximum difference between the estimated parameters in the last two iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical value. If <code>verbose</code>=TRUE, then some information is printed along the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svd.method</code></td>
<td>
<p>the EM algorithm starts from an SVD estimation of the factor model parameters. The default option to implement this 
SVD is <code>fast.svd</code>. An alternative option is an approximate but faster SVD by function 
<code>irlba</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data are centered but not scaled. If a factor model for a correlation matrix is to be estimated, then a scaled dataset is required as 
an input of the function.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>m x <code>nbf</code> matrix of loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>m-vector of specific variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Factors</code></td>
<td>
<p>n x <code>nbf</code> matrix of factor scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Objective</code></td>
<td>
<p>Final value of the stopping criterion, after convergence.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Causeur, IRMAR, UMR 6625 CNRS, Agrocampus Ouest, Rennes, France.
</p>


<h3>References</h3>

<p>Friguet, C., Kloareg, M. and Causeur, D. (2009). A factor model approach to multiple testing under dependence. 
Journal of the American Statistical Association. 104 (488), 1406-1415.
</p>
<p>Rubin, D. B., and Thayer, D. T. (1982), EM Algorithms for ML Factor Analysis, Psychometrika, 47 (1), 69-76.
</p>


<h3>See Also</h3>

<p><code>factanal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(impulsivity)

erpdta = as.matrix(impulsivity[,5:505]) # erpdta contains the whole set of ERP curves  
   
fa = emfa(erpdta,nbf=1) # 1-factor modelling of the ERP curves
fa$Objective            # Final difference between the last two iterations
Semp = var(erpdta)      # Sample estimation of the variance of ERP curves
Sfa = diag(fa$Psi)+tcrossprod(fa$B) # Factorial estimation of the variance 
max(abs(Semp-Sfa))      # Distance between the two estimates 

fa = emfa(erpdta,nbf=20) # 20-factor modelling of the ERP curves in erpdta
fa$Objective             # Final difference between the last two iterations
Semp = var(erpdta)       # Sample estimation of the variance of ERP curves
Sfa = diag(fa$Psi)+tcrossprod(fa$B) # Factorial estimation of the variance 
max(abs(Semp-Sfa))       # Distance between the two estimates

</code></pre>


</div>