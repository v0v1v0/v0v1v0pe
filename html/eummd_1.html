<div class="container">

<table style="width: 100%;"><tr>
<td>energydist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Naive computation for Energy Distance</h2>

<h3>Description</h3>

<p>Computes energy distance, and possibly a p-value.
Suitable for multivariate data. Naive approach, quadratic in number
of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">energydist(
  X,
  Y,
  pval = TRUE,
  numperm = 200,
  seednum = 0,
  alternative = c("greater", "two.sided"),
  allowzeropval = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix (or vector) of observations in first sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix (or vector) of observations in second sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Boolean for whether to compute p-value or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numperm</code></td>
<td>
<p>Number of permutations. Default is <code>200</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seednum</code></td>
<td>
<p>Seed number for generating permutations. Default is <code>0</code>,
which means seed is set randomly. For values larger than
<code>0</code>, results will be reproducible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis,
which must be either <code>"greater"</code> (default) or
<code>"two.sided"</code>. In Gretton et al., the
MMD test statistic is specified so that if it is
significantly larger than zero, then the null hypothesis
that the two samples come from the same distribution
should be rejected. For this reason, <code>"greater"</code>
is recommended. The test will still work
in many cases with <code>"two.sided"</code> specified, but this
could lead to problems in certain cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowzeropval</code></td>
<td>
<p>A boolean, specifying whether we will allow zero
p-values or not. Default is <code>FALSE</code>; then
a threshold of <code>0.5 / (numperm+1)</code> is used,
and if the computed p-value is less than this
threshold, it is then set to be this value.
this avoids the possibility of zero p-values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First checks number of columns (dimension) are equal.
Suppose matrix <code class="reqn">X</code> has <code class="reqn">n</code> rows and <code class="reqn">d</code> columns,
and matrix <code class="reqn">Y</code> has <code class="reqn">m</code> rows; checks that <code class="reqn">Y</code>
has <code class="reqn">d</code> columns (if not, then throws error).
Then flattens matrices to vectors (or, if <code class="reqn">d=1</code>, they are
already vectors.
Then calls C++ method. If the first sample has <code class="reqn">n</code>
<code class="reqn">d</code>-dimensional samples and the second sample has
<code class="reqn">m</code> <code class="reqn">d</code>-dimensional samples, then the algorithm
computes the statistic in <code class="reqn">O((n+m)^2)</code> time.
</p>
<p>Random seed is set for <code>std::mt19937</code> and <code>std::shuffle</code> in C++.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<dl>
<dt><code>pval</code></dt>
<dd>
<p>The p-value of the test, if it is
computed (<code>pval=TRUE</code>). </p>
</dd>
<dt><code>stat</code></dt>
<dd>
<p>The statistic of the test, which
is always computed. </p>
</dd>
</dl>
<h3>References</h3>

<p>Baringhaus L. and Franz C. (2004) "On a new multivariate two-sample test."
Journal of multivariate analysis 88(1):190-206
</p>
<p>Szekely G. J. and Rizzo M. L. (2004) "Testing for equal distributions in
high dimension." InterStat 5(16.10):1249-1272
</p>


<h3>Examples</h3>

<pre><code class="language-R">
X &lt;- matrix(c(1:12), ncol=2, byrow=TRUE)
Y &lt;- matrix(c(13:20), ncol=2, byrow=TRUE)
energydistList &lt;- energydist(X=X, Y=Y, pval=FALSE)

#computing p-value
energydistList &lt;- energydist(X=X, Y=Y)

#computing p-value
#using 1000 permutations and seed 1 for reproducibility.
energydistList &lt;- energydist(X=X, Y=Y, numperm=1000, seednum=1)


</code></pre>


</div>