<div class="container">

<table style="width: 100%;"><tr>
<td>disco</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> distance components (DISCO)</h2>

<h3>Description</h3>

<p>E-statistics DIStance COmponents and tests, analogous to variance components
and anova.
</p>


<h3>Usage</h3>

<pre><code class="language-R">disco(x, factors, distance, index=1.0, R, method=c("disco","discoB","discoF"))
disco.between(x, factors, distance, index=1.0, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data matrix or distance matrix or dist object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p> matrix or data frame of factor labels or integers (not design matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p> logical, TRUE if x is distance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p> exponent on Euclidean distance in (0,2]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of replicates for a permutation test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> test statistic </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>disco</code> calculates the distance components decomposition of
total dispersion and if R &gt; 0 tests for significance using the test statistic
disco "F" ratio (default <code>method="disco"</code>),
or using the between component statistic (<code>method="discoB"</code>),
each implemented by permutation test.
</p>
<p>If <code>x</code> is a <code>dist</code> object, argument <code>distance</code> is
ignored. If <code>x</code> is a distance matrix, set <code>distance=TRUE</code>. 
</p>
<p>In the current release <code>disco</code> computes the decomposition for one-way models
only.
</p>


<h3>Value</h3>

<p>When <code>method="discoF"</code>, <code>disco</code> returns a list similar to the
return value from <code>anova.lm</code>, and the <code>print.disco</code> method is
provided to format the output into a similar table. Details:
</p>
<p><code>disco</code> returns a class <code>disco</code> object, which is a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>vector of observed statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>vector of p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between</code></td>
<td>
<p>between-sample distance components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withins</code></td>
<td>
<p>one-way within-sample distance components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within</code></td>
<td>
<p>within-sample distance component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>total dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df.trt</code></td>
<td>
<p>degrees of freedom for treatments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df.e</code></td>
<td>
<p>degrees of freedom for error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>index (exponent on distance)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.names</code></td>
<td>
<p>factor names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.levels</code></td>
<td>
<p>factor levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.sizes</code></td>
<td>
<p>sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>matrix containing decomposition</p>
</td>
</tr>
</table>
<p>When <code>method="discoB"</code>, <code>disco</code> passes the arguments to
<code>disco.between</code>, which returns a class <code>htest</code> object.
</p>
<p><code>disco.between</code> returns a class <code>htest</code> object, where the test
statistic is the between-sample statistic (proportional to the numerator of the F ratio
of the <code>disco</code> test.
</p>


<h3>Note</h3>

<p>The current version does all calculations via matrix arithmetic and
boot function. Support for more general additive models
and a formula interface is under development.
</p>
<p><code>disco</code> methods have been added to the cluster distance summary
function <code>edist</code>, and energy tests for equality of distribution
(see <code>eqdist.etest</code>).
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and Gabor J. Szekely
</p>


<h3>References</h3>

<p>M. L. Rizzo and G. J. Szekely (2010).
DISCO Analysis: A Nonparametric Extension of
Analysis of Variance, Annals of Applied Statistics,
Vol. 4, No. 2, 1034-1055.
<br><a href="https://doi.org/10.1214/09-AOAS245">doi:10.1214/09-AOAS245</a>
</p>


<h3>See Also</h3>

<p><code> edist </code>
<code> eqdist.e </code>
<code> eqdist.etest </code>
<code> ksample.e </code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">      ## warpbreaks one-way decompositions
      data(warpbreaks)
      attach(warpbreaks)
      disco(breaks, factors=wool, R=99)
      
      ## warpbreaks two-way wool+tension
      disco(breaks, factors=data.frame(wool, tension), R=0)

      ## warpbreaks two-way wool*tension
      disco(breaks, factors=data.frame(wool, tension, wool:tension), R=0)

      ## When index=2 for univariate data, we get ANOVA decomposition
      disco(breaks, factors=tension, index=2.0, R=99)
      aov(breaks ~ tension)

      ## Multivariate response
      ## Example on producing plastic film from Krzanowski (1998, p. 381)
      tear &lt;- c(6.5, 6.2, 5.8, 6.5, 6.5, 6.9, 7.2, 6.9, 6.1, 6.3,
                6.7, 6.6, 7.2, 7.1, 6.8, 7.1, 7.0, 7.2, 7.5, 7.6)
      gloss &lt;- c(9.5, 9.9, 9.6, 9.6, 9.2, 9.1, 10.0, 9.9, 9.5, 9.4,
                 9.1, 9.3, 8.3, 8.4, 8.5, 9.2, 8.8, 9.7, 10.1, 9.2)
      opacity &lt;- c(4.4, 6.4, 3.0, 4.1, 0.8, 5.7, 2.0, 3.9, 1.9, 5.7,
                   2.8, 4.1, 3.8, 1.6, 3.4, 8.4, 5.2, 6.9, 2.7, 1.9)
      Y &lt;- cbind(tear, gloss, opacity)
      rate &lt;- factor(gl(2,10), labels=c("Low", "High"))

	    ## test for equal distributions by rate
      disco(Y, factors=rate, R=99)
	    disco(Y, factors=rate, R=99, method="discoB")

      ## Just extract the decomposition table
      disco(Y, factors=rate, R=0)$stats

	    ## Compare eqdist.e methods for rate
	    ## disco between stat is half of original when sample sizes equal
	    eqdist.e(Y, sizes=c(10, 10), method="original")
	    eqdist.e(Y, sizes=c(10, 10), method="discoB")

      ## The between-sample distance component
      disco.between(Y, factors=rate, R=0)
</code></pre>


</div>