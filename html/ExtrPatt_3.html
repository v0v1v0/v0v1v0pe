<div class="container">

<table style="width: 100%;"><tr>
<td>est.tpdm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of TPDM</h2>

<h3>Description</h3>

<p>Estimation of tail pairwise dependence matrix (TPDM)
</p>
<p>Sub-Routine of est.row.tpdm. Calculates one element of the TPDM
</p>


<h3>Usage</h3>

<pre><code class="language-R">est.tpdm(X, Y = NULL, anz_cores = 1, clust = NULL, q = 0.98)

est.row.tpdm(x, Y, clust = NULL, q = 0.98)

est.element.tpdm(x, y, clust = NULL, q = 0.98)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A t x n dimensional, numeric data-matrix with t: Number of time steps and n: Number of grid points/stations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A t x n dimensional, numeric Data-matrix with t: Number of time steps and n: Number of grid points/stations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anz_cores</code></td>
<td>
<p>Number of cores for parallel computing (default:1); Be careful not to overload your computer!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>
<p>Optional: If clust = NULL, no declustering is performed. Else, declustering according to cluster-length 'clust'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Threshold for computation of TPDM. Only data above the 'q'-quantile will be used for estimation. Choose such that 0&lt;q&lt;1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Array of length t, where t is the number of time steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Same as x</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a random vector X with components <code class="reqn">x_{t,i}, x_{t,j}</code> with <code class="reqn">i,j = 1, \ldots, n</code> and it's radial component <code class="reqn">r_{t,ij} = \sqrt{x_{t,i}^2 + x_{t,j}^2}</code> and angular components <code class="reqn">w_{t,i} = x_{t,i}/r_{t,ij}</code> and <code class="reqn">w_{t,j} = x_{t,j}/r_{t,ij}</code>, the i'th,j'th element of the TPDM is estimated as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = 2 n_{ij,exc}^{-1} \sum_{t=1}^{n} w_{t,i} w_{t,j} |_{(r_{t,ij} &gt; r_{0,ij})} </code>
</p>
<p>.
Given two random vectors X and Y with components <code class="reqn">x_{t,i}, y_{t,j}</code> with <code class="reqn">i,j = 1, \ldots, n</code>, and it's radial component <code class="reqn"> r_{t,ij} = \sqrt{x_{t,i}^2 + y_{t,j}^2}</code> and angular components <code class="reqn"> w_{t,i}^x = \frac{x_{t,i}}{r_{t,ij}} ; w_{t,j}^y = \frac{y_{t,j}}{r_{t,ij}}</code>, the i'th,j'th element of the cross-TPDM is estimated as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = 2 n^{-1}_{exc} \sum_{t=1}^{n} w^x_{t,i} w^y_{t,j} |_{(r_{t,ij} &gt; r_{0,ij})} </code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>An n x n matrix, containing the estimate of the TPDM
</p>
<p>Array containing the estimate of one row of the TPDM.
</p>
<p>Value containing the estimate of one element of the TPDM.
</p>


<h3>References</h3>

<p>Jiang &amp; Cooley (2020) &lt;doi:10.1175/JCLI-D-19-0413.1&gt;; Szemkus &amp; Friederichs (2023)
</p>


<h3>Examples</h3>

<pre><code class="language-R">data    &lt;- precipGER

data.alpha2       &lt;- to.alpha.2(data$pr)
Sigma   &lt;- est.tpdm(data.alpha2,anz_cores =1)
</code></pre>


</div>