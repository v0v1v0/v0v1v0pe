<div class="container">

<table style="width: 100%;"><tr>
<td>edist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>E-distance</h2>

<h3>Description</h3>

<p>Returns the E-distances (energy statistics) between clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> edist(x, sizes, distance = FALSE, ix = 1:sum(sizes), alpha = 1,
        method = c("cluster","discoB"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data matrix of pooled sample or Euclidean distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizes</code></td>
<td>
<p> vector of sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p> logical: if TRUE, x is a distance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ix</code></td>
<td>
<p> a permutation of the row indices of x </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> distance exponent in (0,2]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> how to weight the statistics </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A vector containing the pairwise two-sample multivariate
<code class="reqn">\mathcal{E}</code>-statistics for comparing clusters or samples is returned.
The e-distance between clusters is computed from the original pooled data,
stacked in matrix <code>x</code> where each row is a multivariate observation, or
from the distance matrix <code>x</code> of the original data, or distance object
returned by <code>dist</code>. The first <code>sizes[1]</code> rows of the original data
matrix are the first sample, the next <code>sizes[2]</code> rows are the second
sample, etc. The permutation vector <code>ix</code> may be used to obtain
e-distances corresponding to a clustering solution at a given level in
the hierarchy.
</p>
<p>The default method <code>cluster</code> summarizes the e-distances between
clusters in a table.
The e-distance between two clusters <code class="reqn">C_i, C_j</code>
of size <code class="reqn">n_i, n_j</code>
proposed by Szekely and Rizzo (2005)
is the e-distance <code class="reqn">e(C_i,C_j)</code>, defined by
</p>
<p style="text-align: center;"><code class="reqn">e(C_i,C_j)=\frac{n_i n_j}{n_i+n_j}[2M_{ij}-M_{ii}-M_{jj}],
  </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">M_{ij}=\frac{1}{n_i n_j}\sum_{p=1}^{n_i} \sum_{q=1}^{n_j}
     \|X_{ip}-X_{jq}\|^\alpha,</code>
</p>

<p><code class="reqn">\|\cdot\|</code> denotes Euclidean norm, <code class="reqn">\alpha=</code>
<code>alpha</code>, and <code class="reqn">X_{ip}</code> denotes the p-th observation in the i-th cluster.  The
exponent <code>alpha</code> should be in the interval (0,2].
</p>
<p>The coefficient <code class="reqn">\frac{n_i n_j}{n_i+n_j}</code>
is one-half of the harmonic mean of the sample sizes. The
<code>discoB</code> method is related but with
different ways of summarizing the pairwise differences between samples.
The <code>disco</code> methods apply the coefficient
<code class="reqn">\frac{n_i n_j}{2N}</code> where N is the total number
of observations. This weights each (i,j) statistic by sample size
relative to N. See the <code>disco</code> topic for more details.
</p>


<h3>Value</h3>

<p>A object of class <code>dist</code> containing the lower triangle of the
e-distance matrix of cluster distances corresponding to the permutation
of indices <code>ix</code> is returned. The <code>method</code> attribute of the
distance object is assigned a value of type, index.
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Szekely, G. J. and Rizzo, M. L. (2005) Hierarchical Clustering
via Joint Between-Within Distances: Extending Ward's Minimum
Variance Method, <em>Journal of Classification</em> 22(2) 151-183.
<br><a href="https://doi.org/10.1007/s00357-005-0012-9">doi:10.1007/s00357-005-0012-9</a>
</p>
<p>M. L. Rizzo and G. J. Szekely (2010).
DISCO Analysis: A Nonparametric Extension of
Analysis of Variance, Annals of Applied Statistics,
Vol. 4, No. 2, 1034-1055.
<br><a href="https://doi.org/10.1214/09-AOAS245">doi:10.1214/09-AOAS245</a>
</p>
<p>Szekely, G. J. and Rizzo, M. L. (2004) Testing for Equal
Distributions in High Dimension, InterStat, November (5).
</p>
<p>Szekely, G. J. (2000) Technical Report 03-05,
<code class="reqn">\mathcal{E}</code>-statistics: Energy of
Statistical Samples, Department of Mathematics and Statistics,
Bowling Green State University.
</p>


<h3>See Also</h3>

<p><code>energy.hclust</code>
<code>eqdist.etest</code>
<code>ksample.e</code>
<code>disco</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">     ## compute cluster e-distances for 3 samples of iris data
     data(iris)
     edist(iris[,1:4], c(50,50,50))
    
     ## pairwise disco statistics
     edist(iris[,1:4], c(50,50,50), method="discoB")  

     ## compute e-distances from a distance object
     data(iris)
     edist(dist(iris[,1:4]), c(50, 50, 50), distance=TRUE, alpha = 1)

     ## compute e-distances from a distance matrix
     data(iris)
     d &lt;- as.matrix(dist(iris[,1:4]))
     edist(d, c(50, 50, 50), distance=TRUE, alpha = 1)

 </code></pre>


</div>