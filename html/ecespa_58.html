<div class="container">

<table style="width: 100%;"><tr>
<td>syrjala</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Syrjala's test for the difference between the spatial distributions of two populations </h2>

<h3>Description</h3>

<p>Computes a two-sample Cramer-von Mises (and Kolmogorov-Smirnov) type test for a difference between the spatial distributions of two populations.
It is designed to be sensitive to differences in the way the populations are distributed across the study area but insensitive to differences in abundance between the two populations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">syrjala0(coords, var1, var2, nsim, R=FALSE)
syrjala(coords = NULL, var1 = NULL, var2 = NULL, nperm = 999)
syrjala.test(ppp1, ppp2, nsim = 999)
## S3 method for class 'syrjala.test'
plot(x, coline=1, ...)
## S3 method for class 'ecespa.syrjala'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A <code>data.frame</code> with '$x' and '$y' components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var1</code></td>
<td>
<p>The first numeric variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var2</code></td>
<td>
<p>The second numeric variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Logical. Should be computed using R approach?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppp1</code></td>
<td>
<p> A marked point pattern, with the <code>ppp</code> format of spatstat, 
representing the values of some parameter measured on the corresponding sampling locations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppp2</code></td>
<td>
<p> A marked point pattern, with the <code>ppp</code> format of spatstat, 
representing the values of some other parameter measured on the same locations than <code>ppp1</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class '<code>syrjala.test</code>' or  '<code>ecespa.syrjala</code>' resulting from <code>syrjala</code> or <code>syrjala.test</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coline</code></td>
<td>
<p>color for drawing the statistic's line in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Graphical parameters passed to <code>hist</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis of  Syrjala's test is that across the study area, the normalized distributions of the two populations are the same (Syrjala, 1996). Population density data are collected at <code class="reqn">K</code> sampling locations on two populations. 
Let <code class="reqn">(xk, yk)</code> denote the coordinates of the <code class="reqn">kth</code> sampling location (<code class="reqn"> k= 1,...,K</code> ); 
let <code class="reqn">d.i(xk, yk)</code> denote the sample density at the <code class="reqn">Kth</code> sampling location of the <code class="reqn">ith</code> population.
To construct a test that is independent of the population sizes, the observed density data is first normalized:
</p>
<p style="text-align: center;"><code class="reqn">gamma.i(xk, yk) = di(xk, yk)/Di,</code>
</p>
<p> where <code class="reqn">Di</code> is the sum  of <code class="reqn">d.i(xk, yk)</code> observations  across the <code class="reqn">K</code> sampling locations. 
The value of the cumulative distribution function at the location <code class="reqn">(xk, yk)</code>  for the <code class="reqn">ith</code> population, denoted <code class="reqn">GAMMA.i(xk, yk)</code>,
is the sum of all normalized density observations, <code class="reqn">gamma.i(xk, yk)</code>, whose location <code class="reqn">(x, y)</code> is such that 
<code class="reqn">x &lt;= xk</code> and <code class="reqn">y &lt;= yk</code>. The statistic proposed by Syrjala to test the null hypothesis is the square of the difference 
between the cumulative distribution functions  of the two populations,  summed over all sampling locations,
that is </p>
<p style="text-align: center;"><code class="reqn">psi = sum{GAMMA.1(xk, yk) - GAMMA.2(xk, yk)}^2.</code>
</p>
 
<p>As <code class="reqn">psi</code> is not invariant with respect to the 'corner'  of the rectangle enclosing the study area that is chosen as the origin of the coordinate sytem,
<code class="reqn">psi</code>  is computed  four times, one with each corner as the origin, and the average <code class="reqn">psi</code> is employed as the test statistic.
The level of significance of the observed <code class="reqn">psi</code> is determined from its position  in the ordered set of test statistic values from all <code class="reqn">2^K</code> pairwise 
permutations (that is approximated from a large number of randomly selected permutations).
</p>


<h3>Value</h3>

<p>Functions <code>syrjala</code> or <code>syrjala0</code> (with the argument <code>R=FALSE</code>) return an object of class '<code>syrjala.test</code>'. 
Functions <code>syrjala.test</code> or <code>syrjala0</code> (with the argument <code>R=TRUE</code>) return an object of class '<code>ecespa.syrjala</code>'.
In Both cases, the result is a  list with the following elements: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cvm.obs</code></td>
<td>
<p>(class syrjala.test). The observed (averaged) <code class="reqn">psi</code> statistic for the CvM test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvm.sim</code></td>
<td>
<p>(class syrjala.test). A numeric vector with the <code>nperm+1</code> simulated <code class="reqn">psi</code>'s statistics (including <code>cvm.obs</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ks.obs</code></td>
<td>
<p>(class syrjala.test). The observed (averaged) <code class="reqn">psi</code> statistic for the K-S test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ks.sim</code></td>
<td>
<p>(class syrjala.test). A numeric vector with the <code>nperm+1</code> simulated <code class="reqn">psi</code>'s statistics (including <code>ks.obs</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datanames</code></td>
<td>
<p>(class syrjala.test). A character vector with the names of the two patterns, the spatial congruence of which is been analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm </code></td>
<td>
<p>(class syrjala.test). The number of permutations employed in the test (not counting the original data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.obs </code></td>
<td>
<p>(class ecespa.syrjala).The observed (averaged) <code class="reqn">psi</code> statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.sim </code></td>
<td>
<p>(class ecespa.syrjala). A vector with the <code>nsim</code> simulated <code class="reqn">psi</code>'s statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datanames </code></td>
<td>
<p>(class ecespa.syrjala). A vector with the names of the two point patterns whose spatial congruence is been analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim </code></td>
<td>
<p>(class ecespa.syrjala). The number of permutations employed in the test.</p>
</td>
</tr>
</table>
<p>Both S3 plot methods plot an histogram with the distribution of the simulated <code class="reqn">psi</code>'s statistics and draws the observed <code class="reqn">psi</code> as a vertical line.
</p>


<h3>Warning </h3>

<p>The test requires both populations being sampled in exactly the same sampling locations. 
Althoug this implementation employs <code>ppp</code>'s as the supporting data format, this kind of data are <b>not</b> spatial point patterns.
They cannot be analysed with the usual tools employed for marked point patterns.</p>


<h3>Note</h3>

  <p><code>syrjala</code> or <code>syrjala0</code> (with the argument <code>R=FALSE</code>) implement a Fortran version of Syrjala's test. They run considerably faster
than the "whole-R" implementation of <code>syrjala.test</code> or <code>syrjala0</code> (with the argument <code>R=TRUE</code>). This last implementation is supplied for illustrative purposes and to 
maintain compability with previous versions of package <code>ecespa</code>. One can use function <code>haz.ppp</code> to easily build the <code>ppp</code> objects from a <code>data.frame</code> with only three columns (x-coordinate,
y-coordinate and abundance).  
</p>
<p>This function has been employed to compute Syrjala's test in Rey-Benayas et al. (2008).
</p>


<h3>Author(s)</h3>

<p> Jose M. Blanco-Moreno <a href="mailto:jmblanco@ub.edu">jmblanco@ub.edu</a> for the Fortran implementation of Syrjala's original QBasic function, Marcelino de la Cruz Rot for the R version, the wrapping functions and the documentation</p>


<h3>References</h3>

 
<p>Rey-Benayas, J.M., de la Montaña, E., Pérez-Camacho, L., de la Cruz, M., Moreno, D., Parejo, J.L. and Suárez-Seoane, S. 2010. 
Inter-annual dynamics and spatial congruence of a nocturnal bird assemblage inhabiting a Mediterranean agricultural mosaic. <em>Ardeola</em>,57(2): 303-320.
</p>
<p>Syrjala, S. E. 1996. A statistical test for a difference between the spatial distributions of two populations. <em>Ecology</em> 77: 75-80. <a href="https://doi.org/10.2307/2265656">doi:10.2307/2265656</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
   
   data(syr1); data(syr2); data(syr3)
   
   coords &lt;- data.frame(x=syr1$x, y=syr1$y); var1&lt;- syr1$marks; var2&lt;- syr2$marks
   
   (stest&lt;-syrjala(coords, var1, var2, 9999))
   plot(stest)
   
   
   ## Not run: 
   
   plot(syrjala.test(syr1, syr2, nsim=999)) 
   
   plot(syrjala.test(syr1, syr3, nsim=999)) 
   
   syrjala0(coords, var1, var2, 9999)
   
   syrjala0(coords, var1, var2, 999, R=TRUE)
   
   
   coords &lt;- expand.grid(x=1:10,y=1:10)
   var1 &lt;- runif(100)
   var2 &lt;- runif(100)
   syrjala(coords, var1, var2, 9999)
   
   

## End(Not run)
</code></pre>


</div>