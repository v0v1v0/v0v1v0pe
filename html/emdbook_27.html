<div class="container">

<table style="width: 100%;"><tr>
<td>lambertW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lambert W function</h2>

<h3>Description</h3>

<p>Computes the Lambert W function, giving efficient solutions to the equation x*exp(x)==z
</p>


<h3>Usage</h3>

<pre><code class="language-R">lambertW_base(z, b = 0, maxiter = 10, eps = .Machine$double.eps, min.imag =
1e-09)
lWasymp(z,logz)
lambertW(z,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>(complex) vector of values for which to compute the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logz</code></td>
<td>
<p>(complex (?)) vector of <code class="reqn">log(z)</code> values (to be
specified by name instead of <code>z</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>(integer) b=0 specifies the principal
branch, 0 and -1 are the ones that can take non-complex values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum numbers of iterations for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.imag</code></td>
<td>
<p>maximum magnitude of imaginary part to chop when
returning solutions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to pass to <code>lambertW_base</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute the Lambert W function of z.  This function satisfies
<code class="reqn">W(z)\exp(W(z))=z</code>, and can thus be used to express solutions
of transcendental equations involving exponentials or logarithms.
For <code class="reqn">z&gt;10^307</code>, an asymptotic formula (from
Corless et al by way of
<a href="http://mathworld.wolfram.com/LambertW-Function.html">http://mathworld.wolfram.com/LambertW-Function.html</a>)
is used: <code>lambertW</code> is a wrapper that automatically selects
the asymptotic formula where appropriate.
</p>

<ul>
<li>
<p>In ecology, the Lambert W can be used to solve the so-called
"Rogers equation" for predator functional response with depletion.
</p>
</li>
<li>
<p>In epidemiology, the Lambert W function solves the final-size
equation of a simple SIR epidemic model.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Complex or real vector of solutions.
</p>


<h3>Note</h3>

<p>This implementation should return values within 2.5*eps of its
counterpart in Maple V, release 3 or later.  Please report any
discrepancies to the author or translator.
</p>
<p>The derivative of the <code>lambertW</code> function is <code>plogis(-lambertW)</code>.
</p>


<h3>Author(s)</h3>

<p>Nici Schraudolph &lt;schraudo@inf.ethz.ch&gt; (original
version (c) 1998), Ben Bolker (R translation)
</p>


<h3>References</h3>

<p>Corless, Gonnet, Hare, Jeffrey, and Knuth (1996), "On the Lambert
W Function", Advances in Computational Mathematics 5(4):329-359</p>


<h3>See Also</h3>

<p><code>?Lambert</code> in the <code>gsl</code> package by Robin Hankin,
which uses Gnu Scientific Library code; also <code>?lambertW</code>
in the <code>VGAM</code> and <code>pracma</code> packages, and the <code>lambertW</code> package</p>


<h3>Examples</h3>

<pre><code class="language-R">curve(lambertW(x),from=0,to=10)
pvec &lt;- seq(-1,1,length=40)
m &lt;- outer(pvec,pvec,function(x,y)Re(lambertW(x+y*1i)))
persp(pvec,pvec,m,
      theta=290,shade=0.5,zlab="lambertW")
num1 &lt;- uniroot(function(x) {x*exp(x)-1},lower=0,upper=1,tol=1e-9)
abs(lambertW(1)-num1$root)&lt;1e-9
###
## Rogers random predator equation:
rogers.pred &lt;- function(N0,a,h,T) {
   N0 - lambertW(a*h*N0*exp(-a*(T-h*N0)))/(a*h)
}
holling2.pred &lt;- function(N0,a,h) {
  a*N0/(1+a*h*N0)
}
curve(rogers.pred(x,a=1,h=0.2,T=1),from=0,to=60,
  ylab="Number eaten/unit time",xlab="Initial number",ylim=c(0,5),
  main="Predation: a=1, h=0.2")
curve(rogers.pred(x,a=1,h=0.2,T=5)/5,add=TRUE,lty=2,from=0)
curve(rogers.pred(x,a=1,h=0.2,T=0.2)*5,add=TRUE,lty=3,from=0)
curve(rogers.pred(x,a=1,h=0.2,T=10)/10,add=TRUE,lty=4,from=0)
curve(holling2.pred(x,a=1,h=0.2),add=TRUE,lty=1,lwd=2,from=0)
abline(h=5)
legend(30,2,
   c(paste("Rogers, T=",c(0.2,1,5,10),sep=""),
    "Holling type II"),lwd=c(rep(1,4),2),lty=c(3,1,2,4,1))
## final size of an epidemic
finalsize &lt;- function(R0) {
   1+1/R0*lambertW(-R0*exp(-R0))
}
curve(finalsize,from=1,to=10,xlab=expression(R[0]),ylab="Final size")
## comparison of asymptotic results
tmpf &lt;- function(x) {
  L0 &lt;- lambertW_base(10^x)
  L1 &lt;- lWasymp(logz=x*log(10))
  (L1-L0)/L0
}
curve(tmpf,from=1,to=307,log="y")

## derivative
## don't run (avoid numDeriv dependency)
## require(numDeriv)
##   grad(lambertW(1))
##   plogis(-lambertW(1))
</code></pre>


</div>