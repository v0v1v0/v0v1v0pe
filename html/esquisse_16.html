<div class="container">

<table style="width: 100%;"><tr>
<td>esquisse-module</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Esquisse module</h2>

<h3>Description</h3>

<p>Use esquisse as a module in a Shiny application.
</p>


<h3>Usage</h3>

<pre><code class="language-R">esquisse_ui(
  id,
  header = esquisse_header(),
  container = esquisse_container(),
  controls = c("options", "labs", "axes", "geoms", "theme", "filters", "code"),
  insert_code = FALSE,
  play_pause = TRUE,
  layout_sidebar = FALSE,
  downloads = downloads_labels(),
  n_geoms = 8
)

esquisse_server(
  id,
  data_rv = NULL,
  name = "data",
  default_aes = c("fill", "color", "size", "group", "facet"),
  import_from = c("env", "file", "copypaste", "googlesheets", "url"),
  n_geoms = 8,
  drop_ids = TRUE,
  notify_warnings = NULL
)

esquisse_container(width = "100%", height = "700px", fixed = FALSE)

esquisse_header(
  import_data = TRUE,
  show_data = TRUE,
  update_variable = TRUE,
  create_column = TRUE,
  cut_variable = TRUE,
  update_factor = TRUE,
  settings = TRUE,
  close = TRUE,
  .before = NULL,
  .after = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Module ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>Either <code>TRUE</code> or <code>FALSE</code> to display or not <code>esquisse</code> header, or a named <code>list</code>
where names are : <code>settings</code>, <code>close</code>, <code>import</code> and <code>show_data</code> and values are <code>TRUE</code> or
<code>FALSE</code> to display or not the corresponding button.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>container</code></td>
<td>
<p>Container in which display the addin,
default is to use <code>esquisse_container()</code>, see examples.
Use <code>NULL</code> for no container (behavior in versions &lt;= 0.2.1).
Must be a <code>function</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controls</code></td>
<td>
<p>Controls menu to be displayed. Use <code>NULL</code> to hide all menus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insert_code</code></td>
<td>
<p>Logical, Display or not a button to insert the ggplot
code in the current user script (work only in RStudio).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>play_pause</code></td>
<td>
<p>Display or not the play / pause button.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout_sidebar</code></td>
<td>
<p>Put controls in a sidebar on the left rather than below the chart in dropdowns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downloads</code></td>
<td>
<p>Export options available or <code>NULL</code> for no export. See <code>downloads_labels()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_geoms</code></td>
<td>
<p>Number of geoms the user can use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_rv</code></td>
<td>
<p>Either:
</p>

<ul>
<li>
<p> A <code>shiny::reactiveValues()</code> with a slot <code>data</code> containing a <code>data.frame</code>
to use in the module and a slot <code>name</code> corresponding to the name of the <code>data.frame</code> used for the generated code.
</p>
</li>
<li>
<p> A <code>shiny::reactive()</code> function returning a <code>data.frame</code>. See argument <code>name</code> for the name used in generated code.
</p>
</li>
<li>
<p> A <code>data.frame</code> object.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The default name to use in generated code. Can be a <code>reactive</code> function return a single character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default_aes</code></td>
<td>
<p>Default aesthetics to be used, can be a <code>character</code>
vector or <code>reactive</code> function returning one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>import_from</code></td>
<td>
<p>From where to import data, argument passed
to <code>datamods::import_server()</code>, use <code>NULL</code> to prevent the modal to appear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_ids</code></td>
<td>
<p>Argument passed to datamods::filter_data_server. Drop columns containing more than 90% of unique values, or than 50 distinct values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notify_warnings</code></td>
<td>
<p>See <code>safe_ggplot()</code>. If <code>NULL</code>, the user can make his or her own choice via the settings menu, default is to show warnings once.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width, height</code></td>
<td>
<p>The width and height of the container, e.g. <code>"400px"</code>,
or <code>"100%"</code>; see <code>htmltools::validateCssUnit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>Use a fixed container, e.g. to use use esquisse full page.
If <code>TRUE</code>, width and height are ignored. Default to <code>FALSE</code>.
It's possible to use a vector of CSS unit of length 4 to specify the margins
(top, right, bottom, left).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>import_data</code></td>
<td>
<p>Show button to import data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_data</code></td>
<td>
<p>Show button to display data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_variable</code></td>
<td>
<p>Show button to update selected variables and convert them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>create_column</code></td>
<td>
<p>Show button to create a new column based on an expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_variable</code></td>
<td>
<p>Show button to allow to convert a numeric variable into factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_factor</code></td>
<td>
<p>Show button to open window to reorder factor levels and update them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settings</code></td>
<td>
<p>Show button to open settings modal (to select aesthetics to use).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>close</code></td>
<td>
<p>Show button to stop the app and close addin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.before, .after</code></td>
<td>
<p>Custom content to put in the header, typically buttons.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>reactiveValues</code> with 3 slots :
</p>

<ul>
<li> <p><strong>code_plot</strong> : code to generate plot.
</p>
</li>
<li> <p><strong>code_filters</strong> : a list of length two with code to reproduce filters.
</p>
</li>
<li> <p><strong>data</strong> : <code>data.frame</code> used in plot (with filters applied).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
### Part of a Shiny app ###

library(shiny)
library(esquisse)

ui &lt;- fluidPage(

  theme = bs_theme_esquisse(),

  tags$h1("Use esquisse as a Shiny module"),

  radioButtons(
    inputId = "data",
    label = "Data to use:",
    choices = c("iris", "mtcars"),
    inline = TRUE
  ),
  checkboxGroupInput(
    inputId = "aes",
    label = "Aesthetics to use:",
    choices = c(
      "fill", "color", "size", "shape",
      "weight", "group", "facet", "facet_row", "facet_col"
    ),
    selected = c("fill", "color", "size", "facet"),
    inline = TRUE
  ),
  esquisse_ui(
    id = "esquisse",
    header = FALSE, # dont display gadget title
    container = esquisse_container(height = "700px")
  )
)

server &lt;- function(input, output, session) {

  data_rv &lt;- reactiveValues(data = iris, name = "iris")

  observeEvent(input$data, {
    if (input$data == "iris") {
      data_rv$data &lt;- iris
      data_rv$name &lt;- "iris"
    } else {
      data_rv$data &lt;- mtcars
      data_rv$name &lt;- "mtcars"
    }
  })

  esquisse_server(
    id = "esquisse",
    data_rv = data_rv,
    default_aes = reactive(input$aes)
  )

}

if (interactive())
  shinyApp(ui, server)


### Whole Shiny app ###

library(shiny)
library(esquisse)


# Load some datasets in app environment
my_data &lt;- data.frame(
  var1 = rnorm(100),
  var2 = sample(letters[1:5], 100, TRUE)
)


ui &lt;- fluidPage(
  theme = bs_theme_esquisse(),
  esquisse_ui(
    id = "esquisse",
    header = esquisse_header(
      close = FALSE, # hide the close button
      .after = actionButton( # custom button
        inputId = "open_modal",
        label = NULL,
        icon = icon("plus")
      )
    ),
    container = esquisse_container(fixed = TRUE),
    play_pause = FALSE,
    controls = c("settings", "labs", "axes", "geoms", "theme", "filters", "code", "export"),
    layout_sidebar = TRUE
  )
)

server &lt;- function(input, output, session) {

  esquisse_server(id = "esquisse")


  observeEvent(input$open_modal, {
    showModal(modalDialog("Some content"))
  })
}

if (interactive())
  shinyApp(ui, server)



## You can also use a vector of margins for the fixed argument,
# useful if you have a navbar for example

library(shiny)
library(esquisse)
library(datamods)

ui &lt;- navbarPage(
  title = "My navbar app",
  theme = bs_theme_esquisse(),
  tabPanel(
    title = "esquisse",
    esquisse_ui(
      id = "esquisse", 
      header = FALSE,
      container = esquisse_container(
        fixed = c(55, 0, 0, 0)
      )
    )
  )
)

server &lt;- function(input, output, session) {
  
  # lauch import data modal
  import_modal(
    id = "import-data",
    from = c("env", "file", "copypaste"),
    title = "Import data"
  )
  data_imported_r &lt;- datamods::import_server("import-data")

  data_rv &lt;- reactiveValues(data = data.frame())
  observeEvent(data_imported_r$data(), {
    data_rv$data &lt;- data_imported_r$data()
    data_rv$name &lt;- data_imported_r$name()
  })
  
  esquisse_server(id = "esquisse", data_rv = data_rv)
  
}

if (interactive())
  shinyApp(ui, server)
</code></pre>


</div>