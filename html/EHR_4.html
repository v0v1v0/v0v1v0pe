<div class="container">

<table style="width: 100%;"><tr>
<td>analysisPheWAS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical Analysis for PheWAS</h2>

<h3>Description</h3>

<p>Implement three commonly used statistical methods to analyze data for
Phenome Wide Association Study (PheWAS)
</p>


<h3>Usage</h3>

<pre><code class="language-R">analysisPheWAS(
  method = c("firth", "glm", "lr"),
  adjust = c("PS", "demo", "PS.demo", "none"),
  Exposure,
  PS,
  demographics,
  phenotypes,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>define the statistical analysis method from 'firth', 'glm', and
'lr'. 'firth': Firth's penalized-likelihood logistic regression; 'glm':
logistic regression with Wald test, 'lr': logistic regression with likelihood
ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>define the adjustment method from 'PS','demo','PS.demo', and
'none'. 'PS': adjustment of PS only; 'demo': adjustment of demographics only;
'PS.demo': adjustment of PS and demographics; 'none': no adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>define the variable name of exposure variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PS</code></td>
<td>
<p>define the variable name of propensity score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demographics</code></td>
<td>
<p>define the list of demographic variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>
<p>define the list of phenotypes that need to be analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>define the data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Implements three commonly used statistical methods to analyze the associations 
between exposure (e.g., drug exposure, genotypes) and various phenotypes in 
PheWAS. Firth's penalized-likelihood logistic regression is the default method to 
avoid the problem of separation in logistic regression, which is often a problem 
when analyzing sparse binary outcomes and exposure. Logistic regression with 
likelihood ratio test and conventional logistic regression with Wald test can be 
also performed.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimate of log odds ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdError</code></td>
<td>
<p>the standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>the p-value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Leena Choi <a href="mailto:leena.choi@vanderbilt.edu">leena.choi@vanderbilt.edu</a> and
Cole Beck <a href="mailto:cole.beck@vumc.org">cole.beck@vumc.org</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## use small datasets to run this example
data(dataPheWASsmall)
## make dd.base with subset of covariates from baseline data (dd.baseline.small)
## or select covariates with upper code as shown below
upper.code.list &lt;- unique(sub("[.][^.]*(.).*", "", colnames(dd.baseline.small)) )
upper.code.list &lt;- intersect(upper.code.list, colnames(dd.baseline.small))
dd.base &lt;- dd.baseline.small[, upper.code.list]
## perform regularized logistic regression to obtain propensity score (PS) 
## to adjust for potential confounders at baseline
phenos &lt;- setdiff(colnames(dd.base), c('id', 'exposure'))
data.x &lt;- as.matrix(dd.base[, phenos])
glmnet.fit &lt;- glmnet::cv.glmnet(x=data.x, y=dd.base[,'exposure'],
                                family="binomial", standardize=TRUE,
                                alpha=0.1)
dd.base$PS &lt;- c(predict(glmnet.fit, data.x, s='lambda.min'))
data.ps &lt;- dd.base[,c('id', 'PS')]
dd.all.ps &lt;- merge(data.ps, dd.small, by='id')  
demographics &lt;- c('age', 'race', 'gender')
phenotypeList &lt;- setdiff(colnames(dd.small), c('id','exposure','age','race','gender'))
## run with a subset of phenotypeList to get quicker results
phenotypeList.sub &lt;- sample(phenotypeList, 5)
results.sub &lt;- analysisPheWAS(method='firth', adjust='PS', Exposure='exposure',
                              PS='PS', demographics=demographics, 
                              phenotypes=phenotypeList.sub, data=dd.all.ps)
## run with the full list of phenotype outcomes (i.e., phenotypeList)

        results &lt;- analysisPheWAS(method='firth', adjust='PS',Exposure='exposure',
                          PS='PS', demographics=demographics,
                          phenotypes=phenotypeList, data=dd.all.ps) 
         
</code></pre>


</div>