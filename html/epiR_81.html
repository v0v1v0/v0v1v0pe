<div class="container">

<table style="width: 100%;"><tr>
<td>rsu.sep.rb2rf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Surveillance system sensitivity assuming risk-based sampling on two risk factors
</h2>

<h3>Description</h3>

<p>Calculates risk-based surveillance system (population-level) sensitivity with a two risk factors, assuming [one-stage] risk-based sampling and allowing unit sensitivity to vary among risk strata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsu.sep.rb2rf(N, n, rr1, ppr1, rr2, ppr2, pstar, se.u, method = "binomial")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>matrix of population sizes for each risk group. Rows = levels of <code>rr1</code>, columns = levels of <code>rr2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>matrix of the number of surveillance units tested in each risk group. Rows = levels of <code>rr1</code>, columns = levels of <code>rr2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rr1</code></td>
<td>
<p>scalar or vector defining the first set of relative risk values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppr1</code></td>
<td>
<p>scalar or vector of the same length as that vector of <code>rr1</code> defining the population proportions in each of the first risk strata. Proportions must sum to one. Ignored if <code>method = "hypergeometric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rr2</code></td>
<td>
<p>matrix defining the relative risks for the second risk factor. Rows = levels of <code>rr1</code>, columns = levels of <code>rr2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppr2</code></td>
<td>
<p>matrix defining the population proportions in each of the second risk strata. Row proportions must sum to one. Rows = levels of <code>rr1</code>, columns = levels of <code>rr2</code>. Ignored if <code>method = "hypergeometric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pstar</code></td>
<td>
<p>scalar, defining the design prevalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.u</code></td>
<td>
<p>scalar or vector of the same length as that vector of <code>rr1</code> defining the unit sensitivity (which can vary across strata).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string indicating the method to be used. Options are <code>binomial</code> or <code>hypergeometric</code>. See details, below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method = binomial</code> <code>N</code> is ignored and values for <code>ppr</code> need to be entered. Conversely, if <code>method = hypergeometric</code>, <code>ppr</code> is ignored and calculated from <code>N</code>.
</p>


<h3>Value</h3>

<p>A list comprised of two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>se.p</code></td>
<td>
<p>scalar, surveillance system (population-level) sensitivity estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epi</code></td>
<td>
<p>vector, effective probability of infection estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.risk1</code></td>
<td>
<p>vector, adjusted relative risk estimates for the first risk factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.risk2</code></td>
<td>
<p>vector, adjusted relative risk estimates for the second risk factor.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## EXAMPLE 1:
## A cross-sectional study is to be carried out to confirm the absence of 
## disease using risk based sampling. Assume a design prevalence of 0.01 
## at the surveillance unit level. Surveillance units are categorised as 
## being either high or low risk with the probability of disease for 
## high risk surveillance units 3 times the probability of disease for low 
## risk units. The proportion of units in each risk group is 0.20 and 0.80,
## respectively.

## Within each of the two risk categories the probability of disease varies 
## with age with younger age groups having four times the risk of disease 
## as older age groups. In the high risk area 10% of the population are young 
## and 90% are old. In the low risk area 30% of the population are young and 
## 70% are old. 

## The total number of surveillance units in the population is unknown. The 
## numbers of young and old surveillance units tested in the high and low risk 
## groups are 40, 20, 20 and 10, respectively. You intend to use a test with 
## diagnostic sensitivity of 0.80. What is the surveillance system sensitivity?

rsu.sep.rb2rf(N = NA, n = rbind(c(40,20), c(20,10)), 
   rr1 = c(3,1), 
   ppr1 = c(0.20,0.80), 
   rr2 = rbind(c(4,1), c(4,1)), 
   ppr2 = rbind(c(0.10,0.90), c(0.30,0.70)),
   pstar = 0.01, 
   se.u = 0.80, method = "binomial")$se.p

## The surveillance system sensitivity is 0.93.


## EXAMPLE 2:
## This example shows the importance of sampling high risk groups. Take the 
## same scenario as above but switch the relative proportions sampled by 
## risk group --- taking a greater number of samples from the low risk group
## compared with the high risk group:

rsu.sep.rb2rf(N = NA, n = rbind(c(10,20), c(20,40)), 
   rr1 = c(3,1), 
   ppr1 = c(0.20,0.80), 
   rr2 = rbind(c(4,1), c(4,1)), 
   ppr2 = rbind(c(0.10,0.90), c(0.30,0.70)),
   pstar = 0.01, 
   se.u = 0.80, method = "binomial")$se.p
 
## The surveillance system sensitivity is 0.69. Here we've taken exactly the 
## same number of samples as Example 1, but there's a substantial decrease
## in surveillance system sensitivity because we've concentrated sampling on 
## a low risk group (decreasing our ability to detect disease).

</code></pre>


</div>