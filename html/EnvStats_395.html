<div class="container">

<table style="width: 100%;"><tr>
<td>plotPredIntNparSimultaneousDesign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plots for a Sampling Design Based on a Simultaneous Nonparametric Prediction Interval
</h2>

<h3>Description</h3>

<p>Create plots involving sample size (<code class="reqn">n</code>), number of future observations 
(<code class="reqn">m</code>), minimum number of future observations the interval should contain 
(<code class="reqn">k</code>), number of future sampling occasions (<code class="reqn">r</code>), and confidence level 
<code class="reqn">(1-\alpha)</code> for a simultaneous nonparametric prediction interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plotPredIntNparSimultaneousDesign(x.var = "n", y.var = "conf.level", 
    range.x.var = NULL, n = max(25, lpl.rank + n.plus.one.minus.upl.rank + 1), 
    n.median = 1, k = 1, m = ifelse(x.var == "k", ceiling(max.x), 1), r = 2, 
    rule = "k.of.m", conf.level = 0.95, pi.type = "upper", 
    lpl.rank = ifelse(pi.type == "upper", 0, 1), 
    n.plus.one.minus.upl.rank = ifelse(pi.type == "lower", 0, 1), n.max = 5000, 
    maxiter = 1000, integrate.args.list = NULL, plot.it = TRUE, add = FALSE, 
    n.points = 100, plot.col = "black", plot.lwd = 3 * par("cex"), plot.lty = 1, 
    digits = .Options$digits, cex.main = par("cex"), ..., main = NULL, 
    xlab = NULL, ylab = NULL, type = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.var</code></td>
<td>

<p>character string indicating what variable to use for the x-axis.  
Possible values are <code>"n"</code> (sample size; the default), 
<code>"conf.level"</code> (the confidence level), <code>"k"</code> (minimum number of 
future observations the interval should contain), <code>"m"</code> (number of 
future observations), and <code>"r"</code> (number of future sampling occasions).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.var</code></td>
<td>

<p>character string indicating what variable to use for the y-axis.  
Possible values are <code>"conf.level"</code> (confidence level; the default), and 
<code>"n"</code> (sample size).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.x.var</code></td>
<td>

<p>numeric vector of length 2 indicating the range of the x-variable to use 
for the plot.  The default value depends on the value of <code>x.var</code>.  
When <code>x.var="n"</code> the default value is <code>c(2,50)</code>.  
When <code>x.var="conf.level"</code>, the default value is <code>c(0.5, 0.99)</code>.  
When <code>x.var="k"</code>, <code>x.var="m"</code>, or <code>x.var="r"</code>, the default value 
is c(1, 20).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>numeric scalar indicating the sample size.  The default value is <br><code>max(25, lpl.rank + n.plus.one.minus.upl.rank + 1)</code>.  
Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
values are not allowed.  
This argument is ignored if either <code>x.var="n"</code> or <code>y.var="n"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.median</code></td>
<td>

<p>positive odd integer specifying the sample size associated with the future medians.  
The default value is <code>n.median=1</code> (i.e., individual observations).  Note that 
all future medians must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), a positive integer 
specifying the minimum number of observations (or medians) out of <code class="reqn">m</code> 
observations (or medians) (all obtained on one future sampling “occassion”) 
the prediction interval should contain.  
The default value is <code>k=1</code>.  This argument is ignored when the argument 
<code>rule</code> is not equal to <code>"k.of.m"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>positive integer specifying the maximum number of future observations (or 
medians) on one future sampling “occasion”.  
The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which 
case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>positive integer specifying the number of future sampling “occasions”.  
The default value is <code>r=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>

<p>character string specifying which rule to use.  The possible values are 
<code>"k.of.m"</code> (<code class="reqn">k</code>-of-<code class="reqn">m</code> rule; the default), <code>"CA"</code> (California rule), 
and <code>"Modified.CA"</code> (modified California rule).  
See the DETAILS section below for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric scalar between 0 and 1 indicating the confidence level 
associated with the prediction interval.  The default value is 
<code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>"upper"</code> (the default) and <code>"lower"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpl.rank</code></td>
<td>

<p>non-negative integer indicating the rank of the order statistic to use for 
the lower bound of the prediction interval.  If <code>pi.type="lower"</code>, the 
default value is <code>lpl.rank=1</code> (implying the minimum value is used as the 
lower bound of the prediction interval).  If <code>pi.type="upper"</code>, this 
argument is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.plus.one.minus.upl.rank</code></td>
<td>

<p>non-negative integer related to the rank of the order statistic to use for 
the upper bound of the prediction interval.  A value of 
<code>n.plus.one.minus.upl.rank=1</code> (the default) means use the 
first largest value, and in general a value of <br><code>n.plus.one.minus.upl.rank=</code><code class="reqn">i</code> means use the <code class="reqn">i</code>'th largest value.  
If <br><code>pi.type="lower"</code>, this argument is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.max</code></td>
<td>

<p>numeric scalar indicating the maximum sample size to consider when <code>y.var="n"</code>.  
This argument is used in the search algorithm to determine the required sample size.  
The default value is <code>n.max=5000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>positive integer indicating the maximum number of iterations to use in the 
<code>uniroot</code> search algorithm when <code>y.var="n"</code>.  The default value is 
<code>maxiter=1000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate.args.list</code></td>
<td>

<p>list of arguments to supply to the <code>integrate</code> function.  The default 
value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>a logical scalar indicating whether to create a plot or add to the 
existing plot (see <code>add</code>) on the current graphics device.  If 
<code>plot.it=FALSE</code>, no plot is produced, but a list of (x,y) values 
is returned (see VALUE).  The default value is <code>plot.it=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>a logical scalar indicating whether to add the design plot to the 
existing plot (<code>add=TRUE</code>), or to create a plot from scratch 
(<code>add=FALSE</code>).  The default value is <code>add=FALSE</code>.  
This argument is ignored if <code>plot.it=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>

<p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.  
There are <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>.  The default value is <code>n.points=100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the plotted 
line or points.  The default value is <code>plot.col="black"</code>.  See the 
entry for <code>col</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lwd</code></td>
<td>

<p>a numeric scalar determining the width of the plotted line.  The default value is 
<code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the plotted line.  The default value is 
<code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print out on the plot.  The default 
value is the current setting of <code>options("digits")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main, main, xlab, ylab, type, ...</code></td>
<td>

<p>additional graphical parameters (see <code>par</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help file for <code>predIntNparSimultaneous</code>, 
<code>predIntNparSimultaneousConfLevel</code>, and <br><code>predIntNparSimultaneousN</code> for information on how to compute a 
simultaneous nonparametric prediction interval, how the confidence level 
is computed when other quantities are fixed, and how the sample size is 
computed when other quantities are fixed.
</p>


<h3>Value</h3>

<p><code>plotPredIntNparSimultaneousDesign</code> invisibly returns a list with components 
<code>x.var</code> and <code>y.var</code>, giving coordinates of the points that 
have been or would have been plotted.
</p>


<h3>Note</h3>

<p>See the help file for <code>predIntNparSimultaneous</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>predIntNparSimultaneous</code>.
</p>


<h3>See Also</h3>

<p><code>predIntNparSimultaneous</code>, 
<code>predIntNparSimultaneousConfLevel</code>, <br><code>predIntNparSimultaneousN</code>, 
<code>predIntNparSimultaneousTestPower</code>, 
<code>predIntNpar</code>, <code>tolIntNpar</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # For the 1-of-3 rule with r=20 future sampling occasions, look at the 
  # relationship between confidence level and sample size for a one-sided 
  # upper simultaneous nonparametric prediction interval.

  dev.new()
  plotPredIntNparSimultaneousDesign(k = 1, m = 3, r = 20, range.x.var = c(2, 20))

  #==========

  # Plot confidence level vs. sample size for various values of number of 
  # future sampling occasions (r):

  dev.new()
  plotPredIntNparSimultaneousDesign(m = 3, r = 10, rule = "CA", 
    ylim = c(0, 1), main = "") 

  plotPredIntNparSimultaneousDesign(m = 3, r = 20, rule = "CA", add = TRUE, 
    plot.col = "red") 

  plotPredIntNparSimultaneousDesign(m = 3, r = 30, rule = "CA", add = TRUE, 
    plot.col = "blue") 

  legend("bottomright", c("r=10", "r=20", "r=30"), lty = 1, lwd = 3 * par("cex"), 
    col = c("black", "red", "blue"), bty = "n") 

  title(main = paste("Confidence Level vs. Sample Size for Simultaneous", 
    "Nonparametric PI with Various Values of r", sep="\n"))

  #==========

  # Modifying Example 19-5 of USEPA (2009, p. 19-33), plot confidence level 
  # versus sample size (number of background observations requried) for 
  # a 1-of-3 plan assuming r = 10 compliance wells (future sampling occasions).
  
  dev.new()
  plotPredIntNparSimultaneousDesign(k = 1, m = 3, r = 10, rule = "k.of.m")

  #==========

  # Clean up
  #---------
  graphics.off()
</code></pre>


</div>