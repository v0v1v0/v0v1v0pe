<div class="container">

<table style="width: 100%;"><tr>
<td>alluvial_model_response_caret</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>create model response plot for caret models</h2>

<h3>Description</h3>

<p>Wraps <code>alluvial_model_response</code> and
<code>get_data_space</code> into one call for caret models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">alluvial_model_response_caret(
  train,
  data_input,
  degree = 4,
  bins = 5,
  bin_labels = c("LL", "ML", "M", "MH", "HH"),
  col_vector_flow = c("#FF0065", "#009850", "#A56F2B", "#005EAA", "#710500", "#7B5380",
    "#9DD1D1"),
  method = "median",
  parallel = FALSE,
  params_bin_numeric_pred = list(bins = 5),
  pred_train = NULL,
  stratum_label_size = 3.5,
  force = F,
  resp_var = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>train</code></td>
<td>
<p>caret train object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_input</code></td>
<td>
<p>dataframe, input data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>integer,  number of top important variables to select. For
plotting more than 4 will result in two many flows and the alluvial plot
will not be very readable, Default: 4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>integer, number of bins for numeric variables, increasing this
number might result in too many flows, Default: 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_labels</code></td>
<td>
<p>labels for the bins from low to high, Default: c("LL", "ML",
"M", "MH", "HH")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_vector_flow, </code></td>
<td>
<p>character vector, defines flow colours, Default:
c('#FF0065','#009850', '#A56F2B', '#005EAA', '#710500')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method, </code></td>
<td>
<p>character vector, one of c('median', 'pdp') </p>

<dl>
<dt>median</dt>
<dd>
<p>sets variables that are not displayed to median mode, use with
regular predictions</p>
</dd> <dt>pdp</dt>
<dd>
<p>partial dependency plot method, for each
observation in the training data the displayed variables are set to the
indicated values. The predict function is called for each modified
observation and the result is averaged</p>
</dd> </dl>
<p>. Default: 'median'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical, turn on parallel processing for pdp method. Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_bin_numeric_pred</code></td>
<td>
<p>list, additional parameters passed to
<code>manip_bin_numerics</code> which is applied to the pred
parameter. Default: list(bins = 5, center = T, transform = T, scale = T)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_train</code></td>
<td>
<p>numeric vector, base the automated binning of the pred vector on
the distribution of the training predictions. This is useful if marginal
histograms are added to the plot later. Default = NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum_label_size</code></td>
<td>
<p>numeric, Default: 3.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>logical, force plotting of over 1500 flows, Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp_var</code></td>
<td>
<p>character, sometimes target variable cannot be inferred and
needs to be passed. Default NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to
<code>alluvial_wide</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>this model visualisation approach follows the "visualising the model
in the dataspace" principle as described in Wickham H, Cook D, Hofmann H
(2015) Visualizing statistical models: Removing the blindfold. Statistical
Analysis and Data Mining 8(4) &lt;doi:10.1002/sam.11271&gt;
</p>


<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>Parallel Processing</h3>

<p>We are using 'furrr' and the 'future' package to paralelize some of the
computational steps for calculating the predictions. It is up to the user
to register a compatible backend (see plan).
</p>


<h3>See Also</h3>

<p><code>alluvial_wide</code>,
<code>get_data_space</code>, <code>varImp</code>,
<code>extractPrediction</code>,
<code>get_data_space</code>,
<code>get_pdp_predictions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(check_pkg_installed("caret", raise_error = FALSE)) {
  df = mtcars2[, ! names(mtcars2) %in% 'ids' ]

  train = caret::train( disp ~ .,
                        df,
                        method = 'rf',
                        trControl = caret::trainControl( method = 'none' ),
                        importance = TRUE )

  alluvial_model_response_caret(train, df, degree = 3)
}
# partial dependency plotting method
## Not run: 
future::plan("multisession")
alluvial_model_response_caret(train, df, degree = 3, method = 'pdp', parallel = TRUE)
 
## End(Not run)
</code></pre>


</div>