<div class="container">

<table style="width: 100%;"><tr>
<td>drawEEMgg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw contour for EEM data using ggplot2</h2>

<h3>Description</h3>

<p>This function draw contour for EEM data using ggplot2. Use 'ggsave' to save the contours.
</p>


<h3>Usage</h3>

<pre><code class="language-R">drawEEMgg(x, ...)

## S3 method for class 'EEM'
drawEEMgg(x, n, textsize = 20, color.palette = matlab.like,
  nlevels = 20, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", main = NULL, has_legend = TRUE,
  zlim = NULL, breaks = waiver(), flipaxis = FALSE, ...)

## S3 method for class 'EEMweight'
drawEEMgg(x, ncomp, textsize = 25,
  color.palette = matlab.like, nlevels = 20,
  exlab = "Excitation wavelength [nm]", emlab = "Emission wavelength [nm]",
  main = NULL, has_legend = TRUE, zlim = NULL, breaks = waiver(),
  flipaxis = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of EEM data generated by <code>readEEM</code> function or 
EEMweight object generated by <code>extract</code>-related functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments for other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample number. The number should not exceed <code>length(EEM)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textsize</code></td>
<td>
<p>(optional) text size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p>(optional) contour color palette. See <code>palette</code> for more details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>(optional) number of levels used to separate range of intensity value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exlab</code></td>
<td>
<p>(optional) excitation-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emlab</code></td>
<td>
<p>(optional) emission-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>(optional) plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>has_legend</code></td>
<td>
<p>logical value for legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>zlim = c(min, max)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>breaks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flipaxis</code></td>
<td>
<p>(optional) flip axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of components</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>drawEEM</code> is faster and should be used.
</p>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>EEM</code>: draw EEM of EEM data created by <code>readEEM</code> function
</p>
</li>
<li> <p><code>EEMweight</code>: draw contours of the output from <code>getLoading</code> and 
<code>getReg</code>.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>drawEEM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
require(EEM)
require(ggplot2)
data(applejuice)
drawEEMgg(applejuice, 1) # draw EEM of sample no.1
drawEEMgg(applejuice, 1, color.palette = cm.colors) # draw EEM of sample no.31 with different color
drawEEMgg(applejuice, 1, nlevels = 10) # change nlevels

# manually define legend values
drawEEMgg(applejuice, 1, breaks = seq(from = 1000, to = 6000, by = 1000))

# can be combined with other ggplot2 commands
# add point to the plot
drawEEMgg(applejuice, 1) + geom_point(aes(x = 350, y = 500), pch = 17, cex = 10)

# add grid line to the plot
drawEEMgg(applejuice, 1) + theme(panel.grid = element_line(color = "grey"), 
panel.grid.major = element_line(colour = "grey"))

# add bg color
drawEEMgg(applejuice, 1, has_legend = FALSE) + geom_raster(aes(fill = value)) +
geom_contour(colour = "white")


## End(Not run)

</code></pre>


</div>