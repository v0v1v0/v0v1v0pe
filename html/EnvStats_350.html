<div class="container">

<table style="width: 100%;"><tr>
<td>NormalTrunc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Truncated Normal Distribution
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and random generation 
for the truncated normal distribution with parameters <code>mean</code>, 
<code>sd</code>, <code>min</code>, and <code>max</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  dnormTrunc(x, mean = 0, sd = 1, min = -Inf, max = Inf)
  pnormTrunc(q, mean = 0, sd = 1, min = -Inf, max = Inf)
  qnormTrunc(p, mean = 0, sd = 1, min = -Inf, max = Inf)
  rnormTrunc(n, mean = 0, sd = 1, min = -Inf, max = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>sample size.  If <code>length(n)</code> is larger than 1, then <code>length(n)</code> 
random values are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>

<p>vector of means of the distribution of the non-truncated random variable.  
The default is <code>mean=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>

<p>vector of (positive) standard deviations of the non-truncated random variable.  
The default is <code>sd=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>

<p>vector of minimum values for truncation on the left.  The default value is 
<code>min=-Inf</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>

<p>vector of maximum values for truncation on the right.  The default value is 
<code>max=Inf</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help file for the normal distribution 
for information about the density and cdf of a normal distribution.
</p>
<p><em>Probability Density and Cumulative Distribution Function</em> <br>
Let <code class="reqn">X</code> denote a random variable with density function <code class="reqn">f(x)</code> and 
cumulative distribution function <code class="reqn">F(x)</code>, and let 
<code class="reqn">Y</code> denote the truncated version of <code class="reqn">X</code> where <code class="reqn">Y</code> is truncated 
below at <code>min=</code><code class="reqn">A</code> and above at<code>max=</code><code class="reqn">B</code>.  Then the density 
function of <code class="reqn">Y</code>, denoted <code class="reqn">g(y)</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">g(y) = frac{f(y)}{F(B) - F(A)}, A \le y \le B</code>
</p>

<p>and the cdf of Y, denoted <code class="reqn">G(y)</code>, is given by:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">G(y) =</code>  </td>
<td style="text-align: left;">  0                                    </td>
<td style="text-align: left;"> for <code class="reqn">y &lt; A</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                  </td>
<td style="text-align: left;"> <code class="reqn">\frac{F(y) - F(A)}{F(B) - F(A)}</code> </td>
<td style="text-align: left;"> for <code class="reqn">A \le y \le B</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                  </td>
<td style="text-align: left;"> 1                                     </td>
<td style="text-align: left;"> for <code class="reqn">y &gt; B</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p><em>Quantiles</em> <br>
The <code class="reqn">p^{th}</code> quantile <code class="reqn">y_p</code> of <code class="reqn">Y</code> is given by:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">y_p =</code>  </td>
<td style="text-align: left;"> <code class="reqn">A</code>                                </td>
<td style="text-align: left;"> for <code class="reqn">p = 0</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> <code class="reqn">F^{-1}\{p[F(B) - F(A)] + F(A)\} </code> </td>
<td style="text-align: left;"> for <code class="reqn">0 &lt; p &lt; 1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> <code class="reqn">B</code>                                </td>
<td style="text-align: left;"> for <code class="reqn">p = 1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p><em>Random Numbers</em> <br>
Random numbers are generated using the inverse transformation method:
</p>
<p style="text-align: center;"><code class="reqn">y = G^{-1}(u)</code>
</p>

<p>where <code class="reqn">u</code> is a random deviate from a uniform <code class="reqn">[0, 1]</code> distribution. 
</p>
<p><em>Mean and Variance</em> <br>
The expected value of a truncated normal random variable with parameters 
<code>mean=</code><code class="reqn">\mu</code>, <code>sd=</code><code class="reqn">\sigma</code>, <code>min=</code><code class="reqn">A</code>, and 
<code>max=</code><code class="reqn">B</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">E(Y) = \mu + \sigma^2 \frac{f(A) - f(B)}{F(B) - F(A)}</code>
</p>

<p>(Johnson et al., 1994, p.156; Schneider, 1986, p.17).
</p>
<p>The variance of this random variable is given by:
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2 + \sigma^3 \{z_A f(A) - z_B f(B) - \sigma[f(A) - f(B)]^2 \}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">z_A = \frac{A - \mu}{\sigma}; \, z_B = \frac{B - \mu}{\sigma}</code>
</p>

<p>(Johnson et al., 1994, p.158; Schneider, 1986, p.17).
</p>


<h3>Value</h3>

<p><code>dnormTrunc</code> gives the density, <code>pnormTrunc</code> gives the distribution function, 
<code>qnormTrunc</code> gives the quantile function, and <code>rnormTrunc</code> generates random 
deviates. 
</p>


<h3>Note</h3>

<p>A truncated normal distribution is sometimes used as an input distribution 
for probabilistic risk assessment.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).  Statistical Distributions. 
Fourth Edition. John Wiley and Sons, Hoboken, NJ.
</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994). 
<em>Continuous Univariate Distributions, Volume 1</em>. 
Second Edition. John Wiley and Sons, New York.
</p>
<p>Schneider, H. (1986).  <em>Truncated and Censored Samples from Normal Populations</em>.  
Marcel Dekker, New York, Chapter 2.
</p>


<h3>See Also</h3>

<p>Normal,   
Probability Distributions and Random Numbers.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Density of a truncated normal distribution with parameters 
  # mean=10, sd=2, min=8, max=13, evaluated at 10 and 11.5:

  dnormTrunc(c(10, 11.5), 10, 2, 8, 13) 
  #[1] 0.2575358 0.1943982

  #----------

  # The cdf of a truncated normal distribution with parameters 
  # mean=10, sd=2, min=8, max=13, evaluated at 10 and 11.5:

  pnormTrunc(c(10, 11.5), 10, 2, 8, 13) 
  #[1] 0.4407078 0.7936573

  #----------

  # The median of a truncated normal distribution with parameters 
  # mean=10, sd=2, min=8, max=13:

  qnormTrunc(.5, 10, 2, 8, 13) 
  #[1] 10.23074

  #----------

  # A random sample of 3 observations from a truncated normal distribution 
  # with parameters mean=10, sd=2, min=8, max=13. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(20) 
  rnormTrunc(3, 10, 2, 8, 13) 
  #[1] 11.975223 11.373711  9.361258
</code></pre>


</div>