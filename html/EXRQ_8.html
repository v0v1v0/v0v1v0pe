<div class="container">

<table style="width: 100%;"><tr>
<td>testC.EVI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing the Constancy of EVI Over Covariates</h2>

<h3>Description</h3>

<p>This function tests whether the extreme value index of Y, gamma(x), is constant or varying across the covariate x by using the test procedure
described in Section 3.4 of Wang and Li (2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">testC.EVI(y, x, grid.lam = seq(-2, 2, 0.1), grid.k, tau.lam = 0.9,
  u.x = 0, a = 0, M = 2, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of n untransformed responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.lam</code></td>
<td>
<p>a grid of points for power-transformation parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.k</code></td>
<td>
<p>a grid of points for k, the number of upper order statistics involved in Hill estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.lam</code></td>
<td>
<p>the quantile level used for estimating the transformation parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.x</code></td>
<td>
<p>the proportion to be trimmed in the x direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>location shift parameter in the power transformation (introduced to avoid negative y values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a constant larger than one that is used for estimating the c vector and thus K(x) function. The default is two</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance level for checking quantile crossing issue</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following components
</p>
<p>lam: the estimated power-transformation parameter
</p>
<p>k: the selected tuning parameter k, the number of upper order statistics involved in Hill estimator
</p>
<p>Tm: the proposed test statistic
</p>
<p>scaledTm: the standardized test statistic
</p>
<p>pval.iid: the p-value based on iid assumption, that is, assuming that K(x)=1
</p>
<p>pval.nid: the p-value based on estimated K(x)=(X'C)^(1/EVI)
</p>
<p>gamma.bar: the pooled EVI estimator
</p>
<p>hat.gamma: a N-dimensional vector consisting of the estimated x-dependent EVI at x=xstar
</p>
<p>xstar: a N x p matrix of N observations and p predictors
</p>


<h3>References</h3>

<p>Wang, H. and Li, D. (2013). Estimation of conditional high quantiles through power transformation. Journal of the American Statistical Association, 108, 1062-1074.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(EXRQ)
n=500
tau.e = c(0.99, 0.993, 0.995)
set.seed(12368819)
x1 = runif(n, -1, 1)
x2 = runif(n, -1, 1)
sqrty = 2 + x1 + x2 + (1+0.8*x1)*rpareto(n, 0.5)
x = as.matrix(cbind(x1, x2))
y = sqrty^2
out = testC.EVI(y, x, grid.lam=seq(-0.5, 1.5, 0.1), grid.k=50, tau.lam=0.9)
(Tval = out$scaledTm)
(pval.iid = out$pval.iid)
(pval.nid = out$pval.nid)
</code></pre>


</div>