<div class="container">

<table style="width: 100%;"><tr>
<td>hillplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hill Plot</h2>

<h3>Description</h3>

<p>Plots the Hill plot and some its variants.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hillplot(data, orderlim = NULL, tlim = NULL, hill.type = "Hill",
  r = 2, x.theta = FALSE, y.alpha = FALSE, alpha = 0.05,
  ylim = NULL, legend.loc = "topright",
  try.thresh = quantile(data[data &gt; 0], 0.9, na.rm = TRUE),
  main = paste(ifelse(x.theta, "Alt", ""), hill.type, " Plot", sep = ""),
  xlab = ifelse(x.theta, "theta", "order"),
  ylab = paste(ifelse(x.theta, "Alt", ""), hill.type, ifelse(y.alpha,
  " alpha", " xi"), "&gt;0", sep = ""), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>vector of sample data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderlim</code></td>
<td>
<p>vector of (lower, upper) limits of order statistics
to plot estimator, or <code>NULL</code> to use default values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>vector of (lower, upper) limits of range of threshold
to plot estimator, or <code>NULL</code> to use default values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hill.type</code></td>
<td>
<p>"Hill" or "SmooHill"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>smoothing factor for "SmooHill" (integer &gt; 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.theta</code></td>
<td>
<p>logical, should order (<code>FALSE</code>) or theta (<code>TRUE</code>) be given on x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.alpha</code></td>
<td>
<p>logical, should shape xi (<code>FALSE</code>) or tail index alpha (<code>TRUE</code>) be given on y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level over range (0, 1), or <code>NULL</code> for no CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-axis limits or <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.loc</code></td>
<td>
<p>location of legend (see <code>legend</code>) or <code>NULL</code> for no legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try.thresh</code></td>
<td>
<p>vector of thresholds to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the plotting functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces the Hill, AltHill, SmooHill and AltSmooHill plots,
including confidence intervals.
</p>
<p>For an ordered iid sequence <code class="reqn">X_{(1)}\ge X_{(2)}\ge\cdots\ge X_{(n)} &gt; 0</code> 
the Hill (1975) estimator using <code class="reqn">k</code> order statistics is given by 
</p>
<p style="text-align: center;"><code class="reqn">H_{k,n}=\frac{1}{k}\sum_{i=1}^{k} \log(\frac{X_{(i)}}{X_{(k+1)}})</code>
</p>

<p>which is the pseudo-likelihood estimator of reciprocal of the tail index <code class="reqn">\xi=/\alpha&gt;0</code>
for regularly varying tails (e.g. Pareto distribution).  The Hill estimator
is defined on orders <code class="reqn">k&gt;2</code>, as when<code class="reqn">k=1</code> the </p>
<p style="text-align: center;"><code class="reqn">H_{1,n}=0</code>
</p>
<p>. The
function will calculate the Hill estimator for <code class="reqn">k\ge 1</code>.
The simple Hill plot is shown for <code>hill.type="Hill"</code>.
</p>
<p>Once a sufficiently low order statistic is reached the Hill estimator will
be constant, upto sample uncertainty, for regularly varying tails. The Hill
plot is a plot of </p>
<p style="text-align: center;"><code class="reqn">H_{k,n}</code>
</p>
<p> against the <code class="reqn">k</code>. Symmetric asymptotic
normal confidence intervals assuming Pareto tails are provided.
</p>
<p>These so called Hill's horror plots can be difficult to interpret. A smooth
form of the Hill estimator was suggested by Resnick and Starica (1997): 
</p>
<p style="text-align: center;"><code class="reqn">smooH_{k,n}=\frac{1}{(r-1)k}\sum_{j=k+1}^{rk} H_{j,n}</code>
</p>
<p> giving the
smooHill plot which is shown for <code>hill.type="SmooHill"</code>. The smoothing
factor is <code>r=2</code> by default.
</p>
<p>It has also been suggested to plot the order on a log scale, by plotting
the points <code class="reqn">(\theta, H_{\lceil n^\theta\rceil, n})</code> for 
<code class="reqn">0\le \theta \le 1</code>. This gives the so called AltHill and AltSmooHill
plots. The alternative x-axis scale is chosen by <code>x.theta=TRUE</code>.
</p>
<p>The Hill estimator is for the GPD shape <code class="reqn">\xi&gt;0</code>, or the reciprocal of the
tail index <code class="reqn">\alpha=1/\xi&gt;0</code>. The shape is plotted by default using
<code>y.alpha=FALSE</code> and the tail index is plotted when <code>y.alpha=TRUE</code>.
</p>
<p>A pre-chosen threshold (or more than one) can be given in
<code>try.thresh</code>. The estimated parameter (<code class="reqn">\xi</code> or <code class="reqn">\alpha</code>) at
each threshold are plot by a horizontal solid line for all higher thresholds. 
The threshold should be set as low as possible, so a dashed line is shown
below the pre-chosen threshold. If the Hill estimator is similar to the
dashed line then a lower threshold may be chosen.
</p>
<p>If no order statistic (or threshold) limits are provided <code>orderlim =
  tlim = NULL</code> then the lowest order statistic is set to <code class="reqn">X_{(3)}</code> and
highest possible value <code class="reqn">X_{(n-1)}</code>. However, the Hill estimator is always
output for all <code class="reqn">k=1, \ldots, n-1</code> and <code class="reqn">k=1, \ldots, floor(n/k)</code> for
smooHill estimator.
</p>
<p>The missing (<code>NA</code> and <code>NaN</code>) and non-finite values are ignored.
Non-positive data are ignored.
</p>
<p>The lower x-axis is the order <code class="reqn">k</code> or <code class="reqn">\theta</code>, chosen by the option
<code>x.theta=FALSE</code> and <code>x.theta=TRUE</code> respectively. The upper axis
is for the corresponding threshold.
</p>


<h3>Value</h3>

<p><code>hillplot</code> gives the Hill plot. It also 
returns a dataframe containing columns of the order statistics, order, Hill
estimator, it's standard devation and <code class="reqn">100(1 - \alpha)\%</code> confidence
interval (when requested). When the SmooHill plot is selected, then the corresponding
SmooHill estimates are appended.
</p>


<h3>Acknowledgments</h3>

<p>Thanks to Younes Mouatasim, Risk Dynamics, Brussels for reporting various bugs in these functions.
</p>


<h3>Note</h3>

<p>Warning: Hill plots are not location invariant.
</p>
<p>Asymptotic Wald type CI's are estimated for non-<code>NULL</code> signficance level <code>alpha</code>
for the shape parameter, assuming exactly Pareto tails. When plotting on the tail index scale,
then a simple  reciprocal transform of the CI is applied which may be sub-optimal.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p>Hill, B.M. (1975). A simple general approach to inference about the tail of a distribution. Annals of Statistics 13, 331-341.
</p>
<p>Resnick, S. and Starica, C. (1997). Smoothing the Hill estimator. Advances in Applied Probability 29, 271-293.
</p>
<p>Resnick, S. (1997). Discussion of the Danish Data of Large Fire Insurance Losses. Astin Bulletin 27, 139-151.
</p>


<h3>See Also</h3>

<p><code>hill</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Reproduce graphs from Figure 2.4 of Resnick (1997)
data(danish, package="evir")
par(mfrow = c(2, 2))

# Hill plot
hillplot(danish, y.alpha=TRUE, ylim=c(1.1, 2))

# AltHill plot
hillplot(danish, y.alpha=TRUE, x.theta=TRUE, ylim=c(1.1, 2))

# AltSmooHill plot
hillplot(danish, hill.type="SmooHill", r=3, y.alpha=TRUE, x.theta=TRUE, ylim=c(1.35, 1.85))

# AltHill and AltSmooHill plot (no CI's or legend)
hillout = hillplot(danish, hill.type="SmooHill", r=3, y.alpha=TRUE, 
 x.theta=TRUE, try.thresh = c(), alpha=NULL, ylim=c(1.1, 2), legend.loc=NULL, lty=2)
n = length(danish)
with(hillout[3:n,], lines(log(ks)/log(n), 1/H, type="s"))

## End(Not run)
</code></pre>


</div>