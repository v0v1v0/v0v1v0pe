<div class="container">

<table style="width: 100%;"><tr>
<td>drbasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computation of the Demmler-Reinsch basis.
</h2>

<h3>Description</h3>

<p>The Demmler-Reinsch basis is provided for a given smoothness degree in a uniform grid. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">drbasis(nn,qq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>Number of design points in the uniform grid. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qq</code></td>
<td>
<p>Smoothness degree of the basis.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The use of large numbers required by the basis is handled by the package Brobdingnag. The method assumes the grid is equidistant. Missing values are not supported.
</p>


<h3>Value</h3>

<p>A list object containing the following information.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>estimadted eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvectors</code></td>
<td>
<p>estimated eigenvectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvectorsQR</code></td>
<td>
<p>orthonormal eigenvectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>equidistant grid used to build the basis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francisco Rosales
</p>


<h3>References</h3>

<p>Rosales F. (2016). <br>
Empirical Bayesian Smoothing Splines for Signals with Correlated Errors: Methods and Applications
</p>
<p>Serra, P. and Krivobokova, T. (2015)<br>
Adaptive Empirical Bayesian Smoothing Splines
</p>


<h3>Examples</h3>

<pre><code class="language-R">oldpar &lt;- par(no.readonly = TRUE)
#plot elements of the basis
library(eBsc)
n &lt;- 100
Basis &lt;- list()
for(i in 1:6){Basis[[i]] &lt;- drbasis( nn = n, qq = i)}

#eigenvalues
par(mfrow = c(3,2), mar = c(4,2,2,2))
for(i in 1:6){
name &lt;- paste("Eigenvalues (q = ",i,")", sep = "")
plot(Basis[[i]]$eigenvalues,
type = 'l', lwd = 2, xlab = "x", ylab = "", main = name)	
}
par(oldpar) 

#eigenvectors for q = 3
par(mfrow = c(3,2), mar = c(4,2,2,2))
for(i in 1:6){
name &lt;- paste("Eigenvector n. ", i + 3, sep = "")
plot(Basis[[i]]$eigenvectorsQR[, i + 3],
type = 'l', lwd = 2, xlab = "x", ylab = "", main = name)	
}
par(oldpar) 

#example of a smooth function in the Demmler-Reinsch basis
library(eBsc)
n &lt;- 200
Basis &lt;- list()
for(i in 1:6){Basis[[i]] &lt;- drbasis(nn = n, qq = i)}
coef3 &lt;- c(rep(0,3), (pi*(2:(n-2))) ^ (-3.1)) * (cos(2*(1:n)))
A3 &lt;- Basis[[3]]$eigenvectors
mu &lt;- -A3%*%coef3
mu &lt;- (mu - min(mu)) / (max(mu) - min(mu))
plot(mu, xlab = "x", ylab = "mu", type = 'l', lwd = 2)
par(oldpar)

</code></pre>


</div>