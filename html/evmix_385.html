<div class="container">

<table style="width: 100%;"><tr>
<td>gpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalised Pareto Distribution (GPD)</h2>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and
random number generation for the generalised Pareto distribution, either
as a conditional on being above the threshold <code>u</code> or unconditional.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgpd(x, u = 0, sigmau = 1, xi = 0, phiu = 1, log = FALSE)

pgpd(q, u = 0, sigmau = 1, xi = 0, phiu = 1, lower.tail = TRUE)

qgpd(p, u = 0, sigmau = 1, xi = 0, phiu = 1, lower.tail = TRUE)

rgpd(n = 1, u = 0, sigmau = 1, xi = 0, phiu = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau</code></td>
<td>
<p>scale parameter (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiu</code></td>
<td>
<p>probability of being above threshold <code class="reqn">[0, 1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if TRUE then log density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical, if FALSE then upper tail probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>cumulative probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size (positive integer)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The GPD with parameters scale <code class="reqn">\sigma_u</code> and shape <code class="reqn">\xi</code> has
conditional density of being above the threshold <code>u</code> given by
</p>
<p style="text-align: center;"><code class="reqn">f(x | X &gt; u) = 1/\sigma_u [1 + \xi(x - u)/\sigma_u]^{-1/\xi - 1}</code>
</p>

<p>for non-zero <code class="reqn">\xi</code>, <code class="reqn">x &gt; u</code> and <code class="reqn">\sigma_u &gt; 0</code>. Further, 
<code class="reqn">[1+\xi (x - u) / \sigma_u] &gt; 0</code> which for <code class="reqn">\xi &lt; 0</code> implies 
<code class="reqn">u &lt; x \le u - \sigma_u/\xi</code>. In the special case of <code class="reqn">\xi = 0</code>
considered in the limit <code class="reqn">\xi \rightarrow 0</code>, which is
treated here as <code class="reqn">|\xi| &lt; 1e-6</code>, it reduces to the exponential:
</p>
<p style="text-align: center;"><code class="reqn">f(x | X &gt; u) = 1/\sigma_u exp(-(x - u)/\sigma_u).</code>
</p>

<p>The unconditional density is obtained by mutltiplying this by the
survival probability (or <em>tail fraction</em>) <code class="reqn">\phi_u = P(X &gt; u)</code>
giving <code class="reqn">f(x) = \phi_u f(x | X &gt; u)</code>.
</p>
<p>The syntax of these functions are similar to those of the 
<code>evd</code> package, so most code using these functions can
be reused. The key difference is the introduction of <code>phiu</code> to
permit output of unconditional quantities.
</p>


<h3>Value</h3>

<p><code>dgpd</code> gives the density,
<code>pgpd</code> gives the cumulative distribution function,
<code>qgpd</code> gives the quantile function and 
<code>rgpd</code> gives a random sample.
</p>


<h3>Acknowledgments</h3>

<p>Based on the
<code>gpd</code> functions in the <code>evd</code> package for which their author's contributions are gratefully acknowledged.
They are designed to have similar syntax and functionality to simplify the transition for users of these packages.
</p>


<h3>Note</h3>

<p>All inputs are vectorised except <code>log</code> and <code>lower.tail</code>.
The main inputs (<code>x</code>, <code>p</code> or <code>q</code>) and parameters must be either
a scalar or a vector. If vectors are provided they must all be of the same length,
and the function will be evaluated for each element of vector. In the case of 
<code>rgpd</code> any input vector must be of length <code>n</code>.
</p>
<p>Default values are provided for all inputs, except for the fundamentals 
<code>x</code>, <code>q</code> and <code>p</code>. The default threshold <code>u=0</code> and tail fraction
<code>phiu=1</code> which essentially assumes the user provide excesses above 
<code>u</code> by default, rather than exceedances. The default sample size for 
<code>rgpd</code> is 1.
</p>
<p>Missing (<code>NA</code>) and Not-a-Number (<code>NaN</code>) values in <code>x</code>,
<code>p</code> and <code>q</code> are passed through as is and infinite values are set to
<code>NA</code>. None of these are not permitted for the parameters.
</p>
<p>Some key differences arise for <code>phiu=1</code> and <code>phiu&lt;1</code> (see examples below):
</p>

<ol>
<li>
<p> For <code>phiu=1</code> the <code>dgpd</code> evaluates as zero for
quantiles below the threshold <code>u</code> and <code>pgpd</code>
evaluates over <code class="reqn">[0, 1]</code>.
</p>
</li>
<li>
<p> For <code>phiu=1</code> then <code>pgpd</code> evaluates as zero
below the threshold <code>u</code>. For <code>phiu&lt;1</code> it evaluates as <code class="reqn">1-\phi_u</code> at
the threshold and <code>NA</code> below the threshold.
</p>
</li>
<li>
<p> For <code>phiu=1</code> the quantiles from <code>qgpd</code> are
above threshold and equal to threshold for <code>phiu=0</code>. For <code>phiu&lt;1</code> then
within upper tail, <code>p &gt; 1 - phiu</code>, it will give conditional quantiles
above threshold, but when below the threshold, <code>p &lt;= 1 - phiu</code>, these
are set to <code>NA</code>.
</p>
</li>
<li>
<p> When simulating GPD variates using <code>rgpd</code> if
<code>phiu=1</code> then all values are above the threshold. For <code>phiu&lt;1</code> then
a standard uniform <code class="reqn">U</code> is simulated and the variate will be classified as
above the threshold if <code class="reqn">u&lt;\phi</code>, and below the threshold otherwise. This is
equivalent to a binomial random variable for simulated number of exceedances. Those
above the threshold are then simulated from the conditional GPD and those below
the threshold and set to <code>NA</code>.
</p>
</li>
</ol>
<p>These conditions are intuitive and consistent with <code>evd</code>,
which assumes missing data are below threshold.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Yang Hu and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p>Hu Y. and Scarrott, C.J. (2018). evmix: An R Package for Extreme Value Mixture Modeling, 
Threshold Estimation and Boundary Corrected Kernel Density Estimation. Journal of
Statistical Software 84(5), 1-27. doi: 10.18637/jss.v084.i05.
</p>
<p>Coles, S.G. (2001). An Introduction to Statistical Modelling of Extreme Values.
Springer Series in Statistics. Springer-Verlag: London.
</p>


<h3>See Also</h3>

<p><code>evd</code> package and <code>fpot</code>
</p>
<p>Other gpd: <code>fgpd</code>
</p>
<p>Other fgpd: <code>fgpd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
par(mfrow = c(2, 2))

x = rgpd(1000) # simulate sample from GPD
xx = seq(-1, 10, 0.01)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 10))
lines(xx, dgpd(xx))

# three tail behaviours
plot(xx, pgpd(xx), type = "l")
lines(xx, pgpd(xx, xi = 0.3), col = "red")
lines(xx, pgpd(xx, xi = -0.3), col = "blue")
legend("bottomright", paste("xi =",c(0, 0.3, -0.3)),
  col=c("black", "red", "blue"), lty = 1)

# GPD when xi=0 is exponential, and demonstrating phiu
x = rexp(1000)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 10))
lines(xx, dgpd(xx, u = 0, sigmau = 1, xi = 0), lwd = 2)
lines(xx, dgpd(xx, u = 0.5, phiu = 1 - pexp(0.5)), col = "red", lwd = 2)
lines(xx, dgpd(xx, u = 1.5, phiu = 1 - pexp(1.5)), col = "blue", lwd = 2)
legend("topright", paste("u =",c(0, 0.5, 1.5)),
  col=c("black", "red", "blue"), lty = 1, lwd = 2)

# Quantile function and phiu
p = pgpd(xx)
plot(qgpd(p), p, type = "l")
lines(xx, pgpd(xx, u = 2), col = "red")
lines(xx, pgpd(xx, u = 5, phiu = 0.2), col = "blue")
legend("bottomright", c("u = 0 phiu = 1","u = 2 phiu = 1","u = 5 phiu = 0.2"),
  col=c("black", "red", "blue"), lty = 1)
  
</code></pre>


</div>