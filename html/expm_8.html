<div class="container">

<table style="width: 100%;"><tr>
<td>expm.Higham08</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix Exponential [Higham 2008]</h2>

<h3>Description</h3>

<p>Calculation of matrix exponential <code class="reqn">e^A</code> with the ‘Scaling &amp;
Squaring’ method with balancing.
</p>
<p>Implementation of Higham's Algorithm from his book (see references),
Chapter 10, Algorithm 10.20.
</p>
<p>The balancing option is an extra from Michael Stadelmann's Masters thesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expm.Higham08(A, balancing = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>square matrix, may be a <code>"sparseMatrix"</code>,
currently only if <code>balancing</code> is false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balancing</code></td>
<td>
<p>logical indicating if balancing should happen (before
and after scaling and squaring).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm comprises the following steps
</p>

<dl>
<dt>0.</dt>
<dd>
<p>Balancing</p>
</dd>
<dt>1.</dt>
<dd>
<p>Scaling</p>
</dd>
<dt>2.</dt>
<dd>
<p>Padé-Approximation</p>
</dd>
<dt>3.</dt>
<dd>
<p>Squaring</p>
</dd>
<dt>4.</dt>
<dd>
<p>Reverse Balancing</p>
</dd>
</dl>
<h3>Value</h3>

<p>a matrix of the same dimension as <code>A</code>, the matrix exponential of <code>A</code>.
</p>


<h3>Note</h3>

<p><code>expm.Higham8()</code> no longer needs to be called directly; rather
<code>expm(A, "Higham8b")</code> and <code>expm(A, "Higham8")</code> correspond to
the two options of <code>balancing = TRUE || FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Michael Stadelmann (final polish by Martin Maechler).
</p>


<h3>References</h3>

<p>Higham, Nicholas J. (2008).
<em>Functions of Matrices: Theory and Computation</em>;
SIAM (Society for Industrial and Applied Mathematics), Philadelphia, USA;
<a href="https://doi.org/10.1137/1.9780898717778">doi:10.1137/1.9780898717778</a>
</p>
<p>Michael Stadelmann (2009).
<em>Matrixfunktionen; Analyse und Implementierung</em>.
[in German] Master's thesis and Research Report 2009-12, SAM, ETH Zurich;
<a href="https://math.ethz.ch/sam/research/reports.html?year=2009">https://math.ethz.ch/sam/research/reports.html?year=2009</a>, or the
pdf directly at
<a href="https://www.sam.math.ethz.ch/sam_reports/reports_final/reports2009/2009-12.pdf">https://www.sam.math.ethz.ch/sam_reports/reports_final/reports2009/2009-12.pdf</a>.
</p>


<h3>See Also</h3>

<p>The other algorithms <code>expm(x, method = *)</code>.
</p>
<p><code>expmCond</code>, to compute the exponential-<em>condition</em> number.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The *same* examples as in ../expm.Rd  {FIXME} --
x &lt;- matrix(c(-49, -64, 24, 31), 2, 2)
expm.Higham08(x)

## ----------------------------
## Test case 1 from Ward (1977)
## ----------------------------
test1 &lt;- t(matrix(c(
    4, 2, 0,
    1, 4, 1,
    1, 1, 4), 3, 3))
expm.Higham08(test1)
##                    [,1]               [,2]               [,3]
## [1,] 147.86662244637000 183.76513864636857  71.79703239999643
## [2,] 127.78108552318250 183.76513864636877  91.88256932318409
## [3,] 127.78108552318204 163.67960172318047 111.96810624637124
## -- these agree with ward (1977, p608)


## ----------------------------
## Test case 2 from Ward (1977)
## ----------------------------
test2 &lt;- t(matrix(c(
    29.87942128909879, .7815750847907159, -2.289519314033932,
    .7815750847907159, 25.72656945571064,  8.680737820540137,
   -2.289519314033932, 8.680737820540137,  34.39400925519054),
           3, 3))
expm.Higham08(test2)
expm.Higham08(test2, balancing = FALSE)
##                   [,1]               [,2]               [,3]
##[1,]   5496313853692405 -18231880972009100 -30475770808580196
##[2,] -18231880972009160  60605228702221760 101291842930249376
##[3,] -30475770808580244 101291842930249200 169294411240850880
## -- in this case a very similar degree of accuracy.

## ----------------------------
## Test case 3 from Ward (1977)
## ----------------------------
test3 &lt;- t(matrix(c(
    -131, 19, 18,
    -390, 56, 54,
    -387, 57, 52), 3, 3))
expm.Higham08(test3)
expm.Higham08(test3, balancing = FALSE)
##                    [,1]                [,2]                [,3]
##[1,] -1.5096441587713636 0.36787943910439874 0.13533528117301735
##[2,] -5.6325707997970271 1.47151775847745725 0.40600584351567010
##[3,] -4.9349383260294299 1.10363831731417195 0.54134112675653534
## -- agrees to 10dp with Ward (1977), p608. ??? (FIXME)

## ----------------------------
## Test case 4 from Ward (1977)
## ----------------------------
test4 &lt;-
    structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 1e-10,
                1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 1, 0),
    .Dim = c(10, 10))

E4 &lt;- expm.Higham08(test4)
Matrix(zapsmall(E4))

S4 &lt;- as(test4, "sparseMatrix") # some R based expm() methods work for sparse:
ES4 &lt;- expm.Higham08(S4, bal=FALSE)
stopifnot(all.equal(E4, unname(as.matrix(ES4))))
## NOTE: Need much larger sparse matrices for sparse arith to be faster!

##
## example of computationally singular matrix
##
m &lt;- matrix(c(0,1,0,0), 2,2)
eS &lt;- expm.Higham08(m)  # "works"  (hmm ...)
</code></pre>


</div>