<div class="container">

<table style="width: 100%;"><tr>
<td>findMode</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finding the mode of the empirical saddlepoint density</h2>

<h3>Description</h3>

<p>Given a sample from a d-dimensional distribution, the routine
finds the mode of the corresponding Extended Empirical Saddlepoint (EES) density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findMode(
  X,
  decay,
  init = NULL,
  method = "BFGS",
  hess = FALSE,
  sadControl = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an n by d matrix containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decay</code></td>
<td>
<p>rate at which the SPA falls back on a normal density. Should be a positive number. See Fasiolo et al. (2016)
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>d-dimensional vector containing the starting point for the optimization. By default
it is equal to <code>colMeans(X)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method used by <code>stats::optim()</code>, see ?optim for details. By default it is "BFGS".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>if TRUE also an estimate of the Hessian at the mode will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sadControl</code></td>
<td>
<p>list corresponding to the <code>control</code> argument in the <code>dsaddle</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments to be passed to the optimization routine <code>stats::optim</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list where <code>mode</code> is the location of mode of the empirical saddlepoint density,
<code>logDens</code> is the log-density at the mode and <code>hess</code> (present only if argument <code>hess==TRUE</code>)
is the approximate Hessian at convergence. The other entries are the same as for <code>stats::optim</code>.
</p>


<h3>Author(s)</h3>

<p>Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.
</p>


<h3>References</h3>

<p>Fasiolo, M., Wood, S. N., Hartig, F. and Bravington, M. V. (2016). 
An Extended Empirical Saddlepoint Approximation for Intractable Likelihoods. ArXiv http://arxiv.org/abs/1601.01849.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># library(esaddle)
set.seed(4141)
x &lt;- rgamma(1000, 2, 1)

# Fixing tuning parameter of EES
decay &lt;-  0.05

# Evaluating EES at several point
xSeq &lt;- seq(-2, 8, length.out = 200)
tmp &lt;- dsaddle(y = xSeq, X = x, decay = decay, log = TRUE)  # Un-normalized EES

# Plotting true density, EES and normal approximation
plot(xSeq, exp(tmp$llk), type = 'l', ylab = "Density", xlab = "x")
lines(xSeq, dgamma(xSeq, 2, 1), col = 3)
suppressWarnings( rug(x) )
legend("topright", c("EES", "Truth"), col = c(1, 3), lty = 1)

# Find mode and plot it
res &lt;- findMode(x, init = mean(x), decay = decay)$mode
abline(v = res, lty = 2, lwd = 1.5)
</code></pre>


</div>