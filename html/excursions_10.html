<div class="container">

<table style="width: 100%;"><tr>
<td>excursions.variances</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate variances from a sparse precision matrix</h2>

<h3>Description</h3>

<p><code>excursions.variances</code> calculates the diagonal of the inverse of a sparse
symmetric positive definite matrix <code>Q</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">excursions.variances(L, Q, max.threads = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Cholesky factor of precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.threads</code></td>
<td>
<p>Decides the number of threads the program can use. Set to 0 for using
the maximum number of threads allowed by the system (default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method for calculating the
diagonal requires the Cholesky factor, <code>L</code>, of <code>Q</code>, which should be supplied if
available. If <code>Q</code> is provided, the cholesky factor is
calculated and the variances are then returned in the same ordering as <code>Q</code>.
If <code>L</code> is provided, the variances are returned in the same ordering as <code>L</code>,
even if <code>L@invpivot</code> exists.
</p>


<h3>Value</h3>

<p>A vector with the variances.
</p>


<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a tridiagonal precision matrix
n &lt;- 21
Q &lt;- Matrix(toeplitz(c(1, -0.1, rep(0, n - 2))))
v2 &lt;- excursions.variances(Q = Q, max.threads = 2)
## var2 should be the same as:
v1 &lt;- diag(solve(Q))
</code></pre>


</div>