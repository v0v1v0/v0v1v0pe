<div class="container">

<table style="width: 100%;"><tr>
<td>pFailure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability of falling into a failure region</h2>

<h3>Description</h3>

<p>This function computes the empirical estimate of the probability of falling into two types of failure regions.</p>


<h3>Usage</h3>

<pre><code class="language-R">pFailure(n, beta, u1, u2, mar1, mar2, type, plot, xlab, ylab, 
         nlevels=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer indicating the number of points generated to compute the empirical probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A vector representing the Bernstein polynomial coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1, u2</code></td>
<td>
<p>Vectors of positive reals representing some high thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar1, mar2</code></td>
<td>
<p>Vectors of marginal (GEV) parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating if the failure region includes at least one exceedance (<code>"or"</code>), or both exceednaces (<code>"and"</code>). If <code>"both"</code> then probabilities to fall in both regions are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A logical value; if <code>TRUE</code> contour plots of the probalities are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>A character string equivalent representing the graphical parameters as in <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>The number of contour levels to be displayed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The two failure regions are:
</p>
<p style="text-align: center;"><code class="reqn">A_u = \left\{ (v_1, v_2): v_1&gt;u_1 \textrm{ or } v_2 &gt; u_2\right\} </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">B_u = \left\{ (v_1, v_2): v_1&gt;u_1 \textrm{ and } v_2 &gt; u_2\right\} </code>
</p>

<p>where <code class="reqn">(v_1,v_2) \in R_+^2</code> and <code class="reqn">u_1, u_2&gt;0</code>.
</p>
<p>Exceedances samples <code class="reqn">y_{1,1}, \ldots, y_{n_1}</code> and <code class="reqn">y_{1,2}, \ldots, y_{n_2}</code> are generating according to Algorithm 3 of Marcon et al. (2017) and the the estimates of the probability of falling in <code class="reqn">A_u</code> and <code class="reqn">B_u</code> are given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{A_u} = \frac{1}{n}\sum{i=1}^n I\left\{ y_{i,1}&gt; u_1^* \textrm{ or } y_{i,2}&gt; u_2^* \right\} </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{B_u} = \frac{1}{n}\sum{i=1}^n I\left\{ y_{i,1}&gt; u_1^* \textrm{ and } y_{i,2}&gt; u_2^* \right\} </code>
</p>



<h3>Value</h3>

<p>A list containing <code>AND</code> and/or <code>OR</code>, depending on the <code>type</code> argument. Each element is a <code>length(u1) x length(u2)</code> matrix.   
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Marcon, G., Naveau, P. and Padoan, S.A. (2017)
A semi-parametric stochastic generator for bivariate extreme events
<em>Stat</em>, <b>6</b>, 184-201.
</p>


<h3>See Also</h3>

<p><code>dExtDep</code>, <code>rExtDep</code>, <code>fExtDep</code>, <code>fExtDep.np</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example wind speed and wind gust

data(WindSpeedGust)
years &lt;- format(ParcayMeslay$time, format="%Y")
attach(ParcayMeslay[which(years %in% c(2004:2013)),])
  
WS_th &lt;- quantile(WS,.9)
DP_th &lt;- quantile(DP,.9)
  
pars.WS &lt;- evd::fpot(WS, WS_th, model="pp")$estimate
pars.DP &lt;- evd::fpot(DP, DP_th, model="pp")$estimate
  
data_uf &lt;- trans2UFrechet(cbind(WS,DP), type="Empirical")
  
rdata &lt;- rowSums(data_uf)
r0 &lt;- quantile(rdata, probs=.90)
extdata &lt;- data_uf[rdata&gt;=r0,]
  
SP_mle &lt;- fExtDep.np(method="Frequentist", data=extdata, k0=10, 
                     type="maxima")


  pF &lt;- pFailure(n=50000, beta=SP_mle$Ahat$beta,
                 u1=seq(from=19, to=28, length=200), mar1=pars.WS,
                 u2=seq(from=40, to=60, length=200), mar2=pars.DP, 
                 type="both", plot=TRUE, 
                 xlab="Daily-maximum Wind Speed (m/s)",
                 ylab="Differential of Pressure (mbar)", nlevels=15)


</code></pre>


</div>