<div class="container">

<table style="width: 100%;"><tr>
<td>CommunityProfile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diversity or Entropy Profile of a community
</h2>

<h3>Description</h3>

<p>Calculates the diversity or entropy profile of a community, applying a community function to a vector of orders.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CommunityProfile(FUN, NorP, q.seq = seq(0, 2, 0.1), 
    NumberOfSimulations = 0, Alpha = 0.05, BootstrapMethod = "Chao2015", 
    size = 1, ..., ShowProgressBar = TRUE, CheckArguments = TRUE)
as.CommunityProfile(x, y, low = NULL, high = NULL, mid = NULL)
is.CommunityProfile(x)
## S3 method for class 'CommunityProfile'
plot(x, ..., main = NULL, 
          xlab = "Order of Diversity", ylab = "Diversity", ylim = NULL,
          LineWidth = 2, ShadeColor = "grey75", BorderColor = "red")
## S3 method for class 'CommunityProfile'
autoplot(object, ..., main = NULL, 
          xlab = "Order of Diversity", ylab = "Diversity",
          ShadeColor = "grey75", alpha = 0.3, BorderColor = "red",
          col = ggplot2::GeomLine$default_aes$colour,
          lty = ggplot2::GeomLine$default_aes$linetype,
          lwd = ggplot2::GeomLine$default_aes$size)
CEnvelope(Profile, LineWidth = 2, ShadeColor = "grey75", BorderColor = "red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>The function to be applied to each value of <code class="reqn">q.seq</code>. Any function accepting a numeric vector (or a two-column matrix) and a number as first two arguments and an argument named <code>CheckArguments</code> is acceptable (other arguments of the functions are passed by <code>...</code>). See *Details* for useful entropy and diversity functions and *Examples* for an ad-hoc one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NorP</code></td>
<td>

<p>A numeric vector. Contains either abundances or probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.seq</code></td>
<td>

<p>A numeric vector: the sequence of diversity orders to address. Default is from 0 to 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumberOfSimulations</code></td>
<td>

<p>The number of simulations to run, 0 by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>

<p>The risk level, 5% by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BootstrapMethod</code></td>
<td>

<p>The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. See <code>rCommunity</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>The size of simulated communities used to compute the bootstrap confidence envelope. 1 (default) means that the actual size must be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object to be tested or plotted or the vector of orders of community profiles in <code>as.CommunityProfile</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Entropy or diversity values of each order, corresponding to <code>x</code> values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>

<p>Entropy or diversity lower bound of the confidence envelope, corresponding to <code>x</code> values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high</code></td>
<td>

<p>Entropy or diversity higher bound of the confidence envelope, corresponding to <code>x</code> values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mid</code></td>
<td>

<p>Entropy or diversity center value (usually the mean) of the confidence envelope, corresponding to <code>x</code> values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Profile</code></td>
<td>

<p>An <code>CommunityProfile</code> to be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to <code>FUN</code> in <code>CommunityProfile</code>, to <code>plot</code> in <code>plot.CommunityProfile</code> or to <code>lines</code> in <code>CEnvelope</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>The main title of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>The x axis label of the plots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>The y axis label of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>The interval of y values plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LineWidth</code></td>
<td>

<p>The width of the line that represents the actual profile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ShadeColor</code></td>
<td>

<p>The color of the shaded confidence envelope.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BorderColor</code></td>
<td>

<p>The color of the bounds of the confidence envelope.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Opacity of the confidence enveloppe, between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>The color of the geom objects. See "Color Specification" in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>The type of the lines. See <code>lines</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>The width of the lines. See <code>lines</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ShowProgressBar</code></td>
<td>

<p>If <code>TRUE</code> (default), a progress bar is shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>CommunityProfile</code> is used to calculate diversity or entropy profiles based on community functions such as <code>Tsallis</code> or <code>ChaoPD</code>. 
The first two arguments of the function must be a probability or abundance vector and a number (<code class="reqn">q</code>).
Additional arguments cannot be checked. 
Unexpected results may be returned if <code>FUN</code> is not used properly.
</p>
<p>If <code>NumberOfSimulations</code> is greater than 0, a bootstrap confidence interval is produced by simulating communities with <code>rCommunity</code> and calculating their profiles. 
The size of those communities may be that of the actual community or specified by <code>size</code>.
Simulating communities implies a downward bias in the estimation: rare species of the actual community may have abundance zero in simulated communities.
Simulated diversity values are recentered if 'size = 1' so that their mean is that of the actual community.
Else, it is assumed that the bias is of interest and must not be corrected.
</p>
<p><code>CommunityProfile</code> objects can be plotted. 
They can also be added to the current plot by <code>CEnvelope</code>.
</p>


<h3>Value</h3>

<p>A <code>CommunityProfile</code>, which is a list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The order <code class="reqn">q</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The entropy or diversity values returned by <code>FUN</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>
<p>The lower bound of the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high</code></td>
<td>
<p>The upper bound of the confidence interval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Plot diversity estimated without bias correction
plot(CommunityProfile(Diversity, Paracou618.MC$Ps, seq(0, 2, 0.2)), 
lty=3, ylim=c(50, 350))
# Estimate diversity, with a condidence envelope 
# (only 10 simulations to save time, should be 1000)
Profile &lt;- CommunityProfile(Diversity, as.AbdVector(Paracou618.MC$Ns), 
		  seq(0, 2, 0.2), Correction="UnveilJ", NumberOfSimulations=10)
# Complete the plot, and add the legend
CEnvelope(Profile, main="Paracou Plots Diversity")
legend("topright", c("Bias Corrected", "Biased"), lty=c(1,3), inset=0.01)

# Advanced use with beta-diversity functions :
# Profile of the beta entropy of the first community of Paracou618.
# Observed and expected probabilities are bound into a 2-column matrix
# An intermediate function is necessary to separate them before calling TsallisBeta
# The CheckArguments is mandatory but does not need to be set: CommunityProfile() sets it to FALSE
CommunityProfile(function(PandPexp, q, CheckArguments) 
  {TsallisBeta(PandPexp[, 1], PandPexp[, 2], q)}, 
  NorP=cbind(Paracou618.MC$Psi[, 1], Paracou618.MC$Ps), q.seq=seq(0, 2, 0.2))
</code></pre>


</div>