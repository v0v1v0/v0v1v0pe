<div class="container">

<table style="width: 100%;"><tr>
<td>ebayesthresh.wavelet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical Bayes thresholding on the levels of a wavelet transform.</h2>

<h3>Description</h3>

<p>Apply an Empirical Bayes thresholding approach level by level to the
detail coefficients in a wavelet transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ebayesthresh.wavelet(xtr, vscale = "independent", smooth.levels = Inf, 
      prior = "laplace", a = 0.5, bayesfac = FALSE, 
      threshrule = "median")

ebayesthresh.wavelet.dwt(x.dwt, vscale = "independent", smooth.levels = Inf, 
      prior = "laplace", a = 0.5, bayesfac = FALSE,
      threshrule = "median")

ebayesthresh.wavelet.wd(x.wd, vscale = "independent", smooth.levels = Inf,
      prior = "laplace", a = 0.5, bayesfac = FALSE,
      threshrule = "median")

ebayesthresh.wavelet.splus(x.dwt, vscale = "independent", smooth.levels = Inf, 
      prior = "laplace", a = 0.5, bayesfac = FALSE,
      threshrule = "median")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xtr</code></td>
<td>
<p>The wavelet transform of a vector of data. The transform
is obtained using one of the wavelet transform routines in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> or
in S+WAVELETS. Any choice of wavelet, boundary condition, etc
provided by these routines can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.dwt</code></td>
<td>
<p>Wavelet transform input for <code>ebayesthresh.wavelet.dwt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.wd</code></td>
<td>
<p>Wavelet transform input for <code>ebayesthresh.wavelet.wd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vscale</code></td>
<td>
<p>Controls the scale used at different levels of the
transform. If <code>vscale</code> is a scalar quantity, then it will
be assumed that the wavelet coefficients at every level have
this standard deviation. If <code>vscale = "independent"</code>, the
standard deviation will be estimated from the highest level of
the wavelet transform and will then be used for all levels
processed. If <code>vscale="level"</code>, then the standard
deviation will be estimated separately for each level processed,
allowing standard deviation that is level-dependent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.levels</code></td>
<td>
<p>The number of levels to be processed, if less
than the number of levels of detail calculated by the wavelet
transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Specification of prior to be used for the coefficients at
each level, conditional on their mean being nonzero; can be
<code>cauchy</code> or <code>laplace</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Scale factor if Laplace prior is used.  Ignored if Cauchy
prior is used. If, on entry, <code>a=NA</code> and
<code>prior="laplace"</code>, then the scale parameter will also be
estimated at each level by marginal maximum likelihood.  If
<code>a</code> is not specified then the default value 0.5 will be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bayesfac</code></td>
<td>
<p>If <code>bayesfac=TRUE</code>, then whenever a threshold is
explicitly calculated, the Bayes factor threshold will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshrule</code></td>
<td>
<p>Specifies the thresholding rule to be applied to the
coefficients. Possible values are <code>median</code> (use the
posterior median); <code>mean</code> (use the posterior mean);
<code>hard</code> (carry out hard thresholding); <code>soft</code> (carry
out soft thresholding).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The routine <code>ebayesthresh.wavelet</code> can process a wavelet transform
obtained using the routine <code>wd</code> in the WaveThresh <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package, the
routines <code>dwt</code> or <code>modwt</code> in the waveslim <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package, or one
of the routines (either dwt or nd.dwt) in S+WAVELETS.
</p>
<p>Note that the wavelet transform must be calculated before the routine
ebayesthresh.wavelet is called; the choice of wavelet, boundary
conditions, decimated vs nondecimated wavelet, and so on, are made when
the wavelet transform is calculated.
</p>
<p>Apart from some housekeeping to estimate the standard deviation if
necessary, and to determine the number of levels to be processed, the
main part of the routine is a call, for each level, to the smoothing
routine <code>ebayesthresh</code>.
</p>
<p>The basic notion of processing each level of detail coefficients is
easily transferred to transforms constructed using other wavelet
software. Similarly, it is straightforward to modify the routine to
give other details of the wavelet transform, if necessary using the
option <code>verbose = TRUE</code> in the calls to <code>ebayesthresh</code>.
</p>
<p>The main routine <code>ebayesthresh.wavelet</code> calls the relevant one of
the routines <code>ebayesthresh.wavelet.wd</code> (for a transform obtained
from WaveThresh), <code>ebayesthresh.wavelet.dwt</code> (for transforms
obtained from either <code>dwt</code> or <code>modwt</code> in waveslim) or
<code>ebayesthresh.wavelet.splus</code> (for transforms obtained from
S+WAVELETS.
</p>


<h3>Value</h3>

<p>The wavelet transform (in the same format as that supplied to the
routine) of the values of the estimated regression function underlying
the original data.
</p>


<h3>Author(s)</h3>

<p>Bernard Silverman</p>


<h3>References</h3>

<p>Johnstone, I. M. and Silverman, B. W. (2005)  
Empirical Bayes selection of wavelet thresholds.
<em>Annals of Statistics</em>, <b>33</b>, 1700â€“1752.
</p>
<p>See also the other references given for <code>ebayesthresh</code> and
at <a href="http://www.bernardsilverman.com">http://www.bernardsilverman.com</a>.
</p>


<h3>See Also</h3>

<p><code>ebayesthresh</code></p>


</div>