<div class="container">

<table style="width: 100%;"><tr>
<td>Lognormal3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Three-Parameter Lognormal Distribution
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and random generation 
for the three-parameter lognormal distribution with parameters <code>meanlog</code>, 
<code>sdlog</code>, and <code>threshold</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  dlnorm3(x, meanlog = 0, sdlog = 1, threshold = 0)
  plnorm3(q, meanlog = 0, sdlog = 1, threshold = 0)
  qlnorm3(p, meanlog = 0, sdlog = 1, threshold = 0)
  rlnorm3(n, meanlog = 0, sdlog = 1, threshold = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>sample size.  If <code>length(n)</code> is larger than 1, then <code>length(n)</code> 
random values are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanlog</code></td>
<td>

<p>vector of means of the distribution of the random variable on the log scale.  
The default is <code>meanlog=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdlog</code></td>
<td>

<p>vector of (positive) standard deviations of the random variable on the log scale.  
The default is <code>sdlog=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>vector of thresholds of the random variable on the log scale.  The default 
is <code>threshold=0</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The three-parameter lognormal distribution is simply the usual 
two-parameter lognormal distribution with a 
location shift.
</p>
<p>Let <code class="reqn">X</code> be a random variable with a three-parameter lognormal distribution 
with parameters <code>meanlog=</code><code class="reqn">\mu</code>, <code>sdlog=</code><code class="reqn">\sigma</code>, and 
<code>threshold=</code><code class="reqn">\gamma</code>.  Then the random variable <code class="reqn">Y = X - \gamma</code> 
has a lognormal distribution with parameters 
<code>meanlog=</code><code class="reqn">\mu</code> and <code>sdlog=</code><code class="reqn">\sigma</code>.  Thus, 
</p>

<ul>
<li>  <p><code>dlnorm3</code> calls <code>dlnorm</code> using the arguments 
<code>x = x - threshold</code>, <code>meanlog = meanlog</code>, 
<code>sdlog = sdlog</code>
</p>
</li>
<li> <p><code>plnorm3</code> calls <code>plnorm</code> using the arguments 
<code>q = q - threshold</code>, <code>meanlog = meanlog</code>, <code>sdlog = sdlog</code>
</p>
</li>
<li> <p><code>qlnorm3</code> calls <code>qlnorm</code> using the arguments 
<code>q = q</code>, <code>meanlog = meanlog</code>, <code>sdlog = sdlog</code> and then adds 
the argument <code>threshold</code> to the result.
</p>
</li>
<li> <p><code>rlnorm3</code> calls <code>rlnorm</code> using the arguments 
<code>n = n</code>, <code>meanlog = meanlog</code>, <code>sdlog = sdlog</code> and then adds
the argument <code>threshold</code> to the result.
</p>
</li>
</ul>
<p>The threshold parameter <code class="reqn">\gamma</code> affects only the location of the 
three-parameter lognormal distribution; it has no effect on the variance 
or the shape of the distribution.
</p>
<p>Denote the mean, variance, and coefficient of variation of <code class="reqn">Y = X - \gamma</code> by:
</p>
<p style="text-align: center;"><code class="reqn">E(Y) = \theta</code>
</p>

<p style="text-align: center;"><code class="reqn">Var(Y) = \eta^2</code>
</p>

<p style="text-align: center;"><code class="reqn">CV(Y) = \tau = \eta/\theta</code>
</p>

<p>Then the mean, variance, and coefficient of variation of <code class="reqn">X</code> are given by:
</p>
<p style="text-align: center;"><code class="reqn">E(X) = \theta + \eta</code>
</p>

<p style="text-align: center;"><code class="reqn">Var(X) = \eta^2</code>
</p>

<p style="text-align: center;"><code class="reqn">CV(X) = \frac{\eta}{\theta + \gamma} = \frac{\tau \theta}{\theta + \gamma}</code>
</p>

<p>The relationships between the parameters <code class="reqn">\mu</code>, <code class="reqn">\sigma</code>, 
<code class="reqn">\theta</code>, <code class="reqn">\eta</code>, and <code class="reqn">\tau</code> are as follows:
</p>
<p style="text-align: center;"><code class="reqn">\theta = \beta \sqrt{\omega}</code>
</p>

<p style="text-align: center;"><code class="reqn">\eta = \beta \sqrt{\omega (\omega - 1)}</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau = \sqrt{\omega - 1}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mu = log(\frac{\theta}{\sqrt{\tau^2 + 1}})</code>
</p>

<p style="text-align: center;"><code class="reqn">\sigma = \sqrt{log(\tau^2 + 1)}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\beta = e^\mu, \omega = exp(\sigma^2)</code>
</p>

<p>Since quantiles of a distribution are preserved under monotonic transformations, 
the median of <code class="reqn">X</code> is:
</p>
<p style="text-align: center;"><code class="reqn">Median(X) = \gamma + \beta</code>
</p>



<h3>Value</h3>

<p><code>dlnorm3</code> gives the density, <code>plnorm3</code> gives the distribution function, 
<code>qlnorm3</code> gives the quantile function, and <code>rlnorm3</code> generates random 
deviates. 
</p>


<h3>Note</h3>

<p>The two-parameter lognormal distribution is the 
distribution of a random variable whose logarithm is normally distributed.  
The two major characteristics of the two-parameter lognormal distribution 
are that it is bounded below at 0, and it is skewed to the right.  The 
three-parameter lognormal distribution is a generalization of the two-parameter 
lognormal distribution in which the distribution is shifted so that the 
threshold parameter is some arbitrary number, not necessarily 0.
</p>
<p>The three-parameter lognormal distribution was introduced by Wicksell (1917) in a 
study of the distribution of ages at first marriage.  Both the two- and 
three-parameter lognormal distributions have been used in a variety of fields, 
including economics and business, industry, biology, ecology, atmospheric science, 
and geology (Crow and Shimizu, 1988).  Royston (1992) has discussed the application 
of the three-parameter lognormal distribution in the field of medicine.
</p>
<p>The two-parameter lognormal distribution is often used to characterize chemical 
concentrations in the environment.  Ott (1990) has shown mathematically how a 
series of successive random dilutions gives rise to a distribution that can be 
approximated by a two-parameter lognormal distribution.
</p>
<p>The three-pararameter lognormal distribution starts to resemble a normal 
distribution as the parameter <code class="reqn">\sigma</code> (the standard deviation of 
<code class="reqn">log(X-\gamma)</code> tends to 0.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Aitchison, J., and J.A.C. Brown (1957).  <em>The Lognormal Distribution 
(with special references to its uses in economics)</em>.  Cambridge University 
Press, London, 176pp.
</p>
<p>Crow, E.L., and K. Shimizu. (1988).  <em>Lognormal Distributions:  
Theory and Applications</em>. Marcel Dekker, New York, 387pp.
</p>
<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).  Statistical Distributions. 
Fourth Edition. John Wiley and Sons, Hoboken, NJ.
</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994). 
<em>Continuous Univariate Distributions, Volume 1</em>. 
Second Edition. John Wiley and Sons, New York.
</p>
<p>Ott, W.R. (1990).  A Physical Explanation of the Lognormality of Pollutant 
Concentrations.  <em>Journal of the Air and Waste Management Association</em> <b>40</b>, 
1378–1383.
</p>
<p>Ott, W.R. (1995).  <em>Environmental Statistics and Data Analysis</em>.  
Lewis Publishers, Boca Raton, FL, Chapter 9.
</p>
<p>Royston, J.P. (1992b).  Estimation, Reference Ranges and Goodness of Fit for the 
Three-Parameter Log-Normal Distribution.  <em>Statistics in Medicine</em> <b>11</b>, 
897–912.
</p>
<p>Wicksell, S.D. (1917).  On Logarithmic Correlation with an Application to the 
Distribution of Ages at First Marriage.  <em>Medd. Lunds. Astr. Obs.</em> <b>84</b>, 
1–21.
</p>


<h3>See Also</h3>

<p>Lognormal, <code>elnorm3</code>,  
Probability Distributions and Random Numbers.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Density of the three-parameter lognormal distribution with 
  # parameters meanlog=1, sdlog=2, and threshold=10, evaluated at 10.5:

  dlnorm3(10.5, 1, 2, 10) 
  #[1] 0.278794

  #----------

  # The cdf of the three-parameter lognormal distribution with 
  # parameters meanlog=2, sdlog=3, and threshold=5, evaluated at 9: 

  plnorm3(9, 2, 3, 5) 
  #[1] 0.4189546

  #----------

  # The median of the three-parameter lognormal distribution with 
  # parameters meanlog=2, sdlog=3, and threshold=20: 

  qlnorm3(0.5, 2, 3, 20) 
  #[1] 27.38906

  #----------

  # Random sample of 3 observations from the three-parameter lognormal 
  # distribution with parameters meanlog=2, sdlog=1, and threshold=-5. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(20) 
  rlnorm3(3, 2, 1, -5) 
  #[1] 18.6339749 -0.8873173 39.0561521
</code></pre>


</div>