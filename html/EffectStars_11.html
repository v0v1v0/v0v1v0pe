<div class="container">

<table style="width: 100%;"><tr>
<td>star.nominal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Effect stars for multinomial logit models
</h2>

<h3>Description</h3>

<p><strong>The package EffectStars2 provides a more up-to-date implementation of effect stars!</strong>
</p>
<p>The function computes and visualizes multinomial logit models. The computation is done with help of
the package <span class="pkg">VGAM</span>. The visualization is based on the function <code>stars</code> from the package <span class="pkg">graphics</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">star.nominal(formula, data, xij = NULL, conf.int = FALSE, symmetric = TRUE, 
    pred.coding = "reference", printpvalues = TRUE, test.rel = TRUE, refLevel = 1, 
    maxit = 100, scale = TRUE, nlines = NULL, select = NULL, catstar = TRUE, 
    dist.x = 1, dist.y = 1, dist.cov = 1, dist.cat = 1, xpd = TRUE, main = "", 
    lwd.stars = 1, col.fill = "gray90", col.circle = "black", lwd.circle = 1, 
    lty.circle = "longdash", lty.conf = "dotted", cex.labels = 1, cex.cat = 0.8, 
    xlim = NULL, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>An object of class “formula”. Formula for the multinomial logit model to be fitted and visualized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>An object of class “data.frame” containing the covariates used in <code>formula</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xij</code></td>
<td>

<p>An object of class list, used if category-specific covariates are to be inlcuded. Every element is a formula referring to one of the category-specific covariates. For details see help for <code>xij</code> in <code>vglm.control</code> and the details below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>

<p>If <code>TRUE</code>, confidence intervals are drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>

<p>Which side constraint for the coefficients in the multinomial logit model shall be used for the plot?
Default <code>TRUE</code> uses symmetric side constraints, <code>FALSE</code> uses the reference category specified by <code>refLevel</code>.
If category-specific covariates are specified using <code>xij</code>, automatically <code>symmetric = FALSE</code> is set. Symmetric side constraints are not possible in the case of category-specific covariates. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.coding</code></td>
<td>

<p>Which coding for categorical predictors with more than two categories is to be used? 
Default <code>pred.coding="reference"</code> uses the first category as reference category, the alternative <code>pred.coding="effect"</code> uses effect coding equivalent to symmetric side constraints. For <code>pred.coding="effect"</code> a star for every category is plotted, for <code>pred.coding="reference"</code> no star for the reference category is plotted. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printpvalues</code></td>
<td>

<p>If <code>TRUE</code>, p-values for the respective coefficients are printed besides the category labels.
P-values are recieved by a Wald test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.rel</code></td>
<td>

<p>Provides a Likelihood-Ratio-Test to test the relevance of the explanatory covariates.
The corresponding p-values will be printed behind the covariates labels. <code>test.rel=FALSE</code> might
save a lot of time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refLevel</code></td>
<td>

<p>Reference category for multinomial logit model. Ignored if <code>symmetric=TRUE</code>. See also
<code>multinomial</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>Maximal number of iterations to fit the multinomial logit model. See also
<code>vglm.control</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>If <code>TRUE</code>, the stars are scaled to equal maximal ray length.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlines</code></td>
<td>

<p>If specified, <code>nlines</code> gives the number of lines in which the effect stars are plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>

<p>Numeric vector to choose only a subset of the stars to be plotted. Default is to plot all stars. Numbers refer to total amount of predictors, including intercept and dummy variables.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catstar</code></td>
<td>

<p>A logical argument to specify if all category-specific effects in the model should be visualized with an additional star. Ignored if <code>xij=NULL</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.x</code></td>
<td>

<p>Optional factor to increase/decrease distances between the centers of the stars on the x-axis. Values greater than
1 increase, values smaller than 1 decrease the distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.y</code></td>
<td>

<p>Optional factor to increase/decrease distances between the centers of the stars on the y-axis. Values greater than
1 increase, values smaller than 1 decrease the distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.cov</code></td>
<td>

<p>Optional factor to increase/decrease distances between the stars and the covariates labels above the stars. Values greater than
1 increase, values smaller than 1 decrease the distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.cat</code></td>
<td>

<p>Optional factor to increase/decrease distances between the stars and the category labels around the stars. Values greater than
1 increase, values smaller than 1 decrease the distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpd</code></td>
<td>

<p>If <code>FALSE</code>, all plotting is clipped to the plot region, if <code>TRUE</code>, all plotting is clipped to the figure region,
and if <code>NA</code>, all plotting is clipped to the device region. See also <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>An overall title for the plot. See also <code>plot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.stars</code></td>
<td>

<p>Line width of the stars. See also <code>lwd</code> in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.fill</code></td>
<td>

<p>Color of background of the circle. See also <code>col</code> in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.circle</code></td>
<td>

<p>Color of margin of the circle. See also <code>col</code> in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.circle</code></td>
<td>

<p>Line width of the circle. See also <code>lwd</code> in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.circle</code></td>
<td>

<p>Line type of the circle. See also <code>lty</code> in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.conf</code></td>
<td>

<p>Line type of confidence intervals. Ignored, if <code>conf.int=FALSE</code>. See also <code>lty</code>
in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.labels</code></td>
<td>

<p>Size of labels for covariates placed above the corresponding star. See also <code>cex</code>
in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.cat</code></td>
<td>

<p>Size of labels for categories placed around the corresponding star. See also <code>cex</code>
in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>Optional specification of the x coordinates ranges. See also <code>xlim</code> in <code>plot.window</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>Optional specification of the y coordinates ranges. See also <code>ylim</code> in <code>plot.window</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The underlying models are fitted with the function <code>vglm</code> from the package <span class="pkg">VGAM</span>. The family argument 
for <code>vglm</code> is <code>multinomial(parallel=FALSE)</code>. <br><br>
The stars show the exponentials of the estimated coefficients. In multinomial logit models the exponential coefficients can
be interpreted as odds. More precisely, for the model with symmetric side constraints, the exponential <code class="reqn">e^{\gamma_{rj}}, r=1,\ldots,k</code> represents the multiplicative effect of the covariate j on the odds <code class="reqn">\frac{P(Y=r|x)}{GM(x)}</code> if <code class="reqn">x_j</code> increases by one unit and <code class="reqn">GM(x)</code> is the median response. For the model with reference category k, the exponential <code class="reqn">e^{\gamma_{rj}}, r=1,\ldots,k-1</code> represents the multiplicative effect of the covariate j on the odds <code class="reqn">\frac{P(Y=r|x)}{P(Y=k|x)}</code> if <code class="reqn">x_j</code> increases by one unit.<br><br>
In addition to the stars, we plot a cirlce that refers to the case where the coefficients of the corresponding star are zero. Therefore, the radii of these circles are always <code class="reqn">exp(0)=1</code>. If <code>scale=TRUE</code>, the stars are scaled so that they all have the same maximal ray length. In this case, the actual appearances of the circles differ, but they still refer to the no-effects case where all the coefficients are zero. Now the circles can be used to compare different stars based on their respective circles radii. The distances between the rays of a star and the cirlce correspond to the p-values that are printed beneath the category levels if <code>printpvalues=TRUE</code>. The closer a star ray lies to the no–effects circle, the more the p-value is increased. 
<br>
The p-values beneath the covariate labels, which are given  if <code>test.rel=TRUE</code>, correspond to the distance between the circle and the star as a whole. They refer to a likelihood ratio test if all the coefficients from one covariate are zero (i.e. the variable is left out completely) and thus would lie exactly upon the cirlce. 
<br>
The appearance of the circles can be modified by <code>col.circle</code>, <code>lwd.circle</code> and <code>lty.circle</code>. 
<br><br>
The argument <code>xij</code> is  important  because it has to be used to include category-specific covariates. If its default <code>xij=NULL</code> is kept, an ordinary multinomial logit model without category-specific covariates is fitted. If category-specific covariates are to be included, attention has to be paid to the exact usage of <code>xij</code>. Our <code>xij</code> argument is identical to the <code>xij</code> argument used in the embedded <code>vglm</code> function. For details see also <code>vglm.control</code>. The data are thought to be present in a wide format, i.e. a category-specific covariate consists of k columns. Before calling <code>star.nominal</code>, the values for the reference category (defined by <code>refLevel</code>) have to be subtracted from the values of the further categories. Additionally, the resulting variable for the first response category (but not the reference category) has to be duplicated. This duplicate should be denoted by an appropriate name for the category-specific variable, independent from the different response categories. It will be used as an assignment variable for the corresponding coefficient of the covariate and has to be included in to the <code>formula</code>. For every category-specific covariate, a formula has to be specified in the <code>xij</code> argument. On the left hand side of that formula, the assignment variable has to be placed. On the right hand side, the variables containing the differences from the values for the reference category are written. So the left hand side of the formula contains k-1 terms. The order of these terms has to be chosen according to the order of the response categories, ignoring the reference category. Examples for effect stars for models with category-specific covariates are recieved by typing <code>vignette("election")</code> or <code>vignette("plebiscite")</code>.<br><br>
It is strongly recommended to standardize metric covariates, display of effect stars can benefit greatly as in general differences between the coefficients are increased.
</p>


<h3>Value</h3>

<p>P-values are only available if the corresponding option is set <code>TRUE</code>. <br><code>catspec</code> and <code>catspecse</code> are only available if <code>xij</code> is specified.<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>odds</code></td>
<td>
<p>Odds or exponential coefficients of the multinomial logit model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Coefficients of the multinomial logit model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Standard errors of the coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>P-values of Wald tests for the respective coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catspec</code></td>
<td>
<p>Coefficients for the category-specific covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catspecse</code></td>
<td>
<p>Standard errors for the coefficients for the category-specific covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_rel</code></td>
<td>
<p>P-values of Likelihood-Ratio-Tests for the relevance of the explanatory covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p><code>xlim</code> values that were automatically produced. May be helpfull if you want to specify
your own <code>xlim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p><code>ylim</code> values that were automatically produced. May be helpfull if you want to specify
your own <code>ylim</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gunther Schauberger<br><a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a><br><a href="https://www.sg.tum.de/epidemiologie/team/schauberger/">https://www.sg.tum.de/epidemiologie/team/schauberger/</a>
</p>


<h3>References</h3>

<p>Tutz, G. and Schauberger, G. (2012): <em>Visualization of Categorical Response Models -
from Data Glyphs to Parameter Glyphs</em>, Journal of Computational and Graphical Statistics 22(1), 156-177.
<br><br>
Gerhard Tutz (2012): <em>Regression for Categorical Data</em>, Cambridge University Press
</p>


<h3>See Also</h3>

<p><code>star.sequential</code>, <code>star.cumulative</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(election)

# simple multinomial logit model
star.nominal(Partychoice ~ Age + Religion + Democracy + Pol.Interest + 
                 Unemployment + Highschool + Union + West + Gender, election)

# Use effect coding for the categorical predictor religion
star.nominal(Partychoice ~ Age + Religion + Democracy + Pol.Interest + 
                 Unemployment + Highschool + Union + West + Gender, election,
                 pred.coding = "effect")                 

# Use reference category "FDP" instead of symmetric side constraints
star.nominal(Partychoice ~ Age + Religion + Democracy + Pol.Interest + 
                 Unemployment + Highschool + Union + West + Gender, election,
                 refLevel = 3, symmetric = FALSE)
                 
# Use category-specific covariates, subtract values for reference 
# category CDU
election[,13:16] &lt;- election[,13:16] - election[,12]
election[,18:21] &lt;- election[,18:21] - election[,17]
election[,23:26] &lt;- election[,23:26] - election[,22]
election[,28:31] &lt;- election[,28:31] - election[,27]

election$Social &lt;- election$Social_SPD
election$Immigration &lt;- election$Immigration_SPD
election$Nuclear &lt;- election$Nuclear_SPD
election$Left_Right &lt;- election$Left_Right_SPD

star.nominal(Partychoice ~ Social + Immigration + Nuclear + Left_Right + Age + 
Religion + Democracy + Pol.Interest + Unemployment + Highschool + Union + West + 
Gender, data = election, 
xij = list(Social ~ Social_SPD + Social_FDP + Social_Greens + Social_Left,
Immigration ~ Immigration_SPD + Immigration_FDP + Immigration_Greens + Immigration_Left,
Nuclear ~ Nuclear_SPD + Nuclear_FDP + Nuclear_Greens + Nuclear_Left,
Left_Right ~ Left_Right_SPD + Left_Right_FDP + Left_Right_Greens + Left_Right_Left),
symmetric = FALSE)

## End(Not run)
</code></pre>


</div>