<div class="container">

<table style="width: 100%;"><tr>
<td>EMSNM-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
EM Algorithm for Sigmoid Normal Model
</h2>

<h3>Description</h3>

<p>It provides a method based on EM algorithm to estimate the parameter of a mixture model, Sigmoid-Normal Model, where the samples come from several normal distributions (also call them subgroups) whose mean is determined by co-variable Z and coefficient alpha while the variance are homogeneous. Meanwhile, the subgroup each item belongs to is determined by co-variables X and coefficient eta through Sigmoid link function which is the extension of Logistic Link function. It uses bootstrap to estimate the standard error of parameters. When sample is indeed separable, removing estimation with abnormal sigma, the estimation of alpha is quite well. I used this method to explore the subgroup structure of HIV patients and it can be used in other domains where exists subgroup structure.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> EMSNM</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> EM Algorithm for Sigmoid Normal Model</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.0</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2019-04-19</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Linsui Deng &lt;denglinsui@gmail.com&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Linsui Deng &lt;denglinsui@gmail.com&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> It provides a method based on EM algorithm to estimate the parameter of a mixture model, Sigmoid-Normal Model, where the samples come from several normal distributions (also call them subgroups) whose mean is determined by co-variable Z and coefficient alpha while the variance are homogeneous. Meanwhile, the subgroup each item belongs to is determined by co-variables X and coefficient eta through Sigmoid link function which is the extension of Logistic Link function. It uses bootstrap to estimate the standard error of parameters. When sample is indeed separable, removing estimation with abnormal sigma, the estimation of alpha is quite well. I used this method to explore the subgroup structure of HIV patients and it can be used in other domains where exists subgroup structure.</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL(&gt;=2)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
Ccompute                Ccompute
EMSNM-package           EM Algorithm for Sigmoid Normal Model
EM_parameter_sd         Bootstrap Parameter Inference
EM_result_sort          Sort Parameter
EMalgorithm             Parameter Estimation
EMbootstrap             Bootstrap Method
EMsimulation            Simulation For Estimation
Ggenerate               Subgroup Determination
Wgenerate               Sigmoid Logistic Data Generation
fnorm                   Density Value
softmax                 Softmax Value
standard                Data Standardlization
update_eta              Updata Eta
update_gamma            Updata Alpha and Sigma
weight_matrix           Weighted Inner Product
</pre>
<p>The EMalgorithm is used to estimate the parameters, EMbootstrap is used to estimate the parameters with bootstrap method. In EMsimulation we can simulate the situation with given parameters, so parameter estimation can be verified.
</p>


<h3>Author(s)</h3>

<p>Linsui Deng &lt;denglinsui@gmail.com&gt;
</p>
<p>Maintainer: Linsui Deng &lt;denglinsui@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">#parameter initialization
etasize &lt;- 2
classsize &lt;- 2
alphasize &lt;- 3
samplesize &lt;- 100
expriments &lt;- 30
  
etatest &lt;- matrix(c(1,1,
                    0,0),etasize,classsize)

alphatest &lt;- matrix(c(1,0,2,
                      4,3,5),alphasize,classsize)
sigmatest &lt;- 0.5

#test of EMsimulation
EMsimulation_result &lt;- EMsimulation(eta=etatest,alpha=alphatest,sigma=sigmatest,
                            samplesize=samplesize,expriments=expriments,
                            compact_flag=TRUE,C0=5,C1=0.5,C2=5)
index &lt;- which(EMsimulation_result$sigma&lt;0.8)
EMsimulation_result_sort &lt;- EM_result_sort(EMsimulation_result$alpha[index,,],
                                            EMsimulation_result$eta[index,,])
EM_parameter &lt;- EM_parameter_sd(EMsimulation_result_sort$alpha,
                                EMsimulation_result_sort$eta,
                                EMsimulation_result$sigma[index])

#test of EMbootstrap
samplesize &lt;- 1000
X &lt;- matrix(c(matrix(1,samplesize),
                  rnorm(samplesize*(etasize-1))+1),samplesize,etasize)
Z &lt;- matrix(c(matrix(1,samplesize),rbinom(prob=1/2,size=1,n=samplesize),
                 rnorm(samplesize*(alphasize-2))+1),samplesize,alphasize)
                 
Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,sigma=sigmatest,X=X,Z=Z)

boots_samplesize &lt;- 100
boots_expriments &lt;- 30
samplesize &lt;- dim(Wtest$X)[1]
EMbootstrap_theta &lt;- EMbootstrap(Wtest$X,Wtest$Y,Wtest$Z,samplesize,
                                 boots_samplesize,boots_expriments,
                                 classsize=2,compact_flag=TRUE,C0=5,C1=0.2,C2=5)
index &lt;- which(EMbootstrap_theta$sigma&lt;0.8)
EMsimulation_result_sort &lt;- EM_result_sort(EMbootstrap_theta$alpha[index,,],
                                             EMbootstrap_theta$eta[index,,])
EM_parameter &lt;- EM_parameter_sd(EMsimulation_result_sort$alpha,
                                EMsimulation_result_sort$eta,
                                 EMbootstrap_theta$sigma[index])                          
</code></pre>


</div>