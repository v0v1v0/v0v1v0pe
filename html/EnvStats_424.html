<div class="container">

<table style="width: 100%;"><tr>
<td>predIntLnormAltSimultaneousTestPower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Probability That at Least One Set of Future Observations Violates the Given Rule Based on a Simultaneous Prediction Interval for a Lognormal Distribution
</h2>

<h3>Description</h3>

<p>Compute the probability that at least one set of future observations violates the 
given rule based on a simultaneous prediction interval for the next <code class="reqn">r</code> future 
sampling occasions for a lognormal distribution.  The 
three possible rules are: <code class="reqn">k</code>-of-<code class="reqn">m</code>, California, or Modified California.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntLnormAltSimultaneousTestPower(n, df = n - 1, n.geomean = 1, k = 1, 
    m = 2, r = 1, rule = "k.of.m", ratio.of.means = 1, cv = 1, pi.type = "upper", 
    conf.level = 0.95, r.shifted = r, K.tol = .Machine$double.eps^0.5, 
    integrate.args.list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>vector of positive integers greater than 2 indicating the sample size upon which 
the prediction interval is based.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>vector of positive integers indicating the degrees of freedom associated with 
the sample size.  The default value is <code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.geomean</code></td>
<td>

<p>positive integer specifying the sample size associated with the future geometric 
means.  
The default value is <code>n.geomean=1</code> (i.e., individual observations).  Note 
that all future geometric means must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), vector of positive integers 
specifying the minimum number of observations (or averages) out of <code class="reqn">m</code> 
observations (or averages) (all obtained on one future sampling “occassion”) 
the prediction interval should contain with confidence level <code>conf.level</code>.  
The default value is <code>k=1</code>.  This argument is ignored when the argument 
<code>rule</code> is not equal to <code>"k.of.m"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>vector of positive integers specifying the maximum number of future observations (or 
averages) on one future sampling “occasion”.  
The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which 
case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>vector of positive integers specifying the number of future sampling “occasions”.  
The default value is <code>r=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>

<p>character string specifying which rule to use.  The possible values are 
<code>"k.of.m"</code> (<code class="reqn">k</code>-of-<code class="reqn">m</code> rule; the default), <code>"CA"</code> (California rule), 
and <code>"Modified.CA"</code> (modified California rule).  
See the DETAILS section below for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.of.means</code></td>
<td>

<p>numeric vector specifying the ratio of the mean of the population that will be 
sampled to produce the future observations vs. the mean of the population that 
was sampled to construct the prediction interval.  See the DETAILS section below 
for more information.  The default value is <code>ratio.of.means=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>

<p>numeric vector of positive values specifying the coefficient of variation for 
both the population that was sampled to construct the prediction interval <b>and</b> 
the population that will be sampled to produce the future observations.  The 
default value is <code>cv=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>pi.type="upper"</code> (the default), and 
<code>pi.type="lower"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>vector of values between 0 and 1 indicating the confidence level of the prediction interval.  
The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.shifted</code></td>
<td>

<p>vector of positive integers specifying the number of future sampling occasions for 
which the mean is shifted.  All values must be integeters 
between <code>1</code> and the corresponding element of <code>r</code>.  The default value is 
<code>r.shifted=r</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.tol</code></td>
<td>

<p>numeric scalar indicating the tolerance to use in the nonlinear search algorithm to 
compute <code class="reqn">K</code>.  The default value is <code>K.tol=.Machine$double.eps^(1/2)</code>.  
For many applications, the value of <code class="reqn">K</code> needs to be known only to the second 
decimal place, in which case setting <code>K.tol=1e-4</code> will speed up computation a 
bit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate.args.list</code></td>
<td>

<p>a list of arguments to supply to the <code>integrate</code> function.  The 
default value is <code>integrate.args.list=NULL</code> which means that the 
default values of <code>integrate</code> are used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>What is a Simultaneous Prediction Interval?</em> <br>
A prediction interval for some population is an interval on the real line constructed 
so that it will contain <code class="reqn">k</code> future observations from that population 
with some specified probability <code class="reqn">(1-\alpha)100\%</code>, where 
<code class="reqn">0 &lt; \alpha &lt; 1</code> and <code class="reqn">k</code> is some pre-specified positive integer.  
The quantity <code class="reqn">(1-\alpha)100\%</code> is called  
the confidence coefficient or confidence level associated with the prediction 
interval.  The function <code>predIntNorm</code> computes a standard prediction 
interval based on a sample from a normal distribution.
</p>
<p>The function <code>predIntLnormAltSimultaneous</code> computes a simultaneous 
prediction interval (assuming lognormal observations) that will contain a 
certain number of future observations 
with probability <code class="reqn">(1-\alpha)100\%</code> for each of <code class="reqn">r</code> future sampling 
“occasions”, where <code class="reqn">r</code> is some pre-specified positive integer.  
The quantity <code class="reqn">r</code> may refer to <code class="reqn">r</code> distinct future sampling occasions in 
time, or it may for example refer to sampling at <code class="reqn">r</code> distinct locations on 
one future sampling occasion, 
assuming that the population standard deviation is the same at all of the <code class="reqn">r</code> 
distinct locations.
</p>
<p>The function <code>predIntLnormAltSimultaneous</code> computes a simultaneous 
prediction interval based on one of three possible rules:
</p>

<ul>
<li>
<p> For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), at least <code class="reqn">k</code> of 
the next <code class="reqn">m</code> future observations will fall in the prediction 
interval with probability <code class="reqn">(1-\alpha)100\%</code> on each of the <code class="reqn">r</code> future 
sampling occasions.  If obserations are being taken sequentially, for a particular 
sampling occasion, up to <code class="reqn">m</code> observations may be taken, but once 
<code class="reqn">k</code> of the observations fall within the prediction interval, sampling can stop.  
Note:  When <code class="reqn">k=m</code> and <code class="reqn">r=1</code>, the results of <code>predIntNormSimultaneous</code> 
are equivalent to the results of <code>predIntNorm</code>.
</p>
</li>
<li>
<p> For the California rule (<code>rule="CA"</code>), with probability 
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either 
the first observation will fall in the prediction interval, or else all of the next 
<code class="reqn">m-1</code> observations will fall in the prediction interval. That is, if the first 
observation falls in the prediction interval then sampling can stop.  Otherwise, 
<code class="reqn">m-1</code> more observations must be taken.
</p>
</li>
<li>
<p> For the Modified California rule (<code>rule="Modified.CA"</code>), with probability 
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either the 
first observation will fall in the prediction interval, or else at least 2 out of 
the next 3 observations will fall in the prediction interval.  That is, if the first 
observation falls in the prediction interval then sampling can stop.  Otherwise, up 
to 3 more observations must be taken.
</p>
</li>
</ul>
<p><em>Computing Power</em> <br>
The function <code>predIntNormSimultaneousTestPower</code> computes the 
probability that at least one set of future observations or averages will 
violate the given rule based on a simultaneous prediction interval for the 
next <code class="reqn">r</code> future sampling occasions for a normal distribution, 
based on the assumption of normally distributed observations, 
where the population mean for the future observations is allowed to differ from 
the population mean for the observations used to construct the prediction interval.
</p>
<p>The function <code>predIntLnormAltSimultaneousTestPower</code> assumes all observations are 
from a lognormal distribution.  The observations used to 
construct the prediction interval are assumed to come from a lognormal distribution 
with mean <code class="reqn">\theta_2</code> and coefficient of variation <code class="reqn">\tau</code>.  The future 
observations are assumed to come from a lognormal distribution with mean 
<code class="reqn">\theta_1</code> and coefficient of variation <code class="reqn">\tau</code>; that is, the means are 
allowed to differ between the two populations, but not the coefficient of variation.
</p>
<p>The function <code>predIntLnormAltSimultaneousTestPower</code> calls the function <br><code>predIntNormSimultaneousTestPower</code>, with the argument 
<code>delta.over.sigma</code> given by:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\delta}{\sigma} = \frac{log(R)}{\sqrt{log(\tau^2 + 1)}} \;\;\;\;\;\; (1)</code>
</p>

<p>where <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\theta_1}{\theta_2} \;\;\;\;\;\; (2)</code>
</p>

<p>and corresponds to the argument <code>ratio.of.means</code> for the function <br><code>predIntLnormAltSimultaneousTestPower</code>, and <code class="reqn">\tau</code> corresponds to the 
argument <code>cv</code>.
</p>


<h3>Value</h3>

<p>vector of values between 0 and 1 equal to the probability that 
the rule will be violated.
</p>


<h3>Note</h3>

<p>See the help files for <code>predIntLnormAltSimultaneous</code> and 
<code>predIntNormSimultaneousTestPower</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>predIntLnormAltSimultaneous</code>.
</p>


<h3>See Also</h3>

<p><code>predIntLnormAltSimultaneous</code>, <br><code>plotPredIntLnormAltSimultaneousTestPowerCurve</code>, <br><code>predIntNormSimultaneous</code>, <br><code>plotPredIntNormSimultaneousTestPowerCurve</code>, <br>
Prediction Intervals, LognormalAlt.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # For the k-of-m rule with n=4, k=1, m=3, and r=1, show how the power increases 
  # as ratio.of.means increases.  Assume a 95% upper prediction interval.

  predIntLnormAltSimultaneousTestPower(n = 4, m = 3, ratio.of.means = 1:3) 
  #[1] 0.0500000 0.2356914 0.4236723

  #----------

  # Look at how the power increases with sample size for an upper one-sided 
  # prediction interval using the k-of-m rule with k=1, m=3, r=20, 
  # ratio.of.means=4, and a confidence level of 95%.

  predIntLnormAltSimultaneousTestPower(n = c(4, 8), m = 3, r = 20, ratio.of.means = 4) 
  #[1] 0.4915743 0.8218175

  #----------

  # Compare the power for the 1-of-3 rule with the power for the California and 
  # Modified California rules, based on a 95% upper prediction interval and 
  # ratio.of.means=4.  Assume a sample size of n=8.  Note that in this case the 
  # power for the Modified California rule is greater than the power for the 
  # 1-of-3 rule and California rule.

  predIntLnormAltSimultaneousTestPower(n = 8, k = 1, m = 3, ratio.of.means = 4) 
  #[1] 0.6594845 

  predIntLnormAltSimultaneousTestPower(n = 8, m = 3, rule = "CA", ratio.of.means = 4) 
  #[1] 0.5864311 

  predIntLnormAltSimultaneousTestPower(n = 8, rule = "Modified.CA", ratio.of.means = 4) 
  #[1] 0.691135

  #----------

  # Show how the power for an upper 95% simultaneous prediction limit increases 
  # as the number of future sampling occasions r increases.  Here, we'll use the 
  # 1-of-3 rule with n=8 and ratio.of.means=4.

  predIntLnormAltSimultaneousTestPower(n = 8, k = 1, m = 3, r = c(1, 2, 5, 10), 
    ratio.of.means = 4) 
  #[1] 0.6594845 0.7529576 0.8180814 0.8302302
</code></pre>


</div>