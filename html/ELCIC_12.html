<div class="container">

<table style="width: 100%;"><tr>
<td>ELCIC.wgee.single</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate ELCIC value for a given candidate model under WGEE framework for missing longitudinal data under the mechanism of missing at random and drop-out</h2>

<h3>Description</h3>

<p>The function <code>ELCIC.wgee.single</code> to calculate ELCIC value for a given candidate mean model with specified working correlation structure. It is able to simultaneously evaluate mean model and working correlation structure. The data is dropout missing and missing at random.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ELCIC.wgee.single(x,y,x_mis,r,id,time,index.var=NULL,
      name.var=NULL,dist,corstr,joints=TRUE,lag=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept if the intercept is considered in the marginal mean. Covariate matrix should be complete. See more in details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector containing outcomes. Use NA to indicate missing outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_mis</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept. This covariate matrix should be complete and all observed. See more in details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The number of observations in total for each subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index.var</code></td>
<td>
<p>A vector containing index corresponding to candidate covariates. See more in details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.var</code></td>
<td>
<p>A vector containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A specified distribution. It can be "gaussian", "poisson",and "binomial".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>A candidate correlation structure. It can be "independence","exchangeable", and "ar1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>A numeric value indicating lag-response involved in the missing data model. It can be one of 0, 1, and 2. The default is 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Covariate matrix "x" should be complete. If missing data are present in "x", the elements in covariate vector will be replaced by zeros for individuals who have missing covariates.
</p>
<p>The argument "x_mis" includes all covariates to fit the missing data model. It does not contains a lag variable based on the outcome y. The argument "lag" in this function will automatically add lag-response variables to indicate the data missing at random.
</p>
<p>Either arguments "index.var" or "name.var" is used to identify the candidate mean model. If both arguments are provided, only the argument "name.var" will be used.
</p>
<p>When the argument "joints" is TRUE, <code>ELCIC.wgee.single</code> will calculate ELCIC value based on the function <code>lambda.find.wgee</code> and <code>ee.wgee</code>, which involve estimating equations for both marginal mean and correlation coefficient. When the argument "joints" is FALSE, <code>ELCIC.wgee.single</code> will calculate ELCIC value based on the function <code>lambda.find.wgee.mean</code> and <code>ee.wgee.mean</code>, which only involve estimating equations for marginal mean.
</p>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## tests
# load data
data(wgeesimdata)
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
x&lt;-wgeesimdata$x
y&lt;-wgeesimdata$y
x_mis&lt;-wgeesimdata$x_mis
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time&lt;-3
index.var&lt;-c(1,2,3)
ELCIC_value&lt;-ELCIC.wgee.single(x,y,x_mis,r,id,time,index.var,name.var=NULL,
                     dist,corstr,joints=TRUE)
ELCIC_value
</code></pre>


</div>