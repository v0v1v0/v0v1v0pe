<div class="container">

<table style="width: 100%;"><tr>
<td>vario.reg.prep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjustment for covariates before semi-variogram model fitting</h2>

<h3>Description</h3>

<p>Adjustment for covariates provides the option to eliminate non-spatial effects
on the variable of interest.
Given a linear regression output of class 'lm' or 'lmerMod'
with the attribute of interest as dependent variable,
the function provides a dataset containing the coordinates of the original observations
and the studentized residuals of the regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vario.reg.prep(reg, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>An object of class 'lm' obtained as result of a linear regression using the function
<code>lm</code> from the package <code>stats</code> or an object of class 'lmerMod' obtained as
result of a linear mixed model regression using the function
<code>lmer</code> from the package <code>lme4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Only needed if the data argument within the regression function <code>lm</code>/<code>lmer</code> is not provided:
A data frame containing the geo-coded dataset containing
the Cartesian x- and y-coordinates in the first and second column,
the outcome of interest in the third column and
all covariates used for the regression in further columns.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The adjusted outcome is defined as the student residuals
of the linear or linear mixed regression model. They are calculated using the <code>rstudent</code> function
from package <code>stats</code>.
In case of a mixed model, the adjusted variable vector resembles the conditional studentized residuals.
</p>
<p>The geo-coded dataset used for the regression is extracted from the current environment. In order to work,
the dataset has to be loaded into the environment prior to the use of <code>vario.reg.prep</code>.
</p>
<p>If the data argument was specified within the regression function <code>lm/lmer</code>,
<code>vario.reg.prep</code> automatically extracts the name of the dataset used for regression and calls
it from the current environment.
Otherwise, the dataset has to be provided manually as input argument within <code>vario.reg.prep</code>.
</p>


<h3>Value</h3>

<p>A data frame with three columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x-coordinate in the first column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y-coordinate in the second column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>Studentized residuals to be used as new variable adjusted for covariates.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>lm</code> in the <code>stats</code> package for information on the fitting of a linear regression model;
</p>
<p><code>lmer</code> in the <code>lme4</code> package for information on the fitting of a linear mixed regression model;
</p>
<p><code>rstudent</code> in the <code>stats</code> package for information on how the attribute of interest is
adjusted for covariates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1
head(birth) #geo-coded dataset
hist(birth$birthweight) # attribute of interest

# Linear regression model
mod1 = lm(birthweight ~ primiparous + datediff + bmi
+ inc, data = birth)
summary(mod1)
data.adj1 = vario.reg.prep(mod1)

head(data.adj1)
hist(data.adj1$adj) # adjusted attribute of interest
# The data frame can be used as input for the vario.mod function.


## Example 2
# No data argument provided within lm (not recommended, but possible):
mod2 = lm(birth$birthweight ~ birth$primiparous + birth$datediff + birth$bmi
+ birth$inc)
summary(mod2)
# In this case, make sure to provide the data argument here:
data.adj2 = vario.reg.prep(reg = mod2, data = birth)


if (requireNamespace("lme4", quietly = TRUE)) {
## Example 3
# Linear mixed regression model
mod3 = lme4::lmer(birthweight ~ primiparous + datediff
                + bmi + (1|inc), data = birth)
summary(mod3)
data.adj3 = vario.reg.prep(mod3)


## Example 4
# Data argument within lmer not provided (not recommended, but possible):
mod4 = lme4::lmer(birth$birthweight ~ birth$primiparous + birth$datediff
            + birth$bmi + (1|birth$inc))
summary(mod4)
# In this case, make sure to provide the data argument here:
data.adj4 = vario.reg.prep(reg = mod4, data = birth)
}

</code></pre>


</div>