<div class="container">

<table style="width: 100%;"><tr>
<td>alluvial_long</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>alluvial plot of data in long format</h2>

<h3>Description</h3>

<p>Plots two variables of a dataframe on an alluvial plot. A third
variable can be added either to the left or the right of the alluvial plot
to provide coloring of the flows. All numerical variables are scaled,
centered and YeoJohnson transformed before binning.
</p>


<h3>Usage</h3>

<pre><code class="language-R">alluvial_long(
  data,
  key,
  value,
  id,
  fill = NULL,
  fill_right = T,
  bins = 5,
  bin_labels = c("LL", "ML", "M", "MH", "HH"),
  NA_label = "NA",
  order_levels_value = NULL,
  order_levels_key = NULL,
  order_levels_fill = NULL,
  complete = TRUE,
  fill_by = "first_variable",
  col_vector_flow = palette_qualitative() %&gt;% palette_filter(greys = F),
  col_vector_value = RColorBrewer::brewer.pal(9, "Greys")[c(3, 6, 4, 7, 5)],
  verbose = F,
  stratum_labels = T,
  stratum_label_type = "label",
  stratum_label_size = 4.5,
  stratum_width = 1/4,
  auto_rotate_xlabs = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>unquoted column name or string of x axis variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>unquoted column name or string of y axis variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>unquoted column name or string of id column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>unquoted column name or string of fill variable which will be used to
color flows, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_right</code></td>
<td>
<p>logical, TRUE fill variable is added to the right FALSE to
the left, Default: T</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>number of bins for automatic binning of numerical variables,
Default: 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_labels</code></td>
<td>
<p>labels for bins, Default: c("LL", "ML", "M", "MH", "HH")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA_label</code></td>
<td>
<p>character vector define label for missing data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_levels_value</code></td>
<td>
<p>character vector denoting order of y levels from low
to high, does not have to be complete can also just be used to bring levels
to the front, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_levels_key</code></td>
<td>
<p>character vector denoting order of x levels from low
to high, does not have to be complete can also just be used to bring levels
to the front, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_levels_fill</code></td>
<td>
<p>character vector denoting order of color fill
variable levels from low to high, does not have to be complete can also just
be used to bring levels to the front, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>logical, insert implicitly missing observations, Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_by</code></td>
<td>
<p>one_of(c('first_variable', 'last_variable', 'all_flows',
'values')), Default: 'first_variable'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_vector_flow</code></td>
<td>
<p>HEX color values for flows, Default: palette_filter( greys = F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_vector_value</code></td>
<td>
<p>HEX color values  for y levels/values,
Default:RColorBrewer::brewer.pal(9, 'Greys')[c(3,6,4,7,5)]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, print plot summary, Default: F</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum_labels</code></td>
<td>
<p>logical, Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum_label_type</code></td>
<td>
<p>character, Default: "label"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum_label_size</code></td>
<td>
<p>numeric, Default: 4.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum_width</code></td>
<td>
<p>double, Default: 1/4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto_rotate_xlabs</code></td>
<td>
<p>logical, Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameter passed to <code>manip_bin_numerics</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>See Also</h3>

<p><code>alluvial_wide</code>
,<code>geom_flow</code>, <code>geom_stratum</code>
,<code>manip_bin_numerics</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
 data = quarterly_flights

 alluvial_long( data, key = qu, value = mean_arr_delay, id = tailnum, fill_by = 'last_variable' )

 # more flow coloring variants ------------------------------------

 alluvial_long( data, key = qu, value = mean_arr_delay, id = tailnum, fill_by = 'first_variable' )
 alluvial_long( data, key = qu, value = mean_arr_delay, id = tailnum, fill_by = 'all_flows' )
 alluvial_long( data, key = qu, value = mean_arr_delay, id = tailnum, fill_by = 'value' )

 # color by additional variable carrier ---------------------------

 alluvial_long( data, key = qu, value = mean_arr_delay, fill = carrier, id = tailnum )

 # use same color coding for flows and y levels -------------------

 palette = c('green3', 'tomato')

 alluvial_long( data, qu, mean_arr_delay, tailnum, fill_by = 'value'
                , col_vector_flow = palette
                , col_vector_value = palette )


 # reorder levels ------------------------------------------------

 alluvial_long( data, qu, mean_arr_delay, tailnum, fill_by = 'first_variable'
               , order_levels_value = c('on_time', 'late') )

 alluvial_long( data, qu, mean_arr_delay, tailnum, fill_by = 'first_variable'
               , order_levels_key = c('Q4', 'Q3', 'Q2', 'Q1') )

require(dplyr)
require(magrittr)

 order_by_carrier_size = data %&gt;%
   group_by(carrier) %&gt;%
   count() %&gt;%
   arrange( desc(n) ) %&gt;%
   .[['carrier']]

 alluvial_long( data, qu, mean_arr_delay, tailnum, carrier
                , order_levels_fill = order_by_carrier_size )


## End(Not run)
</code></pre>


</div>