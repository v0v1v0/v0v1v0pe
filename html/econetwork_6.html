<div class="container">

<table style="width: 100%;"><tr>
<td>elgrin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Teasing apart the effects of environmental variations and biotic interactions on species distributions
</h2>

<h3>Description</h3>

<p>ELGRIN jointly models the presence and absence of all species in a given area in function of environmental covariates and the topological structure of the known metaweb
</p>


<h3>Usage</h3>

<pre><code class="language-R">elgrin(presence, metaweb, environmentvar, ncores=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>presence</code></td>
<td>
<p>A <code>matrix</code> with presence/absence of species (rows) at
different locations (columns), coded in 0/1 format (1 for presence).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metaweb</code></td>
<td>
<p>A <code>matrix</code> or a <code>igraph</code> object. This
represents the metaweb/metawnetwork of interactions as an adjacency
matrix or as a graph respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environmentvar</code></td>
<td>
<p>A <code>matrix</code> with environmental variables (columns) at
different locations (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of cores to use, i.e. at most how many
threads will run simultaneously. Default is 1 (no parallelization).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>ELGRIN (in reference to Charles Elton and Joseph Grinnell) can handle the effects of both environmental factors and  known ecological interactions (aka a metanetwork) on species distributions. We rely on Markov random fields, a family of flexible models that can handle dependencies between variables using a graph.
</p>


<h3>Value</h3>

<p><code>elgrin</code> returns an object of class <code>list</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A <code>vector</code> of species intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al</code></td>
<td>
<p>A <code>vector</code> of location intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A <code>matrix</code> of linear environmental parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>A <code>matrix</code> of quadratic environmental parameters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaPres</code></td>
<td>
<p>A <code>vector</code> of co-presence strength (or avoidance when &lt;0)  at each location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaAbs</code></td>
<td>
<p>A <code>vector</code> of co-absence strength (or avoidance when &lt;0) at each location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compat</code></td>
<td>
<p>A <code>matrix</code> with niche compatibility of species (rows) at
different locations (columns), coded in 0/1 format (1 for compatibility)..</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Authors: Vincent Miele
Maintainer: Vincent Miele &lt;vincent.miele@univ-lyon1.fr&gt;
</p>


<h3>References</h3>

<p>Vincent Miele, Catherine Matias, Marc Ohlmann, Giovanni Poggiato, St
ephane Dray and Wilfried Thuiller, Quantifying the overall effect of
biotic1interactions on species communities along2environmental
gradients, arXiv &lt;doi:10.48550/arXiv.2103.10433&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(virtualComCompetition)
vcom &lt;- virtualComCompetition

result &lt;- elgrin(vcom$presence, vcom$metaweb, vcom$environmentvar)
str(result)

plot(result$betaPres, result$betaAbs, xlab="Co-presence", ylab="Co-absence")
abline(h=0, col=2)
abline(v=0, col=2)

</code></pre>


</div>