<div class="container">

<table style="width: 100%;"><tr>
<td>eqdist.etest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multisample E-statistic (Energy) Test of Equal Distributions</h2>

<h3>Description</h3>

<p>Performs the nonparametric multisample E-statistic (energy) test
for equality of multivariate distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eqdist.etest(x, sizes, distance = FALSE,
    method=c("original","discoB","discoF"), R)
eqdist.e(x, sizes, distance = FALSE,
    method=c("original","discoB","discoF"))
ksample.e(x, sizes, distance = FALSE,
    method=c("original","discoB","discoF"), ix = 1:sum(sizes))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data matrix of pooled sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizes</code></td>
<td>
<p> vector of sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>logical: if TRUE, first argument is a distance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> use original (default) or distance components (discoB, discoF)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of bootstrap replicates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ix</code></td>
<td>
<p> a permutation of the row indices of x </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The k-sample multivariate <code class="reqn">\mathcal{E}</code>-test of equal distributions
is performed. The statistic is computed from the original
pooled samples, stacked in matrix <code>x</code> where each row
is a multivariate observation, or the corresponding distance matrix. The
first <code>sizes[1]</code> rows of <code>x</code> are the first sample, the next
<code>sizes[2]</code> rows of <code>x</code> are the second sample, etc.
</p>
<p>The test is implemented by nonparametric bootstrap, an approximate
permutation test with <code>R</code> replicates.
</p>
<p>The function <code>eqdist.e</code> returns the test statistic only; it simply
passes the arguments through to <code>eqdist.etest</code> with <code>R = 0</code>.
</p>
<p>The k-sample multivariate <code class="reqn">\mathcal{E}</code>-statistic for testing equal distributions
is returned. The statistic is computed from the original pooled samples, stacked in
matrix <code>x</code> where each row is a multivariate observation, or from the distance
matrix <code>x</code> of the original data. The
first <code>sizes[1]</code> rows of <code>x</code> are the first sample, the next
<code>sizes[2]</code> rows of <code>x</code> are the second sample, etc.
</p>
<p>The two-sample <code class="reqn">\mathcal{E}</code>-statistic proposed by
Szekely and Rizzo (2004)
is the e-distance <code class="reqn">e(S_i,S_j)</code>, defined for two samples <code class="reqn">S_i, S_j</code>
of size <code class="reqn">n_i, n_j</code> by
</p>
<p style="text-align: center;"><code class="reqn">e(S_i,S_j)=\frac{n_i n_j}{n_i+n_j}[2M_{ij}-M_{ii}-M_{jj}],
    </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">M_{ij}=\frac{1}{n_i n_j}\sum_{p=1}^{n_i} \sum_{q=1}^{n_j}
       \|X_{ip}-X_{jq}\|,</code>
</p>

<p><code class="reqn">\|\cdot\|</code> denotes Euclidean norm, and <code class="reqn">X_{ip}</code> denotes the p-th observation in the i-th sample.
</p>
<p>The original (default method) k-sample
<code class="reqn">\mathcal{E}</code>-statistic is defined by summing the pairwise e-distances over
all <code class="reqn">k(k-1)/2</code> pairs
of samples:
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{E}=\sum_{1 \leq i &lt; j \leq k} e(S_i,S_j).
    </code>
</p>

<p>Large values of <code class="reqn">\mathcal{E}</code> are significant.
</p>
<p>The <code>discoB</code> method computes the between-sample disco statistic.
For a one-way analysis, it is related to the original statistic as follows.
In the above equation, the weights <code class="reqn">\frac{n_i n_j}{n_i+n_j}</code>
are replaced with
</p>
<p style="text-align: center;"><code class="reqn">\frac{n_i + n_j}{2N}\frac{n_i n_j}{n_i+n_j} =
    \frac{n_i n_j}{2N}</code>
</p>

<p>where N is the total number of observations: <code class="reqn">N=n_1+...+n_k</code>.
</p>
<p>The <code>discoF</code> method is based on the disco F ratio, while the <code>discoB</code>
method is based on the between sample component.
</p>
<p>Also see <code>disco</code> and <code>disco.between</code> functions.
</p>


<h3>Value</h3>

<p>A list with class <code>htest</code> containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>description of test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>observed value of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>approximate p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>description of data</p>
</td>
</tr>
</table>
<p><code>eqdist.e</code> returns test statistic only.
</p>


<h3>Note</h3>

<p>The pairwise e-distances between samples can be conveniently
computed by the <code>edist</code> function, which returns a <code>dist</code> object.
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Szekely, G. J. and Rizzo, M. L. (2004) Testing for Equal
Distributions in High Dimension, <em>InterStat</em>, November (5).
</p>
<p>M. L. Rizzo and G. J. Szekely (2010).
DISCO Analysis: A Nonparametric Extension of
Analysis of Variance, Annals of Applied Statistics,
Vol. 4, No. 2, 1034-1055.
<br><a href="https://doi.org/10.1214/09-AOAS245">doi:10.1214/09-AOAS245</a>
</p>
<p>Szekely, G. J. (2000) Technical Report 03-05:
<code class="reqn">\mathcal{E}</code>-statistics: Energy of
Statistical Samples, Department of Mathematics and Statistics, Bowling
Green State University.
</p>


<h3>See Also</h3>

<p><code>ksample.e</code>,
<code>edist</code>,
<code>disco</code>,
<code>disco.between</code>,
<code>energy.hclust</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(iris)

 ## test if the 3 varieties of iris data (d=4) have equal distributions
 eqdist.etest(iris[,1:4], c(50,50,50), R = 199)

 ## example that uses method="disco"
  x &lt;- matrix(rnorm(100), nrow=20)
  y &lt;- matrix(rnorm(100), nrow=20)
  X &lt;- rbind(x, y)
  d &lt;- dist(X)

  # should match edist default statistic
  set.seed(1234)
  eqdist.etest(d, sizes=c(20, 20), distance=TRUE, R = 199)

  # comparison with edist
  edist(d, sizes=c(20, 10), distance=TRUE)

  # for comparison
  g &lt;- as.factor(rep(1:2, c(20, 20)))
  set.seed(1234)
  disco(d, factors=g, distance=TRUE, R=199)

  # should match statistic in edist method="discoB", above
  set.seed(1234)
  disco.between(d, factors=g, distance=TRUE, R=199)
</code></pre>


</div>