<div class="container">

<table style="width: 100%;"><tr>
<td>eadrm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a dose-response curve using an evolutionary algorithm</h2>

<h3>Description</h3>

<p>Uses an evolutionary algorithm to fit a set of four possible
dose-response models. The evolutionary parameters and stopping
rules can be customized by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eadrm(
  obs,
  xvals,
  model = "h4",
  pop.size = 1000,
  stable.pop.size = 200,
  num.tournaments = 20,
  tournament.size = 10,
  max.generations = 500,
  stop.generations = 50,
  epsilon = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>A vector of response values (y-values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvals</code></td>
<td>
<p>A vector of doses (x-values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Type of dose-response model to fit. Possible values
include "h3", "h4", and "h5" (corresponding to 3-parameter,
4-parameter, and 5-parameter log-logistic models, respectively),
"e" (corresponding to an exponential model) and "all" (which allows
the procedure to evaluate all four types of models). Defaults to "h4".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.size</code></td>
<td>
<p>The number of initial potential solutions.
Defaults to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stable.pop.size</code></td>
<td>
<p>This quantity is divided by the number of
tournaments to calculate the number of children in each generation.
Defaults to 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.tournaments</code></td>
<td>
<p>The number of tournaments in each generation.
Defaults to 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tournament.size</code></td>
<td>
<p>The number of players (i.e., models to
consider) in each tournament. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.generations</code></td>
<td>
<p>The maximum number of generations. If this
number is reached, the algorithm immediately terminates. Defaults to
500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.generations</code></td>
<td>
<p>The algorithm will also terminate if there is
no improvement in fitness in stop.generation generations. Defaults to
50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>If three successive new models produce an improvement
of less than epsilon in fitness, the procedure will terminate.
Defaults to 0.1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class eadrm, which is a list containing the
following elements:
</p>

<dl>
<dt>Model:</dt>
<dd>
<p>Specifies the type of model (i.e., "h3", "h4", "h5", or
"e")</p>
</dd>
<dt>R2:</dt>
<dd>
<p>Fitness for the final model</p>
</dd>
<dt>params:</dt>
<dd>
<p>A vector of coefficients for the final model</p>
</dd>
<dt>xvals:</dt>
<dd>
<p>The original x values (concentrations) for the model</p>
</dd>
<dt>yvals:</dt>
<dd>
<p>The original y values (responses) for the model</p>
</dd>
</dl>
<h3>Details</h3>

<p>The procedure will initially generate pop.size possible solutions.
The fitness for each solution will be calculated. In each generation,
a series of tournaments are performed. The children of the surviving
models from the previous generation are mutated. The model with the
best fitness "wins" each tournament and survives to the next
generation. The procedure continues until the maximum number of
generations is reached or the fitness fails to improve substantially
over a sufficient number of generations.
</p>


<h3>References</h3>

<p>Ma, J., Bair, E., Motsinger-Reif, A. "Nonlinear Dose-response Modeling
of High-Throughput Screening Data Using an Evolutionary Algorithm",
Dose Response 18(2):1559325820926734 (2020).
</p>


<h3>Examples</h3>

<pre><code class="language-R">ea.fit &lt;- eadrm(CarboA$y, CarboA$x)
</code></pre>


</div>