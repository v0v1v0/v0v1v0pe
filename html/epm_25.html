<div class="container">

<table style="width: 100%;"><tr>
<td>gridMetrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Grid Metrics</h2>

<h3>Description</h3>

<p>Calculate various morphological and phylogenetic community
metrics for every cell in a <code>epmGrid</code> object. To implement other 
metrics not available here, see <code>customGridMetric</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gridMetrics(
  x,
  metric,
  column = NULL,
  verbose = TRUE,
  dataType = c("auto", "univariate", "multivariate", "pairwise")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>epmGrid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>name of metric to use, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column</code></td>
<td>
<p>If a univariate morphological metric is specified, and the data
in <code>x</code> are multivariate, which trait should be used? This can also
specify which subset of columns a multivariate metric should be applied to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print various messages to the console. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataType</code></td>
<td>
<p>Specify the type of input data that the metric will be calculated from.
Defaults to <code>'auto'</code> in which case this is determined based on the data structure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Univariate trait metrics 
</p>
 
<ul>
<li>
<p> mean
</p>
</li>
<li>
<p> median
</p>
</li>
<li>
<p> range
</p>
</li>
<li>
<p> variance
</p>
</li>
<li>
<p> mean_NN_dist: mean nearest neighbor distance
</p>
</li>
<li>
<p> min_NN_dist: minimum nearest neighbor distance
</p>
</li>
<li>
<p> evenness: variance of nearest neighbor distances, 
larger values imply decreasing evenness
</p>
</li>
<li>
<p> arithmeticWeightedMean (see below)
</p>
</li>
<li>
<p> geometricWeightedMean (see below)
</p>
</li>
</ul>
<p>Multivariate trait metrics 
</p>
 
<ul>
<li>
<p> mean: mean of pairwise distance matrix derived from multivariate data
</p>
</li>
<li>
<p> median: median of pairwise distance matrix derived from multivariate data
</p>
</li>
<li>
<p> disparity
</p>
</li>
<li>
<p> partialDisparity: contribution of species in each gridcell to 
overall disparity, returned as the ratio of summed partial disparities
to total disparity.
</p>
</li>
<li>
<p> range
</p>
</li>
<li>
<p> mean_NN_dist: mean nearest neighbor distance 
</p>
</li>
<li>
<p> min_NN_dist: minimum nearest neighbor distance
</p>
</li>
<li>
<p> evenness: variance of nearest neighbor distances, 
larger values imply decreasing evenness.
</p>
</li>
</ul>
<p>Phylogenetic metrics 
</p>
 
<ul>
<li>
<p> pd: Faith's phylogenetic diversity, including the root
</p>
</li>
<li>
<p> meanPatristic
</p>
</li>
<li>
<p> meanPatristicNN: mean nearest neighbor in patristic distance
</p>
</li>
<li>
<p> minPatristicNN: minimum nearest neighbor in patristic distance
</p>
</li>
<li>
<p> phyloEvenness: variance of nearest neighbor patristic distances,
larger values imply decreasing evenness
</p>
</li>
<li>
<p> phyloDisparity: sum of squared deviations in patristic distance
</p>
</li>
<li>
<p> PSV: Phylogenetic Species Variability
</p>
</li>
<li>
<p> PSR: Phylogenetic Species Richness
</p>
</li>
<li>
<p> DR: non-parametric estimate of speciation rates
</p>
</li>
</ul>
<p>Range-weighted metrics 
</p>
 
<ul>
<li>
<p> weightedEndemism: Species richness inversely weighted by range size.
</p>
</li>
<li>
<p> correctedWeightedEndemism: Weighted endemism standardized by 
species richness
</p>
</li>
<li>
<p> phyloWeightedEndemism: Phylogenetic diversity inversely weighted 
by range size associated with each phylogenetic branch.
</p>
</li>
</ul>
<p>If data slot contains a pairwise matrix, <code>column</code> is ignored. Weighted
mean options are available where, for each cell, a weighting scheme (inverse
of species range sizes) is applied such that small-ranged species are
up-weighted, and broadly distributed species are down-weighted. This can be a
useful way to lessen the influence of broadly distributed species in the
geographic mapping of trait data.
</p>
<p>It may be desirable to have metrics calculated for a dataset where only taxa
shared across geography, traits and phylogeny are included. The function
<code>reduceToCommonTaxa</code> does exactly that.
</p>
<p>If a set of trees are associated with the input epmGrid object <code>x</code>, 
then the metric is calculated for each tree, and a list of epmGrid objects 
is returned. This resulting list can be summarized with the function
<code>summarizeEpmGridList</code>. For instance the mean and variance can 
be calculated, to show the central tendency of the metric across grid cells, 
and to quantify where across geography variability in phylogenetic topography
manifests itself.  
</p>
<p>To implement other metrics not available here, see
<code>customGridMetric</code>.
</p>


<h3>Value</h3>

<p>object of class <code>epmGrid</code> where the grid represents calculations
of the metric at every cell. The species identities per grid cell are those
that had data for the calculation of the metric. If taxa were dropped from
the initial epmGrid object, then they have been removed from this epmGrid.
If a set of trees was involved, then returns a list of <code>epmGrid</code> objects.
</p>


<h3>References</h3>

<p>partial disparity<br> Foote, M. (1993). Contributions of individual taxa to
overall morphological disparity. Paleobiology, 19(4), 403–419.
https://doi.org/10.1017/s0094837300014056
</p>
<p>PSV, RSV<br> Helmus, M. R., Bland, T. J., Williams, C. K., &amp; Ives, A. R.
(2007). Phylogenetic Measures of Biodiversity. The American Naturalist,
169(3), E68–E83. https://doi.org/10.1086/511334
</p>
<p>DR<br> Jetz, W., Thomas, G. H., Joy, J. B., Hartmann, K., &amp; Mooers, A. O.
(2012). The global diversity of birds in space and time. Nature, 491(7424),
444–448. https://doi.org/10.1038/nature11631
</p>
<p>weighted endemism<br> Crisp, M. D., Laffan, S., Linder, H. P., &amp; Monro, A.
(2001). Endemism in the Australian flora. Journal of Biogeography, 28(2),
183–198. https://doi.org/10.1046/j.1365-2699.2001.00524.x
</p>
<p>phylo weighted endemism<br> Rosauer, D., Laffan, S. W., Crisp, M. D.,
Donnellan, S. C., &amp; Cook, L. G. (2009). Phylogenetic endemism: a new approach
for identifying geographical concentrations of evolutionary history.
Molecular Ecology, 18(19), 4061–4072.
https://doi.org/10.1111/j.1365-294x.2009.04311.x
</p>


<h3>Examples</h3>

<pre><code class="language-R">tamiasEPM &lt;- addPhylo(tamiasEPM, tamiasTree)
tamiasEPM &lt;- addTraits(tamiasEPM, tamiasTraits)

# univariate morphological example
x &lt;- gridMetrics(tamiasEPM, metric='mean', column='V2')
plot(x, use_tmap = FALSE)

# multivariate morphological
x &lt;- gridMetrics(tamiasEPM, metric='disparity')
plot(x, use_tmap = FALSE)

# phylogenetic metrics
x &lt;- gridMetrics(tamiasEPM, metric='meanPatristic')
plot(x, use_tmap = FALSE)

</code></pre>


</div>