<div class="container">

<table style="width: 100%;"><tr>
<td>ebayesthresh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical Bayes thresholding on a sequence</h2>

<h3>Description</h3>

<p>Given a sequence of data, performs Empirical Bayes thresholding, 
as discussed in Johnstone and Silverman (2004). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ebayesthresh(x, prior = "laplace", a = 0.5, bayesfac = FALSE, 
sdev = NA, verbose = FALSE, threshrule = "median", universalthresh = TRUE,
stabadjustment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Specification of prior to be used conditional on the
mean being nonzero; can be <code>"cauchy"</code> or <code>"laplace"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Scale factor if Laplace prior is used. Ignored if Cauchy prior
is used. If, on entry, <code>a = NA</code> and <code>prior = "laplace"</code>,
then the scale parameter will also be estimated by marginal
maximum likelihood. If <code>a</code> is not specified then the
default value 0.5 will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bayesfac</code></td>
<td>
<p>If <code>bayesfac = TRUE</code>, then whenever a threshold
is explicitly calculated, the Bayes factor threshold will be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdev</code></td>
<td>
<p>The sampling standard deviation of the data <code>x</code>. If,
on entry, <code>sdev = NA</code>, then the standard deviation will be
estimated using the median absolute deviation from zero, as
<code>mad(x, center = 0)</code>. If a single value is passed to
<code>sdev</code>, sampling standard deviation will be the same for
all observations. A vector of the same length as data sequence
can be passed to allow heterogeneous standard deviation,
currently only for Laplace prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Controls the level of output. See below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshrule</code></td>
<td>
<p>Specifies the thresholding rule to be applied to the
data. Possible values are <code>"median"</code> (use the posterior
median); <code>"mean"</code> (use the posterior mean); <code>"hard"</code>
(carry out hard thresholding); <code>"soft"</code> (carry out soft
thresholding); <code>"none"</code> (find various parameters, but do
not carry out any thresholding).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>universalthresh</code></td>
<td>
<p>If <code>universalthresh = TRUE</code>, the
thresholds will be upper bounded by universal threshold;
otherwise, the thresholds can take any non-negative values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stabadjustment</code></td>
<td>
<p>If
<code>stabadjustment = TRUE</code>, the vectors of standard deviations
and data values will be divided by the mean of standard
deviations in case of inefficiency caused by large value of
standard deviation. For heterogeneous sampling standard deviation only;
ignored if standard deviation is homogeneous.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that the data vector <code class="reqn">(x_1, \ldots, x_n)</code> is such that
each <code class="reqn">x_i</code> is drawn independently from a normal distribution with
mean <code class="reqn">\theta_i</code> and variance <code class="reqn">\sigma_i^2</code> (<code class="reqn">\sigma_i</code> is the
same in the homogeneous case). The prior distribution of each
<code class="reqn">\theta_i</code> is a mixture with probability <code class="reqn">1-w</code> of zero and
probability <code class="reqn">w</code> of a given symmetric heavy-tailed distribution. The
mixing weight, and possibly a scale factor in the symmetric
distribution, are estimated by marginal maximum likelihood. The
resulting values are used as the hyperparameters in the prior.
</p>
<p>The true effects <code class="reqn">\theta_i</code> can be estimated as the posterior median
or the posterior mean given the data, or by hard or soft thresholding
using the posterior median threshold. If hard or soft thresholding is
chosen, then there is the additional choice of using the Bayes factor
threshold, which is the value such thatthe posterior probability of zero
is exactly half if the data value is equal to the threshold.
</p>


<h3>Value</h3>

<p>If <code>verbose = FALSE</code>, a vector giving the values of the estimates
of the underlying mean vector.
</p>
<p>If <code>verbose = TRUE</code>, a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>muhat</code></td>
<td>
<p>the estimated mean vector (omitted if <code>threshrule =
    "none"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the data vector as supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.sdevscale</code></td>
<td>
<p>the threshold as a multiple of the standard
deviation <code>sdev</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.origscale</code></td>
<td>
<p> the threshold measured on the original
scale of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>the prior that was used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>the mixing weight as estimated by marginal maximum
likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>(only present if Laplace prior used) the scale factor as
supplied or estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bayesfac</code></td>
<td>
<p>the value of the parameter <code>bayesfac</code>,
determining whether Bayes factor or posterior median thresholds are
used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdev</code></td>
<td>
<p>the standard deviations of the data as supplied or
estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshrule</code></td>
<td>
<p>the thresholding rule used, as specified above</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bernard Silverman</p>


<h3>References</h3>

<p>Johnstone, I. M. and Silverman, B. W. (2004) Needles and straw in
haystacks: Empirical Bayes estimates of possibly sparse
sequences. <em>Annals of Statistics</em>, <b>32</b>, 1594–1649.
</p>
<p>Johnstone, I. M. and Silverman, B. W. (2004) EbayesThresh: R software
for Empirical Bayes thresholding. <em>Journal of Statistical
Software</em>, <b>12</b>.
</p>
<p>Johnstone, I. M. (2004) 'Function Estimation and Classical Normal
Theory' ‘The Threshold Selection Problem’. The Wald Lectures I and II,
2004. Available from <a href="http://www-stat.stanford.edu/~imj">http://www-stat.stanford.edu/~imj</a>.
</p>
<p>Johnstone, I. M. and Silverman, B. W. (2005) Empirical Bayes selection
of wavelet thresholds. <em>Annals of Statistics</em>, <b>33</b>,
1700–1752.
</p>
<p>The papers by Johnstone and Silverman are available from
<a href="http://www.bernardsilverman.com">http://www.bernardsilverman.com</a>.
</p>
<p>See also <a href="http://www-stat.stanford.edu/~imj">http://www-stat.stanford.edu/~imj</a> for further
references, including the draft of a monograph by I. M. Johnstone.
</p>


<h3>See Also</h3>

<p><code>tfromx</code>, <code>threshld</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Data with homogeneous sampling standard deviation using 
# Cauchy prior.
eb1 &lt;- ebayesthresh(x = rnorm(100, c(rep(0,90),rep(5,10))),
                     prior = "cauchy", sdev = NA)

# Data with homogeneous sampling standard deviation using 
# Laplace prior.
eb2 &lt;- ebayesthresh(x = rnorm(100, c(rep(0,90), rep(5,10))),
                     prior = "laplace", sdev = 1)
             
# Data with heterogeneous sampling standard deviation using 
# Laplace prior.
set.seed(123)
mu &lt;- c(rep(0,90), rep(5,10))
sd &lt;- c(rep(1, 40), rep(3, 60))
x  &lt;- mu + rnorm(100, sd = sd)

# With constraints on thresholds.
eb3 &lt;- ebayesthresh(x = x, prior = "laplace", a = NA, sdev = sd)

# Without constraints on thresholds. Observe that the estimates with
# constraints on thresholds have fewer zeroes than the estimates without
# constraints.
eb4 &lt;- ebayesthresh(x = x, prior = "laplace", a = NA, sdev = sd,
                     universalthresh = FALSE)
print(sum(eb3 == 0))
print(sum(eb4 == 0))

# Data with heterogeneous sampling standard deviation using Laplace
# prior.
set.seed(123)
mu &lt;- c(rep(0,90), rep(5,10))
sd &lt;- c(rep(1, 40), rep(5,40), rep(15, 20))
x  &lt;- mu + rnorm(100, sd = sd)

# In this example, infinity is returned as estimate when some of the
# sampling standard deviations are extremely large. However, this can
# be solved by stabilizing the data sequence before the analysis.
eb5 &lt;- ebayesthresh(x = x, prior = "laplace", a = NA, sdev = sd)

# With stabilization.
eb6 &lt;- ebayesthresh(x = x, prior = "laplace", a = NA, sdev = sd,
                    stabadjustment = TRUE)

</code></pre>


</div>