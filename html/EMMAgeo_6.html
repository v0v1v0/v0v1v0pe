<div class="container">

<table style="width: 100%;"><tr>
<td>EMMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>End-member modelling analysis algorithm.</h2>

<h3>Description</h3>

<p>A multivariate data set (m samples composed of n variables) is decomposed by
eigenspace analysis and modelled with a given number of end-members (q).
Several steps of scaling, transformation, normalisation, eigenspace
decomposition, factor rotation, data modelling and evaluation are performed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMMA(
  X,
  q,
  l,
  c,
  Vqn,
  classunits,
  ID,
  EM.ID,
  rotation = "Varimax",
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>Numeric</code> matrix, input data set with m samples (rows) 
and n variables (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p><code>Numeric</code> scalar, number of end-members to be modelled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p><code>Numeric</code> scalar or vector, weight transformation
limit, i.e.  quantile. Set to zero if omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p><code>Numeric</code> scalar, constant sum scaling parameter, e.g.
1, 100, 1000. Set to 100 if omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vqn</code></td>
<td>
<p><code>Numeric</code> matrix, optional unscaled user-defined
end-member loadings. If provided, these are used instead of model-derived
ones. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classunits</code></td>
<td>
<p><code>Numeric</code> vector, optional class units 
(e.g. micrometers or phi-units) of the same length as columns of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p><code>Numeric</code> or character vector, optional sample IDs of the 
same length as rows of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM.ID</code></td>
<td>
<p><code>Character</code> vector, end-member names. If present, 
these will be set as row-names of the output data set and used in the 
legend text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p><code>Character</code> scalar, rotation type, default is 
"Varimax". See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>Logical</code> scalar, optional graphical output of the results,
default is FALSE. If set to TRUE, end-member loadings and end-member scores
are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the plot function. Since the
function returns two plots some additional graphical parameters must be
specified as vector with the first element for the first plot and the second
element for the second plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameter <code>Vqn</code> is useful when <code>EMMA</code> shall be performed with 
a set of prior unscaled end-members, e.g. from other data sets that are to 
be used as reference or when modelling a data set with mean end-members, as
in the output of <code>robust.loadings</code>.<br>
The rotation type <code>Varimax</code> was used by Dietze et al. (2012). In this 
R package, one out of the rotations provided by the package GPArotation 
is possible, as well. However, tests showed that the rotation type has no 
dramatic consequences for the result.<br> 
The function values <code>$loadings</code> and <code>$scores</code> are redundant. They 
are essentially the same as <code>$Vqsn</code> and <code>$Mqs</code>. However, they are 
included for user convenience.
</p>


<h3>Value</h3>

<p>A list with numeric matrix objects. </p>
<table>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>Normalised
rescaled end-member loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Rescaled end-member scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vqn</code></td>
<td>
<p>Normalised end-member loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vqsn</code></td>
<td>
<p>Normalised rescaled
end-member loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mqs</code></td>
<td>
<p>Rescaled end-member scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xm</code></td>
<td>
<p>Modelled data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modes</code></td>
<td>
<p>Mode class of end-member loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mqs.var</code></td>
<td>
<p>Explained variance of end-members</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Em</code></td>
<td>
<p>Absolute
row-wise model error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>En</code></td>
<td>
<p>Absolute column-wise model error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSEm</code></td>
<td>
<p>row-wise root mean square erroe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSEn</code></td>
<td>
<p>column-wise root 
mean square erroe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rm</code></td>
<td>
<p>Row-wise (sample-wise) explained variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rn</code></td>
<td>
<p>Column-wise (variable-wise) explained variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ol</code></td>
<td>
<p>Number 
of overlapping end-members.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Dietze, Elisabeth Dietze
</p>


<h3>References</h3>

<p>Dietze E, Hartmann K, Diekmann B, IJmker J, Lehmkuhl F, Opitz S,
Stauch G, Wuennemann B, Borchers A. 2012. An end-member algorithm for
deciphering modern detrital processes from lake sediments of Lake Donggi
Cona, NE Tibetan Plateau, China. Sedimentary Geology 243-244: 169-180.<br>
Klovan JE, Imbrie J. 1971. An Algorithm and FORTRAN-IV Program for
Large-Scale Q-Mode Factor Analysis and Calculation of Factor Scores.
Mathematical Geology 3: 61-77. Miesch AT. 1976. Q-Mode factor analysis of
geochemical and petrologic data matrices with constant row sums. U.S.
Geological Survey Professsional Papers 574.
</p>


<h3>See Also</h3>

<p><code>test.parameters</code>, <code>rotations</code>,
<code>eigen</code>, <code>nnls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load example data and set phi-vector
data(example_X)
phi &lt;- seq(from = 1, to = 10, length.out = ncol(X))

## perform EMMA with 5 end-members
EM &lt;- EMMA(X = X, q = 5, l = 0.05, c = 100, plot = TRUE)

## perform EMMA with 4 end-members and more graphical settings
EM &lt;- EMMA(X = X, q = 4, l = 0.05, c = 100, 
           plot = TRUE,
           EM.ID = c("EM 1", "EM 2", "EM 3", "EM 4"),
           classunits = phi,
           xlab = c(expression(paste("Class [", phi, "]")), "Sample ID"),
           cex = 0.7,
           col = rainbow(n = 4))

</code></pre>


</div>