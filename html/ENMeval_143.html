<div class="container">

<table style="width: 100%;"><tr>
<td>similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Multivariate Environmental Similarity</h2>

<h3>Description</h3>

<p>NOTICE: This function was borrowed from the rmaxent package written by John Baumgartner (https://github.com/johnbaums/rmaxent/).
</p>
<p>Calculate Multivariate Environmental Similarity and most dissimilar/similar 
variables with respect to a reference dataset, for a set of environmental 
variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">similarity(x, ref, full = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a 'Raster*', 'list', 'matrix', or 'data.frame'
where each layer/column/element represents focal values of an environmental
variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>a 'list', 'matrix', or 'data.frame' where each
column/element represents reference values for an environmental variable
(corresponding to those given in 'x').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>(logical) should similarity values be returned for all variables?
If 'FALSE' (the default), then only the minimum similarity scores
across variables will be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>'similarity' uses the MESS algorithm described in Appendix S3
of Elith <em>et al.</em> 2010.
</p>


<h3>Value</h3>

<p>If 'x' is a 'Raster*' object, this function returns a list 
containing:
- 'similarity': a 'RasterStack' giving the environmental similarities for
each variable in 'x' (only included when 'full=TRUE'); 
- 'similarity_min': a 'Raster' layer giving the minimum similarity value 
across all variables for each location (i.e. the MESS);
- 'mod': a factor 'Raster' layer indicating which variable was most 
dissimilar to its reference range (i.e. the MoD map, Elith <em>et al.</em> 2010); 
and
- 'mos': a factor 'Raster' layer indicating which variable was most 
similar to its reference range.
</p>
<p>If 'x' is a 'list', 'matrix', or 'data.frame', the function will return
a list as above, but with 'RasterStack' and 'Raster' objects replaced by 
matrix and vectors.
</p>


<h3>References</h3>

<p>Elith, J., Kearney, M., and Phillips, S. (2010) The art of modelling range-shifting species. <em>Methods in Ecology and Evolution</em>, <b>1</b>: 330-342. <a href="https://doi.org/10.1111/j.2041-210X.2010.00036.x">doi:10.1111/j.2041-210X.2010.00036.x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dismo)
library(raster)
ff &lt;- list.files(system.file('ex', package='dismo'), '\\.grd$', 
                 full.names=TRUE )
predictors &lt;- stack(grep('biome', ff, value=TRUE, invert=TRUE))
occ &lt;- read.csv(system.file('ex/bradypus.csv', package='dismo'))[, -1]
ref &lt;- extract(predictors, occ)
mess &lt;- similarity(predictors, ref, full=TRUE)

## Not run: 
library(rasterVis)
library(RColorBrewer)
levelplot(mess$mod, col.regions=brewer.pal(8, 'Set1'))
levelplot(mess$mos, col.regions=brewer.pal(8, 'Set1'))

## End(Not run)
</code></pre>


</div>