<div class="container">

<table style="width: 100%;"><tr>
<td>hill.ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the extreme quantile procedure on a time dependent data</h2>

<h3>Description</h3>

<p>Compute the function hill.adapt on time dependent data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hill.ts(X, t, Tgrid = seq(min(t), max(t), length = 10), h,
  kernel = TruncGauss.kernel, kpar = NULL, CritVal = 3.6,
  gridlen = 100, initprop = 1/10, r1 = 1/4, r2 = 1/20)

## S3 method for class 'hill.ts'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a vector of the observed values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a vector of time covariates which should have the same length as X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tgrid</code></td>
<td>
<p>a grid of time (can be any sequence in the interval <code>[min(t) , max(t)]</code> ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a bandwidth value (vector values are not admitted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>a kernel function used to compute the weights in the time domain, with default the truncated Gaussian kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kpar</code></td>
<td>
<p>a value for the kernel function parameter, with no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CritVal</code></td>
<td>
<p>a critical value associated to the kernel function given by <code>CriticalValue</code>. The default value is 3.6 corresponding to the truncated Gaussian kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridlen</code></td>
<td>
<p>the gridlen parameter used in the function hill.adapt. The length of the grid for which the test will be done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initprop</code></td>
<td>
<p>the initprop parameter used in the function hill.adapt. The initial proportion at which we will begin to test the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p>the r1 parameter used in the function hill.adapt. The proportion from the right that we will skip in the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>the r2 parameter used in the function hill.adapt. The proportion from the left that we will skip in the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the result of the hill.ts function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed from or to other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given time serie and kernel function, the function hill.ts will give the results of the adaptive procedure for each <code class="reqn">t</code>. The adaptive procedure is described in Durrieu et al. (2005).
</p>
<p>The kernel implemented in this packages are : Biweight kernel, Epanechnikov kernel, Rectangular kernel, Triangular kernel and the truncated Gaussian kernel.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tgrid</code></td>
<td>
<p>the given vector <code class="reqn">Tgrid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the given value <code class="reqn">h</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Threshold</code></td>
<td>
<p>the adaptive threshold <code class="reqn">\tau</code> for each <code class="reqn">t</code> in <code class="reqn">Tgrid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>the adaptive estimator of <code class="reqn">\theta</code> for each <code class="reqn">t</code> in <code class="reqn">Tgrid</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Durrieu, G. and Grama, I. and Pham, Q. and Tricot, J.- M (2015). Nonparametric adaptive estimator of extreme conditional tail probabilities quantiles. Extremes, 18, 437-478.
</p>
<p>Durrieu, G. and Grama, I. and Jaunatre, K. and Pham, Q.-K. and Tricot, J.-M. (2018). extremefit: A Package for Extreme Quantiles. Journal of Statistical Software, 87, 1â€“20.
</p>


<h3>See Also</h3>

<p><code>hill.adapt</code>, <code>Biweight.kernel</code>, <code>Epa.kernel</code>, <code>Rectangular.kernel</code>, <code>Triang.kernel</code>, <code>TruncGauss.kernel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
theta &lt;- function(t){
   0.5+0.25*sin(2*pi*t)
 }
n &lt;- 5000
t &lt;- 1:n/n
Theta &lt;- theta(t)
Data &lt;- NULL
Tgrid &lt;- seq(0.01, 0.99, 0.01)
#example with fixed bandwidth
## Not run:  #For computing time purpose
  for(i in 1:n){
     Data[i] &lt;- rparetomix(1, a = 1/Theta[i], b = 5/Theta[i]+5, c = 0.75, precision = 10^(-5))
   }

  #example
  hgrid &lt;- bandwidth.grid(0.009, 0.2, 20, type = "geometric")
  TgridCV &lt;- seq(0.01, 0.99, 0.1)
  hcv &lt;- bandwidth.CV(Data, t, TgridCV, hgrid, pcv = 0.99, TruncGauss.kernel,
                     kpar = c(sigma = 1), CritVal = 3.6, plot = TRUE)

  Tgrid &lt;- seq(0.01, 0.99, 0.01)
  hillTs &lt;- hill.ts(Data, t, Tgrid, h = hcv$h.cv, kernel = TruncGauss.kernel,
             kpar = c(sigma = 1), CritVal = 3.6,gridlen = 100, initprop = 1/10, r1 = 1/4, r2 = 1/20)
  plot(hillTs$Tgrid, hillTs$Theta, xlab = "t", ylab = "Estimator of theta")
  lines(t, Theta, col = "red")


## End(Not run)


</code></pre>


</div>