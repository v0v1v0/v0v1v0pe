<div class="container">

<table style="width: 100%;"><tr>
<td>exams2qti21</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of Exams in QTI 2.1 Format</h2>

<h3>Description</h3>

<p>Automatic generation of exams in QTI 2.1 format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  exams2qti21(file, n = 1L, nsamp = NULL, dir = ".",
    name = NULL, quiet = TRUE, edir = NULL,
    tdir = NULL, sdir = NULL, verbose = FALSE, rds = FALSE,
    resolution = 100, width = 4, height = 4, svg = FALSE, encoding  = "UTF-8",
    num = NULL, mchoice = NULL,
    schoice = mchoice, string = NULL, cloze = NULL,
    template = "qti21", duration = NULL,
    stitle = NULL, ititle = NULL,
    adescription = "Please solve the following exercises.", sdescription = "",
    maxattempts = 1, cutvalue = NULL, solutionswitch = TRUE,
    casesensitive = TRUE, cloze_schoice_display = "auto",
    navigation = "nonlinear", allowskipping = TRUE, allowreview = FALSE,
    allowcomment = FALSE, shufflesections = FALSE, zip = TRUE, points = NULL,
    eval = list(partial = TRUE, rule = "false2", negative = FALSE),
    converter = NULL, envir = NULL, engine = NULL, base64 = TRUE, mode = "hex",
    include = NULL, selection = c("pool", "exam"), flavor = "plain", ...)

  make_itembody_qti21(shuffle = FALSE, defaultval = NULL,
    minvalue = NULL, maxvalue = NULL, enumerate = FALSE,
    digits = NULL, tolerance = is.null(digits), maxchars = 12,
    eval = list(partial = TRUE, rule = "false2", negative = FALSE),
    solutionswitch = TRUE, casesensitive = TRUE,
    cloze_schoice_display = c("auto", "buttons", "dropdown"),
    copypaste = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>character. A specification of a (list of) exercise files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer. The number of copies to be compiled from <code>file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>integer. The number(s) of exercise files sampled from each
list element of <code>file</code>. Sampling without replacement is used
if possible. (Only if some element of <code>nsamp</code> is larger than
the length of the corresponding element in <code>file</code>, sampling
with replacement is used.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>character. The default is the current working directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character. A name prefix for resulting exercises and ZIP file
(must not contain spaces or periods, otherwise replaced by underscores).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>logical. Should output be suppressed when calling
<code>xweave</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edir</code></td>
<td>
<p>character specifying the path of the directory (along with its
sub-directories) in which the files in <code>file</code> are stored
(see also <code>xexams</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tdir</code></td>
<td>
<p>character specifying a temporary directory, by default
this is chosen via <code>tempfile</code>. Note that this
is cleaned up (i.e., existing files are deleted) and only certain
temporary files are preserved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdir</code></td>
<td>
<p>character specifying a directory for storing supplements, by
default this is chosen via <code>tempfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Should information on progress of exam generation
be reported?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rds</code></td>
<td>
<p>logical indicating whether the return list should also be
saved as an RDS data file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution, width, height</code></td>
<td>
<p>numeric. Options for rendering PNG (or SVG)
graphics passed to <code>xweave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svg</code></td>
<td>
<p>logical. Should graphics be rendered in SVG or PNG (default)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>character, ignored. The encoding is always assumed to be UTF-8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num</code></td>
<td>
<p>function or named list applied to numerical (i.e., type <code>num</code>)
questions. If <code>num</code> is a function, <code>num</code> will be used
for generating the item body of the question, see function <code>make_itembody_qti21()</code>.
If <code>num</code> is a named list, these arguments will be passed to function
<code>make_itembody_qti21()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mchoice, schoice, string, cloze</code></td>
<td>
<p>function or named list applied to multiple choice,
single choice, string, and cloze questions (i.e., type <code>mchoice</code>, <code>schoice</code>,
<code>string</code>, and <code>cloze</code>), respectively. See argument <code>num</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>character. The QTI 2.1 template that should be used. Currently,
the package provides <code>"qti21.xml"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>integer. Set the duration of the exam in minutes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stitle</code></td>
<td>
<p>character. A title that should be used for the sections. May be a vector of
length 1 to use the same title for each section, or a vector containing different section
titles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ititle</code></td>
<td>
<p>character or <code>NULL</code>. A title that should be used for the assessment items.
May be a vector
of length 1 to use the same title for each item, or a vector containing different item
titles. Note that the maximum of different item titles is the number of sections/questions
that are used for the exam. Note, if <code>ititle = NULL</code>, simple numbering for the exercises
will be used, however, if the exercise contains meta info extitle, this title will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adescription</code></td>
<td>
<p>character. Description (of length 1) for the overall assessment (i.e., exam).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdescription</code></td>
<td>
<p>character. Vector of descriptions for each section, omitted if empty
(or <code>NULL</code> or <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxattempts</code></td>
<td>
<p>integer. The maximum attempts for one question. This may also be a vector
so that the maximum number of attempts varies across questions. A value of <code>Inf</code> or
<code>0</code> signals that the attempts per question are not limited.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutvalue</code></td>
<td>
<p>numeric. The number of points at which the exam is passed. If set to
<code>NULL</code> (default) or equivalently <code>NA</code>, no cutvalue is set and the result
of the exam is just the number of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutionswitch</code></td>
<td>
<p>logical or character. Should the question/item solutionswitch be enabled?
In OLAT this means that the correct solution is shown after an incorrect solution
was entered by an examinee (i.e., this is typically only useful if <code>maxattempts = 1</code>).
Furthermore, if e.g. <code>solutionswitch = c("correct", "incorrect", "summary")</code>, the correct
solution can be either displayed when the answer is <code>"correct"</code> and/or <code>"incorrect"</code> and/or
after the test is completed in the <code>"summary"</code> of the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>casesensitive</code></td>
<td>
<p>logical. Should the evaluation of string exercises be case sensitive?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloze_schoice_display</code></td>
<td>
<p>character. For <code>schoice</code> answers in <code>cloze</code> exercises,
select the display of the possible answers. By default (<code>cloze_schoice_display = "auto"</code>),
radio <code>"buttons"</code> are used if the answer list appears in its own paragraph and
a <code>"dropdown"</code> menu is used if the answer list appears inline (and has no mathematical
markup). Both options can also be enforced explicitly, independently from the answer list
appearing in a separate paragraph or inline. Note that in dropdown menus the answer list
will typically be rendered as plain text which means that mathematical notaion may become
unintelligible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copypaste</code></td>
<td>
<p>logical. For string/text responses,
controls whether text may be copied into the text entry field, or must actually be entered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>navigation</code></td>
<td>
<p>character. Mode of navigation, can either be <code>"nonlinear"</code> (default)
or <code>"linear"</code>. The former means that test participants can switch back and forth
between questions while the latter implies that the questions need to be answered sequentially.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowskipping</code></td>
<td>
<p>logical. Can a question/section be skipped (default) or must it be answered?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowreview</code></td>
<td>
<p>logical. Can questions be viewed again at the end of a test/exam or not (default)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowcomment</code></td>
<td>
<p>logical. Are comments allowed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shufflesections</code></td>
<td>
<p>logical. Should the order of the
exercises be shuffled? For <code>selection = "pool"</code> setting
<code>shufflesections = TRUE</code> this corresponds to shuffling the
sections that contain the pools of exercises. For
<code>selection = "exam"</code> it corresponds to shuffling the exercises
within each exam section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zip</code></td>
<td>
<p>logical. Should the resulting XML file (plus supplements) be zipped?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>integer. How many points should be assigned to each exercise? Note that this
argument overules any exercise points that are provided within an <code>"\expoints{}"</code> tag
in the <code>.Rnw</code> file. The vector of points supplied is expanded to the number of exercises in
the exam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval</code></td>
<td>
<p>named list, specifies the settings for the evaluation policy, see function
<code>exams_eval</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converter</code></td>
<td>
<p>character. Argument passed on to <code>make_exercise_transform_html</code>.
The default for <code>converter</code> is set to <code>"ttm"</code> unless there are Rmd
exercises in <code>file</code> where <code>"pandoc"</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>argument passed to <code>xweave</code> (which passes
it to <code>knit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>argument passed to <code>xweave</code> indicating whether
<code>"Sweave"</code> (default) or <code>"knitr"</code> should be used for rendering Rnw exercises.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base64</code></td>
<td>
<p>logical. Should supplementary files be embedded using Base 64 coding?
Argument <code>base64</code> may also be a character vector of file suffixes that should be encoded, e.g.
<code>base64 = c("png", "rda")</code> will only encode PNG images and binary <code>.rda</code> files.
If set to <code>NULL</code> only image files will be encoded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>character. See function <code>tth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>character, paths of extra files that should be included within the final
<code>.zip</code>-file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>
<p>character. If <code>selection = "pool"</code>, the function creates one section
for each exercise from which one replication will be selected in the exam. If
<code>selection = "exam"</code> each section contains all questions and one section will
be selected for the exam. The <code>"exam"</code> variant has the advantage that questions
that build on each other can be used in the exam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flavor</code></td>
<td>
<p>character. Which QTI 2.1 “flavor” should be used? Some learning
management systems require that the QTI XML tags are used in a rather specific
and idiosyncratic way. Typically, users should not set this argument directly but
use the convenience interfaces such as <code>exams2openolat</code> instead
(which use the <code>flavor</code> argument internally along with further customizations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shuffle, defaultval, minvalue, maxvalue</code></td>
<td>
<p>arguments used for item construction,
for details see the XML specification (see IMS Global Learning Consortium, Inc. 2012),
especially Section 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enumerate</code></td>
<td>
<p>logical. Insert potential solutions in enumerated list?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer. How many digits should be used for <code>num</code> exercises?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>logical. Should tolerance intervals be used for checking if the supplied
<code>num</code> answer/number is correct? The default is to use tolerance intervals if <code>digits = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxchars</code></td>
<td>
<p>numeric. Lower bound for the number of characters in fill-in-blank
fields. The actual number of characters is selected as the maximum number of
characters of this value and the actual solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed on to <code>make_exercise_transform_html</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Question &amp; Test Interoperability (QTI) is an international XML standard for specifying
e-learning tests established by the IMS Global Learning Consortium, Inc. (2002, 2012).
The standard evolved over various versions with the first release culminating in the QTI 1.2 standard
and the most commonly used stable version of the second release being QTI 2.1.
While both versions share many similarities, they also differ in many details.
Hence, separate functions <code>exams2qti12</code> and <code>exams2qti21</code> are provided.
Moreover, due to the flexibility of the QTI standard, different learning management systems employ
the standard in slightly different ways. Therefore, dedicated interfaces
<code>exams2canvas</code> and <code>exams2ilias</code> (both based on QTI 1.2),
and <code>exams2openolat</code> (based on either QTI 2.1 or 1.2) are provided
for the learning management systems Canvas, ILIAS, and OLAT/OpenOlat, respectively.
In addition, the interfaces <code>exams2blackboard</code>, <code>exams2testvision</code>,
and the separate package <span class="pkg">exams2sakai</span> started as forks of the <code>exams2qti12</code> and
<code>exams2qti21</code> functions, respectively.
</p>
<p><code>exams2qti21</code> produces a <code>.zip</code> file that may be uploaded into different learning
management systems (see above). This includes the final XML file of the exam/assessment,
its exercises as well as possible supplement folders that include images, data sets etc.
It proceeds by (1) calling <code>xweave</code> for each exercise, (2) reading the
resulting Markdown and/or LaTeX code using <code>read_exercise</code>,
(3) transforming the Markdown/LaTeX code to HTML, and (4) embedding the HTML code in XML
files using the QTI 2.1 standard for assessments and question items.
</p>
<p>For steps (1) and (2) the standard drivers in <code>xexams</code> are used. In step (3), a suitable
transformation function is set up on the fly using <code>make_exercise_transform_html</code>, see also
the details section in <code>exams2html</code>.
For step (4), the function will cycle through all questions and exams to generate the final XML
files in QTI 2.1 format: separate XML files for each random replication of each exercise (labeled
items in sections in QTI), one XML file tying the overall exam/assessment together based on
the individual exercises and one overall ‘<span class="file">imsmanifest.xml</span>’.
</p>
<p>For arranging the individual exercise replications (called "items") in so-called "sections"
two different types of <code>selection</code> are available: First, a <code>"pool"</code> of replications/items
can be put into a section and then one item will be selected randomly for each participant from
each section. As learning management systems typically sample the sections independently, this means that
one participant might receive the first random replication from
the first exercise but the third random replication from the second exercise, and so on.
Alternatively, <code>selection = "exam"</code> specifies that each section contains
a complete set of exercises and one section will be selected randomly for each participant.
The <code>"exam"</code> variant is less commonly used but has the advantage that questions that build
on each other can be used in the exam. Also, duplicated exercise types can be avoided when
using <code>nsamp</code> to sample a certain number of exercises without replacement.
</p>
<p>Templates other than the default <code>qti21.xml</code> provided in the <code>xml</code> folder of
this package could in principle also be specified. However, adapting these is a bit technical.
The assessment template must provide one section including one item. <code>exams2qti21</code> will then
use the single item template to generate all items, as well as the assessment and section specifications set within the template.
Note that all specifiers that have a leading <code>##</code> in the XML template will be replaced by suitable code in
<code>exams2qti21</code> and should always be provided in the template. Thus, the user may add
additional tags to the XML template or modify certain specifications, like the number of
replicates/items that should be sampled for each section etc.
</p>
<p>By default, the individual question/item bodies are generated by function
<code>make_itembody_qti21</code> which checks the type of the question and
will produce suitable XML code. Note that for each question type, either the arguments of
<code>make_itembody_qti21</code> may be set within <code>num</code>, <code>mchoice</code>, <code>schoice</code>,
<code>string</code> and <code>cloze</code> in <code>exams2qti21</code>, by providing a named list of specifications
that should be used, or for each question type, a function that produces the item body XML code may
be provided to <code>num</code>, <code>mchoice</code>, <code>schoice</code>, <code>string</code> and <code>cloze</code>. E.g.,
<code>mchoice = list(shuffle = TRUE)</code> will force only multiple choice questions to have a shuffled
answerlist.
</p>


<h3>Value</h3>

<p><code>exams2qti21</code> returns a list of exams as generated by <code>xexams</code>.
</p>
<p><code>make_itembody_qti21</code> returns a function that generates the XML code
for the itembody tag in QTI 2.1 format.
</p>


<h3>References</h3>

<p>IMS Global Learning Consortium, Inc. (2002).
<em>IMS Question &amp; Test Interoperability: ASI XML Binding Specification Final Specification Version 1.2</em>.
<a href="https://www.imsglobal.org/question/qtiv1p2/imsqti_asi_bindv1p2.html">https://www.imsglobal.org/question/qtiv1p2/imsqti_asi_bindv1p2.html</a>
</p>
<p>IMS Global Learning Consortium, Inc. (2012).
<em>IMS Question &amp; Test Interoperability (QTI) XSD Binding Version 2.1 Final</em>.
<a href="https://www.imsglobal.org/question/qtiv2p1/imsqti_bindv2p1.html">https://www.imsglobal.org/question/qtiv2p1/imsqti_bindv2p1.html</a>
</p>
<p>Zeileis A, Umlauf N, Leisch F (2014).
Flexible Generation of E-Learning Exams in R: Moodle Quizzes, OLAT Assessments, and Beyond.
<em>Journal of Statistical Software</em>, <b>58</b>(1), 1–36.
<a href="https://doi.org/10.18637/jss.v058.i01">doi:10.18637/jss.v058.i01</a>.
</p>


<h3>See Also</h3>

<p><code>xexams</code>,
<code>ttm</code>,
<code>tth</code>,
<code>tex2image</code>,
<code>make_exercise_transform_html</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package and enforce par(ask = FALSE)
library("exams")
options(device.ask.default = FALSE)

## define an exams (= list of exercises)
myexam &lt;- list(
  "boxplots.Rmd",
  c("tstat.Rmd", "ttest.Rmd", "confint.Rmd"),
  c("regression.Rmd", "anova.Rmd"),
  c("scatterplot.Rmd", "boxhist.Rmd"),
  "relfreq.Rmd"
)

## output directory
dir.create(mydir &lt;- tempfile())

## generate .zip with QTI 2.1 exam in temporary directory
## using a few customization options
exams2qti21(myexam, n = 3, dir = mydir,
  maxattempts = 3,
  num = list(digits = 1),
  mchoice = list(shuffle = TRUE, enumerate = TRUE)
)
dir(mydir)
</code></pre>


</div>