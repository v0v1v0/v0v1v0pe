<div class="container">

<table style="width: 100%;"><tr>
<td>devd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Extreme Value Distributions
</h2>

<h3>Description</h3>

<p>Density, distribution function (df), quantile function and random generation for the generalized extreme value and generalized Pareto distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">devd(x, loc = 0, scale = 1, shape = 0, threshold = 0, log = FALSE,
    type = c("GEV", "GP"))

pevd(q, loc = 0, scale = 1, shape = 0, threshold = 0, lambda = 1, 
    npy, type = c("GEV", "GP", "PP", "Gumbel", "Frechet", "Weibull", 
        "Exponential", "Beta", "Pareto"), lower.tail = TRUE, log.p = FALSE)

qevd(p, loc = 0, scale = 1, shape = 0, threshold = 0,
    type = c("GEV", "GP", "PP", "Gumbel", "Frechet", "Weibull", "Exponential", "Beta",
    "Pareto"), lower.tail = TRUE)

revd(n, loc = 0, scale = 1, shape = 0, threshold = 0,
    type = c("GEV", "GP"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>numeric vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric vector of probabilities.  Must be between 0 and 1 (non-inclusive).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npy</code></td>
<td>
<p>Number of points per period (period is usually year).  Currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Event frequency base rate.  Currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc, scale, shape</code></td>
<td>
<p>location, scale and shape parameters.  Each may be a vector of same length as <code>x</code> (<code>devd</code> or length <code>n</code> for <code>revd</code>.  Must be length 1 for <code>pevd</code> and <code>qevd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>numeric giving the threshold for the GP df.  May be  a vector of same length as <code>x</code> (<code>devd</code> or length <code>n</code> for <code>revd</code>.  Must be length 1 for <code>pevd</code> and <code>qevd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilites p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x] otherwise, P[X &gt; x].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; one of "GEV" or "GP" describing whether to use the GEV or GP.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The extreme value distributions (EVD's) are generalized extreme value (GEV) or generalized Pareto (GP); if type is “PP”, then <code>pevd</code> changes it to “GEV”.  The point process characterization is an equivalent form, but is not handled here.  The GEV df is given by
</p>
<p>Pr(X &lt;= x) = G(x) = exp[-(1 + shape * (x - location)/scale)^(-1/shape)]
</p>
<p>for 1 + shape*(x - location) &gt; 0 and scale &gt; 0.  It the shape parameter is zero, then the df is defined by continuity and simplies to
</p>
<p>G(x) = exp(-exp((x - location)/scale)).
</p>
<p>The GEV df is often called a family of df's because it encompasses the three types of EVD's: Gumbel (shape = 0, light tail), Frechet (shape &gt; 0, heavy tail) and the reverse Weibull (shape &lt; 0, bounded upper tail at location - scale/shape).  It was first found by R. von Mises (1936) and also independently noted later by meteorologist A. F. Jenkins (1955).  It enjoys theretical support for modeling maxima taken over large blocks of a series of data.
</p>
<p>The generalized Pareo df is given by (Pickands, 1975)
</p>
<p>Pr(X &lt;= x) = F(x) = 1 - [1 + shape * (x - threshold)/scale]^(-1/shape)
</p>
<p>where 1 + shape * (x - threshold)/scale &gt; 0, scale &gt; 0, and x &gt; threshold.  If shape = 0, then the GP df is defined by continuity and becomes
</p>
<p>F(x) = 1 - exp(-(x - threshold)/scale).
</p>
<p>There is an approximate relationship between the GEV and GP df's where the GP df is approximately the tail df for the GEV df.  In particular, the scale parameter of the GP is a function of the threshold (denote it scale.u), and is equivalent to scale + shape*(threshold - location) where scale, shape and location are parameters from the “equivalent” GEV df.  Similar to the GEV df, the shape parameter determines the tail behavior, where shape = 0 gives rise to the exponential df (light tail), shape &gt; 0 the Pareto df (heavy tail) and shape &lt; 0 the Beta df (bounded upper tail at location - scale.u/shape).  Theoretical justification supports the use of the GP df family for modeling excesses over a high threshold (i.e., y = x - threshold).  It is assumed here that <code>x</code>, <code>q</code> describe x (not y = x - threshold).  Similarly, the random draws are y + threshold.
</p>
<p>See Coles (2001) and Reiss and Thomas (2007) for a very accessible text on extreme value analysis and for more theoretical texts, see for example, Beirlant et al. (2004), de Haan and Ferreira (2006), as well as Reiss and Thomas (2007).
</p>


<h3>Value</h3>

<p>'devd' gives the density function, 'pevd' gives the distribution function, 'qevd' gives the quantile function, and 'revd' generates random deviates for the GEV or GP df depending on the type argument.
</p>


<h3>Note</h3>

<p>There is a similarity between the location parameter of the GEV df and the threshold for the GP df.  For clarity, two separate arguments are emplyed here to distinguish the two instead of, for example, just using the location parameter to describe both.
</p>


<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Beirlant, J., Goegebeur, Y., Teugels, J. and Segers, J. (2004) <em>Statistics of Extremes: Theory and Applications</em>.  Chichester, West Sussex, England, UK: Wiley, ISBN 9780471976479, 522pp.
</p>
<p>Coles, S.  (2001) <em>An introduction to statistical modeling of extreme values</em>, London, U.K.: Springer-Verlag, 208 pp.
</p>
<p>de Haan, L. and Ferreira, A. (2006) <em>Extreme Value Theory: An Introduction</em>.  New York, NY, USA: Springer, 288pp.
</p>
<p>Jenkinson, A. F. (1955) The frequency distribution of the annual maximum (or minimum) of meteorological elements. <em>Quart. J. R.  Met. Soc.</em>, <b>81</b>, 158–171.
</p>
<p>Pickands, J. (1975) Statistical inference using extreme order statistics.  <em>Annals of Statistics</em>, <b>3</b>, 119–131.
</p>
<p>Reiss, R.-D. and Thomas, M. (2007) <em>Statistical Analysis of Extreme Values: with applications to insurance, finance, hydrology and other fields</em>. Birkhauser, 530pp., 3rd edition.
</p>
<p>von Mises, R. (1936) La distribution de la plus grande de n valeurs, <em>Rev. Math. Union Interbalcanique</em> <b>1</b>, 141–160.
</p>


<h3>See Also</h3>

<p><code>fevd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## GEV df (Frechet type)
devd(2:4, 1, 0.5, 0.8) # pdf
pevd(2:4, 1, 0.5, 0.8) # cdf 
qevd(seq(1e-8,1-1e-8,,20), 1, 0.5, 0.8) # quantiles
revd(10, 1, 0.5, 0.8) # random draws

## GP df
devd(2:4, scale=0.5, shape=0.8, threshold=1, type="GP")
pevd(2:4, scale=0.5, shape=0.8, threshold=1, type="GP")
qevd(seq(1e-8,1-1e-8,,20), scale=0.5, shape=0.8, threshold=1, type="GP")
revd(10, scale=0.5, shape=0.8, threshold=1, type="GP")

## Not run: 
# The fickleness of extremes.
z1 &lt;- revd(100, 1, 0.5, 0.8)
hist(z1, breaks="FD", freq=FALSE, xlab="GEV distributed random variables", col="darkblue")
lines(seq(0,max(z1),,200), devd(seq(0,max(z1),,200), 1, 0.5, 0.8), lwd=1.5, col="yellow")
lines(seq(0,max(z1),,200), devd(seq(0,max(z1),,200), 1, 0.5, 0.8), lwd=1.5, lty=2) 

z2 &lt;- revd(100, 1, 0.5, 0.8)
qqplot(z1, z2)

z3 &lt;- revd(100, scale=0.5, shape=0.8, threshold=1, type="GP")
# Or, equivalently
z4 &lt;- revd(100, 5, 0.5, 0.8, 1, type="GP") # the "5" is ignored.
qqplot(z3, z4)

# Just for fun.
qqplot(z1, z3)

# Compare
par(mfrow=c(2,2))
plot(density(z1), xlim=c(0,100), ylim=c(0,1))
plot(density(z2), xlim=c(0,100), ylim=c(0,1))
plot(density(z3), xlim=c(0,100), ylim=c(0,1))
plot(density(z4), xlim=c(0,100), ylim=c(0,1))

# Three types
x &lt;- seq(0,10,,200)
par(mfrow=c(1,2))
plot(x, devd(x, 1, 1, -0.5), type="l", col="blue", lwd=1.5,
    ylab="GEV df")
# Note upper bound at 1 - 1/(-0.5) = 3 in above plot.

lines(x, devd(x, 1, 1, 0), col="lightblue", lwd=1.5)
lines(x, devd(x, 1, 1, 0.5), col="darkblue", lwd=1.5)
legend("topright", legend=c("(reverse) Weibull", "Gumbel", "Frechet"),
    col=c("blue", "lightblue", "darkblue"), bty="n", lty=1, lwd=1.5)

plot(x, devd(x, 1, 1, -0.5, 1, type="GP"), type="l", col="blue", lwd=1.5,
    ylab="GP df")
lines(x, devd(x, 1, 1, 0, 1, type="GP"), col="lightblue", lwd=1.5)
lines(x, devd(x, 1, 1, 0.5, 1, type="GP"), col="darkblue", lwd=1.5)
legend("topright", legend=c("Beta", "Exponential", "Pareto"), 
    col=c("blue", "lightblue", "darkblue"), bty="n", lty=1, lwd=1.5)

# Emphasize the tail differences more by using different scale parameters.
par(mfrow=c(1,2))
plot(x, devd(x, 1, 0.5, -0.5), type="l", col="blue", lwd=1.5,
    ylab="GEV df")
lines(x, devd(x, 1, 1, 0), col="lightblue", lwd=1.5)
lines(x, devd(x, 1, 2, 0.5), col="darkblue", lwd=1.5)
legend("topright", legend=c("(reverse) Weibull", "Gumbel", "Frechet"), 
    col=c("blue", "lightblue", "darkblue"), bty="n", lty=1, lwd=1.5)

plot(x, devd(x, 1, 0.5, -0.5, 1, type="GP"), type="l", col="blue", lwd=1.5,
    ylab="GP df")
lines(x, devd(x, 1, 1, 0, 1, type="GP"), col="lightblue", lwd=1.5)
lines(x, devd(x, 1, 2, 0.5, 1, type="GP"), col="darkblue", lwd=1.5)
legend("topright", legend=c("Beta", "Exponential", "Pareto"),
    col=c("blue", "lightblue", "darkblue"), bty="n", lty=1, lwd=1.5)


## End(Not run)
</code></pre>


</div>