<div class="container">

<table style="width: 100%;"><tr>
<td>ee.wgee.mean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating equation for marginal mean under WGEE for missing longitudinal data under the mechanism of missing at random and drop-out</h2>

<h3>Description</h3>

<p>Calculate estimating function from WGEE. This estimating function is used for marginal mean selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ee.wgee.mean(y,x,r,pi,id,time,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector containing outcomes. use NA to indicate missing outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>A vector containing observing probabilities across all observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The number of observations for each subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as WGEE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as WGEE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A specified distribution. It can be "gaussian", "poisson",and "binomial".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>A candidate correlation structure. It can be "independence","exchangeable", and "ar1".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Note</h3>

<p>corstr should be prespecified.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates.
# Note that "obs_ind" is an indicator of observations in the missing data model.
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,
     scale = NULL,mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
wgee.matrix&lt;-ee.wgee.mean(y=wgeesimdata$y,x=wgeesimdata$x,r=wgeesimdata$obs_ind,
pi=pi,id=wgeesimdata$id,time=3,beta=beta,rho=rho,phi=phi,dist=dist,corstr=corstr)
apply(wgee.matrix,1,mean)
</code></pre>


</div>