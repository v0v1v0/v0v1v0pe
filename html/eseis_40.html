<div class="container">

<table style="width: 100%;"><tr>
<td>read_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load seismic data from an archive</h2>

<h3>Description</h3>

<p>The function loads seismic data from a data directory structure (see 
<code>aux_organisecubefiles</code>) based on the event start time, duration,
component and station ID. The data to be read needs to be adequately 
structured. The data directory must contain mseed or SAC files. These 
files will either be identified automatically or can be defined 
explicitly by the parameter <code>format</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_data(
  start,
  duration,
  station,
  component = "BHZ",
  format,
  dir,
  pattern = "eseis",
  simplify = TRUE,
  interpolate = FALSE,
  eseis = TRUE,
  try = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p><code>POSIXct</code> value, start time of the data to import. If
lazy users only submit a text string instead of a POSIXct object, the 
function will try to convert that text string, assuming UTC as time zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p><code>Numeric</code> value, duration of the data to import,
in seconds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station</code></td>
<td>
<p><code>Character</code> value, seismic station ID, which must
correspond to the ID in the file name of the data directory structure 
(cf. <code>aux_organisecubefiles</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p><code>Character</code> value, seismic component, which must
correspond to the component name in the file name of the data directory  
structure (cf. <code>aux_organisecubefiles</code>). Default is 
<code>"BHZ"</code> (vertical component of a sac file).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p><code>Character</code> value, seismic data format. One out of 
<code>"sac"</code> and <code>"mseed"</code>. If omitted, the function will try to 
identify the right format automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p><code>Character</code> value, path to the seismic data directory.
See details for further info on data structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p><code>Character</code> value, either keyword or pattern string 
with wildcards, describing the data organisation. Supported keywords are 
<code>"eseis"</code> and <code>"seiscomp"</code>. See details for keyword definition 
and format of pattern strings. Default option is <code>eseis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p><code>Logical</code> value, option to simplify output
when possible. This basically means that if only data from one station 
is loaded, the list object will have one level less. Default is 
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p><code>Logical</code> value, option to interpolate possible 
gaps in the resulting data stream. If enabled, NA values will be identified 
and linearly interpolated using the function <code>signal_fill</code>. Default 
is <code>FALSE</code>, i.e. NA gaps will remain in the imported data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eseis</code></td>
<td>
<p><code>Logical</code> value, option to read data to an <code>eseis</code>
object (recommended, see documentation of 
<code>aux_initiateeseis</code>), default is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try</code></td>
<td>
<p><code>Logical</code> value, option to run the function in try-mode, 
i.e., to let it return <code>NA</code> in case an error occurs during data
import. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to describe data structure, only needed for 
pattern type <code>seiscomp</code>. These arguments can be one or more of the 
following: <code>"network"</code>, <code>"type"</code>, <code>"location"</code>. If omitted, 
the function will identify all files in the SeisComP data archive that 
fulfill the criteria. If other than data files (<code>type = "D"</code>) or 
files from another network are in the archive, these may lead to crashes  
of the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data organisation must follow a consistent scheme. The default scheme, 
<code>eseis</code> (Dietze, 2018 ESurf) requires 
hourly files organised in a directory for each Julian Day, and in each  
calendar year. The file name must be entirely composed of 
station ID, 2-digit year, Julian Day, hour, minute, second and 
channel name. Each item must be separated by a full stop, 
e.g. <code>"2013/203/IGB01.13.203.16.00.00.BHZ"</code> for a 
file from 2013, Julian Day 203, from station IGB01, covering one hour from 
<code>"16:00:00 UTC"</code>, and containing the BHZ component. Each Julian Day directory 
can contain files from different components and stations. The respective 
pattern string to describe that file organisation is 
<code>"%Y/%j/%STA.%y.%j.%H.%M.%S.%CMP"</code>. The percent sign indicates  
a wild card, where <code>%Y</code> is the 4-digit year, <code>%j</code> the 3-digit Julian 
Julian Day, <code>%STA</code> the station ID, <code>%y</code> the 2-digit year, 
<code>%H</code> the 2-digit hour, <code>%M</code> the 2-digit minute, <code>%S</code> the 
2-digit second and <code>%CMP</code> the component ID. The files can have a 
further file extension which does not need to be explicitly defined in the 
pattern string. The slashes in the above pattern string define 
subdirectories.
</p>
<p>An alternative organisation scheme is the one used by SeisComP, indicated 
by the keyword <code>"seiscomp"</code> or the pattern string 
<code>"%Y/%NET/%STA/%CMP/%NET.%STA.%LOC.%CMP.%TYP.%Y.%j"</code>. 
The wild card <code>"NET"</code> means the network ID, <code>"LOC"</code> the location 
abbreviation and <code>"TYP"</code> the data type. The other wild cards are as 
defined above. Hence, the SeisComP scheme consists of directories of the 
calendar year, the network to which the data belongs, the station it has 
been recorded by, and the component it belongs to. The files in that 
latter directory must be daily files.
</p>


<h3>Value</h3>

<p>A <code>list</code> object containing either a set of <code>eseis</code>
objects or a data set with the time vector (<code>$time</code>) 
and a list of seismic stations (<code>$station_ID</code>) with their seismic
signals as data frame (<code>$signal</code>). If <code>simplify = TRUE</code> (the 
default option) and only one seismic station is provided, the output  
object containseither just one eseis object or the vectors for 
<code>$time</code> and <code>$signal</code>.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## set seismic data directory
dir_data &lt;- paste0(system.file("extdata", package="eseis"), "/")

## load the z component data from a station
data &lt;- read_data(start = as.POSIXct(x = "2017-04-09 01:20:00", 
                                        tz = "UTC"), 
                      duration = 120,
                      station = "RUEG1",
                      component = "BHZ",
                      dir = dir_data)
## plot signal
plot_signal(data = data)

## load data from two stations
data &lt;- read_data(start = as.POSIXct(x = "2017-04-09 01:20:00", 
                                     tz = "UTC"), 
                  duration = 120,
                  station = c("RUEG1", "RUEG2"),
                  component = "BHZ",
                  dir = dir_data)

## plot both signals
par(mfcol = c(2, 1))
lapply(X = data, FUN = plot_signal)
                     
</code></pre>


</div>