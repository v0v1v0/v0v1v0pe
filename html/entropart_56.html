<div class="container">

<table style="width: 100%;"><tr>
<td>ChaoPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Phylogenetic Diversity of a Community
</h2>

<h3>Description</h3>

<p>Calculates the phylogenetic diversity of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ChaoPD(Ps, q = 1, PhyloTree, Normalize = TRUE, Prune = FALSE, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A number: the order of diversity. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhyloTree</code></td>
<td>

<p>An object of class <code>hclust</code>, "phylo" (see <code>read.tree</code>), <code>phylog</code> or <code>PPtree</code>. The tree is not necessarily ultrametric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), diversity is not affected by the height of the tree.<br>
If <code>FALSE</code>, it is proportional to the height of the tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prune</code></td>
<td>

<p>What to do when somes species are in the tree but not in <code>Ps</code>?<br>
If <code>TRUE</code>, the tree is pruned to keep species of <code>Ps</code> only. The height of the tree may be changed if a pruned branch is related to the root.<br>
If <code>FALSE</code> (default), species with probability 0 are added in <code>Ps</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The phylogenetic diversity is calculated following Chao <em>et al.</em> (2010). The result is identical to the total diversity calculated by <code>PhyloDiversity</code> but it is much faster. A single value is returned instead of a <code>PhyloDiversity</code> object, and no bias correction is available.
</p>
<p>The <code>Normalize</code> arguments allows calculating either <code class="reqn">^{q}\bar{D}(T)</code> (if <code>TRUE</code>) or <code class="reqn">^{q}PD(T)</code> if <code>FALSE</code>.
</p>
<p>Diversity can be calculated for non ultrametric trees following Chao <em>et al.</em> (2010) even though the meaning of the result is not so clear (Leinster and Cobold, 2011).
</p>


<h3>Value</h3>

<p>A named number equal the diversity of the community. The name is "None" to recall that no bias correction is available.
</p>


<h3>References</h3>

<p>Chao, A., Chiu, C.-H. and Jost, L. (2010). Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society B</em> 365(1558): 3599-609.
</p>
<p>Leinster, T. and Cobbold, C. (2011). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>


<h3>See Also</h3>

<p><code>PhyloDiversity</code>, <code>AllenH</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps

# Calculate the phylogenetic Simpson diversity of the plot
(ChaoPD(Paracou618.MC$Ps, 2, Paracou618.Taxonomy, Normalize=TRUE))

# Calculate it using PhyloDiversity
# (more powerful but much slower if the tree has many periods)
PhyloDiversity(Paracou618.MC$Ps, 2, Paracou618.Taxonomy, Normalize=TRUE) -&gt; phyD
summary(phyD)
</code></pre>


</div>