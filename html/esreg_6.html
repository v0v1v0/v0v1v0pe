<div class="container">

<table style="width: 100%;"><tr>
<td>esreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Joint Quantile and Expected Shortfall Regression</h2>

<h3>Description</h3>

<p>Estimates a joint linear regression model for the pair (VaR, ES):
</p>
<p style="text-align: center;"><code class="reqn">Q_\alpha(Y | Xq) = Xq'\beta_q</code>
</p>

<p style="text-align: center;"><code class="reqn">ES_\alpha(Y | Xe) = Xe'\beta_e</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">esreg(...)

## S3 method for class 'formula'
esreg(
  formula,
  data = parent.frame(),
  alpha,
  g1 = 2L,
  g2 = 1L,
  early_stopping = 10,
  ...
)

## Default S3 method:
esreg(xq, xe, y, alpha, g1 = 2L, g2 = 1L, early_stopping = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments (does not apply here)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula: y ~ x1 + x2 ... | x1 + x2 ...
where the first part after the response variable specifies the quantile equation
and the second the expected shortfall part. If only one set of regressors is
provided it is used for both model specifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame that holds the variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Probability level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1</code></td>
<td>
<p>1, 2 (see G1_fun, G1_prime_fun), defaults to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>1, 2, 3, 4, 5 (see G2_curly_fun, G2_fun, G2_prime_fun). defaults to 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early_stopping</code></td>
<td>
<p>Stop the iterated local search if there is no improvement in early_stopping steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xq</code></td>
<td>
<p>Explanatory variables for the quantile regression equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xe</code></td>
<td>
<p>Explanatory variables for the expected shortfall regression equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An esreg object
</p>


<h3>References</h3>

<p><a href="https://arxiv.org/abs/1704.02213">A Joint Quantile and Expected Shortfall Regression Framework</a>
</p>


<h3>See Also</h3>

<p><code>vcov.esreg</code> for covariance estimation
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate data (DGP-(2) in the linked paper)
set.seed(0)
x &lt;- rchisq(1000, df=1)
y &lt;- -x + (1 + 0.5 * x) * rnorm(1000)

# True quantile and expected shortfall regression parameters (for alpha=0.025)
alpha=0.025
true_pars &lt;- c(-1.959964, -1.979982, -2.337803, -2.168901)

# Estimate the model using the standard settings
fit &lt;- esreg(y ~ x, alpha=alpha)

# Compare the different variance-covariance estimators
cov1 &lt;- vcov(object=fit, sparsity="iid", sigma_est="ind")
cov2 &lt;- vcov(object=fit, sparsity="nid", sigma_est="scl_N")
cov3 &lt;- vcov(object=fit, sparsity="nid", sigma_est="scl_sp")

print("Comparison of the variance-covariance estimators")
print(cbind(Truth=true_pars,
            Estimate=coef(fit),
            SE_iid_ind=sqrt(diag(cov1)),
            SE_nid_N=sqrt(diag(cov2)),
            SE_nid_sp=sqrt(diag(cov3))))

# Compares estimates using different G2 functions
fit1 &lt;- esreg(y ~ x, alpha=alpha, g2=1)
fit2 &lt;- esreg(y ~ x, alpha=alpha, g2=2)
fit3 &lt;- esreg(y ~ x, alpha=alpha, g2=3)
fit4 &lt;- esreg(y ~ x, alpha=alpha, g2=4)
fit5 &lt;- esreg(y ~ x, alpha=alpha, g2=5)
fits &lt;- sapply(list(fit1, fit2, fit3, fit4, fit5), coef)
colnames(fits) &lt;- sapply(1:5, function(i) esreg:::.G_function_names(1, i)[2])
print("Comparison of the five G2 functions")
print(rbind(Truth=true_pars, t(fits)))

# Usage of different covariates
x &lt;- rchisq(1000, df=1)
noise &lt;- rnorm(1000)
y &lt;- -x + (1 + 0.5 * x) * rnorm(1000)
fit &lt;- esreg(y ~ x | x + noise, alpha=0.025)
print("Using different covariates for VaR and ES")
print(summary(fit))

</code></pre>


</div>