<div class="container">

<table style="width: 100%;"><tr>
<td>factor_scores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes Factor Scores
</h2>

<h3>Description</h3>

<p>This function computes factor scores for observations. 
Using factor scores,
we can represent the original data point <code class="reqn">y_j</code> in a 
<em>q</em>-dimensional reduced space. This is only meaningful
in the case of <code>mcfa</code> or <code>mctfa</code> models,
as the factor cores for <code>mfa</code> and <code>mtfa</code> are
white noise.
</p>
<p>The (estimated conditional expectation of) unobservable factors
<code class="reqn">U_{ij}</code> given <code class="reqn">y_j</code> and the component membership
can be expressed by,
</p>
<p style="text-align: center;"><code class="reqn">
\hat{u}_{ij} = E_{\hat{\Psi}}\{U_{ij} \mid y_j, z_{ij} = 1\}.
</code>
</p>

<p>The estimated mean <code class="reqn">U_{ij}</code> (over the
component membership of <code class="reqn">y_j</code>)
is give as
</p>
<p style="text-align: center;"><code class="reqn">
\hat{u}_{j} = \sum_{i=1}^g \tau_i(y_j; \hat{\Psi}) \hat{u}_{ij},
</code>
</p>

<p>where <code class="reqn">\tau_i(y_j; \hat{\Psi})</code>
estimated posterior probability of <code class="reqn">y_j</code>
belonging to the <code class="reqn">i</code>th component.
</p>
<p>An alternative estimate of <code class="reqn">u_j</code>, the posterior expectation
of the factor corresponding to the <em>j</em>th observation <code class="reqn">y_j</code>, is
defined by replacing <code class="reqn">\tau_i(y_j;\,\hat{\Psi})</code> by <code class="reqn">\hat{z}_{ij}</code>,
where
<code class="reqn">\hat{z}_{ij} = 1</code>, if <code class="reqn">\hat{\tau}_i(y_j; \hat{\Psi})</code>
&gt;= <code class="reqn">\hat{\tau_h}(y_j; \hat{\Psi})
(h=1,\,\dots,\,g; h \neq i)</code>, else
<code class="reqn">\hat{z}_{ij} = 0</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\hat{u}_{j}^C = \sum_{i=1}^g \hat{z}_{ij} \hat{u}_{ij}.
</code>
</p>

<p>For MFA, we have
</p>
<p style="text-align: center;"><code class="reqn">
\hat{u}_{ij} = \hat{\beta}_i^T (y_j - \hat{\mu}_i),
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
\hat{u}_{j} = \sum_{i=1}^g \tau_i(y_j;  \hat{\Psi}) \hat{\beta}_i^T
  (y_j - \hat{\mu}_i)
</code>
</p>

<p>for <code class="reqn">j = 1, \dots, n</code> where
<code class="reqn">\hat{\beta}_i = (B_iB_i^T + D_i)^{-1} B_i</code>.
</p>
<p>For MCFA,
</p>
<p style="text-align: center;"><code class="reqn">
\hat{u}_{ij} = \hat{\xi}_i + \hat{\gamma}_i^T (y_j -\hat{A}\hat{\xi}_i),
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\hat{u}_{j} = \sum_{i=1}^g\tau_i(y_j; \hat{\Psi})
\{\hat{\xi}_i + \hat{\gamma}_i^T(y_j -\hat{A}\hat{\xi}_i)\},
</code>
</p>

<p>where <code class="reqn">\gamma_i =  (A \Omega_i A + D)^{-1} A \Omega_i</code>.
</p>
<p>With M<em>t</em>FA and MC<em>t</em>FA, the distribution of
<code class="reqn">\hat{u}_{ij}</code> and of <code class="reqn">\hat{u}_{j}</code>
have the same form as those of MFA and MCFA, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">factor_scores(model, Y, ...)
## S3 method for class 'mcfa'
factor_scores(model, Y, tau = NULL, clust= NULL, ...)
## S3 method for class 'mctfa'
factor_scores(model, Y, tau = NULL, clust= NULL, ...)
## S3 method for class 'emmix'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>An object of class <code>mfa, mcfa, mtfa</code> or <code>mctfa</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of class <code>mfa, mcfa, mtfa</code> or <code>mctfa</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Data matrix with variables in columns in the same order as used in
model estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>Optional. Posterior probabilities of belonging to the components
in the mixture model. If not provided, they will be computed based on 
the <code>model</code> parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>

<p>Optional. Indicators of belonging to the components.
If not provided, will be estimated using <code>tau</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Factor scores can be used in visualization of the data
in the factor space.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Uscores</code></td>
<td>

<p>Estimated conditional expected component scores of the
unobservable factors given the data and the component membership
(<code class="reqn">\hat{u}_{ij}</code>).
Size is <code class="reqn">n \times q \times g</code>, where <code>n</code> is the number of sample,
<code>q</code> is the number of factors and <code>g</code> is the number components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Umean</code></td>
<td>

<p>Means of the estimated conditional expected factors scores over
estimated posterior distributions (<code class="reqn">\hat{u}_{j}</code>).
Size <code class="reqn">n \times q</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uclust</code></td>
<td>

<p>Alternative estimate of <code>Umean</code> where the posterior probabilities
for each sample are replaced by component indicator vectors
which contain one in the element corresponding to the highest posterior
probability while others zero (<code class="reqn">\hat{u}_{j}^C</code>).  Size <code class="reqn">n \times q</code>.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Geoff McLachlan, Suren Rathnayake, Jungsun Baek
</p>


<h3>References</h3>

<p>McLachlan GJ, Baek J, and Rathnayake SI (2011). Mixtures of factor analyzers
for the analysis of high-dimensional data.
In <em>Mixture Estimation and Applications</em>,
KL Mengersen, CP Robert, and DM Titterington (Eds).
Hoboken, New Jersey: Wiley, pp. 171â€“191.
</p>
<p>McLachlan GJ, and Peel D (2000). <em>Finite Mixture Models</em>.
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fit a MCFA model to a subset
set.seed(1)
samp_size &lt;- dim(iris)[1]
sel_subset &lt;- sample(1 : samp_size, 50)
model &lt;- mcfa(iris[sel_subset, -5], g = 3, q = 2, 
                          nkmeans = 1, nrandom = 0, itmax = 100)

# plot the data points in the factor space
plot(model)

# Allocating new samples to the clusters
Y &lt;- iris[-c(sel_subset), -5]
Y &lt;- as.matrix(Y)
clust &lt;- predict(model, Y)

fa_scores &lt;- factor_scores(model, Y)
# Visualizing new data in factor space
plot_factors(fa_scores, type = "Umean", clust = clust)
</code></pre>


</div>