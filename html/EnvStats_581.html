<div class="container">

<table style="width: 100%;"><tr>
<td>tolIntNparN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample Size for Nonparametric Tolerance Interval for Continuous Distribution
</h2>

<h3>Description</h3>

<p>Compute the sample size necessary for a nonparametric tolerance interval (for a continuous 
distribution) with a specified coverage and, in the case of a <code class="reqn">\beta</code>-content tolerance 
interval, a specified confidence level, given the ranks of the order statistics used for the 
interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  tolIntNparN(coverage = 0.95, conf.level = 0.95, cov.type = "content", 
    ltl.rank = ifelse(ti.type == "upper", 0, 1), 
    n.plus.one.minus.utl.rank = ifelse(ti.type == "lower", 0, 1),  
    ti.type = "two.sided")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>

<p>numeric vector of values between 0 and 1 indicating the desired coverage of the 
tolerance interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric vector of values between 0 and 1 indicating the confidence level of the 
tolerance interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.type</code></td>
<td>

<p>character string specifying the coverage type for the tolerance interval.  
The possible values are <code>"content"</code> (<code class="reqn">\beta</code>-content; the default), and 
<code>"expectation"</code> (<code class="reqn">\beta</code>-expectation).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltl.rank</code></td>
<td>

<p>vector of positive integers indicating the rank of the order statistic to use for the lower bound 
of the tolerance interval.  If <code>ti.type="two-sided"</code> or <br><code>ti.type="lower"</code>, 
the default value is <code>ltl.rank=1</code> (implying the minimum value of <code>x</code> is used 
as the lower bound of the tolerance interval).  If <br><code>ti.type="upper"</code>, this argument 
is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.plus.one.minus.utl.rank</code></td>
<td>

<p>vector of positive integers related to the rank of the order statistic to use for 
the upper bound of the tolerance interval.  A value of 
<code>n.plus.one.minus.utl.rank=1</code> (the default) means use the 
first largest value, and in general a value of <br><code>n.plus.one.minus.utl.rank=</code><code class="reqn">i</code> means use the <code class="reqn">i</code>'th largest value.  
If <br><code>ti.type="lower"</code>, this argument is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ti.type</code></td>
<td>

<p>character string indicating what kind of tolerance interval to compute.  
The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the arguments <code>coverage</code>, <code>conf.level</code>, <code>ltl.rank</code>, and 
<code>n.plus.one.minus.utl.rank</code> are not all the same length, they are replicated to be the 
same length as the length of the longest argument.
</p>
<p>The help file for <code>tolIntNpar</code> explains how nonparametric tolerance intervals 
are constructed.  
</p>
<p><em>Computing Required Sample Size for a <code class="reqn">\beta</code>-Content Tolerance Interval</em> (<code>cov.type="content"</code>) <br>
For a <code class="reqn">\beta</code>-content tolerance interval, if the coverage <code class="reqn">C=\beta</code> is specified, then the 
associated confidence level <code class="reqn">(1-\alpha)100\%</code> is computed as:
</p>
<p style="text-align: center;"><code class="reqn">1 - \alpha = 1 - F(\beta, v-u, w+u) \;\;\;\;\;\; (1)</code>
</p>

<p>where <code class="reqn">F(y, \delta, \gamma)</code> denotes the cumulative distribution function of a 
beta random variable with parameters <code>shape1=</code><code class="reqn">\delta</code> and 
<code>shape2=</code><code class="reqn">\gamma</code> evaluated at <code class="reqn">y</code>.  The value of <code class="reqn">1-\alpha</code> is determined by 
the argument <code>conf.level</code>.  The value of <code class="reqn">\beta</code> is determined by the argument 
<code>coverage</code>.  The value of <code class="reqn">u</code> is determined by the argument <code>ltl.rank</code>.  The value 
of <code class="reqn">w</code> is determined by the argument <br><code>n.plus.one.minus.utl.rank</code>.  Once these values 
have been determined, the above equation can be solved implicitly for <code class="reqn">n</code>, since
</p>
<p style="text-align: center;"><code class="reqn">v = n + 1 - w \;\;\;\;\;\; (2)</code>
</p>

<p><em>Computing Required Sample Size for a <code class="reqn">\beta</code>-Expectation Tolerance Interval</em> (<code>cov.type="expectation"</code>) <br>
For a <code class="reqn">\beta</code>-expectation tolerance interval, the expected coverage is simply the mean of a 
beta random variable with parameters <code>shape1=</code><code class="reqn">v-u</code> and 
<code>shape2=</code><code class="reqn">w+u</code>, which is given by:
</p>
<p style="text-align: center;"><code class="reqn">E(C) = \frac{v-u}{n+1} \;\;\;\;\;\; (3)</code>
</p>

<p>or, using Equation (2) above, we can re-write the formula for the expected coverage as:
</p>
<p style="text-align: center;"><code class="reqn">E(C) = \frac{n+1-w-u}{n+1} = 1 - \frac{u+w}{n+1} \;\;\;\;\;\; (4)</code>
</p>

<p>Thus, for user-specified values of <code class="reqn">u</code> (<code>ltl.rank</code>), 
<code class="reqn">w</code> (<code>n.plus.one.minus.utl.rank</code>), and expected coverage, the required sample 
size is computed as:
</p>
<p style="text-align: center;"><code class="reqn">n = Ceiling\{ [ \frac{u+w}{1-E(C)} ] - 1 \} \;\;\;\;\;\; (5)</code>
</p>

<p>where <code class="reqn">Ceiling(x)</code> denotes the smallest integer greater than or equal to <code class="reqn">x</code>.  
(See the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for <code>ceiling</code>).
</p>


<h3>Value</h3>

<p>A vector of positive integers indicating the required sample size(s) for the specified 
nonparametric tolerance interval(s).
</p>


<h3>Note</h3>

<p>See the help file for <code>tolIntNpar</code>.
</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine 
the relationship between sample size, coverage, and confidence level if one of the objectives of 
the sampling program is to produce tolerance intervals.  The functions 
<code>tolIntNparN</code>, <code>tolIntNparCoverage</code>, <code>tolIntNparConfLevel</code>, and 
<code>plotTolIntNparDesign</code> can be used to investigate these relationships for 
constructing nonparametric tolerance intervals.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>tolIntNpar</code>.
</p>


<h3>See Also</h3>

<p><code>tolIntNpar</code>, <code>tolIntNparConfLevel</code>, <code>tolIntNparCoverage</code>, 
<code>plotTolIntNparDesign</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Look at how the required sample size for a nonparametric tolerance interval increases 
  # with increasing confidence level:

  seq(0.5, 0.9, by = 0.1) 
  #[1] 0.5 0.6 0.7 0.8 0.9 

  tolIntNparN(conf.level = seq(0.5, 0.9, by = 0.1)) 
  #[1] 34 40 49 59 77

  #----------

  # Look at how the required sample size for a nonparametric tolerance interval increases 
  # with increasing coverage:

  tolIntNparN(coverage = seq(0.5, 0.9, by = 0.1)) 
  #[1]  8 10 14 22 46

  #----------

  # Look at how the required sample size for a nonparametric tolerance interval increases 
  # with the rank of the lower tolerance limit:

  tolIntNparN(ltl.rank = 1:5) 
  #[1]  93 124 153 181 208

  #==========

  # Example 17-4 on page 17-21 of USEPA (2009) uses copper concentrations (ppb) from 3 
  # background wells to set an upper limit for 2 compliance wells.  The maximum value from 
  # the 3 wells is set to the 95% confidence upper tolerance limit, and we need to 
  # determine the coverage of this tolerance interval.  

  tolIntNparCoverage(n = 24, conf.level = 0.95, ti.type = "upper")
  #[1] 0.8826538

  # Here we will modify the example and determine the sample size required to produce 
  # a tolerance interval with 95% confidence level AND 95% coverage. 

  tolIntNparN(coverage = 0.95, conf.level = 0.95, ti.type = "upper")
  #[1] 59
</code></pre>


</div>