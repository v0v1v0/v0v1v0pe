<div class="container">

<table style="width: 100%;"><tr>
<td>CIplot_biv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bivariate confidence and data ellipses
</h2>

<h3>Description</h3>

<p>Draws confidence and data ellipses in bivariate scatterplots
</p>


<h3>Usage</h3>

<pre><code class="language-R">CIplot_biv(x, y, group, wt=rep(1/length(x),length(x)), 
           varnames=c("x","y"), groupnames=sort(unique(group)), 
           groupcols=rainbow(length(unique(group))), 
           shownames=TRUE, xlim=c(NA,NA), ylim=c(NA,NA), 
           lty=1, lwd=1, add=FALSE, alpha=0.95, ellipse=0, 
           shade=FALSE, alpha.f=0.2, frac=0.01, cex=1) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>x-variable (horizontal) of scatterplot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>y-variable (vertical) of scatterplot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Grouping variable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>

<p>Set of weights on the cases (operates when ellipse=1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>

<p>Vector of two labels for the axes (default is x and y)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupnames</code></td>
<td>

<p>Vector of labels for the groups (default is 1, 2, etc...)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupcols</code></td>
<td>

<p>Vector of colours for the groups
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shownames</code></td>
<td>

<p>Whether to show group names at group centroids or not (default is <code>TRUE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>Possible new x-limits for plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>Possible new y-limits for plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>Line type for the ellipses (default is 1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>Line width for the ellipses (default is 1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>=<code>TRUE</code> if ellipses/intervals are added to existing plot (default is <code>FALSE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Confidence level of ellipses (default is 0.95)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>

<p>Type of ellipse (see Details below; default is 0 for normal-based ellipses)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>

<p>=<code>TRUE</code> for ellipse shading (default=<code>FALSE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.f</code></td>
<td>

<p>Shading fraction (default is 0.2)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>

<p>Proportional part defining the width of the bars at the edges of confidence intervals (for <code>ellipse=3</code> and <code>4</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>Character expansion factor for group names
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>CIplot_biv</code> makes various types of confidence and data ellipses, according to option <code>ellipse</code>. Set <code>ellipse&lt;0</code> for regular data-covering ellipses. Set <code>ellipse=0</code> (default) for normal-theory confidence ellipses. Set<code>ellipse=1</code> for bootstrap confidence ellipses. The option <code>ellipse=2</code> for the delta method is not implemented yet.  Set <code>ellipse=3</code> for normal-theory confidence error bars lined up with axes. Set <code>ellipse=4</code> for bootstrap confidence error bars along axes.  The package <code>ellipse</code> is required.
</p>


<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Greenacre, M. (2016), Data reporting and visualization in ecology, Polar Biology, 39:2189-2205.
</p>


<h3>See Also</h3>

<p><code>DOT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some bivariate normal data in three groups with different means
# Means (1,0), (0,1) and (0,0)
means  &lt;- matrix(c(1,0,0,1,0,0), ncol=3)
data   &lt;- matrix(nrow=300, ncol=2)
groups &lt;- sample(rep(c(1,2,3), 100))
for(i in 1:300) data[i,] &lt;- rnorm(c(1,1), mean=means[,groups[i]])
# Plot confidence ellipses with shading
CIplot_biv(data[,1], data[,2], group=groups, shade=TRUE)
</code></pre>


</div>