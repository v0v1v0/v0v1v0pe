<div class="container">

<table style="width: 100%;"><tr>
<td>batch_pubmed_download</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Download PubMed Records in XML or TXT Format</h2>

<h3>Description</h3>

<p>Performs a PubMed Query (via the get_pubmed_ids() function), downloads the 
resulting data (via multiple fetch_pubmed_data() calls) and then saves data in a series of 
xml or txt files on the local drive. The function is suitable for downloading 
a very large number of records.
</p>


<h3>Usage</h3>

<pre><code class="language-R">batch_pubmed_download(pubmed_query_string, dest_dir = NULL, 
                             dest_file_prefix = "easyPubMed_data_", 
                             format = "xml", api_key = NULL, 
                             batch_size = 400, res_cn = 1, 
                             encoding = "UTF8")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pubmed_query_string</code></td>
<td>
<p>String (character-vector of length 1): this is the string 
used for querying PubMed (the standard PubMed Query synthax applies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dest_dir</code></td>
<td>
<p>String (character-vector of length 1): this string corresponds to the name 
of the existing folder where files will be saved. Existing files will be overwritten. 
If NULL, the current working directory will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dest_file_prefix</code></td>
<td>
<p>String (character-vector of length 1): this string is used as 
prefix for the files that are written locally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>String (character-vector of length 1): data will be requested from Entrez 
in this format. Acceptable values are: c("medline","uilist","abstract","asn.1", "xml"). 
When format != "xml", data will be saved as text files (txt).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_key</code></td>
<td>
<p>String (character vector of length 1): user-specific API key to increase 
the limit of queries per second. You can obtain your key from NCBI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>Integer (1 &lt; batch_size &lt; 5000): maximum number of records 
to be saved in a single xml or txt file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res_cn</code></td>
<td>
<p>Integer (&gt; 0): numeric index of the data batch to start downloading from. 
This parameter is useful to resume an incomplete download job after a system crash.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>The encoding of an input/output connection can be specified by name 
(for example, "ASCII", or "UTF-8", in the same way as it would be given to the 
function base::iconv(). See iconv() help page for how to find out more about encodings 
that can be used on your platform. Here, we recommend using "UTF-8".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Download large number of PubMed records as a set of xml or txt files that are saved in the 
folder specified by the user. This function enforces data integrity. If a batch of downloaded 
data is corrupted, it is discarded and downloaded again. Each download cycle is monitored until 
the download job is successfully completed. This function should allow to download a whole copy 
of PubMed, if desired. The function informs the user about the current progress by constantly 
printing to console the number of batches still in queue for download. pubmed_query_string 
accepts standard PubMed synthax. The function will query PubMed multiple times using the same 
query string. Therefore, it is recommended to use a [EDAT] or a [PDAT] filter in the query 
if you want to ensure reproducible results.
</p>


<h3>Value</h3>

<p>Character vector including the names of files downloaded to the local system
</p>


<h3>Author(s)</h3>

<p>Damiano Fantini <a href="mailto:damiano.fantini@gmail.com">damiano.fantini@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://www.data-pulse.com/dev_site/easypubmed/">https://www.data-pulse.com/dev_site/easypubmed/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Example 01: retrieve data from PubMed and save as XML file
ml_query &lt;- "Machine Learning[TI] AND 2016[PD]"
out1 &lt;- batch_pubmed_download(pubmed_query_string = ml_query, batch_size = 180)
readLines(out1[1])[1:30]
##
## Example 02: retrieve data from PubMed and save as TXT file
ml_query &lt;- "Machine Learning[TI] AND 2016[PD]"
out2 &lt;- batch_pubmed_download(pubmed_query_string = ml_query, batch_size = 180, format = "medline")
readLines(out2[1])[1:30]

## End(Not run)

</code></pre>


</div>