<div class="container">

<table style="width: 100%;"><tr>
<td>contourmap.mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contour maps and contour map quality measures using Monte Carlo samples</h2>

<h3>Description</h3>

<p><code>contourmap.mc</code> is used for calculating contour maps and quality measures for contour maps based on Monte Carlo samples of a model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">contourmap.mc(
  samples,
  n.levels,
  ind,
  levels,
  type = c("standard", "equalarea", "P0-optimal", "P1-optimal", "P2-optimal"),
  compute = list(F = TRUE, measures = NULL),
  alpha,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Matrix with model Monte Carlo samples. Each column contains a sample of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.levels</code></td>
<td>
<p>Number of levels in contour map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Indices of the nodes that should be analyzed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Levels to use in contour map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of contour map. One of:
</p>

<dl>
<dt>'standard' </dt>
<dd>
<p>Equidistant levels between smallest and largest value of the posterior mean (default).</p>
</dd>
<dt>'pretty' </dt>
<dd>
<p>Equally spaced 'round' values which cover the range of the values in the posterior mean.</p>
</dd>
<dt>'equalarea' </dt>
<dd>
<p>Levels such that different spatial regions are approximately equal in size.</p>
</dd>
<dt>'P0-optimal' </dt>
<dd>
<p>Levels chosen to maximize the P0 measure.</p>
</dd>
<dt>'P1-optimal' </dt>
<dd>
<p>Levels chosen to maximize the P1 measure.</p>
</dd>
<dt>'P2-optimal' </dt>
<dd>
<p>Levels chosen to maximize the P2 measure.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute</code></td>
<td>
<p>A list with quality indices to compute
</p>

<dl>
<dt>'F': </dt>
<dd>
<p>TRUE/FALSE indicating whether the contour map function should be computed (default TRUE).</p>
</dd>
<dt>'measures': </dt>
<dd>
<p>A list with the quality measures to compute ("P0", "P1", "P2") or corresponding bounds based only on the marginal probabilities ("P0-bound", "P1-bound", "P2-bound").</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Maximal error probability in contour map function (default=0.1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to TRUE for verbose mode (optional).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The contour map is computed for the empirical mean of the samples.
See <code>contourmap</code> and <code>contourmap.inla</code> for further details.
</p>


<h3>Value</h3>

<p><code>contourmap</code> returns an object of class "excurobj" with the following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u </code></td>
<td>
<p>Contour levels used in the contour map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.levels </code></td>
<td>
<p>The number of contours used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.e </code></td>
<td>
<p>The values associated with the level sets G_k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G </code></td>
<td>
<p>A vector which shows which of the level sets G_k each node belongs to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map </code></td>
<td>
<p>Representation of the contour map with map[i]=u.e[k] if i is in G_k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F </code></td>
<td>
<p>The contour map function (if computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M </code></td>
<td>
<p>Contour avoiding sets (if <code>F</code> is computed). <code class="reqn">M=-1</code> for all non-significant nodes and  <code class="reqn">M=k</code> for nodes that belong to <code class="reqn">M_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0/P1/P2 </code></td>
<td>
<p>Calculated quality measures (if computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0bound/P1bound/P2bound </code></td>
<td>
<p>Calculated upper bounds quality measures (if computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta </code></td>
<td>
<p>A list containing various information about the calculation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a>
</p>


<h3>References</h3>

<p>Bolin, D. and Lindgren, F. (2017) <em>Quantifying the uncertainty of contour maps</em>, Journal of Computational and Graphical Statistics, 26:3, 513-524.
</p>
<p>Bolin, D. and Lindgren, F. (2018), <em>Calculating Probabilistic Excursion Sets and Related Quantities Using excursions</em>, Journal of Statistical Software, 86(5), 1â€“20.
</p>


<h3>See Also</h3>

<p><code>contourmap</code>, <code>contourmap.inla</code>, <code>contourmap.colors</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 100
Q &lt;- Matrix(toeplitz(c(1, -0.5, rep(0, n - 2))))
mu &lt;- seq(-5, 5, length = n)
## Sample the model 100 times (increase for better estimate)
X &lt;- mu + solve(chol(Q), matrix(rnorm(n = n * 100), nrow = n, ncol = 100))

lp &lt;- contourmap.mc(X, n.levels = 2, compute = list(F = FALSE, measures = c("P1", "P2")))

# plot contourmap
plot(lp$map)
# display quality measures
c(lp$P1, lp$P2)
</code></pre>


</div>