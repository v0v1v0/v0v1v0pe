<div class="container">

<table style="width: 100%;"><tr>
<td>aux_organisecubefiles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Omnirecs/Digos Datacube files to mseed or sac files and organise in directory structure.</h2>

<h3>Description</h3>

<p>This function converts Omnirecs/Digos Datacube files to hourly mseed or 
sac files and organises these in a coherent directory structure, by year, 
Julian day, (station, hour and channel). It depends on the cubetools or   
gipptools software package (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">aux_organisecubefiles(
  stationfile,
  input_dir,
  output_dir,
  format = "sac",
  channel_name = "bh",
  cpu,
  fringe = "constant",
  verbose = FALSE,
  gipptools,
  heapspace,
  mseed_manual = FALSE,
  mseed_keep = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stationfile</code></td>
<td>
<p><code>Character</code> value, file name of the station info 
file, with extension. See <code>aux_stationinfofile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_dir</code></td>
<td>
<p><code>Character</code> value, path to directory where all cube 
files to be processed are stored. Each set of files from one logger must be 
stored in a separate sub-directory named after the cube ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p><code>Character</code> value, path to directory where output 
data is written to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p><code>Character</code> value, output file format. One out of 
<code>"mseed"</code> and <code>"sac"</code>. Default is <code>"sac"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel_name</code></td>
<td>
<p><code>Character</code> value, output file extension. One out 
of <code>"bh"</code> and <code>"p"</code>. Default is <code>"bh"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu</code></td>
<td>
<p><code>Numeric</code> value, fraction of CPUs to use for parallel 
processing. If omitted, one CPU is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fringe</code></td>
<td>
<p><code>Character</code> value, option to handle data outside the 
GPS-tagged time span. One out of <code>"skip"</code>, <code>"nominal"</code> or 
<code>"constant"</code>. Default is <code>"constant"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>Logical</code> value, option to enable extended screen 
output of cubetools operations. Default is <code>FALSE</code>. This option 
might not work with Windows operating systems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gipptools</code></td>
<td>
<p><code>Character</code> value, path to gipptools or cubetools 
directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heapspace</code></td>
<td>
<p><code>Numeric</code> value, heap space assigned to the Java 
Runtime Environment, e.g., <code>4096</code>. Should be increased if the cube 
to mseed conversion fails (announced if <code>verbose = TRUE</code>). Please 
note that this argument fails on Windows machines, and also in other 
operating systems, it should only be used if the function returns an
error caused by Java running out of memory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mseed_manual</code></td>
<td>
<p><code>Logical</code> value, option to convert mseed files 
manually. See details. Default is <code>FALSE</code>, i.e., the function converts 
cube files to mseed files using the GIPP tools.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mseed_keep</code></td>
<td>
<p><code>Logical</code> value, option to keep mseed files instead 
of deleting them. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function converts seismic data from the cube file format to either 
mseed (cf. <code>read_mseed</code>) or sac (cf. <code>read_sac</code>) and cuts the 
daily cube files to hourly files. These hourly files are organised in a 
coherent directory structure which is organised by year and Julian day. 
In each Julian day directory the hourly files are placed and named after 
the following scheme: 
STATIONID.YEAR.JULIANDAY.HOUR.MINUTE.SECOND.CHANNEL.<br>
The function requires that the software cubetools 
(<code>http://www.omnirecs.de/documents.html</code>) or gipptools 
(<code>http://www.gfz-potsdam.de/en/section/geophysical-deep-sounding/infrastructure/geophysical-instrument-pool-potsdam-gipp/software/gipptools/</code>) 
are installed. <br> Specifying an input directory 
(<code>input_dir</code>) is mandatory. This input directory must only contain the 
subdirectories with the cube files to process, each set of cube files must 
be located in a separate subdirectory and these subdiretories must 
have the same name as specified by the logger IDs (<code>logger_ID</code>). An 
appropriate structure would be something like: <br></p>

<ol><li>
<p> input
</p>

<ol>
<li>
<p> A1A
</p>

<ol>
<li>
<p> file1.A1A
</p>
</li>
<li>
<p> file2.A1A
</p>
</li>
</ol>
</li>
<li>
<p> A1B
</p>

<ol>
<li>
<p> file1.A1B
</p>
</li>
<li>
<p> file2.A1B
</p>
</li>
</ol>
</li>
</ol>
</li></ol>
<p>With one of the latest updates of either R or Java the cache size for 
converting cube files to mseed files has been reduced. 
Thus, in several cases the conversion 
stops due to buffer overruns. This effect has been particularly observed 
when trying to convert more than about 20 consecutive days of cube files
at once. In such a case, it is appropriate to set the function argument
mseed_manual to <code>TRUE</code>. This will stop the function just at the point
where the function would call the GIPPtools function cube2mseed. The user 
will see a confirmation command line in the R console, which asks 
to first copy all manually converted mseed files to the directory 
<code>mseed_raw</code> before confirming to continue with the R function. To 
convert all cube files to mseed files it is advised to open a terminal and 
run the function <code>GIPPtools/bin/cube2mseed</code> with the following 
parameters: <code>GIPPtools/bin/cube2mseed --verbose --output-dir=./mseed_raw/ ./input_dir/</code>
without further adjustments, except for the fringe sample option, as 
specified in <code>aux_organisecubefiles</code>. Please also see the documentation 
of the cube2mseed program from the gipptools for further information.
</p>
<p>Alternatively, increasing the heap space of the Java Runtime Environment, 
required for converting the cube files, can solve the above mentioned 
issue. To increase the heap space, use the argument <code>heapspace</code>. By 
default, this argument is set to 4096.
</p>


<h3>Value</h3>

<p>A set of hourly seismic files written to disk.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

## basic example with minimum effort
aux_organisecubefiles(stationfile = "output/stationinfo.txt", 
                      input_dir = "input", 
                      gipptools = "software/gipptools-2015.225/")


## End(Not run)
                        
</code></pre>


</div>