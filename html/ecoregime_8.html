<div class="container">

<table style="width: 100%;"><tr>
<td>dist_edr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dissimilarities between Ecological Dynamic Regimes</h2>

<h3>Description</h3>

<p>Generate a matrix containing dissimilarities between one or more pairs of
Ecological Dynamic Regimes (EDR). <code>dist_edr()</code> computes different dissimilarity
indices, all of them based on the dissimilarities between the trajectories of
two EDRs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dist_edr(
  d,
  d.type,
  trajectories = NULL,
  states = NULL,
  edr,
  metric = "dDR",
  symmetrize = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Symmetric matrix or object of class <code>dist</code> containing the
dissimilarities between each pair of states of all trajectories in the EDR or
the dissimilarities between each pair of trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.type</code></td>
<td>
<p>One of <code>"dStates"</code> (if <code>d</code> contains state dissimilarities) or
<code>"dTraj"</code> (if <code>d</code> contains trajectory dissimilarities).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trajectories</code></td>
<td>
<p>Only if <code>d.type</code> = <code>"dStates"</code>. Vector indicating the
trajectory or site corresponding to each entry in <code>d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>Only if <code>d.type</code> = <code>"dStates"</code>. Vector of integers indicating the
order of the states in <code>d</code> for each trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edr</code></td>
<td>
<p>Vector indicating the EDR to which each trajectory/state in <code>d</code> belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>A string indicating the dissimilarity index to be used: <code>"dDR"</code>
(default), <code>"minDist"</code>, <code>"maxDist"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetrize</code></td>
<td>
<p>String naming the function to be called to symmetrize the
resulting dissimilarity matrix (<code>"mean"</code>, <code>"min"</code>, <code style="white-space: pre;">⁠"max⁠</code>, <code>"lower"</code>, <code>"upper"</code>).
If <code>NULL</code> (default), the matrix is not symmetrized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Only if <code>d.type</code> = <code>"dStates"</code>. Further arguments to calculate
trajectory dissimilarities. See <code>ecotraj::trajectoryDistances()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The implemented metrics are:
</p>

<dl>
<dt><code>"dDR"</code></dt>
<dd>
<p><code class="reqn">
d_{DR}(R_1, R_2) = \frac{1}{n} \sum_{i=1}^{n} d_{TR}(T_{1i}, R_2)
</code>
</p>
</dd>
<dt><code>"minDist"</code></dt>
<dd>
<p><code class="reqn">
d_{DRmin}(R_1, R_2) = \min_{i=1}^{n} \{ d_{TR}(T_{1i}, R_2) \}
</code>
</p>
</dd>
<dt><code>"maxDist"</code></dt>
<dd>
<p><code class="reqn">
d_{DRmax}(R_1, R_2) = \max_{i=1}^{n} \{ d_{TR}(T_{1i}, R_2) \}
</code>
</p>
</dd>
</dl>
<p>where <code class="reqn">R_1</code> and <code class="reqn">R_2</code> are two EDRs composed of <code class="reqn">n</code> and <code class="reqn">m</code>
ecological trajectories, respectively, and <code class="reqn">d_{TR}(T_{1i}, R_2)</code> is the
dissimilarity between the trajectory <code class="reqn">T_{1i}</code> of <code class="reqn">R_1</code> and the closest
trajectory of <code class="reqn">R_2</code>:
</p>
<p><code class="reqn">
d_{TR}(T_{1i}, R_2) = \min\{d_T(T_{1i}, T_{21}), ... , d_T(T_{1i}, T_{2m})\}
</code>
</p>
<p>The metrics calculated are not necessarily symmetric. That is, <code class="reqn">d_{DR}(R_1, R_2)</code>
is not necessarily equal to <code class="reqn">d_{DR}(R_2, R_1)</code>. It is possible to symmetrize
the returned matrix by indicating the name of the function to be used in <code>symmetrize</code>:
</p>

<dl>
<dt><code>"mean"</code></dt>
<dd>
<p><code class="reqn">
d_{DRsym} = \frac{d_{DR}(R_1, R_2) + d_{DR}(R_2, R_1)}{2}
</code>
</p>
</dd>
<dt><code>"min"</code></dt>
<dd>
<p><code class="reqn">
d_{DRsym} = \min\{d_{DR}(R_1, R_2), d_{DR}(R_2, R_1)\}
</code>
</p>
</dd>
<dt><code>"max"</code></dt>
<dd>
<p><code class="reqn">
d_{DRsym} = \max\{d_{DR}(R_1, R_2), d_{DR}(R_2, R_1)\}
</code>
</p>
</dd>
<dt><code>"lower"</code></dt>
<dd>
<p>The lower triangular part of the dissimilarity matrix is used.
</p>
</dd>
<dt><code>"upper"</code></dt>
<dd>
<p>The upper triangular part of the dissimilarity matrix is used.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>Matrix including the dissimilarities between every pair of EDRs.
</p>


<h3>Author(s)</h3>

<p>Martina Sánchez-Pinillos
</p>


<h3>References</h3>

<p>Sánchez-Pinillos, M., Kéfi, S., De Cáceres, M., Dakos, V. 2023. Ecological Dynamic
Regimes: Identification, characterization, and comparison. <em>Ecological Monographs</em>.
<a href="doi:10.1002/ecm.1589">doi:10.1002/ecm.1589</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load species abundances and compile in a data frame
abun1 &lt;- EDR_data$EDR1$abundance
abun2 &lt;- EDR_data$EDR2$abundance
abun3 &lt;- EDR_data$EDR3$abundance
abun &lt;- data.frame(rbind(abun1, abun2, abun3))

# Define row names in abun to keep the reference of the EDR, trajectory, and
# state
row.names(abun) &lt;- paste0(abun$EDR, "_", abun$traj, "_", abun$state)

# Calculate dissimilarities between every pair of states
# For example, Bray-Curtis index
dStates &lt;- vegan::vegdist(abun[, -c(1, 2, 3)], method = "bray")

# Use the labels in dStates to define the trajectories to which each state
# belongs
id_traj &lt;- vapply(strsplit(labels(dStates), "_"), function(x){
                    paste0(x[1], "_", x[2])
                }, character(1))
id_state &lt;- vapply(strsplit(labels(dStates), "_"), function(x){
                    as.integer(x[3])
                }, integer(1))
id_edr &lt;- vapply(strsplit(labels(dStates), "_"), function(x){
                    paste0("EDR", x[1])
                }, character(1))

# Calculate dissimilarities between every pair of trajectories
dTraj &lt;- ecotraj::trajectoryDistances(d = dStates, sites = id_traj,
                                      surveys = id_state,
                                      distance.type = "DSPD")

# Use labels in dTraj to identify EDRs
id_edr_traj &lt;- vapply(strsplit(labels(dTraj), "_"), function(x){
                    paste0("EDR", x[1])
                }, character(1))

# Compute dissimilarities between EDRs:
# 1) without symmetrizing the matrix and using state dissimilarities
dEDR &lt;- dist_edr(d = dStates, d.type = "dStates",
                 trajectories = id_traj, states = id_state, edr = id_edr,
                 metric = "dDR", symmetrize = NULL)

# 2) symmetrizing by averaging elements on and below the diagonal and using
# trajectory dissimilarities
dEDR &lt;- dist_edr(d = dTraj, d.type = "dTraj", edr = id_edr_traj,
                 metric = "dDR", symmetrize = "mean")


</code></pre>


</div>