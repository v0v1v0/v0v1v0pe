<div class="container">

<table style="width: 100%;"><tr>
<td>cresiduals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Conditional Residuals from Multivariate Linear Model Fits</h2>

<h3>Description</h3>

<p>Residuals from full conditionals of a Multivariate 
Linear Model (<code>mlm</code>) object. The full conditional for each response is a
linear model with all other responses used as predictors in addition to the
regressors specified in the formula of the <code>mlm</code> object. This is used to 
diagnose the multivariate normality assumption in <code>plotenvelope</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cresiduals(object, standardize = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a <code>mlm</code> object, typically the result of calling <code>lm</code> with a matrix response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>logical defaults to <code>TRUE</code>, to return studentized residuals
using <code>rstandard</code> so they are comparable across responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>residuals.lm</code> or <code>rstandard</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <code>residuals</code> function for <code>mlm</code> objects, which returns residuals from a full 
conditional model, that is, a linear model of each response against all responses
as well as predictors, which can be used to diagnose the multivariate normality assumption.
These can be standardized (<code>standardize=TRUE</code>) to facilitate overlay plots of multiple
responses, as in <code>plotenvelope</code>.
</p>


<h3>Value</h3>

<p>A matrix of residuals
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code>cpredict</code>, <code>lm</code>, <code>plotenvelope</code>, <code>residuals</code>, <code>rstandard</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(iris)
# fit a mlm:
iris.mlm=lm(cbind(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width)~Species,data=iris)
# construct full conditional residuals:
cresiduals(iris.mlm)

</code></pre>


</div>