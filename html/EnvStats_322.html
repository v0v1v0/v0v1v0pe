<div class="container">

<table style="width: 100%;"><tr>
<td>kendallSeasonalTrendTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric Test for Monotonic Trend Within Each Season Based on Kendall's Tau Statistic
</h2>

<h3>Description</h3>

<p>Perform a nonparametric test for a monotonic trend within each season based on Kendall's tau
statistic, and optionally compute a confidence interval for the slope across all seasons.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kendallSeasonalTrendTest(y, ...)

## S3 method for class 'formula'
kendallSeasonalTrendTest(y, data = NULL, subset,
  na.action = na.pass, ...)

## Default S3 method:
kendallSeasonalTrendTest(y, season, year,
  alternative = "two.sided", correct = TRUE, ci.slope = TRUE, conf.level = 0.95,
  independent.obs = TRUE, data.name = NULL, season.name = NULL, year.name = NULL,
  parent.of.data = NULL, subset.expression = NULL, ...)

## S3 method for class 'data.frame'
kendallSeasonalTrendTest(y, ...)

## S3 method for class 'matrix'
kendallSeasonalTrendTest(y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>an object containing data for the trend test.  In the default method,
the argument <code>y</code> must be numeric vector of observations.
When <code>y</code> is a data frame, all columns must be numeric.
When <code>y</code> is a matrix, it must be a numeric matrix.
In the formula method, <code>y</code> must be a formula of the form
<code>y ~ season + year</code>, where <code>y</code>, <code>season</code>, and <code>year</code>
specify what variables to use for the these arguments in the call to
<code>kendallSeasonalTrendTest.default</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>),
and infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be
removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>specifies an optional data frame, list or environment (or object coercible by
<code>as.data.frame</code> to a data frame) containing the variables in the model.
If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>kendallTrendTest</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>specifies an optional vector specifying a subset of observations to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>specifies a function which indicates what should happen when the data contain <code>NA</code>s.
The default is <code>na.pass</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>season</code></td>
<td>

<p>numeric or character vector or a factor indicating the seasons in which the observations in
<code>y</code> were taken.  The length of <code>season</code> must equal the length of <code>y</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>

<p>numeric vector indicating the years in which the observations in <code>y</code> were taken.
The length of <code>year</code> must equal the length of <code>y</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>character string indicating the kind of alternative hypothesis.  The
possible values are <code>"two.sided"</code> (tau not equal to 0; the default),
<code>"less"</code> (tau less than 0), and <code>"greater"</code> (tau greater than 0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>

<p>logical scalar indicating whether to use the correction for continuity in
computing the <code class="reqn">z</code>-statistic that is based on the test statistic <code class="reqn">S'</code>.
The default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.slope</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the
slope.  The default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric scalar between 0 and 1 indicating the confidence level associated
with the confidence interval for the slope.  The default value is
<code>0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>independent.obs</code></td>
<td>

<p>logical scalar indicating whether to assume the observations in <code>y</code> are seially independent.
The default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>

<p>character string indicating the name of the data used for the trend test.
The default value is <code>deparse(substitute(y))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>season.name</code></td>
<td>

<p>character string indicating the name of the data used for the season.
The default value is <code>deparse(substitute(season))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year.name</code></td>
<td>

<p>character string indicating the name of the data used for the year.
The default value is <code>deparse(substitute(year))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent.of.data</code></td>
<td>

<p>character string indicating the source of the data used for the trend test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset.expression</code></td>
<td>

<p>character string indicating the expression used to subset the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments affecting the test for trend.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hirsch et al. (1982) introduced a modification of Kendall's test for trend
(see <code>kendallTrendTest</code>) that allows for seasonality in observations collected over time.
They call this test the <em>seasonal Kendall test</em>.  Their test is appropriate for testing for
trend in each season when the trend is always in the same direction across all seasons.
van Belle and Hughes (1984) introduced a heterogeneity test for trend which is appropriate for testing
for trend in any direction in any season.  Hirsch and Slack (1984) proposed an extension to the seasonal
Kendall test that allows for serial dependence in the observations.  The function
<code>kendallSeasonalTrendTest</code> includes all of these tests, as well as an extension of the
van Belle-Hughes heterogeneity test to the case of serial dependence.
</p>
<p><b>Testing for Trend Assuming Serial Independence</b> <br></p>
<p><em>The Model</em> <br>
Assume observations are taken over two or more years, and assume a single year
can be divided into two or more seasons.  Let <code class="reqn">p</code> denote the number of seasons.
Let <code class="reqn">X</code> and <code class="reqn">Y</code> denote two continuous random variables with some joint
(bivariate) distribution (which may differ from season to season).  Let <code class="reqn">N_j</code>
denote the number of bivariate observations taken in the <code class="reqn">j</code>'th season (over two
or more years) (<code class="reqn">j = 1, 2, \ldots, p</code>), so that
</p>
<p style="text-align: center;"><code class="reqn">(X_{1j}, Y_{1j}), (X_{2j}, Y_{2j}), \ldots, (X_{N_jj}, Y_{N_jj})</code>
</p>

<p>denote the <code class="reqn">N_j</code> bivariate observations from this distribution for season
<code class="reqn">j</code>, assume these bivariate observations are mutually independent, and let
</p>
<p style="text-align: center;"><code class="reqn">\tau_j = \{ 2 Pr[(X_{2j} - X_{1j})(Y_{2j} - Y_{1j}) &gt; 0] \} - 1 \;\;\;\;\;\; (1)</code>
</p>

<p>denote the value of Kendall's tau for that season (see <code>kendallTrendTest</code>).
Also, assume all of the <code class="reqn">Y</code> observations are independent.
</p>
<p>The function <code>kendallSeasonalTrendTest</code> assumes that the <code class="reqn">X</code> values always
denote the year in which the observation was taken.  Note that within any season,
the <code class="reqn">X</code> values need not be unique.  That is, there may be more than one
observation within the same year within the same season.  In this case, the
argument <code>y</code> must be a numeric vector, and you must supply the additional
arguments <code>season</code> and <code>year</code>.
</p>
<p>If there is only one observation per season per year (missing values allowed), it is
usually easiest to supply the argument <code>y</code> as an <code class="reqn">n \times p</code> matrix or
data frame, where <code class="reqn">n</code> denotes the number of years. In this case
</p>
<p style="text-align: center;"><code class="reqn">N_1 = N_2 = \cdots = N_p = n \;\;\;\;\;\; (2)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">X_{ij} = i \;\;\;\;\;\; (3)</code>
</p>

<p>for <code class="reqn">i = 1, 2, \ldots, n</code> and <code class="reqn">j = 1, 2, \ldots, p</code>, so if <code class="reqn">Y</code> denotes
the <code class="reqn">n \times p</code> matrix of observed <code class="reqn">Y</code>'s and <code class="reqn">X</code> denotes the
<code class="reqn">n \times p</code> matrix of the <code class="reqn">X</code>'s, then
</p>

<table>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">Y_{11}</code> </td>
<td style="text-align: left;"> <code class="reqn">Y_{12}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">Y_{1p}</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">Y_{21}</code> </td>
<td style="text-align: left;"> <code class="reqn">Y_{22}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">Y_{2p}</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{Y} =</code> </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (4)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">Y_{n1}</code> </td>
<td style="text-align: left;"> <code class="reqn">Y_{n2}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">Y_{np}</code> </td>
<td style="text-align: left;">
  </td>
</tr>
</table>
<table>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">1</code> </td>
<td style="text-align: left;"> <code class="reqn">1</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">1</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">2</code> </td>
<td style="text-align: left;"> <code class="reqn">2</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">2</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{X} =</code> </td>
<td style="text-align: left;"> .       </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (5)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .       </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .       </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">n</code> </td>
<td style="text-align: left;"> <code class="reqn">n</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">n</code> </td>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>The null hypothesis is that within each season the <code class="reqn">X</code> and <code class="reqn">Y</code> random
variables are independent; that is, within each season there is no trend in the
<code class="reqn">Y</code> observations over time.  This null hypothesis can be expressed as:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \tau_1 = \tau_2 = \cdots = \tau_p = 0 \;\;\;\;\;\; (6)</code>
</p>

<p><br></p>
<p><em>The Seasonal Kendall Test for Trend</em> <br>
Hirsch et al.'s (1982) extension of Kendall's tau statistic to test the null
hypothesis (6) is based on simply summing together the Kendall <code class="reqn">S</code>-statistics
for each season and computing the following statistic:
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{S'}{\sqrt{Var(S')}} \;\;\;\;\;\; (7)</code>
</p>

<p>or, using the correction for continuity,
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{S' - sign(S')}{\sqrt{Var(S')}} \;\;\;\;\;\; (8)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">S' = \sum_{j=1}^p S_j \;\;\;\;\;\; (9)</code>
</p>

<p style="text-align: center;"><code class="reqn">S_j = \sum_{i=1}^{N_j-1} \sum_{k=i+1}^{N_j} sign[(X_{kj} - X_{ij})(Y_{kj} - Y_{ij})] \;\;\;\;\;\; (10)</code>
</p>

<p>and <code class="reqn">sign()</code> denotes the <code>sign</code> function:
</p>

<table>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: right;"> <code class="reqn">-1</code> </td>
<td style="text-align: left;"> <code class="reqn">x &lt; 0</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code class="reqn">sign(x) =</code> </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
<td style="text-align: left;"> <code class="reqn">x = 0 \;\;\;\;\;\; (11)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: right;"> <code class="reqn">1</code>  </td>
<td style="text-align: left;"> <code class="reqn">x &gt; 0</code>
  </td>
</tr>
</table>
<p>Note that the quantity in Equation (10) is simply the Kendall <code class="reqn">S</code>-statistic for
season <code class="reqn">j</code> (<code class="reqn">j = 1, 2, \ldots, p</code>) (see Equation (3) in the help file for
<code>kendallTrendTest</code>).
</p>
<p>For each season, if the predictor variables (the <code class="reqn">X</code>'s) are strictly increasing
(e.g., Equation (3) above), then Equation (10) simplifies to
</p>
<p style="text-align: center;"><code class="reqn">S_j = \sum_{i=1}^{N_j-1} \sum_{k=i+1}^{N_j} sign[(Y_{kj} - Y_{ij})] \;\;\;\;\;\; (12)</code>
</p>

<p>Under the null hypothesis (6), the quantity <code class="reqn">z</code> defined in Equation (7) or (8)
is approximately distributed as a standard normal random variable.
</p>
<p>Note that there may be missing values in the observations, so let <code class="reqn">n_j</code>
denote the number of <code class="reqn">(X,Y)</code> pairs without missing values for season <code class="reqn">j</code>.
</p>
<p>The statistic <code class="reqn">S'</code> in Equation (9) has mean and variance given by:
</p>
<p style="text-align: center;"><code class="reqn">E(S') = \sum_{j = 1}^p E(S_j) \;\;\;\;\;\; (13)</code>
</p>

<p style="text-align: center;"><code class="reqn">Var(S') = \sum_{j = 1}^p Var(S_j) + \sum_{g=1}^{p-1} \sum_{h=g+1}^{p} 2 Cov(S_g, S_h) \;\;\;\;\;\; (14)</code>
</p>

<p>Since all the observations are assumed to be mutually independent,
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{gh} = Cov(S_g, S_h) = 0, \;\; g \ne h, \;\; g,h = 1, 2, \ldots, p \;\;\;\;\;\; (15)</code>
</p>

<p>Furthermore, under the null hypothesis (6),
</p>
<p style="text-align: center;"><code class="reqn">E(S_j) = 0, \;\; j = 1, 2, \ldots, p \;\;\;\;\;\; (16)</code>
</p>

<p>and, in the case of no tied observations,
</p>
<p style="text-align: center;"><code class="reqn">Var(S_j) = \frac{n_j(n_j-1)(2n_j+5)}{18} \;\;\;\;\;\; (17)</code>
</p>

<p>for <code class="reqn">j=1,2, \ldots, p</code> (see equation (7) in the help file for
<code>kendallTrendTest</code>).
</p>
<p>In the case of tied observations,
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">Var(S_j) =</code> </td>
<td style="text-align: left;"> <code class="reqn">\frac{n_j(n_j-1)(2n_j+5)}{18} -</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> <code class="reqn">\frac{\sum_{i=1}^{g} t_i(t_i-1)(2t_i+5)}{18} - </code> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> <code class="reqn">\frac{\sum_{k=1}^{h} u_k(u_k-1)(2u_k+5)}{18} + </code> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> <code class="reqn">\frac{[\sum_{i=1}^{g} t_i(t_i-1)(t_i-2)][\sum_{k=1}^{h} u_k(u_k-1)(u_k-2)]}{9n_k(n_k-1)(n_k-2)} +</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                 </td>
<td style="text-align: left;"> <code class="reqn">\frac{[\sum_{i=1}^{g} t_i(t_i-1)][\sum_{k=1}^{h} u_k(u_k-1)]}{2n_k(n_k-1)} \;\;\;\;\;\; (18)</code>
  </td>
</tr>
</table>
<p>where <code class="reqn">g</code> is the number of tied groups in the <code class="reqn">X</code> observations for
season <code class="reqn">j</code>, <code class="reqn">t_i</code> is the size of the <code class="reqn">i</code>'th tied group in the <code class="reqn">X</code>
observations for season <code class="reqn">j</code>, <code class="reqn">h</code> is the number of tied groups in the <code class="reqn">Y</code>
observations for season <code class="reqn">j</code>, and <code class="reqn">u_k</code> is the size of the <code class="reqn">k</code>'th tied
group in the <code class="reqn">Y</code> observations for season <code class="reqn">j</code>
(see Equation (9) in the help file for <code>kendallTrendTest</code>).
<br></p>
<p><em>Estimating <code class="reqn">\tau</code>, Slope, and Intercept</em> <br>
The function <code>kendall.SeasonalTrendTest</code> returns estimated values of
Kendall's <code class="reqn">\tau</code>, the slope, and the intercept for each season, as well as a
single estimate for each of these three quantities combined over all seasons.
The overall estimate of <code class="reqn">\tau</code> is the weighted average of the p seasonal
<code class="reqn">\tau</code>'s:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\tau} = \frac{\sum_{j=1}^p n_j \hat{\tau}_j}{\sum_{j=1}^p n_j} \;\;\;\;\;\; (19)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\tau}_j = \frac{2S_j}{n_j(n_j-1)} \;\;\;\;\;\; (20)</code>
</p>

<p>(see Equation (2) in the help file for <code>kendallTrendTest</code>).
</p>
<p>We can compute the estimated slope for season <code class="reqn">j</code> as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{1_j} = Median(\frac{Y_{kj} - Y_{ij}}{X_{kj} - X_{ij}}); \;\; i &lt; k; \;\; X_{kj} \ne X_{ik} \;\;\;\;\;\; (21)</code>
</p>

<p>for <code class="reqn">j = 1, 2, \ldots, p</code>.  The overall estimate of slope, however, is
<b>not</b> the median of these <code class="reqn">p</code> estimates of slope; instead,
following Hirsch et al. (1982, p.117), the overall estimate of slope is the median
of all two-point slopes computed within each season:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_1 = Median(\frac{Y_{kj} - Y_{ij}}{X_{kj} - X_{ij}}); \;\; i &lt; k; \;\; X_{kj} \ne X_{ik}; \;\; j = 1, 2, \ldots, p \;\;\;\;\;\; (22)</code>
</p>

<p>(see Equation (15) in the help file for <code>kendallTrendTest</code>).
</p>
<p>The overall estimate of intercept is the median of the <code class="reqn">p</code> seasonal estimates of
intercept:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_0 = Median(\hat{\beta}_{0_1}, \hat{\beta}_{0_2}, \ldots, \hat{\beta}_{0_p}) \;\;\;\;\;\; (23)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{0_j} = Y_{0.5_j} - \hat{\beta}_{1_j} X_{0.5_j} \;\;\;\;\;\; (24)</code>
</p>

<p>and <code class="reqn">X_{0.5_j}</code> and <code class="reqn">Y_{0.5_j}</code> denote the sample medians of the <code class="reqn">X</code>'s
and <code class="reqn">Y</code>'s, respectively, for season <code class="reqn">j</code>
(see Equation (16) in the help file for <code>kendallTrendTest</code>).
<br></p>
<p><em>Confidence Interval for the Slope</em> <br>
Gilbert (1987, p.227-228) extends his method of computing a confidence interval for
the slope to the case of seasonal observations.  Let <code class="reqn">N'</code> denote the number of
defined two-point estimated slopes that are used in Equation (22) above and let
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{1_{(1)}}, \hat{\beta}_{1_{(2)}}, \ldots, \hat{\beta}_{1_{(N')}}</code>
</p>

<p>denote the <code class="reqn">N'</code> ordered slopes.  For Gilbert's (1987) method, a
<code class="reqn">100(1-\alpha)\%</code> two-sided confidence interval for the true over-all
slope across all seasons is given by:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\beta}_{1_{(M1)}}, \hat{\beta}_{1_{(M2+1)}}] \;\;\;\;\;\; (25)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">M1 = \frac{N' - C_{\alpha}}{2} \;\;\;\;\;\; (26)</code>
</p>

<p style="text-align: center;"><code class="reqn">M2 = \frac{N' + C_{\alpha}}{2} \;\;\;\;\;\; (27)</code>
</p>

<p style="text-align: center;"><code class="reqn">C_\alpha = z_{1 - \alpha/2} \sqrt{Var(S')} \;\;\;\;\;\; (28)</code>
</p>

<p><code class="reqn">Var(S')</code> is defined in Equation (14), and
<code class="reqn">z_p</code> denotes the <code class="reqn">p</code>'th quantile of the standard normal distribution.
One-sided confidence intervals may computed in a similar fashion.
</p>
<p>Usually the quantities <code class="reqn">M1</code> and <code class="reqn">M2</code> will not be integers.
Gilbert (1987, p.219) suggests interpolating between adjacent values in this case,
which is what the function <code>kendallSeasonalTrendTest</code> does.
<br></p>
<p><em>The Van Belle-Hughes Heterogeneity Test for Trend</em> <br>
The seasonal Kendall test described above is appropriate for testing the null
hypothesis (6) against the alternative hypothesis of a trend in at least one season.
All of the trends in each season should be in the same direction.
</p>
<p>The seasonal Kendall test is not appropriate for testing for trend when there are
trends in a positive direction in one or more seasons and also negative trends in
one or more seasons.  For example, for the following set of observations, the
seasonal Kendall statistic <code class="reqn">S'</code> is 0 with an associated two-sided p-value of 1,
even though there is clearly a positive trend in season 1 and a negative trend in
season 2.
</p>

<table>
<tr>
<td style="text-align: center;">
    <b>Year</b> </td>
<td style="text-align: center;"> <b>Season 1</b> </td>
<td style="text-align: center;"> <b>Season 2</b> </td>
</tr>
<tr>
<td style="text-align: center;">
    1           </td>
<td style="text-align: center;"> 5               </td>
<td style="text-align: center;"> 8 </td>
</tr>
<tr>
<td style="text-align: center;">
    2           </td>
<td style="text-align: center;"> 6               </td>
<td style="text-align: center;"> 7 </td>
</tr>
<tr>
<td style="text-align: center;">
    3           </td>
<td style="text-align: center;"> 7               </td>
<td style="text-align: center;"> 6 </td>
</tr>
<tr>
<td style="text-align: center;">
    4           </td>
<td style="text-align: center;"> 8               </td>
<td style="text-align: center;"> 5
  </td>
</tr>
</table>
<p>Van Belle and Hughes (1984) suggest using the following statistic to test for
heterogeneity in trend prior to applying the seasonal Kendall test:
</p>
<p style="text-align: center;"><code class="reqn">\chi_{het}^2 = \sum_{j=1}^p Z_j^2 - p \bar{Z}^2 \;\;\;\;\;\; (29)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">Z_j = \frac{S_j}{Var(S_j)} \;\;\;\;\;\; (30)</code>
</p>

<p style="text-align: center;"><code class="reqn">\bar{Z} = \frac{1}{p} \sum_{j=1}^p Z_j \;\;\;\;\;\; (31)</code>
</p>

<p>Under the null hypothesis (6), the statistic defined in Equation (29) is
approximately distributed as a chi-square random variable with
<code class="reqn">p-1</code> degrees of freedom.  Note that the continuity correction is not used to
compute the <code class="reqn">Z_j</code>'s defined in Equation (30) since using it results in an
unacceptably conservative test (van Belle and Hughes, 1984, p.132).  Van Belle and
Hughes (1984) actually call the statistic in (29) a homogeneous chi-square statistic.
Here it is called a heterogeneous chi-square statistic after the alternative
hypothesis it is meant to test.
</p>
<p>Van Belle and Hughes (1984) imply that the heterogeneity statistic defined in
Equation (29) may be used to test the null hypothesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \tau_1 = \tau_2 = \cdots = \tau_p = \tau \;\;\;\;\;\; (32)</code>
</p>

<p>where <code class="reqn">\tau</code> is some arbitrary number between -1 and 1.  For this case, however,
the distribution of the test statistic in Equation (29) is unknown since it depends
on the unknown value of <code class="reqn">\tau</code> (Equations (16)-(18) above assume
<code class="reqn">\tau = 0</code> and are not correct if <code class="reqn">\tau \ne 0</code>). The heterogeneity
chi-square statistic of Equation (29) may be assumed to be approximately
distributed as chi-square with <code class="reqn">p-1</code> degrees of freedom under the null
hypothesis (32), but further study is needed to determine how well this
approximation works.
<br></p>
<p><b>Testing for Trend Assuming Serial Dependence</b> <br></p>
<p><em>The Model</em> <br>
Assume the same model as for the case of serial independence, except now the
observed <code class="reqn">Y</code>'s are not assumed to be independent of one another, but are
allowed to be serially correlated over time.  Furthermore, assume one observation
per season per year (Equations (2)-(5) above).
<br></p>
<p><em>The Seasonal Kendall Test for Trend Modified for Serial Dependence</em> <br>
Hirsch and Slack (1984) introduced a modification of the seasonal Kendall test that
is robust against serial dependence (in terms of Type I error) except when the
observations have a very strong long-term persistence (very large autocorrelation) or
when the sample sizes are small (e.g., 5 years of monthly data).  This modification
is based on a multivariate test introduced by Dietz and Killeen (1981).
</p>
<p>In the case of serial dependence, Equation (15) is no longer true, so an estimate of
the correct value of <code class="reqn">\sigma_{gh}</code> must be used to compute Var(S') in
Equation (14).  Let <code class="reqn">R</code> denote the <code class="reqn">n \times p</code> matrix of ranks for the
<code class="reqn">Y</code> observations (Equation (4) above), where the <code class="reqn">Y</code>'s are ranked within
season:
</p>

<table>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">R_{11}</code> </td>
<td style="text-align: left;"> <code class="reqn">R_{12}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">R_{1p}</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">R_{21}</code> </td>
<td style="text-align: left;"> <code class="reqn">R_{22}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">R_{2p}</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{R} =</code> </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (33)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">R_{n1}</code> </td>
<td style="text-align: left;"> <code class="reqn">R_{n2}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">R_{np}</code> </td>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>where
</p>
<p style="text-align: center;"><code class="reqn">R_{ij} = \frac{1}{2} [n_j + 1 \sum_{k=1}^{n_j} sign(Y_{ij} - Y_{kj})] \;\;\;\;\;\; (34)</code>
</p>

<p>the <code class="reqn">sign</code> function is defined in Equation (11) above, and as before <code class="reqn">n_j</code> denotes
the number of <code class="reqn">(X,Y)</code> pairs without missing values for season <code class="reqn">j</code>.  Note that
by this definition, missing values are assigned the mid-rank of the non-missing
values.
</p>
<p>Hirsch and Slack (1984) suggest using the following formula, given by Dietz and
Killeen (1981), in the case where there are no missing values:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{gh} = \frac{1}{3} [K_{gh} + 4 \sum_{i=1}^n R_{ig}R_{ih} - n(n+1)^2] \;\;\;\;\;\; (35)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">K_{gh} = \sum_{i=1}^{n-1} \sum_{j=i+1}^n sign[(Y_{jg} - Y_{ig})(Y_{jh} - Y_{ih})] \;\;\;\;\;\; (36)</code>
</p>

<p>Note that the quantity defined in Equation (36) is Kendall's tau for season <code class="reqn">g</code>
vs. season <code class="reqn">h</code>.
</p>
<p>For the case of missing values, Hirsch and Slack (1984) derive the following
modification of Equation (35):
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{gh} = \frac{1}{3} [K_{gh} + 4 \sum_{i=1}^n R_{ig}R_{ih} - n(n_g + 1)(n_h + 1)] \;\;\;\;\;\; (37)</code>
</p>

<p>Technically, the estimates in Equations (35) and (37) are not correct estimators of
covariance, and Equations (17) and (18) are not correct estimators of variance,
because the model Dietz and Killeen (1981) use assumes that observations within the
rows of <code class="reqn">Y</code> (Equation (4) above) may be correlated, but observations between
rows are independent.  Serial dependence induces correlation between all of the
<code class="reqn">Y</code>'s.  In most cases, however, the serial dependence shows an exponential decay
in correlation across time and so these estimates work fairly well (see more
discussion in the BACKGROUND section below).
<br></p>
<p><em>Estimates and Confidence Intervals</em> <br>
The seasonal and over-all estimates of <code class="reqn">\tau</code>, slope, and intercept are computed
using the same methods as in the case of serial independence.  Also, the method for
computing the confidence interval for the slope is the same as in the case of serial
independence.  Note that the serial dependence is accounted for in the term
<code class="reqn">Var(S')</code> in Equation (28).
<br></p>
<p><em>The Van Belle-Hughes Heterogeneity Test for Trend Modified for Serial Dependence</em> <br>
Like its counterpart in the case of serial independence, the seasonal Kendall test
modified for serial dependence described above is appropriate for testing the null
hypothesis (6) against the alternative hypothesis of a trend in at least one season.
All of the trends in each season should be in the same direction.
</p>
<p>The modified seasonal Kendall test is not appropriate for testing for trend when
there are trends in a positive direction in one or more seasons and also negative
trends in one or more seasons.  This section describes a modification of the
van Belle-Hughes heterogeneity test for trend in the presence of serial dependence.
</p>
<p>Let <code class="reqn">\underline{S}</code> denote the <code class="reqn">p \times 1</code> vector of Kendall <code class="reqn">S</code>-statistics for
each season:
</p>

<table>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">S_1</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">S_2</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{S} =</code> </td>
<td style="text-align: left;"> .         </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (38)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">S_p</code> </td>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>The distribution of <code class="reqn">\underline{S}</code> is approximately multivariate normal with
</p>

<table>
<tr>
<td style="text-align: left;">
                                             </td>
<td style="text-align: left;"> <code class="reqn">\mu_1</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                             </td>
<td style="text-align: left;"> <code class="reqn">\mu_2</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">E(\underline{S}) = \underline{\mu} =</code> </td>
<td style="text-align: left;"> .           </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (39)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                             </td>
<td style="text-align: left;"> .           </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                             </td>
<td style="text-align: left;"> .           </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                             </td>
<td style="text-align: left;"> <code class="reqn">\mu_p</code>
  </td>
</tr>
</table>
<table>
<tr>
<td style="text-align: left;">
                                      </td>
<td style="text-align: left;"> <code class="reqn">\sigma_1^2</code>  </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{12}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{1p}</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                      </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{21}</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_2^2</code>  </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{2p}</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">Var(\underline{S}) = \Sigma =</code> </td>
<td style="text-align: left;"> .                 </td>
<td style="text-align: left;">                   </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">                   </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (40)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                      </td>
<td style="text-align: left;"> .                 </td>
<td style="text-align: left;">                   </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">                   </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                      </td>
<td style="text-align: left;"> .                 </td>
<td style="text-align: left;">                   </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">                   </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                      </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{n1}</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{n2}</code> </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_n^2</code>  </td>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>where
</p>
<p style="text-align: center;"><code class="reqn">\mu_j = \frac{n_j(n_j - 1)}{2} \tau_j, \;\; j = 1, 2, \ldots, p \;\;\;\;\;\; (41)</code>
</p>

<p>Define the <code class="reqn">p \times p</code> matrix <code class="reqn">\underline{m}</code> as
</p>

<table>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">\frac{2}{n_1(n_1 - 1)}</code> </td>
<td style="text-align: left;"> <code class="reqn">0</code>                       </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">0</code>                      </td>
<td style="text-align: left;"> <code class="reqn">\frac{2}{n_2(n_2 - 1)}</code>  </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{m} =</code> </td>
<td style="text-align: left;"> .                            </td>
<td style="text-align: left;">                               </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (42)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .                            </td>
<td style="text-align: left;">                               </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> .                            </td>
<td style="text-align: left;">                               </td>
<td style="text-align: left;">              </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: left;"> <code class="reqn">0</code>                      </td>
<td style="text-align: left;"> <code class="reqn">0</code>                       </td>
<td style="text-align: left;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: left;"> <code class="reqn">\frac{2}{n_p(n_p - 1)}</code>
  </td>
</tr>
</table>
<p>Then the vector of the seasonal estimates of <code class="reqn">\tau</code> can be written as:
</p>

<table>
<tr>
<td style="text-align: left;">
                                 </td>
<td style="text-align: left;"> <code class="reqn">\hat{\tau}_1</code> </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> <code class="reqn">2S_1/[n_1(n_1-1)]</code> </td>
<td style="text-align: left;">                                     </td>
</tr>
<tr>
<td style="text-align: left;">
                                 </td>
<td style="text-align: left;"> <code class="reqn">\hat{\tau}_2</code> </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> <code class="reqn">2S_2/[n_2(n_2-1)]</code> </td>
<td style="text-align: left;">                                     </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{\hat{\tau}} =</code> </td>
<td style="text-align: left;"> .                  </td>
<td style="text-align: left;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> .                       </td>
<td style="text-align: left;"> <code class="reqn">= \underline{m} \; \underline{S} \;\;\;\;\; (43)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                 </td>
<td style="text-align: left;"> .                  </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> .                       </td>
<td style="text-align: left;">                                     </td>
</tr>
<tr>
<td style="text-align: left;">
                                 </td>
<td style="text-align: left;"> .                  </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> .                       </td>
<td style="text-align: left;">                                     </td>
</tr>
<tr>
<td style="text-align: left;">
                                 </td>
<td style="text-align: left;"> <code class="reqn">\hat{\tau}_p</code> </td>
<td style="text-align: left;">         </td>
<td style="text-align: left;"> <code class="reqn">2S_p/[n_p(n_p-1)]</code> </td>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>so the distribution of the vector in Equation (43) is approximately multivariate
normal with
</p>

<table>
<tr>
<td style="text-align: left;">
                                    </td>
<td style="text-align: left;">                                        </td>
<td style="text-align: left;">                                       </td>
<td style="text-align: left;">                          </td>
<td style="text-align: left;"> <code class="reqn">\tau_1</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                    </td>
<td style="text-align: left;">                                        </td>
<td style="text-align: left;">                                       </td>
<td style="text-align: left;">                          </td>
<td style="text-align: left;"> <code class="reqn">\tau_2</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">E(\underline{\hat{\tau}}) =</code> </td>
<td style="text-align: left;"> <code class="reqn">E(\underline{m} \underline{S}) =</code> </td>
<td style="text-align: left;"> <code class="reqn">\underline{m} \underline{\mu} =</code> </td>
<td style="text-align: left;"> <code class="reqn">\underline{\tau} =</code> </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;"> <code class="reqn">\;\;\;\;\;\; (44)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                                    </td>
<td style="text-align: left;">                                        </td>
<td style="text-align: left;">                                       </td>
<td style="text-align: left;">                          </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                    </td>
<td style="text-align: left;">                                        </td>
<td style="text-align: left;">                                       </td>
<td style="text-align: left;">                          </td>
<td style="text-align: left;"> .            </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
                                    </td>
<td style="text-align: left;">                                        </td>
<td style="text-align: left;">                                       </td>
<td style="text-align: left;">                          </td>
<td style="text-align: left;"> <code class="reqn">\tau_p</code>
  </td>
</tr>
</table>
<p style="text-align: center;"><code class="reqn">Var(\underline{\hat{\tau}}) = Var(\underline{m} \; \underline{S}) = \underline{m} \Sigma \underline{m}^T = \Sigma_{\hat{\tau}} \;\;\;\;\;\; (45)</code>
</p>

<p>where <code class="reqn">^T</code> denotes the transpose operator.
Let <code class="reqn">\underline{C}</code> denote the <code class="reqn">(p-1) \times p</code> contrast matrix
</p>
<p style="text-align: center;"><code class="reqn">\underline{C} = [\; \underline{1} \; | \; -I_p] \;\;\;\;\;\; (46)</code>
</p>

<p>where <code class="reqn">I_p</code> denotes the <code class="reqn">p \times p</code> identity matrix.  That is,
</p>

<table>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: right;"> <code class="reqn">1</code> </td>
<td style="text-align: right;"> <code class="reqn">-1</code> </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
<td style="text-align: right;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: right;"> <code class="reqn">1</code> </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
<td style="text-align: right;"> <code class="reqn">-1</code> </td>
<td style="text-align: right;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">\underline{C} =</code> </td>
<td style="text-align: right;"> .       </td>
<td style="text-align: right;">          </td>
<td style="text-align: right;">          </td>
<td style="text-align: right;">              </td>
<td style="text-align: right;"> .        </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: right;"> .       </td>
<td style="text-align: right;">          </td>
<td style="text-align: right;">          </td>
<td style="text-align: right;">              </td>
<td style="text-align: right;"> .        </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: right;"> .       </td>
<td style="text-align: right;">          </td>
<td style="text-align: right;">          </td>
<td style="text-align: right;">              </td>
<td style="text-align: right;"> .        </td>
</tr>
<tr>
<td style="text-align: left;">
                        </td>
<td style="text-align: right;"> <code class="reqn">1</code> </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
<td style="text-align: right;"> <code class="reqn">0</code>  </td>
<td style="text-align: right;"> <code class="reqn">\cdots</code> </td>
<td style="text-align: right;"> <code class="reqn">-1</code>
  </td>
</tr>
</table>
<p>Then the null hypothesis (32) is equivalent to the null hypothesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \underline{C} \underline{\tau} = 0 \;\;\;\;\;\; (47)</code>
</p>

<p>Based on theory for samples from a multivariate normal distribution
(Johnson and Wichern, 2007), under the null hypothesis (47) the quantity
</p>
<p style="text-align: center;"><code class="reqn">\chi_{het}^2 = (\underline{C} \; \underline{\hat{\tau}})^T (\underline{C} \hat{\Sigma}_{\hat{\tau}} \underline{C}^T)^{-1} (\underline{C} \; \underline{\hat{\tau}}) \;\;\;\;\;\; (48)</code>
</p>

<p>has approximately a chi-square distribution with <code class="reqn">p-1</code> degrees of freedom for
“large” values of seasonal sample sizes, where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Sigma}_{\hat{\tau}} = \underline{m} \hat{\Sigma} \underline{m}^T \;\;\;\;\;\; (49)</code>
</p>

<p>The estimate of <code class="reqn">\Sigma</code> in Equation (49) can be computed using the same formulas
that are used for the modified seasonal Kendall test (i.e., Equation (35) or (37)
for the off-diagonal elements and Equation (17) or (18) for the diagonal elements).
As previously noted, the formulas for the variances are actually only valid if
<code class="reqn">t = 0</code> and there is no correlation between the rows of <code class="reqn">Y</code>.  The same is
true of the formulas for the covariances.  More work is needed to determine the
goodness of the chi-square approximation for the test statistic in (48).  The
pseudo-heterogeneity test statistic of Equation (48), however, should provide some
guidance as to whether the null hypothesis (32) (or equivalently (47)) appears to be
true.
</p>


<h3>Value</h3>

<p>A list of class <code>"htest"</code> containing the results of the hypothesis
test.  See the help file for <code>htest.object</code> for details.
In addition, the following components are part of the list returned by <br><code>kendallSeasonalTrendTest</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>seasonal.S</code></td>
<td>
<p>numeric vector.  The value of the Kendall S-statistic for each season.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.seasonal.S</code></td>
<td>
<p>numeric vector.  The variance of the Kendall S-statistic for each season.
This component only appears when <code>independent.obs=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cov.seasonal.S</code></td>
<td>
<p>numeric matrix.  The estimated variance-covariance matrix of the Kendall
S-statistics for each season. This component only appears when <br><code>independent.obs=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seasonal.estimates</code></td>
<td>
<p>numeric matrix.  The estimated Kendall's tau, slope, and intercept for
each season.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Kendall's test for independence or trend is a nonparametric test.  No assumptions are made about the
distribution of the <code class="reqn">X</code> and <code class="reqn">Y</code> variables.  Hirsch et al. (1982) introduced the seasonal
Kendall test to test for trend within each season.  They note that Kendall's test for trend is easy to
compute, even in the presence of missing values, and can also be used with censored values.
</p>
<p>van Belle and Hughes (1984) note that the seasonal Kendall test introduced by Hirsch et al. (1982) is
similar to a multivariate extension of the sign test proposed by Jonckheere (1954).  Jonckheeere's test
statistic is based on the unweighted sum of the seasonal tau statistics, while Hirsch et al.'s test is
based on the weighted sum (weighted by number of observations within a season) of the seasonal tau
statistics.
</p>
<p>van Belle and Hughes (1984) also note that Kendall's test for trend is slightly less powerful than the test
based on Spearman's rho, but it converges to normality faster.  Also, Bradley (1968, p.288) shows that for
the case of a linear model with normal (Gaussian) errors, the asymptotic relative efficiency of
Kendall's test for trend versus the parametric test for a zero slope is 0.98.
</p>
<p>Based on the work of Dietz and Killeen (1981), Hirsch and Slack (1984) describe a modified version of the
seasonal Kendall test that allows for serial dependence in the observations.  They performed a Monte Carlo
study to determine the empirical significance level and power of this modified test vs. the test that
assumes independent observations and found a trade-off between power and the correct significance level.
For <code class="reqn">p = 12</code> seasons, they found the modified test gave correct significance levels for <code class="reqn">n \geq 10</code>
as long as the lag-one autocorrelation was 0.6 or less, while the original test that assumes independent
observations yielded highly inflated significance levels.  On the other hand, if in fact the observations
are serially independent, the original test is more powerful than the modified test.
</p>
<p>Hirsch and Slack (1984) also looked at the performance of the test for trend introduced by
Dietz and Killeen (1981), which is a weighted sums of squares of the seasonal Kendall S-statistics,
where the matrix of weights is the inverse of the covariance matrix.  The Dietz-Killeen test statistic,
unlike the one proposed by Hirsh and Slack (1984), tests for trend in either direction in any season,
and is asymptotically distributed as a chi-square random variable with <code class="reqn">p</code> (number of seasons)
degrees of freedom.  Hirsch and Slack (1984), however, found that the test based on this statistic is
quite conservative (i.e., the significance level is much smaller than the assumed significance level)
and has poor power even for moderate sample sizes.  The chi-square approximation becomes reasonably
close only when <code class="reqn">n &gt; 40</code> if <code class="reqn">p = 12</code>, <code class="reqn">n &gt; 30</code> if <code class="reqn">p = 4</code>, and <code class="reqn">n &gt; 20</code> if
<code class="reqn">p = 2</code>.
</p>
<p>Lettenmaier (1988) notes the poor power of the test proposed by Dietz and Killeen (1981) and states the
poor power apparently results from an upward bias in the estimated variance of the statistic, which can
be traced to the inversion of the estimated covariance matrix.  He suggests an alternative test statistic
(to test trend in either direction in any season) that is the sum of the squares of the scaled seasonal
Kendall S-statistics (scaled by their standard deviations).  Note that this test statistic ignores
information about the covariance between the seasonal Kendall S-statistics, although its distribution
depends on these covariances.  In the case of no serial dependence, Lettenmaier's test statistic is
exactly the same as the Dietz-Killeen test statistic.  In the case of serial dependence,
Lettenmaier (1988) notes his test statistic is a quadratic form of a multivariate normal random variable
and therefore all the moments of this random variable are easily computed.  Lettenmaier (1988)
approximates the distribution of his test statistic as a scaled non-central chi-square distribution
(with fractional degrees of freedom).  Based on extensive Monte Carlo studies, Lettenmaier (1988) shows
that for the case when the trend is the same in all seasons, the seasonal Kendall's test of
Hirsch and Slack (1984) is superior to his test and far superior to the Dietz-Killeen test.
The power of Lettenmaier's test approached that of the seasonal Kendall test for large trend magnitudes.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Bradley, J.V. (1968). <em>Distribution-Free Statistical Tests</em>.
Prentice-Hall, Englewood Cliffs, NJ.
</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition.
John Wiley and Sons, New York, pp.256-272.
</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
John Wiley &amp; Sons, Hoboken.
</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
Van Nostrand Reinhold, New York, NY, Chapter 16.
</p>
<p>Helsel, D.R. and R.M. Hirsch. (1988). Discussion of Applicability of the t-test for Detecting Trends
in Water Quality Variables. <em>Water Resources Bulletin</em> <b>24</b>(1), 201-204.
</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
Elsevier, NY.
</p>
<p>Helsel, D.R., and R. M. Hirsch. (2002). <em>Statistical Methods in Water Resources</em>.
Techniques of Water Resources Investigations, Book 4, chapter A3. U.S. Geological Survey.
Available on-line at <a href="https://pubs.usgs.gov/tm/04/a03/tm4a3.pdf">https://pubs.usgs.gov/tm/04/a03/tm4a3.pdf</a>.
</p>
<p>Hirsch, R.M., J.R. Slack, and R.A. Smith. (1982). Techniques of Trend Analysis for Monthly Water Quality
Data. <em>Water Resources Research</em> <b>18</b>(1), 107-121.
</p>
<p>Hirsch, R.M. and J.R. Slack. (1984). A Nonparametric Trend Test for Seasonal Data with Serial Dependence.
<em>Water Resources Research</em> <b>20</b>(6), 727-732.
</p>
<p>Hirsch, R.M., R.B. Alexander, and R.A. Smith. (1991). Selection of Methods for the Detection and
Estimation of Trends in Water Quality. <em>Water Resources Research</em> <b>27</b>(5), 803-813.
</p>
<p>Hollander, M., and D.A. Wolfe. (1999). <em>Nonparametric Statistical Methods, Second Edition</em>.
John Wiley and Sons, New York.
</p>
<p>Johnson, R.A., and D.W. Wichern. (2007).  <em>Applied Multivariate Statistical
Analysis</em>, Sixth Edition.  Pearson Prentice Hall, Upper Saddle River, NJ.
</p>
<p>Kendall, M.G. (1938). A New Measure of Rank Correlation. <em>Biometrika</em> <b>30</b>, 81-93.
</p>
<p>Kendall, M.G. (1975). <em>Rank Correlation Methods</em>. Charles Griffin, London.
</p>
<p>Mann, H.B. (1945). Nonparametric Tests Against Trend. <em>Econometrica</em> <b>13</b>, 245-259.
</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
CRC Press, Boca Raton, Florida.
</p>
<p>Sen, P.K. (1968). Estimates of the Regression Coefficient Based on Kendall's Tau.
<em>Journal of the American Statistical Association</em> <b>63</b>, 1379-1389.
</p>
<p>Theil, H. (1950). A Rank-Invariant Method of Linear and Polynomial Regression Analysis, I-III.
<em>Proc. Kon. Ned. Akad. v. Wetensch. A.</em> <b>53</b>, 386-392, 521-525, 1397-1412.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>
<p>van Belle, G., and J.P. Hughes. (1984). Nonparametric Tests for Trend in Water Quality.
<em>Water Resources Research</em> <b>20</b>(1), 127-136.
</p>


<h3>See Also</h3>

<p><code>kendallTrendTest</code>, <code>htest.object</code>, <code>cor.test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Reproduce Example 14-10 on page 14-38 of USEPA (2009).  This example
  # tests for trend in analyte concentrations (ppm) collected monthly
  # between 1983 and 1985.

  head(EPA.09.Ex.14.8.df)
  #     Month Year Unadj.Conc Adj.Conc
  #1  January 1983       1.99     2.11
  #2 February 1983       2.10     2.14
  #3    March 1983       2.12     2.10
  #4    April 1983       2.12     2.13
  #5      May 1983       2.11     2.12
  #6     June 1983       2.15     2.12

  tail(EPA.09.Ex.14.8.df)
  #       Month Year Unadj.Conc Adj.Conc
  #31      July 1985       2.31     2.23
  #32    August 1985       2.32     2.24
  #33 September 1985       2.28     2.23
  #34   October 1985       2.22     2.24
  #35  November 1985       2.19     2.25
  #36  December 1985       2.22     2.23


  # Plot the data
  #--------------
  Unadj.Conc &lt;- EPA.09.Ex.14.8.df$Unadj.Conc
  Adj.Conc   &lt;- EPA.09.Ex.14.8.df$Adj.Conc
  Month      &lt;- EPA.09.Ex.14.8.df$Month
  Year       &lt;- EPA.09.Ex.14.8.df$Year
  Time       &lt;- paste(substring(Month, 1, 3), Year - 1900, sep = "-")
  n          &lt;- length(Unadj.Conc)
  Three.Yr.Mean &lt;- mean(Unadj.Conc)

  dev.new()
  par(mar = c(7, 4, 3, 1) + 0.1, cex.lab = 1.25)
  plot(1:n, Unadj.Conc, type = "n", xaxt = "n",
	xlab = "Time (Month)",
	ylab = "ANALYTE CONCENTRATION (mg/L)",
	main = "Figure 14-15. Seasonal Time Series Over a Three Year Period",
	cex.main = 1.1)
  axis(1, at = 1:n, labels = rep("", n))
  at &lt;- rep(c(1, 5, 9), 3) + rep(c(0, 12, 24), each = 3)
  axis(1, at = at, labels = Time[at])
  points(1:n, Unadj.Conc, pch = 0, type = "o", lwd = 2)
  points(1:n, Adj.Conc, pch = 3, type = "o", col = 8, lwd = 2)
  abline(h = Three.Yr.Mean, lwd = 2)
  legend("topleft", c("Unadjusted", "Adjusted", "3-Year Mean"), bty = "n",
    pch = c(0, 3, -1), lty = c(1, 1, 1), lwd = 2, col = c(1, 8, 1),
    inset = c(0.05, 0.01))


  # Perform the seasonal Kendall trend test
  #----------------------------------------

  kendallSeasonalTrendTest(Unadj.Conc ~ Month + Year,
    data = EPA.09.Ex.14.8.df)

  #Results of Hypothesis Test
  #--------------------------
  #
  #Null Hypothesis:                 All 12 values of tau = 0
  #
  #Alternative Hypothesis:          The seasonal taus are not all equal
  #                                 (Chi-Square Heterogeneity Test)
  #                                 At least one seasonal tau != 0
  #                                 and all non-zero tau's have the
  #                                 same sign (z Trend Test)
  #
  #Test Name:                       Seasonal Kendall Test for Trend
  #                                 (with continuity correction)
  #
  #Estimated Parameter(s):          tau       =    0.9722222
  #                                 slope     =    0.0600000
  #                                 intercept = -131.7350000
  #
  #Estimation Method:               tau:        Weighted Average of
  #                                             Seasonal Estimates
  #                                 slope:      Hirsch et al.'s
  #                                             Modification of
  #                                             Thiel/Sen Estimator
  #                                 intercept:  Median of
  #                                             Seasonal Estimates
  #
  #Data:                            y      = Unadj.Conc
  #                                 season = Month
  #                                 year   = Year
  #
  #Data Source:                     EPA.09.Ex.14.8.df
  #
  #Sample Sizes:                    January   =  3
  #                                 February  =  3
  #                                 March     =  3
  #                                 April     =  3
  #                                 May       =  3
  #                                 June      =  3
  #                                 July      =  3
  #                                 August    =  3
  #                                 September =  3
  #                                 October   =  3
  #                                 November  =  3
  #                                 December  =  3
  #                                 Total     = 36
  #
  #Test Statistics:                 Chi-Square (Het) = 0.1071882
  #                                 z (Trend)        = 5.1849514
  #
  #Test Statistic Parameter:        df = 11
  #
  #P-values:                        Chi-Square (Het) = 1.000000e+00
  #                                 z (Trend)        = 2.160712e-07
  #
  #Confidence Interval for:         slope
  #
  #Confidence Interval Method:      Gilbert's Modification of
  #                                 Theil/Sen Method
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             LCL = 0.05786914
  #                                 UCL = 0.07213086

  #==========

  # Clean up
  #---------

  rm(Unadj.Conc, Adj.Conc, Month, Year, Time, n, Three.Yr.Mean, at)
  graphics.off()
</code></pre>


</div>