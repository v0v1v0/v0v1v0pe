<div class="container">

<table style="width: 100%;"><tr>
<td>unirootGrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to find a root by grid search. 
</h2>

<h3>Description</h3>

<p>Find the root (value where the function equals 0) of a monotonic function, <code>func</code>, 
using a halving algorithm grid search. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">unirootGrid(func, power2 = 12, step.up = TRUE, pos.side = FALSE, 
    print.steps = FALSE, power2grid = power2gridRatio, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>

<p>monotonic function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power2</code></td>
<td>

<p>positive integer, number of grid points is 1+2^power2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.up</code></td>
<td>
<p> logical, 
start the search at the lower end of the grid and step up?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.side</code></td>
<td>

<p>logical, should the root be on the positive side? In other words, should func(root)&gt;=0
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.steps</code></td>
<td>

<p>logical, should each step that is evaluated be printed?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power2grid</code></td>
<td>

<p>function that returns the grid. Take one argument, <code>power2</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments passed to <code>func</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The grid is defined with the <code>power2grid</code> argument that defines a function 
with an argument <code>power2</code>, and returns a grid with <code>1+2^power2</code>
elements. The root is found by a halving algorithm on the grid, so <code>func</code>
is calculated only <code>power2+1</code> times. The ‘root’ is the element that is closest to the root, 
either on the positive side (<code>pos.side=TRUE</code>) or not.
</p>
<p>The <code>unirootGrid</code> function calls <code>uniroot.integer</code> and finds roots based on grid search. 
The functions <code>power2gridRatio</code> and <code>power2gridDifference</code>
create grids for searching (0,Inf) and (-1,1) respectively. 
The <code>power2gridRatio</code> grid is equally spaced on the log scale with about half of the grid between 0.5 and 2.
The function <code>power2grid</code> allows more flexibility in defining grids.
</p>


<h3>Value</h3>

<p>A list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.root</code></td>
<td>
<p>value of func at root</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>root, element on the grid that is closest to the root on the negative side (if pos.side=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>interval for the  accuracy</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael P. Fay
</p>


<h3>See Also</h3>

<p><code>uniroot</code> and <code>uniroot.integer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># print.steps prints all iterations, 
# with x=rank of grid value (e.g., x=1 is lowest value in grid) 
# f(x) really is f(grid[x]) where grid is from the power2grid function 
unirootGrid(function(x){ x - .37}, power2=10, power2grid=power2gridRatio, 
  print.steps=TRUE, pos.side=TRUE)
</code></pre>


</div>