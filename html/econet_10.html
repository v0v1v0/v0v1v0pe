<div class="container">

<table style="width: 100%;"><tr>
<td>horse_race</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare the explanatory power of parameter.dependent network centrality measures with those of standard measures of network centrality.</h2>

<h3>Description</h3>

<p>Compare the explanatory power of parameter.dependent network centrality measures with those of standard measures of network centrality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">horse_race(
  formula = formula(),
  centralities = c("indegree", "outdegree", "degree", "betweenness", "incloseness",
    "outcloseness", "closeness", "eigenvector"),
  directed = FALSE,
  weighted = FALSE,
  normalization = FALSE,
  data = list(),
  unobservables = list(),
  G = list(),
  model = c("model_A", "model_B"),
  estimation = c("NLLS", "MLE"),
  endogeneity = FALSE,
  first_step = NULL,
  exclusion_restriction = NULL,
  start.val = NULL,
  to_weight = NULL,
  time_fixed_effect = NULL,
  ind_fixed_effect = NULL,
  mle_controls = NULL,
  kappa = NULL,
  delta = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code>: a symbolic description of the model to be fitted. The constant (i.e. intercept) and the autogressive parameter needs not to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centralities</code></td>
<td>
<p>at least one of <code>c("indegree","outdegree","degree", "betweenness", "incloseness", "outcloseness", "closeness", "eigenvector")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directed</code></td>
<td>
<p>logical. <code>TRUE</code> if the social network is directed, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>logical. <code>TRUE</code> if the social network is weighted, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization</code></td>
<td>
<p>Default is NULL. Alternatively, it can be set to <code>c("bygraph","bycomponent","bymaxcomponent","bymaxgraph")</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class <code>data.frame</code> containing the variables in the model. If data are longitudinal, observations must be ordered by time period and then by individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unobservables</code></td>
<td>
<p>a numeric vector used to obtain an unbiased estimate of the parameter.dependent centrality when the network is endogenous. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>an object of class <code>Matrix</code> representing the social network. Row and column names must be specified and match the order of the observations in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>string. One of <code>c("model_A","model_B")</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>
<p>string. One of <code>c("NLLS","MLE")</code>. They are used to implement respectively a non-linear least square and a maximum likelihood estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endogeneity</code></td>
<td>
<p>logical. Default is <code>FALSE</code>. If <code>TRUE</code>, <code>net_dep</code> implements a two-step correction procedure to control for the endogeneity of the network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first_step</code></td>
<td>
<p>Default is NULL. If <code>endogeneity = TRUE</code>, it requires to specify one of <code>c("standard","fe", "shortest", "coauthors", "degree")</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclusion_restriction</code></td>
<td>
<p>an object of class <code>Matrix</code> representing the exogenous matrix used to instrument the endogenous social network, if <code>unobservables</code> is non-<code>NULL</code>.  Row and column names must be specified and match the order of the observations in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.val</code></td>
<td>
<p>an optional list containing the starting values for the estimations. Object names must match the names provided in <code>formula</code>. It is also required to specify the value of both the constant and the decay parameter(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to_weight</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process to indicate that different observations have different variances. Should be <code>NULL</code> or a numeric vector. If non-<code>NULL</code>, weighted non-linear least squares (if <code>estimation = "NLLS"</code>) or weighted maximum likelihood  (if <code>estimation = "MLE"</code>) is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_fixed_effect</code></td>
<td>
<p>an optional string. It indicates the name of the time index used in formula. It is used for models with longitudinal data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_fixed_effect</code></td>
<td>
<p>an optional string. Default is <code>NULL</code>. It indicates the name of the individual index contained in the data. If provided, individual fixed effects are automatically added to the <code>formula</code> of the main equation. If <code>endogeneity = TRUE</code>, the field <code>first_step</code> is overridden, and automatically set equal to <code>"fe"</code>. It is used for models with longitudinal data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle_controls</code></td>
<td>
<p>a list allowing the user to set upper and lower bounds for control variables in MLE estimation and the variance for the ML estimator. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>a normalization level with default equals 1 used in MLE estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Default is <code>NULL</code>. To be used when <code>estimation = "NLLS"</code>. It has to be a number between zero (included) and one (excluded). When used, <code>econet</code> performs a constrained NLLS estimation. In this case, the estimated peer effect parameter, taken in absolute value, is forced to be higher than zero and lower than the spectral radius of <code>G</code>. Specifically, <code>delta</code> is a penalizing factor, decreasing the goodness of fit of the NLLS estimation, when the peer effect parameter approaches one of the two bounds. Observe that very high values of <code>delta</code> may cause NLLS estimation not to converge.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A number of different normalization are available to the user:
</p>

<ul>
<li> <p><code>bygraph</code> and <code>bycomponent</code> are used to divide <em>degree</em> and <em>closeness</em> centrality by <code class="reqn">n - 1</code>, and <em>betweenness</em> centrality by <code class="reqn">(n - 1) * (n - 2)</code> if <code>directed = TRUE</code>, or by <code class="reqn">(n - 1)*(n - 2)/2</code> if <code>directed = FALSE</code>. In the former case (i.e. <code>bygraph</code>), <em>n</em> is equal to the number of nodes in the network In the latter case (i.e. <code>bycomponent</code>), <em>n</em> is equal to the number of nodes of the component in which the node is embedded.
</p>
</li>
<li> <p><code>bymaxgraph</code> and <code>bymaxcomponent</code> are used to divide <em>degree</em>, <em>betweenness</em> and <em>closeness</em> centrality by the maximum value of the centrality of the network (<code>bymaxgraph</code>) or component (<code>bymaxcomponent</code>) in which the node is embedded.
</p>
</li>
</ul>
<p>If the network is endogenous, the user is required to run separately <code>net_dep</code> and extract from the resulting object the vector of unobservables necessary for obtaining an unbiased estimate of the parameter.dependent centrality. This vector can be passed through the argument <code>unobservables</code>.<br>
If <code>endogeneity = TRUE</code>, a two-step estimation is implemented to control for network endogeneity. The argument <code>first_step</code> is used to control for the specification of the first-step model, e.g.:
</p>

<ul>
<li> <p><code>first_step = "standard"</code> is used when agents' connection are predicted by the differences in their characteristics (i.e. those on the right hand side of <code>formula</code>), and an <code>exclusion_restriction</code>: i.e., their connections in a different network.
</p>
</li>
<li> <p><code>first_step = "fe"</code> adds individual fixed effects to the <code>standard</code> model, as in Graham (2017).
</p>
</li>
<li> <p><code>first_step = "shortest"</code> adds to the <code>standard</code> model, the shortest distance between <em>i</em> and <em>j</em>, excluding the link between <em>i</em> and <em>j</em> itself, as in Fafchamps et al (2010).
</p>
</li>
<li> <p><code>first_step = "coauthor"</code> adds to the <code>standard</code> model, the number of shared connections between <em>i</em> and <em>j</em>, as in Graham (2015).
</p>
</li>
<li> <p><code>first_step = "degree"</code> adds to the <code>standard</code> model, the difference in the degree centrality of <em>i</em> and <em>j</em>.
</p>
</li>
</ul>
<p>For additional details, see the vignette (doi:10.18637/jss.v102.i08).
</p>


<h3>Value</h3>

<p>A list of two objects:
</p>

<ul>
<li>
<p> A list of estimates, each one setting the decay parameter to zero, and adding one of the <code>centralities</code> to the specification of <code>formula</code>. The last object adds to <code>formula</code> all the selected <code>centralities</code> and the decay parameter is set different from zero.
</p>
</li>
<li>
<p> An object of class <code>data.frame</code> containing the computed centrality measures.
</p>
</li>
<li>
<p> A list of first-step estimations used to correct the effect of centrality measures when the network is endogenous.
</p>
</li>
</ul>
<h3>References</h3>

<p>Battaglini M., V. Leone Sciabolazza, E. Patacchini, S. Peng (2020), "Econet: An R package for the Estimation of parameter-dependent centrality measures", Mimeo. <br></p>


<h3>See Also</h3>

<p><code>net_dep</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load data
data("db_cosponsor")
data("G_alumni_111")
db_model_B &lt;- db_cosponsor
G_model_B &lt;- G_cosponsor_111
G_exclusion_restriction &lt;- G_alumni_111
are_factors &lt;- c("party", "gender", "nchair")
db_model_B[are_factors] &lt;- lapply(db_model_B[are_factors], factor)

# Specify formula
f_model_B &lt;- formula("les ~gender + party + nchair")

# Specify starting values
starting &lt;- c(alpha = 0.214094,
             beta_gender1 = -0.212706,
             beta_party1 = 0.478518,
             beta_nchair1 = 3.09234,
             beta_betweenness = 7.06287e-05,
             phi = 0.344787)

# Fit model
horse_model_B &lt;- horse_race(formula = f_model_B,
              centralities = "betweenness",
              directed = TRUE, weighted = TRUE,
              data = db_model_B, G = G_model_B,
              model = "model_B", estimation = "NLLS",
              start.val = starting)

# Store and print results
summary(horse_model_B)
summary(horse_model_B, centrality = "betweenness")
horse_model_B$centrality

# WARNING, This toy example is provided only for runtime execution.
# Please refer to previous examples for sensible calculations.
data("db_alumni_test")
data("G_model_A_test")
db_model &lt;- db_alumni_test
G_model &lt;- G_model_A_test
f_model &lt;- formula("les ~ dw")
horse_model_test &lt;- horse_race(formula = f_model, centralities = "betweenness",
                            directed = TRUE, weighted = FALSE, normalization = NULL,
                            data = db_model, unobservables = NULL, G = G_model,
                            model = "model_A", estimation = "NLLS",
                            start.val = c(alpha = -0.31055275,
                                          beta_dw = 1.50666982,
                                          beta_betweenness = 0.09666742,
                                          phi = 16.13035695))
summary(horse_model_test)
</code></pre>


</div>