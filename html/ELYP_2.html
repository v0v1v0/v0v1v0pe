<div class="container">

<table style="width: 100%;"><tr>
<td>BJfindU2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the Wilks Confidence Interval Upper Bound for Betafun from the 2 dimensional Buckley-James Empirical Likelihood Ratio Function</h2>

<h3>Description</h3>

<p>This function uses simple search to find the upper level (default 95%) 1 parameter Wilks confidence limits based on the Buckley-James empirical likelihood test function for two dimensional beta's. The confidece interval is for the 1 parameter, determined by Betafun.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BJfindU2(NPmle, ConfInt, LLRfn, Betafun, dataMat, level=3.84)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>NPmle</code></td>
<td>
<p>a 2-d vector: the NPMLEs: beta1 hat and beta2 hat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>a vector of length 2. Approx. length of the 2 conf. intervals for beta1 and beta2. May use the SD from bj(). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LLRfn</code></td>
<td>
<p>a function that returns the -2LLR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Betafun</code></td>
<td>
<p>a function that takes the input of 2 parameter values (beta1, beta2) and 
returns a parameter that we wish to find its confidence Interval Lower Value. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataMat</code></td>
<td>
<p>matrix of covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>confidence level.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Basically we repeatedly testing the value of the 2 parameters, until we find the max of Betafun, provided
the -2 log likelihood value is &lt;= 3.84 (or other level, if set differently).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Upper</code></td>
<td>
<p>the upper confidence bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxParameterNloglik</code></td>
<td>
<p>Final values of the 2 parameters, and the log likelihood.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou </p>


<h3>References</h3>

<p>Zhou, M. (2005). 
Computing censored empirical likelihood ratio 
by EM algorithm. 
<em>JCGS</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
# The Stanford Heart Transplant Data: with 152 cases.
# Needs bjtest( ) function from emplik package to run.

## BJloglik &lt;- function(para, dataMat) {
##            yvec &lt;- dataMat[,1]
##            dvec &lt;- dataMat[,2]
##            x &lt;- dataMat[,3:4]
## temp &lt;- bjtest(y=log10(yvec), d=dvec, x=x, beta=para)
## return(temp)
## }

## BJ2fun &lt;- function (b1, b2) {
##    return(b2)
## }

## We first use bj() from Design library to find NPmle and
## the conservative SD of beta1 and beta2

## BJfindU2(NPmle=c(3.52696077,-0.01989555), 
##      ConfInt=c(0.3,0.0066), LLRfn=BJloglik, 
##      Betafun=BJ2fun, 
##      dataMat=cbind(stanford5$time, stanford5$status, 
##      rep(1,152),stanford5$age))
##
# This will take (~ 1 min.) to run.
</code></pre>


</div>