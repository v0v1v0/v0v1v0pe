<div class="container">

<table style="width: 100%;"><tr>
<td>tidyst_kcde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tidy and geospatial kernel cumulative distribution and copula estimates</h2>

<h3>Description</h3>

<p>Tidy and geospatial versions of kernel cumulative distribution estimates for 1- and 2-dimensional data, and kernel copula estimates for 2-dimensional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tidy_kcde(data, ...)
tidy_kcopula(data, ...)
st_kcde(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame/tibble of data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>sf object with point geometry</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters in <code>ks::kcde</code>, <code>ks::kcopula</code> functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details of the computation of the kernel distribution and copula estimates, and of the bandwidth selector procedures, see <code>?ks::kcde</code>, <code>?ks::kcopula</code>.
</p>


<h3>Value</h3>

<p>The outputs from <code>*_kcde</code> have the same structure as the kernel density estimate from <code>*_kde</code>, except that <code>estimate</code> indicates the cumulative distribution rather than the density values. Likewise for <code>tidy_kcopula</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)
data(crabs, package="MASS")
## tidy 1-d distribution estimate per species
crabs1 &lt;- dplyr::select(crabs, FL, sp)
crabs1 &lt;- dplyr::group_by(crabs1, sp)
t1 &lt;- tidy_kcde(crabs1)
gt1 &lt;- ggplot(t1, aes(x=FL)) 
gt1 + geom_line(colour=1) + geom_rug_ks(colour=4) + facet_wrap(~sp)

## tidy 2-d copula estimate
crabs2 &lt;- dplyr::select(crabs, FL, CW)
t2 &lt;- tidy_kcopula(crabs2)
gt2 &lt;- ggplot(t2, aes(x=FL, y=CW)) 
gt2 + geom_contour_filled_ks(colour=1, cont=seq(10,90,by=10))

## geospatial distribution estimate
data(wa)
data(grevilleasf)
paradoxa &lt;- dplyr::filter(grevilleasf, species=="paradoxa")
paradoxa_crop &lt;- sf::st_crop(paradoxa, xmin=4e5, xmax=8e5, ymin=6.4e6, ymax=6.65e6)
paradoxa_bbox &lt;- sf::st_as_sfc(sf::st_bbox(paradoxa_crop))
xminb &lt;- sf::st_bbox(paradoxa_crop)[1:2]
xmaxb &lt;- sf::st_bbox(paradoxa_crop)[3:4]
s1 &lt;- st_kcde(paradoxa_crop, xmin=xminb, xmax=xmaxb)

## base R filled contour plot
xlim &lt;- c(1.2e5, 1.1e6); ylim &lt;- c(6.1e6, 7.2e6)
plot(wa, xlim=xlim, ylim=ylim)
plot(paradoxa_bbox, add=TRUE, lty=3, lwd=2)
plot(s1, add=TRUE)

## geom_sf filled contour plot
gs1 &lt;- ggplot(s1) + geom_sf(data=wa, fill=NA) + ggthemes::theme_map() 
gs1 + geom_sf(data=paradoxa_bbox, linewidth=1.2, linetype="dotted", fill=NA) +
    geom_sf(data=st_get_contour(s1), aes(fill=label_percent(contlabel))) +
    scale_fill_viridis_d() + coord_sf(xlim=xlim, ylim=ylim)
</code></pre>


</div>