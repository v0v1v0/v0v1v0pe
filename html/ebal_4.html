<div class="container">

<table style="width: 100%;"><tr>
<td>ebalance.trim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Trimming of Weights for Entropy Balancing
</h2>

<h3>Description</h3>

<p>Function to trim weights obtained from entropy balancing. It takes the output from a call to <code>ebalance</code> and trims the data weights (subject to the moment conditions) such that the 
ratio of the maximum/minimum weight to the mean weight is 
reduced to satisfy a user specified target. If no user target is specified the maximum weight ratio is automatically trimmed as far as is feasible given the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ebalance.trim(ebalanceobj, max.weight = NULL,
min.weight = 0, max.trim.iterations = 200,
max.weight.increment = 0.92,
min.weight.increment = 1.08,
print.level = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ebalanceobj</code></td>
<td>

<p>An object from a call to <code>ebalance</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.weight</code></td>
<td>

<p>Optional target for the ratio of the maximum to mean weight.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.weight</code></td>
<td>

<p>Optional target for the ratio of the minimum to mean weight.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.trim.iterations</code></td>
<td>

<p>Maximum number of trimming iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.weight.increment</code></td>
<td>

<p>Increment for iterative trimming of the ratio of the maximum to mean weight (a scalar between 0-1, .92 indicates that 
the attempted reduction in the max ratio is 8 percent). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.weight.increment</code></td>
<td>

<p>Increment for iterative trimming of the ratio of the minimum to mean weight (a scalar  &gt; 1, 1.08 indicates that 
the attempted reduction in the max ratio is 8 percent).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>

<p>Controls the level of printing: 0 (normal printing), 2 (detailed), and 3 (very detailed).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An list object of class <code>ebalance.trim</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>target.margins</code></td>
<td>
<p>A vector that contains the target moments coded from the covariate distributions of the treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co.xdata</code></td>
<td>
<p>A matrix that contains the covariate data from the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A vector that contains the control group weights assigned by trimming entropy balancing algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs </code></td>
<td>
<p>A vector that contains coefficients from the reweighting algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdiff </code></td>
<td>
<p>A scalar that contains the maximum deviation between the moments of the reweighted data and the target moments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.constant</code></td>
<td>
<p>Normalizing constant used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint.tolerance</code></td>
<td>
<p>The tolerance level used for the balance constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iterations</code></td>
<td>
<p>Maximum number of trimming iterations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.weight</code></td>
<td>
<p>The base weight used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Logical flag if algorithm converged within tolerance.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jens Hainmueller
</p>


<h3>References</h3>

<p>Hainmueller, J. (2012) 'Entropy Balancing for Causal Effects: A Multivariate Reweighting Method to Produce Balanced Samples in Observational Studies', Political Analysis (Winter 2012) 20 (1): 25–46.
</p>
<p>Zaslavsky, A. (1988), 'Representing local reweighting area adjustments by of households', Survey Methodology 14(2), 265–288.
</p>
<p>Ireland, C. and Kullback, S. (1968), 'Contingency tables with given marginals', Biometrika 55, 179–188.
</p>
<p>Kullback, S. (1959), Information Theory and Statistics, Wiley, NY.
</p>


<h3>See Also</h3>

<p>Also see <code>ebalance.trim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# create toy data: treatment indicator and three covariates X1-3
treatment   &lt;- c(rep(0,50),rep(1,30))
X           &lt;- rbind(replicate(3,rnorm(50,0)),replicate(3,rnorm(30,.5)))
colnames(X) &lt;- paste("x",1:3,sep="")

# entropy balancing
eb.out &lt;- ebalance(Treatment=treatment,
                   X=X)
# means in treatment group data
apply(X[treatment==1,],2,mean)
# means in reweighted control group data
apply(X[treatment==0,],2,weighted.mean,w=eb.out$w)
# means in raw data control group data
apply(X[treatment==0,],2,mean)

# trim weights
eb.out.tr &lt;- ebalance.trim(eb.out)
# means in reweighted control group data
apply(X[treatment==0,],2,weighted.mean,w=eb.out.tr$w)

# untrimmed and trimmed weights
round(summary(eb.out$w),2)
round(summary(eb.out.tr$w),2)

</code></pre>


</div>