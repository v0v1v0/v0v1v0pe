<div class="container">

<table style="width: 100%;"><tr>
<td>emplikH1.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical likelihood for hazard with right censored, 
left truncated data</h2>

<h3>Description</h3>

<p>Use empirical likelihood ratio and Wilks theorem to test 
the null hypothesis that 
</p>
<p style="text-align: center;"><code class="reqn">\int f(t) dH(t) = \theta </code>
</p>

<p>with right censored, left truncated data. 
Where <code class="reqn">H(t)</code> is the unknown
cumulative hazard
function; <code class="reqn">f(t)</code> can be any given 
function and
<code class="reqn">\theta</code> a given constant. In fact, <code class="reqn">f(t)</code> can even be data
dependent, just have to be ‘predictable’.
</p>


<h3>Usage</h3>

<pre><code class="language-R">emplikH1.test(x, d, y= -Inf, theta, fun, tola=.Machine$double.eps^.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of the censored survival times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a vector of the censoring indicators, 1-uncensor; 0-censor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of the observed left truncation times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a real number used in the <code class="reqn">H_0</code> to set the hazard 
to this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a left continuous (weight) function used to calculate 
the weighted hazard in <code class="reqn"> H_0</code>. <code>fun</code> must be able 
to take a vector input. See example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tola</code></td>
<td>
<p>an optional positive real number specifying the tolerance of
iteration error in solve the non-linear equation needed in constrained
maximization.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is designed for the case where the 
true distributions are all continuous.
So there should be no tie in the data.
</p>
<p>The log empirical likelihood used here is the ‘Poisson’ version empirical likelihood:
</p>
<p style="text-align: center;"><code class="reqn">  
\sum_{i=1}^n \delta_i \log (dH(x_i))  - [ H(x_i) - H(y_i) ]  ~.
</code>
</p>

<p>If there are ties in the data that are resulted from rounding,
you may break the tie by adding a different tiny number to the tied
observation(s). If those are true ties 
(thus the true distribution is discrete)
we recommend use <code>emplikdisc.test()</code>. 
</p>
<p>The constant <code>theta</code> must be inside the so called
feasible region for the computation to continue. This is similar to the
requirement that in testing the value of the mean, the value must be
inside the convex hull of the observations.
It is always true that the NPMLE values are feasible. So when the
computation complains that there is no hazard function satisfy
the constraint, you should try to move the <code>theta</code> value closer
to the NPMLE.  When the computation stops prematurely, 
the -2LLR should have value infinite.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>the location of the hazard jumps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>the jump size of hazard function at those locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the Lagrange multiplier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"-2LLR"</code></td>
<td>
<p>the -2Log Likelihood ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval</code></td>
<td>
<p>P-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niters</code></td>
<td>
<p>number of iterations used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou </p>


<h3>References</h3>

<p>Pan, X. and Zhou, M. (2002),
“Empirical likelihood in terms of hazard for censored data”. 
<em>Journal of Multivariate Analysis</em> <b>80</b>, 166-188.
</p>


<h3>Examples</h3>

<pre><code class="language-R">fun &lt;- function(x) { as.numeric(x &lt;= 6.5) }
emplikH1.test( x=c(1,2,3,4,5), d=c(1,1,0,1,1), theta=2, fun=fun) 
fun2 &lt;- function(x) {exp(-x)}  
emplikH1.test( x=c(1,2,3,4,5), d=c(1,1,0,1,1), theta=0.2, fun=fun2) 
</code></pre>


</div>