<div class="container">

<table style="width: 100%;"><tr>
<td>marg.prob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the inverse of marginal probability for observing records at each time point</h2>

<h3>Description</h3>

<p>A function calculates the inverse of joint probabilities for weight calculation involved in WGEE.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marg.prob(pi)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a vector containing the inverse of joint probabilities.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,scale = NULL,
         mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
joint_prob&lt;-marg.prob(pi)
</code></pre>


</div>