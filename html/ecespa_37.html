<div class="container">

<table style="width: 100%;"><tr>
<td>marksum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Mark-sum measure </h2>

<h3>Description</h3>

<p>An exploratory data analysis technique for marked point patterns. The marked point pattern is mapped to a random field for visual inspection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marksum(mippp, R = 10, nx = 30, ny = 30)

## S3 method for ploting objects of class 'ecespa.marksum':
## S3 method for class 'ecespa.marksum'
plot(x, what="normalized",  contour=FALSE, grid=FALSE,
	ribbon=TRUE,col=NULL ,main=NULL,xlab="",ylab="",...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mippp</code></td>
<td>
<p> A marked point pattern. An object with the <code>ppp</code> format of <span class="pkg">spatstat</span>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> Radius. The distance argument <em> r</em> at which the mark-sum measure should be computed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>Grid density (for estimation) in the x-side. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p> Grid density (for estimation) in the y-side. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>'ecespa.marksum'</code>. Usually, the result of applying <code>marksum</code> to a point pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>What to plot. One of <code>"marksum"</code> (raw mark sum measure), <code>"point"</code> (point sum measure) or <code>"normalized"</code> (normalized sum measure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>Logical; if <code>"TRUE"</code> add contour to map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical; if <code>"TRUE"</code> add marked grid to map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ribbon</code></td>
<td>
<p>Logical; if <code>"TRUE"</code> add legend to map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color table to use for the map ( see help file on image for details). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Text or expression to add as a title to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Text or expression to add as a label to axis x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Text or expression to add as a label to axis y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to <code>Smooth.ppp</code>, <code>density.ppp</code> or <code>as.mask</code>, to control 
the  parameters of the smoothing kernel, pixel resolution, etc. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Penttinen (2006) defines the <em>mark-sum measure</em> as a smoothed summary measuring locally the contribution of points and marks. For any fixed location <code class="reqn">x</code> within the 
observational   window and a distance <code class="reqn">R</code>, the mark-sum measure <code class="reqn"> S[R](x)</code> equals the sum of the marks of the points within the circle of radius
<code class="reqn">R</code> with centre in  <code class="reqn">x</code>. The <em>point-sum measure</em> <code class="reqn"> I[R](x)</code> is defined by him as the sum of points within the circle of radius <code class="reqn">R</code> with centre
in  <code class="reqn">x</code>, and describes the contribution of points locally near <code class="reqn">x</code>. The <em>normalized mark-sum measure</em> describes the contribution of marks 
near <code class="reqn">x</code> and is defined (Penttinen, 2006) as
</p>
<p style="text-align: center;"><code class="reqn"> S.normalized[R](x) = S[R](x)/I[R](x)</code>
</p>

<p>This implementation of <code>marksum</code> estimates the mark-sum and the point-sum measures in a grid of points whose density is defined by <code>nx</code> and 
<code>ny</code>.
</p>


<h3>Value</h3>

<p><code>marksum</code> gives an object of class <code>'ecespa.marksum'</code>; basically a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>normalized </code></td>
<td>
<p>Normalized mark-sum measure estimated in the grid points. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marksum </code></td>
<td>
<p>Raw mark-sum measure estimated in the grid points. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointsum </code></td>
<td>
<p>Point-sum measure estimated in the grid points. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minus</code></td>
<td>
<p>Point-sum of the grid points. For advanced use only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p> Grid of points. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx </code></td>
<td>
<p>Density of the estimating grid  in the x-side. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny </code></td>
<td>
<p>Density of the estimating grid  in the x-side. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataname </code></td>
<td>
<p>Name of the ppp object analysed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> Radius. The distance argument <em>r</em> at which the mark-sum measure has been computed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>Window of the point pattern.</p>
</td>
</tr>
</table>
<p><code>plot.ecespa.marksum</code> plots the selected mark-sum measure.
</p>


<h3>Author(s)</h3>

<p> Marcelino de la Cruz Rot </p>


<h3>References</h3>

 
<p>Penttinen, A. 2006. Statistics for Marked Point Patterns. In <em>The Yearbook of the Finnish Statistical Society</em>, pp. 70-91. 
</p>


<h3>See Also</h3>

 <p><code>getis</code>, related to the point-sum measure, and  <code>markstat</code> for designing different implementations. </p>


<h3>Examples</h3>

<pre><code class="language-R">
   
 data(seedlings1)
   
 seed.m &lt;- marksum(seedlings1, R=25)

 # raw mark-sum measure; sigma is bandwith for smoothing
 plot(seed.m, what="marksum", sigma = 5)  

 # point sum measure
 plot(seed.m, what="pointsum", sigma = 5) 
   
 # normalized  mark-sum measure
 plot(seed.m,  what="normalized", dimyx=200, contour=TRUE, sigma = 5) 

# the same with added grid and normalized  mark-sum measure
plot(seed.m,  what="normalized", dimyx=200,
      contour=TRUE, sigma = 5, grid=TRUE)


</code></pre>


</div>