<div class="container">

<table style="width: 100%;"><tr>
<td>MRL.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean residual life (MRL) plot</h2>

<h3>Description</h3>

<p>An empirical mean residual life plot (Coles, 2001), including confidence intervals, is produced based on maximum likelihood or moment estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MRL.plot(x, umin = quantile(na.omit(x), probs = 0.8),
  umax = quantile(na.omit(x), probs = 0.95),
  kmin = round(length(na.omit(x)) * 0.05),
  kmax = round(length(na.omit(x)) * 0.2), nint = 100, conf = 0.95,
  est.method = "mle", u0 = NULL, k0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li>
<p>a numeric vector
</p>
</li>
<li>
<p>a time series object <code>ts</code>
</p>
</li>
<li>
<p>a time series object <code>xts</code>
</p>
</li>
<li>
<p>a time series object <code>zoo</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umin</code></td>
<td>
<p>the minimum threshold at which the mean residual life function is calculated based on maximum likelihood estimates. Default is <code>umin = quantile(na.omit(x), probs = 0.8)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umax</code></td>
<td>
<p>the maximum threshold at which the mean residual life function is calculated based on maximum likelihood estimates. Default is <code>umin = quantile(na.omit(x), probs = 0.95)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmin</code></td>
<td>
<p>the minimum number of largest order statistics for which the mean residual life function is calculated based on moment estimates. Default is <code>kmin = round(length(na.omit(x)) * 0.05)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>the maximum number of largest order statistics for which the mean residual life function is calculated based on moment estimates. Default is <code>kmax = round(length(na.omit(x)) * 0.2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>the number of points at which the mean residual life function is calculated. Default is <code>nint = 100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence coefficient for the confidence intervals depicted in the plot. Default is <code>conf = 0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.method</code></td>
<td>
<p>a character string specifying the type of estimates for the scale and shape parameters of GP distribution.
</p>
<p>Possible options are
</p>

<ul>
<li>
<p><code>"mle"</code> (default) to use maximum likelihood estimates (Coles, 2001)
</p>
</li>
<li>
<p><code>"moment"</code> to use moment estimates (de Haan and Ferreira2006).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u0</code></td>
<td>
<p>a numeric value giving the threshold meant for a GP approximation of the threshold exceedances. Default is <code>u0 = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k0</code></td>
<td>
<p>a numeric value giving the number <code>(k0-1)</code> of largest observations meant for a GP approximation. Default is <code>k0 = NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function constructs MRL plot (Coles, 2001) based on maximum likelihood or moment estimates for parameters of GP distribution.
The MRL, i.e. the estimates of the mean excess, are expected to change linearly with threshold levels at which the GP model is appropriate.
If <code>u0</code> (or <code>k0</code>, respectively) is given, a GP mean-threshold dependency line is plotted in addition to the MRL plot (Coles, 2001; Eq. 4.9).
Each of the lines provide the user an option to assess the suitability of <code>u0</code> or <code>k0</code> as a lower bound for the threshold exceedances (for <code>u0</code>) or the number of upper order statistics (for <code>k0</code>) to fit the GP distribution.
In case <code>est.method = "mle"</code> and <code>u0</code> takes a value, the theoretical GP mean is estimated by the MLE estimates of the GP parameters. For the case <code>est.method = "moment"</code> and <code>k0</code> is given, the theoretical GP mean is estimated using the moment estimates.
In case <code>est.method = "moment"</code> the value <code>x(n-k)</code> on the x-axis of MRL plot denotes the <code>(k + 1)</code>-th largest observation of the total number of <code>n</code> observations.
</p>


<h3>References</h3>

<p>Theo Gasser, Alois Kneip &amp; Walter Koehler (1991) A flexible and fast method for automatic smoothing. Journal of the American Statistical Association 86, 643-652. https://doi.org/10.2307/2290393
</p>
<p>E. Herrmann (1997) Local bandwidth choice in kernel regression estimation. Journal of Graphical and Computational Statistics 6, 35-54.
</p>
<p>Herrmann E, Maechler M (2013). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-5, URL http://CRAN.R-project.org/package=lokern.
</p>
<p>Gasser, T, Muller, H-G, Mammitzsch, V (1985). Kernels for nonparametric curve estimation. Journal of the Royal Statistical Society, B Met., 47(2), 238-252.
</p>
<p>Coles, S (2001). An Introduction to Statistical Modeling of Extreme Values. Springer-Verlag, London, U.K., 208pp.
</p>
<p>de Haan, L, Ferreira, A (2006). Extreme Value Theory: An Introduction. Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
res = smoothing(y = x)$residuals
MRL.plot(res)
</code></pre>


</div>