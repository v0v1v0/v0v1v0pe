<div class="container">

<table style="width: 100%;"><tr>
<td>cgr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Gaussian copula graphical lasso to co-occurrence data</h2>

<h3>Description</h3>

<p><code>cgr</code> is used to fit a Gaussian copula graphical model to 
multivariate discrete data, like species co-occurrence data in ecology. 
This function fits the model and estimates the shrinkage parameter
using BIC. Use <code>plot.cgr</code> to plot the resulting graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cgr(
  obj,
  lambda = NULL,
  n.lambda = 100,
  n.samp = 500,
  method = "BIC",
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>object of either class <code>manyglm</code>, 
or  <code>manyany</code> with ordinal models <code>clm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>vector, values of shrinkage parameter lambda for model 
selection (optional, see detail)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.lambda</code></td>
<td>
<p>integer, number of lambda values 
for model selection (default = 100), ignored if lambda supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.samp</code></td>
<td>
<p>integer (default = 500), number of sets residuals used for importance sampling 
(optional, see detail)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for selecting shrinkage parameter lambda, either "BIC" (default) or "AIC"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer (default = 1), seed for random number generation (optional, see detail)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Three objects are returned; 
<code>best_graph</code> is a list with parameters for the 'best' graphical model, chosen by the chosen <code>method</code>; 
<code>all_graphs</code> is a list with likelihood, BIC and AIC for all models along lambda path; 
<code>obj</code> is the input object.
</p>


<h3>Details</h3>

<p><code>cgr</code> is used to fit a Gaussian copula graphical model to multivariate discrete data, such as co-occurrence (multi species) data in ecology. The model is estimated using importance sampling with <code>n.samp</code> sets of randomised quantile or "Dunn-Smyth" residuals (Dunn &amp; Smyth 1996), and the <code>glasso</code> package for fitting Gaussian graphical models. Models are fit for a path of values of the shrinkage parameter <code>lambda</code> chosen so that both completely dense and sparse models are fit. The <code>lambda</code> value for the <code>best_graph</code> is chosen by BIC (default) or AIC.  The seed is controlled so that models with the same data and different predictors can be compared.
</p>


<h3>Author(s)</h3>

<p>Gordana Popovic &lt;g.popovic@unsw.edu.au&gt;.
</p>


<h3>References</h3>

<p>Dunn, P.K., &amp; Smyth, G.K. (1996). Randomized quantile residuals. Journal of Computational and Graphical Statistics 5, 236-244.
</p>
<p>Popovic, G. C., Hui, F. K., &amp; Warton, D. I. (2018). A general algorithm for covariance modeling of discrete data. Journal of Multivariate Analysis, 165, 86-100.
</p>


<h3>See also</h3>

<p><code>plot.cgr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">abund &lt;- spider$abund[,1:5]
spider_mod &lt;- stackedsdm(abund,~1, data = spider$x, ncores=2) 
spid_graph=cgr(spider_mod)
plot(spid_graph,pad=1)
</code></pre>


</div>