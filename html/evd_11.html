<div class="container">

<table style="width: 100%;"><tr>
<td>abvnonpar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-parametric Estimates for Dependence Functions of the
Bivariate Extreme Value Distribution</h2>

<h3>Description</h3>

<p>Calculate or plot non-parametric estimates for the dependence function
<code class="reqn">A</code> of the bivariate extreme value distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">abvnonpar(x = 0.5, data, epmar = FALSE, nsloc1 = NULL,
    nsloc2 = NULL, method = c("cfg", "pickands", "tdo", "pot"),
     k = nrow(data)/4, convex = FALSE, rev = FALSE, madj = 0,
    kmar = NULL, plot = FALSE, add = FALSE, lty = 1, lwd = 1,
    col = 1, blty = 3, blwd = 1, xlim = c(0, 1), ylim = c(0.5, 1),
    xlab = "t", ylab = "A(t)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of values at which the dependence function is
evaluated (ignored if plot or add is <code>TRUE</code>). <code class="reqn">A(1/2)</code>
is returned by default since it is often a useful summary of
dependence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data frame with two columns, which may contain
missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epmar</code></td>
<td>
<p>If <code>TRUE</code>, an empirical transformation of the
marginals is performed in preference to marginal parametric
GEV estimation, and the <code>nsloc</code> arguments are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsloc1, nsloc2</code></td>
<td>
<p>A data frame with the same number of rows as
<code>data</code>, for linear modelling of the location parameter on the
first/second margin. The data frames are treated as covariate
matrices, excluding the intercept. A numeric vector can be given
as an alternative to a single column data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The estimation method (see <b>Details</b>). Typically
either <code>"cfg"</code> (the default) or <code>"pickands"</code>. The method
<code>"tdo"</code> performs poorly and is not recommended. The method 
<code>"pot"</code> is for peaks over threshold modelling where only 
large data values are used for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer parameter for the <code>"pot"</code> method. Only the 
largest <code>k</code> values are used, as described in
<code>bvtcplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convex</code></td>
<td>
<p>Logical; take the convex minorant?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev</code></td>
<td>
<p>Logical; reverse the dependence function? This is
equivalent to evaluating the function at <code>1-x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>madj</code></td>
<td>
<p>Performs marginal adjustments for the <code>"pickands"</code>
method (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmar</code></td>
<td>
<p>In the rare case that the marginal distributions are known,
specifies the GEV parameters to be used instead of maximum likelihood
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical; if <code>TRUE</code> the function is plotted. The
x and y values used to create the plot are returned invisibly.
If <code>plot</code> and <code>add</code> are <code>FALSE</code> (the default),
the arguments following <code>add</code> are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical; add to an existing plot? The existing plot
should have been created using either <code>abvnonpar</code> or
<code>abvevd</code>, the latter of which plots (or calculates)
the dependence function for a number of parametric models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, blty</code></td>
<td>
<p>Function and border line types. Set <code>blty</code>
to zero to omit the border.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd, blwd</code></td>
<td>
<p>Function and border line widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Line colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>x and y-axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x and y-axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other high-level graphics parameters to be passed to
<code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dependence function  <code class="reqn">A(\cdot)</code> of the bivariate
extreme value distribution is defined in <code>abvevd</code>.
Non-parametric estimates are constructed as follows.
Suppose <code class="reqn">(z_{i1},z_{i2})</code> for <code class="reqn">i=1,\ldots,n</code> are <code class="reqn">n</code>
bivariate observations that are passed using the <code>data</code>
argument.
If <code>epmar</code> is <code>FALSE</code> (the default), then
the marginal parameters of the GEV margins are estimated
(under the assumption of independence) and the data is
transformed using
</p>
<p style="text-align: center;"><code class="reqn">y_{i1} = \{1+\hat{s}_1(z_{i1}-\hat{a}_1)/
    \hat{b}_1\}_{+}^{-1/\hat{s}_1}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">y_{i2} = \{1+\hat{s}_2(z_{i2}-\hat{a}_2)/
    \hat{b}_2\}_{+}^{-1/\hat{s}_2}</code>
</p>

<p>for <code class="reqn">i = 1,\ldots,n</code>, where
<code class="reqn">(\hat{a}_1,\hat{b}_1,\hat{s}_1)</code> and
<code class="reqn">(\hat{a}_2,\hat{b}_2,\hat{s}_2)</code>
are the maximum likelihood estimates for the location, scale
and shape parameters on the first and second margins.
If <code>nsloc1</code> or <code>nsloc2</code> are given, the location
parameters may depend on <code class="reqn">i</code> (see <code>fgev</code>).
</p>
<p>Two different estimators of the dependence function can be
implemented.
They are defined (on <code class="reqn">0 \leq w \leq 1</code>) as
follows.
</p>
<p><code>method = "cfg"</code> (Caperaa, Fougeres and Genest, 1997)
</p>
<p style="text-align: center;"><code class="reqn">\log(A_c(w)) = \frac{1}{n} \left\{ \sum_{i=1}^n \log(\max[(1-w)y_{i1},
    wy_{i1}]) - (1-w)\sum_{i=1}^n y_{i1} - w \sum_{i=1}^n y_{i2}
    \right\}</code>
</p>

<p><code>method = "pickands"</code> (Pickands, 1981)
</p>
<p style="text-align: center;"><code class="reqn">A_p(w) = n\left\{\sum_{i=1}^n \min\left(\frac{y_{i1}}{w},
    \frac{y_{i2}}{1-w}\right)\right\}^{-1}</code>
</p>

<p>Two variations on the estimator <code class="reqn">A_p(\cdot)</code> are
also implemented. If the argument <code>madj = 1</code>, an adjustment
given in Deheuvels (1991) is applied. If the argument
<code>madj = 2</code>, an adjustment given in Hall and Tajvidi (2000)
is applied. These are marginal adjustments; they are only
useful when empirical marginal estimation is used.
</p>
<p>Let <code class="reqn">A_n(\cdot)</code> be any estimator of <code class="reqn">A(\cdot)</code>.
None of the estimators satisfy
<code class="reqn">\max(w,1-w) \leq A_n(w) \leq 1</code>
for all <code class="reqn">0\leq w \leq1</code>. An obvious modification is
</p>
<p style="text-align: center;"><code class="reqn">A_n^{'}(w) = \min(1, \max\{A_n(w), w, 1-w\}).</code>
</p>

<p>This modification is always implemented.
</p>
<p>Convex estimators can be derived by taking the convex minorant,
which can be achieved by setting <code>convex</code> to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p><code>abvnonpar</code> calculates or plots a non-parametric estimate of
the dependence function of the bivariate extreme value distribution.
</p>


<h3>Note</h3>

<p>I have been asked to point out that Hall and Tajvidi (2000)
suggest putting a constrained smoothing spline on their
modified Pickands estimator, but this is not done here.
</p>


<h3>References</h3>

<p>Caperaa, P. Fougeres, A.-L. and Genest, C. (1997)
A non-parametric estimation procedure for bivariate
extreme value copulas.
<em>Biometrika</em>, <b>84</b>, 567–577.
</p>
<p>Pickands, J. (1981)
Multivariate extreme value distributions.
<em>Proc. 43rd Sess. Int. Statist. Inst.</em>, <b>49</b>, 859–878.
</p>
<p>Deheuvels, P. (1991)
On the limiting behaviour of the Pickands estimator 
for bivariate extreme-value distributions.
<em>Statist. Probab. Letters</em>, <b>12</b>, 429–439.
</p>
<p>Hall, P. and Tajvidi, N. (2000)
Distribution and dependence-function estimation for
bivariate extreme-value distributions.
<em>Bernoulli</em>, <b>6</b>, 835–844.
</p>


<h3>See Also</h3>

<p><code>abvevd</code>, <code>amvnonpar</code>,
<code>bvtcplot</code>, <code>fgev</code></p>


<h3>Examples</h3>

<pre><code class="language-R">bvdata &lt;- rbvevd(100, dep = 0.7, model = "log")
abvnonpar(seq(0, 1, length = 10), data = bvdata, convex = TRUE)
abvnonpar(data = bvdata, method = "pick", plot = TRUE)

M1 &lt;- fitted(fbvevd(bvdata, model = "log"))
abvevd(dep = M1["dep"], model = "log", plot = TRUE)
abvnonpar(data = bvdata, add = TRUE, lty = 2)
</code></pre>


</div>