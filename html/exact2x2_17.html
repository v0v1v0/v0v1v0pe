<div class="container">

<table style="width: 100%;"><tr>
<td>calcTall</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate all Tstat for all values of the (n1+1) X (n2+1) sample space from the two sample binomial problem.
</h2>

<h3>Description</h3>

<p>Used mostly by internal call from <code>uncondExact2x2</code>.
If <code>EplusM=FALSE</code> and <code>tiebreak=FALSE</code> then the result is just
<code>Tstat(allx,n1,ally,n2,delta0)</code>. Otherwise does more complicated 
calculations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcTall(Tstat, allx, n1, ally, n2, delta0 = 0, parmtype = "difference", 
    alternative = "two.sided", tsmethod = "central", EplusM = FALSE, tiebreak = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tstat</code></td>
<td>

<p>ordering function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allx</code></td>
<td>

<p>vector of x1 values, typically rep(0:n1,n2+1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>sample size in group 1 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ally</code></td>
<td>

<p>vector of x2 values, typically rep(0:n2,each=n1+1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>

<p>sample size in group 2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta0</code></td>
<td>

<p>null parameter value for input into Tstat
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmtype</code></td>
<td>

<p>parmeter type, either 'difference', 'ratio', or 'oddsratio'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>alternative hypothesis, either 'two.sided' or not
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsmethod</code></td>
<td>

<p>two-sided method, either 'central' or 'square'  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EplusM</code></td>
<td>

<p>logical, do E+M ordering of Lloyd (2008)?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tiebreak</code></td>
<td>

<p>logical, do tie break method? Only allowed when tsmethod!='square'.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>tiebreak=TRUE</code> does a method that breaks ties in the ordering function differently  depending on the <code>parmtype</code> value. The tie breaks are developed to make sense when <code>method="simple"</code> and <code>tsmethod!="square"</code>, when applied to other methods it may not necessarily break ties reasonably. For that reason <code>tiebreak=TRUE</code> returns an error when <code>tsmethod="square"</code>. For <code>parmtype="difference"</code> ties are broken based on Z scores on the difference in proportions, with larger values of <code>Z</code>
treated as larger. This means that when the sample proportions are equal,
the ties are not broken. For <code>parmtype="ratio"</code> ties are broken based
on <code>abs(Z)</code>, where the Z scores are based on the difference in log proportions, except when x1=0 (when ties are broken by x2) or x2=0 (when ties are broken by 1/x1). For <code>parmtype="oddsratio"</code> ties are broken based
on <code>abs(Z)</code>, where here the Z scores are based on the 
difference in log odds, except when x1=0 or x1=n1 or x2=0 or x2=n2 (see code for specifics). 
</p>
<p>The E+M method, is to take an existing ordering function, Tstat, and calculate
a one-sided p-value based on that ordering function evaluated at the constrained 
maximum likelihood estimates of the parameters. The ordering is then 
the set of one-sided p-values from Pr[T(X)&lt;=T(xobs)],  except when 
<code>alternative="two.sided"</code> and <code>tsmethod="square"</code> in which case 
it is 1-p, where p, the p-value, is based on Pr[T(X)&gt;=T(xobs)]. The latter exception is needed so that larger values are more likely to reject.
</p>
<p>If <code>tiebreak=TRUE</code> and <code>EplusM=TRUE</code>, the teibreak calculations are always done first. 
</p>


<h3>Value</h3>

<p>a vector of the same length as allx, giving values of Tstat function at all
values in the sample space.
</p>


</div>