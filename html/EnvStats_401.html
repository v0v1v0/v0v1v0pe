<div class="container">

<table style="width: 100%;"><tr>
<td>plotTolIntNparDesign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plots for a Sampling Design Based on a Nonparametric Tolerance Interval
</h2>

<h3>Description</h3>

<p>Create plots involving sample size (<code class="reqn">n</code>), coverage (<code class="reqn">\beta</code>), and confidence level 
<code class="reqn">(1-\alpha)</code> for a nonparametric tolerance interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plotTolIntNparDesign(x.var = "n", y.var = "conf.level", range.x.var = NULL, n = 25, 
    coverage = 0.95, conf.level = 0.95, ti.type = "two.sided", cov.type = "content", 
    ltl.rank = ifelse(ti.type == "upper", 0, 1), 
    n.plus.one.minus.utl.rank = ifelse(ti.type == "lower", 0, 1), plot.it = TRUE, 
    add = FALSE, n.points = 100, plot.col = "black", plot.lwd = 3 * par("cex"), 
    plot.lty = 1, digits = .Options$digits, cex.main = par("cex"), ..., main = NULL, 
    xlab = NULL, ylab = NULL, type = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.var</code></td>
<td>

<p>character string indicating what variable to use for the x-axis.  Possible values are 
<code>"n"</code> (sample size; the default), <code>"coverage"</code> (the coverage), and <code>"conf.level"</code> 
(the confidence level). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.var</code></td>
<td>

<p>character string indicating what variable to use for the y-axis.  Possible values are 
<code>"conf.level"</code> (the confidence level; the default), <code>"n"</code> (sample size), and 
<code>"coverage"</code> (the coverage). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.x.var</code></td>
<td>

<p>numeric vector of length 2 indicating the range of the x-variable to use for the plot.  The 
default value depends on the value of <code>x.var</code>.  When <code>x.var="n"</code> the default value is 
<code>c(2,50)</code>.  When <code>x.var="coverage"</code> or <code>x.var="conf"</code>, the default value is 
<code>c(0.5, 0.99)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>numeric scalar indicating the sample size.  The default value is <br><code>max(25, lpl.rank + n.plus.one.minus.upl.rank + 1)</code>.  
Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
values are not allowed.  
This argument is ignored if either <code>x.var="n"</code> or <code>y.var="n"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>

<p>numeric scalar between 0 and 1 specifying the coverage of the tolerance interval.  The default 
value is <code>coverage=0.95</code>.  This argument is ignored if <br><code>x.var="coverage"</code> or <code>y.var="coverage"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level associated with the tolerance interval.  
The default value is <code>conf.level=0.95</code>.  This argument is ignored if <code>x.var="conf.level"</code> 
or <code>y.var="conf.level"</code>, or if <br><code>cov.type="expectation"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ti.type</code></td>
<td>

<p>character string indicating what kind of tolerance interval to compute.  
The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.type</code></td>
<td>

<p>character string specifying the coverage type for the tolerance interval.  
The possible values are <code>"content"</code> (<code class="reqn">\beta</code>-content; the default), and 
<code>"expectation"</code> (<code class="reqn">\beta</code>-expectation).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltl.rank</code></td>
<td>

<p>vector of positive integers indicating the rank of the order statistic to use for the lower bound 
of the tolerance interval.  If <code>ti.type="two-sided"</code> or <br><code>ti.type="lower"</code>, 
the default value is <code>ltl.rank=1</code> (implying the minimum value of <code>x</code> is used 
as the lower bound of the tolerance interval).  If <br><code>ti.type="upper"</code>, this argument 
is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.plus.one.minus.utl.rank</code></td>
<td>

<p>vector of positive integers related to the rank of the order statistic to use for 
the upper bound of the tolerance interval.  A value of 
<code>n.plus.one.minus.utl.rank=1</code> (the default) means use the 
first largest value, and in general a value of <br><code>n.plus.one.minus.utl.rank=</code><code class="reqn">i</code> means use the <code class="reqn">i</code>'th largest value.  
If <br><code>ti.type="lower"</code>, this argument is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>a logical scalar indicating whether to create a plot or add to the 
existing plot (see <code>add</code>) on the current graphics device.  If 
<code>plot.it=FALSE</code>, no plot is produced, but a list of (x,y) values 
is returned (see VALUE).  The default value is <code>plot.it=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>a logical scalar indicating whether to add the design plot to the 
existing plot (<code>add=TRUE</code>), or to create a plot from scratch 
(<code>add=FALSE</code>).  The default value is <code>add=FALSE</code>.  
This argument is ignored if <code>plot.it=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>

<p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.  
There are <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>.  The default value is <code>n.points=100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the plotted 
line or points.  The default value is <code>plot.col="black"</code>.  See the 
entry for <code>col</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lwd</code></td>
<td>

<p>a numeric scalar determining the width of the plotted line.  The default value is 
<code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the plotted line.  The default value is 
<code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print out on the plot.  The default 
value is the current setting of <code>options("digits")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main, main, xlab, ylab, type, ...</code></td>
<td>

<p>additional graphical parameters (see <code>par</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help file for <code>tolIntNpar</code>, <code>tolIntNparConfLevel</code>, 
<code>tolIntNparCoverage</code>, and <code>tolIntNparN</code> for information on how 
to compute a nonparametric tolerance interval, how the confidence level 
is computed when other quantities are fixed, how the coverage is computed when other 
quantites are fixed, and and how the sample size is computed when other quantities are fixed.
</p>


<h3>Value</h3>

<p><code>plotTolIntNparDesign</code> invisibly returns a list with components 
<code>x.var</code> and <code>y.var</code>, giving coordinates of the points that 
have been or would have been plotted.
</p>


<h3>Note</h3>

<p>See the help file for <code>tolIntNpar</code>.
</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine 
the relationship between sample size, coverage, and confidence level if one of the objectives of 
the sampling program is to produce tolerance intervals.  The functions 
<code>tolIntNparN</code>, <code>tolIntNparCoverage</code>, <code>tolIntNparConfLevel</code>, and 
<code>plotTolIntNparDesign</code> can be used to investigate these relationships for 
constructing nonparametric tolerance intervals.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>tolIntNpar</code>.
</p>


<h3>See Also</h3>

<p><code>tolIntNpar</code>, <code>tolIntNparConfLevel</code>, <code>tolIntNparCoverage</code>, 
<code>tolIntNparN</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Look at the relationship between confidence level and sample size for a two-sided 
  # nonparametric tolerance interval.

  dev.new()
  plotTolIntNparDesign()

  #==========

  # Plot confidence level vs. sample size for various values of coverage:

  dev.new()
  plotTolIntNparDesign(coverage = 0.7, ylim = c(0,1), main = "") 

  plotTolIntNparDesign(coverage = 0.8, add = TRUE, plot.col = "red") 

  plotTolIntNparDesign(coverage = 0.9, add = TRUE, plot.col = "blue") 

  legend("bottomright", c("coverage = 70%", "coverage = 80%", "coverage = 90%"), lty=1, 
    lwd = 3 * par("cex"), col = c("black", "red", "blue"), bty = "n") 

  title(main = paste("Confidence Level vs. Sample Size for Nonparametric TI", 
    "with Various Levels of Coverage", sep = "\n"))

  #==========

  # Example 17-4 on page 17-21 of USEPA (2009) uses copper concentrations (ppb) from 3 
  # background wells to set an upper limit for 2 compliance wells.  There are 6 observations 
  # per well, and the maximum value from the 3 wells is set to the 95% confidence upper 
  # tolerance limit, and we need to determine the coverage of this tolerance interval.  

  tolIntNparCoverage(n = 24, conf.level = 0.95, ti.type = "upper")
  #[1] 0.8826538

  # Here we will modify the example and look at confidence level versus coverage for 
  # a set sample size of n = 24.

  dev.new()
  plotTolIntNparDesign(x.var = "coverage", y.var = "conf.level", n = 24, ti.type = "upper")

  #==========

  # Clean up
  #---------
  graphics.off()
</code></pre>


</div>