<div class="container">

<table style="width: 100%;"><tr>
<td>resid.etas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residuals Analysis and Diagnostics Plots</h2>

<h3>Description</h3>

<p>A function to compute and plot spatial and temporal residuals as well as
transformed times for a fitted ETAS model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   resid.etas(fit, type="raw", n.temp=1000, dimyx=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A fitted ETAS model. An object of class <code>"etas"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string specifying the type residuals to be
computed. Options are <code>"raw"</code> (the default case), <code>"reciprocal"</code>
and <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.temp</code></td>
<td>
<p>An integer specifying the number of partition points for
temporal residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimyx</code></td>
<td>
<p>Dimensions of the discretization for the smoothed
spatial residuals. A numeric vector of length 2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes the temporal residuals
</p>
<p style="text-align: center;"><code class="reqn">R^{temp}(I_j, h) = \sum_{i=1}^{N} \delta_i 1[t_i \in I_j] h(t_i)
    \lambda^{temp}(t_i|H_{t_i}) - \int_{I_j} h(t)\lambda^{temp}(t|H_t) d t</code>
</p>

<p>for <code class="reqn">I_j=((j-1)T/n.temp, jT/n.temp]</code>, <code class="reqn">j=1,...,n.temp</code>,
and the (smoothed version of) spatial residuals
</p>
<p style="text-align: center;"><code class="reqn">R^{spat}(B_j, h) = h(\tilde{x}_i, \tilde{y}_i)
   \lambda^{spat}(\tilde{x}_i, \tilde{y}_i)(\tilde{\delta}_i - \tilde{w}_i)</code>
</p>

<p>for a Berman-Turner quadrature scheme with quadrature points
<code class="reqn">(\tilde{x}_i, \tilde{y}_i)</code> and quadrature weights <code class="reqn">\tilde{w}_i</code>,
<code class="reqn">i=1,...,n.spat</code>. Raw, reciprocal and Pearson residuals obtain
with <code class="reqn">h=1</code>, <code class="reqn">h=1/\lambda</code> and <code class="reqn">h=1/\sqrt{\lambda}</code>,
respectively.
</p>
<p>In addition, the function computes  transformed times
</p>
<p style="text-align: center;"><code class="reqn">\tau_j=\int_{0}^{t_j} \lambda^{temp}(t|H_t) d t</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">U_j = 1 - \exp(-(t_j - t_{j-1}))</code>
</p>



<h3>Value</h3>

<p>The function produces plots of temporal and smoothed spatial residuals,
transformed times <code class="reqn">\tau_j</code> against <code class="reqn">j</code> and Q-Q plot of <code class="reqn">U_j</code>.
</p>
<p>It also returns a list with components
</p>

<ul>
<li>
<p><b>tau</b> the transformed times
</p>
</li>
<li>
<p><b>U</b> related quantities with the transformed times
</p>
</li>
<li>
<p><b>tres</b> the temporal residuals
</p>
</li>
<li>
<p><b>sres</b> the smoothed spatial residuals
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Abdollah Jalilian
<a href="mailto:jalilian@razi.ac.ir">jalilian@razi.ac.ir</a>
</p>


<h3>References</h3>

<p>Baddeley A, Rubak E, Turner R (2015).
<em> Spatial Point Patterns: Methodology and Applications with R</em>.
Chapman and Hall/CRC Press, London. <a href="https://www.routledge.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200">https://www.routledge.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200</a>.
</p>
<p>Baddeley A, Turner R (2000).
Practical Maximum Pseudolikelihood for Spatial Point Patterns.
<em>Australian &amp; New Zealand Journal of Statistics</em>,
<b>42</b>(3), 283–322. 
<a href="https://doi.org/10.1111/1467-842X.00128">doi:10.1111/1467-842X.00128</a>.
</p>
<p>Baddeley A, Turner R, Moller J, Hazelton M (2005).
Residual Analysis for Spatial Point Processes.
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>,
<b>67</b>(5), 617–666. 
<a href="https://doi.org/10.1111/j.1467-9868.2005.00519.x">doi:10.1111/j.1467-9868.2005.00519.x</a>.
</p>
<p>Ogata Y (1988).
Statistical Models for Earthquake Occurrences and Residual Analysis for
Point Processes.
<em>Journal of the American Statistical Association</em>,
<b>83</b>(401), 9–27. 
<a href="https://doi.org/10.2307/2288914">doi:10.2307/2288914</a>.
</p>
<p>Zhuang J (2006).
Second-order Residual Analysis of Spatiotemporal Point Processes and
Applications in Model Evaluation
<em>Journal of the Royal Statistical Society: Series B (Statistical
Methodology)</em>,
<b>68</b>(4), 635–653. 
<a href="https://doi.org/10.1111/j.1467-9868.2006.00559.x">doi:10.1111/j.1467-9868.2006.00559.x</a>.
</p>


<h3>See Also</h3>

<p><code>etas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  iran.cat &lt;- catalog(iran.quakes, time.begin="1973/01/01",
     study.start="1986/01/01", study.end="2016/01/01",
     lat.range=c(26, 40), long.range=c(44, 63), mag.threshold=5)
  print(iran.cat)
  ## Not run: 
  plot(iran.cat)
## End(Not run)

  # setting initial parameter values
  param0 &lt;- c(0.46, 0.23, 0.022, 2.8, 1.12, 0.012, 2.4, 0.35)

  # fitting the model
  ## Not run: 
  iran.fit &lt;- etas(iran.cat, param0=param0)

  # diagnostic plots
  resid.etas(iran.fit)
## End(Not run)

</code></pre>


</div>