<div class="container">

<table style="width: 100%;"><tr>
<td>plot.epinet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the spread of an epidemic</h2>

<h3>Description</h3>

<p>Plot the spread of an epidemic over a contact network.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'epinet'
plot(x, index = dim(x$transtree)[2],
    lwd = 1, leaf.labs = TRUE, leaf.cex = 0.75, zero.at.start = FALSE, 
    main = "Transmission Tree", xlab = "Time", ylab= "", 
    e.col = "black", i.col = "red", lty.transmission = 3,
    marktransitions = TRUE, label.trans = "|", cex.trans = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>output from <code>epinet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a number indicating which of the MCMC
samples to plot. Defaults to the final sample in the chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width for the (horizontal) 
line segments representing the exposed and infective 
periods for each individual.  Also controls the line width 
for the (vertical) line segments showing the transmission
pathways.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaf.labs</code></td>
<td>
<p>boolean variable controlling whether the leaf
labels (Node IDs) are displayed to the right of their
infective period.  Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaf.cex</code></td>
<td>
<p>Character expansion factor for the leaf
labels, if they are displayed.  Defaults to 0.75.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.at.start</code></td>
<td>
<p>boolean variable governing whether the
epidemic times are shifted so that the epidemic begins
at time zero.  Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for x axis on plot.  Defaults to “Time”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for y axis on plot.  Defaults to blank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.col</code></td>
<td>
<p>color to be used to plot the individuals' 
exposed periods on the plot.  Defaults to black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i.col</code></td>
<td>
<p>color to be used to plot the individuals' 
infective periods on the plot.  Defaults to red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.transmission</code></td>
<td>
<p>line type used to mark the (vertical)
infection pathway on the plot.  Defaults to 3 (dotted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marktransitions</code></td>
<td>
<p>boolean variable indicating whether
tick marks should be placed at the times where the
individuals move from the exposed to the infective state.
Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.trans</code></td>
<td>
<p>character used to mark transition points, if
marktransitions is TRUE.  Defaults to “|”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.trans</code></td>
<td>
<p>magnification to be used to for transition labels,
if marktransitions is TRUE.  Defaults to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other plotting arguments to be passed through to the
call to plot() that draws the axes and titles.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Plots the output from the <code>link{epinet}</code> function
indicating the path that the infection took during the
epidemic (the transmission tree) and the times that each
node entered the Exposed, Infective, and Removed states.
The default plotting parameter values work well for
epidemics up to about 50 - 60 infecteds.  For a larger
number of infecteds, it is recommended to use
<code>pdf</code> and adjust plotting dimensions.
</p>


<h3>Value</h3>

<p> returns no value.  Strictly invoked for the plotting
side effect.
</p>


<h3>Author(s)</h3>

<p>David Welch <a href="mailto:david.welch@auckland.ac.nz">david.welch@auckland.ac.nz</a>, 
Chris Groendyke <a href="mailto:cgroendyke@gmail.com">cgroendyke@gmail.com</a></p>


<h3>References</h3>

<p>Groendyke, C. and Welch, D.  2018.  epinet: An R Package to Analyze Epidemics Spread across Contact Networks, <em>Journal of Statistical Software</em>, <b>83-11</b>.	</p>


<h3>See Also</h3>

<p><code>epinet</code> for performing
inference on the network and epidemic model parameters.
The functions <code>epi2newick</code> and 
<code>write.epinet</code> offer other options for outputting
inferred parameter samples and transmission trees.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate an epidemic through a network of 30
set.seed(3)
N &lt;- 30
# Build dyadic covariate matrix (X)
# Have a single covariate for overall edge density; this is the Erdos-Renyi model
nodecov &lt;- matrix(1:N, nrow = N)
dcm &lt;- BuildX(nodecov)
# Simulate network and then simulate epidemic over network
examplenet &lt;- SimulateDyadicLinearERGM(N, dyadiccovmat = dcm, eta = -1.8)
exampleepidemic &lt;- SEIR.simulator(examplenet, N = 30, 
    beta = 0.3, ki = 2, thetai = 5, latencydist = "gamma")

# Set inputs for MCMC algorithm
mcmcinput &lt;- MCMCcontrol(nsamp = 5000, thinning = 10, extrathinning = 10, 
    etapropsd = 0.2) 
priorcontrol &lt;- priorcontrol(bprior = c(0, 1), tiprior = c(1, 3), teprior = c(1, 3), 
    etaprior = c(0, 10), kiprior = c(2, 8), keprior = c(2, 8), priordists = "uniform")
# Run MCMC algorithm on this epidemic
# Delete Exposure and Infection times; will infer these in the MCMC algorithm
exampleepidemic[, 3:4] &lt;- NA
examplemcmc &lt;- epinet( ~ 1, exampleepidemic, dcm, mcmcinput, priorcontrol,
     verbose = FALSE)

# Plot starting state of epidemic from chain 
plot(examplemcmc, index = 1)

# Plot final state of epidemic from chain 
plot(examplemcmc)
</code></pre>


</div>