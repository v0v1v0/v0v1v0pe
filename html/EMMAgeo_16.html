<div class="container">

<table style="width: 100%;"><tr>
<td>mix.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to mix sample spectres.</h2>

<h3>Description</h3>

<p>This functions allows to mix grain-size distributions with specified
proportions and defined noise levels, for example to test the goodness of
the EMMA algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mix.EM(EM, proportion, noise, autocorrelation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>EM</code></td>
<td>
<p><code>Numeric</code> matrix, grain-size distribution definitions.
</p>
<p>Each definition is in a separate row with variable contributions in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportion</code></td>
<td>
<p><code>Numeric</code> vector, relative proportions of each
distribution per sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p><code>Numeric</code> scalar, optional relative white noise levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorrelation</code></td>
<td>
<p><code>Numeric</code> scalar, the degree of
autocorrelation among classes.  Autocorrelation is realised as running mean
of the specified length. Only odd values are allowed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function multiplies each end-member with the respective proportion
value, sums the resulting variables, adds uniform noise and normalises the
resulting mixed sample to 100 %.
</p>


<h3>Value</h3>

<p><code>Numeric</code> vector, a sample composed of known proportions of
end-members.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze, Elisabeth Dietze
</p>


<h3>See Also</h3>

<p><code>create.EM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## define end-member loadings and phi vector
EMa.1 &lt;- create.EM(p1 = c(2, 8), p2 = c(1, 0.8), s = c(0.7, 0.3), 
                   boundaries = c(0, 11), n = 80)
EMa.2 &lt;- create.EM(p1 = c(4, 7), p2 = c(1.1, 1.4), s = c(0.5, 0.5),
                   boundaries = c(0, 11), n = 80)
EMa   &lt;- rbind(EMa.1, EMa.2)

phi   &lt;- seq(0, 11, length.out = 80)

## mix end-member loadings
sample1 &lt;- mix.EM(EMa, proportion = c(0.3, 0.7))
sample2 &lt;- mix.EM(EMa, proportion = c(0.5, 0.5), noise = 0.1,
                  autocorrelation = 3)

## plot end-member loadings (grey) and resulting samples (black)
plot(phi, EMa.1, type="l", col = "grey")
lines(phi, EMa.2, col = "grey")
lines(phi, sample1)
lines(phi, sample2)

</code></pre>


</div>