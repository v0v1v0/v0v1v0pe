<div class="container">

<table style="width: 100%;"><tr>
<td>fit_edwards_optim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Empirical Coefficients</h2>

<h3>Description</h3>

<p>The coefficients calculated by Edwards (1997) and returned by
<code>edwards_coefs()</code> were designed to produce reasonable results
for several general cases, however each source water will have
a set of empirical coefficients that produce more accurate
predictions than the general case. This function calculates
the optimal coefficients given a test set of known initial
values (DOC)
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_edwards_optim(
  data,
  initial_coefs = edwards_coefs("Al"),
  optim_params = list()
)

fit_edwards_coefs(coefs, data = edwards_data("empty"))

## S3 method for class 'edwards_fit_optim'
coef(object, ...)

## S3 method for class 'edwards_fit_coefs'
coef(object, ...)

## S3 method for class 'edwards_fit_base'
predict(object, newdata = NULL, ...)

coagulate_grid(
  object,
  DOC,
  UV254,
  dose = seq(0.01, 2, length.out = 50),
  pH = seq(5, 8, length.out = 50)
)

## S3 method for class 'edwards_fit_base'
fitted(object, ...)

## S3 method for class 'edwards_fit_base'
residuals(object, ...)

## S3 method for class 'edwards_fit_base'
tidy(x, ...)

## S3 method for class 'edwards_fit_base'
glance(x, ...)

## S3 method for class 'edwards_fit_base'
print(x, ...)

## S3 method for class 'edwards_fit_base'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with columns
<code>DOC</code> (mg/L), <code>dose</code> (mmol/L), <code>pH</code> (pH units), <code>UV254</code> (1/cm), and
<code>DOC_final</code> (mg/L). See <code>coagulate()</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_params</code></td>
<td>
<p>Additional arguments to be passed to <code>stats::optim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs, initial_coefs</code></td>
<td>
<p>A set of initial coefficients from which to
start the optimisation. Most usefully one of the coefficient
sets returned by <code>edwards_coefs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>
<p>A fit objected created with <code>fit_edwards_optim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data frame with columns
<code>DOC</code> (mg/L), <code>dose</code> (mmol/L), <code>pH</code> (pH units), and <code>UV254</code> (1/cm). If
omitted, the data used to fit the model is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DOC</code></td>
<td>
<p>The initial DOC concentration (mg/L).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UV254</code></td>
<td>
<p>The absorbance of UV254 (1/cm). With <code>DOC</code>,
used to calculate SUVA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose</code></td>
<td>
<p>The coagulant metal concentration (Al3+ or Fe3+) in mmol/L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pH</code></td>
<td>
<p>The pH of coagulation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An S3 of type "edwards_fit_optim" with components:
</p>

<dl>
<dt>data, initial_coefs, optim_params</dt>
<dd>
<p>References to inputs.</p>
</dd>
<dt>fit_optim</dt>
<dd>
<p>The fit object returned by <code>stats::optim()</code>.</p>
</dd>
</dl>
</div>