<div class="container">

<table style="width: 100%;"><tr>
<td>FBD_tests1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Test assumptions of normality and homoscedasticity for FBD posterior parameters
</h2>

<h3>Description</h3>

<p>Produces tests of normality (within time bin, ignoring time bin, and pooling within-time bin values) and homoscedasticity (homogeneity of variances) for each fossilized birthâ€“death process (FBD) parameter in the posterior parameter log file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FBD_tests1(posterior, downsample = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>

<p>A data frame of posterior parameter estimates containing a single "Time_bin" column and one column for each FBD parameter value. Such data frame can be imported using <code>combine_log</code> followed by <code>FBD_reshape</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downsample</code></td>
<td>

<p>Whether to downsample the observations to ensure Shapiro-Wilk normality tests can be run. If <code>TRUE</code>, observations will be dropped so that no more than 5000 observations are used for the tests on the full dataset, as required by <code>shapiro.test</code>. They will be dropped in evenly spaced intervals. If <code>FALSE</code> and there are more than 5000 observations for any test, that test will not be run.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>FBD_tests1()</code> performs several tests on the posterior distributions of parameter values within and across time bins. It produces the Shapiro-Wilk test for normality using <code>shapiro.test</code> and the Bartlett and Fligner tests for homogeneity of variance using <code>bartlett.test</code> and <code>fligner.test</code>, respectively. Note that these tests are likely to be significant even if the observations are approximately normally distributed or have approximately equal variance; therefore, they should be supplemented with visual inspection using <code>FBD_normality_plot</code>.
</p>


<h3>Value</h3>

<p>A list containing the results of the three tests with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>shapiro</code></td>
<td>
<p>A list with an element for each parameter. Each element is a data frame with a row for each time bin and the test statistic and p-value for the Shapiro-Wilk test for normality. In addition, there will be a row for an overall test, combining all observations ignoring time bin, and a test of the residuals, which combines the group-mean-centered observations (equivalent to the residuals in a regression of the parameter on time bin).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bartlett</code></td>
<td>
<p>A data frame of the Bartlett test for homogeneity of variance across time bins with a row for each parameter and the test statistic and p-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fligner</code></td>
<td>
<p>A data frame of the Fligner test for homogeneity of variance across time bins with a row for each parameter and the test statistic and p-value for the test.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>vignette("fbd-params")</code> for the use of this function as part of an analysis pipeline.
</p>
<p><code>combine_log</code> for producing a single data set of parameter posterior samples from individual parameter log files.
</p>
<p><code>FBD_reshape</code> for converting posterior parameter table from wide to long format.
</p>
<p><code>FBD_normality_plot</code> for visual assessments.
</p>
<p><code>FBD_tests2</code> for tests of differences between parameter means.
</p>
<p><code>shapiro.test</code>, <code>bartlett.test</code>, and <code>fligner.test</code> for the statistical tests used.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See vignette("fbd-params") for how to use this
# function as part of an analysis pipeline

data("posterior3p")

posterior3p_long &lt;- FBD_reshape(posterior3p)

FBD_tests1(posterior3p_long)
</code></pre>


</div>