<div class="container">

<table style="width: 100%;"><tr>
<td>ppointsCensored</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting Positions for Type I Censored Data
</h2>

<h3>Description</h3>

<p>Returns a list of “ordered” observations and associated plotting positions based on
Type I left-censored or right-censored data.  These plotting positions may be used to
construct empirical cumulative distribution plots or quantile-quantile plots, or to estimate
distribution parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ppointsCensored(x, censored, censoring.side = "left",
    prob.method = "michael-schucany", plot.pos.con = 0.375)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censored</code></td>
<td>

<p>numeric or logical vector indicating which values of <code>x</code> are censored.  This must be the
same length as <code>x</code>.  If the mode of <code>censored</code> is <code>"logical"</code>, <code>TRUE</code> values
correspond to elements of <code>x</code> that are censored, and <code>FALSE</code> values correspond to
elements of <code>x</code> that are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to <code>TRUE</code> and
<code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring.side</code></td>
<td>

<p>character string indicating on which side the censoring occurs.  The possible values are
<code>"left"</code> (the default) and <code>"right"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.method</code></td>
<td>

<p>character string indicating what method to use to compute the plotting positions
(empirical probabilities).  Possible values are: <br><code>"kaplan-meier"</code> (product-limit method of Kaplan and Meier (1958)), <br><code>"modified kaplan-meier"</code> (modification of Kaplan-Meier method), <br><code>"nelson"</code> (hazard plotting method of Nelson (1972)), <br><code>"michael-schucany"</code> (generalization of the product-limit method due to Michael and Schucany (1986)), and <br><code>"hirsch-stedinger"</code> (generalization of the product-limit method due to Hirsch and Stedinger (1987)). <br></p>
<p>The default value is <code>prob.method="michael-schucany"</code>.
</p>
<p>The <code>"nelson"</code> method is only available for <code>censoring.side="right"</code>, and
the <code>"modified kaplan-meier"</code> method is only available for <br><code>censoring.side="left"</code>.  See the DETAILS section for more explanation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pos.con</code></td>
<td>

<p>numeric scalar between 0 and 1 containing the value of the plotting position constant.
The default value is <code>plot.pos.con=0.375</code>.  See the DETAILS section for more information.
This argument is used only if <code>prob.method</code> is equal to <code>"michael-schucany"</code> or
<code>"hirsch-stedinger"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Methods for computing plotting positions for complete data sets
(no censored observations) are discussed in D'Agostino, R.B. (1986a) and
Cleveland (1993).  For data sets with censored observations, these methods
must be modified.  The function <code>ppointsCensored</code> allows you to compute
plotting positions based on any of the following methods:
</p>

<ul>
<li>
<p> Product-limit method of Kaplan and Meier (1958) (<code>prob.method="kaplan-meier"</code>).
</p>
</li>
<li>
<p> Hazard plotting method of Nelson (1972) (<code>prob.method="nelson"</code>).
</p>
</li>
<li>
<p> Generalization of the product-limit method due to Michael and Schucany (1986) <br>
(<code>prob.method="michael-schucany"</code>) (the default).
</p>
</li>
<li>
<p> Generalization of the product-limit method due to Hirsch and Stedinger (1987) <br>
(<code>prob.method="hirsch-stedinger"</code>).
</p>
</li>
</ul>
<p>Let <code class="reqn">\underline{x}</code> denote a random sample of <code class="reqn">N</code> observations from
some distribution.  Assume <code class="reqn">n</code> (<code class="reqn">0 &lt; n &lt; N</code>) of these
observations are known and <code class="reqn">c</code> (<code class="reqn">c=N-n</code>) of these observations are
all censored below (left-censored) or all censored above (right-censored) at
<code class="reqn">k</code> fixed censoring levels
</p>
<p style="text-align: center;"><code class="reqn">T_1, T_2, \ldots, T_K; \; K \ge 1 \;\;\;\;\;\; (1)</code>
</p>

<p>For the case when <code class="reqn">K \ge 2</code>, the data are said to be Type I
<b><em>multiply censored</em></b>.  For the case when <code class="reqn">K=1</code>,
set <code class="reqn">T = T_1</code>.  If the data are left-censored
and all <code class="reqn">n</code> known observations are greater
than or equal to <code class="reqn">T</code>, or if the data are right-censored and all <code class="reqn">n</code>
known observations are less than or equal to <code class="reqn">T</code>, then the data are
said to be Type I <b><em>singly censored</em></b> (Nelson, 1982, p.7), otherwise
they are considered to be Type I multiply censored.
</p>
<p>Let <code class="reqn">c_j</code> denote the number of observations censored below or above censoring
level <code class="reqn">T_j</code> for <code class="reqn">j = 1, 2, \ldots, K</code>, so that
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^K c_j = c \;\;\;\;\;\; (2)</code>
</p>

<p>Let <code class="reqn">x_{(1)}, x_{(2)}, \ldots, x_{(N)}</code> denote the “ordered” observations,
where now “observation” means either the actual observation (for uncensored
observations) or the censoring level (for censored observations).  For
right-censored data, if a censored observation has the same value as an
uncensored one, the uncensored observation should be placed first.
For left-censored data, if a censored observation has the same value as an
uncensored one, the censored observation should be placed first.
</p>
<p>Note that in this case the quantity <code class="reqn">x_{(i)}</code> does not necessarily represent
the <code class="reqn">i</code>'th “largest” observation from the (unknown) complete sample.
</p>
<p>Finally, let <code class="reqn">\Omega</code> (omega) denote the set of <code class="reqn">n</code> subscripts in the
“ordered” sample that correspond to uncensored observations.
<br></p>
<p><b>Product-Limit Method of Kaplan and Meier</b> (<code>prob.method="kaplan-meier"</code>) <br>
For complete data sets (no censored observations), the
<b><em>empirical probabilities</em></b> estimator of the cumulative distribution
function evaluated at the <code class="reqn">i</code>'th ordered observation is given by
(D'Agostino, 1986a, p.8):
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \hat{p}_i = \frac{\#[x_j \le x_{(i)}]}{n} \;\;\;\;\;\; (3)</code>
</p>

<p>where <code class="reqn">\#[x_j \le x_{(i)}]</code> denotes the number of observations less than
or equal to <code class="reqn">x_{(i)}</code> (see the help file for <code>ecdfPlot</code>).
Kaplan and Meier (1958) extended this method of computing the empirical cdf to
the case of right-censored data.
<br></p>
<p><em>Right-Censored Data</em> (<code>censoring.side="right"</code>)<br>
Let <code class="reqn">S(t)</code> denote the survival function evaluated at <code class="reqn">t</code>, that is:
</p>
<p style="text-align: center;"><code class="reqn">S(t) = 1 - F(t) = Pr(X &gt; t) \;\;\;\;\;\; (4)</code>
</p>

<p>Kaplan and Meier (1958) show that a nonparametric estimate of the survival
function at the <code class="reqn">i</code>'th ordered observation that is not censored
(i.e., <code class="reqn">i \in \Omega</code>), is given by:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">\hat{S}[x_{(i)}]</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> <code class="reqn">\widehat{Pr}[X &gt; x_{(i)}]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                         </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> <code class="reqn">\widehat{Pr}[X &gt; x_{(1)}]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                         </td>
<td style="text-align: center;">         </td>
<td style="text-align: left;"> <code class="reqn">\;\; \widehat{Pr}[X &gt; x_{(2)} | X &gt; x_{(1)}] \;\; \cdots</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                         </td>
<td style="text-align: center;">         </td>
<td style="text-align: left;"> <code class="reqn">\;\; \widehat{Pr}[X &gt; x_{(i)} | X &gt; x_{(i-1)}]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
                         </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> <code class="reqn">\prod_{j \in \Omega, j \le i} \frac{n_j - d_j}{n_j}, \;\; i \in \Omega \;\;\;\;\; (5)</code>
  </td>
</tr>
</table>
<p>where <code class="reqn">n_j</code> is the number of observations (uncensored or censored) with values
greater than or equal to <code class="reqn">x_{(j)}</code>, and <code class="reqn">d_j</code> denotes the number of
uncensored observations exactly equal to <code class="reqn">x_{(j)}</code> (if there are no tied
uncensored observations then <code class="reqn">d_j</code> will equal 1 for all values of <code class="reqn">j</code>).
(See also Lee and Wang, 2003, pp. 64–69; Michael and Schucany, 1986).  By convention,
the estimate of the survival function at a censored observation is set equal to
the estimated value of the survival function at the largest uncensored observation
less than or equal to that censoring level.  If there are no uncensored observations
less than or equal to a particular censoring level, the estimate of the survival
function is set to 1 for that censoring level.
</p>
<p>Thus the Kaplan-Meier plotting position at the <code class="reqn">i</code>'th ordered observation
that is not censored (i.e., <code class="reqn">i \in \Omega</code>), is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = \hat{F}[x_{(i)}] = 1 - \prod_{j \in \Omega, j \le i} \frac{n_j - d_j}{n_j} \;\;\;\;\;\; (6)</code>
</p>

<p>The plotting position for a censored observation is set equal to the plotting
position associated with the largest uncensored observation less than or equal to
that censoring level.  If there are no uncensored observations less than or equal
to a particular censoring level, the plotting position is set to 0 for that
censoring level.
</p>
<p>As an example, consider the following right-censored data set:
</p>
<p style="text-align: center;"><code class="reqn">3, \ge4, \ge4, 5, 5, 6</code>
</p>

<p>The table below shows how the plotting positions are computed.
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">i</code> </td>
<td style="text-align: left;"> <code class="reqn">x_{(i)}</code> </td>
<td style="text-align: left;"> <code class="reqn">n_i</code> </td>
<td style="text-align: left;"> <code class="reqn">d_i</code> </td>
<td style="text-align: left;"> <code class="reqn">\frac{n_i-d_i}{n_i}</code> </td>
<td style="text-align: left;"> Plotting Position </td>
</tr>
<tr>
<td style="text-align: left;">
   1      </td>
<td style="text-align: left;"> <code class="reqn">3</code>       </td>
<td style="text-align: left;"> <code class="reqn">6</code>   </td>
<td style="text-align: left;"> <code class="reqn">1</code>   </td>
<td style="text-align: left;"> <code class="reqn">5/6</code>                 </td>
<td style="text-align: left;"> <code class="reqn">1 - (5/6) = 0.167</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2      </td>
<td style="text-align: left;"> <code class="reqn">\ge4</code>    </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                       </td>
</tr>
<tr>
<td style="text-align: left;">
   3      </td>
<td style="text-align: left;"> <code class="reqn">\ge4</code>    </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                       </td>
</tr>
<tr>
<td style="text-align: left;">
   4      </td>
<td style="text-align: left;"> <code class="reqn">5</code>       </td>
<td style="text-align: left;"> <code class="reqn">3</code>   </td>
<td style="text-align: left;"> <code class="reqn">2</code>   </td>
<td style="text-align: left;"> <code class="reqn">1/3</code>                 </td>
<td style="text-align: left;"> <code class="reqn">1 - (5/6)(1/3) = 0.722</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   5      </td>
<td style="text-align: left;"> <code class="reqn">5</code>       </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <code class="reqn">0.722</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   6      </td>
<td style="text-align: left;"> <code class="reqn">6</code>       </td>
<td style="text-align: left;"> <code class="reqn">1</code>   </td>
<td style="text-align: left;"> <code class="reqn">1</code>   </td>
<td style="text-align: left;"> <code class="reqn">0/1</code>                 </td>
<td style="text-align: left;"> <code class="reqn">1 - (5/6)(1/3)(0/1) = 1</code>
  </td>
</tr>
</table>
<p>Note that for complete data sets, Equation (6) reduces to Equation (3).
<br></p>
<p><em>Left-Censored Data</em> (<code>censoring.side="left"</code>) <br>
Gillespie et al. (2010) give formulas for the Kaplan-Meier estimator for the case of
left-cesoring (<code>censoring.side="left"</code>).  In this case, the plotting position
for the <code class="reqn">i</code>'th ordered observation, assuming it is not censored, is computed as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = \hat{F}[x_{(i)}] = \prod_{j \in \Omega, j &gt; i} \frac{n_j - d_j}{n_j} \;\;\;\;\;\; (7)</code>
</p>

<p>where <code class="reqn">n_j</code> is the number of observations (uncensored or censored) with values
less than or equal to <code class="reqn">x_{(j)}</code>, and <code class="reqn">d_j</code> denotes the number of
uncensored observations exactly equal to <code class="reqn">x_{(j)}</code> (if there are no tied
uncensored observations then <code class="reqn">d_j</code> will equal 1 for all values of <code class="reqn">j</code>).
The plotting position is equal to 1 for the largest uncensored order statistic.
</p>
<p>As an example, consider the following left-censored data set:
</p>
<p style="text-align: center;"><code class="reqn">3, &lt;4, &lt;4, 5, 5, 6</code>
</p>

<p>The table below shows how the plotting positions are computed.
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">i</code> </td>
<td style="text-align: left;"> <code class="reqn">x_{(i)}</code> </td>
<td style="text-align: left;"> <code class="reqn">n_i</code> </td>
<td style="text-align: left;"> <code class="reqn">d_i</code> </td>
<td style="text-align: left;"> <code class="reqn">\frac{n_i-d_i}{n_i}</code> </td>
<td style="text-align: left;"> Plotting Position </td>
</tr>
<tr>
<td style="text-align: left;">
   1      </td>
<td style="text-align: left;"> <code class="reqn">3</code>       </td>
<td style="text-align: left;"> <code class="reqn">1</code>   </td>
<td style="text-align: left;"> <code class="reqn">1</code>   </td>
<td style="text-align: left;"> <code class="reqn">0/1</code>                 </td>
<td style="text-align: left;"> <code class="reqn">1(5/6)(3/5) = 0.5</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2      </td>
<td style="text-align: left;"> <code class="reqn">&lt;4</code>      </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                       </td>
</tr>
<tr>
<td style="text-align: left;">
   3      </td>
<td style="text-align: left;"> <code class="reqn">&lt;4</code>      </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                       </td>
</tr>
<tr>
<td style="text-align: left;">
   4      </td>
<td style="text-align: left;"> <code class="reqn">5</code>       </td>
<td style="text-align: left;"> <code class="reqn">5</code>   </td>
<td style="text-align: left;"> <code class="reqn">2</code>   </td>
<td style="text-align: left;"> <code class="reqn">3/5</code>                 </td>
<td style="text-align: left;"> <code class="reqn">0.833</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   5      </td>
<td style="text-align: left;"> <code class="reqn">5</code>       </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">           </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <code class="reqn">1(5/6) = 0.833</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   6      </td>
<td style="text-align: left;"> <code class="reqn">6</code>       </td>
<td style="text-align: left;"> <code class="reqn">6</code>   </td>
<td style="text-align: left;"> <code class="reqn">1</code>   </td>
<td style="text-align: left;"> <code class="reqn">5/6</code>                 </td>
<td style="text-align: left;"> <code class="reqn">1</code>
  </td>
</tr>
</table>
<p>Note that for complete data sets, Equation (7) reduces to Equation (3).
<br></p>
<p><b>Modified Kaplan-Meier Method</b> (<code>prob.method="modified kaplan-meier"</code>) <br>
(Left-Censored Data Only.)  For left-censored data, the modified Kaplan-Meier
method is the same as the Kaplan-Meier method, except that for the largest
uncensored order statistic, the plotting position is not set to 1 but rather is
set equal to the Blom plotting position:  <code class="reqn">(N - 0.375)/(N + 0.25)</code>.  This method
is useful, for example, when creating Quantile-Quantile plots.
<br></p>
<p><b>Hazard Plotting Method of Nelson</b> (<code>prob.method="nelson"</code>) <br>
(Right-Censored Data Only.)  For right-censored data, Equation (5) can be
re-written as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}[x_{(i)}] = \prod_{j \in \Omega, j \le i} \frac{N-j}{N-j+1}, \;\; i \in \Omega \;\;\;\;\;\; (8)</code>
</p>

<p>Nelson (1972) proposed the following formula for plotting positions for
the uncensored observations in the context of estimating the hazard function
(see Michael and Schucany,1986, p.469):
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = \hat{F}[x_{(i)}] = 1 - \prod_{j \in \Omega, j \le i} exp(\frac{-1}{N-j+1}) \;\;\;\;\;\; (9)</code>
</p>

<p>See Lee and Wang (2003) for more information about the hazard function.
</p>
<p>As for the Kaplan and Meier (1958) method, the plotting position for a censored
observation is set equal to the plotting position associated with the largest
uncensored observation less than or equal to that censoring level.  If there are
no uncensored observations less than or equal to a particular censoring level,
the plotting position is set to 0 for that censoring level.
<br></p>
<p><b>Generalization of Product-Limit Method, Michael and Schucany</b> <br>
(<code>prob.method="michael-schucany"</code>) <br>
For complete data sets, the disadvantage of using Equation (3) above to define
plotting positions is that it implies the largest observed value is the maximum
possible value of the distribution (the <code class="reqn">100</code>'th percentile).  This may be
satisfactory if the underlying distribution is known to be discrete, but it is
usually not satisfactory if the underlying distribution is known to be continuous.
</p>
<p>A more frequently used formula for plotting positions for complete data sets is
given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \hat{p}_i = \frac{i - a}{N - 2a + 1} \;\;\;\;\;\; (10)</code>
</p>

<p>where <code class="reqn">0 \le a \le 1</code> (Cleveland, 1993, p. 18; D'Agostino, 1986a, pp. 8,25).
The value of <code class="reqn">a</code> is usually chosen so that the plotting positions are
approximately unbiased (i.e., approximate the mean of their distribution) or else
approximate the median value of their distribution (see the help file for
<code>ecdfPlot</code>).  Michael and Schucany (1986) extended this method for
both left- and right-censored data sets.
<br></p>
<p><em>Right-Censored Data</em> (<code>censoring.side="right"</code>)<br>
For right-censored data sets, the plotting positions for the uncensored
observations are computed as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = 1 - \frac{N-a+1}{N-2a+1} \prod_{j \in \Omega, j \le i} \frac{N-j-a+1}{N-j-a+2} \;\; i \in \Omega \;\;\;\;\;\; (11)</code>
</p>

<p>Note that the plotting positions proposed by Herd (1960) and Johnson (1964) are a
special case of Equation (11) with <code class="reqn">a=0</code>.  Equation (11) reduces to Equation (10)
in the case of complete data sets.  Note that unlike the Kaplan-Meier method,
plotting positions associated with tied uncensored observations are not the same
(just as in the case for complete data using Equation (10)).
</p>
<p>As for the Kaplan and Meier (1958) method, for right-censored data the plotting
position for a censored observation is set equal to the plotting position associated
with the largest uncensored observation less than or equal to that censoring level.
If there are no uncensored observations less than or equal to a particular censoring
level, the plotting position is set to 0 for that censoring level.
<br></p>
<p><em>Left-Censored Data</em> (<code>censoring.side="left"</code>) <br>
For left-censored data sets the plotting positions are computed as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = \frac{N-a+1}{N-2a+1} \prod_{j \in \Omega, j \ge i} \frac{j-a}{j-a+1} \;\; i \in \Omega \;\;\;\;\;\; (12)</code>
</p>

<p>Equation (12) reduces to Equation (10) in the case of complete data
sets.  Note that unlike the Kaplan-Meier method, plotting positions associated with
tied uncensored observations are not the same (just as in the case for complete
data using Equation (10)).
</p>
<p>For left-censored data, the plotting position for a censored observation is set
equal to the plotting position associated with the smallest uncensored observation
greater than or equal to that censoring level.  If there are no uncensored
observations greater than or equal to a particular censoring level, the plotting
position is set to 1 for that censoring level.
<br></p>
<p><b>Generalization of Product-Limit Method, Hirsch and Stedinger</b> <br>
(<code>prob.method="hirsch-stedinger"</code>) <br>
Hirsch and Stedinger (1987) use a slightly different approach than Kaplan and Meier
(1958) and Michael and Schucany (1986) to derive a nonparametric estimate of the
survival function (probability of exceedance) in the context of left-censored data.
First they estimate the value of the survival function at each of the censoring
levels.  The value of the survival function for an uncensored observation between
two adjacent censoring levels is then computed by linear interpolation (in the form
of a plotting position).  See also Helsel and Cohn (1988).
</p>
<p>The discussion below presents an extension of the method of Hirsch and Stedinger
(1987) to the case of right-censored data, and then presents the original derivation
due to Hirsch and Stedinger (1987) for left-censored data.
</p>
<p><em>Right-Censored Data</em> (<code>censoring.side="right"</code>)<br>
For right-censored data, the survival function is estimated as follows.
For the <code class="reqn">j</code>'th censoring level (<code class="reqn">j = 0, 1, \ldots, K</code>), write the
value of the survival function as:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">S(T_j)</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">Pr[X &gt; T_j]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
               </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">Pr[X &gt; T_{j+1}] + Pr[T_j &lt; X \le T_{j+1}]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
               </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">S(T_{j+1}) + Pr[T_j &lt; X \le T_{j+1} | X &gt; T_j] Pr[X &gt; T_j]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
               </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">S(T_{j+1}) + Pr[T_j &lt; X \le T_{j+1} | X &gt; T_j] S(T_j) \;\;\;\;\;\; (13)</code>
  </td>
</tr>
</table>
<p>where
</p>
<p style="text-align: center;"><code class="reqn">T_0 = -\infty, \;\;\;\;\;\; (14)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{K+1} = \infty \;\;\;\;\;\; (15)</code>
</p>

<p>Now set
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">A_j</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> # uncensored observations in <code class="reqn">(T_j, T_{j+1}] \;\;\;\;\;\; (16)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">B_j</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> # observations in <code class="reqn">(T_{j+1}, \infty) \;\;\;\;\;\; (17)</code>
  </td>
</tr>
</table>
<p>for <code class="reqn">j = 0, 1, \ldots, K</code>.  Then the method of moments estimator of the
conditional probability in Equation (13) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Pr}[T_j &lt; X \le T_{j+1} | X &gt; T_j] = \frac{A_j}{A_j + B_j} \;\;\;\;\;\; (18)</code>
</p>

<p>Hence, by equations (13) and (18) we have
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}(T_j) = \hat{S}(T_{j+1}) + (\frac{A_j}{A_j + B_j}) \hat{S}(T_{j}) \;\;\;\;\;\; (19)</code>
</p>

<p>which can be rewritten as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}(T_{j+1}) = \hat{S}(T_j) [1 - (\frac{A_j}{A_j + B_j})] \;\;\;\;\;\; (20)</code>
</p>

<p>Equation (20) can be solved interatively for <code class="reqn">j = 1, 2, \ldots, K</code>.  Note that
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}(T_0) = \hat{S}(-\infty) = S(-\infty) = 1 \;\;\;\;\;\; (21)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{S}(T_{K+1}) = \hat{S}(\infty) = S(\infty) = 0 \;\;\;\;\;\; (22)</code>
</p>

<p>Once the values of the survival function at the censoring levels are computed, the
plotting positions for the <code class="reqn">A_j</code> uncensored observations in the interval
<code class="reqn">(T_J, T_{j+1}]</code> (<code class="reqn">j = 0, 1, \ldots, K</code>) are computed as
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = [1 - \hat{S}(T_j)] + [\hat{S}(T_j) - \hat{S}(T_{j+1})] \frac{r-a}{A_j - 2a + 1} \;\;\;\;\;\; (23)</code>
</p>

<p>where <code class="reqn">a</code> denotes the plotting position constant, <code class="reqn">0 \le a \le 1</code>, and
<code class="reqn">r</code> denotes the rank of the <code class="reqn">i</code>'th observation among the <code class="reqn">A_j</code>
uncensored observations in the interval <code class="reqn">(T_J, T_{j+1}]</code>.
(Tied observations are given distinct ranks.)
</p>
<p>For the <code class="reqn">c_j</code> observations censored at censoring level <code class="reqn">T_j</code>
(<code class="reqn">j = 1, 2, \ldots, K</code>), the plotting positions are computed as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = 1 - [\hat{S}(T_j) \frac{r-a}{c_j - 2a + 1}]  \;\;\;\;\;\; (24)</code>
</p>

<p>where <code class="reqn">r</code> denotes the rank of the <code class="reqn">i</code>'th observation among the <code class="reqn">c_j</code>
observations censored at censoring level <code class="reqn">T_j</code>.  Note that all the
observations censored at the same censoring level are given distinct ranks,
even though there is no way to distinguish between them.
<br></p>
<p><em>Left-Censored Data</em> (<code>censoring.side="left"</code>) <br>
For left-censored data, Hirsch and Stedinger (1987) modify the definition of the
survival function as follows:
</p>
<p style="text-align: center;"><code class="reqn">S^*(t) = Pr[X \ge t] \;\;\;\;\;\; (25)</code>
</p>

<p>For continuous distributions, the functions in Equations (4) and (25) are identical.
</p>
<p>Hirsch and Stedinger (1987) show that for the <code class="reqn">j</code>'th censoring level
(<code class="reqn">j = 0, 1, \ldots, K</code>), the value of the survival function can be written as:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">S(T_j)</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">Pr[X \ge T_j]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
               </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">Pr[X \ge T_{j+1}] + Pr[T_j \le X &lt; T_{j+1}]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
               </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">S^*(T_{j+1}) + Pr[T_j \le X &lt; T_{j+1} | X &lt; T_{j+1}] Pr[X &lt; T_{j+1}]</code> </td>
</tr>
<tr>
<td style="text-align: left;">
               </td>
<td style="text-align: center;"> <code class="reqn">=</code>  </td>
<td style="text-align: left;"> <code class="reqn">S^*(T_{j+1}) + Pr[T_j \le X &lt; T_{j+1} | X &lt; T_j] [1 - S^*(T_j)] \;\;\;\;\;\; (26)</code>
  </td>
</tr>
</table>
<p>where <code class="reqn">T_0</code> and <code class="reqn">T_{K+1}</code> are defined in Equations (14) and (15).
</p>
<p>Now set
</p>

<table>
<tr>
<td style="text-align: left;">
  <code class="reqn">A_j</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> # uncensored observations in <code class="reqn">[T_j, T_{j+1}) \;\;\;\;\;\; (27)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">B_j</code> </td>
<td style="text-align: center;"> <code class="reqn">=</code> </td>
<td style="text-align: left;"> # observations in <code class="reqn">(-\infty, T_j) \;\;\;\;\;\; (28)</code>
  </td>
</tr>
</table>
<p>for <code class="reqn">j = 0, 1, \ldots, K</code>.  Then the method of moments estimator of the
conditional probability in Equation (26) is given by:
</p>
<p style="text-align: center;"><code class="reqn">Pr[T_j \le X &lt; T_{j+1} | X &lt; T_{j+1}] = \frac{A_j}{A_j + B_j} \;\;\;\;\;\; (29)</code>
</p>

<p>Hence, by Equations (26) and (29) we have
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}(T_j) = \hat{S}(T_{j+1}) + (\frac{A_j}{A_j + B_j}) \hat{S}(T_{j}) \;\;\;\;\;\; (30)</code>
</p>

<p>which can be solved interatively for <code class="reqn">j = 1, 2, \ldots, K</code>.  Note that
</p>
<p style="text-align: center;"><code class="reqn">\widehat{S^*}(T_{K+1}) = \widehat{S^*}(\infty) = S^*(\infty) = 0 \;\;\;\;\;\; (31)</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{S^*}(T_0) = \widehat{S^*}(-\infty) = S^*(-\infty) = 1 \;\;\;\;\;\; (32)</code>
</p>

<p>Once the values of the survival function at the censoring levels are computed, the
plotting positions for the <code class="reqn">A_j</code> uncensored observations in the interval
<code class="reqn">[T_J, T_{j+1})</code> (<code class="reqn">j = 0, 1, \ldots, K</code>) are computed as
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = [1 - \widehat{S^*}(T_j)] + [\widehat{S^*}(T_j) - \widehat{S^*}(T_{j+1})] \frac{r-a}{A_j - 2a + 1} \;\;\;\;\;\; (33)</code>
</p>

<p>where <code class="reqn">a</code> denotes the plotting position constant, <code class="reqn">0 \le a \le 0.5</code>, and
<code class="reqn">r</code> denotes the rank of the <code class="reqn">i</code>'th observation among the <code class="reqn">A_j</code>
uncensored observations in the interval <code class="reqn">[T_J, T_{j+1})</code>.
(Tied observations are given distinct ranks.)
</p>
<p>For the <code class="reqn">c_j</code> observations censored at censoring level <code class="reqn">T_j</code>
(<code class="reqn">j = 1, 2, \ldots, K</code>), the plotting positions are computed as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = [1 - \widehat{S^*}(T_j)] \frac{r-a}{c_j - 2a + 1}  \;\;\;\;\;\; (34)</code>
</p>

<p>where <code class="reqn">r</code> denotes the rank of the <code class="reqn">i</code>'th observation among the <code class="reqn">c_j</code>
observations censored at censoring level <code class="reqn">T_j</code>.  Note that all the
observations censored at the same censoring level are given distinct ranks,
even though there is no way to distinguish between them.
</p>


<h3>Value</h3>

<p><code>ppointsCensored</code> returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Order.Statistics</code></td>
<td>
<p>numeric vector of the “ordered” observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cumulative.Probabilities</code></td>
<td>
<p>numeric vector of the associated plotting positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censored</code></td>
<td>
<p>logical vector indicating which of the ordered observations are censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censoring.Side</code></td>
<td>
<p>character string indicating whether the data are left- or right-censored.
This is same value as the argument <code>censoring.side</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prob.Method</code></td>
<td>
<p>character string indicating what method was used to compute the plotting positions.
This is the same value as the argument <code>prob.method</code>.</p>
</td>
</tr>
</table>
<p>Optional Component (only present when <code>prob.method="michael-schucany"</code> or <br><code>prob.method="hirsch-stedinger"</code>):
</p>
<table><tr style="vertical-align: top;">
<td><code>Plot.Pos.Con</code></td>
<td>
<p>numeric scalar containing the value of the plotting position constant that was used.
This is the same as the argument <code>plot.pos.con</code>.</p>
</td>
</tr></table>
<h3>Note</h3>

<p>For censored data sets, plotting positions may be used to construct empirical cumulative distribution
plots (see <code>ecdfPlotCensored</code>), construct quantile-quantile plots
(see <code>qqPlotCensored</code>), or to estimate distribution parameters
(see <code>FcnsByCatCensoredData</code>).
</p>
<p>The function <code>survfit</code> in the built-in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> library
<span class="pkg">survival</span> computes the survival function for right-censored, left-censored, or
interval-censored data.  Calling <code>survfit</code> with
<code>type="kaplan-meier"</code> will produce similar results to calling
<code>ppointsCensored</code> with <code>prob.method="kaplan-meier"</code>.  Also, calling
<code>survfit</code> with <code>type="fh2"</code> will produce similar results
to calling <code>ppointsCensored</code> with <code>prob.method="nelson"</code>.
</p>
<p>Helsel and Cohn (1988, p.2001) found very little effect of changing the value of the plotting position
constant when using the method of Hirsch and Stedinger (1987) to compute plotting positions for
multiply left-censored data.  In general, there will be very little difference between plotting positions
computed by the different methods except in the case of very small samples and a large amount of
censoring.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J.M., W.S. Cleveland, B. Kleiner, and P.A. Tukey. (1983).
<em>Graphical Methods for Data Analysis</em>. Duxbury Press, Boston, MA, pp.11-16.
</p>
<p>Cleveland, W.S. (1993). <em>Visualizing Data</em>. Hobart Press, Summit, New Jersey, 360pp.
</p>
<p>D'Agostino, R.B. (1986a). Graphical Analysis.
In: D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
Marcel Dekker, New York, Chapter 2, pp.7-62.
</p>
<p>Gillespie, B.W., Q. Chen, H. Reichert, A. Franzblau, E. Hedgeman, J. Lepkowski,
P. Adriaens, A. Demond, W. Luksemburg, and D.H. Garabrant. (2010).  Estimating Population
Distributions When Some Data Are Below a Limit of Detection by Using a Reverse
Kaplan-Meier Estimator.  <em>Epidemiology</em> <b>21</b>(4), S64–S70.
</p>
<p>Helsel, D.R. (2012). <em>Statistics for Censored Environmental Data Using Minitab and R,
Second Edition</em>.  John Wiley &amp; Sons, Hoboken, New Jersey.
</p>
<p>Helsel, D.R., and T.A. Cohn. (1988). Estimation of Descriptive Statistics for Multiply Censored
Water Quality Data. <em>Water Resources Research</em> <b>24</b>(12), 1997-2004.
</p>
<p>Hirsch, R.M., and J.R. Stedinger. (1987). Plotting Positions for Historical Floods and Their Precision.
<em>Water Resources Research</em> <b>23</b>(4), 715-727.
</p>
<p>Kaplan, E.L., and P. Meier. (1958). Nonparametric Estimation From Incomplete Observations.
<em>Journal of the American Statistical Association</em> <b>53</b>, 457-481.
</p>
<p>Lee, E.T., and J. Wang. (2003). <em>Statistical Methods for Survival Data Analysis,
Third Edition</em>.  John Wiley and Sons, New York.
</p>
<p>Michael, J.R., and W.R. Schucany. (1986). Analysis of Data from Censored Samples.
In D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
Marcel Dekker, New York, 560pp, Chapter 11, 461-496.
</p>
<p>Nelson, W. (1972). Theory and Applications of Hazard Plotting for Censored Failure Data.
<em>Technometrics</em> <b>14</b>, 945-966.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
U.S. Environmental Protection Agency, Washington, D.C. Chapter 15.
</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>


<h3>See Also</h3>

<p><code>ppoints</code>, <code>ecdfPlot</code>, <code>qqPlot</code>,
<code>ecdfPlotCensored</code>, <code>qqPlotCensored</code>,
<code>survfit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a normal distribution with mean=20 and sd=5,
  # censor all observations less than 18, then compute plotting positions for
  # this data set.  Compare the plotting positions to the plotting positions
  # for the uncensored data set.  Note that the plotting positions for the
  # censored data set start at the first ordered uncensored observation and
  # that for values of x &gt; 18 the plotting positions for the two data sets are
  # exactly the same. This is because there is only one censoring level and
  # no uncensored observations fall below the censored observations.
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(333)
  x &lt;- rnorm(20, mean=20, sd=5)
  censored &lt;- x &lt; 18
  censored
  # [1] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE
  #[13] FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE

  sum(censored)
  #[1] 7

  new.x &lt;- x
  new.x[censored] &lt;- 18
  round(sort(new.x),1)
  # [1] 18.0 18.0 18.0 18.0 18.0 18.0 18.0 18.1 18.7 19.6 20.2 20.3 20.6 21.4
  #[15] 21.8 21.8 23.2 26.2 26.8 29.7

  p.list &lt;- ppointsCensored(new.x, censored)
  p.list
  #$Order.Statistics
  # [1] 18.00000 18.00000 18.00000 18.00000 18.00000 18.00000 18.00000 18.09771
  # [9] 18.65418 19.58594 20.21931 20.26851 20.55296 21.38869 21.76359 21.82364
  #[17] 23.16804 26.16527 26.84336 29.67340
  #
  #$Cumulative.Probabilities
  # [1] 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432
  # [8] 0.3765432 0.4259259 0.4753086 0.5246914 0.5740741 0.6234568 0.6728395
  #[15] 0.7222222 0.7716049 0.8209877 0.8703704 0.9197531 0.9691358
  #
  #$Censored
  # [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
  #[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
  #
  #$Censoring.Side
  #[1] "left"
  #
  #$Prob.Method
  #[1] "michael-schucany"
  #
  #$Plot.Pos.Con
  #[1] 0.375

  #----------

  # Round off plotting positions to two decimal places
  # and compare to plotting positions that ignore censoring
  #--------------------------------------------------------

  round(p.list$Cum, 2)
  # [1] 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.43 0.48 0.52 0.57 0.62 0.67
  #[15] 0.72 0.77 0.82 0.87 0.92 0.97

  round(ppoints(x, a=0.375), 2)
  # [1] 0.03 0.08 0.13 0.18 0.23 0.28 0.33 0.38 0.43 0.48 0.52 0.57 0.62 0.67
  #[15] 0.72 0.77 0.82 0.87 0.92 0.97

  #----------

  # Clean up
  #---------
  rm(x, censored, new.x, p.list)

  #----------------------------------------------------------------------------

  # Reproduce the example in Appendix B of Helsel and Cohn (1988).  The data
  # are stored in Helsel.Cohn.88.appb.df.  This data frame contains 18
  # observations, of which 9 are censored below one of 2 distinct censoring
  # levels.

  Helsel.Cohn.88.app.b.df
  #   Conc.orig Conc Censored
  #1         &lt;1    1     TRUE
  #2         &lt;1    1     TRUE
  #...
  #17        33   33    FALSE
  #18        50   50    FALSE

  p.list &lt;- with(Helsel.Cohn.88.app.b.df,
    ppointsCensored(Conc, Censored, prob.method="hirsch-stedinger", plot.pos.con=0))
  lapply(p.list[1:2], round, 3)
  #$Order.Statistics
  # [1]  1  1  1  1  1  1  3  7  9 10 10 10 12 15 20 27 33 50
  #
  #$Cumulative.Probabilities
  # [1] 0.063 0.127 0.190 0.254 0.317 0.381 0.500 0.556 0.611 0.167 0.333 0.500
  #[13] 0.714 0.762 0.810 0.857 0.905 0.952

  # Clean up
  #---------
  rm(p.list)

  #----------------------------------------------------------------------------

  # Example 15-1 of USEPA (2009, page 15-10) gives an example of
  # computing plotting positions based on censored manganese
  # concentrations (ppb) in groundwater collected at 5 monitoring
  # wells.  The data for this example are stored in
  # EPA.09.Ex.15.1.manganese.df.

  EPA.09.Ex.15.1.manganese.df
  #   Sample   Well Manganese.Orig.ppb Manganese.ppb Censored
  #1       1 Well.1                 &lt;5           5.0     TRUE
  #2       2 Well.1               12.1          12.1    FALSE
  #3       3 Well.1               16.9          16.9    FALSE
  #4       4 Well.1               21.6          21.6    FALSE
  #5       5 Well.1                 &lt;2           2.0     TRUE
  #...
  #21      1 Well.5               17.9          17.9    FALSE
  #22      2 Well.5               22.7          22.7    FALSE
  #23      3 Well.5                3.3           3.3    FALSE
  #24      4 Well.5                8.4           8.4    FALSE
  #25      5 Well.5                 &lt;2           2.0     TRUE

  p.list.EPA &lt;- with(EPA.09.Ex.15.1.manganese.df,
    ppointsCensored(Manganese.ppb, Censored,
      prob.method = "kaplan-meier"))
  data.frame(Mn = p.list.EPA$Order.Statistics, Censored = p.list.EPA$Censored,
    CDF = p.list.EPA$Cumulative.Probabilities)
  #      Mn Censored  CDF
  #1    2.0     TRUE 0.21
  #2    2.0     TRUE 0.21
  #3    2.0     TRUE 0.21
  #4    3.3    FALSE 0.28
  #5    5.0     TRUE 0.28
  #6    5.0     TRUE 0.28
  #7    5.0     TRUE 0.28
  #8    5.3    FALSE 0.32
  #9    6.3    FALSE 0.36
  #10   7.7    FALSE 0.40
  #11   8.4    FALSE 0.44
  #12   9.5    FALSE 0.48
  #13  10.0    FALSE 0.52
  #14  11.9    FALSE 0.56
  #15  12.1    FALSE 0.60
  #16  12.6    FALSE 0.64
  #17  16.9    FALSE 0.68
  #18  17.9    FALSE 0.72
  #19  21.6    FALSE 0.76
  #20  22.7    FALSE 0.80
  #21  34.5    FALSE 0.84
  #22  45.9    FALSE 0.88
  #23  53.6    FALSE 0.92
  #24  77.2    FALSE 0.96
  #25 106.3    FALSE 1.00

  #----------

  # Clean up
  #---------
  rm(p.list.EPA)
</code></pre>


</div>