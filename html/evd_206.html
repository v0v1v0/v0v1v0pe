<div class="container">

<table style="width: 100%;"><tr>
<td>mvevd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric Multivariate Extreme Value Distributions</h2>

<h3>Description</h3>

<p>Density function, distribution function and random generation
for the multivariate logistic and multivariate asymmetric
logistic models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pmvevd(q, dep, asy, model = c("log", "alog"), d = 2, mar = c(0,1,0),
    lower.tail = TRUE)
rmvevd(n, dep, asy, model = c("log", "alog"), d = 2, mar = c(0,1,0))
dmvevd(x, dep, asy, model = c("log", "alog"), d = 2, mar = c(0,1,0),
    log = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>A vector of length <code>d</code> or a matrix with <code>d</code>
columns, in which case the density/distribution is evaluated
across the rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep</code></td>
<td>
<p>The dependence parameter(s). For the logistic model,
should be a single value. For the asymmetric logistic model,
should be a vector of length <code class="reqn">2^d-d-1</code>, or a single value,
in which case the value is used for each of the <code class="reqn">2^d-d-1</code>
parameters (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>
<p>The asymmetry parameters for the asymmetric logistic
model. Should be a list with <code class="reqn">2^d-1</code> vector elements
containing the asymmetry parameters for each separate component
(see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The specified model; a character string. Must be either
<code>"log"</code> (the default) or <code>"alog"</code> (or any unique partial
match), for the logistic and asymmetric logistic models respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>A vector of length three containing marginal parameters
for every univariate margin, or a matrix with three columns where
each column represents a vector of values to be passed to the
corresponding marginal parameter. It can also be a list with
<code>d</code> elements, such that each element is either a vector of
length three or a matrix with three columns, in which case the
<code class="reqn">i</code>th element represents the marginal parameters on the
<code class="reqn">i</code>th margin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the log density is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>Logical; if <code>TRUE</code> (default), the
distribution function is returned; the survivor function
is returned otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Define
</p>
<p style="text-align: center;"><code class="reqn">y_i = y_i(z_i) = \{1+s_i(z_i-a_i)/b_i\}^{-1/s_i}</code>
</p>

<p>for <code class="reqn">1+s_i(z_i-a_i)/b_i &gt; 0</code> and
<code class="reqn">i = 1,\ldots,d</code>, where the marginal
parameters are given by
<code class="reqn">(a_i,b_i,s_i)</code>, <code class="reqn">b_i &gt; 0</code>.
If <code class="reqn">s_i = 0</code> then <code class="reqn">y_i</code> is defined by
continuity.
Let <code class="reqn">z = (z_1,z_2,\ldots,z_d)</code>.
In each of the multivariate distributions functions
<code class="reqn">G(z)</code> given below, the
univariate margins are generalized extreme value, so that
<code class="reqn">G(z_i) = \exp(-y_i)</code> for
<code class="reqn">i = 1,\ldots,d</code>.
If <code class="reqn">1+s_i(z_i-a_i)/b_i \leq 0</code> for some
<code class="reqn">i = 1,\ldots,d</code>, the value <code class="reqn">z_i</code> is
either greater than the upper end point (if <code class="reqn">s_i &lt; 0</code>),
or less than the lower end point (if <code class="reqn">s_i &gt; 0</code>), of the
<code class="reqn">i</code>th univariate marginal distribution.
</p>
<p><code>model = "log"</code> (Gumbel, 1960)
</p>
<p>The <code>d</code> dimensional multivariate logistic distribution
function with parameter <code class="reqn">\code{dep} = r</code> is
</p>
<p style="text-align: center;"><code class="reqn">G(z) = \exp\left\{-\left(\sum\nolimits_{i = 1}^{d}
    y_i^{1/r}\right)^r\right\}</code>
</p>

<p>where <code class="reqn">0 &lt; r \leq 1</code>.
This is a special case of the multivariate asymmetric logistic
model.
</p>
<p><code>model = "alog"</code> (Tawn, 1990)
</p>
<p>Let <code class="reqn">B</code> be the set of all non-empty subsets of
<code class="reqn">\{1,\ldots,d\}</code>, let
<code class="reqn">B_1=\{b \in B:|b|=1\}</code>, where <code class="reqn">|b|</code>
denotes the number of elements in the set <code class="reqn">b</code>, and let
<code class="reqn">B_{(i)}=\{b \in B:i \in b\}</code>.
The <code>d</code> dimensional multivariate asymmetric logistic distribution
function is
</p>
<p style="text-align: center;"><code class="reqn">G(z)=\exp\left\{-\sum\nolimits_{b \in B} \left[\sum\nolimits_
    {i\in b}(t_{i,b}y_i)^{1/r_b}\right]^{r_b}\right\},</code>
</p>

<p>where the dependence parameters <code class="reqn">r_b\in(0,1]</code> for
all <code class="reqn">b\in B \setminus B_1</code>, and the asymmetry parameters
<code class="reqn">t_{i,b}\in[0,1]</code> for all <code class="reqn">b\in B</code>
and <code class="reqn">i\in b</code>.
The constraints
<code class="reqn">\sum_{b \in B_{(i)}}t_{i,b}=1</code> for
<code class="reqn">i = 1,\ldots,d</code>
ensure that the marginal distributions are generalized extreme value.
Further constraints arise from the possible redundancy of asymmetry
parameters in the expansion of the distribution form.
Let <code class="reqn">b_{-i_0} = \{i \in b:i \neq i_0\}</code>.
If <code class="reqn">r_b = 1</code> for some
<code class="reqn">b\in B \setminus B_1</code> then
<code class="reqn">t_{i,b} = 0</code> for all <code class="reqn">i\in b</code>.
Furthermore, if for some
<code class="reqn">b\in B \setminus B_1</code>,
<code class="reqn">t_{i,b} = 0</code> for all
<code class="reqn">i\in b_{-i_0}</code>, then
<code class="reqn">t_{i_0,b} = 0</code>.
</p>
<p><code>dep</code> should be a vector of length <code class="reqn">2^d-d-1</code> which contains
<code class="reqn">\{r_b:b\in B \setminus B_1\}</code>, with
the order defined by the natural set ordering on the index.
For example, for the trivariate model,
<code class="reqn">\code{dep} = (r_{12},r_{13},r_{23},r_{123})</code>.
<code>asy</code> should be a list with <code class="reqn">2^d-1</code> elements.
Each element is a vector which corresponds to a set
<code class="reqn">b\in B</code>, containing <code class="reqn">t_{i,b}</code> for
every integer <code class="reqn">i\in b</code>.
The elements should be given using the natural set ordering on the
<code class="reqn">b\in B</code>, so that the first <code class="reqn">d</code> elements are vectors
of length one corresponding to the sets
<code class="reqn">\{1\},\ldots,\{d\}</code>, and the last element is a
a vector of length <code class="reqn">d</code>, corresponding to the set
<code class="reqn">\{1,\ldots,d\}</code>.
<code>asy</code> must be constructed to ensure that all constraints are
satisfied or an error will occur.
</p>


<h3>Value</h3>

<p><code>pmvevd</code> gives the distribution function, <code>dmvevd</code> gives
the density function and <code>rmvevd</code> generates random deviates, for
the multivariate logistic or multivariate asymmetric logistic model.
</p>


<h3>Note</h3>

<p>Multivariate extensions of other bivariate models are more complex.
A multivariate extension of the Husler-Reiss model exists, involving
a multidimensional integral and one parameter for each bivariate
margin.
Multivariate extensions for the negative logistic model can be derived
but are considerably more complex and appear to be less flexible.
The “multivariate negative logistic model” often presented in the
literature (e.g. Kotz <em>et al</em>, 2000) is not a valid distribution
function and should not be used.
</p>
<p>The logistic and asymmetric logistic models respectively are
simulated using Algorithms 2.1 and 2.2 in Stephenson(2003b).
</p>
<p>The density function of the logistic model is evaluated using
the representation of Shi(1995).
The density function of the asymmetric logistic model is evaluated
using the representation given in Stephenson(2003a).
</p>


<h3>References</h3>

<p>Gumbel, E. J. (1960)
Distributions des valeurs extremes en plusieurs dimensions.
<em>Publ. Inst. Statist. Univ. Paris</em>, <b>9</b>, 171–173.
</p>
<p>Kotz, S. and Balakrishnan, N. and Johnson, N. L. (2000)
<em>Continuous Multivariate Distributions</em>, vol. 1.
New York: John Wiley &amp; Sons, 2nd edn.
</p>
<p>Shi, D. (1995)
Fisher information for a multivariate extreme value distribution.
<em>Biometrika</em>, <b>82</b>(3), 644–649.
</p>
<p>Stephenson, A. G. (2003a)
<em>Extreme Value Distributions and their Application</em>.
Ph.D. Thesis, Lancaster University, Lancaster, UK.
</p>
<p>Stephenson, A. G. (2003b)
Simulating multivariate extreme value distributions of logistic type.
<em>Extremes</em>, <b>6</b>(1), 49–60.
</p>
<p>Tawn, J. A. (1990)
Modelling multivariate extreme value distributions.
<em>Biometrika</em>, <b>77</b>, 245–253.
</p>


<h3>See Also</h3>

<p><code>rbvevd</code>, <code>rgev</code></p>


<h3>Examples</h3>

<pre><code class="language-R">pmvevd(matrix(rep(0:4,5), ncol=5), dep = .7, model = "log", d = 5)
pmvevd(rep(4,5), dep = .7, model = "log", d = 5)
rmvevd(10, dep = .7, model = "log", d = 5)
dmvevd(rep(-1,20), dep = .7, model = "log", d = 20, log = TRUE)

asy &lt;- list(.4, .1, .6, c(.3,.2), c(.1,.1), c(.4,.1), c(.2,.3,.2))
pmvevd(rep(2,3), dep = c(.6,.5,.8,.3), asy = asy, model = "alog", d = 3)
asy &lt;- list(.4, .0, .6, c(.3,.2), c(.1,.1), c(.4,.1), c(.2,.4,.2))
rmvevd(10, dep = c(.6,.5,.8,.3), asy = asy, model = "alog", d = 3)
dmvevd(rep(0,3), dep = c(.6,.5,.8,.3), asy = asy, model = "alog", d = 3)

asy &lt;- list(0, 0, 0, 0, c(0,0), c(0,0), c(0,0), c(0,0), c(0,0), c(0,0),
  c(.2,.1,.2), c(.1,.1,.2), c(.3,.4,.1), c(.2,.2,.2), c(.4,.6,.2,.5))
rmvevd(10, dep = .7, asy = asy, model = "alog", d = 4)
rmvevd(10, dep = c(rep(1,6), rep(.7,5)), asy = asy, model = "alog", d = 4)
</code></pre>


</div>