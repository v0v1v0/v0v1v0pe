<div class="container">

<table style="width: 100%;"><tr>
<td>dwm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dynamically Weighted Mixture Model</h2>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and
random number generation for the dynamically weighted mixture model. The
parameters are the Weibull shape <code>wshape</code> and scale <code>wscale</code>,
Cauchy location <code>cmu</code>, Cauchy scale <code>ctau</code>, GPD scale
<code>sigmau</code>, shape <code>xi</code> and initial value for the quantile
<code>qinit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ddwm(x, wshape = 1, wscale = 1, cmu = 1, ctau = 1,
  sigmau = sqrt(wscale^2 * gamma(1 + 2/wshape) - (wscale * gamma(1 +
  1/wshape))^2), xi = 0, log = FALSE)

pdwm(q, wshape = 1, wscale = 1, cmu = 1, ctau = 1,
  sigmau = sqrt(wscale^2 * gamma(1 + 2/wshape) - (wscale * gamma(1 +
  1/wshape))^2), xi = 0, lower.tail = TRUE)

qdwm(p, wshape = 1, wscale = 1, cmu = 1, ctau = 1,
  sigmau = sqrt(wscale^2 * gamma(1 + 2/wshape) - (wscale * gamma(1 +
  1/wshape))^2), xi = 0, lower.tail = TRUE, qinit = NULL)

rdwm(n = 1, wshape = 1, wscale = 1, cmu = 1, ctau = 1,
  sigmau = sqrt(wscale^2 * gamma(1 + 2/wshape) - (wscale * gamma(1 +
  1/wshape))^2), xi = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wshape</code></td>
<td>
<p>Weibull shape (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wscale</code></td>
<td>
<p>Weibull scale (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmu</code></td>
<td>
<p>Cauchy location</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctau</code></td>
<td>
<p>Cauchy scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau</code></td>
<td>
<p>scale parameter (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if TRUE then log density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical, if FALSE then upper tail probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>cumulative probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qinit</code></td>
<td>
<p>scalar or vector of initial values for the quantile estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size (positive integer)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dynamic weighted mixture model combines a Weibull for the bulk 
model with GPD for the tail model. However, unlike all the other mixture 
models the GPD is defined over the entire range of support rather than as a
conditional model above some threshold. A transition function is used to 
apply weights to transition between the bulk and GPD for the upper tail, 
thus providing the dynamically weighted mixture. They use a Cauchy 
cumulative distribution function for the transition function.
</p>
<p>The density function is then a dynamically weighted mixture given by: 
</p>
<p style="text-align: center;"><code class="reqn">f(x) = {[1 - p(x)] h(x) + p(x) g(x)}/r</code>
</p>
<p> where <code class="reqn">h(x)</code> and
<code class="reqn">g(x)</code> are the Weibull and unscaled GPD density functions respectively
(i.e. <code>dweibull(x, wshape, wscale)</code> and <code>dgpd(x, u, sigmau,
  xi)</code>). The Cauchy cumulative distribution function used to provide the
transition is defined by <code class="reqn">p(x)</code> (i.e. <code>pcauchy(x, cmu, ctau</code>. The
normalisation constant <code class="reqn">r</code> ensures a proper density.
</p>
<p>The quantile function is not available in closed form, so has to be solved 
numerically. The argument <code>qinit</code> is the initial quantile estimate
which is used for numerical optimisation and should be set to a reasonable
guess. When the <code>qinit</code> is <code>NULL</code>, the initial quantile value is
given by the midpoint between the Weibull and GPD quantiles. As with the
other inputs <code>qinit</code> is also vectorised, but <code>R</code> does not permit
vectors combining <code>NULL</code> and numeric entries.
</p>


<h3>Value</h3>

<p><code>ddwm</code> gives the density, 
<code>pdwm</code> gives the cumulative distribution function,
<code>qdwm</code> gives the quantile function and 
<code>rdwm</code> gives a random sample.
</p>


<h3>Note</h3>

<p>All inputs are vectorised except <code>log</code> and <code>lower.tail</code>.
The main inputs (<code>x</code>, <code>p</code> or <code>q</code>) and parameters must be either
a scalar or a vector. If vectors are provided they must all be of the same length,
and the function will be evaluated for each element of vector. In the case of 
<code>rdwm</code> any input vector must be of length <code>n</code>.
</p>
<p>Default values are provided for all inputs, except for the fundamentals 
<code>x</code>, <code>q</code> and <code>p</code>. The default sample size for 
<code>rdwm</code> is 1.
</p>
<p>Missing (<code>NA</code>) and Not-a-Number (<code>NaN</code>) values in <code>x</code>,
<code>p</code> and <code>q</code> are passed through as is and infinite values are set to
<code>NA</code>. None of these are not permitted for the parameters.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Yang Hu and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://en.wikipedia.org/wiki/Weibull_distribution">http://en.wikipedia.org/wiki/Weibull_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Cauchy_distribution">http://en.wikipedia.org/wiki/Cauchy_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>Frigessi, A., Haug, O. and Rue, H. (2002). A dynamic mixture model for unsupervised tail
estimation without threshold selection. Extremes 5 (3), 219-235
</p>


<h3>See Also</h3>

<p><code>gpd</code>, <code>dcauchy</code>
and <code>dweibull</code>
</p>
<p>Other fdwm: <code>fdwm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(2, 2))

xx = seq(0.001, 5, 0.01)
f = ddwm(xx, wshape = 2, wscale = 1/gamma(1.5), cmu = 1, ctau = 1, sigmau = 1, xi = 0.5)
plot(xx, f, ylim = c(0, 1), xlim = c(0, 5), type = 'l', lwd = 2, 
  ylab = "density", main = "Plot example in Frigessi et al. (2002)")
lines(xx, dgpd(xx, sigmau = 1, xi = 0.5), col = "red", lty = 2, lwd = 2)
lines(xx, dweibull(xx, shape = 2, scale = 1/gamma(1.5)), col = "blue", lty = 2, lwd = 2)
legend('topright', c('DWM', 'Weibull', 'GPD'),
      col = c("black", "blue", "red"), lty = c(1, 2, 2), lwd = 2)

# three tail behaviours
plot(xx, pdwm(xx, xi = 0), type = "l")
lines(xx, pdwm(xx, xi = 0.3), col = "red")
lines(xx, pdwm(xx, xi = -0.3), col = "blue")
legend("bottomright", paste("xi =",c(0, 0.3, -0.3)), col=c("black", "red", "blue"), lty = 1)

x = rdwm(10000, wshape = 2, wscale = 1/gamma(1.5), cmu = 1, ctau = 1, sigmau = 1, xi = 0.1)
xx = seq(0, 15, 0.01)
hist(x, freq = FALSE, breaks = 100)
lines(xx, ddwm(xx, wshape = 2, wscale = 1/gamma(1.5), cmu = 1, ctau = 1, sigmau = 1, xi = 0.1),
  lwd = 2, col = 'black')
  
plot(xx, pdwm(xx, wshape = 2, wscale = 1/gamma(1.5), cmu = 1, ctau = 1, sigmau = 1, xi = 0.1),
 xlim = c(0, 15), type = 'l', lwd = 2, 
  xlab = "x", ylab = "F(x)")
lines(xx, pgpd(xx, sigmau = 1, xi = 0.1), col = "red", lty = 2, lwd = 2)
lines(xx, pweibull(xx, shape = 2, scale = 1/gamma(1.5)), col = "blue", lty = 2, lwd = 2)
legend('bottomright', c('DWM', 'Weibull', 'GPD'),
      col = c("black", "blue", "red"), lty = c(1, 2, 2), lwd = 2)

## End(Not run)

</code></pre>


</div>