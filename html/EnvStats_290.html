<div class="container">

<table style="width: 100%;"><tr>
<td>gofGroupTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness-of-Fit Test for a Specified Probability Distribution for Groups
</h2>

<h3>Description</h3>

<p>Perform a goodness-of-fit test to determine whether data in a set of 
groups appear to all come from the same probability distribution 
(with possibly different parameters for each group).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofGroupTest(object, ...)

## S3 method for class 'formula'
gofGroupTest(object, data = NULL, subset, 
  na.action = na.pass, ...)

## Default S3 method:
gofGroupTest(object, group, test = "sw", 
  distribution = "norm", est.arg.list = NULL, n.classes = NULL, 
  cut.points = NULL, param.list = NULL, 
  estimate.params = ifelse(is.null(param.list), TRUE, FALSE), 
  n.param.est = NULL, correct = NULL, digits = .Options$digits, 
  exact = NULL, ws.method = "normal scores", 
  data.name = NULL, group.name = NULL, parent.of.data = NULL, 
  subset.expression = NULL, ...)

## S3 method for class 'data.frame'
gofGroupTest(object, ...)

## S3 method for class 'matrix'
gofGroupTest(object, ...)

## S3 method for class 'list'
gofGroupTest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object containing data for 2 or more groups to be compared to the 
hypothesized distribution specified by <code>distribution</code>.  In the default method, 
the argument <code>object</code> must be a numeric vector.  
When <code>object</code> is a data frame, all columns must be numeric.  
When <code>object</code> is a matrix, it must be a numeric matrix.  
When <code>object</code> is a list, all components must be numeric vectors.
In the formula method, a symbolic specification of the form <code>y ~ g</code> 
can be given, indicating the observations in the vector <code>y</code> are to be grouped 
according to the levels of the factor <code>g</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), 
and infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>when <code>object</code> is a formula, <code>data</code> specifies an optional data frame, list or 
environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the 
variables in the model.  If not found in <code>data</code>, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which <br><code>summaryStats</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>when <code>object</code> is a formula, <code>subset</code> specifies an optional vector specifying 
a subset of observations to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>when <code>object</code> is a formula, <code>na.action</code> specifies a function which indicates 
what should happen when the data contain <code>NA</code>s. The default is <code>na.pass</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>when <code>object</code> is a numeric vector, <code>group</code> is a factor or character vector 
indicating which group each observation belongs to.  When <code>object</code> is a matrix or data frame
this argument is ignored and the columns define the groups.  When <code>object</code> is a list 
this argument is ignored and the components define the groups.  When <code>object</code> is a formula, 
this argument is ignored and the right-hand side of the formula specifies the grouping variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>character string defining which goodness-of-fit test to perform on each group.  
Possible values are:  
<code>"sw"</code> (Shapiro-Wilk; the default), <code>"sf"</code> (Shapiro-Francia), 
<code>"ppcc"</code> (Probability Plot Correlation Coefficient), <code>"skew"</code> (Zero-skew), 
<code>"chisq"</code> (Chi-squared), <code>"ks"</code> (Kolmogorov-Smirnov), and 
<code>"ws"</code> (Wilk-Shapiro test for Uniform [0, 1] distribution).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>

<p>a character string denoting the distribution abbreviation.  See the help file for 
<code>Distribution.df</code> for a list of distributions and their abbreviations.  
The default value is <code>distribution="norm"</code> (Normal distribution).
</p>
<p>When <code>test="sw"</code>, <code>test="sf"</code>, or <code>test="ppcc"</code>, any continuous 
distribuiton is allowed (e.g., <code>"norm"</code> (normal), <code>"lnorm"</code> (lognormal), 
<code>"gamma"</code> (gamma), etc.), as well as mixed distributions involving the normal distribution 
(i.e., <code>"zmnorm"</code> (zero-modified normal), <code>"zmlnorm"</code> (zero-modified lognormal (delta)), 
and <br><code>"zmlnorm.alt"</code> (zero-modified lognormal with alternative parameterization)).
</p>
<p>When <code>test="skew"</code>, only the values <code>"norm"</code> (normal), <code>"lnorm"</code> (lognormal), 
<code>"lnorm.alt"</code> (lognormal with alternative parameterization), 
<code>"zmnorm"</code> (zero-modified normal), <code>"zmlnorm"</code> (zero-modified lognormal (delta)), and <br><code>"zmlnorm.alt"</code> (zero-modified lognormal with alternative parameterization) are allowed.
</p>
<p>When <code>test="ks"</code>, any continuous distribution is allowed.
</p>
<p>When <code>test="chisq"</code>, any distribuiton is allowed.
</p>
<p>When <code>test="ws"</code>, this argument is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.arg.list</code></td>
<td>

<p>a list of arguments to be passed to the function estimating the distribution parameters 
for each group of observations.  
For example, if <code>test="sw"</code> and <br><code>distribution="gamma"</code>, setting <code>est.arg.list=list(method="bcmle")</code> 
indicates using the bias-corrected maximum-likelihood estimators of shape and scale 
(see the help file for <code>egamma</code>.  See the help file 
Estimating Distribution Parameters for a list of estimating functions.  
The default value is <br><code>est.arg.list=NULL</code> so that all 
default values for the estimating function are used.  This argument is ignored if 
<code>estimate.params=FALSE</code>.
</p>
<p>When <code>test="sw"</code>, <code>test="sf"</code>, <code>test="ppcc"</code>, or <code>test="skew"</code>, 
and you are testing for some form of normality (i.e., Normal, Lognormal, 
Three-Parameter Lognormal, 
Zero-Modified Normal, or 
Zero-Modified Lognormal (Delta)), 
the estimated parameters are provided in the 
output merely for information, and the choice of the method of estimation has no effect 
on the goodness-of-fit test statistics or p-values.
</p>
<p>When <code>test="ks"</code>, and <code>estimate.params=TRUE</code>, 
the estimated parameters are used to specify the null hypothesis of which distribution 
the data are assumed to come from. 
</p>
<p>When <code>test="chisq"</code> and <code>estimate.params=TRUE</code>, 
the estimated parameters are used to specify the null hypothesis of which distribution 
the data are assumed to come from. 
</p>
<p>When <code>test="ws"</code>, this argument is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.classes</code></td>
<td>

<p>for the case when <code>test="chisq"</code>, the number of cells into which the observations 
within each group are to be allocated.  If the argument <code>cut.points</code> is supplied, 
then <code>n.classes</code> is set to <code>length(cut.points)-1</code>.  The default value is <br><code>ceiling(2* (length(x)^(2/5)))</code> and is recommended by Moore (1986).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.points</code></td>
<td>

<p>for the case when <code>test="chisq"</code>, a vector of cutpoints that defines the cells for each 
group of observations. 
The element <code>x[i]</code> is allocated to cell <code>j</code> if <br><code>cut.points[j]</code> &lt; <code>x[i]</code> <code class="reqn">\le</code> <code>cut.points[j+1]</code>. If <code>x[i]</code> is less than or equal to the first cutpoint or 
greater than the last cutpoint, then <code>x[i]</code> is treated as missing.  If the 
hypothesized distribution is discrete, <code>cut.points</code> must be supplied.  The default 
value is <code>cut.points=NULL</code>, in which case the cutpoints are determined by 
<code>n.classes</code> equi-probable intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.list</code></td>
<td>

<p>for the case when <code>test="ks"</code> or <code>test="chisq"</code>, 
a list with values for the parameters of the specified distribution.  See the help file 
for <code>Distribution.df</code> for the names and possible values of the parameters 
associated with each distribution.  The default value is <code>NULL</code>, which forces 
estimation of the distribution parameters.  This argument is ignored if 
<code>estimate.params=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate.params</code></td>
<td>

<p>for the case when <code>test="ks"</code> or <code>test="chisq"</code>, 
a logical scalar indicating whether to perform the goodness-of-fit test based on 
estimating the distribution parameters (<code>estimate.params=TRUE</code>) or using the 
user-supplied distribution parameters specified by <code>param.list</code> <br>
(<code>estimate.params=FALSE</code>).  The default value of <code>estimate.params</code> is <code>TRUE</code> if 
<code>param.list=NULL</code>, otherwise it is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.param.est</code></td>
<td>

<p>for the case when <code>test="ks"</code> or <code>test="chisq"</code>, 
an integer indicating the number of parameters estimated from the data.  <br>
If <code>estimate.params=TRUE</code>, the default value is the number of parameters associated 
with the distribution specified by <code>distribution</code> (e.g., 2 for a normal distribution).  
If <code>estimate.params=FALSE</code>, the default value is <code>n.param.est=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>

<p>for the case when <code>test="chisq"</code>, a logical scalar indicating whether to use the 
continuity correction.  The default value is <code>correct=FALSE</code> unless <br><code>n.classes=2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print out for the parameters 
associated with the hypothesized distribution.  The default value is <br><code>.Options$digits</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>

<p>for the case when <code>test="ks"</code>, <code>exact=NULL</code> by default, but can be set to 
a logical scalar indicating whether an exact p-value should be computed.  
See the help file for <code>ks.test</code> for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ws.method</code></td>
<td>

<p>character string indicating which method to use when performing the 
Wilk-Shapiro test for a Uniform [0,1] distribution 
on the p-values from the goodness-of-fit tests on each group.  Possible values 
are <code>ws.method="normal scores"</code> (the default) or 
<code>ws.method="chi-square scores"</code>.  See the subsection 
<em>Wilk-Shapiro goodness-of-fit test for Uniform [0, 1] distribution</em> 
under the DETAILS section of the help file for <code>gofTest</code> 
for more information.
</p>
<p><b>NOTE:</b> In the case where you are testing whether each group comes from a 
Uniform [0,1] distribution (i.e., when you set 
<code>test="ws"</code>), the argument <code>ws.method</code> determines which score types 
are used for each individual test of the groups as well.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>

<p>character string indicating the name of the data used for the goodness-of-fit tests.  
The default value is <code>data.name=deparse(substitute(object))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.name</code></td>
<td>

<p>character string indicating the name of the data used to create the groups.
The default value is <code>group.name=deparse(substitute(group))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent.of.data</code></td>
<td>

<p>character string indicating the source of the data used for the goodness-of-fit tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset.expression</code></td>
<td>

<p>character string indicating the expression used to subset the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments affecting the goodness-of-fit test.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>gofGroupTest</code> performs a goodness-of-fit test for each group of 
data by calling the function <code>gofTest</code>.  Using the p-values from these 
goodness-of-fit tests, it then calls the function <code>gofTest</code> with the 
argument <code>test="ws"</code> to test whether the p-values appear to come from a 
Uniform [0,1] distribution.
</p>


<h3>Value</h3>

<p>a list of class <code>"gofGroup"</code> containing the results of the group goodness-of-fit test.  
Objects of class <code>"gofGroup"</code> have special printing and plotting methods.  
See the help file for <code>gofGroup.object</code> for details.
</p>


<h3>Note</h3>

<p>The Wilk-Shapiro (1968) tests for a Uniform [0, 1] distribution were introduced in the context 
of testing whether several independent samples all come from normal distributions, with 
possibly different means and variances.  The function <code>gofGroupTest</code> extends 
this idea to allow you to test whether several independent samples come from the same 
distribution (e.g., gamma, extreme value, etc.), with possibly different parameters.
</p>
<p>Examples of simultaneously assessing whether several groups come from the same distribution 
are given in USEPA (2009) and Gibbons et al. (2009).
</p>
<p>In practice, almost any goodness-of-fit test will <em>not</em> reject the null hypothesis 
if the number of observations is relatively small.  Conversely, almost any goodness-of-fit 
test <em>will</em> reject the null hypothesis if the number of observations is very large, 
since “real” data are never distributed according to any theoretical distribution 
(Conover, 1980, p.367).  For most cases, however, the distribution of “real” data 
is close enough to some theoretical distribution that fairly accurate results may be 
provided by assuming that particular theoretical distribution.  One way to asses the 
goodness of the fit is to use goodness-of-fit tests.  Another way is to look at 
quantile-quantile (Q-Q) plots (see <code>qqPlot</code>).
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
John Wiley &amp; Sons, Hoboken.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
U.S. Environmental Protection Agency, Washington, D.C. p.17-17.
</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>
<p>Wilk, M.B., and S.S. Shapiro. (1968). The Joint Assessment of Normality of Several Independent 
Samples. <em>Technometrics</em>, <b>10</b>(4), 825-839.
</p>


<h3>See Also</h3>

<p><code>gofTest</code>, <code>gofGroup.object</code>, <code>print.gofGroup</code>, 
<code>plot.gofGroup</code>, <code>qqPlot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Example 10-4 of USEPA (2009, page 10-20) gives an example of 
  # simultaneously testing the assumption of normality for nickel 
  # concentrations (ppb) in groundwater collected at 4 monitoring 
  # wells over 5 months.  The data for this example are stored in 
  # EPA.09.Ex.10.1.nickel.df.

  EPA.09.Ex.10.1.nickel.df
  #   Month   Well Nickel.ppb
  #1      1 Well.1       58.8
  #2      3 Well.1        1.0
  #3      6 Well.1      262.0
  #4      8 Well.1       56.0
  #5     10 Well.1        8.7
  #6      1 Well.2       19.0
  #7      3 Well.2       81.5
  #8      6 Well.2      331.0
  #9      8 Well.2       14.0
  #10    10 Well.2       64.4
  #11     1 Well.3       39.0
  #12     3 Well.3      151.0
  #13     6 Well.3       27.0
  #14     8 Well.3       21.4
  #15    10 Well.3      578.0
  #16     1 Well.4        3.1
  #17     3 Well.4      942.0
  #18     6 Well.4       85.6
  #19     8 Well.4       10.0
  #20    10 Well.4      637.0


  # Test for a normal distribution at each well:
  #--------------------------------------------

  gofGroup.list &lt;- gofGroupTest(Nickel.ppb ~ Well, 
    data = EPA.09.Ex.10.1.nickel.df)

  gofGroup.list

  #Results of Group Goodness-of-Fit Test
  #-------------------------------------
  #
  #Test Method:                     Wilk-Shapiro GOF (Normal Scores)
  #
  #Hypothesized Distribution:       Normal
  #
  #Data:                            Nickel.ppb
  #
  #Grouping Variable:               Well
  #
  #Data Source:                     EPA.09.Ex.10.1.nickel.df
  #
  #Number of Groups:                4
  #
  #Sample Sizes:                    Well.1 = 5
  #                                 Well.2 = 5
  #                                 Well.3 = 5
  #                                 Well.4 = 5
  #
  #Test Statistic:                  z (G) = -3.658696
  #
  #P-values for
  #Individual Tests:                Well.1 = 0.03510747
  #                                 Well.2 = 0.02385344
  #                                 Well.3 = 0.01120775
  #                                 Well.4 = 0.10681461
  #
  #P-value for
  #Group Test:                      0.0001267509
  #
  #Alternative Hypothesis:          At least one group
  #                                 does not come from a
  #                                 Normal Distribution.

  dev.new()
  plot(gofGroup.list)

  #----------

  # Test for a lognormal distribution at each well:
  #-----------------------------------------------

  gofGroupTest(Nickel.ppb ~ Well, data = EPA.09.Ex.10.1.nickel.df, 
    dist = "lnorm")

  #Results of Group Goodness-of-Fit Test
  #-------------------------------------
  #
  #Test Method:                     Wilk-Shapiro GOF (Normal Scores)
  #
  #Hypothesized Distribution:       Lognormal
  #
  #Data:                            Nickel.ppb
  #
  #Grouping Variable:               Well
  #
  #Data Source:                     EPA.09.Ex.10.1.nickel.df
  #
  #Number of Groups:                4
  #
  #Sample Sizes:                    Well.1 = 5
  #                                 Well.2 = 5
  #                                 Well.3 = 5
  #                                 Well.4 = 5
  #
  #Test Statistic:                  z (G) = 0.2401720
  #
  #P-values for
  #Individual Tests:                Well.1 = 0.6898164
  #                                 Well.2 = 0.6700394
  #                                 Well.3 = 0.3208299
  #                                 Well.4 = 0.5041375
  #
  #P-value for
  #Group Test:                      0.5949015
  #
  #Alternative Hypothesis:          At least one group
  #                                 does not come from a
  #                                 Lognormal Distribution.

  #----------
  # Clean up
  rm(gofGroup.list)
  graphics.off()
</code></pre>


</div>