<div class="container">

<table style="width: 100%;"><tr>
<td>mgammagpdcon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixture of Gammas Bulk and GPD Tail Extreme Value Mixture Model with Single Continuity Constraint</h2>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and
random number generation for the extreme value mixture model with mixture of gammas for bulk
distribution upto the threshold and conditional GPD for upper tail with continuity at threshold. The parameters
are the multiple gamma shapes <code>mgshape</code>, scales <code>mgscale</code> and <code>mgweights</code>, threshold <code>u</code>
GPD shape <code>xi</code> and tail fraction <code>phiu</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmgammagpdcon(x, mgshape = 1, mgscale = 1, mgweight = NULL,
  u = qgamma(0.9, mgshape[[1]], 1/mgscale[[1]]), xi = 0, phiu = TRUE,
  log = FALSE)

pmgammagpdcon(q, mgshape = 1, mgscale = 1, mgweight = NULL,
  u = qgamma(0.9, mgshape[[1]], 1/mgscale[[1]]), xi = 0, phiu = TRUE,
  lower.tail = TRUE)

qmgammagpdcon(p, mgshape = 1, mgscale = 1, mgweight = NULL,
  u = qgamma(0.9, mgshape[[1]], 1/mgscale[[1]]), xi = 0, phiu = TRUE,
  lower.tail = TRUE)

rmgammagpdcon(n = 1, mgshape = 1, mgscale = 1, mgweight = NULL,
  u = qgamma(0.9, mgshape[[1]], 1/mgscale[[1]]), xi = 0, phiu = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgshape</code></td>
<td>
<p>mgamma shape (positive) as list or vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgscale</code></td>
<td>
<p>mgamma scale (positive) as list or vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgweight</code></td>
<td>
<p>mgamma weights (positive) as list or vector (<code>NULL</code> for equi-weighted)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiu</code></td>
<td>
<p>probability of being above threshold <code class="reqn">[0, 1]</code> or <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if TRUE then log density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical, if FALSE then upper tail probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>cumulative probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size (positive integer)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extreme value mixture model combining mixture of gammas for the bulk
below the threshold and GPD for upper tail with continuity at threshold. 
</p>
<p>The user can pre-specify <code>phiu</code> permitting a parameterised value for the tail
fraction <code class="reqn">\phi_u</code>. Alternatively, when <code>phiu=TRUE</code> the tail fraction is
estimated as the tail fraction from the mixture of gammas bulk model.
</p>
<p>Suppose there are <code class="reqn">M&gt;=1</code> gamma components in the mixture model. If you 
wish to have a single (scalar) value for each parameter within each of the
<code class="reqn">M</code> components then these can be input as a vector of length <code class="reqn">M</code>. If
you wish to input a vector of values for each parameter within each of the
<code class="reqn">M</code> components, then they are input as a list with each entry the
parameter object for each component (which can either be a scalar or
vector as usual). No matter whether they are input as a vector or list there
must be <code class="reqn">M</code> elements in <code>mgshape</code> and <code>mgscale</code>, one for each
gamma mixture component. Further, any vectors in the list of parameters must
of the same length of the <code>x, q, p</code> or equal to the sample size <code>n</code>, where
relevant.
</p>
<p>If <code>mgweight=NULL</code> then equal weights for each component are assumed. Otherwise, 
<code>mgweight</code> must be a list of the same length as <code>mgshape</code> and 
<code>mgscale</code>, filled with positive values. In the latter case, the weights are rescaled
to sum to unity.
</p>
<p>The cumulative distribution function with tail fraction <code class="reqn">\phi_u</code> defined by the
upper tail fraction of the mixture of gammas bulk model (<code>phiu=TRUE</code>), upto the 
threshold <code class="reqn">0 &lt; x \le u</code>, given by:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = H(x)</code>
</p>

<p>and above the threshold <code class="reqn">x &gt; u</code>:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = H(u) + [1 - H(u)] G(x)</code>
</p>

<p>where <code class="reqn">H(x)</code> and <code class="reqn">G(X)</code> are the mixture of gammas and conditional GPD
cumulative distribution functions.
</p>
<p>The cumulative distribution function for pre-specified <code class="reqn">\phi_u</code>, upto the
threshold <code class="reqn">0 &lt; x \le u</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = (1 - \phi_u) H(x)/H(u)</code>
</p>

<p>and above the threshold <code class="reqn">x &gt; u</code>:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \phi_u + [1 - \phi_u] G(x)</code>
</p>

<p>Notice that these definitions are equivalent when <code class="reqn">\phi_u = 1 - H(u)</code>.
</p>
<p>The continuity constraint means that <code class="reqn">(1 - \phi_u) h(u)/H(u) = \phi_u g(u)</code>
where <code class="reqn">h(x)</code> and <code class="reqn">g(x)</code> are the mixture of gammas and conditional GPD
density functions respectively. The resulting GPD scale parameter is then:
</p>
<p style="text-align: center;"><code class="reqn">\sigma_u = \phi_u H(u) / [1 - \phi_u] h(u)</code>
</p>
<p>.
In the special case of where the tail fraction is defined by the bulk model this reduces to
</p>
<p style="text-align: center;"><code class="reqn">\sigma_u = [1 - H(u)] / h(u)</code>
</p>
<p>.
</p>
<p>The gamma is defined on the non-negative reals, so the threshold must be positive. 
Though behaviour at zero depends on the shape (<code class="reqn">\alpha</code>):
</p>

<ul>
<li> <p><code class="reqn">f(0+)=\infty</code> for <code class="reqn">0&lt;\alpha&lt;1</code>;
</p>
</li>
<li> <p><code class="reqn">f(0+)=1/\beta</code> for <code class="reqn">\alpha=1</code> (exponential);
</p>
</li>
<li> <p><code class="reqn">f(0+)=0</code> for <code class="reqn">\alpha&gt;1</code>;
</p>
</li>
</ul>
<p>where <code class="reqn">\beta</code> is the scale parameter.
</p>
<p>See <code>gammagpd</code> for details of simpler parametric mixture model
with single gamma for bulk component and GPD for upper tail.
</p>


<h3>Value</h3>

<p><code>dmgammagpdcon</code> gives the density, 
<code>pmgammagpdcon</code> gives the cumulative distribution function,
<code>qmgammagpdcon</code> gives the quantile function and 
<code>rmgammagpdcon</code> gives a random sample.
</p>


<h3>Acknowledgments</h3>

<p>Thanks to Daniela Laas, University of St Gallen, Switzerland for reporting various bugs in these functions.
</p>


<h3>Note</h3>

<p>All inputs are vectorised except <code>log</code> and <code>lower.tail</code>, and the gamma mixture
parameters can be vectorised within the list. The main inputs (<code>x</code>, <code>p</code> or <code>q</code>)
and parameters must be either a scalar or a vector. If vectors are provided they must all be
of the same length, and the function will be evaluated for each element of vector. In the case of 
<code>rmgammagpdcon</code> any input vector must be of length <code>n</code>.
</p>
<p>Default values are provided for all inputs, except for the fundamentals 
<code>x</code>, <code>q</code> and <code>p</code>. The default sample size for 
<code>rmgammagpdcon</code> is 1.
</p>
<p>Missing (<code>NA</code>) and Not-a-Number (<code>NaN</code>) values in <code>x</code>,
<code>p</code> and <code>q</code> are passed through as is and infinite values are set to
<code>NA</code>. None of these are not permitted for the parameters.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://www.math.canterbury.ac.nz/~c.scarrott/evmix">http://www.math.canterbury.ac.nz/~c.scarrott/evmix</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Gamma_distribution">http://en.wikipedia.org/wiki/Gamma_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Mixture_model">http://en.wikipedia.org/wiki/Mixture_model</a>
</p>
<p>McLachlan, G.J. and Peel, D. (2000). Finite Mixture Models. Wiley.
</p>
<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>do Nascimento, F.F., Gamerman, D. and Lopes, H.F. (2011). A semiparametric
Bayesian approach to extreme value estimation. Statistical Computing, 22(2), 661-675.
</p>


<h3>See Also</h3>

<p><code>gpd</code> and <code>dgamma</code>
</p>
<p>Other gammagpdcon: <code>fgammagpdcon</code>,
<code>fgammagpd</code>, <code>fmgammagpdcon</code>,
<code>gammagpdcon</code>, <code>gammagpd</code>
</p>
<p>Other mgamma: <code>fmgammagpdcon</code>,
<code>fmgammagpd</code>, <code>fmgamma</code>,
<code>mgammagpd</code>, <code>mgamma</code>
</p>
<p>Other mgammagpd: <code>fgammagpd</code>,
<code>fmgammagpdcon</code>, <code>fmgammagpd</code>,
<code>fmgamma</code>, <code>gammagpd</code>,
<code>mgammagpd</code>, <code>mgamma</code>
</p>
<p>Other mgammagpdcon: <code>fgammagpdcon</code>,
<code>fmgammagpdcon</code>, <code>fmgammagpd</code>,
<code>fmgamma</code>, <code>gammagpdcon</code>,
<code>mgammagpd</code>, <code>mgamma</code>
</p>
<p>Other fmgammagpdcon: <code>fmgammagpdcon</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(1, 1))

x = rmgammagpdcon(1000, mgshape = c(1, 6), mgscale = c(1, 2), mgweight = c(1, 2), u = 15, xi = 0)
xx = seq(-1, 40, 0.01)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 40))
lines(xx, dmgammagpdcon(xx, mgshape = c(1, 6), mgscale = c(1, 2), mgweight = c(1, 2),
 u = 15, xi = 0))
abline(v = 15)

## End(Not run)

</code></pre>


</div>