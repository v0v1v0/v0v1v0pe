<div class="container">

<table style="width: 100%;"><tr>
<td>IVProbitRob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Probit Model with Endogeneity
</h2>

<h3>Description</h3>

<p>Compute robust two-stage estimates of probit model with endogeneity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IVProbitRob(reduced, outcome, data, control = rob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reduced</code></td>
<td>

<p>formula, the reduced function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>

<p>formula, the outcome function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data fram containing the varaibles in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>IVProbitRob</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameters for controlling the fitting process.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute robust two-step estimates of the endogenous probit model.
</p>


<h3>Value</h3>

<p>Object of class "epmrob".
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>References</h3>

<p>Naghi, A. A., Varadi, M., &amp; Zhelonkin, M. (2022). Robust Estimation of Probit Models with Endogeneity. <em>Econometrics and Statistics</em>. <a href="https://doi.org/10.1016/j.ecosta.2022.05.001">doi:10.1016/j.ecosta.2022.05.001</a>
</p>


<h3>See Also</h3>

<p><code>epmrob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)
N &lt;- 2000
M &lt;- 500
cont.frac = 0.01
rho = 0.5
sigma = matrix(c(1, rho, rho, 1), 2, 2)
gamma1 = 1
gamma2 = c(0.6, 0.4) 
alpha1 = c(0.5)
beta1 = 0.5

set.seed(123)
X1 = rnorm(N,0,1)
X2 = rnorm(N,0,1)
X3 = rnorm(N,0,1)
eps = rmvnorm(N, mean =rep(0,2), sigma = sigma)
Y1 = X1*gamma1 + X2*gamma2[1] + X3*gamma2[2]  + eps[,1]
Y2 = ifelse(X1*beta1 + Y1*alpha1 + eps[,2] &gt; 0, 1, 0)

dat.exmpl &lt;- data.frame(Y2, Y1, X1, X2, X3)
names(dat.exmpl) &lt;- c("int", "endo", "exo", "ivrbl", "ivrbl2")
ivp.fit &lt;- IVProbitRob(endo ~ exo + ivrbl + ivrbl2, int ~ endo + exo, data = dat.exmpl, 
                       control = rob.control(weights.x1 = "hat", weights.x2 = "hat"))
ivp.fit
</code></pre>


</div>