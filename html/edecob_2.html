<div class="container">

<table style="width: 100%;"><tr>
<td>conf_band</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence Bounds of the Smoother</h2>

<h3>Description</h3>

<p>Calculate the confidence bounds of the smoother function using the bootstrap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conf_band(bt_smoother, smoother_pts, bt_tot_rep, conf_band_lvl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bt_smoother</code></td>
<td>
<p>A data frame containing the bootstrapped smoother. Use the output of <code>bt_smoother</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoother_pts</code></td>
<td>
<p>A data frame containing the smoother. Preferably the
output of one of the smoother functions included in this package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bt_tot_rep</code></td>
<td>
<p>The number of iterations for the bootstrap computation. Because of
run time, it is recommended to keep this number below 500. Defaults to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_band_lvl</code></td>
<td>
<p>The confidence level for the simultaneous confidence
bands. Defaults to 0.95. When detection of events using only the smoother
is desired, <code>conf_band_lvl</code> can be chosen to be 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure is as follows:
</p>

<ol>
<li>
<p> We compute the quantiles </p>
<p style="text-align: center;"><code class="reqn"> q_x(t_i), q_{1-x}(t_i) i = 1,\dots, N</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">q_x(t_i) = inf\left\{u; P^*[S(t_i)^*_b - S(t_i) \le u] \ge x\right\} </code>
</p>
<p> is a
pointwise bootstrap quantile, <code class="reqn">S(t_i)^*_b</code> the bootstrapped smoother,
and <code class="reqn">N</code> the number of measurements or rows in <code>data</code>, in our case the number of rows.
</p>
</li>
<li>
<p> We vary the pointwise error <code class="reqn">x</code> until </p>
<p style="text-align: center;"><code class="reqn">P^*[q_x(t_i) \le S(t_i)^*_b - S(t_i) \le q_{1-x}(t_i) \forall i = 1,\dots, N] \approx 1-\alpha.</code>
</p>

<p>In other words, until the ratio of bootstrap curves that have all their points within
<code class="reqn">[q_x(t_i), q_{1-x}(t_i)]</code> is approximately <code class="reqn">1-\alpha</code>.
</p>
</li>
<li>
<p> We define
</p>
<p style="text-align: center;"><code class="reqn"> I_n(t_i) = [S(t_i) +  q_x(t_i), S(t_i) + q_{1-x}(t_i)] \forall i = 1,\dots, N</code>
</p>

<p>the confidence bounds. Then <code class="reqn">{I_n(t_i); i = 1,\dots, N}</code> is a consistent simultaneous confidence band of level <code class="reqn">1-\alpha</code>.
</p>
</li>
</ol>
<h3>Value</h3>

<p>A data frame containing the upper confidence bound, the lower confidence bound,
and the time point corresponding to the bounds.
</p>


<h3>References</h3>

<p>BÃ¼hlmann, P. (1998). Sieve Bootstrap for Smoothing in
Nonstationary Time Series. <em>The Annals of Statistics</em>, 26(1), 48-83.
</p>


</div>