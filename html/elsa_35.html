<div class="container">

<table style="width: 100%;"><tr>
<td>lisa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local indicators of Spatial Associations</h2>

<h3>Description</h3>

<p>Calculate local indicators of spatial association (LISA) for a continuous (numeric) variable at each location in a Raster layer or a SpatialPointsDataFrame or a SpatialPolygonsDataFrame.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lisa(x,d1,d2,statistic,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1</code></td>
<td>
<p> numeric lower bound of local distance (default=0), or an object of class neighbours created by dneigh when x is SpatialPoints or SpatialPolygons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2</code></td>
<td>
<p> numeric upper bound of local distance, not needed if d1 is a neighbours object,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p> a character string specifying the LISA statistic that should be calculated. This can be one of "I" (or "localmoran" or "moran"), "c" (or "localgeary" or "geary"), "G" (or "localG"), "G*" (or "localG*")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments including <code>filename</code> (only when x is Raster, specifies the name of the raster file when the output should be written; additional arguments for <code>writeRaster</code> function can also be specified);
<code>mi</code> (only when x is Raster and <code>statistic='I'</code>, specifies whether raw Local Moran's I statistic (Ii) should be returned, or standardized value (Z.Ii). e.g., mi="I", mi='Z' (default)); 
<code>zcol</code> (only when x is a Spatial* object specifies the name of the variable column in the data); 
<code>longlat</code> (logical, only when x is a Spatial* object specifies whether the coordinate system is geographic); 
<code>drop</code> (logical, only when x is a Spatial* object, if TRUE, the original data structure (Spatial* object) is returned, otherwise a numeric vector is returned) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can calculate different LISA statistics at each location in the input dataset. The statistics, implemented in this function, include local Moran's I ("I"), local Geary's c ("c"), local G and G* ("G" and "G*"). This function returns standardized value (Z) for Moran, G and G*.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RasterLayer</code></td>
<td>
<p>if <code>x</code> is a <code>RasterLayer</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spatial*</code></td>
<td>
<p>if <code>x</code> is a <code>Spatial*</code> and <code>drop=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numeric vector</code></td>
<td>
<p>if <code>x</code> is a <code>Spatial*</code> and <code>drop=TRUE</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
Anselin, L. 1995. Local indicators of spatial association, Geographical Analysis, 27, 93–115;
</p>
<p>Getis, A. and Ord, J. K. 1996 Local spatial statistics: an overview. In P. Longley and M. Batty (eds) <em>Spatial analysis: modelling in a GIS environment</em> (Cambridge: Geoinformation International), 261–277.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)

plot(r,main='a continuous raster map')

mo &lt;- lisa(r,d2=2000,statistic='i') # local moran's I (Z.Ii value)

plot(mo, main="local Moran's I (Z.Ii)")

mo &lt;- lisa(r,d2=2000,statistic='i',mi='I') # local moran's I (Ii value  (non-standardized))

plot(mo, main="local Moran's I (Ii))")

gc &lt;- lisa(r,d2=2000,statistic='c') # local Geary's c

plot(gc, main="local Geary's c")

g &lt;- lisa(r,d2=2000,statistic='g') # local G

plot(g, main="local G")


</code></pre>


</div>