<div class="container">

<table style="width: 100%;"><tr>
<td>power.exact.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power Calculations for 2x2 Tables with Independent Samples</h2>

<h3>Description</h3>

<p>Calculates the power of the design for known sample sizes and true probabilities.</p>


<h3>Usage</h3>

<pre><code class="language-R">power.exact.test(p1, p2, n1, n2, alternative = c("two.sided", "less", "greater"),
    alpha = 0.05, npNumbers = 100, np.interval = FALSE, beta = 0.001,
    method = c("z-pooled", "z-unpooled", "boschloo", "santner and snell", "csm",
               "fisher", "pearson chisq", "yates chisq"),
    tsmethod = c("square", "central"), simulation = FALSE, nsim = 100,
    delta = 0, convexity = TRUE, useStoredCSM = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>The probability of success given in first group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>The probability of success given in second group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>The sample size in first group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>The sample size in second group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Indicates the alternative hypothesis: must be either "two.sided", "less", or "greater"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npNumbers</code></td>
<td>
<p>Number: The number of nuisance parameters considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np.interval</code></td>
<td>
<p>Logical: Indicates if a confidence interval on the nuisance parameter should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Number: Confidence level for constructing the interval of nuisance parameters considered.  Only used if np.interval=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Indicates the method for finding more extreme tables:
must be either "Z-pooled", "Z-unpooled", "Santner and Snell", "Boschloo", "CSM", "Fisher", "Pearson Chisq", or "Yates Chisq"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsmethod</code></td>
<td>
<p>Indicates two-sided method: must be either "square" or "central"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation</code></td>
<td>
<p>Logical: Indicates if the power calculation is exact or estimated by simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations run.  Only used if simulation=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Number: null hypothesis of the difference in proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convexity</code></td>
<td>
<p>Logical: assumes convexity for interval approach.  Only used if np.interval=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useStoredCSM</code></td>
<td>
<p>Logical: uses stored CSM ordering matrix.  Only used if method="csm"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power calculations are for binomial models with independent samples.  The design must know the fixed sample sizes in advance.  There are (n1+1) x (n2+1) possible tables that could be produced.  There are two ways to calculate the power: simulate the tables under two independent binomial distributions or determine the rejection region for all possible tables and calculate the exact power.  The calculations can be done using any <code>exact.test</code> computation, Fisher's exact test, or chi-square tests (Yates' or Pearson's; note: these are not exact tests).  The power calculations utilize the convexity property, which greatly speeds up computation time (see <code>exact.reject.region</code> documentation).
</p>


<h3>Value</h3>

<p>A list with class "power.htest" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n1, n2</code></td>
<td>
<p>The respective sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1, p2</code></td>
<td>
<p>The respective success probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Power of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string describing the alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Null hypothesis of the difference in proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string describing the method to determine more extreme tables</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Pearson's and Yates' chi-square tests are not exact tests, so the function name may be a misnomer.  These tests may have inflated type 1 error rates.  These options were added to compute the power efficiently when using asymptotic tests.
</p>


<h3>Author(s)</h3>

<p>Peter Calhoun</p>


<h3>References</h3>

<p>Berger, R. (1994) Power comparison of exact unconditional tests for comparing two binomial proportions. <em>Institute of Statistics Mimeo Series No. 2266</em>
</p>
<p>Berger, R. (1996) More powerful tests from confidence interval p values. <em>American Statistician</em>, <b>50</b>, 314-318
</p>
<p>Boschloo, R. D. (1970), Raised Conditional Level of Significance for the 2x2-table when Testing the Equality of Two Probabilities. <em>Statistica Neerlandica</em>, <b>24</b>, 1-35
</p>


<h3>See Also</h3>

<p><code>exact.reject.region</code> and <span class="pkg">statmod</span></p>


<h3>Examples</h3>

<pre><code class="language-R"># Superiority power #
power.exact.test(p1=0.15, p2=0.60, n1=15, n2=30, method="Z-pooled")
power.exact.test(p1=0.15, p2=0.60, n1=15, n2=30, method="Fisher")
power.exact.test(p1=0.15, p2=0.60, n1=15, n2=30, method="Boschloo",
                 np.interval=TRUE, beta=0.001)
## Not run: 
# Ensure that the ExactData R package is available before running the CSM test.
if (requireNamespace("ExactData", quietly = TRUE)) {
power.exact.test(p1=0.15, p2=0.60, n1=15, n2=30, method="CSM")
}

## End(Not run)

# Non-inferiority power #
power.exact.test(p1=0.30, p2=0.30, n1=65, n2=65, method="Z-pooled",
                 delta=0.2, alternative="less")
</code></pre>


</div>