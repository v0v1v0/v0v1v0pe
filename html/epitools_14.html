<div class="container">

<table style="width: 100%;"><tr>
<td>epicurve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Construct an epidemic curve
</h2>

<h3>Description</h3>

<p>Construct an epidemic curve
</p>


<h3>Usage</h3>

<pre><code class="language-R">epicurve.dates(x, format = "%Y-%m-%d", strata = NULL,
               min.date, max.date, before = 7, after = 7,
               width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE, ...)

epicurve.weeks(x, format = "%Y-%m-%d", strata = NULL,
               min.date, max.date, before = 7, after = 7,
               width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE,
               origin = as.Date("1970-01-01"), sunday = TRUE, ...)

epicurve.months(x, format = "%Y-%m-%d", strata = NULL,
                min.date, max.date, before = 31, after = 31,
                width = 1, space = 0, tick = TRUE,
                tick.offset = 0.5, segments = FALSE,
                origin = as.Date("1970-01-01"), ...)

epicurve.hours(x, mindt, maxdt, strata = NULL, half.hour = FALSE,
               width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE, ...) 

epicurve.table(x, width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE, ...)
  

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>character vector of dates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>

<p>date format of <code>x</code>; default is of form "2004-08-10" 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>

<p>[optional] categorical vector (character or factor) for stratifying
<code>x</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.date</code></td>
<td>

<p>[optional] minimum calendar date for plotting x-axis of an epidemic
curve; should be of the form of "2004-08-10"; if no date is
specified, then several days are subtracted from the minimum date in
<code>x</code> as specified by the <code>before</code> option
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.date</code></td>
<td>

<p>[optional] maximum calendar date for plotting x-axis of an epidemic
curve; should be of the form of "2004-08-10"; if no date is
specified, then several days are added to the maximum date in
<code>x</code> as specified by the <code>after</code> option
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>before</code></td>
<td>

<p>if <code>min.date</code> is not specified, then these number of days are
subtracted from the minimum date in <code>x</code> for plotting minimum
calendar date for epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>after</code></td>
<td>

<p>if <code>max.date</code> is not specified, then these number of days are
added to the maximum date in <code>x</code> for plotting maximum calendar
date for epidemic curve 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindt</code></td>
<td>

<p>[required] Date-time object in standard format that will form the
lower boundary of the hour or half-hour time categories. The
<code>mindt</code> option must less than or equal to the minimum value in
<code>x</code>, and must be rounded off to the nearst hour for hour
categories (e.g., HH:00:00) or rounded  off to the nearest half-hour
for half-hour categories (e.g., HH:30:00). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdt</code></td>
<td>

<p>[required] Date-time object in standard format that will form the
upper boundary of the hour or half-hour time categories. The
<code>maxdt</code> option must greater than or equal to the minimum value
in <code>x</code>, and must be rounded off to the nearst hour for hour
categories (e.g., HH:00:00) or rounded off to the nearest half-hour
for half-hour categories (e.g., HH:30:00). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>half.hour</code></td>
<td>

<p>Set to TRUE for half-hour categories in <code>epicurve.hours</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>

<p>width of bars in the epidemic curve; this value is passed to
<code>barplot</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>

<p>space between bars in the epidemic curve; this value is passed to
<code>barplot</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick</code></td>
<td>

<p>adds tick marks to the x-axis (default = TRUE)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick.offset</code></td>
<td>

<p>offsets tick marks so that they plotted between the bars 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>

<p>segments bars so that each box represents one case
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>

<p>allows user to specify an alternative origin for Julian dates that
are generated by this function (default = "1970-01-01")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sunday</code></td>
<td>

<p>First day of the week is Sunday (default = TRUE); setting to FALSE
makes Monday the first day of the week
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>options are passed to the <code>barplot</code> function
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions makes plotting epidemic curves much easier in
R. Normally, to plot an epidemic curve in R, one must do the
following: (1) have disease onset dates in some calendar date format,
(2) convert these onset dates into a factor with the levels specified
by the range of calendar dates for the x-axis of the epidemic curve,
(3) convert this factor into a table (with or without stratification),
(4) use this table as an argument in the <code>barplot</code> function to plot the
epidemic curve, and (5) make final adjustments (labels, titles, etc.).
</p>
<p>Why use the <code>barplot</code> function? Strictly speaking, an epidemic
curve is a histogram displaying the distribution of onset times which
are categorized into, for example, dates. However, histogram functions
seems to work better for measurements that our continuous (e.g.,
height, weight). In contrast, epidemic curves are constructed from
onset time data that has been categorized into days, weeks, or
months. For this type of categorical data, the <code>barplot</code> does a
better job. The caveat, however, is that we need to specify the range
of possible calendar dates, weeks, or months in order to construct an
appropriate plot. To do this we convert the data into a factor with
the levels specified by the possible calendar date values.
</p>
<p>To make this whole process much easier, and to generate additional
data that can be use for labeling your epidemic curve, the
<code>epicurve</code> functions were created.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epicurve.dates</code></td>
<td>
<p>returns list:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$dates2</code></td>
<td>

<p>input dates are also converted to a factor with levels determined by
the calendar dates (<code>$cdates</code>) used to plot the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cdates</code></td>
<td>

<p>the calendar dates used for plotting the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of the epidemic curve  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epicurve.weeks</code></td>
<td>
<p>returns list:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$firstday</code></td>
<td>

<p>first day of the week is reported
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$week</code></td>
<td>

<p>week of the year (1-53); note that week 52 or 53 can represent both
last week of a year but also the first few days at the beginning of
the year 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$week</code> value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum2</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$week</code> value
converted to a factor with levels determined by the Julian dates
(<code>$cstratum</code>) used to plot the epidemic curve 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum3</code></td>
<td>

<p>the mid-week day of the <code>$week</code> value converted to standard
calendar dates  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cweek</code></td>
<td>

<p>the week of the year used for plotting the x-axis of the epidemic
curve    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cstratum</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$cweek</code> value used
for plotting the x-axis of the epidemic curve 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cstratum2</code></td>
<td>

<p>the standard calendar date for the mid-week day of the <code>$cweek</code>
value used for plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of the epidemic curve 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epicurve.months</code></td>
<td>
<p>returns list:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$mon</code></td>
<td>

<p>month of the year (1-12)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$month</code></td>
<td>

<p>month of the year (Jan, Feb, Mar, ...)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$mon</code> value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum2</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$mon</code> value
converted to a factor with levels determined by the Julian dates
(<code>$cstratum</code>)used to plot the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum3</code></td>
<td>

<p>the mid-month day of the <code>$mon</code> value converted to standard
calendar dates  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmon</code></td>
<td>

<p>the month of the year (1-12) used for plotting the x-axis of the
epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cstratum</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$cmonth</code> value
used for plotting the x-axis of the epidemic curve 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cstratum2</code></td>
<td>

<p>the standard calendar date for the mid-month day of the
<code>$cmonth</code> value used for plotting the x-axis of the epidemic
curve      
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of the epidemic curve 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epicurve.hours</code></td>
<td>
<p>returns list:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$ct</code></td>
<td>

<p>Date-time object that contains the number of seconds since the
beginning of 1970 as a numeric vector and produced by
<code>as.POSIXct</code>. You can use <code>as.POSIXlt</code> to
convert this output in human legible (already done by this
function). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$sec</code></td>
<td>
<p>seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$min</code></td>
<td>
<p>minutes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$hour</code></td>
<td>
<p>hours (0-23)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$hour12</code></td>
<td>
<p>hours (1-12)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum</code></td>
<td>
<p>number of hours or 1/2 hours since beginning of 1970</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum2</code></td>
<td>

<p>factor (categorical variable) with number of hours of 1/2 hours
since beginning of 1970 using <code>$cstratum</code> as the levels
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$stratum3</code></td>
<td>

<p>factor (categorical variable) in standard date-time format
indicating number of hours or 1/2 hours since beginning of 1970
using 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$xvals</code></td>
<td>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cstratum</code></td>
<td>
<p>levels for creating <code>$stratum2</code> factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cstratum2</code></td>
<td>
<p>levels for creating <code>$stratum3</code> factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$csec</code></td>
<td>
<p>seconds from <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmin</code></td>
<td>
<p>minutes from <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$chour</code></td>
<td>
<p>hours from <code>$cstratum2</code> in 24-hour format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$chour12</code></td>
<td>
<p>hours from <code>$cstratum2</code> in 12-hour format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$campm</code></td>
<td>
<p>corresponding 'AM' or 'PM' for <code>$chour12</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$campm2</code></td>
<td>
<p>corresponding 'am' or 'pm' for <code>$chour12</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cweekday</code></td>
<td>
<p>day of the week for <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cwkday</code></td>
<td>
<p>abbreviated day of the week for <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmday</code></td>
<td>
<p>day of the month for <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmonth</code></td>
<td>
<p>month for <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cmon</code></td>
<td>
<p>abbreviated month for <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cyear</code></td>
<td>
<p>year for <code>$cstratum2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$half.hour</code></td>
<td>

<p>FALSE (default) for 1-hour categories; TRUE for 1/2-hour categories
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epicurve.table</code></td>
<td>
<p>returns numeric vector:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function 
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code>barplot</code>, <code>strptime</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##epicurve.dates
sampdates &lt;- seq(as.Date("2004-07-15"), as.Date("2004-09-15"), 1)
x &lt;- sample(sampdates, 100, rep=TRUE)
xs &lt;- sample(c("Male","Female"), 100, rep=TRUE)
epicurve.dates(x)
epicurve.dates(x, strata = xs)
rr &lt;- epicurve.dates(x, strata = xs, segments = TRUE,
                     axisnames = FALSE)
axis(1, at = rr$xvals, labels = rr$cmday, tick = FALSE, line = 0)
axis(1, at = rr$xvals, labels = rr$cmonth, tick = FALSE, line = 1)

##epicurve.weeks
sampdates &lt;- seq(as.Date("2004-07-15"), as.Date("2004-09-15"), 1)
x &lt;- sample(sampdates, 100, rep=TRUE)
xs &lt;- sample(c("Male","Female"), 100, rep=TRUE)
epicurve.weeks(x)

epicurve.weeks(x, strata = xs)

rr &lt;- epicurve.weeks(x, strata = xs, segments = TRUE)
rr


##epicurve.months
dates &lt;- c("1/1/04", "1/2/04", "1/3/04", "1/4/04", "1/5/04",
"1/6/04", "1/7/04", "1/8/04", "1/9/04", "1/10/04", NA, "1/12/04",
"1/14/04", "3/5/04", "5/5/04", "7/6/04", "8/18/04", "12/13/05",
"1/5/05", "4/6/05", "7/23/05", "10/3/05")
aw &lt;- as.month(dates, format = "%m/%d/%y")
aw
aw2 &lt;- as.month(dates, format = "%m/%d/%y", min.date="2003-01-01")
aw2

##epicurve.hours
data(oswego)
## create vector with meal date and time
mdt &lt;- paste("4/18/1940", oswego$meal.time)
mdt[1:10]
## convert into standard date and time
meal.dt &lt;- strptime(mdt, "%m/%d/%Y %I:%M %p")
meal.dt[1:10]
## create vector with onset date and time
odt &lt;- paste(paste(oswego$onset.date,"/1940",sep=""), oswego$onset.time)
odt[1:10]
## convert into standard date and time
onset.dt &lt;- strptime(odt, "%m/%d/%Y %I:%M %p")
onset.dt[1:10]      

##set colors
col3seq.d &lt;- c("#43A2CA", "#A8DDB5", "#E0F3DB")

par.fin &lt;- par()$fin
par(fin=c(5,3.4))

##1-hour categories
xv &lt;- epicurve.hours(onset.dt, "1940-04-18 12:00:00", "1940-04-19 12:00:00",
                     axisnames = FALSE, axes = FALSE, ylim = c(0,11),
                     col = col3seq.d[1], segments =  TRUE,
                     strata = oswego$sex)

hh &lt;- xv$chour12==3 | xv$chour12== 6 | xv$chour12== 9
hh2 &lt;- xv$chour12==12
hh3 &lt;- xv$chour12==1
hlab &lt;- paste(xv$chour12,xv$campm2,sep="")
hlab2 &lt;- paste(xv$cmonth,xv$cmday)
axis(1, at = xv$xval[hh], labels = xv$chour12[hh], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh2], labels = hlab[hh2], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh3], labels = hlab2[hh3], tick = FALSE, line = 1.0)
axis(2, las = 1)
title(main = "Figure 1. Cases of Gastrointestinal Illness
by Time of Onset of Symptoms (Hour Category)
Oswego County, New York, April 18-19, 2004",
      xlab = "Time of Onset",
      ylab = "Cases")

##1/2-hour categories
xv &lt;- epicurve.hours(onset.dt, "1940-04-18 12:00:00", "1940-04-19 12:00:00",
                     axisnames = FALSE, axes = FALSE, ylim = c(0,11),
                     col = col3seq.d[1], segments =  TRUE,
                     half.hour = TRUE, strata = oswego$sex)
hh &lt;- xv$chour12==3 | xv$chour12== 6 | xv$chour12== 9
hh2 &lt;- xv$chour12==12
hh3 &lt;- xv$chour12==1
hlab &lt;- paste(xv$chour12,xv$campm2,sep="")
hlab2 &lt;- paste(xv$cmonth,xv$cmday)
axis(1, at = xv$xval[hh], labels = xv$chour12[hh], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh2], labels = hlab[hh2], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh3], labels = hlab2[hh3], tick = FALSE, line = 1.0)
axis(2, las = 1)
title(main = "Figure 2. Cases of Gastrointestinal Illness
by Time of Onset of Symptoms (1/2 Hour Category)
Oswego County, New York, April 18-19, 2004",
      xlab = "Time of Onset",
      ylab = "Cases")

par(fin=par.fin)


##epicurve.table
xvec &lt;- c(1,2,3,4,5,4,3,2,1)
epicurve.table(xvec)

names(xvec) &lt;- 1991:1999
epicurve.table(xvec)

xmtx &lt;- rbind(xvec, xvec)
rownames(xmtx) &lt;- c("Male", "Female")
epicurve.table(xmtx)

epicurve.table(xmtx, seg = TRUE)


</code></pre>


</div>