<div class="container">

<table style="width: 100%;"><tr>
<td>movpotential_ews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moving Average Potential</h2>

<h3>Description</h3>

<p>This function reconstructs a potential derived from data along a gradient of a given parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">movpotential_ews(
  X,
  param = NULL,
  bw = "nrd",
  bw.adjust = 1,
  detection.threshold = 0.1,
  std = 1,
  grid.size = 50,
  plot.cutoff = 0.5,
  plot.contours = TRUE,
  binwidth = 0.2,
  bins = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a vector of the X observations of the state variable of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>parameter values corresponding to the observations in X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth for smoothing kernels. Automatically determined by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw.adjust</code></td>
<td>
<p>Bandwidth adjustment constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detection.threshold</code></td>
<td>
<p>Threshold for local optima to be discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>Standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.size</code></td>
<td>
<p>number of evaluation points; number of steps between min and max potential; also used as kernel window size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cutoff</code></td>
<td>
<p>cuttoff for potential minima and maxima in visualization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.contours</code></td>
<td>
<p>Plot contours on the landscape visualization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>binwidth for contour plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>bins for contour plot. Overrides binwidth if given</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
pars values of the covariate parameter as matrix;
xis values of the x as matrix;
pots smoothed potentials;
mins minima in the densities (-potentials; neglecting local optima);
maxs maxima in densities (-potentials; neglecting local optima);
plot an object that displays the potential estimated in 2D
</p>


<h3>Author(s)</h3>

<p>L. Lahti, E. van Nes, V. Dakos.
</p>


<h3>References</h3>

<p>Hirota, M., Holmgren, M., van Nes, E.H. &amp; Scheffer, M. (2011). Global resilience of tropical forest and savanna to critical transitions. <em>Science</em>, 334, 232-235.
</p>


<h3>Examples</h3>

<pre><code class="language-R">X &lt;- c(rnorm(1000, mean = 0), rnorm(1000, mean = -2), rnorm(1000, mean = 2));
param &lt;- seq(0,5,length=3000); 
res &lt;- movpotential_ews(X, param)
</code></pre>


</div>