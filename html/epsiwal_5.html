<div class="container">

<table style="width: 100%;"><tr>
<td>pconnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pconnorm .</h2>

<h3>Description</h3>

<p>CDF of the conditional normal variate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pconnorm(y, A, b, eta, mu = NULL, Sigma = NULL, Sigma_eta = Sigma
  %*% eta, eta_mu = as.numeric(t(eta) %*% mu), lower.tail = TRUE,
  log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an <code class="reqn">n</code> vector, assumed multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>an <code class="reqn">k \times n</code> matrix of constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a <code class="reqn">k</code> vector of inequality limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of the test contrast, <code class="reqn">\eta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>an <code class="reqn">n</code> vector of the population mean, <code class="reqn">\mu</code>.
Not needed if <code>eta_mu</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>an <code class="reqn">n \times n</code> matrix of the population covariance, <code class="reqn">\Sigma</code>.
Not needed if <code>Sigma_eta</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of <code class="reqn">\Sigma \eta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_mu</code></td>
<td>
<p>the scalar <code class="reqn">\eta^{\top}\mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the CDF of the truncated normal conditional
on linear constraints, as described in section 5 of Lee <em>et al.</em>
</p>
<p>Let <code class="reqn">y</code> be multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>. Conditional on <code class="reqn">Ay \le b</code>
for conformable matrix <code class="reqn">A</code> and vector <code class="reqn">b</code> we compute the
CDF of a truncated normal maximally aligned with <code class="reqn">\eta</code>. 
Inference depends on the population parameters only via 
<code class="reqn">\eta^{\top}\mu</code> and <code class="reqn">\Sigma \eta</code>,
and only these need to be given.
</p>
<p>The test statistic is aligned with <code class="reqn">y</code>, meaning that an output
p-value near one casts doubt on the null hypothesis that 
<code class="reqn">\eta^{\top}\mu</code> is less than the posited value.
</p>


<h3>Value</h3>

<p>The CDF.
</p>


<h3>Note</h3>

<p>An error will be thrown if we do not observe <code class="reqn">A y \le b</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee, J. D., Sun, D. L., Sun, Y. and Taylor, J. E. "Exact post-selection inference, 
with application to the Lasso." Ann. Statist. 44, no. 3 (2016): 907-927.
doi:10.1214/15-AOS1371. <a href="https://arxiv.org/abs/1311.6238">https://arxiv.org/abs/1311.6238</a>
</p>


<h3>See Also</h3>

<p>the confidence interval function, <code>ci_connorm</code>.
</p>


</div>