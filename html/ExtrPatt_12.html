<div class="container">

<table style="width: 100%;"><tr>
<td>wrapper.EPI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wrapper function</h2>

<h3>Description</h3>

<p>Handles all steps for estimation of EPI from raw-data:
1) Preprocessing into Frechet-Margins
2) Estimation of TPDM
3) Calculation of Principal Components
4) Estimation of EPI
</p>


<h3>Usage</h3>

<pre><code class="language-R">wrapper.EPI(
  X,
  Y = NULL,
  q = 0.98,
  anz_cores = 1,
  clust = NULL,
  m = 1:10,
  thr_EPI = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A t x n dimensional Data-matrix with t: Number of time steps and n: Number of grid points/stations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Optional: Sames as X but for second variable: If Y!=NULL, cross-TPDM instead of TPDM and SVD instead of PCA is computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Threshold for computation of TPDM. Only data above the 'q'-quantile will be used for estimation. Choose such that 0 &lt; q &lt; 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anz_cores</code></td>
<td>
<p>Number of cores for parallel computing (default: 5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>
<p>Optional_ Uf clust = NULL, no declustering is performed. Else, declustering according to cluster-length 'clust'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Numeric vector: Containing the principal components/expansion coefficients (in case of Y!=NULL) from which the EPI shall be computed (default: modes = c(1:10), calculates the EPI on first ten principle Components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr_EPI</code></td>
<td>
<p>Only if Y!=NULL: Threshold for computation of TEPI. Expansion-coefficients that exceed the 'q'-quantile will be used for estimation. Choose such that 0 &lt; q &lt; 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In case of Y =NULL: A list containing:
</p>

<ul>
<li>
<p> basis: The Eigenvectors of TPDM
</p>
</li>
<li>
<p> pc: The principal components of TPDM
</p>
</li>
<li>
<p> extremal.basis: The Eigenvectors of TPDM but transformed in positive reals with trans
</p>
</li>
<li>
<p> EPI: Extremal pattern index
</p>
</li>
</ul>
<p>In case of Y !=NULL: A list containing:
</p>

<ul>
<li>
<p> U, V: The left- and right singular Vectors of cross-TPDM
</p>
</li>
<li>
<p> extr.U, extr.V: The left- and right singular vectors of cross-TPDM, but transformed in positive reals with trans
</p>
</li>
<li>
<p> pcU, pcV: The left- and right expansion coefficients of cross-TPDM
</p>
</li>
<li>
<p> EPI: Extremal pattern index
</p>
</li>
<li>
<p> TEPI: Threshold-based extremal pattern index
</p>
</li>
</ul>
<h3>References</h3>

<p>Szemkus &amp; Friederichs 2023
</p>


<h3>Examples</h3>

<pre><code class="language-R">data    &lt;- precipGER

result  &lt;- wrapper.EPI(data$pr, m = 1:50)

rbPal &lt;- colorRampPalette(c('blue', 'white','red'))
Col &lt;- rbPal(10)[as.numeric(cut(result$basis[,2],breaks = 10))]
plot(data$lat, data$lon,col=Col)
plot(data$date, result$EPI, type='l')
</code></pre>


</div>