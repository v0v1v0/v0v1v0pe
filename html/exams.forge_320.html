<div class="container">

<table style="width: 100%;"><tr>
<td>sumofsquares</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sum of Squared Integers</h2>

<h3>Description</h3>

<p>Decomposes an integer <code>n</code> into a sum of squared integers (<code class="reqn">n = \sum_{i=1}^k x_i^2</code>; <code class="reqn">1\leq x_i &lt;n</code>)
with <code class="reqn">k\leq nmax</code>.
If <code>zerosum</code> is true then it is ensured that <code class="reqn">\sum_{i=1}^k c_i x_i = 0</code> with <code class="reqn">c_i=-1</code> or <code class="reqn">c_i=+1</code>.
The computation of the <code class="reqn">x_i</code>'s is limited by <code>maxt</code> seconds, which may result that not all possible
solutions are found. To reduce computing time, <code>rbind</code>'s in the function are replaced by allocating
matrices with <code>size</code> rows to fill in the results.
Note that the following data sets are available:
</p>

<ul>
<li> <p><code>sos100=sumofsquares(100, 10, zerosum=TRUE, maxt=Inf)</code>,
</p>
</li>
<li> <p><code>sos200=sumofsquares(200, 10, zerosum=TRUE, maxt=Inf)</code>,
</p>
</li>
<li> <p><code>sos400=sumofsquares(400, 10, zerosum=TRUE, maxt=Inf)</code>,
</p>
</li>
<li> <p><code>sos800=sumofsquares(800, 10, zerosum=TRUE, maxt=Inf)</code>, and
</p>
</li>
<li> <p><code>sos1000=sumofsquares(100, 10, zerosum=TRUE, maxt=Inf)</code>
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">sumofsquares(n, nmax = 10, zerosum = FALSE, maxt = 30, size = 100000L)

sum_sq(n, nmax = 10, zerosum = FALSE, maxt = 30, size = 100000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer: number to decompose as sum of squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>integer: maximum number of squares in the sum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zerosum</code></td>
<td>
<p>logical: should the solution sum up to one (default: <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxt</code></td>
<td>
<p>numeric: maximal number of seconds the routine should run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>numeric: length of additional matrix size (default: <code>100000L</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with <code>nmax</code> column with <code class="reqn">x_i</code>'s. <code>NA</code> means number has not been used.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sos &lt;- sumofsquares(100, 6) # 23 solutions
head(sos)
table(rowSums(!is.na(sos))) 
# one solution with one or two x_i
# five solutions with four x_i
# six solutions with five x_i
# ten solutions with six x_i
rowSums(sos^2, na.rm=TRUE)  # all 100
sos &lt;- sumofsquares(100, 6, zerosum=TRUE)
head(sos)
rowSums(sos^2, na.rm=TRUE)  # all 100
rowSums(sos, na.rm=TRUE)    # all 0 
</code></pre>


</div>