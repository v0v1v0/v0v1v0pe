<div class="container">

<table style="width: 100%;"><tr>
<td>plotContours</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Color contour plot of the estimated surfaces as a function of discharge and time (surfaces include log concentration, standard error, and concentration)</h2>

<h3>Description</h3>

<p>These plots are normally used for plotting the estimated concentration surface (whatSurface = 3) but can be used to explore the 
estimated surfaces for the log of concentration or for the standard error (in log space) which is what determines the bias correction. 
The plots are often more interpretable when the time limits for the plot are less than a decade.
To explore changes over a long time period it is best to do this multiple times, for various time slices of 2 years (for example) or to use the function <code>plotDiffContours</code>.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Obtaining a plot that provides good insight it is useful to experiment with several of the arguments such as yearStart, yearEnd, qBottom, qTop, and contourLevels. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotContours(eList, yearStart, yearEnd, qBottom = NA, qTop = NA,
  whatSurface = 3, qUnit = 2, contourLevels = NA, span = 60,
  pval = 0.05, printTitle = TRUE, vert1 = NA, vert2 = NA, horiz = NA,
  tcl = 0.03, flowDuration = TRUE, customPar = FALSE, yTicks = NA,
  tick.lwd = 1, usgsStyle = FALSE, lwd = 2, cex.main = 1,
  cex.axis = 1, concLab = 1, color.palette = colorRampPalette(c("white",
  "gray", "blue", "red")), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes, and surfaces matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yearStart</code></td>
<td>
<p>numeric value for the starting date for the graph, expressed as decimal year (typically whole number such as 1989.0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yearEnd</code></td>
<td>
<p>numeric value for the ending date for the graph, expressed as decimal year, (for example 1993.0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qBottom</code></td>
<td>
<p>numeric value for the bottom edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a "pretty" lower limit nearest to the 5% of discharge.  If yTicks are specified, then the first value of yTicks becomes the lowest discharge shown on the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qTop</code></td>
<td>
<p>numeric value for the top edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a "pretty" upper limit nearest to the 95% of discharge. If yTicks are specified, then the last value of yTicks becomes the highest discharge shown on the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whatSurface</code></td>
<td>
<p>numeric value, can only accept 1, 2, or 3;  whatSurface=1 is yHat (log concentration), whatSurface=2 is SE (standard error of log concentration), and whatSurface=3 is ConcHat (unbiased estimate of concentration), default = 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qUnit</code></td>
<td>
<p>object of qUnit class. <code>printqUnitCheatSheet</code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contourLevels</code></td>
<td>
<p>numeric vector containing the contour levels for the contour plot, arranged in ascending order, default is NA (which causes the contour levels to be set automatically, based on the data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>numeric, it is the half-width (in days) of the smoothing window for computing the flow duration information, default = 60</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>numeric, the probability value for the lower flow frequency line on the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vert1</code></td>
<td>
<p>numeric, the location in time for a black vertical line on the figure, yearStart&lt;vert1&lt;yearEnd, default is NA (vertical line is not drawn)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vert2</code></td>
<td>
<p>numeric, the location in time for a black vertical line on the figure, yearStart&lt;vert2&lt;yearEnd, default is NA (vertical line is not drawn)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p>numeric, the location in discharge for a black horizontal line on the figure, qBottom&lt;vert1&lt;qTop, default is NA (no horizontal line is drawn)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcl</code></td>
<td>
<p>numeric, length of tick marks in inches, default is 0.03</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flowDuration</code></td>
<td>
<p>logical variable if TRUE plot the flow duration lines (5 and 95 flow percentiles), if FALSE do not plot them, default = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yTicks</code></td>
<td>
<p>vector of yTick labels and marks that will be plotted in log space. (for example yTicks = c(3, 5, 10, 20, 50, 100, 200, 400). The first and last values determine the range of the y axis. If NA, the tick marks will be automatically generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick.lwd</code></td>
<td>
<p>line width for axis ticks, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>numeric, line width of flowDuration curve, default is 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
"Concentration" see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p>a function that creates a color palette for the contour plot. Default goes from white to gray to blue to red 
using the function <code>colorRampPalette(c("white","gray","blue","red"))</code>. A few preset options are heat.colors, topo.colors, and terrain.colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">yearStart &lt;- 2002
yearEnd &lt;- 2010
qBottom &lt;- 0.5
qTop&lt;- 20
clevel &lt;- seq(0,2,0.25)
eList &lt;- Choptank_eList
plotContours(eList, yearStart, yearEnd, qBottom, qTop, 
             contourLevels = clevel)  
plotContours(eList, yearStart, yearEnd, qBottom, qTop = 50, 
             contourLevels = clevel, flowDuration = FALSE) 
colors &lt;- colorRampPalette(c("white","black"))
plotContours(eList, yearStart, yearEnd, qBottom, qTop = 50, 
             contourLevels = clevel, color.palette = colors, 
             flowDuration = FALSE)
</code></pre>


</div>