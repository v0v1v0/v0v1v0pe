<div class="container">

<table style="width: 100%;"><tr>
<td>coxreg.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox regression</h2>

<h3>Description</h3>

<p>Called by <code>coxreg</code>, but a user can call it directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxreg.fit(
  X,
  Y,
  rs,
  weights,
  t.offset = NULL,
  strats,
  offset,
  init,
  max.survs,
  method = "efron",
  boot = FALSE,
  efrac = 0,
  calc.martres = TRUE,
  control,
  verbose = TRUE,
  calc.hazards = NULL,
  center = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The survival object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>The risk set composition. If absent, calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Case weights; time-fixed or time-varying.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.offset</code></td>
<td>
<p>Case offset; time-varying.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strats</code></td>
<td>
<p>The stratum variable. Can be absent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Offset. Can be absent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Start values. If absent, equal to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.survs</code></td>
<td>
<p>Sampling of risk sets? If so, gives the maximum number of
survivors in each risk set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either "efron" (default) or "breslow".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Number of bootstrap replicates. Defaults to FALSE, no
bootstrapping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efrac</code></td>
<td>
<p>Upper limit of fraction failures in 'mppl'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc.martres</code></td>
<td>
<p>Should martingale residuals be calculated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>See <code>coxreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should Warnings about convergence be printed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc.hazards</code></td>
<td>
<p>Deprecated. See <code>coxreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Deprecated. See <code>coxreg</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>rs</code> is dangerous to use when NA's are present.
</p>


<h3>Value</h3>

<p>A list with components 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Estimated regression parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Covariance matrix of estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>First component is value at <code>init</code>, second at maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>Score test statistic, at initial value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>Linear predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Martingale residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazard</code></td>
<td>
<p>Estimated baseline hazard. At value zero of design variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>Means of the columns of the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>The bootstrap replicates, if requested on input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conver</code></td>
<td>
<p><code>TRUE</code> if convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.conver</code></td>
<td>
<p>TRUE if variables converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p><code>TRUE</code> if failure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of performed iterations.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is the user's responsibility to check that indata is sane.
</p>


<h3>Author(s)</h3>

<p>Göran Broström
</p>


<h3>See Also</h3>

<p><code>coxreg</code>, <code>risksets</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 X &lt;- as.matrix(data.frame(
                x=     c(0, 2,1,4,1,0,3),
                sex=   c(1, 0,0,0,1,1,1)))
 time &lt;- c(1,2,3,4,5,6,7)
 status &lt;- c(1,1,1,0,1,1,0)
 stratum &lt;- rep(1, length(time))

 coxreg.fit(X, Surv(time, status), strats = stratum, max.survs = 6,
     control = list(eps=1.e-4, maxiter = 10, trace = FALSE))

</code></pre>


</div>