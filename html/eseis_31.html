<div class="container">

<table style="width: 100%;"><tr>
<td>model_turbulence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model the seismic spectrum due to hydraulic turbulence</h2>

<h3>Description</h3>

<p>The function calculates the seismic spectrum as predicted by the model 
of Gimbert et al. (2014) for hydraulic turbulence. The code was written to 
R by Sophie Lagarde and integrated to the R package 'eseis' by Michael 
Dietze.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_turbulence(
  d_s,
  s_s,
  r_s = 2650,
  h_w,
  w_w,
  a_w,
  f = c(1, 100),
  r_0,
  f_0,
  q_0,
  v_0,
  p_0,
  n_0,
  res = 1000,
  eseis = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d_s</code></td>
<td>
<p><code>Numeric</code> value, mean sediment grain diameter (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_s</code></td>
<td>
<p><code>Numeric</code> value, standard deviation of sediment grain 
diameter (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_s</code></td>
<td>
<p><code>Numeric</code> value, specific sediment density (kg / m^3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_w</code></td>
<td>
<p><code>Numeric</code> value, fluid flow depth (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_w</code></td>
<td>
<p><code>Numeric</code> value, fluid flow width (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_w</code></td>
<td>
<p><code>Numeric</code> value, fluid flow inclination angle (radians)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p><code>Numeric</code> vector, frequency range to be modelled. 
If of length two the argument is interpreted as representing the lower and 
upper limit and the final length of the frequency vector is set by the 
argument <code>res</code>. If <code>f</code> contains more than two values it is 
interpreted as the actual frequency vector and the value of <code>res</code> is 
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_0</code></td>
<td>
<p><code>Numeric</code> value, distance of seismic station to source</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_0</code></td>
<td>
<p><code>Numeric</code> value, reference frequency (Hz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_0</code></td>
<td>
<p><code>Numeric</code> value, ground quality factor at <code>f_0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_0</code></td>
<td>
<p><code>Numeric</code> value, phase velocity of the Rayleigh wave at 
<code>f_0</code> (m/s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_0</code></td>
<td>
<p><code>Numeric</code> value, variation exponent of Rayleigh wave 
velocities with frequency (dimensionless)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_0</code></td>
<td>
<p><code>Numeric</code> vector of length two, Greens function 
displacement amplitude coefficients. Cf. N_ij in eq. 36 in Gimbert et 
al. (2014)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p><code>Numeric</code> value, output resolution, i.e. length of the 
spectrum vector. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eseis</code></td>
<td>
<p><code>Character</code> value, option to return an eseis object 
instead of a data frame. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model uses a set of predefined constants. These can also be changed
by the user, using the <code>...</code> argument:
</p>

<ul>
<li> <p><code>c = 0.5</code>, instantaneous fluid-grain friction coefficient 
(dimensionless)
</p>
</li>
<li> <p><code>g = 9.81</code>, gravitational acceleration (m/s^2)
</p>
</li>
<li> <p><code>k = 0.5</code>, Kolmogrov constant (dimensionless)
</p>
</li>
<li> <p><code>k_s = 3 * d_s</code>, roughness length (m)
</p>
</li>
<li> <p><code>h = k_s / 2</code>, reference height of the measurement (m)
</p>
</li>
<li> <p><code>e_0 = 0</code>, exponent of Q increase with frequency 
(dimensionless)
</p>
</li>
<li> <p><code>r_w = 1000</code>, specific density of the fluid (kg/m^3)
</p>
</li>
<li> <p><code>c_w = 0.5</code>, instantaneous fluid-grain friction coefficient
(dimensionless)
</p>
</li>
</ul>
<h3>Value</h3>

<p><code>eseis</code> object containing the modelled spectrum.
</p>


<h3>Author(s)</h3>

<p>Sophie Lagarde, Michael Dietze
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## model the turbulence-related power spectrum
P &lt;- model_turbulence(d_s = 0.03, # 3 cm mean grain-size
                      s_s = 1.35, # 1.35 log standard deviation
                      r_s = 2650, # 2.65 g/cm^3 sediment density
                      h_w = 0.8, # 80 cm water level
                      w_w = 40, # 40 m river width
                      a_w = 0.0075, # 0.0075 rad river inclination
                      f = c(1, 200), # 1-200 Hz frequency range
                      r_0 = 10, # 10 m distance to the river
                      f_0 = 1, # 1 Hz Null frequency 
                      q_0 = 10, # 10 quality factor at f = 1 Hz
                      v_0 = 2175, # 2175 m/s phase velocity
                      p_0 = 0.48, # 0.48 power law variation coefficient
                      n_0 = c(0.6, 0.8), # Greens function estimates
                      res = 1000) # 1000 values build the output resolution

## plot the power spectrum
plot_spectrum(data = P)
              
</code></pre>


</div>