<div class="container">

<table style="width: 100%;"><tr>
<td>exams2pandoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of Exams via Pandoc</h2>

<h3>Description</h3>

<p>Automatic generation of exams via pandoc, by default in docx format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  exams2pandoc(file, n = 1L, nsamp = NULL, dir = ".",
    name = "pandoc", type = "docx", template = "plain.tex",
    question = "Question", solution = "Solution",
    header = list(Date = Sys.Date()), inputs = NULL, options = NULL,
    quiet = TRUE, resolution = 100, width = 4, height = 4, svg = FALSE,
    encoding = "UTF-8", envir = NULL, engine = NULL,
    edir = NULL, tdir = NULL, sdir = NULL, verbose = FALSE,
    points = NULL, exshuffle = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>character. A specification of a (list of) exercise files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer. The number of copies to be compiled from <code>file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>integer. The number(s) of exercise files sampled from each
list element of <code>file</code>. Sampling without replacement is used
if possible. (Only if some element of <code>nsamp</code> is larger than
the length of the corresponding element in <code>file</code>, sampling
with replacement is used.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>character specifying the output directory (default:
current working directory). If only a single HTML file is produced
and no <code>dir</code> is explicitly specified, the file is displayed in the
browser rather than saved in <code>dir</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character. A name prefix for resulting exercises.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character. The file type to convert to using pandoc. The default is
<code>"docx"</code> (but other choices are also supported, e.g., <code>"odt"</code>,
<code>"html"</code>, <code>"markdown"</code> etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>character. A specification of a template in either
LaTeX, HTML, or Markdown format. The default is to use the <code>"plain.tex"</code>
file provided but an alternative <code>"plain.html"</code> is also available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>question</code></td>
<td>
<p>character or logical. Should the question be included in the
output? If <code>question</code> is a character it will be used as a header for
resulting questions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solution</code></td>
<td>
<p>character or logical, see argument <code>question</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>list. A list of named character strings (or functions generating such)
to be substituted in the <code>template</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputs</code></td>
<td>
<p>character. Names of files that are needed as inputs for the
<code>template</code> (e.g., images, headers). Either the full path
must be given or the file needs to be in <code>edir</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>character. A string of options to be passed on to
<code>pandoc_convert</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>logical. Should output be suppressed when calling
<code>xweave</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution, width, height</code></td>
<td>
<p>numeric. Options for rendering PNG (or SVG)
graphics passed to <code>xweave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svg</code></td>
<td>
<p>logical. Should graphics be rendered in SVG or PNG (default)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>character, ignored. The encoding is always assumed to be UTF-8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>argument passed to <code>xweave</code> (which passes
it to <code>knit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>argument passed to <code>xweave</code> indicating whether
<code>"Sweave"</code> (default) or <code>"knitr"</code> should be used for rendering Rnw exercises.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edir</code></td>
<td>
<p>character specifying the path of the directory (along with its
sub-directories) in which the files in <code>file</code> are stored
(see also <code>xexams</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tdir</code></td>
<td>
<p>character specifying a temporary directory, by default
this is chosen via <code>tempfile</code>. Note that this
is cleaned up (i.e., existing files are deleted) and only certain
temporary files are preserved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdir</code></td>
<td>
<p>character specifying a directory for storing supplements, by
default this is chosen via <code>tempfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Should information on progress of exam generation
be reported?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>integer. How many points should be assigned to each exercise? Note that this
argument overules any exercise points that are provided within the <code>expoints</code> tags
of the exercise files (if any). The vector of points supplied should either have
length 1 or the number of exercises in the exam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exshuffle</code></td>
<td>
<p>logical or integer. If the <code>exshuffle</code>
argument is non-<code>NULL</code> it is used to overrule the <code>exshuffle</code>
tag from the <code>file</code> (e.g., <code>exshuffle = FALSE</code> can be used
to keep all available answers without permutation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>exams2pandoc</code> can generate exams in various output formats
(by default docx) using <code>xexams</code> and
<code>pandoc_convert</code>. It proceeds by (1) calling
<code>xweave</code> on each exercise, (2) reading the resulting
LaTeX or Markdown code, (3) transforming the code to the markup of
some exam template (either LaTeX, HTML, or Markdown), (4) embedding the
code in a template and converting it to the desired output format
using pandoc.
</p>
<p>For steps (1) and (2) the standard drivers in <code>xexams</code> are used.
</p>
<p>For step (3) a suitable transformation function is set up on the fly
using <code>make_exercise_transform_pandoc</code>. Depending
on which format the template uses (LaTeX or HTML or Markdown) the
transformation may or may not be trivial.
</p>
<p>For step (4) all exercises are inserted into the template (and also
replacing certain additional tags from <code>header</code>) and then
<code>pandoc_convert</code> is used to convert to the
desired output format (one file for each exam). In principle, all output
types of pandoc are supported, but most of them have not been tested.
(The main motivation for <code>exams2pandoc</code> was the generation of
<code>"docx"</code> or <code>"odt"</code> files.)
</p>


<h3>Value</h3>

<p><code>exams2pandoc</code> returns a list of exams as generated by <code>xexams</code>.
</p>


<h3>See Also</h3>

<p><code>xexams</code>,
<code>pandoc_convert</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package and enforce par(ask = FALSE)
options(device.ask.default = FALSE)

## define an exams (= list of exercises)
myexam &lt;- list(
  "boxplots.Rmd",
  c("tstat.Rmd", "ttest.Rmd", "confint.Rmd"),
  c("regression.Rmd", "anova.Rmd"),
  c("scatterplot.Rmd", "boxhist.Rmd"),
  "relfreq.Rmd"
)

## output directory
dir.create(mydir &lt;- tempfile())

## compile two docx and odt versions each
set.seed(1090)
exams2pandoc(myexam, n = 2, dir = mydir, type = "docx")
set.seed(1090)
exams2pandoc(myexam, n = 2, dir = mydir, type = "odt")
</code></pre>


</div>