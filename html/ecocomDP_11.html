<div class="container">

<table style="width: 100%;"><tr>
<td>create_location</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create the location table</h2>

<h3>Description</h3>

<p>Create the location table
</p>


<h3>Usage</h3>

<pre><code class="language-R">create_location(
  L0_flat,
  location_id,
  location_name,
  latitude = NULL,
  longitude = NULL,
  elevation = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L0_flat</code></td>
<td>
<p>(tbl_df, tbl, data.frame) The fully joined source L0 dataset, in "flat" format (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location_id</code></td>
<td>
<p>(character) Column in <code>L0_flat</code> containing the identifier assigned to each unique location at the observation level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location_name</code></td>
<td>
<p>(character) One or more columns in <code>L0_flat</code> of sampling locations ordered from high to low in terms of nesting, where the lowest is the level of observation (e.g. <code>location_name = c("plot", "subplot")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude</code></td>
<td>
<p>(character) An optional column in <code>L0_flat</code> containing the latitude in decimal degrees of <code>location_id</code>. Latitudes south of the equator are negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitude</code></td>
<td>
<p>(character) An optional column in <code>L0_flat</code> containing the longitude in decimal degrees of <code>location_id</code>. Longitudes west of the prime meridian are negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elevation</code></td>
<td>
<p>(character) An optional column in <code>L0_flat</code> containing the elevation in meters relative to sea level of <code>location_id</code>. Above sea level is positive. Below sea level is negative.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function collects specified columns from <code>L0_flat</code>, creates data frames for each <code>location_name</code>, assigns <code>latitude</code>, <code>longitude</code>, and <code>elevation</code> to the lowest nesting level (i.e. the observation level) returning <code>NA</code> for higher levels (these will have to be filled manually afterwards), and determines the relationships between location_id and parent_location_id from <code>L0_flat</code> and <code>location_name</code>.
</p>
<p>To prevent the listing of duplicate location_name values, and to enable the return of <code>location_name</code> columns by <code>flatten_data()</code>, location_name values are suffixed with the column they came from according to: <code>paste0(&lt;column name&gt;, "__", &lt;column value&gt;)</code>. Example: A column named "plot" with values "1", "2", "3", in <code>L0_flat</code> would be listed in the resulting location table under the location_name column as "1", "2", "3" and therefore no way to discern these values correspond with "plot". Applying the above listed solution returns "plot__1", "plot__2", "plot__3" in the location table and returns the column "plot" with values c("1", "2", "3") by <code>flatten_data()</code>.
</p>
<p>"flat" format refers to the fully joined source L0 dataset in "wide" form with the exception of the core observation variables, which are in "long" form (i.e. using the variable_name, value, unit columns of the observation table). This "flat" format is the "widest" an L1 ecocomDP dataset can be consistently spread due to the frequent occurrence of L0 source datasets with &gt; 1 core observation variable.
</p>
<p>Additionally, latitude, longitude, and elevation of sites nested above the observation level will have to be manually added after the location table is returned.
</p>


<h3>Value</h3>

<p>(tbl_df, tbl, data.frame) The location table.
</p>


<h3>Examples</h3>

<pre><code class="language-R">flat &lt;- ants_L0_flat

location &lt;- create_location(
  L0_flat = flat, 
  location_id = "location_id", 
  location_name = c("block", "plot"), 
  latitude = "latitude", 
  longitude = "longitude", 
  elevation = "elevation")

location

</code></pre>


</div>