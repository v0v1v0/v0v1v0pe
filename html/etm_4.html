<div class="container">

<table style="width: 100%;"><tr>
<td>clos</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Change in Length of Stay</h2>

<h3>Description</h3>

<p>The function estimates the expected change in length of stay (LOS)
associated with an intermediate event.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clos(x, aw, ratio, ...)
## S3 method for class 'etm'
clos(x, aw = FALSE, ratio = FALSE, ...)
## S3 method for class 'msfit'
clos(x, aw = FALSE, ratio = FALSE, cox_model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>etm</code>. Argument <code>delta.na</code> in
<code>etm</code> must be set to <code>TRUE</code> in order to use this
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aw</code></td>
<td>
<p>Logical. Whether to compute the expected change of LOS using
alternative weighting. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>Logical. Compute the ratio of the expected length-of-stay
given instermediate event status instead of a difference. Default
value is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cox_model</code></td>
<td>
<p>TODO</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The approach for evaluating the impact of an intermediate
event on the expected change in length of stay is based on Schulgen
and Schumacher (1996). They suggested to consider the difference of
the expected subsequent stay given infectious status at time s. 
</p>
<p>Extensions to the methods of Schulgen and Schumacher and the earlier
implementation in the <span class="pkg">changeLOS</span> include the possibility to
compute the extra length of stay both for competing endpoints and the
more simple case of one absorbing state, as well as the possibility to
compute this quantity for left-truncated data. 
</p>


<h3>Value</h3>

<p>An object of class <code>clos.etm</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>e.phi</code></td>
<td>
<p>Change in length of stay</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.case</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS} | X_s =
      \mbox{intermediate event})</code> for
all observed transition times <code class="reqn">s</code>, where
<code class="reqn">X_s</code>denotes the state by time <code class="reqn">s</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.control</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS} | X_s =
      \mbox{initial state})</code> for
all observed transition times <code class="reqn">s</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.phi2</code></td>
<td>
<p>Weighted average of the difference between
<code>phi2.case</code> and <code>phi2.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2.case</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{discharge}) | X_s =
      \mbox{intermediate event})</code>, where <code class="reqn">\mathbf{1}</code> denotes
the indicator function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2.control</code></td>
<td>
<p><code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{discharge}) | X_s =
      \mbox{initial state})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.phi3</code></td>
<td>
<p>Weighted average of the difference between
<code>phi3.case</code> and <code>phi3.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi3.case</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{death}) | X_s =
      \mbox{intermediate event})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi3.control</code></td>
<td>
<p><code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{death}) | X_s =
      \mbox{initial state})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights used to compute the weighted averages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.time</code></td>
<td>
<p>Times at which the weights are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>All transition times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.phi.weights.1</code></td>
<td>
<p>Expected change in LOS using <code>weights.1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.phi.weights.other</code></td>
<td>
<p>Expected change in LOS using
<code>weights.other</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.1</code></td>
<td>
<p>Weights corresponding to the conditional waiting
time in the intial state given one experiences the intermediate event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.other</code></td>
<td>
<p>Weights corresponding to the conditional
waiting time given one does not experience the intermediate event.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>,
Matthias Wangler, Jan Beyersmann</p>


<h3>References</h3>

<p>G Schulgen and M Schumacher (1996). Estimation of prolongation of
hospital stay attributable to nosocomial infections.  <em>Lifetime
Data Analysis</em> 2, 219-240.
</p>
<p>J Beyersmann, P Gastmeier, H Grundmann, S Baerwolf, C Geffers,
M Behnke, H Rueden, and M Schumacher (2006). Use of Multistate
Models to Assess Prolongation of Intensive Care Unit Stay Due to
Nosocomial Infection. <em>Infection Control and Hospital
Epidemiology</em> 27, 493-499.
</p>
<p>Allignol A, Schumacher M, Beyersmann J: Estimating summary functionals
in multistate models with an application to hospital infection
data. <em>Computation Stat</em>, 2011; 26: 181-197.
</p>
<p>M Wrangler, J Beyersmann and M Schumacher (2006). changeLOS: An
R-package for change in length of hospital stay based on the
Aalen-Johansen estimator. <em>R News</em> 6(2), 31â€“35.
</p>


<h3>See Also</h3>

<p><code>etm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(los.data)

## putting los.data in the long format
my.observ &lt;- prepare.los.data(x=los.data)

tra &lt;- matrix(FALSE, 4, 4)
tra[1, 2:4] &lt;- TRUE
tra[2, 3:4] &lt;- TRUE

tr.prob &lt;- etm(my.observ, c("0","1","2","3"), tra, NULL, 0)

cLOS &lt;- etm::clos(tr.prob)
plot(cLOS)


### Compute bootstrapped SE

## function that performs the bootstrap
## nboot: number of bootstrap samples. Other arguments are as in etm()
boot.clos &lt;- function(data, state.names, tra, cens.name, s = 0, nboot) {
    res &lt;- double(nboot)
    for (i in seq_len(nboot)) {
        index &lt;- sample(unique(data$id), replace = TRUE)
        inds &lt;- new.id &lt;- NULL
        for (j in seq_along(index)){
            ind &lt;- which(data$id == index[j])
            new.id &lt;- c(new.id, rep(j, length(ind)))
            inds &lt;- c(inds, ind)
        }
        dboot &lt;- cbind(data[inds, ], new.id)
        dboot[, which(names(dboot) == "id")]
        dboot$id &lt;- dboot$new.id
        tr.prob &lt;- etm(dboot, state.names, tra, cens.name, s, cova = FALSE)
        res[i] &lt;- etm::clos(tr.prob)$e.phi
    }
    res
}

## bootstrap
se &lt;- sqrt(var(boot.clos(my.observ, c("0","1","2","3"), tra, NULL, 0,
                         nboot = 10)))
</code></pre>


</div>