<div class="container">

<table style="width: 100%;"><tr>
<td>hdIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute importance weights for  lasso, group lasso, scaled lasso or
scaled group lasso estimator under high-dimensional setting</h2>

<h3>Description</h3>

<p><code>hdIS</code> computes importance weights using samples
drawn by <code>PBsampler</code>. See the examples
below for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hdIS(PBsample, PETarget, sig2Target, lbdTarget, TsA.method = "default",
  log = TRUE, parallel = FALSE, ncores = 2L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PBsample</code></td>
<td>
<p>bootstrap samples of class <code>PB</code> from <code>PBsampler</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PETarget, sig2Target, lbdTarget</code></td>
<td>
<p>parameters of target distribution.
(point estimate of beta or <code>E(y)</code>, estimated variance of error and lambda)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TsA.method</code></td>
<td>
<p>method to construct <code>T(eta(s),A)</code> matrix. See Zhou and Min(2017)
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical. If <code>log = TRUE</code>, importance weight is computed in log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. If <code>parallel = TRUE</code>, uses parallelization.
Default is <code>parallel = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>integer. The number of cores to use for parallelization.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>computes importance weights which is defined as (target density)/(proposal density),
when the samples are drawn from the proposal
distribution with the function <code>PBsampler</code> while the parameters of
the target distribution are (PETarget, sig2Target, lbdTarget). <br>
Say that we are interested in computing the expectation of a function of a random variable, <code>h(X)</code>.
Let <code>f(x)</code> be the true or target distribution and <code>g(x)</code> be the proposal distribution.
We can approximate the expectation, <code>E[h(X)]</code>, by a weighted average of samples, <code>x_i</code>, drawn from
the proposal distribution as follows, <code>E[h(X)] = mean( h(x_i) * f(x_i)/h(x_i) )</code>.
</p>


<h3>Value</h3>

<p>importance weights of the proposed samples.
</p>


<h3>References</h3>

<p>Zhou, Q. (2014), "Monte Carlo simulation for Lasso-type problems by estimator augmentation,"
Journal of the American Statistical Association, 109, 1495-1516.
</p>
<p>Zhou, Q. and Min, S. (2017), "Estimator augmentation with applications in
high-dimensional group inference," Electronic Journal of Statistics, 11(2), 3039-3080.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
n &lt;- 10
p &lt;- 30
Niter &lt;-  10
Group &lt;- rep(1:(p/10), each = 10)
Weights &lt;- rep(1, p/10)
x &lt;- matrix(rnorm(n*p), n)

# Target distribution parameter
PETarget &lt;- rep(0, p)
sig2Target &lt;- .5
lbdTarget &lt;- .37

#
# Using non-mixture distribution
# ------------------------------
## Proposal distribution parameter
PEProp1 &lt;- rep(1, p)
sig2Prop1 &lt;- .5
lbdProp1 &lt;- 1
PB &lt;- PBsampler(X = x, PE_1 = PEProp1, sig2_1 = sig2Prop1,
 lbd_1 = lbdProp1, weights = Weights, group = Group, niter = Niter,
 type="grlasso", PEtype = "coeff")

hdIS(PB, PETarget = PETarget, sig2Target = sig2Target, lbdTarget = lbdTarget,
 log = TRUE)

#
# Using mixture distribution
# ------------------------------
# Target distribution parameters (coeff, sig2, lbd) = (rep(0,p), .5, .37)
# Proposal distribution parameters
#  (coeff, sig2, lbd) = (rep(0,p), .5, .37) &amp; (rep(1,p), 1, .5)
#
#
PEProp1 &lt;- rep(0,p); PEProp2 &lt;- rep(1,p)
sig2Prop1 &lt;- .5; sig2Prop2 &lt;- 1
lbdProp1 &lt;- .37; lbdProp2 &lt;- .5

PBMixture &lt;- PBsampler(X = x, PE_1 = PEProp1,
 sig2_1 = sig2Prop1, lbd_1 = lbdProp1, PE_2 = PEProp2,
 sig2_2 = sig2Prop2, lbd_2 = lbdProp2, weights = Weights, group = Group,
 niter = Niter, type = "grlasso", PEtype = "coeff")
hdIS(PBMixture, PETarget = PETarget, sig2Target = sig2Target, lbdTarget = lbdTarget,
 log = TRUE)
</code></pre>


</div>