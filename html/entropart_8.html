<div class="container">

<table style="width: 100%;"><tr>
<td>SpeciesDistribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Species Distributions
</h2>

<h3>Description</h3>

<p>A Species Distribution is a (preferably named) vector containing species abundances or probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">as.SpeciesDistribution(x, ...)
## S3 method for class 'data.frame'
as.SpeciesDistribution(x, ...)
## S3 method for class 'integer'
as.SpeciesDistribution(x, ...)
## S3 method for class 'numeric'
as.SpeciesDistribution(x, ...)
## S3 method for class 'SpeciesDistribution'
autoplot(object, ..., Distribution = NULL, 
         ylog = TRUE, main = NULL, xlab = "Rank", ylab = NULL, 
         pch = ggplot2::GeomPoint$default_aes$shape,
         col = ggplot2::GeomPoint$default_aes$colour,
         cex = ggplot2::GeomPoint$default_aes$size) 
## S3 method for class 'SpeciesDistribution'
plot(x, ..., Distribution = NULL, 
         type = "b", log = "y", main = NULL, xlab = "Rank", ylab = NULL)
is.SpeciesDistribution(x)
as.ProbaVector(x, ...)
## S3 method for class 'data.frame'
as.ProbaVector(x, ...)
## S3 method for class 'integer'
as.ProbaVector(x, Correction = "None", Unveiling = "None", 
          RCorrection = "Jackknife", JackOver = FALSE, JackMax = 10, 
          CEstimator = "ZhangHuang", q = 0, ..., CheckArguments = TRUE)
## S3 method for class 'numeric'
as.ProbaVector(x, Correction = "None", Unveiling = "None", 
          RCorrection = "Jackknife", JackOver = FALSE, JackMax = 10, 
          CEstimator = "ZhangHuang", q = 0, ..., CheckArguments = TRUE)
is.ProbaVector(x)
as.AbdVector(x, ...)
## S3 method for class 'data.frame'
as.AbdVector(x, Round = TRUE, ...)
## S3 method for class 'integer'
as.AbdVector(x, ...)
## S3 method for class 'numeric'
as.AbdVector(x, Round = TRUE, ...)
is.AbdVector(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Distribution</code></td>
<td>

<p>The distribution to fit on the plot. May be <code>"lnorm"</code> (log-normal), <code>"lseries"</code> (log-series), <code>"geom"</code> (geometric) or <code>"bstick"</code> (broken stick). If <code>NULL</code>, no distribution is fitted. See <code>rCommunity</code> for the description of these distributions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Round</code></td>
<td>

<p>If <code>TRUE</code> (by default), values of <code>x</code> are set to integer to create an <code>AbdVector</code>. This is useful if original abundances are not integers (this is often the case for <code>MetaCommunity</code> abundances which are the product of probabilities by the number of individuals) and integer values are required (for example to calculate the bootstrap confidence interval of a community profile).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correction</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution: <code>"None"</code> (no correction, the default value), or <code>"Chao2013"</code>, <code>"Chao2015"</code>, <code>"ChaoShen"</code> to estimate the probability of the observed species in the asymptotic distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species: <code>"None"</code> (default, no species is added), <code>"unif"</code> (uniform: all unobserved species have the same probability) or <code>"geom"</code> (geometric: the unobserved species distribution is geometric).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code>Richness</code> to evaluate the total number of species. <code>"Jackknife"</code> is the default value. An alternative is <code>"Rarefy"</code> to estimate the number of species such that the entropy of order <code>q</code> of the asymptotic distribution rarefied to the observed sample size equals the actual entropy of the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JackOver</code></td>
<td>

<p>If <code>TRUE</code>, retain the jackknife order immediately superior to the optimal one, usually resulting in the overestimation of the number of species. Default is <code>FALSE</code>. Ignored if <code>RCorrection</code> is not <code>"Jackknife"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JackMax</code></td>
<td>

<p>The highest jackknife order allowed. Default is 10. Allowed values are between 1 and 10.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CEstimator</code></td>
<td>

<p>A string containing an estimator recognized by <code>Coverage</code> to evaluate the sample coverage. <code>"ZhangHuang"</code> is the default value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A number: the order of entropy. Default is 0 for richness. Used only to estimate asymptotic probability distributions with <code>RCorrection</code> equal to <code>"Rarefy"</code>. Then, the number of unobserved species is fitted so that the entropy of order <code>q</code> of the asymptotic probability distribution at the observed sample size equals the actual entropy of the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The plot type, see <code>plot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>

<p>The axis to plot in log scale, <em>e.g.</em> <code>"xy"</code> for both axes. Default is <code>"y"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>The main title of the plot. if <code>NULL</code> (by default), there is no title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>The X axis label, "Rank" by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>The Y axis label. if <code>NULL</code> (by default), "Probability" or "Abundance" is chosen according to the object class.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylog</code></td>
<td>

<p>Logical; if <code>TRUE</code> (by default), the Y-axis of the plot is log scaled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>The plotting characters. See <code>points</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>The color of the geom objects. See "Color Specification" in <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>The character expansion (size) of the points. See <code>points</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to <code>plot</code>. Unused elsewhere.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>SpeciesDistribution</code> objects include <code>AbdVector</code> and <code>ProbaVector</code> objects.
</p>
<p><code>as.AbdVector</code> just sets the class of the numeric or integer <code>x</code> so that appropriate versions of community functions (generic methods such as <code>Diversity</code>) are applied. Abundance values are rounded (by default) to the nearest integer.
</p>
<p><code>as.ProbaVector</code> normalizes the vector so that it sums to 1. If <code>Correction</code> is not <code>"None"</code>, the observed abundance distribution is used to estimate the actual species distribution. The list of species will be changed: zero-abundance species will be cleared, and some unobserved species will be added. First, observed species probabilities are estimated folllowing Chao and Shen (2003), <em>i.e.</em> input probabilities are multiplied by the sample coverage, or according to more sophisticated models: Chao <em>et al.</em> (2013, single-parameter model), or Chao <em>et al.</em> (2015, two-parameter model). The total probability of observed species equals the sample coverage. Then, the distribution of unobserved species can be unveiled: their number is estimated according to <code>RCorrection</code> (if the Jackknife estimator is chosen, the <code>JackOver</code> argument allows using the order immediately over the optimal one). The coverage deficit (1 minus the sample coverage) is shared by the unobserved species equally (<code>Unveiling = "unif"</code>, Chao <em>et al.</em>, 2013) or according to a geometric distribution (<code>Unveiling = "geom"</code>, Chao <em>et al.</em>, 2015).
</p>
<p>These functions can be applied to data frames to calculate the joint diversity (Gregorius, 2010).
</p>
<p><code>SpeciesDistribution</code> objects can be plotted. The <code>plot</code> method returns the estimated parameters of the fitted distribution. The broken stick has no parameter, so the maximum abundance is returned.
</p>


<h3>Note</h3>

<p>Fisher's alpha (Fisher <em>et al.</em>, 1943) is estimated to fit the log-series distribution. The estimation is done by the <code>fisher.alpha</code> function of package <code>vegan</code>. It may differ substantially from the estimation returned by <code>optimal.theta</code> from package <code>untb</code>.
</p>


<h3>Author(s)</h3>

<p>Eric Marcon &lt;Eric.Marcon@agroparistech.fr&gt;, Bruno Herault &lt;Bruno.Herault@cirad.fr&gt;
</p>


<h3>References</h3>

<p>Chao, A. and Shen, T. J. (2003). Nonparametric estimation of Shannon's index of diversity when there are unseen species in sample. <em>Environmental and Ecological Statistics</em> 10(4): 429-443.
</p>
<p>Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p>Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p>Fisher R.A., Corbet A.S., Williams C.B. (1943) The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population. <em>Journal of Animal Ecology</em> 12: 42-58.
</p>
<p>Gregorius H.-R. (2010) Linking Diversity and Differentiation. <em>Diversity</em> 2(3): 370-394.
</p>


<h3>See Also</h3>

<p><code>rgeom</code>, <code>rlnorm</code>, <code>rCommunity</code>, <code>RAClnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Whittaker plot, poorly fitted by a log-normal distribution
plot(Ns, Distribution = "lnorm")
# ggplot version
autoplot(Ns, Distribution = "lnorm")
</code></pre>


</div>