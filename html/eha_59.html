<div class="container">

<table style="width: 100%;"><tr>
<td>mlreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML proportional hazards regression</h2>

<h3>Description</h3>

<p>Maximum Likelihood estimation of proportional hazards models. Is deprecated,
use <code>coxreg</code> instead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlreg(
  formula = formula(data),
  data = parent.frame(),
  na.action = getOption("na.action"),
  init = NULL,
  method = c("ML", "MPPL"),
  control = list(eps = 1e-08, maxiter = 10, n.points = 12, trace = FALSE),
  singular.ok = TRUE,
  model = FALSE,
  center = TRUE,
  x = FALSE,
  y = TRUE,
  boot = FALSE,
  geometric = FALSE,
  rs = NULL,
  frailty = NULL,
  max.survs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~
operator, and the terms on the right. The response must be a survival object
as returned by the Surv function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the
formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a missing-data filter function, applied to the model.frame,
after any subset argument has been used.  Default is
<code>options()$na.action</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>vector of initial values of the iteration.  Default initial
value is zero for all variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method of treating ties, "ML", the default, means pure maximum
likelihood, i.e, data are treated as discrete. The choice "MPPL" implies
that risk sets with no tied events are treated as in ordinary Cox
regression. This is a cameleont that adapts to data, part discrete and part
continuous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with components <code>eps</code> (convergence criterion),
<code>maxiter</code> (maximum number of iterations), and <code>silent</code> (logical,
controlling amount of output). You can change any component without mention
the other(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Should covariates be centered? Default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Return the design matrix in the model object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>return the response in the model object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>No. of bootstrap replicates. Defaults to FALSE, i.e., no
bootstrapping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geometric</code></td>
<td>
<p>If <code>TRUE</code>, the intensity is assumed constant within
strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>Risk set? If present, speeds up calculations considerably.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frailty</code></td>
<td>
<p>A grouping variable for frailty analysis. Full name is
needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.survs</code></td>
<td>
<p>Sampling of risk sets?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Method <code>ML</code> performs a true discrete analysis, i.e., one parameter per
observed event time. Method <code>MPPL</code> is a compromize between the discrete
and continuous time approaches; one parameter per observed event time with
multiple events. With no ties in data, an ordinary Cox regression (as with
<code>coxreg</code>) is performed.
</p>


<h3>Value</h3>

<p>A list of class <code>c("mlreg", "coxreg", "coxph")</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Fitted parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Covariance
matrix of the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Vector of length two; first
component is the value at the initial parameter values, the second componet
is the maximized value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>The score test statistic (at the
initial value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>The estimated linear predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The martingale residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazard</code></td>
<td>
<p>The estimated
baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>Means of the columns of the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.means</code></td>
<td>
<p>Weighted (against exposure time) means of covariates;
weighted relative frequencies of levels of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of
spells in indata (possibly after removal of cases with NA's).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>Number of events in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>Used by extractor
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign</code></td>
<td>
<p>Used by extractor functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald.test</code></td>
<td>
<p>The
Walt test statistic (at the initial value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The Surv vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isF</code></td>
<td>
<p>Logical vector indicating the covariates that are factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>The covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ttr</code></td>
<td>
<p>Total Time at Risk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>List of levels of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The calling
formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>The bootstrap sample, if
requested on input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Present if a frailty model is fitted.
Equals the estimated frailty standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sd</code></td>
<td>
<p>The
standard error of the estimated frailty standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Did the optimization
converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p>Did the optimization fail? (Is <code>NULL</code> if not).</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>The use of <code>rs</code> is dangerous, see note above. It can
however speed up computing time.
</p>


<h3>Note</h3>

<p>This function starts by creating risksets, if no riskset is supplied
via <code>rs</code>, with the aid of <code>risksets</code>. This latter mechanism
fails if there are any NA's in the data! Note also that it depends on
stratification, so <code>rs</code> contains information about stratification.
Giving another strata variable in the formula is an error. The same is ok,
for instance to supply stratum interactions.
</p>
<p>Note futher that <code>mlreg</code> is deprecated. <code>coxreg</code> should be
used instead.
</p>


<h3>Author(s)</h3>

<p>Göran Broström
</p>


<h3>References</h3>

<p>Broström, G. (2002). Cox regression; Ties without
tears. <em>Communications in Statistics: Theory and Methods</em> <b>31</b>,
285–297.
</p>


<h3>See Also</h3>

<p><code>coxreg</code>, <code>risksets</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

 dat &lt;- data.frame(time=  c(4, 3,1,1,2,2,3),
                status=c(1,1,1,0,1,1,0),
                x=     c(0, 2,1,1,1,0,0),
                sex=   c(0, 0,0,0,1,1,1))
 mlreg( Surv(time, status) ~ x + strata(sex), data = dat) #stratified model
 # Same as:
 rs &lt;- risksets(Surv(dat$time, dat$status), strata = dat$sex)
 mlreg( Surv(time, status) ~ x, data = dat, rs = rs) #stratified model
 
</code></pre>


</div>