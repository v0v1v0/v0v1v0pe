<div class="container">

<table style="width: 100%;"><tr>
<td>plotEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot estimates with confidence limits (forest plot)
</h2>

<h3>Description</h3>

<p>Plots parameter estimates with confidence intervals, annotated with
parameter names. A dot is plotted at the estimate and a horizontal
line extending from the lower to the upper limit is superimposed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotEst( ests,
            y = dim(ests)[1]:1,
          txt = rownames(ests),
       txtpos = y,
         ylim = range(y)-c(0.5,0),
         xlab = "",
         xtic = nice(ests[!is.na(ests)], log = xlog),
         xlim = range( xtic ),
         xlog = FALSE,
          pch = 16,
          cex = 1,
          lwd = 2,
          col = "black",
      col.txt = "black",
     font.txt = 1,
    col.lines = col,
   col.points = col,
         vref = NULL,
         grid = FALSE,
     col.grid = gray(0.9),
  restore.par = TRUE,
          ... )

linesEst( ests, y = dim(ests)[1]:1, pch = 16, cex = 1, lwd = 2,
          col="black", col.lines=col, col.points=col, ... )

pointsEst( ests, y = dim(ests)[1]:1, pch = 16, cex = 1, lwd = 2,
          col="black", col.lines=col, col.points=col, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ests</code></td>
<td>
<p>Matrix with three columns: Estimate, lower limit, upper
limit. If a model object is supplied, <code>ci.lin</code> is
invoked for this object first.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vertical position of the lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt</code></td>
<td>
<p>Annotation of the estimates. Either a character vector or
an expression vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txtpos</code></td>
<td>
<p>Vertical position of the text. Defaults to <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Extent of the vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Annotation of the horizontal axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtic</code></td>
<td>
<p>Location of tickmarks on the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Extent of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlog</code></td>
<td>
<p>Should the x-axis be logarithmic?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>What symbol should be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Expansion of the symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colour of the points and lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.txt</code></td>
<td>
<p>Colour of the text annotating the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.txt</code></td>
<td>
<p>Font for the text annotating the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lines</code></td>
<td>
<p>Colour of the lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.points</code></td>
<td>
<p>Colour of the symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Thickness of the lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vref</code></td>
<td>
<p>Where should vertical reference line(s) be drawn?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>If TRUE, vertical gridlines are drawn at the
tickmarks. If a numerical vector is given vertical lines are drawn
at <code>grid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.grid</code></td>
<td>
<p>Colour of the vertical gridlines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restore.par</code></td>
<td>
<p>Should the graphics parameters be restored? If set
to <code>FALSE</code> the coordinate system will still be available for
additional plotting, and <code>par("mai")</code> will still have the very
large value set in order to make room for the labelling of the
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed on to <code>ci.lin</code> when a model object is
supplied as <code>ests</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plotEst</code> makes a news plot, whereas <code>linesEst</code> and
<code>pointsEst</code> (identical functions) adds to an existing plot.
</p>
<p>If a model object of class <code>"glm"</code>, <code>"coxph"</code>, <code>"clogistic"</code> or
<code>"gnlm"</code> is supplied the argument <code>xlog</code> defaults to
<code>TRUE</code>, and exponentiated estimates are extracted by default.
</p>


<h3>Value</h3>

<p>NULL
</p>


<h3>Author(s)</h3>

<p>Bendix Carstensen,
<a href="mailto:b@bxc.dk">b@bxc.dk</a>,
<a href="http://bendixcarstensen.com">http://bendixcarstensen.com</a></p>


<h3>See Also</h3>

<p>ci.lin
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Bogus data and a linear model
f &lt;- factor( sample( letters[1:5], 100, replace=TRUE ) )
x &lt;- rnorm( 100 )
y &lt;- 5 + 2 * as.integer( f ) + 0.8 * x + rnorm(100) * 2
m1 &lt;- lm( y ~ f )

# Produce some confidence intervals for contrast to first level
( cf &lt;- ci.lin( m1, subset=-1 )[,-(2:4)] )

# Plots with increasing amounts of bells and whistles
par( mfcol=c(3,2), mar=c(3,3,2,1) )
plotEst( cf )
plotEst( cf, grid=TRUE, cex=2, lwd=3 )
plotEst( cf, grid=TRUE, cex=2, col.points="red", col.lines="green" )
plotEst( cf, grid=TRUE, cex=2, col.points="red", col.lines="green",
             xlog=TRUE, xtic=c(1:8), xlim=c(0.8,6) )
rownames( cf )[1] &lt;- "Contrast to fa:\n fb"
plotEst( cf, grid=TRUE, cex=2, col.points=rainbow(4),
                                col.lines=rainbow(4), vref=1 )
#
etxt &lt;- expression("Plain text, qouted",
                   "combined with maths:"*sqrt(a)*phi[c],
                   f^d*"  Hb"*A[1][c],
                   eff^e*"  kg/"*m^2)
plotEst( cf, txt=etxt, grid=TRUE, cex=2, col.points=rainbow(4),
                                         col.lines =rainbow(4), vref=1 )
  </code></pre>


</div>