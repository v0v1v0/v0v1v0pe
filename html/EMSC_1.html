<div class="container">

<table style="width: 100%;"><tr>
<td>EMSC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extended multiplicative signal correction (EMSC)</h2>

<h3>Description</h3>

<p>Performs model-based background correction and normalisation of spectra. EMSC handles
variations in scaling, polynomial baselines and interferents. Parameters for corrections
are stored for further analysis, and spectra are corrected accordingly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMSC(X, model = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>matrix</code> containing spectra as rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an EMSC model to use instead of the other parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>named model parameters for EMSC_model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the main EMSC function performing all calculations. It can be run with
no parameters (defaults are used), with a predefined EMSC model object or with
parameters that are passed on to the EMSC model building function <code>EMSC_model</code>.
</p>


<h3>Value</h3>

<p>An object of class EMSC is returned. This contains:
</p>

<ul>
<li> <p><code>corrected</code>: <code>matrix</code> of corrected spectra.
</p>
</li>
<li> <p><code>parameters</code>: <code>matrix</code> of fitted parameter values.
</p>
</li>
<li> <p><code>model</code>: object containing input all input parameters.
</p>
</li>
<li> <p><code>X</code>: original data.
</p>
</li>
</ul>
<h3>References</h3>

<p>H. Martens, E. Stark, Extended multiplicative signal correction and spectral
interference subtraction: new preprocessing methods for near infrared spectroscopy.
J Pharm Biomed Anal. 1991; 9(8):625-35.
</p>
<p>Joakim Skogholt, Kristian Hovde Liland, Ulf Geir Indahl,
Pre-processing of spectral data in the extended multiplicative signal correction framework using multiple reference spectra
Journal of Raman Spectroscopy 50(3), (2019), pp. 407-417.
</p>


<h3>See Also</h3>

<p><code>EMSC_model</code> <code>predict.EMSC</code> <code>plot.EMSC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(fishoil)
Raman      &lt;- fishoil$Raman[, 850:3300]
EMSC.basic &lt;- EMSC(Raman)
EMSC.poly6 &lt;- EMSC(Raman, degree = 6)
EMSC.rep   &lt;- EMSC(Raman, degree = 6, reference = Raman[30, ],
                   replicates = fishoil$replicates)

old.par  &lt;- par(mfrow = c(2,2), mar = c(4,4,1,1))
xlim     &lt;- rev(as.numeric(range(colnames(Raman))))
matplot(colnames(Raman), t(Raman), type = 'l', xlim = xlim,
        ylab = 'Relative intensity', xlab = 'Raw spectra')
matplot(colnames(Raman), t(EMSC.basic$corrected), type = 'l', xlim = xlim,
        ylab = 'Relative intensity', xlab = 'Corrected (basic)')
matplot(colnames(Raman), t(EMSC.poly6$corrected), type = 'l', xlim = xlim,
        ylab = 'Relative intensity', xlab = 'Corrected (6th degree polynomial)')
matplot(colnames(Raman), t(EMSC.rep$corrected),   type = 'l', xlim = xlim,
        ylab = 'Relative intensity', 
        xlab = 'Corrected (reference = spec. #30, replicate correction (90%))')
par(old.par)

</code></pre>


</div>