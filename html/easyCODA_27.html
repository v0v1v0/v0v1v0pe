<div class="container">

<table style="width: 100%;"><tr>
<td>RDA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Redundancy analysis
</h2>

<h3>Description</h3>

<p>Computation of weighted or unweighted redundancy analysis of a samples-by-parts compositional data table, given a set of covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RDA(data, cov=NA, nd = NA, weight = TRUE, suprow = NA, row.wt = NA) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame or matrix of interval-scale data, e.g. logratios (which are preferably in a list object with weights)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>

<p>List of covariates for constraining solution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd</code></td>
<td>

<p>Number of dimensions for summary output, by default the number of constraining dimensions
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>TRUE (default) when weights are in data list object, FALSE for unweighted analysis, or a vector of user-defined part weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suprow</code></td>
<td>

<p>Indices of rows that are supplementary (passive) points  (NOTE: this option is not implemented in this version)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.wt</code></td>
<td>

<p>Optional user-defined set of positive weights for the rows (samples) (default: equal weights)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>RDA</code> computes a redundancy analysis of a matrix of interval-scaled data, constrained by a matrix of covariates, using the singular value decomposition. 
By default weights are assumed in the data list object. 
For the unweighted logratio analysis, specify the option <code>weight=FALSE</code>. 
If <code>weight = TRUE</code> (the default) it is assumed that the weights are included in the data object, which comes from one of the logratio functions.
User-specified part weights can be provided using the same <code>weight</code> option. 
</p>
<p>Usually row weights are not specified, they are equal unless intentional weighting of the samples is desired.
Supplementary rows can be declared (also known as passive points) â€“ these do not contribute to the solution but are positioned on the solution axes.
This option will be available in the next release of the package.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sv        </code></td>
<td>
<p>Singular values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd        </code></td>
<td>
<p>Number of dimensions in the solution output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rownames  </code></td>
<td>
<p>Row names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowmass   </code></td>
<td>
<p>Row weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowdist   </code></td>
<td>
<p>Row distances to centroid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowinertia</code></td>
<td>
<p>Row variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowcoord  </code></td>
<td>
<p>Row standard coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowpcoord </code></td>
<td>
<p>Row principal coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowsup    </code></td>
<td>
<p>Indices of row supplementary points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnames  </code></td>
<td>
<p>Column names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colmass   </code></td>
<td>
<p>Column weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coldist   </code></td>
<td>
<p>Column logratio distances to centroid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colinertia</code></td>
<td>
<p>Column variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colcoord  </code></td>
<td>
<p>Column standard coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpcoord </code></td>
<td>
<p>Column principal coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covcoord  </code></td>
<td>
<p>Regression coordinates of constraining variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covnames  </code></td>
<td>
<p>Names of constraining variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N         </code></td>
<td>
<p>The data table (usually logratios in this package)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov       </code></td>
<td>
<p>The table of covariates</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Van den Wollenbergh, A. (1977), Redundancy analysis. An alternative to canonical correlation analysis, Psychometrika 42, 207-219.<br>
Greenacre, M. (2013), Contribution biplots, Journal of Computational and Graphical Statistics 22, 107-122.
</p>


<h3>See Also</h3>

<p><code>PLOT.RDA</code>, <code>CLR</code>, <code>LR</code>, <code>DUMMY</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data frame fish has sex, habitat and mass in first columns, 
# then morphometric data in remaining columns
data("fish")
sex     &lt;- fish[,1]
habitat &lt;- fish[,2]
mass    &lt;- fish[,3]
fishm   &lt;- as.matrix(fish[,4:29])
# Convert to compositional data matrix
fishm   &lt;- CLOSE(fishm)
# Compute logarithm of mass and interaction of sex (F/M) and habitat (L/P) categories
logmass &lt;- log(mass)
sexhab  &lt;- 2*(sex-1)+habitat
sexhab.names &lt;- c("FL","FP","ML","MP")
rownames(fishm) &lt;- sexhab.names[sexhab]
# Create dummy variables for sexhab and create matrix of covariates
sexhab.Z &lt;- DUMMY(sexhab, catnames=sexhab.names)
vars     &lt;- cbind(logmass, sexhab.Z)
# Perform RDA on centred logratios
require(ca)
fish.rda &lt;- RDA(CLR(fishm), cov=vars)
# Plot results 
# (for more options see Appendix of Compositional Data Analysis in Practice)
PLOT.RDA(fish.rda, map="contribution", rescale=0.05, indcat=2:5, 
         colrows=rainbow(4, start=0.1, end=0.8)[sexhab], cexs=c(0.8,0.8,1))
</code></pre>


</div>