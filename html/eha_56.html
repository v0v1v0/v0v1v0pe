<div class="container">

<table style="width: 100%;"><tr>
<td>make.communal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Put communals in "fixed" data frame</h2>

<h3>Description</h3>

<p>Given an ordinary data frame suitable for survival analysis, and a data
frame with "communal" time series, this function includes the communal
covariates as fixed, by the "cutting spells" method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.communal(
  dat,
  com.dat,
  communal = TRUE,
  start,
  period = 1,
  lag = 0,
  surv = c("enter", "exit", "event", "birthdate"),
  tol = 1e-04,
  fortran = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data frame containing interval specified survival data and
covariates, of which one must give a "birth date", the connection between
duration and calendar time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>com.dat</code></td>
<td>
<p>Data frame with communal covariates. They must have the same
start year and periodicity, given by <code>start</code> and <code>lag</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>communal</code></td>
<td>
<p>Boolean; if TRUE, then it is a true communal (default),
otherwise a fixed. The first component is the first year (start date in
decimal form), and the second component is the period length. The third is
<code>lag</code> and the fourth is <code>scale</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Start date in decimal form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Period length. Defaults to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>The lag of the effect. Defaults to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p>Character vector of length 4 giving the names of interval start,
interval end, event indicator, birth date, in that order. These names must
correspond to names in <code>dat</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Largest length of an interval considered to be of zero length.
The cutting sometimes produces zero length intervals, which we want to
discard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fortran</code></td>
<td>
<p>If <code>TRUE</code>, then a Fortran implementation of the function
is used. This is the default. This possibility is only for debugging
purposes. You should of course get identical results with the two methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main purpose of this function is to prepare a data file for use with
<code>coxreg</code>, <code>aftreg</code>, and
<code>coxph</code>.
</p>


<h3>Value</h3>

<p>The return value is a data frame with the same variables as in the
combination of <code>dat</code> and <code>com.dat</code>. Therefore it is an error to
have common name(s) in the two data frames.
</p>


<h3>Note</h3>

<p>Not very vigorously tested.
</p>


<h3>Author(s)</h3>

<p>Göran Broström
</p>


<h3>See Also</h3>

<p><code>coxreg</code>, <code>aftreg</code>,
<code>coxph</code>, <code>cal.window</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
dat &lt;- data.frame(enter = 0, exit = 5.731, event = 1,
birthdate = 1962.505, x = 2)
## Birth date: July 2, 1962 (approximately).
com.dat &lt;- data.frame(price = c(12, 3, -5, 6, -8, -9, 1, 7))
dat.com &lt;- make.communal(dat, com.dat, start = 1962.000) 

</code></pre>


</div>