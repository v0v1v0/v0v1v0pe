<div class="container">

<table style="width: 100%;"><tr>
<td>Optimal.Similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Optimal scale parameter to transform a distance matrix into a similarity matrix
</h2>

<h3>Description</h3>

<p>Calculates the scale parameter <code class="reqn">u</code> that maximizes the variance of the similarity matrix <code class="reqn">exp(-u*DistanceMatrix)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Optimal.Similarity(Distance, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Distance</code></td>
<td>

<p>A distance matrix, <em>i.e.</em> a square matrix with zeros on its diagonal or a <code>dist</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The similarity matrix used by <code>Dqz</code>) can be optimized following Marcon <em>et al.</em> (2014) such that the variance of similarities between pairs of species is maximized. See the example.
</p>


<h3>Value</h3>

<p>A list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The optimal scale <code class="reqn">u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Matrix</code></td>
<td>
<p>The optimal similarity matrix <code>Z</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>


<h3>See Also</h3>

<p><code>Dqz</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix. The square root of Paracou618.dist is euclidean.
optimal &lt;- Optimal.Similarity(sqrt(Paracou618.dist))
# Optimal scale
optimal$u
# Calculate diversity of order 2
bcDqz(Paracou618.MC$Ns, 2, optimal$Matrix)
</code></pre>


</div>