<div class="container">

<table style="width: 100%;"><tr>
<td>EllCopLikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of the likelihood of an elliptical copula</h2>

<h3>Description</h3>

<p>Computes the likelihood
</p>
<p style="text-align: center;"><code class="reqn">\frac{g(Q_g(U) \Sigma^{-1} Q_g(U))}{f_g(Q_g(U_1)) \cdots f_g(Q_g(U_d))}
</code>
</p>

<p>for a vector <code class="reqn">(U_1, \dots, U_d)</code> on the unit cube
and for a <code class="reqn">d</code>-dimensional generator <code class="reqn">g</code> whose univariate density and quantile functions
are respectively <code class="reqn">f_g</code> and <code class="reqn">Q_g</code>.
This is to the likelihood of the copula associated with the elliptical distribution
having density <code class="reqn">|det(\Sigma)|^{-1/2} g(x \Sigma^{-1} x)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EllCopLikelihood(grid, g_d, pointsToCompute, Sigma_m1, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>the discretization grid on which the generator is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_d</code></td>
<td>
<p>the values of the <code class="reqn">d</code>-dimensional density generator on the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointsToCompute</code></td>
<td>
<p>the points <code class="reqn">U</code> at which the likelihood should be computed.
If <code>pointsToCompute</code> is a vector, then its length is used as the dimension <code class="reqn">d</code> of the space.
If it is a matrix, then the dimension of the space is the number of columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_m1</code></td>
<td>
<p>the inverse correlation matrix of the elliptical distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>if <code>TRUE</code>, this returns the log-likelihood instead of the likelihood.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector (of length 1 if <code>pointsToCompute</code> is a vector) of likelihoods
associated with each observation.
</p>


<h3>References</h3>

<p>Derumigny, A., &amp; Fermanian, J. D. (2022).
Identifiability and estimation of meta-elliptical copula generators.
Journal of Multivariate Analysis, article 104962.
<a href="https://doi.org/10.1016/j.jmva.2022.104962">doi:10.1016/j.jmva.2022.104962</a>.
</p>


<h3>See Also</h3>

<p><code>EllCopEst</code> for the estimation of elliptical copula,
<code>EllCopEst</code> for the estimation of elliptical copula.
</p>


<h3>Examples</h3>

<pre><code class="language-R">grid = seq(0,50,by = 0.01)
gdnorm = DensityGenerator.normalize(grid = grid, grid_g = exp(-grid/2), d = 3)
gdnorm2 = DensityGenerator.normalize(grid = grid, grid_g = 1/(1+grid^2), d = 3)
X = EllCopSim(n = 30, d = 3, grid = grid, g_d = gdnorm)
logLik = EllCopLikelihood(grid , g_d = gdnorm , X,
                          Sigma_m1 = diag(3), log = TRUE)
logLik2 = EllCopLikelihood(grid , g_d = gdnorm2 , X,
                           Sigma_m1 = diag(3), log = TRUE)
print(c(sum(logLik), sum(logLik2)))

</code></pre>


</div>