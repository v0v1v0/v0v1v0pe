<div class="container">

<table style="width: 100%;"><tr>
<td>epx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting an Ensemble of Phalanxes</h2>

<h3>Description</h3>

<p><code>epx</code> forms phalanxes of variables from training data for
binary classification with a rare class. The phalanxes are
disjoint subsets of variables, each of which is fit with a base classifier.
Together they form an ensemble.
</p>


<h3>Usage</h3>

<pre><code class="language-R">epx(
  x,
  y,
  phalanxes.initial = c(1:ncol(x)),
  alpha = 0.95,
  nsim = 1000,
  rmin.target = 1,
  classifier = "random forest",
  classifier.args = list(),
  performance = "AHR",
  performance.args = list(),
  computing = "sequential",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Explanatory variables (predictors, features) contained in a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Binary response variable vector (numeric or integer):
1 for the rare class, 0 for the majority class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phalanxes.initial</code></td>
<td>
<p>Initial variable group indices; default one group
per variable. Example: vector c(1, 1, 2, 2, 3, ...) puts variables 1 and 2
in group 1, variables 3 and 4 in group, 2, etc.  Indices cannot
be skipped, e.g., c( 1, 3, 3, 4, 4, 3, 1) skips group 2 and is invalid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Lower-tail probability for the critical quantile of the reference
distribution of the <code>performance</code> measure for a classifier that ranks
at random (i.e., the predictors have no explanatory power); default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations for the reference empirical distribution of
the performance measure; default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmin.target</code></td>
<td>
<p>To merge the pair of groups with the
minimum ratio of performance measures (ensemble of models to single model)
into a single group their ratio must be less than
<code>rmin.target</code>, otherwise merging stops; default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classifier</code></td>
<td>
<p>Base classifier, one of
<code>c("random forest", "logistic regression", "neural network")</code>;
default is "random forest", which uses
<code>randomForest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classifier.args</code></td>
<td>
<p>Arguments for the base <code>classifier</code>
specified in a list as follows: <code>list(argName1 = value1, argName2 =
  value2, ...)</code>. If the list is empty, the classifier will use
its defaults.  For "random forest", user may specify <code>replace, cutoff,
  nodesize, maxnodes</code>. For "logistic regression" there are no options. For
"neural network", user may specify <code>size, trace</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>performance</code></td>
<td>
<p>Performance assessment metric, one of
<code>c("AHR", "IE", "TOP1", "RKL")</code>;
default is <code>AHR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>performance.args</code></td>
<td>
<p>Arguments for the <code>performance</code> measure
specified in a list as follows:
<code>list(argName1 = value1, argName2 = value2, ...)</code>.
If the list is empty, the performance measure will use its
defaults. Currently,  only <code>IE</code> takes an argument list,
and its only argument is <code>cutoff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computing</code></td>
<td>
<p>Whether to compute sequentially or in parallel. Input is one
of <code>c("sequential", "parallel")</code>; default is "sequential".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please see Tomal et al. (2015) for more description of phalanx formation.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>epx</code>, which is
a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PHALANXES</code></td>
<td>
<p>List of four vectors, each the same length as the number of
explanatory variables (columns in <code>x</code>): <code>phalanxes.initial</code>,
<code>phalanxes.filtered</code>, <code>phalanxes.merged</code>, <code>phalanxes.final</code>.
Each vector contains the phalanx membership indices of all explanatory variables
at one of the four stages of phalanx-formation. Element <code class="reqn">i</code> of a vector
is the index of the phalanx to which variable <code class="reqn">i</code> belongs. Phalanx 0 does
not exist and so membership in phalanx 0 indicates that the variable does not
belong to any phalanx; it has been screened out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PHALANXES.FINAL.PERFORMANCE</code></td>
<td>
<p>Vector of <code>performance</code> measures of
the final phalanxes: the first element is for phalanx 1, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PHALANXES.FINAL.FITS</code></td>
<td>
<p>A matrix with number of rows equal to the number
of observations in the training data and number of columns equal to the
number of final phalanxes.  Column <code class="reqn">i</code> contains the predicted
probabilities of class 1 from fitting the base <code>classifier</code> to the
variables in phalanx <code class="reqn">i</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ENSEMBLED.FITS</code></td>
<td>
<p>The predicted probabilities of class 1 from the
ensemble of phalanxes based on <code>phalanxes.final</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BASE.CLASSIFIER.ARGS</code></td>
<td>
<p>(Parsed) record of user-specified arguments for
<code>classifier</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PERFORMANCE.ARGS</code></td>
<td>
<p>(Parsed) record of user-specified arguments for
<code>performance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>User-provided data frame of explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>User-provided binary response vector.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Tomal, J. H., Welch, W. J., &amp; Zamar, R. H. (2015).
Ensembling classification models based on phalanxes of variables with
applications in drug discovery.
<em>The Annals of Applied Statistics</em>,
<em>9</em>(1), 69-93.
doi: <a href="https://doi.org/10.1214/14-AOAS778">10.1214/14-AOAS778</a>
</p>


<h3>See Also</h3>

<p><code>summary.epx</code> prints a summary of the results,
and <code>cv.epx</code> assesses performance via cross-validation.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example with data(harvest)

## Phalanx-formation using a base classifier with 50 trees (default = 500)

set.seed(761)
model &lt;- epx(x = harvest[, -4], y = harvest[, 4],
             classifier.args = list(ntree = 50))

## Phalanx-membership of explanatory variables at the four stages
## of phalanx formation (0 means not in a phalanx)
model$PHALANXES

## Summary of the final phalanxes (matches above)
summary(model)
## Not run: 
## Parallel computing
clusters &lt;- parallel::detectCores()
cl &lt;- parallel::makeCluster(clusters)
doParallel::registerDoParallel(cl)
set.seed(761)
model.par &lt;- epx(x = harvest[, -4], y = harvest[, 4],
                 computing = "parallel")
parallel::stopCluster(cl)

## End(Not run)

</code></pre>


</div>