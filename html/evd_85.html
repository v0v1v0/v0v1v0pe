<div class="container">

<table style="width: 100%;"><tr>
<td>fbvevd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum-likelihood Fitting of Bivariate Extreme Value Distributions</h2>

<h3>Description</h3>

<p>Fit models for one of nine parametric bivariate extreme value
distributions, including linear modelling of the marginal
location parameters, and allowing any of the parameters to be held
fixed if desired. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">fbvevd(x, model = c("log", "alog", "hr", "neglog", "aneglog", "bilog",
    "negbilog", "ct", "amix"), start, ..., sym = FALSE,
    nsloc1 = NULL, nsloc2 = NULL, cshape = cscale, cscale = cloc,
    cloc = FALSE, std.err = TRUE, corr = FALSE, method = "BFGS",
    warn.inf = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix or data frame, ordinarily with two columns,
which may contain missing values. A data frame may also
contain a third column of mode <code>logical</code>, which
itself may contain missing values (see <b>More Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The specified model; a character string. Must be
either <code>"log"</code> (the default), <code>"alog"</code>, <code>"hr"</code>,
<code>"neglog"</code>, <code>"aneglog"</code>, <code>"bilog"</code>,
<code>"negbilog"</code>, <code>"ct"</code> or <code>"amix"</code> (or any unique
partial match), for the logistic, asymmetric logistic,
Husler-Reiss, negative logistic, asymmetric negative logistic,
bilogistic, negative bilogistic, Coles-Tawn and asymmetric
mixed models respectively. The definition of each model is
given in <code>rbvevd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values for the
parameters over which the likelihood is to be maximized.
If <code>start</code> is omitted the routine attempts to find good
starting values using marginal maximum likelihood estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters, either for the bivariate extreme
value model or for the optimization function <code>optim</code>. If
parameters of the model are included they will be held fixed at
the values given (see <b>Examples</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sym</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the dependence structure
of the models <code>"alog"</code>, <code>"aneglog"</code> or <code>"ct"</code> are
constrained to be symmetric (see <b>Details</b>). For all other
models, the argument is ignored (and a warning is given).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsloc1, nsloc2</code></td>
<td>
<p>A data frame with the same number of rows as
<code>x</code>, for linear modelling of the location parameter on the
first/second margin (see <b>Details</b>).
The data frames are treated as covariate matrices, excluding the
intercept. A numeric vector can be given as an alternative to a
single column data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cshape</code></td>
<td>
<p>Logical; if <code>TRUE</code>, a common shape parameter is
fitted to each margin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cscale</code></td>
<td>
<p>Logical; if <code>TRUE</code>, a common scale parameter is
fitted to each margin, and the default value of <code>cshape</code>
is then <code>TRUE</code>, so that under this default common scale
and shape parameters are fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloc</code></td>
<td>
<p>Logical; if <code>TRUE</code>, a common location parameter is
fitted to each margin, and the default values of <code>cshape</code>
and <code>cscale</code> are then <code>TRUE</code>, so that under these
defaults common marginal parameters are fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>Logical; if <code>TRUE</code> (the default), the standard
errors are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the correlation matrix is
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The optimization method (see <code>optim</code> for
details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.inf</code></td>
<td>
<p>Logical; if <code>TRUE</code> (the default), a warning is
given if the negative log-likelihood is infinite when evaluated at
the starting values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dependence parameter names are one or more of <code>dep</code>,
<code>asy1</code>, <code>asy2</code>, <code>alpha</code> and <code>beta</code>, depending on
the model selected (see <code>rbvevd</code>).  The marginal parameter
names are <code>loc1</code>, <code>scale1</code> and <code>shape1</code> for the first
margin, and <code>loc2</code>, <code>scale2</code> and <code>shape2</code> for the
second margin.
If <code>nsloc1</code> is not <code>NULL</code>, so that a linear model is
implemented for the first marginal location parameter, the parameter
names for the first margin are <code>loc1</code>, <code>loc1</code><em>x1</em>,
..., <code>loc1</code><em>xn</em>, <code>scale</code> and <code>shape</code>, where
<em>x1</em>, ..., <em>xn</em> are the column names of <code>nsloc1</code>,
so that <code>loc1</code> is the intercept of the linear model, and
<code>loc1</code><em>x1</em>, ..., <code>loc1</code><em>xn</em> are the
<code>ncol(nsloc1)</code> coefficients.
When <code>nsloc2</code> is not <code>NULL</code>, the parameter names for the
second margin are constructed similarly.
</p>
<p>It is recommended that the covariates within the linear models for
the location parameters are (at least approximately) centered and
scaled (i.e. that the columns of <code>nsloc1</code> and <code>nsloc2</code>
are centered and scaled), particularly if automatic starting values
are used, since the starting values for the associated parameters are
then zero. If <code>cloc</code> is <code>TRUE</code>, both <code>nsloc1</code> and
<code>nsloc2</code> must be identical, since a common linear model is
then implemented on both margins.
</p>
<p>If <code>cshape</code> is true, the models are constrained so that
<code>shape2 = shape1</code>. The parameter <code>shape2</code> is then
taken to be specified, so that e.g. the common shape
parameter can only be fixed at zero using <code>shape1 = 0</code>,
since using <code>shape2 = 0</code> gives an error. Similar
comments apply for <code>cscale</code> and <code>cloc</code>.
</p>
<p>If <code>sym</code> is <code>TRUE</code>, the asymmetric logistic and
asymmetric negative logistic models are constrained so that
<code>asy2 = asy1</code>, and the Coles-Tawn model is constrained
so that <code>beta = alpha</code>. The parameter <code>asy2</code> or
<code>beta</code> is then taken to be specified, so that e.g.
the parameters <code>asy1</code> and <code>asy2</code> can only
be fixed at <code>0.8</code> using <code>asy1 = 0.8</code>, since
using <code>asy2 = 0.8</code> gives an error.
</p>
<p>Bilogistic and negative bilogistic models constrained to
symmetry are logistic and negative logistic models
respectively. The (symmetric) mixed model (e.g. Tawn, 1998)
can be obtained as a special case of the asymmetric
logistic or asymmetric mixed models (see <b>Examples</b>).
</p>
<p>The value <code>Dependence</code> given in the printed output
is <code class="reqn">2(1-A(1/2))</code>, where <code class="reqn">A</code> is the estimated dependence
function (see <code>abvevd</code>). It measures the strength of
dependence, and lies in the interval [0,1]; at independence and
complete dependence it is zero and one respectively (Coles,
Heffernan and Tawn, 1999). See <code>chiplot</code> for
further information.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>c("bvevd","evd")</code>.
</p>
<p>The generic accessor functions <code>fitted</code> (or
<code>fitted.values</code>), <code>std.errors</code>,
<code>deviance</code>, <code>logLik</code> and
<code>AIC</code> extract various features of the
returned object.
</p>
<p>The functions <code>profile</code> and <code>profile2d</code> can be
used to obtain deviance profiles.
The function <code>anova</code> compares nested models, and the
function <code>AIC</code> compares non-nested models.
The function <code>plot</code> produces diagnostic plots.
</p>
<p>An object of class <code>c("bvevd","evd")</code> is a list containing
the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>A vector containing the maximum likelihood estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>A vector containing the standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A vector containing the parameters that have been fixed
at specific values within the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed2</code></td>
<td>
<p>A vector containing the parameters that have been set
to be equal to other model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A vector containing all parameters (those optimized,
those fixed to specific values, and those set to be
equal to other model parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>The deviance at the maximum likelihood estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep.summary</code></td>
<td>
<p>The estimate of <code class="reqn">2(1-A(1/2))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>The correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cov</code></td>
<td>
<p>The variance covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence, counts, message</code></td>
<td>
<p>Components taken from the
list returned by <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data passed to the argument <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tdata</code></td>
<td>
<p>The data, transformed to stationarity (for non-stationary
models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsloc1, nsloc2</code></td>
<td>
<p>The arguments <code>nsloc1</code> and <code>nsloc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of rows in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sym</code></td>
<td>
<p>The argument <code>sym</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmar</code></td>
<td>
<p>The vector <code>c(cloc, cscale, cshape)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The argument <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call of the current function.</p>
</td>
</tr>
</table>
<h3>More Details</h3>

<p>If <code>x</code> is a data frame with a third column of mode
<code>logical</code>, then the model is fitted using the likelihood
derived by Stephenson and Tawn (2004). This is appropriate
when each bivariate data point comprises componentwise maxima
from some underlying bivariate process, and where the
corresponding logical value denotes whether or not the maxima
were caused by the same event within that process.
</p>
<p>Under this scheme the diagnostic plots that are produced
using <code>plot</code> are somewhat different to those described
in <code>plot.bvevd</code>: the density, dependence function
and quantile curves plots contain fitted functions for
observations where the logical case is unknown, and the
conditional P-P plots condition on both the logical case and
the given margin (which requires numerical integration at each
data point).
</p>


<h3>Artificial Constraints</h3>

<p>For numerical reasons parameters are subject to artificial
constraints. Specifically, these constraints are: marginal
scale parameters not less than 0.01; <code>dep</code> not less
than [0.1] [0.2] [0.05] in [logistic] [Husler-Reiss]
[negative logistic] models; <code>dep</code> not greater
than [10] [5] in [Husler-Reiss] [negative logistic] models;
<code>asy1</code> and <code>asy2</code> not less than 0.001;
<code>alpha</code> and <code>beta</code> not less than [0.1] [0.1]
[0.001] in [bilogistic] [negative bilogistic] [Coles-Tawn]
models; <code>alpha</code> and <code>beta</code> not greater than [0.999]
[20] [30] in [bilogistic] [negative bilogistic] [Coles-Tawn]
models.
</p>


<h3>Warning</h3>

<p>The standard errors and the correlation matrix in the returned
object are taken from the observed information, calculated by a
numerical approximation.
They must be interpreted with caution when either of the
marginal shape parameters are less than <code class="reqn">-0.5</code>, because
the usual asymptotic properties of maximum likelihood estimators
do not then hold (Smith, 1985).
</p>


<h3>References</h3>

<p>Coles, S. G., Heffernan, J. and Tawn, J. A. (1999)
Dependence measures for extreme value analyses.
<em>Extremes</em>, <b>2</b>, 339–365.
</p>
<p>Smith, R. L. (1985)
Maximum likelihood estimation in a class of non-regular cases.
<em>Biometrika</em>, <b>72</b>, 67–90.
</p>
<p>Stephenson, A. G. and Tawn, J. A. (2004)
Exploiting Occurence Times in Likelihood Inference for
Componentwise Maxima.
<em>Biometrika</em> <b>92</b>(1), 213–217.
</p>
<p>Tawn, J. A. (1988)
Bivariate extreme value theory: models and estimation.
<em>Biometrika</em>, <b>75</b>, 397–415.
</p>


<h3>See Also</h3>

<p><code>anova.evd</code>, <code>optim</code>,
<code>plot.bvevd</code>, <code>profile.evd</code>,
<code>profile2d.evd</code>, <code>rbvevd</code></p>


<h3>Examples</h3>

<pre><code class="language-R">bvdata &lt;- rbvevd(100, dep = 0.6, model = "log", mar1 = c(1.2,1.4,0.4))
M1 &lt;- fbvevd(bvdata, model = "log")
M2 &lt;- fbvevd(bvdata, model = "log", dep = 0.75)
anova(M1, M2)
par(mfrow = c(2,2))
plot(M1)
plot(M1, mar = 1)
plot(M1, mar = 2)
## Not run: par(mfrow = c(1,1))
## Not run: M1P &lt;- profile(M1, which = "dep")
## Not run: plot(M1P)

trend &lt;- (-49:50)/100
rnd &lt;- runif(100, min = -.5, max = .5)
fbvevd(bvdata, model = "log", nsloc1 = trend)
fbvevd(bvdata, model = "log", nsloc1 = trend, nsloc2 = data.frame(trend
= trend,  random = rnd))
fbvevd(bvdata, model = "log", nsloc1 = trend, nsloc2 = data.frame(trend
= trend, random = rnd), loc2random = 0)

bvdata &lt;- rbvevd(100, dep = 1, asy = c(0.5,0.5), model = "anegl")
anlog &lt;- fbvevd(bvdata, model = "anegl")
mixed &lt;- fbvevd(bvdata, model = "anegl", dep = 1, sym = TRUE)
anova(anlog, mixed)
amixed &lt;- fbvevd(bvdata, model = "amix")
mixed &lt;- fbvevd(bvdata, model = "amix", beta = 0)
anova(amixed, mixed)
</code></pre>


</div>