<div class="container">

<table style="width: 100%;"><tr>
<td>ACLUST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Amalgamation clustering of the parts of a compositional data matrix
</h2>

<h3>Description</h3>

<p>This function clusters the parts of a compositional data matrix, using amalgamation of the parts at each step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ACLUST(data, weight = TRUE, close = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Compositional data matrix, with the parts as columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p><code>TRUE</code> (default) for weighting using part averages of closed compositions, <code>FALSE</code> for unweighted analysis, or a vector of user-defined column weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>close</code></td>
<td>

<p><code>TRUE</code> (default) will close the rows of <code>data</code> prior to clustering, <code>FALSE</code> leaves <code>data</code> as it is
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>ACLUST</code> performs amalgamation hierarchical clustering on the parts (columns) of a given compositional data matrix, as proposed by Greenacre (2019).
At each step of the clustering two clusters are amalgamated that give the least loss of explained logratio variance.
</p>


<h3>Value</h3>

<p>An object which describes the tree produced by the clustering process on the n objects. The object is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>merge  </code></td>
<td>
<p>an n-1 by 2 matrix. Row i of <code>merge</code> describes the merging of clusters at step i of the clustering. If an element j in the row is negative, then observation -j was merged at this stage. If j is positive then the merge was with the cluster formed at the (earlier) stage j of the algorithm. Thus negative entries in <code>merge</code> indicate agglomerations of singletons, and positive entries indicate agglomerations of non-singletons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height </code></td>
<td>
<p>a set of n-1 real values (non-decreasing for ultrametric trees). The clustering height: that is, the value of the criterion associated with the clustering method for the particular agglomeration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order  </code></td>
<td>
<p>a vector giving the permutation of the original observations suitable for plotting, in the sense that a cluster plot using this ordering and matrix merge will not have crossings of the branches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels </code></td>
<td>
<p>a vector of column labels, the column names of <code>data</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Greenacre, M. (2018), Compositional Data Analysis in Practice, Chapman &amp; Hall / CRC. <br>
Greenacre, M. (2019), Amalgamations are valid in compositional data analysis,
can be used in agglomerative clustering, and their
logratios have an inverse transformation.
Applied Computing and Geosciences, open access.<br></p>


<h3>See Also</h3>

<p><code>hclust</code>, <code>WARD</code>,<code>CLR</code>, <code>LR.VAR</code>,
<code>CLOSE</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cups)

# amalgamation clustering    (weighted parts)
cups.aclust &lt;- ACLUST(cups)
plot(cups.aclust)

# reproducing Figure 2(b) of Greenacre (2019) (unweighted parts))
# dataset Aar is in the compositions package
# aar is a subset of Aar
# code given here within the '\dontrun' environment since external package 'compositions' required
## Not run: 
  library(compositions)
  data(Aar)
  aar &lt;- Aar[,c(3:12)]
  aar.aclust &lt;- ACLUST(aar, weight=FALSE)
# the maximum height is the total variance
# convert to percents of variance NOT explained
  aar.aclust$height &lt;- 100 * aar.aclust$height / max(aar.aclust$height)
  plot(aar.aclust, main="Parts of Unexplained Variance", ylab="Variance (percent)")

## End(Not run)
</code></pre>


</div>