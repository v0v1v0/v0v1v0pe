<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_aftershocks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a catalog of aftershocks</h2>

<h3>Description</h3>

<p>When a catalog of background earthquakes is given, this function can be applied
to simulate aftershocks under the intensity function
<code class="reqn">\sum_{i:t_i&lt;t}\hat{k}(m_i)\hat{g}(t-t_i)\hat{f}(x-x_i,y-y_i \mid m_i)</code>, which
is determined by the target parameter values given by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_aftershocks(
  parameters_target,
  background_catalog,
  time_begin_background = NULL,
  longitude_limit = NULL,
  latitude_limit = NULL,
  time_limit = NULL,
  magnitude_sample = NULL,
  magnitude_threshold = NULL,
  time_zone = "GMT"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parameters_target</code></td>
<td>
<p>A numerical vector of size 7, (<code class="reqn">\hat{A},\hat{c},\hat{\alpha},\hat{p},\hat{D},\hat{q},\hat{\gamma}</code>), specifying the target values of
parameters in the ETAS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background_catalog</code></td>
<td>
<p>An object of class "data.frame" with 5 columns: recording date, time, longitude, latitude,
and magnitude of the background events, in this order and in a format consistent with that of <b>earthquake_data</b>
in the function <code>ETAS_Boots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_begin_background</code></td>
<td>
<p>A character string, in the date-time format, that specifies the
beginning of the time span in <b>background_catalog</b>. If NULL, it will be set by the program to the
date-time of the first earthquake in <b>background_catalog</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitude_limit</code></td>
<td>
<p>A vector of size 2 (xlim_min, xlim_max) specifying the
longitude boundaries for the simulated aftershocks. If NULL, xlim_min and
xlim_max will be set by the program to the minimum and maximum values of the
longitude for the earthquakes in <b>background_catalog</b>, respectively. Only the simulated
aftershocks with a longitude inside <b>longitude_limit</b> will be kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude_limit</code></td>
<td>
<p>A vector of size 2 (ylim_min, ylim_max) specifying the
latitude boundaries for the simulated aftershocks. If NULL, ylim_min and
ylim_max will be set by the program to the minimum and maximum values of
latitude for the earthquakes in <b>background_catalog</b>, respectively. Only the simulated
aftershocks with a latitude inside <b>latitude_limit</b> will be kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_limit</code></td>
<td>
<p>A vector of size 2 (tlim_min, tlim_max) specifying the time span for
the simulated aftershocks. If NULL, tlim_min and tlim_max will be set by the program to the
date-time of the first and last earthquakes (in chronological order) in <b>background_catalog</b>,
respectively. Only the simulated aftershocks inside the specified time span will be kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magnitude_sample</code></td>
<td>
<p>A vector recording the sample from the distribution of earthquake magnitudes (<code class="reqn">s_{\beta}(m)</code>).
If NULL, the magnitudes of earthquakes in <b>background_catalog</b> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magnitude_threshold</code></td>
<td>
<p>A decimal value specifying the magnitude
threshold to be applied. Only the simulated aftershocks with a magnitude of at least
<b>mag_threshold</b> will be kept. 
If NULL, the minimum magnitude of the events in <b>background_catalog</b> will be used as
<b>magnitude_threshold</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_zone</code></td>
<td>
<p>A character string specifying the time zone. The default setting
"GMT" is the UTC (Universal Time Coordinated).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>aftershocks_simulated: An object of class "data.frame" with 5 columns: recording the
date, time, longitude, latitude and magnitude of the simulated
aftershocks, in this order and a consistent format.
</p>


<h3>References</h3>

<p>Dutilleul, P., Genest, C., Peng, R., 2024. Bootstrapping for parameter uncertainty
in the space-time epidemic-type aftershock sequence model. Geophysical Journal 
International 236, 1601â€“1608.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
simulate_aftershocks(parameters_target = c(0.2424, 0.0068, 0.9771, 1.2200, 
                                           0.0033, 2.4778, 0.1718),
                     background_catalog = VCI_simulated_background_earthquakes,
                     time_begin_background = "2000/01/01",
                     longitude_limit = c(-131, -126.25),
                     latitude_limit = c(48, 50),
                     time_limit = c("2000/01/01", "2018/04/27"),
                     magnitude_sample = VCI_magnitude_sample,
                     magnitude_threshold = 3.5,
                     time_zone="GMT")

</code></pre>


</div>