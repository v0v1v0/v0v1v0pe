<div class="container">

<table style="width: 100%;"><tr>
<td>ecospat.calculate.pd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Phylogenetic Diversity Measures</h2>

<h3>Description</h3>

<p>Calculate all phylogenetic diversity measures listed in Schweiger et al., 2008 (see full reference below).</p>


<h3>Usage</h3>

<pre><code class="language-R">ecospat.calculate.pd (tree, data, method="spanning", type="clade", root=FALSE, 
average=FALSE, verbose=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>The phylogenetic tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A presence or absence (binary) matrix for each species (columns) in each location or grid cell (rows)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method to use. Options are "pairwise", "topology", and "spanning". Default is "spanning".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Phylogenetic measure from those listed in Schweiger et al 2008. Options are "Q", "P", "W", "clade", "species", "J", "F", "AvTD","TTD", "Dd". Default is "clade".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>Phylogenetic diversity can either be rooted or unrooted. Details in Schweiger et al 2008. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>Phylogenetic diversity can either be averaged or not averaged. Details in Schweiger et al 2008. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a phylogenetic tree and a presence/absence matrix this script calculates phylogenetic diversity of a group of species across a given set of grid cells or locations. The library "ape" is required to read the tree in R. Command is "read.tree" or "read.nexus".
Options of type:
"P" is a normalized mearure of "Q".
"clade" is "PDnode" when root= FALSE, and is "PDroot" ehn root =TRUE.
"species" is "AvPD".
</p>


<h3>Value</h3>

<p>This function returns a list of phylogenetic diversity values for each of the grid cells in the presence/absence matrix</p>


<h3>Author(s)</h3>

<p>Nicolas Salamin <a href="mailto:nicolas.salamin@unil.ch">nicolas.salamin@unil.ch</a> and Dorothea Pio <a href="mailto:Dorothea.Pio@fauna-flora.org">Dorothea.Pio@fauna-flora.org</a></p>


<h3>References</h3>

<p>Schweiger, O., S. Klotz, W. Durka and I. Kuhn. 2008. A comparative test of phylogenetic diversity indices. <em>Oecologia</em>, <b>157</b>, 485-495.
</p>
<p>Pio, D.V., O. Broennimann, T.G. Barraclough, G. Reeves, A.G. Rebelo, W. Thuiller, A. Guisan and N. Salamin. 2011. Spatial predictions of phylogenetic diversity in conservation decision making. <em>Conservation Biology</em>, <b>25</b>, 1229-1239.
</p>
<p>Pio, D.V., R. Engler, H.P. Linder, A. Monadjem, F.P.D. Cotterill, P.J. Taylor, M.C. Schoeman, B.W. Price, M.H. Villet, G. Eick, N. Salamin and A. Guisan. 2014. Climate change effects on animal and plant phylogenetic diversity in southern Africa. <em>Global Change Biology</em>, <b>20</b>, 1538-1549.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
fpath &lt;- system.file("extdata", "ecospat.testTree.tre", package="ecospat")
library(ape)
tree &lt;-ape::read.tree(fpath)
data &lt;- ecospat.testData[9:52] 

pd &lt;- ecospat.calculate.pd(tree, data, method = "spanning", type = "species", root = FALSE, 
average = FALSE, verbose = TRUE )

plot(pd)
</code></pre>


</div>