<div class="container">

<table style="width: 100%;"><tr>
<td>el2.test.wts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes maximium-likelihood probability jumps for a single mean-type hypothesis, based on two independent uncensored samples</h2>

<h3>Description</h3>

<p>This function computes the maximum-likelihood probability jumps for a single mean-type hypothesis, based on two samples
that are independent, uncensored, and weighted.  The target function (Lagrangian) for the maximization is the constrained
log(empirical likelihood) which can be expressed as,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{dx_i=1} wx_i \log{\mu_i} + \sum_{dy_j=1} wy_j \log{\nu_j} - \eta ( 1 - \sum_{dx_i=1} \mu_i ) - \delta
( 1 -\sum_{dy_j=1} \nu_j ) - \lambda \sum_{dx_i=1} \sum_{dy_j=1} ( g(x_i,y_j)- mean ) \mu_i \nu_j </code>
</p>

<p>where the variables are defined as follows:
</p>
<p><code class="reqn">x</code> is a vector of data for the first sample
</p>
<p><code class="reqn">y</code> is a vector of data for the second sample
</p>
<p><code class="reqn">wx</code> is a vector of estimated weights for the first sample
</p>
<p><code class="reqn">wy</code> is a vector of estimated weights for the second sample
</p>
<p><code class="reqn">\mu</code> is a vector of estimated probability jumps for the first sample
</p>
<p><code class="reqn">\nu</code> is a vector of estimated probability jumps for the second sample
</p>


<h3>Usage</h3>

<pre><code class="language-R">el2.test.wts(u,v,wu,wv,mu0,nu0,indicmat,mean,lamOld=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a vector of uncensored data for the first sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>a vector of uncensored data for the second sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wu</code></td>
<td>
<p>a vector of estimated weights for <code>u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wv</code></td>
<td>
<p>a vector of estimated weights for <code>v</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>a vector of estimated probability jumps for <code>u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0</code></td>
<td>
<p>a vector of estimated probability jumps for <code>v</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indicmat</code></td>
<td>
<p>a matrix <code class="reqn">[g(u_i,v_j)-mean]</code> where <code class="reqn">g(u, v)</code> is a user-chosen function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a hypothesized value of <code class="reqn">E(g(u,v))</code>, where <code class="reqn">E</code> indicates “expected value.”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamOld</code></td>
<td>
<p>The previous solution of lambda, used as the starting point to search for new solution of lambda.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is called by <code>el2.cen.EMs</code>.  It is listed here because the user may find it useful elsewhere.
</p>
<p>The value of <code class="reqn">mean</code> should be chosen between the maximum and minimum values of
<code class="reqn">(u_i,v_j)</code>; otherwise there may be no distributions for <code class="reqn">u</code> and <code class="reqn">v</code> that
will satisfy the the mean-type hypothesis.  If <code class="reqn">mean</code> is inside this interval, but the convergence is
still not satisfactory, then the value of <code class="reqn">mean</code> should be moved closer to the NPMLE for <code class="reqn">E(g(u,v))</code>.
(The NPMLE itself should always  be a feasible value for <code class="reqn">mean</code>.)  The calculations for this function
are derived in Owen (2001).
</p>


<h3>Value</h3>

<p><code>el2.test.wts</code> returns a list of values as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>the vector of uncensored data for the first sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wu</code></td>
<td>
<p>the vector of weights for <code class="reqn">u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpu</code></td>
<td>
<p>the vector of probability jumps for <code class="reqn">u</code> that maximize the weighted empirical likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>the vector of uncensored data for the second sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wv</code></td>
<td>
<p>the vector of weights for <code class="reqn">v</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpv</code></td>
<td>
<p>the vector of probability jumps for <code class="reqn">v</code> that maximize the weighted empirical likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>the value of the Lagrangian multipler found by the calculations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>William H. Barton &lt;bbarton@lexmark.com&gt; and modified by Mai Zhou.
</p>


<h3>References</h3>

<p>Owen, A.B. (2001). <code>Empirical Likelihood</code>. Chapman and Hall/CRC, Boca Raton, pp.223-227.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
u&lt;-c(10, 209, 273, 279, 324, 391, 566, 785)
v&lt;-c(21, 38, 39, 51, 77, 185, 240, 289, 524)
wu&lt;-c(2.442931, 1.122365, 1.113239, 1.113239, 1.104113, 1.104113, 1.000000, 1.000000)
wv&lt;-c( 1, 1, 1, 1, 1, 1, 1, 1, 1)
mu0&lt;-c(0.3774461, 0.1042739, 0.09649724, 0.09649724, 0.08872055, 0.08872055, 0.0739222, 0.0739222)
nu0&lt;-c(0.1013718, 0.1013718, 0.1013718, 0.1013718, 0.1013718, 0.1013718, 0.1095413, 0.1287447,
 0.1534831)
mean&lt;-0.5

#let fun=function(x,y){x&gt;=y}
indicmat&lt;-matrix(nrow=8,ncol=9,c(
-0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5, 
-0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
-0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
-0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
-0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
-0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
-0.5, -0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
-0.5, -0.5, -0.5, -0.5,  0.5,  0.5,  0.5,  0.5,
-0.5, -0.5, -0.5, -0.5, -0.5, -0.5,  0.5,  0.5))
el2.test.wts(u,v,wu,wv,mu0,nu0,indicmat,mean)

# jumpu
# [1] 0.3774461, 0.1042739, 0.09649724, 0.09649724, 0.08872055, 0.08872055, 0.0739222, 0.0739222

# jumpv
# [1] 0.1013718, 0.1013718, 0.1013718, 0.1013718, 0.1013718, 0.1013718, 0.1095413, 0.1287447,
# [9] 0.1534831

# lam
# [1] 7.055471
</code></pre>


</div>