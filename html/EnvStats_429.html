<div class="container">

<table style="width: 100%;"><tr>
<td>predIntNormK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute the Value of <code class="reqn">K</code> for a Prediction Interval for a Normal Distribution
</h2>

<h3>Description</h3>

<p>Compute the value of <code class="reqn">K</code> (the multiplier of estimated standard deviation) used
to construct a prediction interval for the next <code class="reqn">k</code> observations or next set of
<code class="reqn">k</code> means based on data from a normal distribution.
The function
<code>predIntNormK</code> is called by <code>predIntNorm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntNormK(n, df = n - 1, n.mean = 1, k = 1,
    method = "Bonferroni", pi.type = "two-sided",
    conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>a positive integer greater than 2 indicating the sample size upon which the
prediction interval is based.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>the degrees of freedom associated with the prediction interval.  The default is
<code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mean</code></td>
<td>

<p>positive integer specifying the sample size associated with the <code class="reqn">k</code> future averages.
The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all
future averages must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>positive integer specifying the number of future observations or averages the
prediction interval should contain with confidence level <code>conf.level</code>.
The default value is <code>k=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method to use if the number of future observations
(<code>k</code>) is greater than 1.  The possible values are <code>method="Bonferroni"</code>
(approximate method based on Bonferonni inequality; the default), and <br><code>method="exact"</code> (exact method due to Dunnett, 1955).  See the DETAILS section for
more information.  This argument is ignored if <code>k=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.
The possible values are <code>pi.type="two-sided"</code> (the default), <code>pi.type="lower"</code>,
and <code>pi.type="upper"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the prediction interval.
The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A prediction interval for some population is an interval on the real line constructed
so that it will contain <code class="reqn">k</code> future observations or averages from that population
with some specified probability <code class="reqn">(1-\alpha)100\%</code>, where
<code class="reqn">0 &lt; \alpha &lt; 1</code> and <code class="reqn">k</code> is some pre-specified positive integer.
The quantity <code class="reqn">(1-\alpha)100\%</code> is called
the confidence coefficient or confidence level associated with the prediction
interval.
</p>
<p>Let <code class="reqn">\underline{x} = x_1, x_2, \ldots, x_n</code> denote a vector of <code class="reqn">n</code>
observations from a normal distribution with parameters
<code>mean=</code><code class="reqn">\mu</code> and <code>sd=</code><code class="reqn">\sigma</code>.  Also, let <code class="reqn">m</code> denote the
sample size associated with the <code class="reqn">k</code> future averages (i.e., <code>n.mean=</code><code class="reqn">m</code>).
When <code class="reqn">m=1</code>, each average is really just a single observation, so in the rest of
this help file the term “averages” will replace the phrase
“observations or averages”.
</p>
<p>For a normal distribution, the form of a two-sided <code class="reqn">(1-\alpha)100\%</code> prediction
interval is:
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)</code>
</p>

<p>where <code class="reqn">\bar{x}</code> denotes the sample mean:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)</code>
</p>

<p><code class="reqn">s</code> denotes the sample standard deviation:
</p>
<p style="text-align: center;"><code class="reqn">s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)</code>
</p>

<p>and <code class="reqn">K</code> denotes a constant that depends on the sample size <code class="reqn">n</code>, the
confidence level, the number of future averages <code class="reqn">k</code>, and the
sample size associated with the future averages, <code class="reqn">m</code>.  Do not confuse the
constant <code class="reqn">K</code> (uppercase K) with the number of future averages <code class="reqn">k</code>
(lowercase k).  The symbol <code class="reqn">K</code> is used here to be consistent with the
notation used for tolerance intervals (see <code>tolIntNorm</code>).
</p>
<p>Similarly, the form of a one-sided lower prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)</code>
</p>

<p>and the form of a one-sided upper prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)</code>
</p>

<p>but <code class="reqn">K</code> differs for one-sided versus two-sided prediction intervals.
The derivation of the constant <code class="reqn">K</code> is explained below.  The function
<code>predIntNormK</code> computes the value of <code class="reqn">K</code> and is called by
<code>predIntNorm</code>.
<br></p>
<p><b>The Derivation of K for One Future Observation or Average (k = 1)</b> <br>
Let <code class="reqn">X</code> denote a random variable from a normal distribution
with parameters <code>mean=</code><code class="reqn">\mu</code> and <code>sd=</code><code class="reqn">\sigma</code>, and let
<code class="reqn">x_p</code> denote the <code class="reqn">p</code>'th quantile of <code class="reqn">X</code>.
</p>
<p>A true two-sided <code class="reqn">(1-\alpha)100\%</code> prediction interval for the next
<code class="reqn">k=1</code> observation of <code class="reqn">X</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">[x_{\alpha/2}, x_{1-\alpha/2}] = [\mu - z_{1-\alpha/2}\sigma,  \mu + z_{1-\alpha/2}\sigma] \;\;\;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">z_p</code> denotes the <code class="reqn">p</code>'th quantile of a standard normal distribution.
</p>
<p>More generally, a true two-sided <code class="reqn">(1-\alpha)100\%</code> prediction interval for the
next <code class="reqn">k=1</code> average based on a sample of size <code class="reqn">m</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">[\mu - z_{1-\alpha/2}\frac{\sigma}{\sqrt{m}},  \mu + z_{1-\alpha/2}\frac{\sigma}{\sqrt{m}}] \;\;\;\;\;\; (7)</code>
</p>

<p>Because the values of <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> are unknown, they must be
estimated, and a prediction interval then constructed based on the estimated
values of <code class="reqn">\mu</code> and <code class="reqn">\sigma</code>.
</p>
<p>For a two-sided prediction interval (<code>pi.type="two-sided"</code>),
the constant <code class="reqn">K</code> for a <code class="reqn">(1-\alpha)100\%</code> prediction interval for the next
<code class="reqn">k=1</code> average based on a sample size of <code class="reqn">m</code> is computed as:
</p>
<p style="text-align: center;"><code class="reqn">K = t_{n-1, 1-\alpha/2} \sqrt{\frac{1}{m} + \frac{1}{n}} \;\;\;\;\;\; (8)</code>
</p>

<p>where <code class="reqn">t_{\nu, p}</code> denotes the <code class="reqn">p</code>'th quantile of the
Student's t-distribution with <code class="reqn">\nu</code>
degrees of freedom.  For a one-sided prediction interval
(<code>pi.type="lower"</code> or <code>pi.type="lower"</code>), the prediction interval
is given by:
</p>
<p style="text-align: center;"><code class="reqn">K = t_{n-1, 1-\alpha} \sqrt{\frac{1}{m} + \frac{1}{n}} \;\;\;\;\;\; (9)</code>
</p>
<p>.
</p>
<p>The formulas for these prediction intervals are derived as follows.  Let
<code class="reqn">\bar{y}</code> denote the future average based on <code class="reqn">m</code> observations.  Then
the quantity <code class="reqn">\bar{y} - \bar{x}</code> has a normal distribution with expectation
and variance given by:
</p>
<p style="text-align: center;"><code class="reqn">E(\bar{y} - \bar{x}) = 0 \;\;\;\;\;\; (10)</code>
</p>

<p style="text-align: center;"><code class="reqn">Var(\bar{y} - \bar{x}) = Var(\bar{y}) + Var(\bar{x}) = \frac{\sigma^2}{m} + \frac{\sigma^2}{n} = \sigma^2(\frac{1}{m} + \frac{1}{n}) \;\;\;\;\;\; (11)</code>
</p>

<p>so the quantity
</p>
<p style="text-align: center;"><code class="reqn">t = \frac{\bar{y} - \bar{x}}{s\sqrt{\frac{1}{m} + \frac{1}{n}}} \;\;\;\;\;\; (12)</code>
</p>

<p>has a Student's t-distribution with <code class="reqn">n-1</code> degrees of freedom.
<br></p>
<p><b>The Derivation of K for More than One Future Observation or Average (k &gt;1)</b> <br>
When <code class="reqn">k &gt; 1</code>, the function <code>predIntNormK</code> allows for two ways to compute
<code class="reqn">K</code>:  an exact method due to Dunnett (1955) (<code>method="exact"</code>), and
an approximate (conservative) method based on the Bonferroni inequality
(<code>method="Bonferroni"</code>; see Miller, 1981a, pp.8, 67-70;
Gibbons et al., 2009, p.4).  Each of these methods is explained below.
<br></p>
<p><em>Exact Method Due to Dunnett (1955)</em> (<code>method="exact"</code>) <br>
Dunnett (1955) derived the value of <code class="reqn">K</code> in the context of the multiple
comparisons problem of comparing several treatment means to one control mean.
The value of <code class="reqn">K</code> is computed as:
</p>
<p style="text-align: center;"><code class="reqn">K = c \sqrt{\frac{1}{m} + \frac{1}{n}} \;\;\;\;\;\; (13)</code>
</p>

<p>where <code class="reqn">c</code> is a constant that depends on the sample size <code class="reqn">n</code>, the number of
future observations (averages) <code class="reqn">k</code>, the sample size associated with the
<code class="reqn">k</code> future averages <code class="reqn">m</code>, and the confidence level <code class="reqn">(1-\alpha)100\%</code>.
</p>
<p>When <code>pi.type="lower"</code> or <code>pi.type="upper"</code>, the value of <code class="reqn">c</code> is the
number that satisfies the following equation (Gupta and Sobel, 1957; Hahn, 1970a):
</p>
<p style="text-align: center;"><code class="reqn">1 - \alpha = \int_{0}^{\infty} F_1(cs, k, \rho) h(s\sqrt{n-1}, n-1) \sqrt{n-1} ds \;\;\;\;\;\; (14)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">F_1(x, k, \rho) = \int_{\infty}^{\infty} [\Phi(\frac{x + \rho^{1/2}y}{\sqrt{1 - \rho}})]^k \phi(y) dy \;\;\;\;\;\; (15)</code>
</p>

<p style="text-align: center;"><code class="reqn">\rho = 1 / (\frac{n}{m} + 1) \;\;\;\;\;\; (16)</code>
</p>

<p style="text-align: center;"><code class="reqn">h(x, \nu) = \frac{x^{\nu-1}e^{-x^2/2}}{2^{(\nu/2) - 1} \Gamma(\frac{\nu}{2})} \;\;\;\;\;\; (17)</code>
</p>

<p>and <code class="reqn">\Phi()</code> and <code class="reqn">\phi()</code> denote the cumulative distribution function and
probability density function, respectively, of the standard normal distribution.
Note that the function <code class="reqn">h(x, \nu)</code> is the probability density function of a
chi random variable with <code class="reqn">\nu</code> degrees of freedom.
</p>
<p>When <code>pi.type="two-sided"</code>, the value of <code class="reqn">c</code> is the number that satisfies
the following equation:
</p>
<p style="text-align: center;"><code class="reqn">1 - \alpha = \int_{0}^{\infty} F_2(cs, k, \rho) h(s\sqrt{n-1}, n-1) \sqrt{n-1} ds \;\;\;\;\;\; (18)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">F_2(x, k, \rho) = \int_{\infty}^{\infty} [\Phi(\frac{x + \rho^{1/2}y}{\sqrt{1 - \rho}}) - \Phi(\frac{-x + \rho^{1/2}y}{\sqrt{1 - \rho}})]^k \phi(y) dy \;\;\;\;\;\; (19)</code>
</p>

<p><br></p>
<p><em>Approximate Method Based on the Bonferroni Inequality</em> (<code>method="Bonferroni"</code>) <br>
As shown above, when <code class="reqn">k=1</code>, the value of <code class="reqn">K</code> is given by Equation (8) or
Equation (9) for two-sided or one-sided prediction intervals, respectively.  When
<code class="reqn">k &gt; 1</code>, a conservative way to construct a <code class="reqn">(1-\alpha^*)100\%</code> prediction
interval for the next <code class="reqn">k</code> observations or averages is to use a Bonferroni
correction (Miller, 1981a, p.8) and set <code class="reqn">\alpha = \alpha^*/k</code> in Equation (8)
or (9) (Chew, 1968).  This value of <code class="reqn">K</code> will be conservative in that the computed
prediction intervals will be wider than the exact predictions intervals.
Hahn (1969, 1970a) compared the exact values of <code class="reqn">K</code> with those based on the
Bonferroni inequality for the case of <code class="reqn">m=1</code> and found the approximation to be
quite satisfactory except when <code class="reqn">n</code> is small, <code class="reqn">k</code> is large, and <code class="reqn">\alpha</code>
is large.  For example, Gibbons (1987a) notes that for a 99% prediction interval
(i.e., <code class="reqn">\alpha = 0.01</code>) for the next <code class="reqn">k</code> observations, if <code class="reqn">n &gt; 4</code>,
the bias of <code class="reqn">K</code> is never greater than 1% no matter what the value of <code class="reqn">k</code>.
</p>


<h3>Value</h3>

<p>A numeric scalar equal to <code class="reqn">K</code>, the multiplier of estimated standard
deviation that is used to construct the prediction interval.
</p>


<h3>Note</h3>

<p>Prediction and tolerance intervals have long been applied to quality control and
life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973).
In the context of environmental statistics, prediction intervals are useful for
analyzing data from groundwater detection monitoring programs at hazardous and
solid waste facilities (e.g., Gibbons et al., 2009; Millard and Neerchal, 2001;
USEPA, 2009).
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Berthouex, P.M., and L.C. Brown. (2002). <em>Statistics for Environmental Engineers</em>.
Lewis Publishers, Boca Raton.
</p>
<p>Dunnett, C.W. (1955). A Multiple Comparisons Procedure for Comparing Several Treatments
with a Control. <em>Journal of the American Statistical Association</em> <b>50</b>, 1096-1121.
</p>
<p>Dunnett, C.W. (1964). New Tables for Multiple Comparisons with a Control.
<em>Biometrics</em> <b>20</b>, 482-491.
</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
John Wiley &amp; Sons, Hoboken.
</p>
<p>Hahn, G.J. (1969). Factors for Calculating Two-Sided Prediction Intervals for
Samples from a Normal Distribution.
<em>Journal of the American Statistical Association</em> <b>64</b>(327), 878-898.
</p>
<p>Hahn, G.J. (1970a). Additional Factors for Calculating Prediction Intervals for
Samples from a Normal Distribution.
<em>Journal of the American Statistical Association</em> <b>65</b>(332), 1668-1676.
</p>
<p>Hahn, G.J. (1970b). Statistical Intervals for a Normal Population, Part I: Tables,
Examples and Applications. <em>Journal of Quality Technology</em> <b>2</b>(3), 115-125.
</p>
<p>Hahn, G.J. (1970c). Statistical Intervals for a Normal Population, Part II:
Formulas, Assumptions, Some Derivations. <em>Journal of Quality Technology</em>
<b>2</b>(4), 195-206.
</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for Practitioners</em>.
John Wiley and Sons, New York.
</p>
<p>Hahn, G., and W. Nelson. (1973). A Survey of Prediction Intervals and Their Applications.
<em>Journal of Quality Technology</em> <b>5</b>, 178-188.
</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
Elsevier, New York.
</p>
<p>Helsel, D.R., and R.M. Hirsch. (2002). <em>Statistical Methods in Water Resources</em>.
Techniques of Water Resources Investigations, Book 4, chapter A3. U.S. Geological Survey.
(available on-line at:  <a href="https://pubs.usgs.gov/tm/04/a03/tm4a3.pdf">https://pubs.usgs.gov/tm/04/a03/tm4a3.pdf</a>).
</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
CRC Press, Boca Raton, Florida.
</p>
<p>Miller, R.G. (1981a). <em>Simultaneous Statistical Inference</em>. McGraw-Hill, New York.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>


<h3>See Also</h3>

<p><code>predIntNorm</code>, <code>predIntNormSimultaneous</code>,
<code>predIntLnorm</code>, <code>tolIntNorm</code>,
Normal, <code>estimate.object</code>, <code>enorm</code>, <code>eqnorm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Compute the value of K for a two-sided 95% prediction interval
  # for the next observation given a sample size of n=20.

  predIntNormK(n = 20)
  #[1] 2.144711

  #--------------------------------------------------------------------

  # Compute the value of K for a one-sided upper 99% prediction limit
  # for the next 3 averages of order 2 (i.e., each of the 3 future
  # averages is based on a sample size of 2 future observations) given a
  # samle size of n=20.

  predIntNormK(n = 20, n.mean = 2, k = 3, pi.type = "upper",
    conf.level = 0.99)
  #[1] 2.258026

  #----------

  # Compare the result above that is based on the Bonferroni method
  # with the exact method.

  predIntNormK(n = 20, n.mean = 2, k = 3, method = "exact",
    pi.type = "upper", conf.level = 0.99)
  #[1] 2.251084

  #--------------------------------------------------------------------

  # Example 18-1 of USEPA (2009, p.18-9) shows how to construct a 95%
  # prediction interval for 4 future observations assuming a
  # normal distribution based on arsenic concentrations (ppb) in
  # groundwater at a solid waste landfill.  There were 4 years of
  # quarterly monitoring, and years 1-3 are considered background,

  # So the sample size for the prediciton limit is n = 12,
  # and the number of future samples is k = 4.

  predIntNormK(n = 12, k = 4, pi.type = "upper")
  #[1] 2.698976
</code></pre>


</div>