<div class="container">

<table style="width: 100%;"><tr>
<td>plot_ExtDep.np</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical summaries of non-parametric representations of extremal dependence.</h2>

<h3>Description</h3>

<p>This function displays several summaries of extremal dependence represented through Bernstein polynomials.</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_ExtDep.np(out, type, summary.mcmc, burn, y, probs, 
               A_true, h_true, est.out, mar1, mar2, dep, 
               QatCov1=NULL, QatCov2=QatCov1, P, 
               labels=c(expression(y[1]),expression(y[2])), 
               CEX=1.5, xlim, ylim, col.data, 
               col.Qfull, col.Qfade, data=NULL, ...)        
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>An output of the <code>fExtDep.np</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating the type of graphical summary to be plotted. Takes values <code>"summary"</code>, <code>"returns"</code>, <code>"A"</code>, <code>"h"</code>, <code>"pm"</code>, <code>"k"</code> or <code>"Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.mcmc</code></td>
<td>
<p>The output of the <code>summary_ExtDep</code> function. Only required when <code>out</code> is obtained using a Bayesian estimation method (<code>out$est=="Bayesian"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>The burn-in period. Only required when <code>out</code> is obtained using a Bayesian estimation method (<code>out$est=="Bayesian"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A 2-column matrix of unobserved thresholds at which the returns are calculated. Required when <code>type="returns"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>The probability of joint exceedances, the output of the <code>return</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A_true</code></td>
<td>
<p>A vector representing the true pickands dependence function evaluated at the grid points on the simplex given by <code>summary.mcmc$w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_true</code></td>
<td>
<p>A vector representing the true angular density function evaluated at the grid points on the simplex given by <code>summary.mcmc$w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.out</code></td>
<td>
<p>A list containing:
</p>

<dl>
<dt>ghat:</dt>
<dd>
<p>a 3-row matrix giving the posterior summary for the estimate of the bound;</p>
</dd>
<dt>Shat and Shat_post:</dt>
<dd>
<p>a matrix of the posterior and a 3-row matrix giving the posterior summary for the estimate of the basic set <code class="reqn">S</code>;</p>
</dd>
<dt>nuShat and nuShat_post:</dt>
<dd>
<p>a matrix of the posterior and a 3-row matrix giving the posterior summary for the estimate of the measure <code class="reqn">\nu(S)</code>;</p>
</dd>
</dl>
<p>Note that a posterior summary is made of its mean and <code class="reqn">90\%</code>credibility interval.
</p>
<p>Only required when using a Bayesian estimation method (<code>out$est=="Bayesian"</code>) and <code>type="Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar1, mar2</code></td>
<td>
<p>Vectors of marginal GEV parameters. Required when <code>type="Qsets"</code> and either <code>out$method=="Bayesian"</code> if the marginal parameter weren't fitted or <code>"empirical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep</code></td>
<td>
<p>A logical value; if <code>TRUE</code> the estimate of the dependence is plotted when computing extreme quantile regions (<code>type="Qsets"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QatCov1, QatCov2</code></td>
<td>
<p>Matrices representing the value of the covariates at which extreme quantile regions should be computed. Required when <code>type="Qsets"</code>. See arguments <code>cov1</code> and <code>cov2</code> from <code>fExtDep</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>A vector indicating the probabilities associated with the quantiles to be computed. Required when <code>type="Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>A bivariate vector of character strings providing labels for extreme quantile regions.  Required when <code>type="Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CEX</code></td>
<td>
<p>Label and axis sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>Limits of the x and y axis when computing extreme quantile regions. Required when <code>type="Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.data, col.Qfull, col.Qfade</code></td>
<td>
<p>Colors for data, estimate of extreme quantile regions and its credible interval (when applicable). Required when <code>type="Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A 2-column matrix providing the original data to be plotted when <code>type="Qsets"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional graphical parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>type="returns"</code>, a (contour) plot of the probabilities of exceedances for some threshold is returned. This corresponds to the output of the <code>returns</code> function. <br>
If <code>type="A"</code>, a plot of the estimated Pickands dependence function is drawn. If <code>A_true</code> is specified the plot includes the true Pickands dependence function and a functional boxplot for the estimated function.
If <code>type="h"</code>, a plot of the estimated angular density function is drawn. If <code>h_true</code> is specified the plot includes the true angular density and a functional boxplot for the estimated function.
If <code>type="pm"</code>, a plot of the prior against the posterior for the mass at <code class="reqn">\{0\}</code> is drawn.
If <code>type="k"</code>, a plot of the prior against the posterior for the polynomial degree <code class="reqn">k</code> is drawn.
If <code>type="summary"</code>, when the estimation was performed in a Bayesian framework then a 2 by 2 plot with types <code>"A"</code>, <code>"h"</code>, <code>"pm"</code> and <code>"k"</code> is returned. Otherwise a 1 by 2 plot with types <code>"A"</code> and <code>"h"</code> is returned.
If <code>type="Qsets"</code>, extreme quantile regions are computed according to the methodology developped in Beranger et al. (2021).
</p>


<h3>Value</h3>

<p>a graph depending on argument <code>type</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2021).
Estimation and uncertainty quantification for extreme quantile regions.
<em>Extremes</em>, <b>24</b>, 349-375.
</p>
<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P., Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>


<h3>See Also</h3>

<p><code>fExtDep.np</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
###########################################################
### Example 1 - Wind Speed and Differential of pressure ###
###########################################################

data(WindSpeedGust)

years &lt;- format(ParcayMeslay$time, format="%Y")
attach(ParcayMeslay[which(years %in% c(2004:2013)),])

# Marginal quantiles
WS_th &lt;- quantile(WS,.9)
DP_th &lt;- quantile(DP,.9)

# Standardisation to unit Frechet (requires evd package)
pars.WS &lt;- evd::fpot(WS, WS_th, model="pp")$estimate
pars.DP &lt;- evd::fpot(DP, DP_th, model="pp")$estimate
  
# transform the marginal distribution to common unit Frechet:
data_uf &lt;- trans2UFrechet(cbind(WS,DP), type="Empirical")

# compute exceedances 
rdata &lt;- rowSums(data_uf)
r0 &lt;- quantile(rdata, probs=.90)
extdata_WSDP &lt;- data_uf[rdata&gt;=r0,]

# Fit
SP_mle &lt;- fExtDep.np(method="Frequentist", data=extdata_WSDP, k0=10, type="maxima")

# Plot
plot_ExtDep.np(out=SP_mle, type="summary")

####################################################
### Example 2 - Pollution levels in Milan, Italy ###
####################################################
	
## Not run: 

### Here we will only model the dependence structure	
data(MilanPollution)

data &lt;- Milan.winter[,c("NO2","SO2")] 
data &lt;- as.matrix(data[complete.cases(data),])

# Thereshold
u &lt;- apply(data, 2, function(x) quantile(x, prob=0.9, type=3))

# Hyperparameters
hyperparam &lt;- list(mu.nbinom = 6, var.nbinom = 8, a.unif=0, b.unif=0.2)

### Standardise data to univariate Frechet margins

f1 &lt;- fGEV(data=data[,1], method="Bayesian", sig0 = 0.0001, nsim = 5e+4)
diagnostics(f1)
burn1 &lt;- 1:30000
gev.pars1 &lt;- apply(f1$param_post[-burn1,],2,mean)
sdata1 &lt;- trans2UFrechet(data=data[,1], pars=gev.pars1, type="GEV")

f2 &lt;- fGEV(data=data[,2], method="Bayesian", sig0 = 0.0001, nsim = 5e+4)
diagnostics(f2)
burn2 &lt;- 1:30000
gev.pars2 &lt;- apply(f2$param_post[-burn2,],2,mean)
sdata2 &lt;- trans2UFrechet(data=data[,2], pars=gev.pars2, type="GEV")

sdata &lt;- cbind(sdata1,sdata2)

### Bayesian estimation using Bernstein polynomials

pollut1 &lt;- fExtDep.np(method="Bayesian", data=sdata, u=TRUE,
                      mar.fit=FALSE, k0=5, hyperparam = hyperparam, nsim=5e+4)

diagnostics(pollut1)
pollut1_sum &lt;- summary_ExtDep(mcmc=pollut1, burn=3e+4, plot=TRUE)
pl1 &lt;- plot_ExtDep.np(out=pollut1, type="Qsets", summary.mcmc=pollut1_sum, 
                      mar1=gev.pars1, mar2=gev.pars2, P = 1/c(600, 1200, 2400),
                      dep=TRUE, data=data, xlim=c(0,400), ylim=c(0,400))

pl1b &lt;- plot_ExtDep.np(out=pollut1, type="Qsets", summary.mcmc=pollut1_sum, est.out=pl1$est.out, 
                       mar1=gev.pars1, mar2=gev.pars2, P = 1/c(1200),
                       dep=FALSE, data=data, xlim=c(0,400), ylim=c(0,400))

### Frequentist estimation using Bernstein polynomials

pollut2 &lt;- fExtDep.np(method="Frequentist", data=sdata, mar.fit=FALSE, type="rawdata", k0=8)
plot_ExtDep.np(out=pollut2, type = c("summary"), CEX=1.5)

pl2 &lt;- plot_ExtDep.np(out=pollut2, type="Qsets", mar1=gev.pars1, mar2=gev.pars2, 
                      P = 1/c(600, 1200, 2400),
                      dep=TRUE, data=data, xlim=c(0,400), ylim=c(0,400),
                      labels=c(expression(NO[2]),expression(SO[2])),
                      col.Qfull = c("red", "green", "blue"))
                      
### Frequentist estimation using EKdH estimator

pollut3 &lt;- fExtDep.np(method="Empirical", data=data)
plot_ExtDep.np(out=pollut3, type = c("summary"), CEX=1.5)

pl3 &lt;- plot_ExtDep.np(out=pollut3, type="Qsets", mar1=gev.pars1, mar2=gev.pars2,
                      P = 1/c(600, 1200, 2400),
                      dep=TRUE, data=data, xlim=c(0,400), ylim=c(0,400),
                      labels=c(expression(NO[2]),expression(SO[2])),
                      col.Qfull = c("red", "green", "blue"))


## End(Not run)
</code></pre>


</div>