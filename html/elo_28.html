<div class="container">

<table style="width: 100%;"><tr>
<td>elo.run</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate running Elos for a series of matches.</h2>

<h3>Description</h3>

<p>Calculate running Elos for a series of matches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">elo.run(
  formula,
  data,
  na.action,
  subset,
  k = NULL,
  initial.elos = NULL,
  ...,
  prob.fun = elo.prob,
  update.fun = elo.update,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula. See the help page for formulas for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A constant k-value (or a vector, where appropriate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.elos</code></td>
<td>
<p>An optional named vector containing initial Elo ratings for all teams in <code>formula</code>.
If a single (unnamed) value is supplied, that value is applied to all teams. <code>NULL</code> (the default)
sets all Elos to 1500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments (not used at this time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.fun</code></td>
<td>
<p>A function with at least 4 arguments: elo.A, elo.B, adjust.A, and adjust.B. It should return a predicted probability
that team A wins. The values passed in will be scalars, and a scalar is expected as output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update.fun</code></td>
<td>
<p>A function with at least 6 arguments: the same as <code>elo.update.default</code>. The function takes
in the Elos, the win indicator, k, and any adjustments, and returns a value by which to update the Elos. The values passed in
will be scalars, and a scalar is expected as output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should a message be issued when R is used (over C++)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>elo.run</code> is run two different ways: the first (default) uses C++ and may be up to 50 times faster,
while the second (when <code>prob.fun</code> or <code>update.fun</code> are specified) uses R but also supports custom update functions.
Prefer the first unless you really need a custom update function.
</p>


<h3>Value</h3>

<p>An object of class <code>"elo.run"</code> or class <code>"elo.run.regressed"</code>.
</p>


<h3>See Also</h3>

<p><code>score</code>, elo.run.helperselo.run helpers, <code>elo.calc</code>,
<code>elo.update</code>, <code>elo.prob</code>, <code>elo.model.frame</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(tournament)
elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
        data = tournament, k = 20)

# Create non-constant 'k'
elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor +
        k(20*log(abs(points.Home - points.Visitor) + 1)), data = tournament)

# Adjust Elo for, e.g., home-field advantage
elo.run(score(points.Home, points.Visitor) ~ adjust(team.Home, 30) + team.Visitor,
        data = tournament, k = 20)

tournament$home.field &lt;- 30
elo.run(score(points.Home, points.Visitor) ~ adjust(team.Home, home.field) + team.Visitor,
        data = tournament, k = 20)

# Regress the Elos back toward 1500 at the end of the half-season
elo.run(score(points.Home, points.Visitor) ~ adjust(team.Home, 30) +
        team.Visitor + regress(half, 1500, 0.2), data = tournament, k = 20)

</code></pre>


</div>