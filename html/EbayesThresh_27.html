<div class="container">

<table style="width: 100%;"><tr>
<td>zetafromx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of a parameter in the prior weight sequence in the
EbayesThresh paradigm.</h2>

<h3>Description</h3>

<p>Suppose a sequence of data has underlying mean vector with elements
<code class="reqn">\theta_i</code>. Given the sequence of data, and a vector of scale
factors <code>cs</code> and a lower limit <code>pilo</code>, this routine finds the
marginal maximum likelihood estimate of the parameter <code>zeta</code> such
that the prior probability of <code class="reqn">\theta_i</code> being nonzero is of the
form <code>median(pilo, zeta*cs, 1)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">zetafromx(xd, cs, pilo = NA, prior = "laplace", a = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xd</code></td>
<td>
<p>A vector of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cs</code></td>
<td>
<p>A vector of scale factors, of the same length as <code>xd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pilo</code></td>
<td>
<p>The lower limit for the estimated weights. If
<code>pilo=NA</code> it is calculated according to the sample size to be
the weight corresponding to the universal threshold <code class="reqn">\sqrt{2
    \log n}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Specification of prior to be used conditional on the mean
being nonzero; can be <code>cauchy</code> or <code>laplace</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Scale factor if Laplace prior is used. Ignored if Cauchy
prior is used. If, on entry, <code>a=NA</code> and <code>prior="laplace"</code>,
then the scale parameter will also be estimated by marginal maximum
likelihood. If <code>a</code> is not specified then the default value 0.5
will be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An exact algorithm is used, based on splitting the range up for
<code>zeta</code> into subintervals over which no element of <code>zeta*cs</code>
crosses either <code>pilo</code> or 1.
</p>
<p>Within each of these subintervals, the log likelihood is concave and its
maximum can be found to arbitrary accuracy; first the derivatives at
each end of the interval are checked to see if there is an internal
maximum at all, and if there is this can be found by a binary search for
a zero of the derivative.
</p>
<p>Finally, the maximum of all the local maxima over these subintervals is
found.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>The value of <code>zeta</code> that yields the marginal maximum
likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The weights (prior probabilities of nonzero) yielded by this
value of <code>zeta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cs</code></td>
<td>
<p>The factors as supplied to the program.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pilo</code></td>
<td>
<p>The lower bound on the weight, either as supplied or as
calculated internally.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Once the maximizing <code>zeta</code> and corresponding weights have
been found, the thresholds can be found using the program
<code>tfromw</code>, and these can be used to process the original
data using the routine <code>threshld</code>.</p>


<h3>Author(s)</h3>

<p>Bernard Silverman</p>


<h3>References</h3>

<p>See <code>ebayesthresh</code> and
<a href="http://www.bernardsilverman.com">http://www.bernardsilverman.com</a></p>


<h3>See Also</h3>

<p><code>tfromw</code>, <code>threshld</code>,
<code>wmonfromx</code>, <code>wfromx</code></p>


</div>