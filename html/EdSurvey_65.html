<div class="container">

<table style="width: 100%;"><tr>
<td>parseScript_SPSS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parse SPSS Syntax Script for Fixed-Width Data Files</h2>

<h3>Description</h3>

<p>Parses an SPSS Syntax Script (.sps) file to return information relating to fixed-width data files.
</p>


<h3>Usage</h3>

<pre><code class="language-R">parseScript_SPSS(
  spsFilePath,
  verbose = FALSE,
  outputFormat = c("data.frame"),
  encoding = getOption("encoding")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spsFilePath</code></td>
<td>
<p>a character value of the file path to the SPSS script to parse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logic value to indicate if user wishes to print parsing activity to console. Default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputFormat</code></td>
<td>
<p>a named argument to indicate which output format the resulting object should be.  See details for information on each format.
Currently, <code>data.frame</code> format is only supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>a character value to indicate the encoding specification that is used by <code>readLines</code> base function for the <code>spsFilePath</code> parameter.
Only adjust this parameter if the original file encoding of the file is known, is not producing correct string values, or other errors occur.
See <code>?readLines</code> help for details about it's use for file encoding, and additional details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NOT CURRENTLY EXPORTED!  In Future this could potentially be made to a separate R package
THIS parseScript_SPSS function should be used 100
Old/Previous SPSS script parsers should be slowly transitioned to utilize this function when possible to maximize code use.
</p>
<p>The SPSS syntax script parser is focused on gathering details for use with fixed-width data files.  This function scans for the following SPSS commands:
</p>

<ul>
<li>
<p>FILE HANDLE
</p>
</li>
<li>
<p>DATA LIST
</p>
</li>
<li>
<p>VARIABLE LABEL
</p>
</li>
<li>
<p>VALUE LABEL
</p>
</li>
<li>
<p>MISSING VALUE
</p>
</li>
</ul>
<p>The <code>outputFormat</code> specified will determine the result object returned.  This function currently supports the following formats.
</p>

<ul><li>
<p>data.frame
</p>

<ul>
<li>
<p>variableName - The variable name as defined in the script
</p>
</li>
<li>
<p>Start - The start number index of the variable defined for the fixed-width format layout
</p>
</li>
<li>
<p>End - The end number index of the variable defined for the fixed-width format layout
</p>
</li>
<li>
<p>Width - The length of how many columns the variable uses in the fixed-width format layout
</p>
</li>
<li>
<p>Attributes - Any SPSS attributes that are defined in the DATA LIST command.  This is typically only for field formatting.
</p>
</li>
<li>
<p>RecordNumber - Some fixed-width data files are considered "multi-line" where one record of data can span multiple rows in the file.
The RecordNumber indicates which line the variable is assigned.
</p>
</li>
<li>
<p>Labels - The descriptive label associated with the variable name to give more detail or context.
</p>
</li>
<li>
<p>labelValues - For categorical variables a stored value will typically be assigned a longer label/definition. This string identifies these mappings.
The '^' symbol is used to delimit each individual label value. Then additionally, the '=' is used to split the value from the left side of the '=' symbol,
and the remaining right-hand side of '=' is the text label for that value.
</p>
</li>
<li>
<p>dataType - A best-guess of the data type (either 'numeric' or 'character') without actually examining the data-file.
</p>
</li>
<li>
<p>missingValues - If a MISSING VALUE clause is included in the script this will list the values that are considered 'Missing'.
If multiple values specified, they will be delimited by a ';' (semi-colon) symbol.
</p>
</li>
</ul>
</li></ul>
<h3>Value</h3>

<p>returns an object containing information specified by the <code>outputFormat</code> argument.
</p>


<h3>Author(s)</h3>

<p>Tom Fink
</p>


</div>