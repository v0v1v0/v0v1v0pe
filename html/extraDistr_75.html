<div class="container">

<table style="width: 100%;"><tr>
<td>GammaPoiss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gamma-Poisson distribution</h2>

<h3>Description</h3>

<p>Probability mass function and random generation
for the gamma-Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgpois(x, shape, rate, scale = 1/rate, log = FALSE)

pgpois(q, shape, rate, scale = 1/rate, lower.tail = TRUE, log.p = FALSE)

rgpois(n, shape, rate, scale = 1/rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape, scale</code></td>
<td>
<p>shape and scale parameters. Must be positive,
scale strictly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>an alternative way to specify the scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P[X \le x]</code>
otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>,
the length is taken to be the number required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Gamma-Poisson distribution arises as a continuous mixture of
Poisson distributions, where the mixing distribution
of the Poisson rate <code class="reqn">\lambda</code> is a gamma distribution.
When <code class="reqn">X \sim \mathrm{Poisson}(\lambda)</code>
and <code class="reqn">\lambda \sim \mathrm{Gamma}(\alpha, \beta)</code>, then <code class="reqn">X \sim \mathrm{GammaPoisson}(\alpha, \beta)</code>.
</p>
<p>Probability mass function
</p>
<p style="text-align: center;"><code class="reqn">
f(x) = \frac{\Gamma(\alpha+x)}{x! \, \Gamma(\alpha)} \left(\frac{\beta}{1+\beta}\right)^x \left(1-\frac{\beta}{1+\beta}\right)^\alpha
</code>
</p>

<p>Cumulative distribution function is calculated using recursive algorithm that employs the fact that
<code class="reqn">\Gamma(x) = (x - 1)!</code>. This enables re-writing probability mass function as
</p>
<p style="text-align: center;"><code class="reqn">
f(x) = \frac{(\alpha+x-1)!}{x! \, \Gamma(\alpha)} \left( \frac{\beta}{1+\beta} \right)^x \left( 1- \frac{\beta}{1+\beta} \right)^\alpha
</code>
</p>

<p>what makes recursive updating from <code class="reqn">x</code> to <code class="reqn">x+1</code> easy using the properties of factorials
</p>
<p style="text-align: center;"><code class="reqn">
f(x+1) = \frac{(\alpha+x-1)! \, (\alpha+x)}{x! \,(x+1) \, \Gamma(\alpha)} \left( \frac{\beta}{1+\beta} \right)^x \left( \frac{\beta}{1+\beta} \right) \left( 1- \frac{\beta}{1+\beta} \right)^\alpha
</code>
</p>

<p>and let's us efficiently calculate cumulative distribution function as a sum of probability mass functions
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \sum_{k=0}^x f(k)</code>
</p>



<h3>See Also</h3>

<p><code>Gamma</code>, <code>Poisson</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- rgpois(1e5, 7, 0.002)
xx &lt;- seq(0, 12000, by = 1)
hist(x, 100, freq = FALSE)
lines(xx, dgpois(xx, 7, 0.002), col = "red")
hist(pgpois(x, 7, 0.002))
xx &lt;- seq(0, 12000, by = 0.1)
plot(ecdf(x))
lines(xx, pgpois(xx, 7, 0.002), col = "red", lwd = 2)

</code></pre>


</div>