<div class="container">

<table style="width: 100%;"><tr>
<td>varEstToCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance Estimation</h2>

<h3>Description</h3>

<p>When the variance of a derived statistic (e.g., a difference) is
required, the covariance between the two statistics must be
calculated. This function uses results generated by various
functions (e.g., a <code>lm.sdf</code>) to find the covariance
between two statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varEstToCov(
  varEstA,
  varEstB = varEstA,
  varA,
  varB = varA,
  jkSumMultiplier,
  returnComponents = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>varEstA</code></td>
<td>
<p>a list of two <code>data.frame</code>s returned by a function after
the <code>returnVarEstInputs</code> argument was turned on.
The statistic named in the <code>varA</code> argument must be
present in each <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varEstB</code></td>
<td>
<p>a list of two <code>data.frame</code>s returned by a function after
the <code>returnVarEstInputs</code> argument was turned on.
The statistic named in the <code>varA</code> argument must be
present in each <code>data.frame</code>. When the same as
<code>varEstA</code>, the covariance is within one result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varA</code></td>
<td>
<p>a character that names the statistic in the <code>varEstA</code>
argument for which a covariance is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varB</code></td>
<td>
<p>a character that names the statistic in the <code>varEstB</code>
argument for which a covariance is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jkSumMultiplier</code></td>
<td>
<p>when the jackknife variance estimation method—or
balanced repeated replication (BRR)
method—multiplies the final jackknife variance estimate by a value,
set <code>jkSumMultiplier</code> to that value.
For an <code>edsurvey.data.frame</code> or
a <code>light.edsurvey.data.frame</code>,
the recommended value can be recovered with
<code>EdSurvey::getAttributes(</code><code>myData,</code> <code>"jkSumMultiplier")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnComponents</code></td>
<td>
<p>set to <code>TRUE</code> to return the imputation variance seperate from the sampling variance</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are not vectorized, so <code>varA</code> and
<code>varB</code> must contain exactly one variable name.
</p>
<p>The method used to compute the covariance is in
the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf"><em>Statistical Methods Used in EdSurvey</em></a>
</p>
<p>The method used to compute the degrees of freedom is in the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf"><em>Statistical Methods Used in EdSurvey</em></a>
in the section “Estimation of Degrees of Freedom.”
</p>


<h3>Value</h3>

<p>a numeric value; the jackknife covariance estimate. If <code>returnComponents</code> is <code>TRUE</code>, returns a vector of
length three, <code>V</code> is the variance estimate, <code>Vsamp</code> is the sampling component of the variance, and <code>Vimp</code> is the imputation component of the variance
</p>


<h3>Author(s)</h3>

<p>Paul Bailey
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# read in the example data (generated, not real student data)
sdf &lt;- readNAEP(path=system.file("extdata/data", "M36NT2PM.dat", package = "NAEPprimer"))

# estimate a regression
lm1 &lt;- lm.sdf(formula=composite ~ dsex + b017451, data=sdf, returnVarEstInputs=TRUE)
summary(lm1)
# estimate the covariance between two regression coefficients
# note that the variable names are parallel to what they are called in lm1 output
jkSumMultiplier &lt;- EdSurvey:::getAttributes(data=sdf, attribute="jkSumMultiplier")
covFEveryDay &lt;- varEstToCov(varEstA=lm1$varEstInputs,
                            varA="dsexFemale",
                            varB="b017451Every day",
                            jkSumMultiplier=jkSumMultiplier)
# the estimated difference between the two coefficients
# note: unname prevents output from being named after the first coefficient
unname(coef(lm1)["dsexFemale"] - coef(lm1)["b017451Every day"])
# the standard error of the difference
# uses the formula SE(A-B) = sqrt(var(A) + var(B) - 2*cov(A,B))
sqrt(lm1$coefmat["dsexFemale", "se"]^2
     + lm1$coefmat["b017451Every day", "se"]^2
     - 2 * covFEveryDay)

## End(Not run)
</code></pre>


</div>