<div class="container">

<table style="width: 100%;"><tr>
<td>PhyloApply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Apply a Function over a Phylogenetic Tree
</h2>

<h3>Description</h3>

<p>Cuts the tree into slices separated by nodes, applies the function to each slice and returns the weighted (by slice lengths) sum of the results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PhyloApply(Tree, FUN, NorP, Normalize = TRUE, dfArgs = NULL,
           ..., CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tree</code></td>
<td>

<p>An object of class <code>hclust</code>, "phylo" (see <code>read.tree</code>), <code>phylog</code> or <code>PPtree</code>. The tree must be ultrametric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>The function to be applied to each interval of the tree. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NorP</code></td>
<td>

<p>A numeric vector or a two-column matrix. Contains either abundances or probabilities. Two-column matrices should contain the observed abundances (or probabilities) in the first column and the expected ones in the second column, to allow using beta diversity functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the <code>Total</code> value returned by <code>Function</code> is normalized by the height of the tree (it is the weighted average value of the result in each slice).<br>
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfArgs</code></td>
<td>

<p>A dataframe. Columns are arguments for <code>FUN</code>: their names are those of valid arguments. Values will be passed to <code>FUN</code> in each slice of the tree, starting from the tips. The number of lines must equal the number of slices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to pass to <code>Function</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This funtion is generally not used directly. It is a tool to calculate <code>PhyloEntropy</code> and <code>PhyloDiversity</code>.
</p>
<p>Intervals (slices) separate two cuts (nodes) in a tree: no node is found at heights contained in an interval.
</p>
<p>Objects of class <strong>PPtree</strong> are returned by <code>Preprocess.Tree</code>.
</p>
<p>... allow passing arguments to the function but they can't change along the tree. If necessary, <code>dfArgs</code> allow passing a different value for each slice of the tree.
</p>


<h3>Value</h3>

<p>An object of class <code>PhyloValue</code>. It is a list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Distribution</code></td>
<td>
<p>The distribution used to calculate the value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Function</code></td>
<td>
<p>The function used to calculate the value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tree</code></td>
<td>
<p>The functional or phylogenetic tree used to calculate the value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phylovalue is normalized or proportional to the height of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cuts</code></td>
<td>
<p>A named vector containing values along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Corrections</code></td>
<td>
<p>A named vector containing the correction used by FUN to obtain each value of <code>Cuts</code>. Names are those of <code>Cuts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Total</code></td>
<td>
<p>The total value, multiplied by the tree height if <code>Normalize</code> is FALSE.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>


<h3>See Also</h3>

<p><code>Preprocess.Tree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Plot the taxonomy
plot(Paracou618.Taxonomy, type="fan", show.tip.label=FALSE)
# Calculate the mean number of trees (individuals) per species 
# (Cuts are 1=species, 2=genus, 3=family)
summary(PhyloApply(Paracou618.Taxonomy, mean, Paracou618.MC$Ns, TRUE))
</code></pre>


</div>