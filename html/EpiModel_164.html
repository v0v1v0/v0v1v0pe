<div class="container">

<table style="width: 100%;"><tr>
<td>plot.netsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Data from a Stochastic Network Epidemic Model</h2>

<h3>Description</h3>

<p>Plots epidemiological and network data from a stochastic network
model simulated with <code>netsim</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'netsim'
plot(
  x,
  type = "epi",
  y,
  popfrac = FALSE,
  sim.lines = FALSE,
  sims,
  sim.col,
  sim.lwd,
  sim.alpha,
  mean.line = TRUE,
  mean.smooth = TRUE,
  mean.col,
  mean.lwd = 2,
  mean.lty = 1,
  qnts = 0.5,
  qnts.col,
  qnts.alpha = 0.5,
  qnts.smooth = TRUE,
  legend,
  leg.cex = 0.8,
  axs = "r",
  grid = FALSE,
  add = FALSE,
  network = 1,
  at = 1,
  col.status = FALSE,
  shp.g2 = NULL,
  vertex.cex,
  stats,
  targ.line = TRUE,
  targ.col,
  targ.lwd = 2,
  targ.lty = 2,
  plots.joined,
  duration.imputed = TRUE,
  method = "l",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code>EpiModel</code> model object of class <code>netsim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot: <code>"epi"</code> for epidemic model results,
<code>"network"</code> for a static network plot (<code>plot.network</code>),
or <code>"formation"</code>, <code>"duration"</code>, or <code>"dissolution"</code> for
network formation, duration, or dissolution statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Output compartments or flows from <code>netsim</code> object to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popfrac</code></td>
<td>
<p>If <code>TRUE</code>, plot prevalence of values rather than numbers
(see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.lines</code></td>
<td>
<p>If <code>TRUE</code>, plot individual simulation lines. Default is
to plot lines for one-group models but not for two-group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>If <code>type="epi"</code> or <code>"formation"</code>, a vector of
simulation numbers to plot. If <code>type="network"</code>, a single
simulation number for which to plot the network, or else <code>"min"</code>
to plot the simulation number with the lowest disease prevalence,
<code>"max"</code> for the simulation with the highest disease prevalence,
or <code>"mean"</code> for the simulation with the prevalence closest to the
mean across simulations at the specified time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.col</code></td>
<td>
<p>Vector of any standard R color format for simulation lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.lwd</code></td>
<td>
<p>Line width for simulation lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.alpha</code></td>
<td>
<p>Transparency level for simulation lines, where
0 = transparent and 1 = opaque (see <code>adjustcolor</code> function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.line</code></td>
<td>
<p>If <code>TRUE</code>, plot mean of simulations across time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.smooth</code></td>
<td>
<p>If <code>TRUE</code>, use a loess smoother on the mean line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.col</code></td>
<td>
<p>Vector of any standard R color format for mean lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lwd</code></td>
<td>
<p>Line width for mean lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lty</code></td>
<td>
<p>Line type for mean lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qnts</code></td>
<td>
<p>If numeric, plot polygon of simulation quantiles based on the
range implied by the argument (see details). If <code>FALSE</code>, suppress
polygon from plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qnts.col</code></td>
<td>
<p>Vector of any standard R color format for polygons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qnts.alpha</code></td>
<td>
<p>Transparency level for quantile polygons, where 0 =
transparent and 1 = opaque (see <code>adjustcolor</code> function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qnts.smooth</code></td>
<td>
<p>If <code>TRUE</code>, use a loess smoother on quantile polygons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>If <code>TRUE</code>, plot default legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.cex</code></td>
<td>
<p>Legend scale size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axs</code></td>
<td>
<p>Plot axis type (see <code>par</code> for details), with default
of <code>"r"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>If <code>TRUE</code>, a grid is added to the background of plot
(see <code>grid</code> for details), with default of nx by ny.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>If <code>TRUE</code>, new plot window is not called and lines are added
to existing plot window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>
<p>Network number, for simulations with multiple networks
representing the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>If <code>type = "network"</code>, time step for network graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.status</code></td>
<td>
<p>If <code>TRUE</code> and <code>type="network"</code>, automatic disease
status colors (blue = susceptible, red = infected, green = recovered).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shp.g2</code></td>
<td>
<p>If <code>type = "network"</code> and <code>x</code> is for a two-group model,
shapes for the Group 2 vertices, with acceptable inputs of "triangle"
and "square". Group 1 vertices will remain circles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.cex</code></td>
<td>
<p>Relative size of plotted vertices if <code>type="network"</code>,
with implicit default of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>If <code>type="formation","duration","dissolution"</code>, statistics
to plot. For <code>type = "formation"</code>, <code>stats</code> are among those
specified in <code>nwstats.formula</code> of <code>control.net</code>; for
<code>type = "duration", "dissolution"</code>, <code>stats</code> are among those
of the dissolution model (without <code>offset()</code>). The default is
to plot all statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targ.line</code></td>
<td>
<p>If <code>TRUE</code>, plot target or expected value line for
the statistic of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targ.col</code></td>
<td>
<p>Vector of standard R colors for target statistic lines, with
default colors based on <code>RColorBrewer</code> color palettes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targ.lwd</code></td>
<td>
<p>Line width for the line showing the target statistic values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targ.lty</code></td>
<td>
<p>Line type for the line showing the target statistic values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots.joined</code></td>
<td>
<p>If <code>TRUE</code> and
<code>type="formation","duration","dissolution"</code>, combine all
statistics in one plot, versus one plot per statistic if
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration.imputed</code></td>
<td>
<p>If <code>type = "duration"</code>, a logical indicating
whether or not to impute starting times for relationships extant at
the start of the simulation. Defaults to <code>TRUE</code> when
<code>type = "duration"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Plot method for <code>type="formation", "duration", "dissolution"</code>,
with options of <code>"l"</code> for line plots and <code>"b"</code> for box plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This plot function can produce three types of plots with a stochastic network
model simulated through <code>netsim</code>:
</p>

<ol>
<li> <p><strong><code>type="epi"</code></strong>: epidemic model results (e.g., disease
prevalence and incidence) may be plotted.
</p>
</li>
<li> <p><strong><code>type="network"</code></strong>: a static network plot will be
generated. A static network plot of a dynamic network is a
cross-sectional extraction of that dynamic network at a specific
time point. This plotting function wraps the
<code>plot.network</code> function in the <code>network</code> package.
Consult the help page for <code>plot.network</code> for all of the plotting
parameters. In addition, four plotting parameters specific to
<code>netsim</code> plots are available: <code>sim</code>, <code>at</code>,
<code>col.status</code>, and <code>shp.g2</code>.
</p>
</li>
<li> <p><strong><code>type="formation"</code></strong>: summary network statistics related
to the network model formation are plotted. These plots are similar
to the formation plots for <code>netdx</code> objects. When running a
<code>netsim</code> simulation, one must specify there that
<code>save.nwstats=TRUE</code>; the plot here will then show the network
statistics requested explicitly in <code>nwstats.formula</code>, or will use
the formation formula set in <code>netest</code> otherwise.
</p>
</li>
<li> <p><strong><code>type="duration","dissolution"</code></strong>: as in
<code>plot.netdx</code>; supported in <code>plot.netsim</code> only when
the dissolution model is <code>~offset(edges)</code>, <code>tergmLite</code> is
<code>FALSE</code>, and <code>save.network</code> is <code>TRUE</code>.
</p>
</li>
</ol>
<p>When <code>type="epi"</code>, this plotting function will extract the
epidemiological output from a model object of class <code>netsim</code> and plot
the time series data of disease prevalence and other results. The summary
statistics that the function calculates and plots are individual simulation
lines, means of the individual simulation lines, and quantiles of those
individual simulation lines. The mean line, toggled on with
<code>mean.line=TRUE</code>, is calculated as the row mean across simulations at
each time step.
</p>
<p>Compartment prevalences are the size of a compartment over some denominator.
To plot the raw numbers from any compartment, use <code>popfrac=FALSE</code>; this
is the default for any plots of flows. The <code>popfrac</code> parameter
calculates and plots the denominators of all specified compartments using
these rules: 1) for one-group models, the prevalence of any compartment is
the compartment size divided by the total population size; 2) for two-group
models, the prevalence of any compartment is the compartment size divided by
the group population size. For any prevalences that are not automatically
calculated, the <code>mutate_epi</code> function may be used to add new
variables to the <code>netsim</code> object to plot or analyze.
</p>
<p>The quantiles show the range of outcome values within a certain specified
quantile range. By default, the interquartile range is shown: that is the
middle 50\
middle 95\
where they are plotted by default, specify <code>qnts=FALSE</code>.
</p>
<p>When <code>type="network"</code>, this function will plot cross sections of the
simulated networks at specified time steps. Because it is only possible to
plot one time step from one simulation at a time, it is necessary to enter
these in the <code>at</code> and <code>sims</code> parameters. To aid in visualizing
representative and extreme simulations at specific time steps, the
<code>sims</code> parameter may be set to <code>"mean"</code> to plot the simulation in
which the disease prevalence is closest to the average across all
simulations, <code>"min"</code> to plot the simulation in which the prevalence is
lowest, and <code>"max"</code> to plot the simulation in which the prevalence is
highest.
</p>


<h3>See Also</h3>

<p><code>plot.network</code>, <code>mutate_epi</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## SI Model without Network Feedback
# Initialize network and set network model parameters
nw &lt;- network_initialize(n = 100)
nw &lt;- set_vertex_attribute(nw, "group", rep(1:2, each = 50))
formation &lt;- ~edges
target.stats &lt;- 50
coef.diss &lt;- dissolution_coefs(dissolution = ~offset(edges), duration = 20)

# Estimate the network model
est &lt;- netest(nw, formation, target.stats, coef.diss, verbose = FALSE)

# Simulate the epidemic model
param &lt;- param.net(inf.prob = 0.3, inf.prob.g2 = 0.15)
init &lt;- init.net(i.num = 10, i.num.g2 = 10)
control &lt;- control.net(type = "SI", nsteps = 20, nsims = 3,
                       verbose = FALSE, save.nwstats = TRUE,
                       nwstats.formula = ~edges + meandeg + concurrent)
mod &lt;- netsim(est, param, init, control)

# Plot epidemic trajectory
plot(mod)
plot(mod, type = "epi", grid = TRUE)
plot(mod, type = "epi", popfrac = TRUE)
plot(mod, type = "epi", y = "si.flow", qnts = 1, ylim = c(0, 4))

# Plot static networks
par(mar = c(0, 0, 0, 0))
plot(mod, type = "network", vertex.cex = 1.5)

# Automatic coloring of infected nodes as red
par(mfrow = c(1, 2), mar = c(0, 0, 2, 0))
plot(mod, type = "network", main = "Min Prev | Time 50",
     col.status = TRUE, at = 20, sims = "min", vertex.cex = 1.25)
plot(mod, type = "network", main = "Max Prev | Time 50",
     col.status = TRUE, at = 20, sims = "max", vertex.cex = 1.25)

# Automatic shape by group number (circle = group 1)
par(mar = c(0, 0, 0, 0))
plot(mod, type = "network", at = 20, col.status = TRUE,
     shp.g2 = "square")
plot(mod, type = "network", at = 20, col.status = TRUE,
     shp.g2 = "triangle", vertex.cex = 2)

# Plot formation statistics
par(mfrow = c(1,1), mar = c(3,3,1,1), mgp = c(2,1,0))
plot(mod, type = "formation", grid = TRUE)
plot(mod, type = "formation", plots.joined = FALSE)
plot(mod, type = "formation", sims = 2:3)
plot(mod, type = "formation", plots.joined = FALSE,
     stats = c("edges", "concurrent"))
plot(mod, type = "formation", stats = "meandeg",
     mean.lwd = 1, qnts.col = "seagreen", mean.col = "black")

</code></pre>


</div>