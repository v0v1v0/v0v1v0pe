<div class="container">

<table style="width: 100%;"><tr>
<td>el.test.wt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Empirical Likelihood ratio for mean, uncensored data</h2>

<h3>Description</h3>

<p>This program is similar to <code>el.test( )</code> except
it takes weights, and is for one dimensional mu.
</p>
<p>The mean constraint considered is:
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{i=1}^n  p_i x_i  = \mu . </code>
</p>

<p>where <code class="reqn">p_i = \Delta F(x_i)</code> is a probability.
Plus the probability constraint: <code class="reqn"> \sum p_i =1</code>.
</p>
<p>The weighted log empirical likelihood been maximized is
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{i=1}^n w_i \log p_i. </code>
</p>
 


<h3>Usage</h3>

<pre><code class="language-R">el.test.wt(x, wt, mu, usingC=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector containing the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>a vector containing the weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a real number used in the constraint, weighted
mean value of <code class="reqn">f(X)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usingC</code></td>
<td>
<p>TRUE: use C function, which may be benifit when sample size is large; FALSE: use pure R function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function used to be an internal function. 
It becomes external because others may find it useful
elsewhere.
</p>
<p>The constant <code>mu</code> must be inside 
<code class="reqn">( \min x_i , \max x_i ) </code>
for the computation to continue. 
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>the vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>The probabilities that maximized the weighted 
empirical likelihood under mean constraint.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou, Y.F. Yang for C part. </p>


<h3>References</h3>

<p>Owen, A. (1990). Empirical likelihood ratio 
confidence regions. 
<em>Ann. Statist.</em> <b>18</b>, 90-120.
</p>
<p>Zhou, M. (2002). 
Computing censored empirical likelihood ratio 
by EM algorithm. 
<em>Tech Report, Univ. of Kentucky, Dept of Statistics</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example with tied observations
x &lt;- c(1, 1.5, 2, 3, 4, 5, 6, 5, 4, 1, 2, 4.5)
d &lt;- c(1,   1, 0, 1, 0, 1, 1, 1, 1, 0, 0,   1)
el.cen.EM(x,d,mu=3.5)
## we should get "-2LLR" = 1.2466....
myfun5 &lt;- function(x, theta, eps) {
u &lt;- (x-theta)*sqrt(5)/eps 
INDE &lt;- (u &lt; sqrt(5)) &amp; (u &gt; -sqrt(5)) 
u[u &gt;= sqrt(5)] &lt;- 0 
u[u &lt;= -sqrt(5)] &lt;- 1 
y &lt;- 0.5 - (u - (u)^3/15)*3/(4*sqrt(5)) 
u[ INDE ] &lt;- y[ INDE ] 
return(u)
}
el.cen.EM(x, d, fun=myfun5, mu=0.5, theta=3.5, eps=0.1)
</code></pre>


</div>