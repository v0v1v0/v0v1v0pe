<div class="container">

<table style="width: 100%;"><tr>
<td>ensembleMOS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
EMOS modeling
</h2>

<h3>Description</h3>

<p>Fits a EMOS model to ensemble forecasts.
Allows specification of a model, training rule, and forecasting dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ensembleMOS(ensembleData, trainingDays, consecutive = FALSE,
            dates = NULL, control = NULL, warmStart = FALSE,
            model = NULL, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with the
corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>A list of control values for the fitting functions. The corresponding
control function has to be chosen in accordance with the selected 
<code>model</code>. For the Gaussian (normal) EMOS model see controlMOSnormal,
for the truncated normal model see controlMOStruncnormal,
for the log-normal model see controlMOSlognormal,
for the censored and shifted gamma model see controlMOScsg0,
and for the censored generalized extreme value distribution model see controlMOSgev0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>A character string describing the EMOS model to be fit.
Current choices are <code>"normal"</code> (typically used for temperature
or pressure data), <code>"truncnormal"</code> (typically used for wind 
speed data), <code>"lognormal"</code> (typically used for wind 
speed data), <code>"csg0"</code> (typically used for precipitation accumulation data),
and <code>"gev0"</code> (typically used for precipitation accumulation data).
For specific details on model fitting see ensembleMOSnormal,
ensembleMOStruncnormal, ensembleMOSlognormal, 
ensembleMOScsg0, or ensembleMOSgev0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters within each
group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If dates are specified in <code>dates</code> that cannot be forecast
with the training rule, the corresponding EMOS model parameter
outputs will be missing (<code>NA</code>) but not <code>NULL</code>. <br>
The training rule uses the number of days corresponding to its
<code>length</code> regardless of whether or not the dates are consecutive.
<br></p>


<h3>Value</h3>

<p>A list containing information on the training (length, lag and the 
number of instances used for training for each modeling date), the
exchangeability, and vectors and/or matrics containing the estimated
regression and variance coefficient values depending on the specified
<code>model</code>.
</p>


<h3>References</h3>

<p><em>Gaussian (normal) EMOS model</em>: <br>
T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098–1118, 2005.
<br><br><em>Truncated normal EMOS model</em>: <br>
T. L. Thorarinsdottir and T. Gneiting,
Probabilistic forecasts of wind speed: 
Ensemble model output statistics by using 
heteroscedastic censored regression.
<em>Journal of the Royal Statistical Society Series A</em> 
173:371–388, 2010.
<br><br><em>Log-normal EMOS model</em>: <br>
S. Baran and S. Lerch, Log-normal distribution based Ensemble Model
Output Statistics models for probabilistic wind-speed forecasting. 
<em>Quarterly Journal of the Royal Meteorological Society</em> 141:2289–2299,
2015.
<br><br><em>Censored and shifted gamma EMOS model</em>: <br>
M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578–4596, 2015.<br>
S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280–292, 2016.  
<br><br><em>Censored generalized extreme value distribution EMOS model</em>: <br>
M. Scheuerer, Probabilistic quantitative precipitation forecasting using ensemble
model output statistics. <em>Quarterly Journal of the Royal Meteorological
Society</em> 140:1086–1096, 2014.
</p>


<h3>See Also</h3>

<p><code>trainingData</code>,
<code>ensembleMOSnormal</code>,
<code>ensembleMOStruncnormal</code>,
<code>ensembleMOSlognormal</code>,
<code>ensembleMOScsg0</code>,
<code>ensembleMOSgev0</code>,
<code>controlMOSnormal</code>,
<code>controlMOStruncnormal</code>,
<code>controlMOSlognormal</code>,
<code>controlMOScsg0</code>,
<code>controlMOSgev0</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOS(tempTestData, trainingDays = 25, 
                           model = "normal")

 ## Same as
 ## tempTestFit &lt;- ensembleMOSnormal(tempTestData, trainingDays = 25)
</code></pre>


</div>