<div class="container">

<table style="width: 100%;"><tr>
<td>ciCalculations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ciCalculations</h2>

<h3>Description</h3>

<p>Interactive function to calculate confidence bands for flow normalized concentration or flow normalized flux.
It returns the data frame CIAnnualResults, which is used as input to the functions
plotConcHistBoot( ), and plotFluxHistBoot( ) which produce the graphical output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ciCalculations(eList, startSeed = 494817, verbose = TRUE,
  jitterOn = FALSE, V = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code>modelEstimation</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical specifying whether or not to display progress messag, default = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitterOn</code></td>
<td>
<p>logical, if TRUE, adds "jitter" to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optionally include nBoot, blockLength, or widthCI</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of "jitter" can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random "jitter" to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>
<p>Argument values suggested.  
To test the code nBoot = 10 is sufficient, but for meaningful results nBoot = 100 or even nBoot = 500 are more appropriate.
blockLength = 200
widthCI = 90 (90% confidence interval)
</p>


<h3>Value</h3>

<p>CIAnnualResults a data frame with the following columns
Year, mean decYear value for the year being reported
FNConcLow, the lower confidence limit for flow normalized concentration, in mg/L
FNConcHigh, the upper confidence limit for flow normalized concentration, in mg/L
FNFluxLow, the lower confidence limit for flow normalized flux, in kg
FNFluxLow, the lower confidence limit for flow normalized flux, in kg
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(EGRET)
eList &lt;- Choptank_eList
## Not run: 
# If run interactively, using stationary flow normalization
# in this format it will prompt for nBoot, blockLength and widthCI.
# CIAnnualResults &lt;- ciCalculations(eList)

# run in batch mode, using non-stationary flow normalization
# In this example nBoot is set very small, useful for an initial trial run.
# A meaningful application would use nBoot values such as 100 or even 500. 
seriesOut_2 &lt;- runSeries(eList, windowSide = 11)
CIAnnualResults &lt;- ciCalculations(seriesOut_2, 
                     nBoot = 10,
                     blockLength = 200,
                     widthCI = 90)
                     
 plotConcHistBoot(seriesOut_2, CIAnnualResults)


## End(Not run)
</code></pre>


</div>