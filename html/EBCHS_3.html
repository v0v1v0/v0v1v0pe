<div class="container">

<table style="width: 100%;"><tr>
<td>EB_CS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function used in the paper (Du and Hu, 2020)</h2>

<h3>Description</h3>

<p>Give a sequence of chi-squared statistic values, the function computes the posterior mean, variance, and skewness
of the noncentrality parameter given the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EB_CS(
  x,
  df,
  qq = c(0.2, 0.4, 0.6, 0.8),
  method = c("LS", "PLS", "g_model"),
  mixture = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a sequence of chi-squared test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qq</code></td>
<td>
<p>the quantiles used in spline basis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>LS: parametric least-squares; PLS: penalized least-squares; g-model: g-modeling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture</code></td>
<td>
<p>default is FALSE: there is no point mass at zero.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list: posterior mean, variance, and skewness estimates
</p>


<h3>References</h3>

<p>Du and Hu (2020), <em>An Empirical Bayes Method for Chi-Squared Data</em>, <em>Journal of American Statistical Association</em>, forthcoming.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p = 1000
k = 7
# the prior distribution for lambda
alpha = 2
beta =  10
# lambda
lambda = rep(0, p)
pi_0 = 0.8
p_0 = floor(p*pi_0)
p_1 = p-p_0
lambda[(p_0+1):p] = rgamma(p_1, shape = alpha, rate=1/beta)
# Generate a Poisson RV
J = sapply(1:p, function(x){rpois(1, lambda[x]/2)})
X = sapply(1:p, function(x){rchisq(1, k+2*J[x])})
qq_set = seq(0.01, 0.99, 0.01)
out = EB_CS(X, k, qq=qq_set, method='LS', mixture = TRUE)
E = out$E_lambda
V = out$V_lambda
S = out$S_lambda

</code></pre>


</div>