<div class="container">

<table style="width: 100%;"><tr>
<td>predIntNparN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample Size for a Nonparametric Prediction Interval for a Continuous Distribution
</h2>

<h3>Description</h3>

<p>Compute the sample size necessary for a nonparametric prediction interval to 
contain at least <code class="reqn">k</code> out of the next <code class="reqn">m</code> future observations with 
probability <code class="reqn">(1-\alpha)100\%</code> for a continuous distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntNparN(k = m, m = 1, lpl.rank = ifelse(pi.type == "upper", 0, 1), 
    n.plus.one.minus.upl.rank = ifelse(pi.type == "lower", 0, 1), 
    pi.type = "two.sided", conf.level = 0.95, n.max = 5000, maxiter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>vector of positive integers specifying the minimum number of future 
observations out of <code>m</code> that should be contained in the prediction interval.  
The default value is <code>k=m</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>vector of positive integers specifying the number of future observations.  
The default value is <code>m=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpl.rank</code></td>
<td>

<p>vector of positive integers indicating the rank of the order statistic to use for 
the lower bound of the prediction interval.  If <code>pi.type="two-sided"</code> or <br><code>pi.type="lower"</code>, the default value is <code>lpl.rank=1</code> (implying the 
minimum value is used as the lower bound of the prediction interval).  
If <code>pi.type="upper"</code>, this argument is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.plus.one.minus.upl.rank</code></td>
<td>

<p>vector of positive integers related to the rank of the order statistic to use for 
the upper bound of the prediction interval.  A value of 
<code>n.plus.one.minus.upl.rank=1</code> (the default) means use the 
first largest value, and in general a value of <br><code>n.plus.one.minus.upl.rank=</code><code class="reqn">i</code> means use the <code class="reqn">i</code>'th largest value.  
If <br><code>pi.type="lower"</code>, this argument is set equal to <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>"two.sided"</code> (the default), <code>"lower"</code>, and 
<code>"upper"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric vector of values between 0 and 1 indicating the confidence level 
associated with the prediction interval.  The default value is 
<code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.max</code></td>
<td>

<p>positive integer greater than 1 indicating the maximum possible sample size.  The 
default value is <code>n.max=5000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>positive integer indicating the maximum number of iterations to use in the 
<code>uniroot</code> search algorithm.  The default value is 
<code>maxiter=1000</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the arguments <code>k</code>, <code>m</code>, <code>lpl.rank</code>, and 
<code>n.plus.one.minus.upl.rank</code> are not all the same length, they are replicated 
to be the same length as the length of the longest argument.
</p>
<p>The function <code>predIntNparN</code> initially computes the required sample size <code class="reqn">n</code> 
by solving Equation (11) or (12) in the help file for <code>predIntNpar</code> for 
<code class="reqn">n</code>, depending on the value of the argument <code>pi.type</code>.  If <code>k &lt; m</code>, 
<code>lpl.rank &gt; 1</code> (two-sided and lower prediction intervals only), or <br><code>n.plus.one.minus.upl.rank &gt; 1</code> (two-sided and upper prediction intervals only), 
then this initial value of <code class="reqn">n</code> is used as the upper bound in a binary search 
based on Equation (8) in the help file for <code>predIntNpar</code> and is 
implemented via the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>uniroot</code> with the argument 
<code>tolerance</code> set to <code>1</code>.
</p>


<h3>Value</h3>

<p>vector of positive integers indicating the required sample size(s) for the 
specified nonparametric prediction interval(s).
</p>


<h3>Note</h3>

<p>See the help file for <code>predIntNpar</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help file for <code>predIntNpar</code>.
</p>


<h3>See Also</h3>

<p><code>predIntNpar</code>, <code>predIntNparConfLevel</code>, 
<code>plotPredIntNparDesign</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Look at how the required sample size for a nonparametric prediction interval 
  # increases with increasing confidence level:

  seq(0.5, 0.9, by = 0.1) 
  #[1] 0.5 0.6 0.7 0.8 0.9 

  predIntNparN(conf.level = seq(0.5, 0.9, by = 0.1)) 
  #[1] 3 4 6 9 19

  #----------

  # Look at how the required sample size for a nonparametric prediction interval 
  # increases with number of future observations (m):

  1:5
  #[1] 1 2 3 4 5

  predIntNparN(m = 1:5) 
  #[1] 39 78 116 155 193

  #----------

  # Look at how the required sample size for a nonparametric prediction interval 
  # increases with minimum number of observations that must be contained within 
  # the interval (k):

  predIntNparN(k = 1:5, m = 5) 
  #[1] 4 7 13 30 193

  #----------

  # Look at how the required sample size for a nonparametric prediction interval 
  # increases with the rank of the lower prediction limit:

  predIntNparN(lpl.rank = 1:5) 
  #[1]  39  59  79 100 119

  #==========

  # Example 18-3 of USEPA (2009, p.18-19) shows how to construct 
  # a one-sided upper nonparametric prediction interval for the next 
  # 4 future observations of trichloroethylene (TCE) at a downgradient well.  
  # The data for this example are stored in EPA.09.Ex.18.3.TCE.df.  
  # There are 6 monthly observations of TCE (ppb) at 3 background wells, 
  # and 4 monthly observations of TCE at a compliance well.

  # Look at the data
  #-----------------

  EPA.09.Ex.18.3.TCE.df

  #   Month Well  Well.type TCE.ppb.orig TCE.ppb Censored
  #1      1 BW-1 Background           &lt;5     5.0     TRUE
  #2      2 BW-1 Background           &lt;5     5.0     TRUE
  #3      3 BW-1 Background            8     8.0    FALSE
  #...
  #22     4 CW-4 Compliance           &lt;5     5.0     TRUE
  #23     5 CW-4 Compliance            8     8.0    FALSE
  #24     6 CW-4 Compliance           14    14.0    FALSE


  longToWide(EPA.09.Ex.18.3.TCE.df, "TCE.ppb.orig", "Month", "Well", 
    paste.row.name = TRUE)

  #        BW-1 BW-2 BW-3 CW-4
  #Month.1   &lt;5    7   &lt;5     
  #Month.2   &lt;5  6.5   &lt;5     
  #Month.3    8   &lt;5 10.5  7.5
  #Month.4   &lt;5    6   &lt;5   &lt;5
  #Month.5    9   12   &lt;5    8
  #Month.6   10   &lt;5    9   14


  # If we construct the prediction limit based on the background well
  # data using the maximum value as the upper prediction limit, 
  # the associated confidence level is only 82%.  
  #-----------------------------------------------------------------

  predIntNparConfLevel(n = 18, m = 4, pi.type = "upper")
  #[1] 0.8181818

  # We would have to collect an additional 18 observations to achieve a 
  # confidence level of at least 90%:

  predIntNparN(m = 4, pi.type = "upper", conf.level = 0.9)
  #[1] 36

  predIntNparConfLevel(n = 36, m = 4, pi.type = "upper")
  #[1] 0.9
</code></pre>


</div>