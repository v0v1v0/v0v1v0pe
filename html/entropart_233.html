<div class="container">

<table style="width: 100%;"><tr>
<td>Tsallis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Tsallis (HCDT) Entropy of a community
</h2>

<h3>Description</h3>

<p>Calculates the HCDT, also known as Tsallis entropy of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Tsallis(NorP, q = 1, ...)
bcTsallis(Ns, q = 1, Correction = "Best", SampleCoverage = NULL,
  CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
Tsallis(NorP, q = 1, ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
Tsallis(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
Tsallis(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
Tsallis(NorP, q = 1, Correction = "Best", Level = NULL,
  PCorrection="Chao2015", Unveiling="geom", RCorrection="Rarefy", ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code>AbdVector</code>) or a probability vector (<code>ProbaVector</code>). Contains either abundances or probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A number: the order of entropy. Some corrections allow only a positive number. Default is 1 for Shannon entropy.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correction</code></td>
<td>

<p>A string containing one of the possible asymptotic estimators: <code>"None"</code> (no correction), <code>"ChaoShen"</code>, <code>"GenCov"</code>, <code>"Grassberger"</code>, <code>"Holste"</code>, <code>"Bonachela"</code>, <code>"ZhangGrabchak"</code>, or <code>"ChaoJost"</code>, <code>"Marcon"</code>, <code>"UnveilC"</code>, <code>"UnveiliC"</code>, <code>"UnveilJ"</code> or <code>"Best"</code>, the default value.  Currently, <code>"Best"</code> is <code>"UnveilJ"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Level</code></td>
<td>

<p>The level of interpolation or extrapolation. It may be an a chosen sample size (an integer) or a sample coverage (a number between 0 and 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCorrection</code></td>
<td>

<p>A string containing one of the possible corrections to estimate a probability distribution in <code>as.ProbaVector</code>: <code>"Chao2015"</code> is the default value. Used only for extrapolation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Unveiling</code></td>
<td>

<p>A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species in <code>as.ProbaVector</code>: <code>"geom"</code> (the unobserved species distribution is geometric) is the default value. Used only for extrapolation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RCorrection</code></td>
<td>

<p>A string containing a correction recognized by <code>Richness</code> to evaluate the total number of species in <code>as.ProbaVector</code>. <code>"Rarefy"</code> is the default value to estimate the number of species such that the entropy of the asymptotic distribution rarefied to the observed sample size equals the observed entropy of the data. Used only for extrapolation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampleCoverage</code></td>
<td>

<p>The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tsallis (Havrda and Charvat, 1967; Daroczy, 1970; Tsallis, 1988) generalized entropy is a generalized measure of diversity (Jost, 2006).
</p>
<p>Bias correction requires the number of individuals to estimate sample <code>Coverage</code>.
</p>
<p>Correction techniques are from Chao and Shen (2003), Grassberger (1988), Holste <em>et al.</em> (1998), Bonachela <em>et al.</em> (2008), (Marcon <em>et al.</em>, 2014), which is actually the max value of <code>"ChaoShen"</code> and <code>"Grassberger"</code>, Zhang and Grabchak (2014), Chao and Jost (2015) and Marcon (2015).
</p>
<p>The <code>"ChaoJost"</code> (Chao, Wang and Jost, 2013 for <code class="reqn">q=1</code>; Chao and Jost, 2015) estimator contains an unbiased part concerning observed species, equal to that of Zhang and Grabchak (2014), and a (biased) estimator of the remaining bias based on the estimation of the species-accumulation curve. 
It is very efficient but very slow if the number of individuals is more than a few hundreds. 
This estimator was named "ChaoWangJost" in previous versions of the package; its old name is still supported for backward compatibility.
</p>
<p>The unveiled estimators rely on Chao <em>et al.</em> (2015), completed by Marcon (2015). 
The actual probabilities of observed species are estimated and completed by a geometric distribution of the probabilities of unobserved species. 
The number of unobserved species is estimated by the Chao1 estimator (<code>"UnveilC"</code>), following Chao <em>et al.</em> (2015), or by the iChao1 (<code>"UnveiliC"</code>) or the jacknife (<code>"UnveilJ"</code>). 
The <code>"UnveilJ"</code> correction often has a lower bias but a greater variance (Marcon, 2015). 
It is a good first choice thanks to the versatility of the jacknife estimator of richness.
</p>
<p>The functions are designed to be used as simply as possible. 
<code>Tsallis</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallis</code> is called.
</p>
<p>The size of a metacommunity (see <code>MetaCommunity</code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. 
Then, classical bias-correction methods do not apply. 
Providing the <code>SampleCoverage</code> argument allows applying the <code>"ChaoShen"</code> and <code>"Grassberger"</code> corrections to estimate quite well the entropy. 
<code>DivPart</code> and <code>GammaEntropy</code> functions use this tweak.
</p>
<p>Entropy can be estimated at a specified level of interpolation or extrapolation, either a chosen sample size or sample coverage (Chao et al., 2014), rather than its asymptotic value.
Special cases $q$ equals 0, 1 or 2 are treated by <code>Richness</code>, <code>Shannon</code> and <code>Simpson</code> functions.
For extrapolation of entropy of other values of $q$, the asymptotic distribution of the community must be estimated by <code>as.ProbaVector</code>.
The default arguments allow joining smoothly the extrapolated entropy and the observed entropy by estimating the number of unobserved species so that the entropy of the observed distribution equals the entropy of the asymptotic distribution rarefied to the actual sample size.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated entropy. The name is that of the bias correction used.
</p>


<h3>References</h3>

<p>Chao, A., Gotelli, N. J., Hsieh, T. C., Sander, E. L., Ma, K. H., Colwell, R. K., Ellison, A. M (2014). Rarefaction and extrapolation with Hill numbers: A framework for sampling and estimation in species diversity studies.  <em>Ecological Monographs</em>, 84(1): 45-67.
</p>
<p>Chao, A. and Jost, L. (2015) Estimating diversity and entropy profiles via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 6(8): 873-882.
</p>
<p>Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p>Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p>Havrda, J. and Charvat, F. (1967). Quantification method of classification processes. Concept of structural a-entropy. <em>Kybernetika</em> 3(1): 30-35.
</p>
<p>Daroczy, Z. (1970). Generalized information functions. <em>Information and Control</em> 16(1): 36-51.
</p>
<p>Jost, L. (2006). Entropy and diversity. <em>Oikos</em> 113(2): 363-375.
</p>
<p>Marcon, E. (2015) Practical Estimation of Diversity from Abundance Data. <em>HAL</em> 01212435: 1-27.
</p>
<p>Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p>Tsallis, C. (1988). Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em> 52(1): 479-487.
</p>
<p>Zhang, Z., and Grabchak, M. (2016). Entropic Representation and Estimation of Diversity Indices. <em>Journal of Nonparametric Statistics</em>, 28(3): 563-575.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate entropy of order 1, i.e. Shannon's entropy
Tsallis(Ps, 1)
# Calculate it with estimation bias correction
Tsallis(Ns, 1)
</code></pre>


</div>