<div class="container">

<table style="width: 100%;"><tr>
<td>polychoric.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes Polychoric Correlations</h2>

<h3>Description</h3>

<p>A fast implementation of polychoric correlations in C.
Uses the Beasley-Springer-Moro algorithm (Boro &amp; Springer, 1977; Moro, 1995)
to estimate the inverse univariate normal CDF, the Drezner-Wesolosky
approximation (Drezner &amp; Wesolosky, 1990) to estimate the bivariate normal
CDF, and Brent's method (Brent, 2013) for optimization of rho
</p>


<h3>Usage</h3>

<pre><code class="language-R">polychoric.matrix(
  data,
  na.data = c("pairwise", "listwise"),
  empty.method = c("none", "zero", "all"),
  empty.value = c("none", "point_five", "one_over"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Matrix or data frame.
A dataset with all ordinal values
(rows = cases, columns = variables).
Data are required to be between <code>0</code> and <code>11</code>.
Proper adjustments should be made prior to analysis (e.g.,
scales from -3 to 3 in increments of 1 should be shifted
by added 4 to all values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.data</code></td>
<td>
<p>Character (length = 1).
How should missing data be handled?
Defaults to <code>"pairwise"</code>.
Available options:
</p>

<ul>
<li> <p><code>"pairwise"</code> — Computes correlation for all available cases between
two variables
</p>
</li>
<li> <p><code>"listwise"</code> — Computes correlation for all complete cases in the dataset
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empty.method</code></td>
<td>
<p>Character (length = 1).
Method for empty cell correction.
Available options:
</p>

<ul>
<li> <p><code>"none"</code> — Adds no value (<code>empty.value = "none"</code>)
to the empirical joint frequency table between two variables
</p>
</li>
<li> <p><code>"zero"</code> — Adds <code>empty.value</code> to the cells with zero
in the joint frequency table between two variables
</p>
</li>
<li> <p><code>"all"</code> — Adds <code>empty.value</code> to all
in the joint frequency table between two variables
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empty.value</code></td>
<td>
<p>Character (length = 1).
Value to add to the joint frequency table cells.
Accepts numeric values between 0 and 1 or
specific methods:
</p>

<ul>
<li> <p><code>"none"</code> — Adds no value (<code>0</code>) to the empirical joint
frequency table between two variables
</p>
</li>
<li> <p><code>"point_five"</code> — Adds <code>0.5</code> to the cells defined by <code>empty.method</code>
</p>
</li>
<li> <p><code>"one_over"</code> — Adds <code>1 / n</code> where <em>n</em> equals the number of cells
based on <code>empty.method</code>. For <code>empty.method = "zero"</code>,
<em>n</em> equals the number of <em>zero</em> cells
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used but made available for easier
argument passing</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a polychoric correlation matrix
</p>


<h3>Author(s)</h3>

<p>Alexander P. Christensen &lt;alexpaulchristensen@gmail.com&gt; with assistance from GPT-4
</p>


<h3>References</h3>

<p><strong>Beasley-Moro-Springer algorithm</strong> <br>
Beasley, J. D., &amp; Springer, S. G. (1977).
Algorithm AS 111: The percentage points of the normal distribution.
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, <em>26</em>(1), 118-121.
</p>
<p>Moro, B. (1995).
The full monte.
<em>Risk 8 (February)</em>, 57-58.
</p>
<p><strong>Brent optimization</strong> <br>
Brent, R. P. (2013).
Algorithms for minimization without derivatives.
Mineola, NY: Dover Publications, Inc.
</p>
<p><strong>Drezner-Wesolowsky bivariate normal approximation</strong> <br>
Drezner, Z., &amp; Wesolowsky, G. O. (1990).
On the computation of the bivariate normal integral.
<em>Journal of Statistical Computation and Simulation</em>, <em>35</em>(1-2), 101-107.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data (ensure matrix for missing data example)
wmt &lt;- as.matrix(wmt2[,7:24])

# Compute polychoric correlation matrix
correlations &lt;- polychoric.matrix(wmt)

# Randomly assign missing data
wmt[sample(1:length(wmt), 1000)] &lt;- NA

# Compute polychoric correlation matrix
# with pairwise missing
pairwise_correlations &lt;- polychoric.matrix(
  wmt, na.data = "pairwise"
)

# Compute polychoric correlation matrix
# with listwise missing
pairwise_correlations &lt;- polychoric.matrix(
  wmt, na.data = "listwise"
)

</code></pre>


</div>