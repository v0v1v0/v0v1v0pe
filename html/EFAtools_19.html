<div class="container">

<table style="width: 100%;"><tr>
<td>HULL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hull method for determining the number of factors to retain</h2>

<h3>Description</h3>

<p>Implementation of the Hull method suggested by Lorenzo-Seva, Timmerman,
and Kiers (2011), with an extension to principal axis factoring. See details for
parallelization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HULL(
  x,
  N = NA,
  n_fac_theor = NA,
  method = c("PAF", "ULS", "ML"),
  gof = c("CAF", "CFI", "RMSEA"),
  eigen_type = c("SMC", "PCA", "EFA"),
  use = c("pairwise.complete.obs", "all.obs", "complete.obs", "everything",
    "na.or.complete"),
  cor_method = c("pearson", "spearman", "kendall"),
  n_datasets = 1000,
  percent = 95,
  decision_rule = c("means", "percentile", "crawford"),
  n_factors = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix or data.frame. Dataframe or matrix of raw data or matrix with
correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>numeric. Number of cases in the data. This is passed to PARALLEL.
Only has to be specified if x is a correlation matrix, otherwise it is determined
based on the dimensions of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fac_theor</code></td>
<td>
<p>numeric. Theoretical number of factors to retain. The maximum
of this number and the number of factors suggested by PARALLEL plus
one will be used in the Hull method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character. The estimation method to use. One of  <code>"PAF"</code>,
<code>"ULS"</code>, or  <code>"ML"</code>, for principal axis factoring, unweighted
least squares, and maximum likelihood, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof</code></td>
<td>
<p>character. The goodness of fit index to use. Either <code>"CAF"</code>,
<code>"CFI"</code>, or <code>"RMSEA"</code>, or any combination of them.
If <code>method = "PAF"</code> is used, only
the CAF can be used as goodness of fit index. For details on the CAF, see
Lorenzo-Seva, Timmerman, and Kiers (2011).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen_type</code></td>
<td>
<p>character. On what the eigenvalues should be found in the
parallel analysis. Can be one of <code>"SMC"</code>, <code>"PCA"</code>, or <code>"EFA"</code>.
If using  <code>"SMC"</code> (default), the diagonal of the correlation matrices is
replaced by the squared multiple correlations (SMCs) of the indicators. If
using  <code>"PCA"</code>, the diagonal values of the correlation
matrices are left to be 1. If using  <code>"EFA"</code>, eigenvalues are found on the
correlation  matrices with the final communalities of an EFA solution as
diagonal. This is passed to  <code>PARALLEL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>character. Passed to <code>stats::cor</code> if raw data
is given as input. Default is <code>"pairwise.complete.obs"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_method</code></td>
<td>
<p>character. Passed to <code>stats::cor</code>.
Default is  <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_datasets</code></td>
<td>
<p>numeric. The number of datasets to simulate. Default is 1000.
This is passed to <code>PARALLEL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent</code></td>
<td>
<p>numeric. A vector of percentiles to take the simulated eigenvalues from.
Default is 95. This is passed to <code>PARALLEL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decision_rule</code></td>
<td>
<p>character. Which rule to use to determine the number of
factors to retain. Default is <code>"means"</code>, which will use the average
simulated eigenvalues. <code>"percentile"</code>, uses the percentiles specified
in percent. <code>"crawford"</code> uses the 95th percentile for the first factor
and the mean afterwards (based on Crawford et al, 2010). This is passed to <code>PARALLEL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_factors</code></td>
<td>
<p>numeric. Number of factors to extract if  <code>"EFA"</code> is
included in <code>eigen_type</code>. Default is 1. This is passed to
<code>PARALLEL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>EFA</code>, also in
<code>PARALLEL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Hull method aims to find a model with an optimal balance between
model fit and number of parameters. That is, it aims to retrieve only major
factors (Lorenzo-Seva, Timmerman, &amp; Kiers, 2011). To this end, it performs
the following steps (Lorenzo-Seva, Timmerman, &amp; Kiers, 2011, p.351):
</p>

<ol>
<li>
<p> It performs parallel analysis and adds one to the identified number of factors (this number is denoted <em>J</em>). <em>J</em> is taken as an upper bound of the number of factors to retain in the hull method. Alternatively, a theoretical number of factors can be entered. In this case <em>J</em> will be set to whichever of these two numbers (from parallel analysis or based on theory) is higher.
</p>
</li>
<li>
<p> For all 0 to <em>J</em> factors, the goodness-of-fit (one of <em>CAF</em>, <em>RMSEA</em>, or <em>CFI</em>) and the degrees of freedom (<em>df</em>) are computed.
</p>
</li>
<li>
<p> The solutions are ordered according to their <em>df</em>.
</p>
</li>
<li>
<p> Solutions that are not on the boundary of the convex hull are eliminated (see Lorenzo-Seva, Timmerman, &amp; Kiers, 2011, for details).
</p>
</li>
<li>
<p> All the triplets of adjacent solutions are considered consecutively. The middle solution is excluded if its point is below or on the line connecting its neighbors in a plot of the goodness-of-fit versus the degrees of freedom.
</p>
</li>
<li>
<p> Step 5 is repeated until no solution can be excluded.
</p>
</li>
<li>
<p> The <em>st</em> values of the “hull” solutions are determined.
</p>
</li>
<li>
<p> The solution with the highest <em>st</em> value is selected.
</p>
</li>
</ol>
<p>The PARALLEL function and the principal axis factoring of the
different number of factors can be parallelized using the future framework,
by calling the future::plan function. The examples
provide example code on how to enable parallel processing.
</p>
<p>Note that if <code>gof = "RMSEA"</code> is used, 1 - RMSEA is actually used to
compare the different solutions. Thus, the threshold of .05 is then .95. This
is necessary due to how the heuristic to locate the elbow of the hull works.
</p>
<p>The ML estimation method uses the stats::factanal
starting values. See also the EFA documentation.
</p>
<p>The <code>HULL</code> function can also be called together with other factor
retention criteria in the <code>N_FACTORS</code> function.
</p>


<h3>Value</h3>

<p>A list of class HULL containing the following objects
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n_fac_CAF</code></td>
<td>
<p>The number of factors to retain according to the Hull method
with the CAF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fac_CFI</code></td>
<td>
<p>The number of factors to retain according to the Hull method
with the CFI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fac_RMSEA</code></td>
<td>
<p>The number of factors to retain according to the Hull method
with the RMSEA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutions_CAF</code></td>
<td>
<p>A matrix containing the CAFs, degrees of freedom, and for the factors lying on the hull, the st values of the hull solution (see Lorenzo-Seva, Timmerman, and Kiers 2011 for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutions_CFI</code></td>
<td>
<p>A matrix containing the CFIs, degrees of freedom, and for the factors lying on the hull, the st values of the hull solution (see Lorenzo-Seva, Timmerman, and Kiers 2011 for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutions_RMSEA</code></td>
<td>
<p>A matrix containing the RMSEAs, degrees of freedom, and for the factors lying on the hull, the st values of the hull solution (see Lorenzo-Seva, Timmerman, and Kiers 2011 for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fac_max</code></td>
<td>
<p>The upper bound <em>J</em> of the number of factors to extract (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settings</code></td>
<td>
<p>A list of the settings used.</p>
</td>
</tr>
</table>
<h3>Source</h3>

<p>Lorenzo-Seva, U., Timmerman, M. E., &amp; Kiers, H. A. (2011).
The Hull method for selecting the number of common factors. Multivariate
Behavioral Research, 46(2), 340-364.
</p>


<h3>See Also</h3>

<p>Other factor retention criteria: <code>CD</code>, <code>EKC</code>,
<code>KGC</code>, <code>PARALLEL</code>, <code>SMT</code>
</p>
<p><code>N_FACTORS</code> as a wrapper function for this and all the
above-mentioned factor retention criteria.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# using PAF (this will throw a warning if gof is not specified manually
# and CAF will be used automatically)
HULL(test_models$baseline$cormat, N = 500, gof = "CAF")

# using ML with all available fit indices (CAF, CFI, and RMSEA)
HULL(test_models$baseline$cormat, N = 500, method = "ML")

# using ULS with only RMSEA
HULL(test_models$baseline$cormat, N = 500, method = "ULS", gof = "RMSEA")


## Not run: 
# using parallel processing (Note: plans can be adapted, see the future
# package for details)
future::plan(future::multisession)
HULL(test_models$baseline$cormat, N = 500, gof = "CAF")

## End(Not run)
</code></pre>


</div>