<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_rate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating evolutionary rate model</h2>

<h3>Description</h3>

<p><code>simulate_rate</code> Simulates three different evolutionary rates models. In
the two first, 'predictor_BM' and 'predictor_gBM', the evolution of y follows
a Brownian motion with variance linear in x, while the evolution of x either
follows a Brownian motion or a geometric Brownian motion, respectively. In
the third model, 'recent_evol', the residuals of the macroevolutionary
predictions of y have variance linear in x.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_rate(
  tree,
  startv_x = NULL,
  sigma_x = NULL,
  a,
  b,
  sigma_y = NULL,
  x = NULL,
  model = "predictor_BM"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A <code>phylo</code> object. Must be ultrametric and scaled to
unit length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startv_x</code></td>
<td>
<p>The starting value for x (usually 0 for 'predictor_BM' and
'recent_evol', and 1 for 'predictor_gBM').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_x</code></td>
<td>
<p>The evolutionary rate of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A parameter of the evolutionary rate of y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A parameter of the evolutionary rate of y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_y</code></td>
<td>
<p>The evolutionary rate for the macroevolution of y (Brownian
motion process) used in the 'recent_evolution' model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Optional fixed values of x (only for the 'recent_evol' model), must
equal number of tips in the phylogeny, must correspond to the order of the
tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Either a Brownian motion model of x 'predictor_BM', geometric
Brownian motion model of x 'predictor_gBM', or 'recent_evol'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the vignette 'Analyzing rates of evolution' for an explanation
of the evolutionary models. The data of the tips can be analyzed with the
function <code>rate_gls</code>. Note that a large part of parameter space
will cause negative roots in the rates of y (i.e. negative a+bx). In these
cases the rates are set to 0. A warning message is given if the number of
such instances is larger than 0.1%. For model 1 and 2, it is possible to
set ‘a=’scaleme'', if this chosen then 'a' will be given the lowest
possible value constrained by a+bx&gt;0.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'simulate_rate'</code>, which is a list
with the following components: </p>

<table>
<tr>
<td style="text-align: left;"> <code>tips</code>
  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> A data frame of x and y values for the tips. </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>percent_negative_roots</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> The percent of iterations
  with negative roots in the rates of y (not given for model =
  'recent_evol'). </td>
</tr>
<tr>
<td style="text-align: left;"> <code>compl_dynamics</code>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> A list with the
  output of the complete dynamics (not given for model = 'recent_evol'). </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Also see the vignette 'Analyzing rates of evolution'.
## Not run: 
# Generating a tree with 50 species
set.seed(102)
tree &lt;- ape::rtree(n = 50)
tree &lt;- ape::chronopl(tree, lambda = 1, age.min = 1)

### model = 'predictor_BM' ###
sim_data &lt;- simulate_rate(tree, startv_x = 0, sigma_x = 0.25, a = 1, b = 1, 
model = "predictor_BM")
head(sim_data$tips)
par(mfrow = c(1, 3))
plot(sim_data)
plot(sim_data, response = "y")
plot(sim_data, response = "x")
par(mfrow = c(1, 1))

### model = 'predictor_gBM' ###
sim_data &lt;- simulate_rate(tree, startv_x = 1, sigma_x = 1, a = 1, b = 0.1, 
model = "predictor_gBM")
head(sim_data$tips)
par(mfrow = c(1, 3))
plot(sim_data)
plot(sim_data, response = "y")
plot(sim_data, response = "x")
par(mfrow = c(1, 1))

### model = 'recent_evol' ###
sim_data &lt;- simulate_rate(tree,
  startv_x = 0, sigma_x = 1, a = 1, b = 1, sigma_y = 1,
  model = "recent_evol"
)
head(sim_data$tips)

## End(Not run)
</code></pre>


</div>