<div class="container">

<table style="width: 100%;"><tr>
<td>STEPR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Stepwise selection of pairwise logratios for generalized linear modelling
</h2>

<h3>Description</h3>

<p>Three different algorithms for selecting pairwise logratios that best explain/predict a response variable, which could be continuous, binary or count
</p>


<h3>Usage</h3>

<pre><code class="language-R">STEPR(data, y, method = NA, family = "gaussian", nsteps = ncol(data)-1, 
      top = 1, previous = NA, criterion = "Bonferroni", alpha = 0.05, 
      previousparts=NA, denom=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame or matrix of compositional data on which the pairwise logratios will be constructed and selected
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>The response variable: a numeric variable for regression (default)), a binary factor for logistic regression or a numeric count for Poisson regression
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The selection method: 1 (unrestricted selection of logratios), 2 (restricted to non-overlapping parts), 3 (additive logratios)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>The distribution used in the generalized linear model family: "gaussian" (default, for multiple regression), "binomial" (for logistic regression of binary response), or "poisson" (for Poisson regression)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps</code></td>
<td>

<p>The maximum number of steps taken, by default one less than the number of parts
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top</code></td>
<td>

<p>When one step is taken (nsteps=1), the ordered list of top logratios with the highest improvements in the likelihood function, for selection based on domain knowledge 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous</code></td>
<td>
	
<p>For specifying variable(s) to be included before stepwise selection takes place; these can be non-compositional variables and/or specific pairwise logratios computed in previous runs of STEPR or by hand; the matrix (or vector for a single variable) of values must be supplied
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>

<p>Criterion for stopping the stepwise selection: "Bonferroni" (default), "AIC", "BIC", or NA for no stopping until maximum specified or permissible logratios entered
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
	
<p>Overall significance level (default is 0.05)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previousparts</code></td>
<td>

<p>(For method 2) The sequence numbers of the logratios, if any, forced in using the previous option
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denom</code></td>
<td>

<p>(For method 3) The sequence number of the part used in denominator; for use when additive logratios are forced in using previous option or to select a set of additive logratios with specific reference from the start
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>STEPR</code> performs stepwise selection of pairwise logratios with the objective of explaining/predicting a response variable, in the framework of generalized linear modelling where the response can be numeric continuous (regression analysis), or a binary factor (logistic regression), or a numeric count (Poisson regression). The corresponding family option has to be indicated if the regression is logistic or Poisson. The different method options for the stepwise selection are <code>method = 1</code> (unrestricted selection of logratios, any logratios can be selected irrespective of the previous ones), <code>method = 2</code> (restricted to non-overlapping parts, each part participates at most in one logratio, so that parts in previously selected logratios are excluded in subsequent steps; logratio effects can be interpreted as under orthogonality), <code>method = 3</code> (additive logratios, only logratios with the same denominator as the first selected logratio are c onsidered; the result is an additive logratio transformation on a subcomposition) Three alternative stopping criteria can be specified, otherwise the procedure executes as many steps as the value of nsteps. These are (in increasing strictness), "AIC", "BIC" and "Bonferroni" (the default).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rationames        </code></td>
<td>
<p>Names of the selected logratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratios       </code></td>
<td>
<p>The sequence numbers of the selected parts in each ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logratios    </code></td>
<td>
<p>Matrix of selected logratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik        </code></td>
<td>
<p>The -2*log-likelihood sequence for the steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance      </code></td>
<td>
<p>The deviance sequence for the steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC    </code></td>
<td>
<p>The AIC sequence for the steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC   </code></td>
<td>
<p>The BIC sequence for the steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bonferroni</code></td>
<td>
<p>The Bonferroni sequence for the steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.deviance       </code></td>
<td>
<p>The null deviance for the regression</p>
</td>
</tr>
</table>
<p>(Notice that for <code>logLik</code>, <code>AIC</code>, <code>BIC</code> and <code>Bonferroni</code>, the values for one more step are given, so that the stopping point can be confirmed.)  <br></p>
<p>And the following if <code>top &gt; 1</code>: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>ratios.top</code></td>
<td>
<p>The top ratios and the sequence numbers of their parts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logratios.top</code></td>
<td>
<p>The matrix of top logratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik.top</code></td>
<td>
<p>The set of top -2*log-likelihoods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance.top</code></td>
<td>
<p>The set of top deviances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC.top</code></td>
<td>
<p>The set of top AICs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC.top</code></td>
<td>
<p>The set of top BICs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bonferroni.top</code></td>
<td>
<p>The set of top Bonferronis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Coenders, G. and Greenacre, M. (2021), Three approaches to supervised learning for compositional data with pairwise logratios. aRxiv preprint. URL:https://arxiv.org/abs/2111.08953 <br>
Coenders, G. and Pawlowsky-Glahn, V. (2020), On interpretations of tests and effect sizes in regression models with a compositional predictor. SORT, 44:201-220 <br>
Greenacre, M. (2021), Compositional data analysis, Annual Review of Statistics and its Application, 8: 271-299
</p>


<h3>See Also</h3>

<p><code>ALR</code>, <code>STEP</code>, <code>glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For the fish morphometric data, first close (normalize, although not necessary) 
# then loop over the 26*25/2 = 325 possible logratios stepwise
data(fish)
habitat &lt;- fish[,2]
morph &lt;- CLOSE(fish[,4:29])
# predict habitat binary classification from morphometric ratios
fish.step1 &lt;- STEPR(morph, as.factor(habitat), method=1, family="binomial")
# [1] "Criterion increases when 3-th ratio enters"
fish.step1$names
# [1] "Bac/Hg" "Hw/Jl"
# perform logistic regression with selected logratios
fish.glm   &lt;- glm(as.factor(habitat) ~ fish.step1$logratios, family="binomial")
summary(fish.glm)
fish.pred1  &lt;- predict(fish.glm)
table(fish.pred1&gt;0.5, habitat)
#     habitat
#        1  2
# FALSE 56 11
# TRUE   3  5
# (Thus 61/75 correct predictions)
#
# force the sex variable in at the first step before selecting logratios
# and using more strict Bonferroni default
sex &lt;- as.factor(fish[,1]) 
fish.step2 &lt;- STEPR(morph, as.factor(habitat), method=1, previous=sex, family="binomial")
# [1] "Criterion increases when 3-th ratio enters"
fish.step2$names
# [1] "Bac/Hg" "Hw/Jl"
# perform logistic regression with sex and selected logratios
fish.glm   &lt;- glm(as.factor(habitat) ~ sex + fish.step2$logratios, family="binomial")
summary(fish.glm)
# (sex not significant)
#
# check the top 10 ratios at Step 1 to allow domain knowledge to operate
fish.step3 &lt;- STEPR(morph, as.factor(habitat), method=1, nsteps=1, top=10, family="binomial")
cbind(fish.step3$ratios.top, fish.step3$BIC.top)
#        row col         
# Bac/Hg   8  19 67.93744
# Bp/Hg    7  19 69.87134
# Jl/Hg    6  19 70.31554
# Jw/Bp    5   7 71.53671
# Jw/Jl    5   6 71.57122
# Jw/Bac   5   8 71.69294
# Fc/Hg   10  19 72.38560
# Hw/Bac   1   8 73.25325
# Jw/Fc    5  10 73.48882
# Hw/Bp    1   7 73.55621
# Suppose 5th in list, Jw/Jl (Jaw width/Jaw length), preferred at the first step
fish.step4 &lt;- STEPR(morph, as.factor(habitat), method=1, 
                    previous=fish.step3$logratios.top[,5], family="binomial")
# [1] "Criterion increases when 2-th ratio enters"
fish.step4$names
# [1] "Bac/Hg"
# So after Jw/Jl forced in only Bac/Hg enters, the best one originally
</code></pre>


</div>