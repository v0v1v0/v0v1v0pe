<div class="container">

<table style="width: 100%;"><tr>
<td>centering distance matrices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Double centering and U-centering </h2>

<h3>Description</h3>

<p>Stand-alone double centering and U-centering functions
that are applied in unbiased distance covariance, bias
corrected distance correlation, and partial distance correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Dcenter(x)
Ucenter(x)
U_center(Dx)
D_center(Dx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> dist object or data matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dx</code></td>
<td>
<p> distance or dissimilarity matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In <code>Dcenter</code> and <code>Ucenter</code>, <code>x</code> must be
a <code>dist</code> object or a data matrix. Both functions return
a doubly centered distance matrix.
</p>
<p>Note that <code>pdcor</code>, etc. functions include the
centering operations (in C), so that these stand alone versions
of centering functions are not needed except in case one
wants to compute just a double-centered or U-centered matrix.
</p>
<p><code>U_center</code> is the Rcpp export of the cpp function.
<code>D_center</code> is the Rcpp export of the cpp function.
</p>


<h3>Value</h3>

<p>All functions return a square symmetric matrix.
</p>
<p><code>Dcenter</code> returns a matrix
</p>
<p style="text-align: center;"><code class="reqn">A_{ij}=a_{ij} - \bar a_{i.} - \bar a_{.j} + \bar a_{..}</code>
</p>

<p>as in classical multidimensional scaling. <code>Ucenter</code>
returns a matrix
</p>
<p style="text-align: center;"><code class="reqn">\tilde A_{ij}=a_{ij} - \frac{a_{i.}}{n-2}
 - \frac{a_{.j}}{n-2} + \frac{a_{..}}{(n-1)(n-2)},\quad i \neq j,</code>
</p>

<p>with zero diagonal,
and this is the double centering applied in <code>pdcov</code> and
<code>pdcor</code> as well as the unbiased dCov and bias corrected
dCor statistics.
</p>


<h3>Note</h3>

<p>The c++ versions <code>D_center</code> and <code>U_center</code> should typically
be faster. R versions are retained for historical reasons.
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Szekely, G.J. and Rizzo, M.L. (2014),
Partial Distance Correlation with Methods for Dissimilarities,
<em>Annals of Statistics</em>, Vol. 42, No. 6, pp. 2382-2412.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> x &lt;- iris[1:10, 1:4]
 dx &lt;- dist(x)
 Dx &lt;- as.matrix(dx)
 M &lt;- U_center(Dx)

 all.equal(M, U_center(M))     #idempotence
 all.equal(M, D_center(M))     #invariance
</code></pre>


</div>