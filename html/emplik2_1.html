<div class="container">

<table style="width: 100%;"><tr>
<td>el2.cen.EMm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes empirical likelihood ratio and p-value for multiple mean-type hypotheses, 
based on two independent samples that may contain censored data.
</h2>

<h3>Description</h3>

<p>This function is similar to <code>el2.cen.EMs</code> but for several mean type restrictions.
This function uses the EM algorithm to calculate a maximized empirical likelihood ratio for a set of <code class="reqn">p</code> 
simultaneous hypotheses
as follows:
</p>
<p style="text-align: center;"><code class="reqn">
H_o:  E(g(x,y)-mean)=0 
</code>
</p>

<p>where <code class="reqn">E</code> indicates expected value; <code class="reqn">g(x,y)</code> is a vector of user-defined functions: <code class="reqn">g_1(x,y), \ldots,
g_p(x,y)</code>; and <code class="reqn">mean</code> is a vector of <code class="reqn">p</code> hypothesized values of <code class="reqn">E(g(x,y))</code>. The two samples <code class="reqn">x</code> and <code class="reqn">y</code>
are assumed independent. They may be uncensored, right-censored, left-censored, or left-and-right (“doubly”) 
censored. A p-value for <code class="reqn">H_o</code> is also calculated, based on the assumption that -2*log(empirical likelihood ratio)
is asymptotically distributed as chisq(df=p). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">el2.cen.EMm(x, dx, wx=rep(1,length(x)), y, dy, wy=rep(1,length(y)), 
            p, H, xc=1:length(x), yc=1:length(y), mean, maxit=35)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of the data for the first sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx</code></td>
<td>
<p>a vector of the censoring indicators for x: 0=right-censored, 
1=uncensored, 2=left-censored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wx</code></td>
<td>
<p>a vector of data case weight for x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of the data for the second sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dy</code></td>
<td>
<p>a vector of the censoring indicators for y: 0=right-censored, 
1=uncensored, 2=left-censored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>a vector of data case weight for y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>a matrix defined as <code class="reqn">H = [H_1, H_2, \ldots, H_p]</code>, where 
<code class="reqn">H_k = [g_k(x_i,y_j)-mu_k], k=1, \ldots, p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xc</code></td>
<td>
<p>a vector containing the indices of the <code>x</code> datapoints, controls if tied x collapse or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yc</code></td>
<td>
<p>a vector containing the indices of the <code>y</code> datapoints, ditto</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the hypothesized value of <code class="reqn">E(g(x,y)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>a positive integer used to control the maximum number of iterations of the EM algorithm; default is 35</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The value of <code class="reqn">mean_k</code> should be chosen between the maximum and minimum values of <code class="reqn">g_k(x_i,y_j)</code>; otherwise
there may be no distributions for <code class="reqn">x</code> and <code class="reqn">y</code> that will satisfy <code class="reqn">H_o</code>.  If <code class="reqn">mean_k</code> is inside 
this interval, but the convergence is still not satisfactory, then the value of <code class="reqn">mean_k</code> should be moved 
closer to the NPMLE for <code class="reqn">E(g_k(x,y))</code>.  (The NPMLE itself should always be a feasible value for <code class="reqn">mean_k</code>.)
</p>


<h3>Value</h3>

<p><code>el2.cen.EMm</code> returns a list of values as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xd1</code></td>
<td>
<p>a vector of unique, uncensored <code class="reqn">x</code>-values in ascending order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yd1</code></td>
<td>
<p>a vector of unique, uncensored <code class="reqn">y</code>-values in ascending order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp3</code></td>
<td>
<p>a list of values returned by the <code>el2.test.wtm</code> function (which is called by <code>el2.cen.EMm</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the hypothesized value of <code class="reqn">E(g(x,y))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPMLE</code></td>
<td>
<p>a non-parametric-maximum-likelihood-estimator vector of <code class="reqn">E(g(x,y))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logel00</code></td>
<td>
<p>the log of the unconstrained empirical likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logel</code></td>
<td>
<p>the log of the constrained empirical likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"-2LLR"</code></td>
<td>
<p>-2*(log-likelihood-ratio) for the <code>p</code> simultaneous hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval</code></td>
<td>
<p>the p-value for the <code>p</code> simultaneous hypotheses, equal to <code>1 - pchisq(-2LLR, df = p)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logvec</code></td>
<td>
<p>the vector of successive values of <code>logel</code> computed by the EM algorithm
(should converge toward a fixed value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_muvec</code></td>
<td>
<p>sum of the probability jumps for the uncensored <code class="reqn">x</code>-values, should be 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_nuvec</code></td>
<td>
<p>sum of the probability jumps for the uncensored <code class="reqn">y</code>-values, should be 1</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>William H. Barton &lt;bbarton@lexmark.com&gt;
</p>


<h3>References</h3>

<p>Barton, W. (2010). Comparison of two samples by a nonparametric likelihood-ratio test.  
PhD dissertation at University of Kentucky.
</p>
<p>Chang, M. and Yang, G. (1987). “Strong Consistency of a Nonparametric Estimator of the Survival Function with Doubly Censored Data.”  <code>Ann. Stat.</code>,15, pp. 1536-1547.
</p>
<p>Dempster, A., Laird, N., and Rubin, D. (1977). “Maximum Likelihood from Incomplete Data via the EM Algorithm.” <code>J. Roy. Statist. Soc.</code>, Series B, 39, pp.1-38.
</p>
<p>Gomez, G., Julia, O., and Utzet, F. (1992). “Survival Analysis for Left-Censored Data.” In Klein, J. and Goel, P. (ed.),
<code>Survival Analysis: State of the Art.</code> Kluwer Academic Publishers, Boston, pp. 269-288.
</p>
<p>Li, G. (1995). “Nonparametric Likelihood Ratio Estimation of Probabilities for Truncated Data.”
<code>J. Amer. Statist. Assoc.</code>, 90, pp. 997-1003.
</p>
<p>Owen, A.B. (2001). <code>Empirical Likelihood</code>. Chapman and Hall/CRC, Boca Raton, pp. 223-227.
</p>
<p>Turnbull, B. (1976). “The Empirical Distribution Function with Arbitrarily Grouped, Censored and Truncated Data.”
<code>J. Roy. Statist. Soc.</code>, Series B, 38, pp. 290-295.
</p>
<p>Zhou, M. (2005). “Empirical likelihood ratio with arbitrarily censored/truncated data by EM algorithm.”
<code>J. Comput. Graph. Stat.</code>, 14, pp. 643-656.
</p>
<p>Zhou, M. (2009) <code>emplik</code> package on CRAN website. 
The function <code>el2.cen.EMm</code> here extends <code>el.cen.EM2</code> 
inside <code>emplik</code> package from one-sample to two-samples.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
x&lt;-c(10, 80, 209, 273, 279, 324, 391, 415, 566, 85, 852, 881, 895, 954, 1101, 1133,
1337, 1393, 1408, 1444, 1513, 1585, 1669, 1823, 1941)
dx&lt;-c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0)
y&lt;-c(21, 38, 39, 51, 77, 185, 240, 289, 524, 610, 612, 677, 798, 881, 899, 946, 1010,
1074, 1147, 1154, 1199, 1269, 1329, 1484, 1493, 1559, 1602, 1684, 1900, 1952)
dy&lt;-c(1,1,1,1,1,1,2,2,1,1,1,1,1,2,1,1,1,1,1,1,0,0,1,1,0,0,1,0,0,0)
nx&lt;-length(x)
ny&lt;-length(y)
xc&lt;-1:nx
yc&lt;-1:ny
wx&lt;-rep(1,nx)
wy&lt;-rep(1,ny)
mu=c(0.5,0.5)
p &lt;- 2
H1&lt;-matrix(NA,nrow=nx,ncol=ny)
H2&lt;-matrix(NA,nrow=nx,ncol=ny)
for (i in 1:nx) {
  for (j in 1:ny) {
   H1[i,j]&lt;-(x[i]&gt;y[j])
   H2[i,j]&lt;-(x[i]&gt;1060) } }
H=matrix(c(H1,H2),nrow=nx,ncol=p*ny)

# Ho1: X is stochastically equal to Y (i.e. P(X&gt;Y)=0.5)
# Ho2: P(X&gt;1060)=0.5 

el2.cen.EMm(x=x, dx=dx, y=y, dy=dy, p=2, H=H, mean=mu)

# Result: Pval is 0.6310234, so we cannot with 95 percent confidence reject the two
# simultaneous hypotheses Ho1 and Ho2
</code></pre>


</div>