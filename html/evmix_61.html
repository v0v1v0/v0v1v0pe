<div class="container">

<table style="width: 100%;"><tr>
<td>mgamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixture of Gammas Distribution</h2>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and
random number generation for the mixture of gammas distribution. The parameters
are the multiple gamma shapes <code>mgshape</code> scales <code>mgscale</code> and weights <code>mgweights</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmgamma(x, mgshape = 1, mgscale = 1, mgweight = NULL, log = FALSE)

pmgamma(q, mgshape = 1, mgscale = 1, mgweight = NULL,
  lower.tail = TRUE)

qmgamma(p, mgshape = 1, mgscale = 1, mgweight = NULL,
  lower.tail = TRUE)

rmgamma(n = 1, mgshape = 1, mgscale = 1, mgweight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgshape</code></td>
<td>
<p>mgamma shape (positive) as list or vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgscale</code></td>
<td>
<p>mgamma scale (positive) as list or vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgweight</code></td>
<td>
<p>mgamma weights (positive) as list or vector (<code>NULL</code> for equi-weighted)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if TRUE then log density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical, if FALSE then upper tail probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>cumulative probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size (positive integer)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Distribution functions for weighted mixture of gammas.
</p>
<p>Suppose there are <code class="reqn">M&gt;=1</code> gamma components in the mixture model. If you 
wish to have a single (scalar) value for each parameter within each of the
<code class="reqn">M</code> components then these can be input as a vector of length <code class="reqn">M</code>. If
you wish to input a vector of values for each parameter within each of the
<code class="reqn">M</code> components, then they are input as a list with each entry the
parameter object for each component (which can either be a scalar or
vector as usual). No matter whether they are input as a vector or list there
must be <code class="reqn">M</code> elements in <code>mgshape</code> and <code>mgscale</code>, one for each
gamma mixture component. Further, any vectors in the list of parameters must
of the same length of the <code>x, q, p</code> or equal to the sample size <code>n</code>, where
relevant.
</p>
<p>If <code>mgweight=NULL</code> then equal weights for each component are assumed. Otherwise, 
<code>mgweight</code> must be a list of the same length as <code>mgshape</code> and 
<code>mgscale</code>, filled with positive values. In the latter case, the weights are rescaled
to sum to unity.
</p>
<p>The gamma is defined on the non-negative reals. Though behaviour at zero depends on
the shape (<code class="reqn">\alpha</code>):
</p>

<ul>
<li> <p><code class="reqn">f(0+)=\infty</code> for <code class="reqn">0&lt;\alpha&lt;1</code>;
</p>
</li>
<li> <p><code class="reqn">f(0+)=1/\beta</code> for <code class="reqn">\alpha=1</code> (exponential);
</p>
</li>
<li> <p><code class="reqn">f(0+)=0</code> for <code class="reqn">\alpha&gt;1</code>;
</p>
</li>
</ul>
<p>where <code class="reqn">\beta</code> is the scale parameter.
</p>


<h3>Value</h3>

<p><code>dmgamma</code> gives the density, 
<code>pmgamma</code> gives the cumulative distribution function,
<code>qmgamma</code> gives the quantile function and 
<code>rmgamma</code> gives a random sample.
</p>


<h3>Acknowledgments</h3>

<p>Thanks to Daniela Laas, University of St Gallen, Switzerland for reporting various bugs in these functions.
</p>


<h3>Note</h3>

<p>All inputs are vectorised except <code>log</code> and <code>lower.tail</code>, and
the gamma mixture parameters can be vectorised within the list. The main
inputs (<code>x</code>, <code>p</code> or <code>q</code>) and parameters must be either a
scalar or a vector. If vectors are provided they must all be of the same
length, and the function will be evaluated for each element of vector. In
the case of <code>rmgamma</code> any input vector must be of
length <code>n</code>. The only exception is when the parameters are single scalar
values, input as vector of length <code class="reqn">M</code>.
</p>
<p>Default values are provided for all inputs, except for the fundamentals 
<code>x</code>, <code>q</code> and <code>p</code>. The default sample size for 
<code>rmgamma</code> is 1.
</p>
<p>Missing (<code>NA</code>) and Not-a-Number (<code>NaN</code>) values in <code>x</code>,
<code>p</code> and <code>q</code> are passed through as is and infinite values are set to
<code>NA</code>. None of these are not permitted for the parameters.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://www.math.canterbury.ac.nz/~c.scarrott/evmix">http://www.math.canterbury.ac.nz/~c.scarrott/evmix</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Gamma_distribution">http://en.wikipedia.org/wiki/Gamma_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Mixture_model">http://en.wikipedia.org/wiki/Mixture_model</a>
</p>
<p>McLachlan, G.J. and Peel, D. (2000). Finite Mixture Models. Wiley.
</p>


<h3>See Also</h3>

<p><code>gammagpd</code>, <code>gpd</code>
and <code>dgamma</code>
</p>
<p>Other mgamma: <code>fmgammagpdcon</code>,
<code>fmgammagpd</code>, <code>fmgamma</code>,
<code>mgammagpdcon</code>, <code>mgammagpd</code>
</p>
<p>Other mgammagpd: <code>fgammagpd</code>,
<code>fmgammagpdcon</code>, <code>fmgammagpd</code>,
<code>fmgamma</code>, <code>gammagpd</code>,
<code>mgammagpdcon</code>, <code>mgammagpd</code>
</p>
<p>Other mgammagpdcon: <code>fgammagpdcon</code>,
<code>fmgammagpdcon</code>, <code>fmgammagpd</code>,
<code>fmgamma</code>, <code>gammagpdcon</code>,
<code>mgammagpdcon</code>, <code>mgammagpd</code>
</p>
<p>Other fmgamma: <code>fmgamma</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(2, 1))

n = 1000
x = rmgamma(n, mgshape = c(1, 6), mgscale = c(1,2), mgweight = c(1, 2))
xx = seq(-1, 40, 0.01)

hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 40))
lines(xx, dmgamma(xx, mgshape = c(1, 6), mgscale = c(1, 2), mgweight = c(1, 2)))

# By direct simulation
n1 = rbinom(1, n, 1/3) # sample size from population 1
x = c(rgamma(n1, shape = 1, scale = 1), rgamma(n - n1, shape = 6, scale = 2))

hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 40))
lines(xx, dmgamma(xx, mgshape = c(1, 6), mgscale = c(1, 2), mgweight = c(1, 2)))

## End(Not run)

</code></pre>


</div>