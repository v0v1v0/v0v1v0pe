<div class="container">

<table style="width: 100%;"><tr>
<td>cv.emBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>k-folds cross-validation for 'emBayes'</h2>

<h3>Description</h3>

<p>This function performs cross-validation and returns the optimal values of the tuning parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.emBayes(
  y,
  clin = NULL,
  X,
  W = NULL,
  nt = NULL,
  group = NULL,
  quant,
  t0,
  t1,
  k,
  func,
  error = 0.01,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clin</code></td>
<td>
<p>a matrix of clinical factors. It has default value NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of genetic factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a matrix of random factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>
<p>a vector of number of repeated measurements for each subject. They can be same or different.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a vector of group sizes. They can be same or different.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>value of quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>a user-supplied sequence of the spike scale <code class="reqn">s_{0}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>a user-supplied sequence of the slab scale <code class="reqn">s_{1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of folds for cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>methods to perform variable selection. Four choices are available. For non longitudinal analysis: "ssLASSO" and "ssQLASSO". For longitudinal varying-coefficient analysis: "ssVCM" and "ssQVCM".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>cutoff value for determining convergence. The algorithm reaches convergence if the difference in the expected log-likelihood of two iterations is less than the value of error. The default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of iterations that is used in the estimation algorithm. The default value is 200.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When performing cross-validation for emBayes, function cv.emBayes returns two sets of optimal tuning parameters and their corresponding cross-validation error matrices. 
The spike scale parameter <code class="reqn">CL.s0</code> and the slab scale parameter <code class="reqn">CL.s1</code> are obtained based on the quantile check loss. 
The spike scale parameter <code class="reqn">SL.s0</code> and the slab scale parameter <code class="reqn">SL.s1</code> are obtained based on the least squares loss. 
The spike scale parameter <code class="reqn">SIC.s0</code> and the slab scale parameter <code class="reqn">SIC.s1</code> are obtained based on the Schwarz Information Criterion (SIC).
Corresponding error matrices <code class="reqn">CL.CV</code>, <code class="reqn">SL.CV</code> and <code class="reqn">SIC.CV</code> can also be obtained from the output.
</p>
<p>Schwarz Information Criterion has the following form:
</p>
<p style="text-align: center;"><code class="reqn">SIC=\log\sum_{i=1}^nL(y_i-\hat{y_i})+\frac{\log n}{2n}edf</code>
</p>

<p>where <code class="reqn">L(\cdot)</code> is the check loss and <code class="reqn">edf</code> is the number of close to zero residuals <code class="reqn">(\leq 0.001)</code>. For non-robust method “ssLASSO”, one should use least squares loss for tuning selection. For robust method “ssQLASSO”, one can either use quantile check loss or SIC for tuning selection. We suggest using SIC, since it has been extensively utilized for tuning selection in high-dimensional quantile regression, as documented in numerous literature sources.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>CL.s0</code></td>
<td>
<p>the optimal spike scale under check loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CL.s1</code></td>
<td>
<p>the optimal slab scale under check loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SL.s0</code></td>
<td>
<p>the optimal slab scale under least squares loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SL.s1</code></td>
<td>
<p>the optimal slab scale under least squares loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIC.s0</code></td>
<td>
<p>the optimal slab scale under SIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIC.s1</code></td>
<td>
<p>the optimal slab scale under SIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CL.CV</code></td>
<td>
<p>cross-validation error matrix under check loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SL.CV</code></td>
<td>
<p>cross-validation error matrix under least squares loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIC.CV</code></td>
<td>
<p>cross-validation error matrix under SIC.</p>
</td>
</tr>
</table>
</div>