<div class="container">

<table style="width: 100%;"><tr>
<td>estimRmcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the reproduction number with Laplacian-P-splines via MCMC</h2>

<h3>Description</h3>

<p>This routine estimates the instantaneous reproduction number <code class="reqn">R_t</code>;
the mean number of secondary infections generated by an infected individual
at time <code class="reqn">t</code> (White et al. 2020); by using Bayesian P-splines and Laplace
approximations (Gressani et al. 2022). The inference approach is fully
stochastic with a Metropolis-adjusted Langevin algorithm. The
<code>estimRmcmc()</code> routine estimates <code class="reqn">R_t</code> based on a time series of
incidence counts and a (discretized) serial interval distribution. The
negative binomial distribution is used to model incidence count data and
P-splines (Eilers and Marx, 1996) are used to smooth the epidemic curve.
The link between the epidemic curve and the reproduction number is
established via the renewal equation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimRmcmc(incidence, si, K = 30, dates = NULL, niter = 5000, burnin = 2000,
 CoriR = FALSE, WTR = FALSE, priors = Rmodelpriors(), progressbar = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>incidence</code></td>
<td>
<p>A vector containing the incidence time series. If
<code>incidence</code> contains NA values at certain time points, these are
replaced by the average of the left- and right neighbor counts. If the
right neighbor is NA, the left neighbor is used as a replacement value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si</code></td>
<td>
<p>The (discrete) serial interval distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of B-splines in the basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>A vector of dates in format "YYYY-MM-DD" (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>The number of MCMC samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The burn-in size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CoriR</code></td>
<td>
<p>Should the <code class="reqn">R_t</code> estimate of Cori (2013) be also computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WTR</code></td>
<td>
<p>Should the <code class="reqn">R_t</code> estimate of Wallinga-Teunis (2004) be
also computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>A list containing the prior specification of the model
hyperparameters as set in Rmodelpriors. See ?Rmodelpriors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>Should a progression bar indicating status of MCMC
algorithm be shown? Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li>
<p> incidence: The incidence time series.
</p>
</li>
<li>
<p> si: The serial interval distribution.
</p>
</li>
<li>
<p> RLPS: A data frame containing estimates of the reproduction number
obtained with the Laplacian-P-splines methodology.
</p>
</li>
<li>
<p> thetahat: The estimated vector of B-spline coefficients.
</p>
</li>
<li>
<p> Sighat: The estimated variance-covariance matrix of the Laplace
approximation to the conditional posterior distribution of
the B-spline coefficients.
</p>
</li>
<li>
<p> RCori: A data frame containing the estimates of the reproduction
obtained with the method of Cori (2013).
</p>
</li>
<li>
<p> RWT: A data frame containing the estimates of the reproduction
obtained with the method of Wallinga-Teunis (2004).
</p>
</li>
<li>
<p> LPS_elapsed: The routine real elapsed time (in seconds) when estimation
of the reproduction number is carried out with Laplacian-P-splines.
</p>
</li>
<li>
<p> penparam: The estimated penalty parameter related to the P-spline model.
</p>
</li>
<li>
<p> K: The number of B-splines used in the basis.
</p>
</li>
<li>
<p> NegBinoverdisp: The estimated overdispersion parameter of the negative
binomial distribution for the incidence time series.
</p>
</li>
<li>
<p> optimconverged: Indicates whether the algorithm to maximize the
posterior distribution of the hyperparameters has converged.
</p>
</li>
<li>
<p> method: The method to estimate the reproduction number with Laplacian-P-splines.
</p>
</li>
<li>
<p> optim_method: The chosen method to to maximize the posterior distribution
of the hyperparameters.
</p>
</li>
<li>
<p> HPD90_Rt: The <code class="reqn">90\%</code> HPD interval for Rt obtained with the LPS methodology.
</p>
</li>
<li>
<p> HPD95_Rt: The <code class="reqn">95\%</code> HPD interval for Rt obtained with the LPS methodology.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>
</p>


<h3>References</h3>

<p>Gressani, O., Wallinga, J., Althaus, C. L., Hens, N. and Faes, C.
(2022). EpiLPS: A fast and flexible Bayesian tool for estimation of the
time-varying reproduction number. <em>Plos Computational Biology</em>,
<strong>18(10): e1010618</strong>.
</p>
<p>Cori, A., Ferguson, N.M., Fraser, C., Cauchemez, S. (2013). A new
framework and software to estimate time-varying reproduction numbers during
epidemics. <em>American Journal of Epidemiology</em>, <strong>178</strong>(9):1505â€“1512.
</p>
<p>Wallinga, J., &amp; Teunis, P. (2004). Different epidemic curves for
severe acute respiratory syndrome reveal similar impacts of control measures.
<em>American Journal of Epidemiology</em>, <strong>160</strong>(6), 509-516.
</p>
<p>White, L.F., Moser, C.B., Thompson, R.N., Pagano, M. (2021).
Statistical estimation of the reproductive number from case notification
data. <em>American Journal of Epidemiology</em>, <strong>190</strong>(4):611-620.
</p>
<p>Eilers, P.H.C. and Marx, B.D. (1996). Flexible smoothing
with B-splines and penalties. <em>Statistical Science</em>,
<strong>11</strong>(2):89-121.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Illustration on the 2009 influenza pandemic in Pennsylvania.
data(influenza2009)
epifit_flu &lt;- estimRmcmc(incidence = influenza2009$incidence, dates = influenza2009$dates,
                         si = influenza2009$si[-1], niter = 2500,
                         burnin = 1500, progressbar = FALSE)
tail(epifit_flu$RLPS)
summary(epifit_flu)
plot(epifit_flu)

</code></pre>


</div>