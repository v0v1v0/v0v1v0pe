<div class="container">

<table style="width: 100%;"><tr>
<td>qda_ews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quick Detection Analysis for Generic Early Warning Signals</h2>

<h3>Description</h3>

<p>Estimate autocorrelation, variance within rolling windows along a timeseries, test the significance of their trends, and reconstruct the potential landscape of the timeseries.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qda_ews(
  timeseries,
  param = NULL,
  winsize = 50,
  detrending = c("no", "gaussian", "linear", "first-diff"),
  bandwidth = NULL,
  boots = 100,
  s_level = 0.05,
  cutoff = 0.05,
  detection.threshold = 0.002,
  grid.size = 50,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>values corresponding to observations in timeseries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winsize</code></td>
<td>
<p>is the size of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 50%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered prior to analysis. There are four options: <code>gaussian</code> filtering, <code>linear</code> detrending and <code>first-differencing</code>. Default is <code>no</code> detrending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>is the bandwidth used for the Gaussian kernel when gaussian filtering is applied. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Alternatively it can be given by the bandwidth selector <code>bw.nrd0</code> (Default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boots</code></td>
<td>
<p>the number of surrogate data to generate from fitting an ARMA(p,q) model. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_level</code></td>
<td>
<p>significance level. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the cutoff value to visualize the potential landscape</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detection.threshold</code></td>
<td>
<p>detection threshold for potential minima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.size</code></td>
<td>
<p>grid size (for potential analysis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>qda_ews produces three plots. The first plot contains the original data, the detrending/filtering applied and the residuals (if selected), autocorrelation and variance. For each statistic trends are estimated by the nonparametric Kendall tau correlation.  The second plot, returns a histogram of the distributions of the Kendall trend statistic for autocorrelation and variance estimated on the surrogated data. Vertical lines represent the level of significance, whereas the black dots the actual trend found in the time series. The third plot is the reconstructed potential landscape in 2D. In addition, the function returns a list containing the output from the respective functions generic_RShiny (indicators); surrogates_RShiny (trends); movpotential_ews (potential analysis)
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos, Leo Lahti, March 1, 2013 <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>See Also</h3>

<p><code>generic_ews</code>; <code>ddjnonparam_ews</code>; <code>bdstest_ews</code>; <code>sensitivity_ews</code>; <code>surrogates_ews</code>; <code>ch_ews</code>; <code>movpotential_ews</code>; <code>livpotential_ews</code>;
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(foldbif)
out &lt;- qda_ews(foldbif, param = NULL, winsize = 50, 
      	          detrending='gaussian', bandwidth=NULL, 
	  boots = 10, s_level = 0.05, cutoff=0.05, 
	  detection.threshold = 0.002, grid.size = 50, 
	  logtransform=FALSE, interpolate=FALSE)
</code></pre>


</div>