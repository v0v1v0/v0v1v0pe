<div class="container">

<table style="width: 100%;"><tr>
<td>deltamethod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Delta method functions</h2>

<h3>Description</h3>

<p>Delta-method implementations for Jensen's inequality and prediction uncertainty
</p>


<h3>Usage</h3>

<pre><code class="language-R">deltamethod(fun, z, var = "x", params = NULL, max.order = 2)
deltavar(fun,meanval=NULL,vars,Sigma,verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>Function of one (deltamethod) or more arguments, expressed
in raw form (e.g. a*x/(b+x))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>numeric vector of values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>variable name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>list of variable names: needed if <code>params</code> does not
have names, or if some of the values specified in <code>params</code>
should be treated as constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>list or numeric vector of parameter values to substitute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanval</code></td>
<td>
<p>possibly named vector of mean values of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>numeric vector of variances or variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.order</code></td>
<td>
<p>maximum order of delta method to compute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print details?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>deltamethod()</code> is for computing delta-method approximations of
the mean of a function of data; <code>deltavar()</code> is for estimating
variances of a function based on the mean values and
variance-covariance matrix of the parameters.  If <code>Sigma</code> is a
vector rather than a matrix, the parameters are assumed to be
independently estimated.
</p>


<h3>Value</h3>

<p>For <code>deltavar()</code>, a vector of predicted variances; for
<code>deltamethod()</code> a vector containing the observed value of the
function average, the function applied to the average, and a series of
delta-method approximations
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>References</h3>

<p>Lyons (1991), "A practical guide to data analysis for
physical science students", Cambridge University Press</p>


<h3>Examples</h3>

<pre><code class="language-R">deltamethod(a*x/(b+x),runif(50),params=list(a=1,b=1),max.order=9)
deltavar(scale*gamma(1+1/shape),meanval=c(scale=0.8,shape=12),
   Sigma=matrix(c(0.015,0.125,0.125,8.97),nrow=2))
## more complex deltavar example
xvec = seq(-4,4,length=101)
x1 = xvec
x2 = xvec
v = matrix(0.2,nrow=3,ncol=3)
diag(v) = 1
m = c(b0=1,b1=1.5,b2=1)
v3  = deltavar(1/(1+exp(-(b0+b1*x1+b2*x2))),meanval=m,Sigma=v)
plot(xvec,v3)
</code></pre>


</div>