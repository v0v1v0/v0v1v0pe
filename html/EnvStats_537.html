<div class="container">

<table style="width: 100%;"><tr>
<td>stat_mean_sd_text</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add Text Indicating the Mean and Standard Deviation to a ggplot2 Plot 
</h2>

<h3>Description</h3>

<p>For a strip plot or scatterplot produced using the package ggplot2
(e.g., with <code>geom_point</code>), 
for each value on the <code class="reqn">x</code>-axis, add text indicating the mean and 
standard deviation of the <code class="reqn">y</code>-values for that particular <code class="reqn">x</code>-value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  stat_mean_sd_text(mapping = NULL, data = NULL, 
    geom = ifelse(text.box, "label", "text"), 
    position = "identity", na.rm = FALSE, show.legend = NA, 
    inherit.aes = TRUE, y.pos = NULL, y.expand.factor = 0.2, 
    digits = 1, digit.type = "round", 
    nsmall = ifelse(digit.type == "round", digits, 0), text.box = FALSE, 
    alpha = 1, angle = 0, color = "black", family = "", fontface = "plain", 
    hjust = 0.5, label.padding = ggplot2::unit(0.25, "lines"), 
    label.r = ggplot2::unit(0.15, "lines"), label.size = 0.25, 
    lineheight = 1.2, size = 4, vjust = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapping, data, position, na.rm, show.legend, inherit.aes</code></td>
<td>

<p>See the help file for <code>geom_text</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom</code></td>
<td>

<p>Character string indicating which <code>geom</code> to use to display the text.   
Setting <code>geom="text"</code> will use <code>geom_text</code> to display the text, and 
setting <code>geom="label"</code> will use <code>geom_label</code> to display the text.  
The default value is <code>geom="text"</code> unless the user sets <code>text.box=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.pos</code></td>
<td>

<p>Numeric scalar indicating the <code class="reqn">y</code>-position of the text (i.e., the value of the 
argument <code>y</code> that will be used in the call to <code>geom_text</code> or 
<code>geom_label</code>).  The default value is <code>y.pos=NULL</code>, in which 
case <code>y.pos</code> is set to the maximum value of all <code class="reqn">y</code>-values plus 
a proportion of the range of all <code class="reqn">y</code>-values, where the proportion is 
determined by the argument <code>y.expand.factor</code> (see below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.expand.factor</code></td>
<td>

<p>For the case when <code>y.pos=NULL</code>, a numeric scalar indicating the proportion 
by which the range of all <code class="reqn">y</code>-values should be multiplied by before adding 
this value to the maximum value of all <code class="reqn">y</code>-values in order to compute the 
value of the argument <code>y.pos</code> (see above).  
The default value is <code>y.expand.factor=0.2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>Integer indicating the number of digits to use for displaying the 
mean and standard deviation.  When <code>digit.type="round"</code> (see below) 
the argument <code>digits</code> indicates the number of digits to round to, and when 
<code>digit.type="signif"</code> the argument <code>digits</code> indicates the number of 
significant digits to display.  The default value is <code>digits=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digit.type</code></td>
<td>

<p>Character string indicating whether the <code>digits</code> argument (see above) refers to significant
digits (<code>digit.type="signif"</code>), or how many decimal places to round to 
(<code>digit.type="round"</code>, the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsmall</code></td>
<td>

<p>Integer passed to the function <code>format</code> indicating the the minimum number of
digits to the right of the decimal point for the computed mean and standard deviation.
The default value is <code>nsmall=digits</code> when <code>digit.type="round"</code> and 
<code>nsmall=0</code> when <code>digit.type="signif"</code>.  When <code>nsmall</code> is greater than 0, 
all computed means and standard deviations will have the same number of digits to the 
right of the decimal point (including, possibly, trailing zeros). To omit trailing zeros, set
<code>nsmall=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.box</code></td>
<td>

<p>Logical scalar indicating whether to surround the text with a text box (i.e., 
whether to use <code>geom_label</code> instead of 
<code>geom_text</code>).  This argument can be overridden by simply 
specifying the argument <code>geom</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, angle, color, family, fontface, hjust, vjust, lineheight, size</code></td>
<td>

<p>See the help file for <code>geom_text</code> and 
the vignette <b>Aesthetic specifications</b> at  
<a href="https://cran.r-project.org/package=ggplot2/vignettes/ggplot2-specs.html">https://cran.r-project.org/package=ggplot2/vignettes/ggplot2-specs.html</a>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.padding, label.r, label.size</code></td>
<td>

<p>See the help file for <code>geom_text</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments passed on to <code>layer</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help file for <code>geom_text</code> for details about how 
<code>geom_text</code> and <code>geom_label</code> work.
</p>
<p>See the vignette <b>Extending ggplot2</b> at  
<a href="https://cran.r-project.org/package=ggplot2/vignettes/extending-ggplot2.html">https://cran.r-project.org/package=ggplot2/vignettes/extending-ggplot2.html</a> 
for information on how to create a new stat.
</p>


<h3>Note</h3>

<p>The function <code>stat_mean_sd_text</code> is called by the function <code>geom_stripchart</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Wickham, H. (2016).  <em>ggplot2:  Elegant Graphics for Data Analysis (Use R!)</em>.  
Second Edition.  Springer. 
</p>


<h3>See Also</h3>

<p><code>geom_stripchart</code>, <code>stat_median_iqr_text</code>, 
<code>stat_n_text</code>, <code>stat_test_text</code>, 
<code>geom_text</code>, <code>geom_label</code>, 
<code>mean</code>, <code>sd</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # First, load and attach the ggplot2 package.
  #--------------------------------------------

  library(ggplot2)

  #====================

  # Example 1:

  # Using the built-in data frame mtcars, 
  # plot miles per gallon vs. number of cylinders
  # using different colors for each level of the number of cylinders.
  #------------------------------------------------------------------

  p &lt;- ggplot(mtcars, aes(x = factor(cyl), y = mpg, color = factor(cyl))) + 
    theme(legend.position = "none")

  p + geom_point() + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")

  # Now add text indicating the mean and standard deviation 
  # for each level of cylinder.
  #--------------------------------------------------------

  dev.new()
  p + geom_point() + 
    stat_mean_sd_text() + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")
  
  #====================

  # Example 2:

  # Repeat Example 1, but:
  # 1) facet by transmission type, 
  # 2) make the size of the text smaller.
  #--------------------------------------

  dev.new()
  p + geom_point() + 
    stat_mean_sd_text(size = 3) + 
    facet_wrap(~ am, labeller = label_both) +  
    labs(x = "Number of Cylinders", y = "Miles per Gallon")
 
  #====================

  # Example 3:

  # Repeat Example 1, but specify the y-position for the text.
  #-----------------------------------------------------------

  dev.new()
  p + geom_point() + 
    stat_mean_sd_text(y.pos = 36) + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")
  
  #====================

  # Example 4:

  # Repeat Example 1, but show the 
  # mean and standard deviation in a text box.
  #-------------------------------------------

  dev.new()
  p + geom_point() + 
    stat_mean_sd_text(text.box = TRUE) + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")

  #====================

  # Example 5:

  # Repeat Example 1, but use the color brown for the text.
  #--------------------------------------------------------
 
  dev.new()
  p + geom_point() + 
    stat_mean_sd_text(color = "brown") + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")

  #====================

  # Example 6:

  # Repeat Example 1, but:
  # 1) use the same colors for the text that are used for each group, 
  # 2) use the bold monospaced font.
  #------------------------------------------------------------------
 
  mat &lt;- ggplot_build(p)$data[[1]]
  group &lt;- mat[, "group"]
  colors &lt;- mat[match(1:max(group), group), "colour"]

  dev.new()
  p + geom_point() + 
    stat_mean_sd_text(color = colors, size = 5, 
      family = "mono", fontface = "bold") + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")

  #====================

  # Clean up
  #---------

  graphics.off()
  rm(p, mat, group, colors)
</code></pre>


</div>