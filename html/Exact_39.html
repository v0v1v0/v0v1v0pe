<div class="container">

<table style="width: 100%;"><tr>
<td>power.paired.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power Calculations for 2x2 Tables with Paired Samples</h2>

<h3>Description</h3>

<p>Calculates the power of the design for known sample size and true probabilities.</p>


<h3>Usage</h3>

<pre><code class="language-R">power.paired.test(p12, p21, N, alternative = c("two.sided", "less", "greater"),
    alpha = 0.05, npNumbers = 100, np.interval = FALSE, beta = 0.001,
    method = c("uam", "ucm", "uamcc", "csm", "cm", "am", "amcc"),
    tsmethod = c("square", "central"),
    simulation = FALSE, nsim = 100,
    delta = 0, convexity = TRUE, useStoredCSM = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p12</code></td>
<td>
<p>The probability of success in first group and failure in second group.  This is the probability of the discordant pair x12</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p21</code></td>
<td>
<p>The probability of failure in first group and success in second group.  This is the probability of the discordant pair x21</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The total sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Indicates the alternative hypothesis: must be either "two.sided", "less", or "greater"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npNumbers</code></td>
<td>
<p>Number: The number of nuisance parameters considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np.interval</code></td>
<td>
<p>Logical: Indicates if a confidence interval on the nuisance parameter should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Number: Confidence level for constructing the interval of nuisance parameters considered.  Only used if np.interval=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Indicates the method for finding the more extreme tables:
must be either "UAM", "UCM", "UAMCC", "CSM", "CM", "AM", or "AMCC"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsmethod</code></td>
<td>
<p>A character string describing the method to implement two-sided tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation</code></td>
<td>
<p>Logical: Indicates if the power calculation is exact or estimated by simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations run.  Only used if simulation=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Number: null hypothesis of the difference in proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convexity</code></td>
<td>
<p>Logical: assumes convexity for interval approach.  Only used if np.interval=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useStoredCSM</code></td>
<td>
<p>Logical: uses stored CSM ordering matrix.  Only used if method="csm"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power calculations are for paired samples.  All possible tables can be represented by an (N+1) x (N+1) matrix.  There are two ways to calculate the power: simulate the tables under a trinomial distribution or determine the rejection region for all possible tables and calculate the exact power.  The power calculations can be determined for any unconditional exact test in <code>paired.exact.test</code>, the Conditional McNemar's (CM) exact test, the Asymptotic McNemar's (AM) test, or Asymptotic McNemar's test with Continuity Correction (AMCC) (note: asymptotic tests are not exact tests).  The power calculations utilize the convexity property, which greatly speeds up computation time (see <code>paired.reject.region</code> documentation).
</p>


<h3>Value</h3>

<p>A list with class "power.htest" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The total sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p12, p21</code></td>
<td>
<p>The respective discordant probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Power of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string describing the alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Null hypothesis of the difference in proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string describing the method to determine more extreme tables</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>McNemar's asymptotic tests are not exact test and may have inflated type 1 error rates.  These options were added to compute the power efficiently when using asymptotic tests.
</p>


<h3>Author(s)</h3>

<p>Peter Calhoun</p>


<h3>References</h3>

<p>Berger, R.L. and Sidik, K. (2003) Exact unconditional tests for 2 x 2 matched-pairs design. <em>Statistical Methods in Medical Research</em>, <b>12</b>, 91â€“108
</p>


<h3>See Also</h3>

<p><code>paired.reject.region</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Superiority power #
power.paired.test(p12=0.15, p21=0.45, N=40, method="UAM")
## Not run: 
# Ensure that the ExactData R package is available before running the CSM test.
if (requireNamespace("ExactData", quietly = TRUE)) {
power.paired.test(p12=0.15, p21=0.45, N=40, method="CSM")
}

## End(Not run)

# Non-inferiority power #
power.paired.test(p12=0.30, p21=0.30, N=80, method="UAM",
                  alternative="less", delta=0.2)
</code></pre>


</div>