<div class="container">

<table style="width: 100%;"><tr>
<td>hilbertspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hilbert Transform and Instantaneous Frequency</h2>

<h3>Description</h3>

<p>This function calculates the amplitude and instantaneous frequency
using Hilbert transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hilbertspec(xt, tt=NULL, central=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xt</code></td>
<td>
<p>matrix of multiple signals. Each column represents a signal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>observation index or time index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>central</code></td>
<td>
<p>If central=TRUE, use central difference method to calculate the instantaneous frequency</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the amplitude and instantaneous frequency
using Hilbert transform.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amplitude</code></td>
<td>
<p>matrix of amplitudes for multiple signals <code>xt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instantfreq</code></td>
<td>
<p>matrix of instantaneous frequencies for multiple signals <code>xt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>energy</code></td>
<td>
<p>cumulative energy of multiple signals</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Huang, N. E., Shen, Z., Long, S. R., Wu, M. L. Shih, H. H.,
Zheng, Q., Yen, N. C., Tung, C. C. and Liu, H. H. (1998) The empirical
mode decomposition and Hilbert spectrum for nonlinear and
nonstationary time series analysis. <em>Proceedings of the Royal
Society London A</em>, <b>454</b>, 903–995.
</p>
<p>Dasios, A., Astin, T. R. and McCann C. (2001) Compressional-wave Q estimation
from full-waveform sonic data. <em>Geophysical Prospecting</em>, <b>49</b>, 353–373. 
</p>


<h3>See Also</h3>

<p><code>spectrogram</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">tt &lt;- seq(0, 0.1, length = 2001)[1:2000]           
f1 &lt;- 1776; f2 &lt;- 1000
xt &lt;- sin(2*pi*f1*tt) * (tt &lt;= 0.033 | tt &gt;= 0.067) + sin(2*pi*f2*tt)
 
### Before treating intermittence
interm1 &lt;- emd(xt, tt, boundary="wave", max.imf=2, plot.imf=FALSE)  
### After treating intermittence
interm2 &lt;- emd(xt, tt, boundary="wave", max.imf=2, plot.imf=FALSE, 
interm=0.0007)

par(mfrow=c(2,1), mar=c(2,2,2,1))
test1 &lt;- hilbertspec(interm1$imf)
spectrogram(test1$amplitude[,1], test1$instantfreq[,1])

test2 &lt;- hilbertspec(interm2$imf, tt=tt)
spectrogram(test2$amplitude[,1], test2$instantfreq[,1])
</code></pre>


</div>