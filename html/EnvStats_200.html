<div class="container">

<table style="width: 100%;"><tr>
<td>epoisCensored</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Mean of a Poisson Distribution Based on Type I Censored Data
</h2>

<h3>Description</h3>

<p>Estimate the mean of a Poisson distribution given a
sample of data that has been subjected to Type I censoring, and optionally
construct a confidence interval for the mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  epoisCensored(x, censored, method = "mle", censoring.side = "left",
    ci = FALSE, ci.method = "profile.likelihood", ci.type = "two-sided",
    conf.level = 0.95, n.bootstraps = 1000, pivot.statistic = "z",
    ci.sample.size = sum(!censored))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censored</code></td>
<td>

<p>numeric or logical vector indicating which values of <code>x</code> are censored.
This must be the same length as <code>x</code>.  If the mode of <code>censored</code> is
<code>"logical"</code>, <code>TRUE</code> values correspond to elements of <code>x</code> that
are censored, and <code>FALSE</code> values correspond to elements of <code>x</code> that
are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to
<code>TRUE</code> and <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>)
values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimation.  The possible values are:
<code>"mle"</code> (maximum likelihood; the default), and
<code>"half.cen.level"</code> (moment estimation based on setting the censored
observations to half the censoring level).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring.side</code></td>
<td>

<p>character string indicating on which side the censoring occurs.  The possible
values are <code>"left"</code> (the default) and <code>"right"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>logical scalar indicating whether to compute a confidence interval for the
mean or variance.  The default value is <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>character string indicating what method to use to construct the confidence interval
for the mean.  The possible values are <code>"profile.likelihood"</code>
(profile likelihood; the default),
<code>"normal.approx"</code> (normal approximation),
and
<code>"bootstrap"</code> (based on bootstrapping).
See the DETAILS section for more information.
This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>

<p>character string indicating what kind of confidence interval to compute.  The
possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
<code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
The default value is <code>conf.level=0.95</code>. This argument is ignored if
<code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bootstraps</code></td>
<td>

<p>numeric scalar indicating how many bootstraps to use to construct the
confidence interval for the mean when <code>ci.type="bootstrap"</code>.  This
argument is ignored if <code>ci=FALSE</code> and/or <code>ci.method</code> does not
equal <code>"bootstrap"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivot.statistic</code></td>
<td>

<p>character string indicating which pivot statistic to use in the construction
of the confidence interval for the mean when <code>ci.method="normal.approx"</code>
(see the DETAILS section).  The possible
values are <code>pivot.statistic="z"</code> (the default) and <code>pivot.statistic="t"</code>.
When <code>pivot.statistic="t"</code> you may supply the argument
<code>ci.sample size</code> (see below).  The argument <code>pivot.statistic</code> is
ignored if <code>ci=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.sample.size</code></td>
<td>

<p>numeric scalar indicating what sample size to assume to construct the
confidence interval for the mean if <code>pivot.statistic="t"</code> and
<code>ci.method="normal.approx"</code>.  The default value is the number of
uncensored observations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> or <code>censored</code> contain any missing (<code>NA</code>), undefined (<code>NaN</code>) or
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to
performing the estimation.
</p>
<p>Let <code class="reqn">\underline{x}</code> denote a vector of <code class="reqn">N</code> observations from a
Poisson distribution with mean
<code>lambda=</code><code class="reqn">\lambda</code>.
</p>
<p>Assume <code class="reqn">n</code> (<code class="reqn">0 &lt; n &lt; N</code>) of these
observations are known and <code class="reqn">c</code> (<code class="reqn">c=N-n</code>) of these observations are
all censored below (left-censored) or all censored above (right-censored) at
<code class="reqn">k</code> fixed censoring levels
</p>
<p style="text-align: center;"><code class="reqn">T_1, T_2, \ldots, T_k; \; k \ge 1 \;\;\;\;\;\; (1)</code>
</p>

<p>For the case when <code class="reqn">k \ge 2</code>, the data are said to be Type I
<b><em>multiply censored</em></b>.  For the case when <code class="reqn">k=1</code>,
set <code class="reqn">T = T_1</code>.  If the data are left-censored
and all <code class="reqn">n</code> known observations are greater
than or equal to <code class="reqn">T</code>, or if the data are right-censored and all <code class="reqn">n</code>
known observations are less than or equal to <code class="reqn">T</code>, then the data are
said to be Type I <b><em>singly censored</em></b> (Nelson, 1982, p.7), otherwise
they are considered to be Type I multiply censored.
</p>
<p>Let <code class="reqn">c_j</code> denote the number of observations censored below or above censoring
level <code class="reqn">T_j</code> for <code class="reqn">j = 1, 2, \ldots, k</code>, so that
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^k c_j = c \;\;\;\;\;\; (2)</code>
</p>

<p>Let <code class="reqn">x_{(1)}, x_{(2)}, \ldots, x_{(N)}</code> denote the “ordered” observations,
where now “observation” means either the actual observation (for uncensored
observations) or the censoring level (for censored observations).  For
right-censored data, if a censored observation has the same value as an
uncensored one, the uncensored observation should be placed first.
For left-censored data, if a censored observation has the same value as an
uncensored one, the censored observation should be placed first.
</p>
<p>Note that in this case the quantity <code class="reqn">x_{(i)}</code> does not necessarily represent
the <code class="reqn">i</code>'th “largest” observation from the (unknown) complete sample.
</p>
<p>Finally, let <code class="reqn">\Omega</code> (omega) denote the set of <code class="reqn">n</code> subscripts in the
“ordered” sample that correspond to uncensored observations.
<br></p>
<p><b>Estimation</b> <br></p>
<p><em>Maximum Likelihood Estimation</em> (<code>method="mle"</code>) <br>
For Type I left censored data, the likelihood function is given by:
</p>
<p style="text-align: center;"><code class="reqn">L(\lambda | \underline{x}) = {N \choose c_1 c_2 \ldots c_k n} \prod_{j=1}^k [F(T_j)]^{c_j} \prod_{i \in \Omega} f[x_{(i)}] \;\;\;\;\;\; (3)</code>
</p>

<p>where <code class="reqn">f</code> and <code class="reqn">F</code> denote the probability density function (pdf) and
cumulative distribution function (cdf) of the population
(Cohen, 1963; Cohen, 1991, pp.6, 50).  That is,
</p>
<p style="text-align: center;"><code class="reqn">f(t) =  \frac{e^{-\lambda} \lambda^t}{t!}, \; x = 0, 1, 2, \ldots \;\;\;\;\;\; (4)</code>
</p>

<p style="text-align: center;"><code class="reqn">F(t) = \sum_{i=0}^t f(i) = \sum_{i=0}^t \frac{e^{-\lambda} \lambda^i}{i!} \;\;\;\;\;\; (5)</code>
</p>

<p>(Johnson et al., 1992, p.151).  For left singly censored data, equation (3)
simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">L(\lambda | \underline{x}) = {N \choose c} [F(T)]^{c} \prod_{i = c+1}^n f[x_{(i)}] \;\;\;\;\;\; (6)</code>
</p>

<p>Similarly, for Type I right censored data, the likelihood function is given by:
</p>
<p style="text-align: center;"><code class="reqn">L(\lambda | \underline{x}) = {N \choose c_1 c_2 \ldots c_k n} \prod_{j=1}^k [1 - F(T_j)]^{c_j} \prod_{i \in \Omega} f[x_{(i)}] \;\;\;\;\;\; (7)</code>
</p>

<p>and for right singly censored data this simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">L(\lambda | \underline{x}) = {N \choose c} [1 - F(T)]^{c} \prod_{i = 1}^n f[x_{(i)}] \;\;\;\;\;\; (8)</code>
</p>

<p>The maximum likelihood estimators are computed by maximizing the likelihood function.
For right-censored data, taking the derivative of the log-likelihood function
with respect to <code class="reqn">\lambda</code> and setting this to 0 produces the following equation:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \lambda \{1 - \sum_{j=1}^K \frac{c_j}{n} [\frac{f(T_j)}{1-F(T_j)}] \} \;\;\;\;\;\; (9)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum{i \in \Omega} x_i \;\;\;\;\;\; (10)</code>
</p>

<p>Note that the quantity defined in equation (10) is simply the mean of the uncensored observations.
</p>
<p>For left-censored data, taking the derivative of the log-likelihood function with
respect to <code class="reqn">\lambda</code> and setting this to 0 produces the following equation:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \lambda \{1 + \sum_{j=1}^K \frac{c_j}{n} [\frac{f(T_j - 1)}{F(T_j - 1)}] \} \;\;\;\;\;\; (11)</code>
</p>

<p>The function <code>epoisCensored</code> computes the maximum likelihood estimator
of <code class="reqn">\lambda</code> by solving Equation (9) (right-censored data) or
Equation (11) (left-censored data); it uses the sample mean of
the uncensored observations as the initial value.
<br></p>
<p><em>Setting Censored Observations to Half the Censoring Level</em> (<code>method="half.cen.level"</code>) <br>
This method is applicable only to left censored data.
This method involves simply replacing all the censored observations with half their
detection limit, and then computing the mean and standard deviation with the usual
formulas (see <code>epois</code>).
</p>
<p>This method is included only to allow comparison of this method to other methods.
<b><em>Setting left-censored observations to half the censoring level is not
recommended</em></b>.
<br><br></p>
<p><b>Confidence Intervals</b> <br>
This section explains how confidence intervals for the mean <code class="reqn">\lambda</code> are
computed.
<br></p>
<p><em>Likelihood Profile</em> (<code>ci.method="profile.likelihood"</code>) <br>
This method was proposed by Cox (1970, p.88), and Venzon and Moolgavkar (1988)
introduced an efficient method of computation.  This method is also discussed by
Stryhn and Christensen (2003) and Royston (2007).
The idea behind this method is to invert the likelihood-ratio test to obtain a
confidence interval for the mean <code class="reqn">\lambda</code>.  Equation (3) above
shows the form of the likelihood function <code class="reqn">L(\lambda | \underline{x})</code> for
multiply left-censored data, and Equation (7) shows the function for
multiply right-censored data.
</p>
<p>Following Stryhn and Christensen (2003), denote the maximum likelihood estimate
of the mean by <code class="reqn">\lambda^*</code>.  The likelihood
ratio test statistic (<code class="reqn">G^2</code>) of the hypothesis <code class="reqn">H_0: \lambda = \lambda_0</code>
(where <code class="reqn">\lambda_0</code> is a fixed value) equals the drop in <code class="reqn">2 log(L)</code> between the
“full” model and the reduced model with <code class="reqn">\lambda</code> fixed at <code class="reqn">\mu_0</code>, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">G^2 = 2 \{log[L(\lambda^*)] - log[L(\lambda_0)]\} \;\;\;\;\;\; (11)</code>
</p>
<p>.
Under the null hypothesis, the test statistic <code class="reqn">G^2</code> follows a
chi-squared distribution with 1 degree of freedom.
</p>
<p>A two-sided <code class="reqn">(1-\alpha)100\%</code> confidence interval for the mean <code class="reqn">\lambda</code>
consists of all values of <code class="reqn">\lambda_0</code> for which the test is not significant at
level <code class="reqn">alpha</code>:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_0: G^2 \le \chi^2_{1, {1-\alpha}} \;\;\;\;\;\; (12)</code>
</p>

<p>where <code class="reqn">\chi^2_{\nu, p}</code> denotes the <code class="reqn">p</code>'th quantile of the
chi-squared distribution with <code class="reqn">\nu</code> degrees of freedom.
One-sided lower and one-sided upper confidence intervals are computed in a similar
fashion, except that the quantity <code class="reqn">1-\alpha</code> in Equation (12) is replaced with
<code class="reqn">1-2\alpha</code>.
<br></p>
<p><em>Normal Approximation</em> (<code>ci.method="normal.approx"</code>) <br>
This method constructs approximate <code class="reqn">(1-\alpha)100\%</code> confidence intervals for
<code class="reqn">\lambda</code> based on the assumption that the estimator of <code class="reqn">\lambda</code> is
approximately normally distributed.  That is, a two-sided <code class="reqn">(1-\alpha)100\%</code>
confidence interval for <code class="reqn">\lambda</code> is constructed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\lambda} - t_{1-\alpha/2, m-1}\hat{\sigma}_{\hat{\lambda}}, \; \hat{\lambda} + t_{1-\alpha/2, m-1}\hat{\sigma}_{\hat{\lambda}}] \;\;\;\; (13)</code>
</p>

<p>where <code class="reqn">\hat{\lambda}</code> denotes the estimate of <code class="reqn">\lambda</code>,
<code class="reqn">\hat{\sigma}_{\hat{\lambda}}</code> denotes the estimated asymptotic standard
deviation of the estimator of <code class="reqn">\lambda</code>, <code class="reqn">m</code> denotes the assumed sample
size for the confidence interval, and <code class="reqn">t_{p,\nu}</code> denotes the <code class="reqn">p</code>'th
quantile of Student's t-distribuiton with <code class="reqn">\nu</code>
degrees of freedom.  One-sided confidence intervals are computed in a
similar fashion.
</p>
<p>The argument <code>ci.sample.size</code> determines the value of <code class="reqn">m</code> and by
default is equal to the number of uncensored observations.
This is simply an ad-hoc method of constructing
confidence intervals and is not based on any published theoretical results.
</p>
<p>When <code>pivot.statistic="z"</code>, the <code class="reqn">p</code>'th quantile from the
standard normal distribution is used in place of the
<code class="reqn">p</code>'th quantile from Student's t-distribution.
</p>
<p>When <code class="reqn">\lambda</code> is estimated with the maximum likelihood estimator
(<code>method="mle"</code>), the variance of <code class="reqn">\hat{\lambda}</code> is
estimated based on the inverse of the Fisher Information matrix.  When
<code class="reqn">\lambda</code> is estimated using the half-censoring-level method
(<code>method="half.cen.level"</code>), the variance of <code class="reqn">\hat{\lambda}</code> is
estimated as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}^2_{\hat{\lambda}} = \frac{\hat{\lambda}}{m} \;\;\;\;\;\; (14)</code>
</p>

<p>where <code class="reqn">m</code> denotes the assumed sample size (see above).
<br></p>
<p><em>Bootstrap and Bias-Corrected Bootstrap Approximation</em> (<code>ci.method="bootstrap"</code>) <br>
The bootstrap is a nonparametric method of estimating the distribution
(and associated distribution parameters and quantiles) of a sample statistic,
regardless of the distribution of the population from which the sample was drawn.
The bootstrap was introduced by Efron (1979) and a general reference is
Efron and Tibshirani (1993).
</p>
<p>In the context of deriving an approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval
for the population mean <code class="reqn">\lambda</code>, the bootstrap can be broken down into the
following steps:
</p>

<ol>
<li>
<p> Create a bootstrap sample by taking a random sample of size <code class="reqn">N</code> from
the observations in <code class="reqn">\underline{x}</code>, where sampling is done with
replacement.  Note that because sampling is done with replacement, the same
element of <code class="reqn">\underline{x}</code> can appear more than once in the bootstrap
sample.  Thus, the bootstrap sample will usually not look exactly like the
original sample (e.g., the number of censored observations in the bootstrap
sample will often differ from the number of censored observations in the
original sample).
</p>
</li>
<li>
<p> Estimate <code class="reqn">\lambda</code> based on the bootstrap sample created in Step 1, using
the same method that was used to estimate <code class="reqn">\lambda</code> using the original
observations in <code class="reqn">\underline{x}</code>. Because the bootstrap sample usually
does not match the original sample, the estimate of <code class="reqn">\lambda</code> based on the
bootstrap sample will usually differ from the original estimate based on
<code class="reqn">\underline{x}</code>.
</p>
</li>
<li>
<p> Repeat Steps 1 and 2 <code class="reqn">B</code> times, where <code class="reqn">B</code> is some large number.
For the function <code>epoisCensored</code>, the number of bootstraps <code class="reqn">B</code> is
determined by the argument <code>n.bootstraps</code> (see the section ARGUMENTS above).
The default value of <code>n.bootstraps</code> is <code>1000</code>.
</p>
</li>
<li>
<p> Use the <code class="reqn">B</code> estimated values of <code class="reqn">\lambda</code> to compute the empirical
cumulative distribution function of this estimator of <code class="reqn">\lambda</code> (see
<code>ecdfPlot</code>), and then create a confidence interval for <code class="reqn">\lambda</code>
based on this estimated cdf.
</p>
</li>
</ol>
<p>The two-sided percentile interval (Efron and Tibshirani, 1993, p.170) is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\frac{\alpha}{2}), \; \hat{G}^{-1}(1-\frac{\alpha}{2})] \;\;\;\;\;\; (15)</code>
</p>

<p>where <code class="reqn">\hat{G}(t)</code> denotes the empirical cdf evaluated at <code class="reqn">t</code> and thus
<code class="reqn">\hat{G}^{-1}(p)</code> denotes the <code class="reqn">p</code>'th empirical quantile, that is,
the <code class="reqn">p</code>'th quantile associated with the empirical cdf.  Similarly, a one-sided lower
confidence interval is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\alpha), \; \infty] \;\;\;\;\;\; (16)</code>
</p>

<p>and a one-sided upper confidence interval is computed as:
</p>
<p style="text-align: center;"><code class="reqn">[0, \; \hat{G}^{-1}(1-\alpha)] \;\;\;\;\;\; (17)</code>
</p>

<p>The function <code>epoisCensored</code> calls the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>quantile</code>
to compute the empirical quantiles used in Equations (15)-(17).
</p>
<p>The percentile method bootstrap confidence interval is only first-order
accurate (Efron and Tibshirani, 1993, pp.187-188), meaning that the probability
that the confidence interval will contain the true value of <code class="reqn">\lambda</code> can be
off by <code class="reqn">k/\sqrt{N}</code>, where <code class="reqn">k</code>is some constant.  Efron and Tibshirani
(1993, pp.184-188) proposed a bias-corrected and accelerated interval that is
second-order accurate, meaning that the probability that the confidence interval
will contain the true value of <code class="reqn">\lambda</code> may be off by <code class="reqn">k/N</code> instead of
<code class="reqn">k/\sqrt{N}</code>.  The two-sided bias-corrected and accelerated confidence interval is
computed as:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\alpha_1), \; \hat{G}^{-1}(\alpha_2)] \;\;\;\;\;\; (18)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\alpha_1 = \Phi[\hat{z}_0 + \frac{\hat{z}_0 + z_{\alpha/2}}{1 - \hat{a}(z_0 + z_{\alpha/2})}] \;\;\;\;\;\; (19)</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha_2 = \Phi[\hat{z}_0 + \frac{\hat{z}_0 + z_{1-\alpha/2}}{1 - \hat{a}(z_0 + z_{1-\alpha/2})}] \;\;\;\;\;\; (20)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{z}_0 = \Phi^{-1}[\hat{G}(\hat{\lambda})] \;\;\;\;\;\; (21)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{a} = \frac{\sum_{i=1}^N (\hat{\lambda}_{(\cdot)} - \hat{\lambda}_{(i)})^3}{6[\sum_{i=1}^N (\hat{\lambda}_{(\cdot)} - \hat{\lambda}_{(i)})^2]^{3/2}} \;\;\;\;\;\; (22)</code>
</p>

<p>where the quantity <code class="reqn">\hat{\lambda}_{(i)}</code> denotes the estimate of <code class="reqn">\lambda</code> using
all the values in <code class="reqn">\underline{x}</code> except the <code class="reqn">i</code>'th one, and
</p>
<p style="text-align: center;"><code class="reqn">\hat{\lambda}{(\cdot)} = \frac{1}{N} \sum_{i=1}^N \hat{\lambda_{(i)}} \;\;\;\;\;\; (23)</code>
</p>

<p>A one-sided lower confidence interval is given by:
</p>
<p style="text-align: center;"><code class="reqn">[\hat{G}^{-1}(\alpha_1), \; \infty] \;\;\;\;\;\; (24)</code>
</p>

<p>and a one-sided upper confidence interval is given by:
</p>
<p style="text-align: center;"><code class="reqn">[0, \; \hat{G}^{-1}(\alpha_2)] \;\;\;\;\;\; (25)</code>
</p>

<p>where <code class="reqn">\alpha_1</code> and <code class="reqn">\alpha_2</code> are computed as for a two-sided confidence
interval, except <code class="reqn">\alpha/2</code> is replaced with <code class="reqn">\alpha</code> in Equations (19) and (20).
</p>
<p>The constant <code class="reqn">\hat{z}_0</code> incorporates the bias correction, and the constant
<code class="reqn">\hat{a}</code> is the acceleration constant.  The term “acceleration” refers
to the rate of change of the standard error of the estimate of <code class="reqn">\lambda</code> with
respect to the true value of <code class="reqn">\lambda</code> (Efron and Tibshirani, 1993, p.186).  For a
normal (Gaussian) distribution, the standard error of the estimate of <code class="reqn">\lambda</code>
does not depend on the value of <code class="reqn">\lambda</code>, hence the acceleration constant is not
really necessary.
</p>
<p>When <code>ci.method="bootstrap"</code>, the function <code>epoisCensored</code> computes both
the percentile method and bias-corrected and accelerated method bootstrap confidence
intervals.
</p>


<h3>Value</h3>

<p>a list of class <code>"estimateCensored"</code> containing the estimated parameters
and other information.  See <code>estimateCensored.object</code> for details.
</p>


<h3>Note</h3>

<p>A sample of data contains censored observations if some of the observations are
reported only as being below or above some censoring level.  In environmental
data analysis, Type I left-censored data sets are common, with values being
reported as “less than the detection limit” (e.g., Helsel, 2012).  Data
sets with only one censoring level are called <em>singly censored</em>; data sets with
multiple censoring levels are called <em>multiply</em> or <em>progressively censored</em>.
</p>
<p>Statistical methods for dealing with censored data sets have a long history in the
field of survival analysis and life testing.  More recently, researchers in the
environmental field have proposed alternative methods of computing estimates and
confidence intervals in addition to the classical ones such as maximum likelihood
estimation.  Helsel (2012, Chapter 6) gives an excellent review of past studies
of the properties of various estimators for parameters of a normal or lognormal
distribution based on censored environmental data.
</p>
<p>In practice, it is better to use a confidence interval for the mean or a
joint confidence region for the mean and standard deviation (or coefficient of
variation), rather than rely on a single point-estimate of the mean.
Few studies have been done to evaluate the performance of methods for constructing
confidence intervals for the mean or joint confidence regions for the mean and
coefficient of variation of a Poisson distribution when data are subjected to
single or multiple censoring.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Cohen, A.C. (1991).  <em>Truncated and Censored Samples</em>.  Marcel Dekker,
New York, New York, 312pp.
</p>
<p>Cox, D.R. (1970).  <em>Analysis of Binary Data</em>.  Chapman &amp; Hall, London.  142pp.
</p>
<p>Efron, B. (1979).  Bootstrap Methods: Another Look at the Jackknife.
<em>The Annals of Statistics</em> <b>7</b>, 1–26.
</p>
<p>Efron, B., and R.J. Tibshirani. (1993).  <em>An Introduction to the Bootstrap</em>.
Chapman and Hall, New York, 436pp.
</p>
<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).
<em>Statistical Distributions, Fourth Edition</em>.
John Wiley and Sons, Hoboken, NJ.
</p>
<p>Helsel, D.R. (2012). <em>Statistics for Censored Environmental Data Using Minitab and R,
Second Edition</em>.  John Wiley &amp; Sons, Hoboken, New Jersey.
</p>
<p>Johnson, N. L., S. Kotz, and A. Kemp. (1992).  <em>Univariate Discrete
Distributions, Second Edition</em>.  John Wiley and Sons, New York, Chapter 4.
</p>
<p>Millard, S.P., P. Dixon, and N.K. Neerchal. (2014; in preparation).
<em>Environmental Statistics with R</em>.  CRC Press, Boca Raton, Florida.
</p>
<p>Nelson, W. (1982).  <em>Applied Life Data Analysis</em>.
John Wiley and Sons, New York, 634pp.
</p>
<p>Royston, P. (2007).  Profile Likelihood for Estimation and Confdence Intervals.
<em>The Stata Journal</em> <b>7</b>(3), pp. 376–387.
</p>
<p>Stryhn, H., and J. Christensen. (2003).  <em>Confidence Intervals by the Profile
Likelihood Method, with Applications in Veterinary Epidemiology</em>.  Contributed paper
at ISVEE X (November 2003, Chile).
<a href="https://gilvanguedes.com/wp-content/uploads/2019/05/Profile-Likelihood-CI.pdf">https://gilvanguedes.com/wp-content/uploads/2019/05/Profile-Likelihood-CI.pdf</a>.
</p>
<p>Venzon, D.J., and S.H. Moolgavkar. (1988).  A Method for Computing
Profile-Likelihood-Based Confidence Intervals.  <em>Journal of the Royal
Statistical Society, Series C (Applied Statistics)</em> <b>37</b>(1), pp. 87–94.
</p>


<h3>See Also</h3>

<p>Poisson, <code>epois</code>, <code>estimateCensored.object</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a Poisson distribution with
  # parameter lambda=10, and censor the values less than 10.
  # Then generate 20 more observations from the same distribution
  # and censor the values less than 20.  Then estimate the mean
  # using the maximum likelihood method.
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(300)
  dat.1 &lt;- rpois(20, lambda=10)
  censored.1 &lt;- dat.1 &lt; 10
  dat.1[censored.1] &lt;- 10

  dat.2 &lt;- rpois(20, lambda=10)
  censored.2 &lt;- dat.2 &lt; 20
  dat.2[censored.2] &lt;- 20

  dat &lt;- c(dat.1, dat.2)
  censored &lt;- c(censored.1, censored.2)

  epoisCensored(dat, censored, ci = TRUE)

  #Results of Distribution Parameter Estimation
  #Based on Type I Censored Data
  #--------------------------------------------
  #
  #Assumed Distribution:            Poisson
  #
  #Censoring Side:                  left
  #
  #Censoring Level(s):              10 20
  #
  #Estimated Parameter(s):          lambda = 11.05402
  #
  #Estimation Method:               MLE
  #
  #Data:                            dat
  #
  #Censoring Variable:              censored
  #
  #Sample Size:                     40
  #
  #Percent Censored:                65%
  #
  #Confidence Interval for:         lambda
  #
  #Confidence Interval Method:      Profile Likelihood
  #
  #Confidence Interval Type:        two-sided
  #
  #Confidence Level:                95%
  #
  #Confidence Interval:             LCL =  9.842894
  #                                 UCL = 12.846484

  #----------

  # Clean up
  #---------
  rm(dat.1, censored.1, dat.2, censored.2, dat, censored)
</code></pre>


</div>