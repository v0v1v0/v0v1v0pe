<div class="container">

<table style="width: 100%;"><tr>
<td>plot.boxcoxLm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot Results of Box-Cox Transformations for a Linear Model
</h2>

<h3>Description</h3>

<p>Plot the results of calling the function <code>boxcox</code> when the argument 
<code>x</code> supplied to <code>boxcox</code> is an object of class <code>"lm"</code>.
Three different kinds of plots are available.
</p>
<p>The function <code>plot.boxcoxLm</code> is automatically called by <code>plot</code> 
when given an object of class <br><code>"boxcoxLm"</code>.  The names of other functions 
associated with Box-Cox transformations are listed under Data Transformations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'boxcoxLm'
plot(x, plot.type = "Objective vs. lambda", same.window = TRUE, 
    ask = same.window &amp; plot.type != "Ojective vs. lambda", 
    plot.pos.con = 0.375, estimate.params = FALSE, 
    equal.axes = qq.line.type == "0-1" || estimate.params, add.line = TRUE, 
    qq.line.type = "least squares", duplicate.points.method = "standard", 
    points.col = 1, line.col = 1, line.lwd = par("cex"), line.lty = 1, 
    digits = .Options$digits, cex.main = 1.4 * par("cex"), cex.sub = par("cex"), 
    main = NULL, sub = NULL, xlab = NULL, ylab = NULL, xlim = NULL, 
    ylim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>"boxcoxLm"</code>.  See <code>boxcoxLm.object</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>character string indicating what kind of plot to create.  Only one particular 
plot type will be created, unless <code>plot.type="All"</code>, in which case all plots 
will be created sequentially.  The possible values of <code>plot.type</code> are: <br><code>"Objective vs. lambda"</code> (the default), <br><code>"Q-Q Plots"</code>, <br><code>"Tukey M-D Q-Q Plots"</code>, and <br><code>"All"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.window</code></td>
<td>

<p>logical scalar indicating whether to produce all plots in the same graphics 
window (<code>same.window=TRUE</code>; the default), or to create a new graphics 
window for each separate plot (<code>same.window=FALSE</code>).  The argument is 
relevant only when <code>plot.type</code> produces more than one plot (i.e., when 
<code>plot.type</code> is not equal to <code>"Objective vs. lambda"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>

<p>logical scalar supplied to the function <code>devAskNewPage</code>, indicating 
whether to prompt the user before creating a new plot within a single graphics 
window.  This argument is ignored when <code>plot.type="Objective vs. lambda"</code> 
(since only one plot is produced) or when <code>same.window=FALSE</code>, otherwise  
the default value is <code>ask=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.col</code></td>
<td>

<p>numeric scalar determining the color of the points in the plot.  The default 
value is <code>points.col=1</code>. See the entry for <code>col</code> in the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for 
<code>par</code> for more information.
</p>
</td>
</tr>
</table>
<p><b>The following arguments can be supplied when <code>plot.type="Q-Q Plots"</code>,</b> <br><b><code>plot.type="Tukey M-D Q-Q Plots"</code>, or <code>plot.type="All"</code> 
(supplied to <code>qqPlot</code>):</b> 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>plot.pos.con</code></td>
<td>

<p>numeric scalar between 0 and 1 containing the value of the plotting position 
constant used to construct the Q-Q plots and/or Tukey Mean-Difference Q-Q plots.  
The default value is <code>plot.pos.con=0.375</code>.  See the help files for 
<code>qqPlot</code> for more information and the motivation for this choice.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate.params</code></td>
<td>

<p>logical scalar indicating whether to compute quantiles based on estimating the 
distribution parameters (<code>estimate.params=TRUE</code>) or using the 
distribution parameters for a standard normal distribution (i.e, 
<code>mean=0</code>, <code>sd=1</code>).  The default value is <code>estimate.params=FALSE</code> 
because a standard normal Q-Q plot will yield roughly a straight line if the 
observations are from <em>any</em> normal distribution.  If you specify 
<code>plot.type="Tukey M-D Q-Q Plots"</code>, then you need to set 
<code>estiamte.params=TRUE</code> unless you want to assume the transformed data come 
from a standard normal distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.axes</code></td>
<td>

<p>logical scalar indicating whether to use the same range on the <code class="reqn">x</code>- and 
<code class="reqn">y</code>-axes when <code>plot.type="Q-Q Plots"</code>.  The default value is 
<code>TRUE</code> if <br><code>qq.line.type="0-1"</code> or <code>estimate.params=TRUE</code>, 
otherwise it is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.line</code></td>
<td>

<p>logical scalar indicating whether to add a line to the plot.  If <code>add.line=TRUE</code> 
and <code>plot.type="Q-Q Plots"</code>, a line determined by the value of 
<code>qq.line.type</code> is added to the plot.  If <code>add.line=TRUE</code> and 
<code>plot.type="Tukey M-D Q-Q Plots"</code>, a horizontal line at <code class="reqn">y=0</code> is added to 
the plot.  The default value is <br><code>add.line=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qq.line.type</code></td>
<td>

<p>character string determining what kind of line to add to the plot when <br><code>plot.type="Q-Q Plots"</code>.  Possible values are <code>"least squares"</code> 
(a least squares line; the default), 
<code>"0-1"</code> (a line with intercept 0 and slope 1), 
and <code>"robust"</code> (a line is fit through the first and third quartiles of the 
<code class="reqn">x</code> and <code class="reqn">y</code> data).  This argument is ignored if <br><code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duplicate.points.method</code></td>
<td>

<p>a character string denoting how to plot points with duplicate <code class="reqn">(x,y)</code> values.  
Possible values are <code>"standard"</code> (a single plotting symbol is plotted; 
the default), <code>"jitter"</code> (a separate plotting symbol is plotted for 
each duplicate point, where the plotting symbols cluster around the true value 
of <code class="reqn">x</code> and <code class="reqn">y</code>), and <code>"number"</code> (a single number is plotted at 
<code class="reqn">(x,y)</code> that represents how many duplicate points are at that <code class="reqn">(x,y)</code> 
coordinate).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>

<p>numeric scalar determining the color of the line in the plot.  The default value 
is <code>line.col=1</code>.  See the entry for <code>col</code> in the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for 
<code>par</code> for more information.  This argument is ignored if 
<code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lwd</code></td>
<td>

<p>numeric scalar determining the width of the line in the plot.  The default value 
is <code>line.lwd=par("cex")</code>.  See the entry for <code>lwd</code> in the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for 
<code>par</code> for more information.  This argument is ignored if 
<code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lty</code></td>
<td>

<p>numeric scalar determining the line type (style) of the line in the plot.  
The default value is <code>line.lty=1</code>.  See the entry for <code>lty</code> 
in the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for <code>par</code> for more information.  
This argument is ignored if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>scalar indicating how many significant digits to print for the distribution 
parameters and the value of the objective in the sub-title.  The default 
value is the current setting of <code>options("digits")</code>.
</p>
</td>
</tr>
</table>
<p><b>Graphics parameters:</b>
</p>
<table><tr style="vertical-align: top;">
<td><code>cex.main, cex.sub, main, sub, xlab, ylab, xlim, ylim, ...</code></td>
<td>

<p>graphics parameters; see <code>par</code> for more information.  The 
default value of <code>cex.main</code> is <code>cex.main=1.4 * par("cex")</code>.  
The default value of <code>cex.sub</code> is <br><code>cex.sub=par("cex")</code>.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The function <code>plot.boxcoxLm</code> is a method for the generic function 
<code>plot</code> for the class <code>"boxcoxLm"</code> (see <code>boxcoxLm.object</code>).  
It can be invoked by calling <code>plot</code> and giving it an object of 
class <code>"boxcoxLm"</code> as the first argument, or by calling <code>plot.boxcoxLm</code> 
directly, regardless of the class of the object given as the first argument 
to <code>plot.boxcoxLm</code>.
</p>
<p>Plots associated with Box-Cox transformations are produced on the current graphics 
device.  These can be one or all of the following:
</p>

<ul>
<li>
<p> Objective vs. <code class="reqn">\lambda</code>.
</p>
</li>
<li>
<p> Observed Quantiles vs. Normal Quantiles (Q-Q Plot) for the residuals of 
the linear model based on transformed values of the response variable 
for each of the values of <code class="reqn">\lambda</code>.
</p>
</li>
<li>
<p> Tukey Mean-Difference Q-Q Plots for the residuals of 
the linear model based on transformed values of the response variable 
for each of the values of <code class="reqn">\lambda</code>.
</p>
</li>
</ul>
<p>See the help files for <code>boxcox</code> and <code>qqPlot</code> for more 
information.
</p>


<h3>Value</h3>

<p><code>plot.boxcoxLm</code> invisibly returns the first argument, <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992).  <em>Statistical Models in S</em>.  
Wadsworth &amp; Brooks/Cole. 
</p>


<h3>See Also</h3>

<p><code>qqPlot</code>, <code>boxcox</code>, <code>boxcoxLm.object</code>, 
<code>print.boxcoxLm</code>, Data Transformations, <code>plot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Create an object of class "boxcoxLm", then plot the results.

  # The data frame Environmental.df contains daily measurements of 
  # ozone concentration, wind speed, temperature, and solar radiation
  # in New York City for 153 consecutive days between May 1 and 
  # September 30, 1973.  In this example, we'll model ozone as a 
  # function of temperature.

  # Fit the model with the raw Ozone data
  #--------------------------------------
  ozone.fit &lt;- lm(ozone ~ temperature, data = Environmental.df) 

  boxcox.list &lt;- boxcox(ozone.fit)

  # Plot PPCC vs. lambda based on Q-Q plots of residuals 
  #-----------------------------------------------------
  dev.new()
  plot(boxcox.list) 

  # Look at Q-Q plots of residuals for the various transformation 
  #--------------------------------------------------------------
  plot(boxcox.list, plot.type = "Q-Q Plots", same.window = FALSE)


  # Look at Tukey Mean-Difference Q-Q plots of residuals 
  # for the various transformation 
  #-----------------------------------------------------
  plot(boxcox.list, plot.type = "Tukey M-D Q-Q Plots", same.window = FALSE)

  #==========

  # Clean up
  #---------
  rm(ozone.fit, boxcox.list)
  graphics.off()
</code></pre>


</div>