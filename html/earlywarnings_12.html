<div class="container">

<table style="width: 100%;"><tr>
<td>sensitivity_ews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensitivity Early Warning Signals</h2>

<h3>Description</h3>

<p><code>sensitivity_ews</code> is used to estimate trends in statistical moments for different sizes of rolling windows along a timeseries and the trends are estimated by the nonparametric Kendall tau correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sensitivity_ews(
  timeseries,
  indicator = c("ar1", "sd", "acf1", "sk", "kurt", "cv", "returnrate", "densratio"),
  winsizerange = c(25, 75),
  incrwinsize = 25,
  detrending = c("no", "gaussian", "loess", "linear", "first-diff"),
  bandwidthrange = c(5, 100),
  spanrange = c(5, 100),
  degree = NULL,
  incrbandwidth = 20,
  incrspanrange = 10,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indicator</code></td>
<td>
<p>is the statistic (leading indicator) selected for which the sensitivity analysis is perfomed. Currently, the indicators supported are: ar1 autoregressive coefficient of a first order AR model, sd, standard deviation, acf1 autocorrelation at first lag, sk skewness, kurt kurtosis, cv coeffcient of variation, returnrate, and densratio density ratio of the power spectrum at low frequencies over high frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winsizerange</code></td>
<td>
<p>is the range of the rolling window sizes expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 25% - 75%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incrwinsize</code></td>
<td>
<p>increments the rolling window size (must be numeric between 0 and 100). Default is 25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered. There are three options: gaussian filtering, loess fitting, linear detrending and first-differencing. Default is no detrending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidthrange</code></td>
<td>
<p>is the range of the bandwidth used for the Gaussian kernel when gaussian filtering is selected. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 5% - 100%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spanrange</code></td>
<td>
<p>parameter that controls the degree of smoothing (numeric between 0 and 100). Default is 5% - 100%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of polynomial to be used for when loess fitting is applied, normally 1 or 2 (Default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incrbandwidth</code></td>
<td>
<p>is the size to increment the bandwidth used for the Gaussian kernel when gaussian filtering is applied. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incrspanrange</code></td>
<td>
<p>Span range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In addition, <code>sensitivity_ews</code> returns a plot with the Kendall tau estimates and their p-values for the range of rolling window sizes used, together with a histogram of the distributions of the statistic and its significance. When gaussian filtering is chosen, a contour plot is produced for the Kendall tau estimates and their p-values for the range of both rolling window sizes and bandwidth used. A reverse triangle indicates the combination of the two parameters for which the Kendall tau was the highest
</p>


<h3>Value</h3>

<p><code>sensitivity_ews</code> returns a matrix that contains the Kendall tau rank correlation estimates for the rolling window sizes (rows) and bandwidths (columns), if gaussian filtering is selected.
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2008). 'Slowing down as an early warning signal for abrupt climate change.' <em>Proceedings of the National Academy of Sciences</em> 105(38): 14308-14312 
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(foldbif)
output=sensitivity_ews(foldbif,indicator='sd',detrending='gaussian',
incrwinsize=25,incrbandwidth=20)
</code></pre>


</div>