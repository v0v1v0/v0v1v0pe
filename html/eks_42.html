<div class="container">

<table style="width: 100%;"><tr>
<td>tidyst_kde_balloon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tidy and geospatial kernel density estimates with variable kernels</h2>

<h3>Description</h3>

<p>Tidy and geospatial versions of kernel density estimates with variable kernels for 2-dimensional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tidy_kde_balloon(data, ...)
tidy_kde_sp(data, ...)
st_kde_balloon(x, ...)
st_kde_sp(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame/tibble of data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>sf object with point geometry</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters in <code>ks::kde.balloon</code>, <code>ks::kde.sp</code> functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A variable kernel density estimate is a modification of the standard density estimate where the bandwidth matrix is variable. There are two main types: balloon kernel estimates (<code>*_kde_balloon</code>) where the bandwidth varies with the grid point, and sample point kernel estimates (<code>*_kde_sp</code>) where the bandwidth varies with the data points. For details of the computation of the variable kernel estimates and of the bandwidth selector procedure, see <code>ks::kde.balloon</code>, <code>ks::kde.sp</code>.
</p>


<h3>Value</h3>

<p>The outputs from <code>*_kde_balloon</code>, <code>*_kde_sp</code> have the same structure as the standard kernel density estimate from <code>*_kde</code>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## tidy variable density estimates
library(ggplot2)
data(worldbank, package="ks")
worldbank &lt;- dplyr::as_tibble(worldbank)
wb2 &lt;- na.omit(worldbank[,c("GDP.growth", "inflation")])
xmin &lt;- c(-70,-25); xmax &lt;- c(25,70)

## standard density estimate
t1 &lt;- tidy_kde(wb2, xmin=xmin, xmax=xmax)
## sample point variable density estimate
t2 &lt;- tidy_kde_sp(wb2, xmin=xmin, xmax=xmax)
tt &lt;- c(t1, t2, labels=c("Standard KDE","Sample point KDE"))

## fixed contour levels for all three plots
b &lt;- contour_breaks(tt)
gt &lt;- ggplot(tt, aes(x=GDP.growth, y=inflation)) 
gt + geom_contour_filled_ks(breaks=b, colour=1) + 
    colorspace::scale_fill_discrete_sequential() + facet_wrap(~group)

## balloon variable density estimate
## gridsize=c(21,21) only for illustrative purposes
t3 &lt;- tidy_kde_balloon(wb2, xmin=xmin, xmax=xmax, gridsize=c(21,21))
tt &lt;- c(t1, t2, t3, labels=c("Standard KDE","Sample point KDE","Balloon KDE"))
b &lt;- contour_breaks(tt, cont=seq(10,90,by=10))
gt + geom_contour_filled_ks(data=tt, breaks=b, colour=1) + 
    colorspace::scale_fill_discrete_sequential() + facet_wrap(~group)

## geospatial variable density estimates
data(wa)
data(grevilleasf)
hakeoides &lt;- dplyr::filter(grevilleasf, species=="hakeoides")

## standard density estimate
s1 &lt;- st_kde(hakeoides)
## sample point variable density estimate
s2 &lt;- st_kde_sp(hakeoides)   
s3 &lt;- c(s1, s2, labels=c("Standard KDE","Sample point KDE"))
b &lt;- contour_breaks(s3)
bcols &lt;- colorspace::sequential_hcl(nrow(b), palette="Heat2", rev=TRUE)

## base R plot
xlim &lt;- c(1.2e5, 1.1e6); ylim &lt;- c(6.1e6, 7.2e6)
plot(wa, xlim=xlim, ylim=ylim)
plot(s1, add=TRUE, col=bcols[1:2], breaks=b)
plot(wa, xlim=xlim, ylim=ylim)
plot(s2, add=TRUE, col=bcols, breaks=b)

## geom_sf plot
gs &lt;- ggplot(s3) + geom_sf(data=wa, fill=NA) + ggthemes::theme_map()
gs + geom_sf(data=st_get_contour(s3, breaks=b), aes(fill=contlabel)) + 
    colorspace::scale_fill_discrete_sequential(palette="Heat2") +
    coord_sf(xlim=xlim, ylim=ylim) + facet_wrap(~group)
</code></pre>


</div>