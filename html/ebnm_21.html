<div class="container">

<table style="width: 100%;"><tr>
<td>ebnm_scale_npmle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set scale parameter for NPMLE and deconvolveR prior family</h2>

<h3>Description</h3>

<p>The default method for setting the <code>scale</code> parameter for functions
<code>ebnm_npmle</code> and <code>ebnm_deconvolver</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ebnm_scale_npmle(
  x,
  s,
  min_K = 3,
  max_K = 300,
  KLdiv_target = 1/length(x),
  pointmass = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of observations. Missing observations (<code>NA</code>s) are
not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A vector of standard errors (or a scalar if all are equal).
Standard errors may not be exactly zero, and missing standard errors are
not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_K</code></td>
<td>
<p>The minimum number of components <code class="reqn">K</code> to include in the
mixture of point masses used to approximate the nonparametric family of
all distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_K</code></td>
<td>
<p>The maximum number of components <code class="reqn">K</code> to include in the
approximating mixture of point masses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KLdiv_target</code></td>
<td>
<p>The desired bound <code class="reqn">\kappa</code> on the KL-divergence from
the solution obtained using the approximating mixture to the exact
solution. More precisely, the scale parameter is set such that given
the exact MLE
</p>
<p style="text-align: center;"><code class="reqn">\hat{g} := \mathrm{argmax}_{g \in G} L(g),</code>
</p>

<p>where <code class="reqn">G</code> is the full nonparametric family, and given the MLE for the
approximating family <code class="reqn">\tilde{G}</code>
</p>
<p style="text-align: center;"><code class="reqn">\tilde{g} := \mathrm{argmax}_{g \in \tilde{G}} L(g),</code>
</p>

<p>we have that
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{KL}(\hat{g} \ast N(0, s^2) \mid \tilde{g} \ast N(0, s^2)) \le \kappa,</code>
</p>

<p>where <code class="reqn">\ast \ N(0, s^2)</code> denotes convolution with the normal error
distribution (the derivation of the bound assumes homoskedastic
observations). For details, see <strong>References</strong> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointmass</code></td>
<td>
<p>When the range of the data is so large that <code>max_K</code>
point masses cannot provide a good approximation to the family of all
distributions, then <code>ebnm</code> will instead use a mixture of normal
distributions, with the standard deviation of each component equal to
<code>scale</code><code class="reqn">/ 2</code>. Setting <code>pointmass = FALSE</code> gives the
default <code>scale</code> for this mixture of normal distributions.
</p>
<p>To be exact, <code>ebnm</code> uses a mixture of normal distributions rather than
a mixture of point masses when
</p>
<p style="text-align: center;"><code class="reqn">\frac{\max(x) - \min(x)}{\min(s)} &gt; 3 \ \mathrm{max}_K;</code>
</p>
<p> for a
rationale, see <strong>References</strong> below. Note however that <code>ebnm</code>
only uses a mixture of normal distributions when <code>scale = "estimate"</code>;
if parameter <code>scale</code> is set manually, then a mixture of point masses
will be used in all cases. To use a mixture of normal distributions with
the scale set manually, an object created by the constructor function
<code>normalmix</code> must be provided as argument to parameter
<code>g_init</code> in function <code>ebnm_npmle</code> or function
<code>ebnm_deconvolver</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Jason Willwerscheid (2021).
<em>Empirical Bayes Matrix Factorization: Methods and Applications</em>.
University of Chicago, PhD dissertation.
</p>


</div>