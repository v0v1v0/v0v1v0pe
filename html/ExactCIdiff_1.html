<div class="container">

<table style="width: 100%;"><tr>
<td>Exact one-sided and two-sided 1-alpha confidence interval two independent proportions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inductive confidence intervals for the Difference Between Two Proportions</h2>

<h3>Description</h3>

<p>Three exact confidence intervals (two-sided, smallest lower one-sided and  smallest upper one-sided)  of level 1-alpha are constructed for p1-p2,
the difference of two independent proportions. 
</p>
<p>X follows Binomial(n1,p1), Y follows Binomial(n2,p2) and X and Y are independent. Intervals [L(X,Y),1], [-1,U(X,Y)] and [L(X,Y),U(X,Y)] are of interest. 
</p>
<p>This package can be used to calculate these intervals using an inductive method
developed by Wang (2010).           
</p>


<h3>Usage</h3>

<pre><code class="language-R">BinomCI(n1,n2,x,y,conf.level,CItype,precision,grid.one,grid.two)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>the number of trials in the first group in the parallel two-arm study</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>the number of trials in the second group in the parallel two-arm study</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the number of successes from the first group in the parallel two-arm study</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the number of successes from the second group in the parallel two-arm study</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confience level, 95% is the default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CItype</code></td>
<td>
<p>c("Lower","Upper","Two.sided"), lower one-sided confidence interval [L,1], upper one-sided confidence interval [-1,U], two-sided confidence interval [L,U], "Two.sided" is the default value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>Precision of the confidence interval, default is 0.00001 rounded to 5 decimals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.one</code></td>
<td>
<p>two-step grid search algorithm is used. grid.one is the number of points for searching the global maximum of the tail probability in the first step. 30 is the default value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.two</code></td>
<td>
<p>grid.two is the number of points for searching the global maximum of the tail probability in the second step. 20 is the default value</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An inductive construction is carried out to obtain one-sided interval. At each step we rank sample 
point by its potential confidence interval and then select the one with the
shortest interval. The difference of the two proportions is the parameter of interest.
There is a nuisance parameter in the tail probability 
(Eq (6) in Wang 2010). The nuisance parameter is 
eliminated by the maximization originally proposed by Buehler (1957).
A two-step grid search algorithm is applied to find the maximum. 
The first step is to roughly identify a neighbor area of the global 
maximization of the tail probability,  more points used more accurate results achieved. 
We recommend to use grid.one at least 30 to have accurate confidence intervals. 
The second step is to search for maximum within that smaller neighbor area, and  grid.two should be
at least 20. We find that this two-step grid search algorithm works much more accurate and efficient 
than the traditional one-step grid search algorithm. 1-alpha two-sided interval is equal to the 
intersection of two 1-alpha/2 one-sided intervals.
</p>
<p>Details and more examples see: http://www.wright.edu/~weizhen.wang/software/ExactTwoProp/examples.pdf
</p>


<h3>Value</h3>

<p>BinomCI gives the estimate of (p1-p2), which is x/n1-y/n2, and the exact confidence interval.
</p>


<h3>References</h3>

<p>Wang, W. (2010). On construction of the smallest one-sided confidence interval for the difference of two proportions. The Annals of Statistics, 38, 1227–1243.
</p>
<p>Buehler, R. (1957). Confidence intervals for the porduct of two binomial parameters. JASA, 52, 482–493.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#lower one-sided confidence interval with n1=4,n2=1,x=2,and y=0 in Wang 2010 
BinomCI(4,1,2,0,CItype="Lower")

#Upper one-sided confidence interval with n1=4,n2=1,x=2,and y=0.
BinomCI(4,1,2,0,CItype="Upper")


#Two-sided 90% confidence intervals
BinomCI(5,5,4,2,conf.level=0.9,CItype='Two.sided')

</code></pre>


</div>