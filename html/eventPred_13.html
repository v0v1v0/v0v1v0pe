<div class="container">

<table style="width: 100%;"><tr>
<td>predictEvent</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict event</h2>

<h3>Description</h3>

<p>Utilizes pre-fitted time-to-event and time-to-dropout models
to generate event and dropout times for ongoing subjects
and new subjects. It also provides a
prediction interval for the expected time to reach the target
number of events.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predictEvent(
  df = NULL,
  target_d,
  newSubjects = NULL,
  event_fit = NULL,
  dropout_fit = NULL,
  fixedFollowup = FALSE,
  followupTime = 365,
  pilevel = 0.9,
  nyears = 4,
  nreps = 500,
  showEnrollment = TRUE,
  showEvent = TRUE,
  showDropout = FALSE,
  showOngoing = FALSE,
  showsummary = TRUE,
  showplot = TRUE,
  by_treatment = FALSE,
  covariates_event = NULL,
  event_fit_with_covariates = NULL,
  covariates_dropout = NULL,
  dropout_fit_with_covariates = NULL,
  fix_parameter = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The subject-level enrollment and event data, including
<code>trialsdt</code>, <code>usubjid</code>, <code>randdt</code>, <code>cutoffdt</code>,
<code>time</code>, <code>event</code>, and <code>dropout</code>. The data should also
include <code>treatment</code> coded as 1, 2, and so on, and
<code>treatment_description</code> for by-treatment prediction. By default,
it is set to <code>NULL</code> for event prediction at the design stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_d</code></td>
<td>
<p>The target number of events to reach in the study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newSubjects</code></td>
<td>
<p>The enrollment data for new subjects including
<code>draw</code> and <code>arrivalTime</code>. The data should also include
<code>treatment</code> for prediction by treatment. By default,
it is set to <code>NULL</code>,
indicating the completion of subject enrollment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_fit</code></td>
<td>
<p>The pre-fitted event model used to generate
predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout_fit</code></td>
<td>
<p>The pre-fitted dropout model used to generate
predictions. By default, it is set to <code>NULL</code>,
indicating no dropout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedFollowup</code></td>
<td>
<p>A Boolean variable indicating whether a fixed
follow-up design is used. By default, it is set to <code>FALSE</code>
for a variable follow-up design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followupTime</code></td>
<td>
<p>The follow-up time for a fixed
follow-up design, in days. By default, it is set to 365.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pilevel</code></td>
<td>
<p>The prediction interval level. By default,
it is set to 0.90.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyears</code></td>
<td>
<p>The number of years after the data cut for prediction.
By default, it is set to 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>The number of replications for simulation. By default,
it is set to 500. If <code>newSubjects</code> is not <code>NULL</code>,
the number of draws in <code>newSubjects</code> should be <code>nreps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showEnrollment</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of enrolled subjects. By default, it is set to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showEvent</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of events. By default, it is set to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showDropout</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of dropouts. By default, it is set to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showOngoing</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of ongoing subjects. By default, it is set to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showsummary</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the prediction summary. By default, it is set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showplot</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the prediction plot. By default, it is set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict event by treatment group. By default,
it is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates_event</code></td>
<td>
<p>The names of baseline covariates from the input
data frame to include in the event model, e.g., c("age", "sex").
Factor variables need to be declared in the input data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_fit_with_covariates</code></td>
<td>
<p>The pre-fitted event model with
covariates used to generate event predictions for ongoing subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates_dropout</code></td>
<td>
<p>The names of baseline covariates from the input
data frame to include in the dropout model, e.g., c("age", "sex").
Factor variables need to be declared in the input data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout_fit_with_covariates</code></td>
<td>
<p>The pre-fitted dropout model with
covariates used to generate dropout predictions for ongoing subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_parameter</code></td>
<td>
<p>Whether to fix parameters at the maximum
likelihood estimates when generating new data for prediction.
Defaults to FALSE, in which case, parameters will be drawn from
their approximate posterior distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To ensure successful event prediction at the design stage, it is
important to provide the <code>newSubjects</code> data set.
</p>
<p>To specify the event (dropout) model used during the design-stage event
prediction, the <code>event_fit</code> (<code>dropout_fit</code>) should be a list
with one element per treatment. For each treatment, the element should
include <code>w</code> to specify the weight of the treatment in a
randomization block, <code>model</code> to specify the event model
(exponential, weibull, log-logistic, log-normal, or piecewise
exponential), <code>theta</code> and <code>vtheta</code> to indicate
the parameter values and the covariance matrix. For the piecewise
exponential event (dropout) model, the list should also include
<code>piecewiseSurvivalTime</code> (<code>piecewiseDropoutTime</code>) to indicate
the location of knots. It should be noted that the model averaging
and spline options are not appropriate for use during the design stage.
</p>
<p>Following the commencement of the trial, we obtain the event
model fit and the dropout model fit based on the observed data,
denoted as <code>event_fit</code> and <code>dropout_fit</code>, respectively.
These fitted models are subsequently utilized to generate event
and dropout times for both ongoing and new subjects in the trial.
</p>


<h3>Value</h3>

<p>A list of prediction results which includes important
information such as the median, lower and upper percentiles for
the estimated day and date to reach the target number of events,
as well as simulated event data for both ongoing and new subjects.
The data for the prediction plot is also included
within this list.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Emilia Bagiella and Daniel F. Heitjan. Predicting analysis times in
randomized clinical trials. Stat in Med. 2001; 20:2055-2063.
</p>
<p>Gui-shuang Ying and Daniel F. Heitjan. Weibull prediction of event
times in clinical trials. Pharm Stat. 2008; 7:107-120.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Event prediction after enrollment completion

event_fit &lt;- fitEvent(df = interimData2,
                      event_model = "piecewise exponential",
                      piecewiseSurvivalTime = c(0, 140, 352))

dropout_fit &lt;- fitDropout(df = interimData2,
                          dropout_model = "exponential")

event_pred &lt;- predictEvent(df = interimData2, target_d = 200,
                           event_fit = event_fit$fit,
                           dropout_fit = dropout_fit$fit,
                           pilevel = 0.90, nreps = 100)

</code></pre>


</div>