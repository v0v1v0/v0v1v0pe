<div class="container">

<table style="width: 100%;"><tr>
<td>WARD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Ward clustering of a compositional data matrix
</h2>

<h3>Description</h3>

<p>This function clusters the rows (or the columns, if the matrix is transformed) of a compositional data matrix, using weighted Ward clustering of the logratios.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WARD(LRdata, weight=TRUE, row.wt=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LRdata</code></td>
<td>

<p>Matrix of logratios, either a vector or preferably the logratio object resulting from one of the functions ALR, CLR, PLR or LR  (usually CLRs will be used))
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p><code>TRUE</code> (default) for weighted analysis (in which case weights are in the logratio object), <code>FALSE</code> for unweighted analysis, or a vector of user-defined column weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.wt</code></td>
<td>

<p>Optional set of row weights (default is equal weights when <code>row.wt=NA</code>)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>WARD</code> performs a weighted WARD hierarchical clustering on the rows of an input set of logratios, usually CLR-transformed.
(This would be equivalent to performing the clustering on all pairwise logratios).
If the columns of the logratio matrix are unweighted, specify the option <code>weight=FALSE</code>: they will then get equal weights.
The default <code>weight=TRUE</code> option implies that column weights are provided, either in the input list object LRdata, as <code>LRdata$LR.wt</code>, or as
a vector of user-specified weights using the same <code>weight</code> option.
</p>


<h3>Value</h3>

<p>An object which describes the tree produced by the clustering process on the n objects. The object is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>merge  </code></td>
<td>
<p>an n-1 by 2 matrix. Row i of <code>merge</code> describes the merging of clusters at step i of the clustering. If an element j in the row is negative, then observation -j was merged at this stage. If j is positive then the merge was with the cluster formed at the (earlier) stage j of the algorithm. Thus negative entries in <code>merge</code> indicate agglomerations of singletons, and positive entries indicate agglomerations of non-singletons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height </code></td>
<td>
<p>a set of n-1 real values (non-decreasing for ultrametric trees). The clustering height: that is, the value of the criterion associated with the clustering method for the particular agglomeration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order  </code></td>
<td>
<p>a vector giving the permutation of the original observations suitable for plotting, in the sense that a cluster plot using this ordering and matrix merge will not have crossings of the branches</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Greenacre, M. (2018), Compositional Data Analysis in Practice, Chapman &amp; Hall / CRC. <br></p>


<h3>See Also</h3>

<p><code>hclust</code>, <code>CLR</code>, <code>LR.VAR</code>, <code>CLOSE</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># clustering steps for unweighted and weighted logratios
# for both row- and column-clustering
data(cups)
cups &lt;- CLOSE(cups)

# unweighted logratios: clustering samples
cups.uclr  &lt;- CLR(cups, weight=FALSE)
cups.uward &lt;- WARD(cups.uclr, weight=FALSE)   # weight=FALSE not needed here,
                                              # as equal weights are in object
plot(cups.uward)
# add up the heights of the nodes
sum(cups.uward$height)
# [1] 0.02100676
# check against the total logratio variance
LR.VAR(cups.uclr, weight=FALSE)
# [1] 0.02100676

# unweighted logratios: clustering parts
tcups &lt;- t(cups)
tcups.uclr  &lt;- CLR(tcups, weight=FALSE)
tcups.uward &lt;- WARD(tcups.uclr, weight=FALSE)  # weight=FALSE not needed here,
                                               # as equal weights are in object
plot(tcups.uward, labels=colnames(cups))
sum(tcups.uward$height)
# [1] 0.02100676
LR.VAR(tcups.uclr, weight=FALSE)
# [1] 0.02100676

# weighted logratios: clustering samples
cups.clr &lt;- CLR(cups)
cups.ward &lt;- WARD(cups.clr)
plot(cups.ward)
sum(cups.ward$height)
# [1] 0.002339335
LR.VAR(cups.clr)
# [1] 0.002339335

# weighted logratios: clustering parts
# weight=FALSE is needed here, since we want equal weights
# for the samples (columns of tcups)
tcups.clr  &lt;- CLR(tcups, weight=FALSE)
tcups.ward &lt;- WARD(tcups.clr, row.wt=colMeans(cups))
plot(tcups.ward, labels=colnames(cups))
   sum(tcups.ward$height)
# [1] 0.002339335
LR.VAR(tcups.clr, row.wt=colMeans(cups))
# [1] 0.002339335
</code></pre>


</div>