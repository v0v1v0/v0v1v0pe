<div class="container">

<table style="width: 100%;"><tr>
<td>write.dbi.ffdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write ffdf data to a database table by using a DBI connection.</h2>

<h3>Description</h3>

<p>Write <code>ffdf</code> data to a database table by using a DBI connection.
This can for example be used to store large ffdf datasets from R in
Oracle, SQLite, MySQL, PostgreSQL, Hive or other SQL databases. <br>
Mark that for very large datasets, these SQL databases might have tools to speed up by bulk loading.
You might also consider that as an alternative to using this procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.dbi.ffdf(
  x,
  name,
  dbConnect.args = list(drv = NULL, dbname = NULL, username = "", password = ""),
  RECORDBYTES = sum(.rambytes[vmode(x)]),
  BATCHBYTES = getOption("ffbatchbytes"),
  by = NULL,
  VERBOSE = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the <code>ffdf</code> to write to the database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character string with the name of the table to store the data in. Passed on to <code>dbWriteTable</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbConnect.args</code></td>
<td>
<p>a list of arguments to pass to DBI's <code>dbConnect</code> (like drv, dbname, username, password). See the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RECORDBYTES</code></td>
<td>
<p>optional integer scalar representing the bytes needed to process a single row of the ffdf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BATCHBYTES</code></td>
<td>
<p>integer: bytes allowed for the size of the data.frame storing the result of reading one chunk. 
See documentation in <code>read.table.ffdf</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>integer passed on to <code>chunk</code> indicating to write to the database in chunks of this size. Overwrites
the behaviour of BATCHBYTES and RECORDBYTES.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VERBOSE</code></td>
<td>
<p>logical: TRUE to verbose timings for each processed chunk (default FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional parameters passed on to <code>dbWriteTable</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Opens up the DBI connection using <code>DBI::dbConnect</code>, writes data to the SQL table
using <code>DBI::dbWriteTable</code> by extracting the data in batches from the <code>ffdf</code>
and appending them to the table.
</p>


<h3>Value</h3>

<p>invisible()
</p>


<h3>See Also</h3>

<p><code>dbWriteTable</code>, <code>chunk</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(ff)

##
## Example query using data in sqlite
##
require(RSQLite)
dbfile &lt;- system.file("smalldb.sqlite3", package="ETLUtils")
drv &lt;- dbDriver("SQLite")
query &lt;- "select * from testdata limit 10000"
x &lt;- read.dbi.ffdf(query = query, dbConnect.args = list(drv = drv, dbname = dbfile), 
first.rows = 100, next.rows = 1000, VERBOSE=TRUE)

## copy db in package folder to temp folder as CRAN does not allow writing in package dirs
dbfile &lt;- tempfile(fileext = ".sqlite3")
file.copy(from = system.file("smalldb.sqlite3", package="ETLUtils"), to = dbfile)
Sys.chmod(dbfile, mode = "777")
write.dbi.ffdf(x = x, name = "helloworld", row.names = FALSE, overwrite = TRUE,
  dbConnect.args = list(drv = drv, dbname = dbfile), 
  by = 1000, VERBOSE=TRUE)
test &lt;- read.dbi.ffdf(query = "select * from helloworld", 
  dbConnect.args = list(drv = drv, dbname = dbfile))

## clean up for CRAN
file.remove(dbfile)
## Not run: 
require(ROracle)
write.dbi.ffdf(x = x, name = "hellooracle", row.names = FALSE, overwrite = TRUE,
  dbConnect.args = list(drv = dbDriver("Oracle"), 
                        user = "YourUser", password = "YourPassword", dbname = "Mydatabase"), 
  VERBOSE=TRUE)

## End(Not run)
</code></pre>


</div>