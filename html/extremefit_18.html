<div class="container">

<table style="width: 100%;"><tr>
<td>goftest.hill.ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness of fit test statistics for time series</h2>

<h3>Description</h3>

<p>Give the results of the goodness of fit test for testing the null hypothesis that the tail is fitted by a Pareto distribution starting from the adaptive threshold (for more details see pages 447 and 448 of Durrieu et al. (2015)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'hill.ts'
goftest(object, X, t, plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>output of the hill.ts function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a vector of the observed values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a vector of time covariates which should have the same length as X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If <code>TRUE</code>, the test statistic are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TS.window</code></td>
<td>
<p>the maximum value of test statistics inside the window for each t in Tgrid (see help(hill.ts) ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TS.max</code></td>
<td>
<p>the maximum value of test statistics for each t in Tgrid (see help(hill.ts) ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CritVal</code></td>
<td>
<p>the critical value of the test.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Grama, I. and Spokoiny, V. (2008). Statistics of extremes by oracle estimation. Ann. of Statist., 36, 1619-1648.
</p>
<p>Durrieu, G. and Grama, I. and Pham, Q. and Tricot, J.- M (2015). Nonparametric adaptive estimator of extreme conditional tail probabilities quantiles. Extremes, 18, 437-478.
</p>


<h3>See Also</h3>

<p><code>hill.ts</code>, <code>goftest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">theta&lt;-function(t){0.5+0.25*sin(2*pi*t)}
n&lt;-5000
t&lt;-1:n/n
Theta&lt;-theta(t)
Data&lt;-NULL
Tgrid&lt;-seq(0.01,0.99,0.01)
#example with fixed bandwidth
for(i in 1:n){Data[i]&lt;-rparetomix(1,a=1/Theta[i],b=5/Theta[i]+5,c=0.75,precision=10^(-5))}
## Not run:  #For computing time purpose
  #example
  hgrid &lt;- bandwidth.grid(0.009, 0.2, 20, type = "geometric")
  TgridCV &lt;- seq(0.01, 0.99, 0.1)
  hcv &lt;- bandwidth.CV(Data, t, TgridCV, hgrid, pcv = 0.99,
         TruncGauss.kernel, kpar = c(sigma = 1), CritVal = 3.6, plot = TRUE)

  Tgrid &lt;- seq(0.01,0.99,0.01)
  hillTs &lt;- hill.ts(Data, t, Tgrid, h = hcv$h.cv, TruncGauss.kernel, kpar = c(sigma = 1),
                   CritVal = 3.6, gridlen = 100, initprop = 1/10, r1 = 1/4, r2 = 1/20)
  goftest(hillTs, Data, t, plot = TRUE)

  # we observe that for this data, the null hypothesis that the tail
  # is fitted by a Pareto distribution is not rejected
  # for all points on the Tgrid


## End(Not run)


</code></pre>


</div>