<div class="container">

<table style="width: 100%;"><tr>
<td>signal_motion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate particle motion parameters</h2>

<h3>Description</h3>

<p>The function calculates from a data set of three seismic 
components of the same signal the following particle motion 
paramters using a moving window approach: horizontal-vertical 
eigenvalue ratio, azimuth and inclination.
</p>


<h3>Usage</h3>

<pre><code class="language-R">signal_motion(data, time, dt, window, step, order = "xyz")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>List</code> of eseis objects or <code>matrix</code>, seismic
components to be processed. If <code>data</code> is a matrix, the components 
must be organised as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p><code>POSIXct</code> vector, time vector corresponding to the 
seismic signal components. If omitted, a synthetic time vector will 
be generated. If omitted, the sampling period (<code>dt</code>) must be 
provided or is taken from the first eseis object in the <code>data</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p><code>Numeric</code> value, sampling period. Only needed if 
<code>time</code> is omitted or if <code>data</code> is no <code>eseis</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> value, time window length (given as 
number of samples) used to calculate the particle motion parameters. 
If value is even, it will be set to the next smaller odd value. If 
omitted, the window size is set to 1 percent of the time series length by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p><code>Numeric</code> value, step size (given as number of samples), 
by which the window is shifted over the data set. If omitted, the step 
size is set to 50 percent of the window size by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p><code>Character</code> value, order of the seismic components. 
Description must contain the letters <code>"x"</code>,<code>"y"</code> and
<code>"z"</code> in the order according to the input data set. Default is 
<code>"xyz"</code> (EW-NS-vertical).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function code is loosely based on the function GAZI() from 
the package RSEIS with removal of unnecessary content and updated 
or rewritten loop functionality. In its current form, it also uses 
additional workflows from obspy.signal.polarisation, specifically 
following the Flinn (1965) approach. It windows the input signals,
calculates the covariance matrix and performs a singular values 
decomposition to use the eigen values and vectors to determine the 
ratios corresponding to the output values rectilinearity, angularity,
azimuth and incidence. 
</p>
<p>Note that the names of the output objects as well as the calculation 
routine have changed from the earlier version (V. 0.6.0), to increase 
computational efficiency and fix a bug in the windowing implementation.
</p>


<h3>Value</h3>

<p>A List object with rectilinearity (<code>rectilinearity</code>),  
angularity (<code>polarity</code>), azimuth (<code>azimuth</code>) and incidence 
(<code>incidence</code>), as well as the corresponding time vector for 
these values.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load example data set
data(earthquake)

## filter seismic signals
s &lt;- eseis::signal_filter(data = s, 
                          dt = 1/200, 
                          f = c(1, 3))

## convert list of signal vectors to column-wise matrix
s &lt;- do.call(cbind, s)

## calculate particle motion parameters
pm &lt;- signal_motion(data = s, 
                    dt = 1 / 200,
                    window = 500, 
                    step = 250)
                    
## plot function output
par_original &lt;- par(no.readonly = TRUE)
par(mfcol = c(2, 2))

plot(pm$time, pm$rect, type = "b")
plot(pm$time, pm$plan, type = "b")
plot(pm$time, pm$azimuth, type = "b")
plot(pm$time, pm$incidence, type = "b")

par(par_original)

</code></pre>


</div>