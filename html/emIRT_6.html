<div class="container">

<table style="width: 100%;"><tr>
<td>dynIRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Dynamic IRT estimation via Variational Inference </h2>

<h3>Description</h3>

 
<p><code>ordIRT</code> estimates an dynamic IRT model with two response categories per item, over several
sessions. Ideal points over time follow a random walk prior, and the model originates from the
work of Martin and Quinn (2002). Estimation is conducted using the variational EM algorithm described
in the reference paper below. The algorithm will produce point estimates that are comparable to those
of <code>MCMCdynamicIRT1d</code>, but will do so much more rapidly and also scale better
with larger data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  dynIRT(.data, .starts = NULL, .priors = NULL, .control = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p> a list with the following items.
</p>

<dl>
<dt><code>rc</code></dt>
<dd>
<p>  A (N x J) matrix of observed votes. ‘1’ and ‘-1’ are the yea and nay codes, while ‘0’ is
a missing data code.</p>
</dd>
<dt><code>startlegis</code></dt>
<dd>
<p>  An (N x 1) matrix indicating the first session that each legislator serves. Justices
are assumed to serve in all terms between (and including) ‘startlegis’ to ‘endlegis’.  Terms start at term 0,
and end at term T - 1.</p>
</dd>
<dt><code>endlegis</code></dt>
<dd>
<p>  An (N x 1) matrix indicating the last session that each legislator serves. Justices
are assumed to serve in all terms between (and including) ‘startlegis’ to ‘endlegis’.  Terms start at term 0,
and end at term T - 1.</p>
</dd>
<dt><code>bill.session</code></dt>
<dd>
<p>  A (J x 1) matrix of integers indicating the session each bill occurred in. Session count
begins at 0, so the maximum value of bill.session is T - 1.</p>
</dd>
<dt><code>T</code></dt>
<dd>
<p>  integer, indicating total number of consecutive terms in the data. Count starts from 1, so the
maximum values of startlegis/endlegis/bill.session is T - 1, since they start from term 0.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.starts</code></td>
<td>
<p> a list containing several matrices of starting values for the parameters. The
list should contain the following matrices:
</p>

<dl>
<dt><code>alpha</code></dt>
<dd>
<p>  A (J x 1) matrix of starting values for the item difficulty parameter <code class="reqn">\alpha_j</code>.</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>  A (J x 1) matrix of starting values for the item discrimination parameter <code class="reqn">\beta_j</code>.</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>  An (N x T) matrix of starting values for the respondent ideal points <code class="reqn">x_{it}</code>, with rows indicating the
legislator and columns indicating the session.  Although not strictly necessary, it is generally good practice here to
set the start values for legislators who are not serving in a particular session to 0, as that is what the point estimate for
them will return.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.priors</code></td>
<td>
<p>  list, containing several matrices of starting values for the parameters. The
list should contain the following matrices:
</p>

<dl>
<dt><code>x.mu0</code></dt>
<dd>
<p>  A (N x 1) prior means matrix for respondent ideal points <code class="reqn">c_{i0}</code>. These are generally
set to be somewhat informative to resolve the standard rotational invariance problem in ideal point models.</p>
</dd>
<dt><code>x.sigma0</code></dt>
<dd>
<p>  A (N x 1) prior variance matrix for respondent ideal points <code class="reqn">C_{i0}</code>.</p>
</dd>
<dt><code>beta.mu</code></dt>
<dd>
<p>  A (2 x 1) prior means matrix for all bill parameters <code class="reqn">\alpha_j</code> and <code class="reqn">\beta_j</code>.</p>
</dd>
<dt><code>beta.sigma</code></dt>
<dd>
<p>  A (2 x 2) prior covariance matrix for all bill parameters <code class="reqn">\alpha_j</code> and <code class="reqn">\beta_j</code>.</p>
</dd>
<dt><code>omega2</code></dt>
<dd>
<p>  A (N x 1) matrix with the evolutionary variance for each legislator <code class="reqn">\omega^2_{ix}</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.control</code></td>
<td>
<p>  list, specifying some control functions for estimation.  Options include the following:
</p>

<dl>
<dt><code>threads</code></dt>
<dd>
<p>  integer, indicating number of cores to use. Default is to use a single core, but more can be
supported if more speed is desired.</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>  boolean, indicating whether output during estimation should be verbose or not.  Set FALSE by default.</p>
</dd>
<dt><code>thresh</code></dt>
<dd>
<p>  numeric. Algorithm will run until all parameters correlate at 1 - thresh across
consecutive iterations. Set at 1e-6 by default.</p>
</dd>
<dt><code>maxit</code></dt>
<dd>
<p>  integer. Sets the maximum number of iterations the algorithm can run. Set at 500 by default.</p>
</dd>
<dt><code>checkfreq</code></dt>
<dd>
<p>  integer. Sets frequency of verbose output by number of iterations. Set at 50 by default.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>dynIRT</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p> list, containing several matrices of point estimates for the parameters corresponding
to the inputs for the priors.  The list should contain the following matrices.
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>  A (N x T) matrix of point estimates for the respondent ideal points <code class="reqn">x_{it}</code>, with rows
indicating respondent and columns indicating session of the estimated ideal point. Estimates will equal
exactly 0 for legislator/period combinations in which the legislator did not serve.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>  A (J x 1) matrix of point estimates for the item difficulty parameter <code class="reqn">\alpha_j</code>.</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>  A (J x 1) matrix of point estimates for the item discrimination parameter <code class="reqn">\beta_j</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p> list, containing several matrices of variance estimates for parameters corresponding
to the inputs for the priors.  Note that these variances are those recovered via variational approximation,
and in most cases they are known to be far too small and generally unusable.  Better estimates of variances
can be obtained manually via the parametric bootstrap.  The list should contain the following matrices:
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>  A (N x T) matrix of variance estimates for the respondent ideal points <code class="reqn">x_{it}</code>, with rows
indicating respondent and columns indicating session of the estimated ideal point. Estimates will equal
exactly 0 for legislator/period combinations in which the legislator did not serve.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>  A (J x 1) matrix of variance estimates for the item difficulty parameter <code class="reqn">\alpha_j</code>.</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>  A (J x 1) matrix of variance estimates for the item discrimination parameter <code class="reqn">\beta_j</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runtime</code></td>
<td>
<p> A list of fit results, with elements listed as follows:</p>
</td>
</tr>
</table>
<dl>
<dt><code>iters</code></dt>
<dd>
<p>  integer, number of iterations run.</p>
</dd>
<dt><code>conv</code></dt>
<dd>
<p>  integer, convergence flag. Will return 1 if threshold reached, and 0 if maximum number of iterations reached.</p>
</dd>
<dt><code>threads</code></dt>
<dd>
<p>  integer, number of threads used to estimated model.</p>
</dd>
<dt><code>tolerance</code></dt>
<dd>
<p>  numeric, tolerance threshold for convergence.  Identical to thresh argument in input to .control list.</p>
</dd>
</dl>
<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p> Number of respondents in estimation, should correspond to number of rows in roll call matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p> Number of items in estimation, should correspond to number of columns in roll call matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p> Number of time periods fed into the estimation, identical to argument input from .data list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> Function call used to generate output.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

 
<p>Kosuke Imai <a href="mailto:imai@harvard.edu">imai@harvard.edu</a>
</p>
<p>James Lo <a href="mailto:lojames@usc.edu">lojames@usc.edu</a>
</p>
<p>Jonathan Olmsted <a href="mailto:jpolmsted@gmail.com">jpolmsted@gmail.com</a>
</p>


<h3>References</h3>

<p>Original model and the example is based off of Andrew Martin and Kevin Quinn, “Dynamic Ideal
Point Estimation via Markov Chain Monte Carlo for the U.S. Supreme Court, 1953-1999.” Political
Analysis 10(2) 134-153.
</p>
<p>Variational model is described in Kosuke Imai, James Lo, and Jonathan Olmsted (2016). “Fast Estimation
of Ideal Points with Massive Data.” American Political Science Review, Vol. 110, No. 4 (December), pp. 631-656.
</p>


<h3>See Also</h3>

<p>'mq_data'.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Replication of Martin-Quinn Judicial Ideology Scores
### Based on July 23, 2014 (2014 Release 01) release of the Supreme Court Database
### Start values and priors based on replication code provided by Kevin Quinn

data(mq_data)

## Estimate dynamic variational model using dynIRT()
lout &lt;- dynIRT(.data = mq_data$data.mq,
                    .starts = mq_data$cur.mq,
                    .priors = mq_data$priors.mq,
                    .control = {list(
                    threads = 1,
                    verbose = TRUE,
                    thresh = 1e-6,
		    maxit=500
                    )})

## Extract estimate from variational model
## Delete point estimates of 0, which are justices missing from that session
vi.out &lt;- c(t(lout$means$x))
vi.out[vi.out==0] &lt;- NA
vi.out &lt;- na.omit(vi.out)

## Compare correlation against MCMC-estimated result
## Correlates at r=0.93 overall, and 0.96 when excluding Douglas
cor(vi.out, mq_data$mq_mcmc)	
cor(vi.out[mq_data$justiceName != "Douglas"],
 mq_data$mq_mcmc[mq_data$justiceName != "Douglas"])	


</code></pre>


</div>