<div class="container">

<table style="width: 100%;"><tr>
<td>wBT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the WBT (WRTDS Bootstrap Test)</h2>

<h3>Description</h3>

<p>Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out <code>runPairsBoot</code> and <code>runGroupsBoot</code>
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The <code>runPairsBoot</code> and <code>runGroupsBoot</code> allow for generalized flow normalization (i.e. non-stationary discharge).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wBT(eList, caseSetUp, saveOutput = TRUE, fileName = "temp.txt",
  startSeed = 494817, jitterOn = FALSE, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code>modelEstimation</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caseSetUp</code></td>
<td>
<p>data frame. Returned from <code>trendSetUp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveOutput</code></td>
<td>
<p>logical. If <code>TRUE</code>, a text file will be saved in the working directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileName</code></td>
<td>
<p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitterOn</code></td>
<td>
<p>logical, if TRUE, adds "jitter" to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of "jitter" can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random "jitter" to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>


<h3>Value</h3>

<p>eBoot, a named list with bootOut, wordsOut, xConc, xFlux, pConc, pFlux values.
</p>

<table>
<tr>
<td style="text-align: left;">
Object </td>
<td style="text-align: left;"> Description</td>
</tr>
<tr>
<td style="text-align: left;">
bootOut </td>
<td style="text-align: left;"> a data frame with the results of the bootstrap test. </td>
</tr>
<tr>
<td style="text-align: left;">
wordsOut </td>
<td style="text-align: left;"> a character vector describing the results. </td>
</tr>
<tr>
<td style="text-align: left;">
xConc and xFlux </td>
<td style="text-align: left;"> vectors of length iBoot, of the change in flow normalized concentration
   and flow normalized flux computed from each of the bootstrap replicates. </td>
</tr>
<tr>
<td style="text-align: left;">
pConc and pFlux </td>
<td style="text-align: left;"> vectors of length iBoot, of the change in flow normalized concentration
   or flow normalized flux computed from each of the bootstrap replicates expressed as 
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>trendSetUp</code>, <code>setForBoot</code>, <code>runGroupsBoot</code>, <code>runPairsBoot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">eList &lt;- EGRET::Choptank_eList
caseSetUp &lt;- trendSetUp(eList,
                        year1 = 1985, 
                        year2 = 2005,
                        nBoot = 50, 
                        bootBreak = 39,
                        blockLength = 200)
# Very long-running function:                     
## Not run: 
eBoot &lt;- wBT(eList,caseSetUp)

## End(Not run)
</code></pre>


</div>