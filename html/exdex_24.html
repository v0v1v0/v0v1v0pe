<div class="container">

<table style="width: 100%;"><tr>
<td>dgaps_stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sufficient statistics for the left-censored inter-exceedances time model</h2>

<h3>Description</h3>

<p>Calculates sufficient statistics for the the left-censored inter-exceedances
time <code class="reqn">D</code>-gaps model for the extremal index <code class="reqn">\theta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgaps_stat(data, u, q_u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector of raw data.  No missing values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_u</code></td>
<td>
<p>A numeric scalar.  An estimate of the probability with which
the threshold <code>u</code> is exceeded.  If <code>q_u</code> is missing then it is
calculated using <code>mean(data &gt; u, na.rm = TRUE)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A numeric scalar.  Run parameter <code class="reqn">K</code>, as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
<code class="reqn">K</code>-gap equal to zero.  Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times relating to the
first and last observation.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample inter-exceedance times are
<code class="reqn">T_0, T_1, ..., T_{N-1}, T_N</code>,
where <code class="reqn">T_1, ..., T_{N-1}</code> are uncensored and
<code class="reqn">T_0</code> and <code class="reqn">T_N</code> are right-censored.  Under the assumption that the
inter-exceedance times are independent, the log-likelihood of the
<code class="reqn">D</code>-gaps model is given by
</p>
<p style="text-align: center;"><code class="reqn">l(\theta; T_0, \ldots, T_N) = N_0 \log(1 - \theta e^{-\theta d}) +
    2 N_1 \log \theta - \theta q (I_0 T_0 + \cdots + I_N T_N),</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">q</code> is the threshold exceedance probability, estimated by
the proportion of threshold exceedances,
</p>
</li>
<li> <p><code class="reqn">d = q D</code>,
</p>
</li>
<li> <p><code class="reqn">I_j = 1</code> if <code class="reqn">T_j &gt; D</code> and <code class="reqn">I_j = 0</code> otherwise,
</p>
</li>
<li> <p><code class="reqn">N_0</code> is the number of sample inter-exceedance times that
are left-censored, that is, are less than or equal to <code class="reqn">D</code>,
</p>
</li>
<li>
<p> (apart from an adjustment for the contributions of <code class="reqn">T_0</code> and
<code class="reqn">T_N</code>) <code class="reqn">N_1</code> is the number of inter-exceedance times that
are uncensored, that is, are greater than <code class="reqn">D</code>,
</p>
</li>
<li>
<p> specifically, if <code>inc_cens = TRUE</code> then <code class="reqn">N_1</code> is equal
to the number of <code class="reqn">T_1, ..., T_{N-1}</code> that are
uncensored plus <code class="reqn">(I_0 + I_N) / 2</code>.
</p>
</li>
</ul>
<p>The differing treatment of uncensored and censored <code class="reqn">K</code>-gaps reflects
differing contributions to the likelihood. Right-censored
inter-exceedance times whose observed values are less than or equal to
<code class="reqn">D</code> add no information to the likelihood because we do not know to
which part of the likelihood they should contribute.
</p>
<p>If <code class="reqn">N_1 = 0</code> then we are in the degenerate case where there is one
cluster (all inter-exceedance times are left-censored) and the likelihood
is maximized at <code class="reqn">\theta = 0</code>.
</p>
<p>If <code class="reqn">N_0 = 0</code> then all exceedances occur singly (no inter-exceedance
times are left-censored) and the likelihood is maximized at
<code class="reqn">\theta = 1</code>.
</p>


<h3>Value</h3>

<p>A list containing the sufficient statistics, with components
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>N0</code> </td>
<td>
<p>the number of left-censored inter-exceedance times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>N1</code> </td>
<td>
<p>contribution from inter-exceedance times that are not
left-censored (see <strong>Details</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>sum_qtd</code> </td>
<td>
<p>the sum of the (scaled) inter-exceedance times
that are not left-censored, that is,
<code class="reqn">q (I_0 T_0 + \cdots + I_N T_N)</code>,
where <code class="reqn">q</code> is estimated by the proportion of threshold
exceedances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>n_dgaps</code> </td>
<td>
<p>the number of inter-exceedances that contribute
to the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>q_u</code> </td>
<td>
<p>the sample proportion of values that exceed the
threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>D</code> </td>
<td>
<p>the input value of <code>D</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code>dgaps</code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">D</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">u &lt;- quantile(newlyn, probs = 0.90)
dgaps_stat(newlyn, u = u, D = 1)
</code></pre>


</div>