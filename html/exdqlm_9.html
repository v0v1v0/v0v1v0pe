<div class="container">

<table style="width: 100%;"><tr>
<td>exdqlmMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>exDQLM - MCMC algorithm</h2>

<h3>Description</h3>

<p>The function applies a Markov chain Monte Carlo (MCMC) algorithm to sample the posterior of an exDQLM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exdqlmMCMC(
  y,
  p0,
  model,
  df,
  dim.df,
  fix.gamma = FALSE,
  gam.init = NA,
  fix.sigma = FALSE,
  sig.init = NA,
  dqlm.ind = FALSE,
  Sig.mh,
  joint.sample = FALSE,
  n.burn = 2000,
  n.mcmc = 1500,
  init.from.isvb = TRUE,
  PriorSigma = NULL,
  PriorGamma = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A univariate time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>The quantile of interest, a value between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Discount factors for each block.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim.df</code></td>
<td>
<p>Dimension of each block of discount factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.gamma</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>gam.init</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam.init</code></td>
<td>
<p>Initial value for gamma (skewness parameter), or value at which gamma will be fixed if <code>fix.gamma=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.sigma</code></td>
<td>
<p>Logical value indicating whether to fix sigma at <code>sig.init</code>. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.init</code></td>
<td>
<p>Initial value for sigma (scale parameter), or value at which sigma will be fixed if <code>fix.sigma=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dqlm.ind</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>0</code>, reducing the exDQLM to the special case of the DQLM. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sig.mh</code></td>
<td>
<p>Covariance matrix used in the random walk MH step to jointly sample sigma and gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint.sample</code></td>
<td>
<p>Logical value indicating whether or not to recompute <code>Sig.mh</code> based off the initial burn-in samples of gamma and sigma. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.burn</code></td>
<td>
<p>Number of MCMC iterations to burn. Default is <code>n.burn = 2000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mcmc</code></td>
<td>
<p>Number of MCMC iterations to sample. Default is <code>n.mcmc = 1500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.from.isvb</code></td>
<td>
<p>Logical value indicating whether or not to initialize the MCMC using the ISVB algorithm. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PriorSigma</code></td>
<td>
<p>List of parameters for inverse gamma prior on sigma; shape <code>a_sig</code> and scale <code>b_sig</code>. Default is an inverse gamma with mean 1 (or <code>sig.init</code> if provided) and variance 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PriorGamma</code></td>
<td>
<p>List of parameters for truncated student-t prior on gamma; center <code>m_gam</code>, scale <code>s_gam</code> and degrees of freedom <code>df_gam</code>. Default is a standard student-t with 1 degree of freedom, truncated to the support of gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value indicating whether progress should be displayed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the following is returned:
</p>

<ul>
<li> <p><code>run.time</code> - Algorithm run time in seconds.
</p>
</li>
<li> <p><code>model</code> - List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.
</p>
</li>
<li> <p><code>p0</code> - The quantile which was estimated.
</p>
</li>
<li> <p><code>df</code> - Discount factors used for each block.
</p>
</li>
<li> <p><code>dim.df</code> - Dimension used for each block of discount factors.
</p>
</li>
<li> <p><code>samp.theta</code> - Posterior sample of the state vector.
</p>
</li>
<li> <p><code>samp.post.pred</code> - Sample of the posterior predictive distributions.
</p>
</li>
<li> <p><code>map.standard.forecast.errors</code> - MAP standardized one-step-ahead forecast errors.
</p>
</li>
<li> <p><code>samp.sigma</code> - Posterior sample of scale parameter sigma.
</p>
</li>
<li> <p><code>samp.vts</code> - Posterior sample of latent parameters, v_t.
</p>
</li>
<li> <p><code>theta.out</code> - List containing the distributions of the state vector including filtered distribution parameters (<code>fm</code> and <code>fC</code>) and smoothed distribution parameters (<code>sm</code> and <code>sC</code>).
</p>
</li>
</ul>
<p>If <code>dqlm.ind=FALSE</code>, the list also contains the following:
</p>

<ul>
<li> <p><code>samp.gamma</code> - Posterior sample of skewness parameter gamma.
</p>
</li>
<li> <p><code>samp.sts</code> - Posterior sample of latent parameters, s_t.
</p>
</li>
<li> <p><code>init.log.sigma</code> - Burned samples of log sigma from the random walk MH joint sampling of sigma and gamma.
</p>
</li>
<li> <p><code>init.logit.gamma</code> - Burned samples of logit gamma from the random walk MH joint sampling of sigma and gamma.
</p>
</li>
<li> <p><code>accept.rate</code> - Acceptance rate of the MH step.
</p>
</li>
<li> <p><code>Sig.mh</code> - Covariance matrix used in MH step to jointly sample sigma and gamma.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
y = scIVTmag[1:100]
trend.comp = polytrendMod(1,mean(y),10)
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))
model = combineMods(trend.comp,seas.comp)
M2 = exdqlmMCMC(y,p0=0.85,model,df=c(1,1),dim.df = c(1,6),
                gam.init=-3.5,sig.init=15,
                n.burn=100,n.mcmc=150)


</code></pre>


</div>