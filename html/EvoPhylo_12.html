<div class="container">

<table style="width: 100%;"><tr>
<td>FBD_reshape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Convert an FBD posterior parameter table from wide to long format
</h2>

<h3>Description</h3>

<p>Converts FBD posterior parameter table, such as those imported using <code>combine_log</code>, from wide to long format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FBD_reshape(posterior, variables = NULL, log.type = c("MrBayes", "BEAST2"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>

<p>Single posterior parameter sample dataset with skyline FBD parameters produced with <code>combine_log</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>

<p>Names of FBD rate variables in the log. If NULL (default), will attempt to auto-detect the names and log type.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.type</code></td>
<td>

<p>Name of the software which produced the log (currently supported: MrBayes or BEAST2). Has to be set if <code>variables</code> is not NULL.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The posterior parameters log files produced by Bayesian evolutionary analyses using skyline birth-death tree models, including the skyline FBD model, result into two or more estimates for each FBD parameter, one for each time bin. This function will convert a table of parameters with skyline FBD parameters from wide to long format, with one row per generation per time bin and a new column "Time_bin" containing the respective time bins as a factor. The long format is necessary for downstream analyses using <code>FBD_summary</code>, <code>FBD_dens_plot</code>, <code>FBD_normality_plot</code>, <code>FBD_tests1</code>, or <code>FBD_tests2</code>, as similarly done by <code>clock_reshape</code> for clock rate tables.
</p>
<p>The format of the log files can either be specified using the <code>variables</code> and <code>log.type</code> or auto-detected by the function.
The "posterior" data frame can be obtained by reading in a log file directly (e.g. using the <code>read.table</code> function) or by combining several output log files from Mr. Bayes using <code>combine_log</code>.
</p>


<h3>Value</h3>

<p>A data frame of posterior parameter estimates containing a single "Time_bin" column and one column for each FBD parameter value.
</p>


<h3>See Also</h3>

<p><code>vignette("fbd-params")</code> for the use of this function as part of an analysis pipeline.
</p>
<p><code>combine_log</code>, <code>reshape</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See vignette("fbd-params") for how to use this
# function as part of an analysis pipeline

data("posterior3p")

head(posterior3p)

## Reshape FBD table to long format
posterior3p_long &lt;- FBD_reshape(posterior3p)

head(posterior3p_long)
</code></pre>


</div>