<div class="container">

<table style="width: 100%;"><tr>
<td>envelope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Isotope pattern envelope calculation</h2>

<h3>Description</h3>

<p>Convolutes an isotope pattern from <code>isopattern</code> with a peak shape function (Gaussian or Cauchy-Lorentz function) 
to its theoretical envelope (profile), at a given measurement resolution. 
The envelope is represented by sticks, i.e. measurement abundances at discrete m/z intervals. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">envelope(pattern, ppm = FALSE, dmz = "get", frac = 1/4, env = "Gaussian", 
resolution = 5e+05, plotit = FALSE, verbose = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>List of isotope pattern(s) as generated by <code>isopattern</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppm</code></td>
<td>
<p>Should stick discretization be set in ppm (<code>TRUE</code>) or absolute m/z (<code>FALSE</code>)?
Only checked if <code>dmz</code> is not set to <code>"get"</code>; check details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmz</code></td>
<td>
<p>Stick discretization. Set to <code>"get"</code> to derive discretization from argument <code>resolution</code> or set a numerical value
in combination with <code>ppm</code> to use as ppm or absolute m/z. Check details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>Used if <code>dmz</code> is set to <code>"get"</code>. Check details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Peak shape function; either <code>"Gaussian"</code> or <code>"CauchyLorentz"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>Single resolution value or vector of resolutions with length equal to the number of entries in list <code>pattern</code>. 
Check resolution definition in the details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>
<p>Should results be plotted, <code>TRUE/FALSE</code> ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose, <code>TRUE/FALSE</code>?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The theoretical profiles are represented by sticks, i.e. abundances at discrete m/z intervals.
While the profile width is set by argument <code>resolution</code>, the mass discretization between adjacent sticks can be set in two different ways. 
</p>
<p>On the one hand, discretization can be given as a numerical value, either in ppm or absolute m/z. 
To do so, set argument <code>dmz</code> to a numerical value and specify with argument <code>ppm</code> if this value is stating the discretization in ppm or 
as absolute m/z.
</p>
<p>On the other hand, discretization can be derived from the measurement resolution (R) set by
argument <code>resolution</code>. To do so, set <code>dmz</code> to <code>"get"</code>, which leads to argument <code>ppm</code> being ignored. 
In this case, the stick discretization is retrieved from (dm/z)*<code>frac</code>, with (dm/z) = (m/z)/R = peak width at half maximum.</p>


<h3>Value</h3>

<p>List with length equal to length of list <code>pattern</code>, with equal names of list entries.
Each entry in that list contains the sticks of the envelope in two columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>m/z</code></td>
<td>
<p>Stick m/z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p>Stick abundance</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The resolution R is defined as R=(m/z)/(dm/z), with dm/z = peak width at half maximum, cp. <code>resolution_list</code>.</p>


<h3>Author(s)</h3>

<p>Martin Loos, Christian Gerber</p>


<h3>References</h3>

<p>Li, L., Kresh, J., Karabacak, N., Cobb, J., Agar, J. and Hong, P. (2008). 
A Hierarchical Algorithm for Calculating the Isotopic Fine Structures of Molecules.
Journal of the American Society for Mass Spectrometry, 19, 1867â€“1874.
</p>


<h3>See Also</h3>

<p><code>isopattern</code>
<code>getR</code>
<code>vdetect</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
############################
# batch of chemforms #######
data(isotopes)
data(chemforms)
chemforms&lt;-chemforms[1:5]

pattern&lt;-isopattern(
  isotopes,
  chemforms,
  threshold=0.1,
  plotit=TRUE,
  charge=FALSE,
  emass=0.00054858,
  algo=2
)

profiles&lt;-envelope(
    pattern,
    ppm=FALSE,
    dmz=0.0001,   
    frac=1/4,
    env="Gaussian",
    resolution=1E6,
    plotit=TRUE
)
############################

</code></pre>


</div>