<div class="container">

<table style="width: 100%;"><tr>
<td>addord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit new points to an existing NMDS configuration.
</h2>

<h3>Description</h3>

<p>Uses a brute force algorithm to find the location for each new point that minimizes overall stress.
</p>


<h3>Usage</h3>

<pre><code class="language-R">addord(origconf, fulldat, fulldist, isTrain, bfstep = 10, maxit = 50, epsilon = 1e-12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>origconf</code></td>
<td>

<p>The original ordination configuration.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fulldat</code></td>
<td>

<p>The dataset containing original and new points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fulldist</code></td>
<td>

<p>A dissimilarity matrix calculated on <code>fulldat</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isTrain</code></td>
<td>

<p>A boolean vector of length <code>nrow(fulldat)</code> indicating which rows were training data used in determining <code>origconf</code> (TRUE), or are new points (FALSE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bfstep</code></td>
<td>

<p>A tuning parameter for the brute force algorithm describing the size of grid to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>The maximum number of iterations to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>Tolerance value for convergence.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A region comprising the original ordination configuration plus one standard deviation is divided into a grid of <code>bfstep</code> rows and columns. For a new point, the grid cell with the lowest stress is identified. That cell is divided into a finer grid, and the lowest-stress cell identified. This process is repeated up to <code>maxit</code> times, or until stress changes less than <code>epsilon</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fullfitconf </code></td>
<td>
<p>The new ordination configuration containing training and new points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stress </code></td>
<td>
<p>The stress value for each point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isTrain </code></td>
<td>
<p>The boolean vector indicating training set membership, for reference.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Sarah Goslee </p>


<h3>Examples</h3>

<pre><code class="language-R">data(iris)
iris.d &lt;- dist(iris[,1:4])

### nmds() is timeconsuming, so this was generated
### in advance and saved.
### set.seed(1234)
### iris.nmds &lt;- nmds(iris.d, nits=20, mindim=1, maxdim=4)
### save(iris.nmds, file="ecodist/data/iris.nmds.rda")
data(iris.nmds)

# examine fit by number of dimensions
plot(iris.nmds)

# choose the best two-dimensional solution to work with
iris.nmin &lt;- min(iris.nmds, dims=2)

# rotate the configuration to maximize variance
iris.rot &lt;- princomp(iris.nmin)$scores

# rotation preserves distance apart in ordination space
cor(dist(iris.nmin), dist(iris.rot))

# fit the data to the ordination as vectors
### vf() is timeconsuming, so this was generated
### in advance and saved.
### set.seed(1234)
### iris.vf &lt;- vf(iris.nmin, iris[,1:4], nperm=1000)
### save(iris.vf, file="ecodist/data/iris.vf.rda")
data(iris.vf)

# repeat for the rotated ordination
### vf() is timeconsuming, so this was generated
### in advance and saved.
### set.seed(1234)
### iris.vfrot &lt;- vf(iris.rot, iris[,1:4], nperm=1000)
### save(iris.vfrot, file="ecodist/data/iris.vfrot.rda")
data(iris.vfrot)

par(mfrow=c(1,2))
plot(iris.nmin, col=as.numeric(iris$Species), pch=as.numeric(iris$Species), main="NMDS")
plot(iris.vf)
plot(iris.rot, col=as.numeric(iris$Species), pch=as.numeric(iris$Species), main="Rotated NMDS")
plot(iris.vfrot)

####### addord example

# generate new data points to add to the ordination
# this might be new samples, or a second dataset

iris.new &lt;- structure(list(Sepal.Length = c(4.6, 4.9, 5.4, 5.2, 6, 6.5, 6, 
6.8, 7.3), Sepal.Width = c(3.2, 3.5, 3.6, 2.3, 2.8, 3, 2.7, 3.1, 
3.2), Petal.Length = c(1.2, 1.5, 1.5, 3.5, 4.1, 4.2, 4.8, 5, 
5.7), Petal.Width = c(0.26, 0.26, 0.26, 1.2, 1.3, 1.4, 1.8, 2, 
2), Species = structure(c(1L, 1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L), .Label = c("setosa", 
"versicolor", "virginica"), class = "factor")), .Names = c("Sepal.Length", 
"Sepal.Width", "Petal.Length", "Petal.Width", "Species"), class = "data.frame", row.names = c(NA, 
-9L))

# provide a dist object containing original and new data
# provide a logical vector indicating which samples were used to
# construct the original configuration

iris.full &lt;- rbind(iris, iris.new)
all.d &lt;- dist(iris.full[,1:4])
is.orig &lt;- c(rep(TRUE, nrow(iris)), rep(FALSE, nrow(iris.new)))

### addord() is timeconsuming, so this was generated
### in advance and saved.
### set.seed(1234)
### iris.fit &lt;- addord(iris.nmin, iris.full[,1:4], all.d, is.orig, maxit=100)
### save(iris.fit, file="ecodist/data/iris.fit.rda")
data(iris.fit)

plot(iris.fit$conf, col=iris.full$Species, pch=c(18, 4)[is.orig + 1], xlab="NMDS 1", ylab="NMDS 2")
title("Demo: adding points to an ordination")
legend("bottomleft", c("Training set", "Added point"), pch=c(4, 18))
legend("topright", levels(iris$Species), fill=1:3)

</code></pre>


</div>