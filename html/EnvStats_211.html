<div class="container">

<table style="width: 100%;"><tr>
<td>eqlnorm3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Quantiles of a Three-Parameter Lognormal Distribution
</h2>

<h3>Description</h3>

<p>Estimate quantiles of a three-parameter lognormal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  eqlnorm3(x, p = 0.5, method = "lmle", digits = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a numeric vector of observations, or an object resulting from a call to an 
estimating function that assumes a three-parameter lognormal distribution 
(e.g., <code>elnorm3</code>). If <code>x</code> is a numeric vector, 
missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>numeric vector of probabilities for which quantiles will be estimated.  
All values of <code>p</code> must be between 0 and 1.  When <code>ci=TRUE</code>, <code>p</code> 
must be a scalar. The default value is <code>p=0.5</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method of estimating the distribution parameters.  
Possible values are 
<code>"lmle"</code> (local maximum likelihood; the default), <code>"mme"</code> 
(method of moments), <code>"mmue"</code> (method of moments using an unbaised 
estimate of variance), <code>"mmme"</code> (modified method of moments due to Cohen 
and Whitten (1980)), <code>"zero.skew"</code> (zero-skewness estimator due to 
Griffiths (1980)), and <code>"royston.skew"</code> (estimator based on 
Royston's (1992b) index of skewness).  See the DETAILS section of the help file 
for <code>elnorm3</code> for more information on these estimation methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>an integer indicating the number of decimal places to round to when printing out 
the value of <code>100*p</code>. The default value is <code>digits=0</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or 
infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to 
performing the estimation.
</p>
<p>Quantiles are estimated by 1) estimating the distribution parameters by 
calling <code>elnorm3</code>, and then 2) calling the function 
<code>qlnorm3</code> and using the estimated distribution  
parameters.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a numeric vector, <code>eqlnorm3</code> returns a 
list of class <code>"estimate"</code> containing the estimated quantile(s) and other 
information. See <code>estimate.object</code> for details.
</p>
<p>If <code>x</code> is the result of calling an estimation function, <code>eqlnorm3</code> 
returns a list whose class is the same as <code>x</code>.  The list 
contains the same components as <code>x</code>, as well as components called 
<code>quantiles</code> and <code>quantile.method</code>.
</p>


<h3>Note</h3>

<p>The problem of estimating the parameters of a three-parameter lognormal distribution 
has been extensively discussed by Aitchison and Brown (1957, Chapter 6), 
Calitz (1973), Cohen (1951), Cohen (1988), Cohen and Whitten (1980), 
Cohen et al. (1985), Griffiths (1980), Harter and Moore (1966), Hill (1963), and 
Royston (1992b).  Stedinger (1980) and Hoshi et al. (1984) discuss fitting the 
three-parameter lognormal distribution to hydrologic data.
</p>
<p>The global maximum likelihood estimates are inadmissible.  In the past, several 
researchers have found that the local maximum likelihood estimates (lmle's) 
occasionally fail because of convergence problems, but they were not using the 
likelihood profile and reparameterization of Griffiths (1980).  Cohen (1988) 
recommends the modified methods of moments estimators over lmle's because they are 
easy to compute, they are unbiased with respect to <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code> (the 
mean and standard deviation on the log-scale), their variances are minimal or near 
minimal, and they do not suffer from regularity problems.
</p>
<p>Because the distribution of the lmle of the threshold parameter <code class="reqn">\gamma</code> is far 
from normal for moderate sample sizes (Griffiths, 1980), it is questionable whether 
confidence intervals for <code class="reqn">\gamma</code> or the median based on asymptotic variances 
and covariances will perform well.  Cohen and Whitten (1980) and Cohen et al. (1985), 
however, found that the asymptotic variances and covariances are reasonably close to 
corresponding simulated variances and covariances for the modified method of moments 
estimators (<code>method="mmme"</code>).  In a simulation study (5000 monte carlo trials), 
Royston (1992b) found that the coverage of confidence intervals for <code class="reqn">\gamma</code> 
based on the likelihood profile (<code>ci.method="likelihood.profile"</code>) was very 
close the nominal level (94.1% for a nominal level of 95%), although not 
symmetric.  Royston (1992b) also found that the coverage of confidence intervals 
for <code class="reqn">\gamma</code> based on the skewness method (<code>ci.method="skewness"</code>) was also 
very close (95.4%) and symmetric.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Aitchison, J., and J.A.C. Brown (1957).  <em>The Lognormal Distribution 
(with special references to its uses in economics)</em>.  Cambridge University Press, 
London, Chapter 5.
</p>
<p>Calitz, F. (1973).  Maximum Likelihood Estimation of the Parameters of the 
Three-Parameter Lognormal Distribution–a Reconsideration.  <em>Australian 
Journal of Statistics</em> <b>15</b>(3), 185–190.
</p>
<p>Cohen, A.C. (1951).  Estimating Parameters of Logarithmic-Normal Distributions by 
Maximum Likelihood.  <em>Journal of the American Statistical Association</em> 
<b>46</b>, 206–212.
</p>
<p>Cohen, A.C. (1988).  Three-Parameter Estimation.  In Crow, E.L., and K. Shimizu, eds. 
<em>Lognormal Distributions: Theory and Applications</em>.  Marcel Dekker, New York, 
Chapter 4.
</p>
<p>Cohen, A.C., and B.J. Whitten. (1980).  Estimation in the Three-Parameter Lognormal 
Distribution.  <em>Journal of the American Statistical Association</em> <b>75</b>, 
399–404.
</p>
<p>Cohen, A.C., B.J. Whitten, and Y. Ding. (1985).  Modified Moment Estimation for the 
Three-Parameter Lognormal Distribution.  <em>Journal of Quality Technology</em> 
<b>17</b>, 92–99.
</p>
<p>Crow, E.L., and K. Shimizu. (1988).  <em>Lognormal Distributions: Theory and 
Applications</em>.  Marcel Dekker, New York, Chapter 2.
</p>
<p>Griffiths, D.A. (1980).  Interval Estimation for the Three-Parameter Lognormal 
Distribution via the Likelihood Function.  <em>Applied Statistics</em> <b>29</b>, 
58–68.
</p>
<p>Harter, H.L., and A.H. Moore. (1966).  Local-Maximum-Likelihood Estimation of the 
Parameters of Three-Parameter Lognormal Populations from Complete and Censored 
Samples.  <em>Journal of the American Statistical Association</em> <b>61</b>, 842–851.
</p>
<p>Heyde, C.C. (1963).  On a Property of the Lognormal Distribution.  <em>Journal of 
the Royal Statistical Society, Series B</em> <b>25</b>, 392–393.
</p>
<p>Hill, .B.M. (1963).  The Three-Parameter Lognormal Distribution and Bayesian 
Analysis of a Point-Source Epidemic.  <em>Journal of the American Statistical 
Association</em> <b>58</b>, 72–84.
</p>
<p>Hoshi, K., J.R. Stedinger, and J. Burges. (1984).  Estimation of Log-Normal 
Quantiles: Monte Carlo Results and First-Order Approximations.  <em>Journal of 
Hydrology</em> <b>71</b>, 1–30.
</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994). 
<em>Continuous Univariate Distributions, Volume 1</em>. 
Second Edition. John Wiley and Sons, New York.
</p>
<p>Royston, J.P. (1992b).  Estimation, Reference Ranges and Goodness of Fit for the 
Three-Parameter Log-Normal Distribution.  <em>Statistics in Medicine</em> <b>11</b>, 
897–912.
</p>
<p>Stedinger, J.R. (1980).  Fitting Lognormal Distributions to Hydrologic Data. 
<em>Water Resources Research</em> <b>16</b>(3), 481–490.
</p>


<h3>See Also</h3>

<p><code>elnorm3</code>, Lognormal3, Lognormal, 
LognormalAlt, Normal.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a 3-parameter lognormal distribution 
  # with parameters meanlog=1.5, sdlog=1, and threshold=10, then use 
  # Cohen and Whitten's (1980) modified moments estimators to estimate 
  # the parameters, and estimate the 90th percentile. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  dat &lt;- rlnorm3(20, meanlog = 1.5, sdlog = 1, threshold = 10) 
  eqlnorm3(dat, method = "mmme", p = 0.9)

  #Results of Distribution Parameter Estimation
  #--------------------------------------------
  #
  #Assumed Distribution:            3-Parameter Lognormal
  #
  #Estimated Parameter(s):          meanlog   = 1.5206664
  #                                 sdlog     = 0.5330974
  #                                 threshold = 9.6620403
  #
  #Estimation Method:               mmme
  #
  #Estimated Quantile(s):           90'th %ile = 18.72194
  #
  #Quantile Estimation Method:      Quantile(s) Based on
  #                                 mmme Estimators
  #
  #Data:                            dat
  #
  #Sample Size:                     20

  # Clean up
  #---------
  rm(dat)
</code></pre>


</div>