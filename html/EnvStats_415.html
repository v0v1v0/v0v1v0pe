<div class="container">

<table style="width: 100%;"><tr>
<td>predict.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predict Method for Linear Model Fits
</h2>

<h3>Description</h3>

<p>The function <code>predict.lm</code> in <span class="pkg">EnvStats</span> is a modified version 
of the built-in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>predict.lm</code>.  
The only modification is that for the <span class="pkg">EnvStats</span> function <code>predict.lm</code>, 
if <code>se.fit=TRUE</code>, the list returned includes a component called 
<code>n.coefs</code>.  The component <code>n.coefs</code> is used by the function 
<code>pointwise</code> to create simultaneous confidence or prediction limits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lm'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Object of class inheriting from <code>"lm"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments passed to the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>predict.lm</code>.  
See the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>predict.lm</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for <code>predict.lm</code>.
</p>
<p>The function <code>predict.lm</code> in <span class="pkg">EnvStats</span> is a modified version 
of the built-in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>predict.lm</code>.  
The only modification is that for the <span class="pkg">EnvStats</span> function <code>predict.lm</code>, 
if <code>se.fit=TRUE</code>, the list returned includes a component called 
<code>n.coefs</code>.  The component <code>n.coefs</code> is used by the function 
<code>pointwise</code> to create simultaneous confidence or prediction limits.
</p>


<h3>Value</h3>

<p>See the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for <code>predict.lm</code>.  
</p>
<p>The only modification is that for the <span class="pkg">EnvStats</span> function <code>predict.lm</code>, 
if <code>se.fit=TRUE</code>, the list returned includes a component called 
<code>n.coefs</code>, i.e., the function returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>vector or matrix as above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>standard error of predicted means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.scale</code></td>
<td>
<p>residual standard deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom for residual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.coefs</code></td>
<td>
<p>numeric scalar denoting the number of predictor variables used in the model</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>R Development Core Team (for code for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> version of <code>predict.lm</code>).
</p>
<p>Steven P. Millard (for modification to add compenent <code>n.coefs</code>; <a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J.M., and Hastie, T.J., eds. (1992). <em>Statistical Models in S</em>. 
Chapman and Hall/CRC, Boca Raton, FL.
</p>
<p>Draper, N., and H. Smith. (1998). <em>Applied Regression Analysis</em>. 
Third Edition. John Wiley and Sons, New York, Chapter 3.
</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>. 
CRC Press, Boca Raton, FL, pp.546-553.
</p>
<p>Miller, R.G. (1981a). <em>Simultaneous Statistical Inference</em>. 
Springer-Verlag, New York, pp.111, 124.
</p>


<h3>See Also</h3>

<p>Help file for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>predict</code>, 
Help file for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>predict.lm</code>, 
<code>lm</code>, <code>calibrate</code>, 
<code>calibrate</code>, <code>inversePredictCalibrate</code>, 
<code>detectionLimitCalibrate</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Using the data from the built-in data frame Air.df, 
  # fit the cube-root of ozone as a function of temperature, 
  # then compute predicted values for ozone at 70 and 90 degrees F,
  # along with the standard errors of these predicted values.

  # First look at the data
  #-----------------------
  with(Air.df, 
    plot(temperature, ozone, xlab = "Temperature (degrees F)", 
      ylab = "Cube-Root Ozone (ppb)"))


  # Now create the lm object 
  #-------------------------
  ozone.fit &lt;- lm(ozone ~ temperature, data = Air.df) 


  # Now get predicted values and CIs at 70 and 90 degrees.
  # Note the presence of the last component called n.coefs.
  #--------------------------------------------------------
  predict.list &lt;- predict(ozone.fit, 
    newdata = data.frame(temperature = c(70, 90)), se.fit = TRUE) 

  predict.list
  #$fit
  #       1        2 
  #2.697810 4.101808 
  #
  #$se.fit
  #         1          2 
  #0.07134554 0.08921071 
  #
  #$df
  #[1] 114
  #
  #$residual.scale
  #[1] 0.5903046
  #
  #$n.coefs
  #[1] 2

 
  #----------

  #Continuing with the above example, create a scatterplot of 
  # cube-root ozone vs. temperature, and add the fitted line 
  # along with simultaneous 95% confidence bands.

  with(Air.df, 
    plot(temperature, ozone, xlab = "Temperature (degrees F)", 
      ylab = "Cube-Root Ozone (ppb)"))

  abline(ozone.fit, lwd = 3, col = "blue")

  new.temp &lt;- with(Air.df, 
    seq(min(temperature), max(temperature), length = 100))

  predict.list &lt;- predict(ozone.fit, 
    newdata = data.frame(temperature = new.temp), 
    se.fit = TRUE)

  ci.ozone &lt;- pointwise(predict.list, coverage = 0.95, 
    simultaneous = TRUE)

  lines(new.temp, ci.ozone$lower, lty = 2, lwd = 3, col = "magenta") 

  lines(new.temp, ci.ozone$upper, lty = 2, lwd = 3, col = "magenta") 

  title(main=paste("Scatterplot of Cube-Root Ozone vs. Temperature", 
    "with Fitted Line and Simultaneous 95% Confidence Bands", 
    sep="\n"))

  #----------

  # Clean up
  #---------
  rm(ozone.fit, predict.list, new.temp, ci.ozone)
  graphics.off()
</code></pre>


</div>