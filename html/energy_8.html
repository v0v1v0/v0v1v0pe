<div class="container">

<table style="width: 100%;"><tr>
<td>dcov.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Distance Covariance Test and Distance Correlation test</h2>

<h3>Description</h3>

<p>Distance covariance test and distance correlation test of multivariate independence.
Distance covariance and distance correlation are
multivariate measures of dependence.</p>


<h3>Usage</h3>

<pre><code class="language-R">dcov.test(x, y, index = 1.0, R = NULL)
dcor.test(x, y, index = 1.0, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data or distances of first sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> data or distances of second sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p> exponent on Euclidean distance, in (0,2]</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dcov.test</code> and <code>dcor.test</code> are nonparametric
tests of multivariate independence. The test decision is
obtained via permutation bootstrap, with <code>R</code> replicates.
</p>
<p>The sample sizes (number of rows) of the two samples must
agree, and samples must not contain missing values. 
</p>
<p>The <code>index</code> is an optional exponent on Euclidean distance.
Valid exponents for energy are in (0, 2) excluding 2. 
</p>
<p>Argument types supported are 
numeric data matrix, data.frame, or tibble, with observations in rows;
numeric vector; ordered or unordered factors. In case of unordered factors
a 0-1 distance matrix is computed.
</p>
<p>Optionally pre-computed distances can be input as class "dist" objects or as distance matrices. 
For data types of arguments,
distance matrices are computed internally. 
</p>
<p>The <code>dcov</code> test statistic is
<code class="reqn">n \mathcal V_n^2</code> where
<code class="reqn">\mathcal V_n(x,y)</code> = dcov(x,y),
which is based on interpoint Euclidean distances
<code class="reqn">\|x_{i}-x_{j}\|</code>. The <code>index</code>
is an optional exponent on Euclidean distance.
</p>
<p>Similarly, the <code>dcor</code> test statistic is based on the normalized
coefficient, the distance correlation. (See the manual page for <code>dcor</code>.)
</p>
<p>Distance correlation is a new measure of dependence between random
vectors introduced by Szekely, Rizzo, and Bakirov (2007).
For all distributions with finite first moments, distance
correlation <code class="reqn">\mathcal R</code> generalizes the idea of correlation in two
fundamental ways:
</p>
<p>(1) <code class="reqn">\mathcal R(X,Y)</code> is defined for <code class="reqn">X</code> and <code class="reqn">Y</code> in arbitrary dimension.
</p>
<p>(2) <code class="reqn">\mathcal R(X,Y)=0</code> characterizes independence of <code class="reqn">X</code> and
<code class="reqn">Y</code>.
</p>
<p>Characterization (2) also holds for powers of Euclidean distance <code class="reqn">\|x_i-x_j\|^s</code>, where <code class="reqn">0&lt;s&lt;2</code>, but (2) does not hold when <code class="reqn">s=2</code>.
</p>
<p>Distance correlation satisfies <code class="reqn">0 \le \mathcal R \le 1</code>, and
<code class="reqn">\mathcal R = 0</code> only if <code class="reqn">X</code> and <code class="reqn">Y</code> are independent. Distance
covariance <code class="reqn">\mathcal V</code> provides a new approach to the problem of
testing the joint independence of random vectors. The formal
definitions of the population coefficients <code class="reqn">\mathcal V</code> and
<code class="reqn">\mathcal R</code> are given in (SRB 2007). The definitions of the
empirical coefficients are given in the energy
<code>dcov</code> topic.
</p>
<p>For all values of the index in (0,2), under independence
the asymptotic distribution of <code class="reqn">n\mathcal V_n^2</code>
is a quadratic form of centered Gaussian random variables,
with coefficients that depend on the distributions of <code class="reqn">X</code> and <code class="reqn">Y</code>. For the general problem of testing independence when the distributions of <code class="reqn">X</code> and <code class="reqn">Y</code> are unknown, the test based on <code class="reqn">n\mathcal V^2_n</code> can be implemented as a permutation test. See (SRB 2007) for
theoretical properties of the test, including statistical consistency.
</p>


<h3>Value</h3>

<p><code>dcov.test</code> or <code>dcor.test</code> returns a list with class <code>htest</code> containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>     method</code></td>
<td>
<p> description of test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>  statistic</code></td>
<td>
<p> observed value of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>   estimate</code></td>
<td>
<p> dCov(x,y) or dCor(x,y)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>  estimates</code></td>
<td>
<p> a vector: [dCov(x,y), dCor(x,y), dVar(x), dVar(y)]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>  condition</code></td>
<td>
<p> logical, permutation test applied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> replicates</code></td>
<td>
<p> replicates of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>    p.value</code></td>
<td>
<p> approximate p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>          n</code></td>
<td>
<p> sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>  data.name</code></td>
<td>
<p> description of data</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For the dcov test of independence,
the distance covariance test statistic is the V-statistic
<code class="reqn">\mathrm{n\, dCov^2} = n \mathcal{V}_n^2</code> (not dCov). 
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Szekely, G.J., Rizzo, M.L., and Bakirov, N.K. (2007),
Measuring and Testing Dependence by Correlation of Distances,
<em>Annals of Statistics</em>, Vol. 35 No. 6, pp. 2769-2794.
<br><a href="https://doi.org/10.1214/009053607000000505">doi:10.1214/009053607000000505</a>
</p>
<p>Szekely, G.J. and Rizzo, M.L. (2009),
Brownian Distance Covariance,
<em>Annals of Applied Statistics</em>,
Vol. 3, No. 4, 1236-1265.
<br><a href="https://doi.org/10.1214/09-AOAS312">doi:10.1214/09-AOAS312</a>
</p>
<p>Szekely, G.J. and Rizzo, M.L. (2009),
Rejoinder: Brownian Distance Covariance,
<em>Annals of Applied Statistics</em>, Vol. 3, No. 4, 1303-1308.
</p>


<h3>See Also</h3>

<p><code>dcov </code> <code>dcor </code> 
<code>pdcov.test</code> <code>pdcor.test</code> 
<code>dcor.ttest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> x &lt;- iris[1:50, 1:4]
 y &lt;- iris[51:100, 1:4]
 set.seed(1)
 dcor.test(dist(x), dist(y), R=199)
 set.seed(1)
 dcov.test(x, y, R=199)
</code></pre>


</div>