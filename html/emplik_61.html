<div class="container">

<table style="width: 100%;"><tr>
<td>WRegEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the casewise weighted regression estimator for AFT model</h2>

<h3>Description</h3>

<p>For the AFT model, this function computes the case weighted estimator of
beta. Either the least squares estimator or the regression quantile estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WRegEst(x, y, delta, LS=TRUE, tau=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of size N by q. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of length N, containing the censored responses. Usually 
the log of the original observed failure times. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a vector (length N) of either 1's or 0's. 
d=1 means y is uncensored;
d=0 means y is right censored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LS</code></td>
<td>
<p>a logical value. If TRUE then the function will 
return the least squares estimator. If FALSE then the
function will return the quantile regression estimator,
with the quantile level specified by tau. </p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a scalar, between 0 and 1. The quantile to be used in
quantile regression. If tau=0.5 then it is the median regression. If LS=TRUE, then it is ignored.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Due to the readily available minimizer, we only provide least squares
and quantile regression here. However, in the companion testing function
<code>WRegTest </code> the user can supply a self defined psi function,
corresponding to the general M-estimation in the regression modeling.
(since there is no minimization needed).
</p>
<p>The estimator is the minimizer of
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{i=1}^n w_i \rho (Y_i - X_i b) </code>
</p>

<p>Assuming a correlation model
</p>
<p style="text-align: center;"><code class="reqn"> Y_i = X_i \beta + \sigma(X_i) \epsilon_i </code>
</p>
<p>,
where <code class="reqn">\rho( )</code> is either the square or the absolute value function.
</p>


<h3>Value</h3>

<p>The estimator <code class="reqn"> \hat \beta</code>.
</p>


<h3>Author(s)</h3>

<p> Mai Zhou. </p>


<h3>References</h3>

<p>Zhou, M.; Bathke, A. and Kim, M. (2012). 
Empirical likelihood analysis of the
Heteroscastic Accelerated Failure Time model. 
<em>Statistica Sinica</em>, <b>22</b>, 295-316.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(smallcell)
WRegEst(x=cbind(1,smallcell[,1],smallcell[,2]), 
        y=smallcell[,3], delta=smallcell[,4]) 
####################################################
#### you should get         x1         x2         x3
####                 -59.22126 -488.41306   16.03259
####################################################
WRegEst(x=cbind(1,smallcell[,1],smallcell[,2]), 
        y=log10(smallcell[,3]), delta=smallcell[,4], LS=FALSE) 
########################################################
#### you should get      
####     [1]     2.603342985  -0.263000044  0.003836832
########################################################
</code></pre>


</div>