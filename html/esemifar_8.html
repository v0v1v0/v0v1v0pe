<div class="container">

<table style="width: 100%;"><tr>
<td>esemifar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>esemifar: A package for data-driven nonparametric estimation of the trend and
its derivatives in equidistant time series.</h2>

<h3>Description</h3>

<p>The <code>esemifar</code> package provides different applicable functions for the
estimation of the trend or its derivatives in equidistant time series.
The main functions include an automated bandwidth selection method for time
series with long-memory errors.
</p>
<p>An alternative method to create an ESEMIFAR estimation object
stitched together from a nonparametric and a parametric part.
</p>


<h3>Usage</h3>

<pre><code class="language-R">esemifar(nonpar_model, par_model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nonpar_model</code></td>
<td>
<p>an estimation object returned by <code>gsmooth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_model</code></td>
<td>
<p>an estimation object returned by <code>fracdiff</code> fitted
to the residuals of <code>nonpar_model</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main function <code>tsmoothlm</code> already returns a fully estimated
ESEMIFAR model. In some instances, alternative specifications of the
nonparametric and parametric model parts are needed, for which
<code>tsmoothlm</code> with its automated estimation algorithm does not
provide sufficient flexibility. Therefore, this function allows to stitch
together a nonparametric model part returned by <code>gsmooth</code> and
a FARIMA part for the residuals obtained via <code>fracdiff</code>.
The resulting object can then be used for forecasting.
</p>


<h3>Value</h3>

<p>The function returns a list of class <code>"esemifar"</code> with elements
<code>nonpar_model</code> and <code>par_model</code>.
</p>


<h3>Functions (version 1.0.0)</h3>

<p>The <code>esemifar</code> functions are either meant for calculating nonparametric
estimates of the trend of a time series or its derivatives.
</p>
<p><code>dsmoothlm</code> is a function that calculates the derivatives of the
trend after obtaining the optimal bandwidth by an iterative plug-in
algorithm.
</p>
<p><code>tsmoothlm</code> is the central function of the package. It allows
the user to conduct a local polynomial regression of the trend based on
an optimal bandwidth that is obtained by an iterative plug-in algorithm.
Inflation rate (and other factors) can be manually
and individually adjusted as arguments in the function
(see also: <code>tsmoothlm</code>).
</p>
<p><code>critMatlm</code> is a quick tool for the calculation of information criteria
for FARIMA(<code class="reqn">p,d,q</code>) models with different order combinations <code class="reqn">p</code> and
<code class="reqn">q</code>. The function returns a matrix with the obtained values of the
selected criterion for the different combinations of <code class="reqn">p</code> and <code class="reqn">q</code>
(see also: <code>critMatlm</code>).
</p>


<h3>Datasets</h3>

<p>The package includes two datasets: <code>airLDN</code> (see also:
<code>airLDN</code>) with daily observations of individual air pollutants
from 2014 to 2020 and <code>gdpG7</code> (see also: <code>gdpG7</code>) that has
data concerning the quarterly G7 GDP between Q1 1962 and Q4 2019.
</p>


<h3>License</h3>

<p>The package is distributed under the General Public License v3
([GPL-3](https://tldrlegal.com/license/gnu-general-public-license-v3-(gpl-3))).
</p>


<h3>Author(s)</h3>


<ul>
<li>
<p> Yuanhua Feng (Department of Economics, Paderborn University), <br>
Author of the Algorithms <br>
Website: <a href="https://wiwi.uni-paderborn.de/en/dep4/feng/">https://wiwi.uni-paderborn.de/en/dep4/feng/</a>
</p>
</li>
<li>
<p> Sebastian Letmathe, <br>
Author (and Original Package Creator and Maintainer)
</p>
</li>
<li>
<p> Dominik Schulz, <br>
Author and Current Package Creator and Maintainer
</p>
</li>
</ul>
<ul><li>
<p> Dominik Schulz (Scientific Employee) (Department of Economics,
Paderborn University), <br>
Author
</p>
</li></ul>
<h3>References</h3>

<p>Beran, J. and Y. Feng (2002a). Iterative plug-in algorithms for SEMIFAR
models - definition, convergence, and asymptotic properties. Journal of
Computational and Graphical Statistics 11(3), 690-713.
</p>
<p>Beran, J. and Feng, Y. (2002b). Local polynomial fitting with long-memory,
short-memory and antipersistent errors. Annals of the Institute of
Statistical Mathematics, 54(2), 291-311.
</p>
<p>Beran, J. and Feng, Y. (2002c). SEMIFAR models - a semiparametric approach
to modelling trends, longrange dependence and nonstationarity. Computational
Statistics &amp; Data Analysis 40(2), 393-419.
</p>
<p>Letmathe, S., Beran, J. and Feng, Y. (2023). An extended exponential SEMIFAR
model with application in R. Communications in Statistics - Theory and Methods:
1-13.
</p>


<h3>Examples</h3>

<pre><code class="language-R">lgdp &lt;- log(esemifar::gdpG7$gdp)
nonpar &lt;- gsmooth(lgdp, b = 0.15)
res &lt;- nonpar$res
par &lt;- fracdiff::fracdiff(res, nar = 1, nma = 1)
model &lt;- esemifar(nonpar_model = nonpar, par_model = par)
model

</code></pre>


</div>