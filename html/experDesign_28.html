<div class="container">

<table style="width: 100%;"><tr>
<td>replicates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Design a batch experiment with experimental controls</h2>

<h3>Description</h3>

<p>To ensure that the batches are comparable some samples are processed in each
batch. This function allows to take into account that effect.
It uses the most different samples as controls as defined with <code>extreme_cases()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">replicates(pheno, size_subset, controls, omit = NULL, iterations = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>Data.frame with the sample information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_subset</code></td>
<td>
<p>Numeric value of the number of sample per batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controls</code></td>
<td>
<p>The numeric value of the amount of technical controls per
batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>Name of the columns of the <code>pheno</code> that will be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Numeric value of iterations that will be performed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To control for variance replicates are important, see for example <a href="https://www.nature.com/articles/nmeth.3091">https://www.nature.com/articles/nmeth.3091</a>.
</p>


<h3>Value</h3>

<p>A index with some samples duplicated in the batches.
</p>


<h3>See Also</h3>

<p><code>design()</code>, <code>extreme_cases()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">samples &lt;- data.frame(L = letters[1:25], Age = rnorm(25),
                      type = sample(LETTERS[1:5], 25, TRUE))
index &lt;- replicates(samples, 5, controls = 2, omit = "L", iterations = 10)
head(index)
</code></pre>


</div>