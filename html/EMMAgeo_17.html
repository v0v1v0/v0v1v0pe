<div class="container">

<table style="width: 100%;"><tr>
<td>model.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model all possible end-member scenarios</h2>

<h3>Description</h3>

<p>This function takes a definition of weight transformation 
limits and corresponding minimum and maximum numbers of end-members to 
model all end-member scenarios in accordance with these parameters. Based 
on the output the user can decide on robust end-members.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model.EM(X, q, l, classunits, plot = TRUE, col.q = TRUE, bw, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>Numeric</code> matrix, input data set with m samples (rows) 
and n variables (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p><code>Numeric</code> matrix, definitions of minimum and maximum number
of end-members (cf. <code>get.q()</code>), required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p><code>Numeric</code> vector, weight transformation limit values, 
corresponding to the matrix q, required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classunits</code></td>
<td>
<p><code>Numeric</code> vector, optional class units 
(e.g. micrometers or phi-units) of the same length as columns of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>Logical</code> scalar, option to plot the results (cf. 
details for explanations), default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.q</code></td>
<td>
<p><code>Logical</code> scalar, option to colour end-member loadings by
the number of end-members which were used to create the model realisation,
default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p><code>Numeric</code> scalar, optional manual setting of the kde 
bandwidth. By default, bw is calculated as 1 percent of the number of 
grain-size classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot output is an overlay of several data. The coloured lines in the 
background are end-member loadings (number noted in the plot title), 
resulting from all possible model scenarios. If <code>col.q == TRUE</code> they
are coloured according to the number of end-members with which the model 
was generated. This colour scheme allows to depict end-members that emerge
for model realisations with specific number of end-members. The thick 
black line is a kernel density estimate curve, generated from the mode 
positions of all end-members. The kernel bandwidth is set to 1 percent of 
the number of grain-size classes of the input data set, which gave useful
results for most of our test data sets. The cumulaitve dot-line-plot is a
further visualisation of end-member mode positions. The function is a 
modified wrapper function for the function <code>test.robustness()</code>.
</p>


<h3>Value</h3>

<p><code>List</code> object with all modelled end-members, each described by
input parameters, mode position, quality measures and value distributions.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze, Elisabeth Dietze
</p>


<h3>References</h3>

<p>Dietze E, Hartmann K, Diekmann B, IJmker J, Lehmkuhl F, Opitz S,
Stauch G, Wuennemann B, Borchers A. 2012. An end-member algorithm for
deciphering modern detrital processes from lake sediments of Lake Donggi
Cona, NE Tibetan Plateau, China. Sedimentary Geology 243-244: 169-180.
</p>


<h3>See Also</h3>

<p><code>EMMA</code>, <code>test.l.max</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load example data set
data(example_X)

## define input parameters
l &lt;- c(0, 0.05, 0.10)
q &lt;- cbind(c(2, 2, 3), c(5, 6, 4))

## infer l-vector
em_pot &lt;- model.EM(X = X, q = q, l = l)

</code></pre>


</div>