<div class="container">

<table style="width: 100%;"><tr>
<td>dirichlet_tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a Dirichlet-tree for modelling ranked ballots</h2>

<h3>Description</h3>

<p>A <code>dirichlet_tree</code> object represents a Dirichlet-tree distribution
on ballots. By specifying the tree structure for the ranked ballots,
the Dirichlet-tree is initialized with the same prior structure described by
Everest et al. (2022). There are
methods provided for observing data (to obtain a posterior distribution)
along with methods to sample election outcomes and sets of ballots from
the posterior predictive distribution.
</p>


<h3>Format</h3>

<p>An <code>R6Class</code> generator object.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>a0</code></dt>
<dd>
<p>Gets or sets the <code>a0</code> parameter for the Dirichlet-tree.</p>
</dd>
<dt><code>min_depth</code></dt>
<dd>
<p>Gets or sets the <code>min_depth</code> parameter for the Dirichlet-tree.</p>
</dd>
<dt><code>max_depth</code></dt>
<dd>
<p>Gets or sets the <code>max_depth</code> parameter for the
Dirichlet-tree.</p>
</dd>
<dt><code>vd</code></dt>
<dd>
<p>Gets or sets the <code>vd</code> parameter for the Dirichlet-tree.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-dirichlet_tree-new"><code>dirichlet_tree$new()</code></a>
</p>
</li>
<li> <p><a href="#method-dirichlet_tree-print"><code>dirichlet_tree$print()</code></a>
</p>
</li>
<li> <p><a href="#method-dirichlet_tree-update"><code>dirichlet_tree$update()</code></a>
</p>
</li>
<li> <p><a href="#method-dirichlet_tree-reset"><code>dirichlet_tree$reset()</code></a>
</p>
</li>
<li> <p><a href="#method-dirichlet_tree-sample_posterior"><code>dirichlet_tree$sample_posterior()</code></a>
</p>
</li>
<li> <p><a href="#method-dirichlet_tree-sample_predictive"><code>dirichlet_tree$sample_predictive()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-dirichlet_tree-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new <code>dirichlet_tree</code> prior distribution with the specified
tree structure. See Everest et al. (2022)
for further details.
</p>


<h5>Usage</h5>

<div class="r"><pre>dirichlet_tree$new(
  candidates,
  min_depth = 0,
  max_depth = length(candidates) - 1,
  a0 = 1,
  vd = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>candidates</code></dt>
<dd>
<p>A character vector, with each element (must be unique) representing a
single candidate.</p>
</dd>
<dt><code>min_depth</code></dt>
<dd>
<p>The minimum number of candidates which must be specified for a valid
ballot in the election.</p>
</dd>
<dt><code>max_depth</code></dt>
<dd>
<p>The maximum number of candidates which can be specified for a valid
ballot in the election.</p>
</dd>
<dt><code>a0</code></dt>
<dd>
<p>The prior parameter for the distribution.</p>
</dd>
<dt><code>vd</code></dt>
<dd>
<p>A flag which, when <code>TRUE</code>, employs a parameter structure which
reduces to a regular Dirichlet distribution as described by
Everest et al. (2022).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new <code>dirichlet_tree</code> prior.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dtree &lt;- dirichlet_tree$new(candidates = LETTERS, a0 = 1., min_depth = 1)

</pre>
</div>


<hr>
<a id="method-dirichlet_tree-print"></a>



<h4>Method <code>print()</code>
</h4>

<p><code>print</code> shows some details of the distribution and its parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>dirichlet_tree$print()</pre></div>



<h5>Returns</h5>

<p>The <code>dirichlet_tree</code> object.
</p>


<hr>
<a id="method-dirichlet_tree-update"></a>



<h4>Method <code>update()</code>
</h4>

<p>Updates the <code>dirichlet_tree</code> object with observations of ballots.
This updates the parameter structure of the tree to yield the posterior
Dirichlet-tree, as described in
Everest et al. (2022).
</p>


<h5>Usage</h5>

<div class="r"><pre>dirichlet_tree$update(ballots)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>ballots</code></dt>
<dd>
<p>A set of ballots of class 'prefio::preferences' or
'prefio::aggregated_preferences' to observe. The ballots should not contain
any ties, but they may be incomplete.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The <code>dirichlet_tree</code> object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dirichlet_tree$new(
  candidates = LETTERS[1:3]
)$update(ballots)

</pre>
</div>


<hr>
<a id="method-dirichlet_tree-reset"></a>



<h4>Method <code>reset()</code>
</h4>

<p>Resets the <code>dirichlet_tree</code> observations to revert the
parameter structure back to the originally specified prior.
</p>


<h5>Usage</h5>

<div class="r"><pre>dirichlet_tree$reset()</pre></div>



<h5>Returns</h5>

<p>The <code>dirichlet_tree</code> object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dtree &lt;- dirichlet_tree$new(
  candidates = LETTERS
)$update(ballots)
print(dtree)
dtree$reset()
print(dtree)

</pre>
</div>


<hr>
<a id="method-dirichlet_tree-sample_posterior"></a>



<h4>Method <code>sample_posterior()</code>
</h4>

<p>Draws sets of ballots from independent realizations of the Dirichlet-tree
posterior, then determines the probability for each candidate being
elected by aggregating the results of the social choice function. See
Everest et al. (2022) for details.
</p>


<h5>Usage</h5>

<div class="r"><pre>dirichlet_tree$sample_posterior(
  n_elections,
  n_ballots,
  n_winners = 1,
  replace = FALSE,
  n_threads = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>n_elections</code></dt>
<dd>
<p>An integer representing the number of elections to generate. A higher
number yields higher precision in the output probabilities.</p>
</dd>
<dt><code>n_ballots</code></dt>
<dd>
<p>An integer representing the total number of ballots cast in the election.</p>
</dd>
<dt><code>n_winners</code></dt>
<dd>
<p>The number of candidates elected in each election.</p>
</dd>
<dt><code>replace</code></dt>
<dd>
<p>A boolean indicating whether or not we should replace our sample in the
monte-carlo step, drawing the full set of election ballots from the posterior</p>
</dd>
<dt><code>n_threads</code></dt>
<dd>
<p>The maximum number of threads for the process. The default value of
<code>NULL</code> will default to 2 threads. <code>Inf</code> will default to the maximum
available, and any value greater than or equal to the maximum available will
result in the maximum available.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A numeric vector containing the probabilities for each candidate
being elected.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dirichlet_tree$new(
  candidates = LETTERS,
  a0 = 1.,
  min_depth = 3,
  max_depth = 6,
  vd = FALSE
)$update(
  ballots
)$sample_posterior(
  n_elections = 10,
  n_ballots = 10
)

</pre>
</div>


<hr>
<a id="method-dirichlet_tree-sample_predictive"></a>



<h4>Method <code>sample_predictive()</code>
</h4>

<p><code>sample_predictive</code> draws ballots from a multinomial distribution
with ballot probabilities obtained from a single realization of the
Dirichlet-tree posterior on the ranked ballots. See
Everest et al. (2022) for details.
</p>


<h5>Usage</h5>

<div class="r"><pre>dirichlet_tree$sample_predictive(n_ballots)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>n_ballots</code></dt>
<dd>
<p>An integer representing the total number of ballots cast in the election.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A <code>prefio::preferences</code> object containing <code>n_ballots</code>
ballots drawn from a single realisation of the posterior Dirichlet-tree.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dirichlet_tree$new(
  candidates = LETTERS,
  a0 = 1.,
  min_depth = 3,
  max_depth = 6,
  vd = FALSE
)$update(
  ballots
)$sample_predictive(
  n_ballots = 10
)

</pre>
</div>




<h3>References</h3>

<p>Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2023).
“Ballot-Polling Audits of Instant-Runoff Voting Elections with a Dirichlet-Tree Model.”
In <em>Computer Security. ESORICS 2022 International Workshops</em>, 525–540.
ISBN 978-3-031-25460-4..
</p>
<p>Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2022).
“Auditing Ranked Voting Elections with Dirichlet-Tree Models: First Steps.”
<a href="https://doi.org/10.15157/diss/021">doi:10.15157/diss/021</a>..
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `dirichlet_tree$new`
## ------------------------------------------------

dtree &lt;- dirichlet_tree$new(candidates = LETTERS, a0 = 1., min_depth = 1)


## ------------------------------------------------
## Method `dirichlet_tree$update`
## ------------------------------------------------

ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dirichlet_tree$new(
  candidates = LETTERS[1:3]
)$update(ballots)


## ------------------------------------------------
## Method `dirichlet_tree$reset`
## ------------------------------------------------

ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dtree &lt;- dirichlet_tree$new(
  candidates = LETTERS
)$update(ballots)
print(dtree)
dtree$reset()
print(dtree)


## ------------------------------------------------
## Method `dirichlet_tree$sample_posterior`
## ------------------------------------------------

ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dirichlet_tree$new(
  candidates = LETTERS,
  a0 = 1.,
  min_depth = 3,
  max_depth = 6,
  vd = FALSE
)$update(
  ballots
)$sample_posterior(
  n_elections = 10,
  n_ballots = 10
)


## ------------------------------------------------
## Method `dirichlet_tree$sample_predictive`
## ------------------------------------------------

ballots &lt;- prefio::preferences(
  t(c(1, 2, 3)),
  format = "ranking",
  item_names = LETTERS[1:3]
)
dirichlet_tree$new(
  candidates = LETTERS,
  a0 = 1.,
  min_depth = 3,
  max_depth = 6,
  vd = FALSE
)$update(
  ballots
)$sample_predictive(
  n_ballots = 10
)

</code></pre>


</div>