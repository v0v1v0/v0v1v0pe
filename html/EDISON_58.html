<div class="container">

<table style="width: 100%;"><tr>
<td>simulateNetwork</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate network and simulate data.</h2>

<h3>Description</h3>

<p>This function generates a random network with structure changepoints (or
takes one as input) and simulated data from it using a regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulateNetwork(l = 100, min_phase_length = 10, k_bar = 10, q = 10,
  lambda_2 = 0.45, noise = 0.25, net = NULL, lambda_3 = 2,
  spacing = 0, gauss_weights = FALSE, same = FALSE,
  changes = "sequential", fixed = FALSE, cps = NULL, saveFile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Length of the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_phase_length</code></td>
<td>
<p>Minimum segment length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_bar</code></td>
<td>
<p>Maximum number of changepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Number of nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_2</code></td>
<td>
<p>Average number of parents for each node in the network
(parameter for a Poisson distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>Standard deviation of the Gaussian observation noise. Can be
constant, or segment specific (in which case the number of changepoints
needs to be fixed and the noise needs to be a vector of the same length).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>net</code></td>
<td>
<p>Input network, can be <code>NULL</code> if a new network should be
generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_3</code></td>
<td>
<p>Average number of structure changes between two segments
(parameter for a Poisson distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacing</code></td>
<td>
<p><code>1</code> if segments are equally spaced, <code>0</code> if they are
spaced randomly (subject to the constraints of min_phase_length).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gauss_weights</code></td>
<td>
<p><code>1</code> if edge weights in the network are drawn from
N(0, 1), <code>0</code> if they are fixed to be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same</code></td>
<td>
<p><code>1</code> if the networks should all be the same (no changes),
<code>0</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changes</code></td>
<td>
<p><code>'sequential'</code> if the changes happen sequentially (i.e.
changes at segment i are applied to segment i-1), <code>'hierarchical'</code> if
the changes happen with respect to a hypernetwork (i.e. changes at segment i
are applied to segment 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p><code>T</code> if the changepoint locations are fixed, <code>F</code> if
they should be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cps</code></td>
<td>
<p>Changepoint locations (if they are fixed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveFile</code></td>
<td>
<p>If not <code>NULL</code>, indicates the filename for saving the
output in R data format.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>sim_data</code></td>
<td>
<p>A matrix of length NumNodes by
NumTimepoints containing the simulated data from the regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Changepoint vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of changepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>
<p>The network, a list of length NumSegs, where each element is
a NumNodes by NumNodes matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>The standard deviation of the
applied Gaussian noise.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Frank Dondelinger
</p>


<h3>See Also</h3>

<p><code>generateNetwork</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate random network and simulate data with default parameters
dataset = simulateNetwork()

# Generate random network and simulate data with an average of 
# 1 change per node among network segments
dataset = simulateNetwork(lambda_3=1)

# Generate random network and simulate data with an average of 
# 1 change per node among network segments and standard deviation 
# of the Gaussian observation noise 0.5
dataset = simulateNetwork(lambda_3=1, noise=0.5)

# Generate random network with default parameters
network = generateNetwork()

# Simulate data using generated network
dataset = simulateNetwork(net=network)

# Generate random network with 4 changepoints and 15 nodes, 
# with changepoints distributed over a timeseries of length 50
network = generateNetwork(l=50, q=15, fixed=TRUE, k_bar=4)

# Simulate data of length 50 using generated network
dataset = simulateNetwork(net=network)

</code></pre>


</div>