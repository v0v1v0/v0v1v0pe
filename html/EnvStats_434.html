<div class="container">

<table style="width: 100%;"><tr>
<td>predIntNormTestPower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Probability That at Least One Future Observation Falls Outside a Prediction Interval for a Normal Distribution
</h2>

<h3>Description</h3>

<p>Compute the probability that at least one out of <code class="reqn">k</code> future observations 
(or means) falls outside a prediction interval for <code class="reqn">k</code> future observations 
(or means) for a normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntNormTestPower(n, df = n - 1, n.mean = 1, k = 1, delta.over.sigma = 0, 
    pi.type = "upper", conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>vector of positive integers greater than 2 indicating the sample size upon which 
the prediction interval is based.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>vector of positive integers indicating the degrees of freedom associated with 
the sample size.  The default value is <code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mean</code></td>
<td>

<p>positive integer specifying the sample size associated with the future averages.  
The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all 
future averages must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>vector of positive integers specifying the number of future observations that the 
prediction interval should contain with confidence level <code>conf.level</code>.  The 
default value is <code>k=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.over.sigma</code></td>
<td>

<p>vector of numbers indicating the ratio <code class="reqn">\Delta/\sigma</code>.  The quantity 
<code class="reqn">\Delta</code> (delta) denotes the difference between the mean of the population 
that was sampled to construct the prediction interval, and the mean of the 
population that will be sampled to produce the future observations.  The quantity 
<code class="reqn">\sigma</code> (sigma) denotes the population standard deviation for both populations.  
See the DETAILS section below for more information.  The default value is 
<code>delta.over.sigma=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>pi.type="upper"</code> (the default), and 
<code>pi.type="lower"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>numeric vector of values between 0 and 1 indicating the confidence level of the 
prediction interval.  The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>What is a Prediction Interval?</em> <br>
A prediction interval for some population is an interval on the real line 
constructed so that it will contain <code class="reqn">k</code> future observations or averages 
from that population with some specified probability <code class="reqn">(1-\alpha)100\%</code>, 
where <code class="reqn">0 &lt; \alpha &lt; 1</code> and <code class="reqn">k</code> is some pre-specified positive integer.  
The quantity <code class="reqn">(1-\alpha)100\%</code> is call the confidence coefficient or 
confidence level associated with the prediction interval.  The function 
<code>predIntNorm</code> computes a standard prediction interval based on a 
sample from a normal distribution.  The function <code>predIntNormTestPower</code> 
computes the probability that at least one out of <code class="reqn">k</code> future observations or 
averages will <b>not</b> be contained in the prediction interval, 
where the population mean for the future observations is allowed to differ from 
the population mean for the observations used to construct the prediction interval.
<br></p>
<p><em>The Form of a Prediction Interval</em> <br>
Let <code class="reqn">\underline{x} = x_1, x_2, \ldots, x_n</code> denote a vector of <code class="reqn">n</code> 
observations from a normal distribution with parameters 
<code>mean=</code><code class="reqn">\mu</code> and <code>sd=</code><code class="reqn">\sigma</code>.  Also, let <code class="reqn">m</code> denote the 
sample size associated with the <code class="reqn">k</code> future averages (i.e., <code>n.mean=</code><code class="reqn">m</code>).  
When <code class="reqn">m=1</code>, each average is really just a single observation, so in the rest of 
this help file the term “averages” will replace the phrase 
“observations or averages”.
</p>
<p>For a normal distribution, the form of a two-sided <code class="reqn">(1-\alpha)100\%</code> prediction 
interval is: 
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)</code>
</p>
 
<p>where <code class="reqn">\bar{x}</code> denotes the sample mean:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)</code>
</p>

<p><code class="reqn">s</code> denotes the sample standard deviation:
</p>
<p style="text-align: center;"><code class="reqn">s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)</code>
</p>

<p>and <code class="reqn">K</code> denotes a constant that depends on the sample size <code class="reqn">n</code>, the 
confidence level, the number of future averages <code class="reqn">k</code>, and the 
sample size associated with the future averages, <code class="reqn">m</code>.  Do not confuse the 
constant <code class="reqn">K</code> (uppercase K) with the number of future averages <code class="reqn">k</code> 
(lowercase k).  The symbol <code class="reqn">K</code> is used here to be consistent with the 
notation used for tolerance intervals (see <code>tolIntNorm</code>).  
</p>
<p>Similarly, the form of a one-sided lower prediction interval is: 
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)</code>
</p>
 
<p>and the form of a one-sided upper prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)</code>
</p>
 
<p>but <code class="reqn">K</code> differs for one-sided versus two-sided prediction intervals.  
The derivation of the constant <code class="reqn">K</code> is explained in the help file for 
<code>predIntNormK</code>.
<br></p>
<p><em>Computing Power</em> <br>
The "power" of the prediction interval is defined as the probability that at 
least one out of the <code class="reqn">k</code> future observations or averages 
will <b>not</b> be contained in the prediction interval, where the population mean 
for the future observations is allowed to differ from the population mean for the 
observations used to construct the prediction interval.  The probability <code class="reqn">p</code> 
that all <code class="reqn">k</code> future observations will be contained in a one-sided upper 
prediction interval (<code>pi.type="upper"</code>) is given in Equation (6) of the help 
file for 
<code>predIntNormSimultaneousK</code>, where <code class="reqn">k=m</code> and <code class="reqn">r=1</code>:
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) [\frac{v^{k-1}}{B(k, 1)}] dv \;\;\;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">T(x; \nu, \delta)</code> denotes the cdf of the 
non-central Student's t-distribution with parameters 
<code>df=</code><code class="reqn">\nu</code> and <code>ncp=</code><code class="reqn">\delta</code> evaluated at <code class="reqn">x</code>; 
<code class="reqn">\Phi(x)</code> denotes the cdf of the standard normal distribution 
evaluated at <code class="reqn">x</code>; and <code class="reqn">B(\nu, \omega)</code> denotes the value of the 
beta function with parameters <code>a=</code><code class="reqn">\nu</code> and 
<code>b=</code><code class="reqn">\omega</code>.
</p>
<p>The quantity <code class="reqn">\Delta</code> (upper case delta) denotes the difference between the 
mean of the population that was sampled to construct the prediction interval, and 
the mean of the population that will be sampled to produce the future observations.  
The quantity <code class="reqn">\sigma</code> (sigma) denotes the population standard deviation of both 
of these populations.  Usually you assume <code class="reqn">\Delta=0</code> unless you are interested 
in computing the power of the rule to detect a change in means between the 
populations, as we are here.
</p>
<p>If we are interested in using averages instead of single observations, with 
<code class="reqn">w \ge 1</code> (i.e., <code>n.mean</code><code class="reqn">\ge 1</code>), the first 
term in the integral in Equation (6) that involves the cdf of the 
non-central Student's t-distribution becomes:
</p>
<p style="text-align: center;"><code class="reqn">T(\sqrt{n}K; n-1, \frac{\sqrt{n}}{\sqrt{w}}[\Phi^{-1}(v) + \frac{\sqrt{w}\Delta}{\sigma}]) \;\;\;\;\;\; (7)</code>
</p>

<p>For a given confidence level <code class="reqn">(1-\alpha)100\%</code>, the power of the rule to detect 
a change in means is simply given by:
</p>
<p style="text-align: center;"><code class="reqn">Power = 1 - p \;\;\;\;\;\; (8)</code>
</p>

<p>where <code class="reqn">p</code> is defined in Equation (6) above using the value of <code class="reqn">K</code> that 
corresponds to <code class="reqn">\Delta/\sigma = 0</code>.  Thus, when the argument 
<code>delta.over.sigma=0</code>, the value of <code class="reqn">p</code> is <code class="reqn">1-\alpha</code> and the power is 
simply <code class="reqn">\alpha 100\%</code>.  As <code>delta.over.sigma</code> increases above 0, the power 
increases.
</p>
<p>When <code>pi.type="lower"</code>, the same value of <code>K</code> is used as when 
<code>pi.type="upper"</code>, but Equation (4) is used to construct the prediction 
interval.  Thus, the power increases as <code>delta.over.sigma</code> decreases below 0.
</p>


<h3>Value</h3>

<p>vector of values between 0 and 1 equal to the probability that at least one of 
<code class="reqn">k</code> future observations or averages will fall outside the prediction interval.
</p>


<h3>Note</h3>

<p>See the help files for <code>predIntNorm</code> and 
<code>predIntNormSimultaneous</code>.
</p>
<p>In the course of designing a sampling program, an environmental scientist may wish 
to determine the relationship between sample size, significance level, power, and 
scaled difference if one of the objectives of the sampling program is to determine 
whether two distributions differ from each other.  The functions 
<code>predIntNormTestPower</code> and <code>plotPredIntNormTestPowerCurve</code> can be 
used to investigate these relationships for the case of normally-distributed 
observations.  In the case of a simple shift between the two means, the test based 
on a prediction interval is not as powerful as the two-sample t-test.  However, the 
test based on a prediction interval is more efficient at detecting a shift in the 
tail.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help files for <code>predIntNorm</code> and 
<code>predIntNormSimultaneous</code>.
</p>


<h3>See Also</h3>

<p><code>predIntNorm</code>, <code>predIntNormK</code>, 
<code>plotPredIntNormTestPowerCurve</code>, <code>predIntNormSimultaneous</code>, 
<code>predIntNormSimultaneousK</code>, 
<code>predIntNormSimultaneousTestPower</code>, Prediction Intervals, 
Normal.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Show how the power increases as delta.over.sigma increases.  
  # Assume a 95% upper prediction interval.

  predIntNormTestPower(n = 4, delta.over.sigma = 0:2) 
  #[1] 0.0500000 0.1743014 0.3990892

  #----------

  # Look at how the power increases with sample size for a one-sided upper 
  # prediction interval with k=3, delta.over.sigma=2, and a confidence level 
  # of 95%.

  predIntNormTestPower(n = c(4, 8), k = 3, delta.over.sigma = 2) 
  #[1] 0.3578250 0.5752113

  #----------

  # Show how the power for an upper 95% prediction limit increases as the 
  # number of future observations k increases.  Here, we'll use n=20 and 
  # delta.over.sigma=1.

  predIntNormTestPower(n = 20, k = 1:3, delta.over.sigma = 1) 
  #[1] 0.2408527 0.2751074 0.2936486
</code></pre>


</div>