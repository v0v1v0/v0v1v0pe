<div class="container">

<table style="width: 100%;"><tr>
<td>Gstat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>G Statistic and Chi-Squared Statistic</h2>

<h3>Description</h3>

<p><code>Gstat</code> computes the G statistic. 
</p>
<p><code>chi2stat</code> computes the Pearson chi-squared statistic. 
</p>
<p><code>Gstatindep</code> computes the G statistic between the empirical observed joint distribution and the product distribution obtained from its marginals.
</p>
<p><code>chi2statindep</code> computes the Pearson chi-squared statistic of independence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Gstat(y, freqs, unit=c("log", "log2", "log10"))
chi2stat(y, freqs, unit=c("log", "log2", "log10"))
Gstatindep(y2d, unit=c("log", "log2", "log10"))
chi2statindep(y2d, unit=c("log", "log2", "log10"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed vector of counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>vector of expected frequencies (probability mass function). Alternatively, counts may be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2d</code></td>
<td>
<p>matrix of counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>the unit in which entropy is measured. 
The default is "nats" (natural units). For 
computing entropy in "bits" set <code>unit="log2"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observed counts in <code>y</code> and <code>y2d</code> are used to determine the total sample size.
</p>
<p>The G statistic equals two times the sample size times the KL divergence between
empirical observed frequencies and expected frequencies. 
</p>
<p>The Pearson chi-squared statistic equals sample size times chi-squared divergence
between empirical observed frequencies and expected frequencies.   It is a quadratic
approximation of the G statistic.
</p>
<p>The G statistic between the empirical observed joint distribution and the product
distribution obtained from its marginals is equal to  two times the sample size times mutual
information.  
</p>
<p>The Pearson chi-squared statistic of independence equals the Pearson chi-squared statistic 
between the empirical observed joint distribution and the product distribution obtained from 
its marginals.  It is a quadratic approximation of the corresponding G statistic.
</p>
<p>The G statistic and the Pearson chi-squared statistic are asymptotically chi-squared distributed 
which allows to compute corresponding p-values.
</p>


<h3>Value</h3>

<p>A list containing the test statistic <code>stat</code>, the degree of freedom <code>df</code> used to calculate the
p-value <code>pval</code>.
</p>


<h3>Author(s)</h3>

<p>Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>See Also</h3>

<p><code>KL.plugin</code>,
<code>chi2.plugin</code>, <code>mi.plugin</code>, <code>chi2indep.plugin</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load entropy library 
library("entropy")

## one discrete random variable

# observed counts in each class
y = c(4, 2, 3, 1, 6, 4)
n = sum(y) # 20

# expected frequencies and counts
freqs.expected = c(0.10, 0.15, 0.35, 0.05, 0.20, 0.15)
y.expected = n*freqs.expected


# G statistic (with p-value) 
Gstat(y, freqs.expected) # from expected frequencies
Gstat(y, y.expected) # alternatively from expected counts

# G statistic computed from empirical KL divergence
2*n*KL.empirical(y, y.expected)


## Pearson chi-squared statistic (with p-value) 
# this can be viewed an approximation of the G statistic
chi2stat(y, freqs.expected) # from expected frequencies
chi2stat(y, y.expected) # alternatively from expected counts

# computed from empirical chi-squared divergence
n*chi2.empirical(y, y.expected)

# compare with built-in function
chisq.test(y, p = freqs.expected) 


## joint distribution of two discrete random variables

# contingency table with counts
y.mat = matrix(c(4, 5, 1, 2, 4, 4), ncol = 2)  # 3x2 example matrix of counts
n.mat = sum(y.mat) # 20


# G statistic between empirical observed joint distribution and product distribution
Gstatindep( y.mat )

# computed from empirical mutual information
2*n.mat*mi.empirical(y.mat)


# Pearson chi-squared statistic of independence
chi2statindep( y.mat )

# computed from empirical chi-square divergence
n.mat*chi2indep.empirical(y.mat)

# compare with built-in function
chisq.test(y.mat) 

</code></pre>


</div>