<div class="container">

<table style="width: 100%;"><tr>
<td>eptdecomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decomposition of a signal by Ensemble Patch Transform</h2>

<h3>Description</h3>

<p>This function decomposes a signal into frequency component and residue of ensemble patch transform by sifting process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eptdecomp(tindex = NULL, signal, type = "rectangle", tau, 
    process = c("average", "average"), pquantile = c(0, 1), equantile = c(0, 1), 
    gamma = 1, boundary = "symmetric", stoprule = "type1", 
    tol = sd(signal, na.rm = TRUE) * 0.1^2, maxiter = 10, check = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tindex</code></td>
<td>
<p>time index at which a signal is observed. When it is <code>NULL</code>, the signal is supposed to be equally spaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>a set of data or a signal observed at time <code>tindex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>patch type of <code>"rectangle"</code> or <code>"oval"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a size parameter for ensemble patch transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process</code></td>
<td>
<p>specifies transform types for patch and ensemble processes:
<code>process[1]</code> for patch process and process[2] for ensemble process.
Each process has options of <code>"average"</code>, <code>"median"</code>, or <code>"envelope"</code>.
Note that when <code>process[1]</code> is <code>"average"</code> or <code>"median"</code>, <code>process[2]</code> must be <code>"average"</code> or <code>"median"</code>. 
When <code>process[1]</code> is <code>"envelope"</code>, lower and upper envelopes are obtained by <code class="reqn">\code{pquantile[1]} \times 100 \%</code>-quantile 
and <code class="reqn">\code{pquantile[2]} \times 100 \%</code>-quantile of patches, respectively.
When <code>process[2]</code> is <code>"envelope"</code>, ensemble lower and upper envelopes are obtained as 
<code class="reqn">\code{equantile[1]} \times 100 \%</code>-quantile and <code class="reqn">\code{equantile[2]} \times 100 \%</code>-quantile  
of lower and upper envelopes of shifted patches, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pquantile</code></td>
<td>
<p>quantiles for lower and upper envelopes of patch transform. When it is <code>c(0, 1)</code>,
minimum and maximum of a patch are used for lower and upper envelopes, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equantile</code></td>
<td>
<p>quantiles for lower and upper envelopes of ensemble patch transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>controls the amount of envelope magnitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>specifies boundary condition from <code>"symmetric"</code>, <code>"periodic"</code> or <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stoprule</code></td>
<td>
<p>stopping rule of sifting. The <code>type1</code> stopping rule indicates that absolute values of ept (ensemble patch transform) component must be less than the user-specified tolerance level.
The <code>type2</code> is the stopping rule that the difference between ept components at the current and previous iterative steps must be less than the user-specified tolerance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for stopping rule of sifting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of sifting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>specifies whether the sifting process is displayed. When <code>check = TRUE</code>, ept component and residue for each sifting step are displayed. If <code>check=TRUE</code>, click the plotting area to start the next step.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function decomposes a signal into frequency component and residue of ensemble patch transform by sifting process for a size parameter.
</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>eptcomp</code></td>
<td>
<p>matrix of ept (ensemble patch transform) component at each sifting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FC</code></td>
<td>
<p>frequency component of ensemble patch transform by sifting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residue</code></td>
<td>
<p>residue of ensemble patch transform by sifting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>a list of input parameters of <code>type</code>, <code>tau</code>, <code>process</code>, <code>pquantile</code>, <code>equantile</code>, <code>gamma</code>, <code>boundary</code>, 
and output parameter <code>niter</code>, the number of sifting.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>eptransf</code>, <code>meptransf</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### example : composite of two components having different frequencies
ndata &lt;- 1000 
tindex &lt;- seq(0, 1, length=ndata)
comp1 &lt;- cos(90*pi*tindex)
comp2 &lt;- cos(10*pi*tindex)
f &lt;- comp1 + comp2 

op &lt;- par(mfrow=c(3,1), mar=c(2,2,2,1))
plot(tindex, f, main="a signal", xlab="", ylab="", type='l')
abline(h=0, lty=3)
plot(tindex, comp1, main="high-frequency component", xlab="", ylab="", type='l')
abline(h=0, lty=3)
plot(tindex, comp2, main="low-frequency component", xlab="", ylab="", type='l')
abline(h=0, lty=3)

#### Decomposition by Ensemble Patch Transform  
outdecom &lt;- eptdecomp(signal=f, tau=21, process=c("envelope", "average"), pquantile=c(0, 1))

#### Decomposition result
plot(tindex, f, main="a signal", xlab="", ylab="", type='l'); abline(h=0, lty=3)
plot(outdecom$FC, type='l', main="", xlab="", ylab=""); abline(h=0, lty=3)
title(paste0("high-frequency component, tau=", 21))
lines(comp1, col="red", lty=2, lwd=0.5)
plot(outdecom$residue, type="l", main="", xlab="", ylab=""); abline(h=0, lty=3)
title(paste0("low-frequency component, tau=", 21))
lines(comp2, col="red", lty=2, lwd=0.5)
par(op)
</code></pre>


</div>