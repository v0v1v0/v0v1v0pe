<div class="container">

<table style="width: 100%;"><tr>
<td>HPDregionplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot highest posterior density region</h2>

<h3>Description</h3>

<p>Given a sample from a posterior distribution (an <code>mcmc</code> object
from the <code>coda</code> package),
plot the bivariate region of highest marginal posterior density
for two variables, using <code>kde2d</code> from <code>MASS</code> to calculate
a bivariate density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HPDregionplot(x, vars = 1:2, h, n = 50, lump = TRUE, prob = 0.95, xlab =
NULL, ylab = NULL, lims=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>mcmc</code> or <code>mcmc.list</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>which variables to plot: numeric or character vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth of 2D kernel smoother (previous default value was <code>c(1,1)</code>,
which worked poorly with some plots with very small scales;
if not specified, defaults to values in <code>kde2d</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of points at which to evaluate the density grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lump</code></td>
<td>
<p>if <code>x</code> is an <code>mcmc.list</code> object, lump the
chains together for plotting?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lims</code></td>
<td>
<p>limits, specified as (x.lower,x.upper,y.lower,y.upper)
(passed to <code>kde2d</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to <code>contour</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses <code>kde2d</code> to calculate a bivariate density, then
normalizes the plot and calculates the contour corresponding
to a contained volume of <code>prob</code> of the total volume under
the surface (a two-dimensional Bayesian credible region).
</p>


<h3>Value</h3>

<p>Draws a plot on the current device, and
invisibly returns a list of contour lines (<code>contourLines</code>).
</p>


<h3>Note</h3>

<p>Accuracy may be limited by density estimation; you may
need to tinker with <code>h</code> and <code>n</code> (see <code>kde2d</code>
in the <code>MASS</code> package).
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>See Also</h3>

<p><code>HPDinterval</code> in the <code>coda</code> package,
<code>ellipse</code> package</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
library(coda)
z &lt;- mvrnorm(1000,mu=c(0,0),Sigma=matrix(c(2,1,1,2),nrow=2))
z2 &lt;- mvrnorm(1000,mu=c(0,0),Sigma=matrix(c(2,1,1,2),nrow=2))
HPDregionplot(mcmc(z))
HPDregionplot(mcmc.list(mcmc(z),mcmc(z2)))
</code></pre>


</div>