<div class="container">

<table style="width: 100%;"><tr>
<td>simconf.mixture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simultaneous confidence regions for Gaussian mixture models</h2>

<h3>Description</h3>

<p><code>simconf.mixture</code> is used for calculating simultaneous confidence regions
for Gaussian mixture models. The distribution for the process <code class="reqn">x</code> is assumed to be
</p>
<p style="text-align: center;"><code class="reqn">\pi(x) = \sum_{k=1}^K w_k N(\mu_k, Q_k^{-1}).</code>
</p>

<p>The function returns upper and lower bounds <code class="reqn">a</code> and <code class="reqn">b</code> such that
<code class="reqn">P(a&lt;x&lt;b) = 1-\alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simconf.mixture(
  alpha,
  mu,
  Q,
  w,
  ind,
  n.iter = 10000,
  vars,
  verbose = 0,
  max.threads = 0,
  seed = NULL,
  mix.samp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Error probability for the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A list with the <code>k</code> expectation vectors <code class="reqn">\mu_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>A list with the <code>k</code> precision matrices <code class="reqn">Q_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A vector with the weights for each class in the mixture.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Indices of the nodes that should be analyzed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Number or iterations in the MC sampler that is used for
approximating probabilities. The default value is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>A list with precomputed marginal variances for each class (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to TRUE for verbose mode (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.threads</code></td>
<td>
<p>Decides the number of threads the program can use. Set to 0
for using the maximum number of threads allowed by the system (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix.samp</code></td>
<td>
<p>If TRUE, the MC integration is done by directly sampling the mixture,
otherwise sequential integration is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>simconf</code> for details.
</p>


<h3>Value</h3>

<p>An object of class "excurobj" with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a </code></td>
<td>
<p>The lower bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b </code></td>
<td>
<p>The upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.marginal </code></td>
<td>
<p>The lower bound for pointwise confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.marginal </code></td>
<td>
<p>The upper bound for pointwise confidence bands.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a>
</p>


<h3>References</h3>

<p>Bolin et al. (2015) <em>Statistical prediction of global sea level
from global temperature</em>, Statistica Sinica, vol 25, pp 351-367.
</p>
<p>Bolin, D. and Lindgren, F. (2018), <em>Calculating Probabilistic Excursion Sets and Related Quantities Using excursions</em>, Journal of Statistical Software, vol 86, no 1, pp 1-20.
</p>


<h3>See Also</h3>

<p><code>simconf</code>, <code>simconf.inla</code>, <code>simconf.mc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 11
K &lt;- 3
mu &lt;- Q &lt;- list()
for (k in 1:K) {
  mu[[k]] &lt;- k * 0.1 + seq(-5, 5, length = n)
  Q[[k]] &lt;- Matrix(toeplitz(c(1, -0.1, rep(0, n - 2))))
}
## calculate the confidence region
conf &lt;- simconf.mixture(0.05, mu, Q, w = rep(1 / 3, 3), max.threads = 2)

## Plot the region
plot(mu[[1]], type = "l")
lines(mu[[2]])
lines(mu[[3]])
lines(conf$a, col = 2)
lines(conf$b, col = 2)
</code></pre>


</div>