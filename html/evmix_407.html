<div class="container">

<table style="width: 100%;"><tr>
<td>tcplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter Threshold Stability Plots</h2>

<h3>Description</h3>

<p>Plots the MLE of the GPD parameters against threshold
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcplot(data, tlim = NULL, nt = min(100, length(data)),
  p.or.n = FALSE, alpha = 0.05, ylim.xi = NULL, ylim.sigmau = NULL,
  legend.loc = "bottomright", try.thresh = quantile(data, 0.9, na.rm =
  TRUE), ...)

tshapeplot(data, tlim = NULL, nt = min(100, length(data)),
  p.or.n = FALSE, alpha = 0.05, ylim = NULL,
  legend.loc = "bottomright", try.thresh = quantile(data, 0.9, na.rm =
  TRUE), main = "Shape Threshold Stability Plot", xlab = "Threshold u",
  ylab = "Shape Parameter", ...)

tscaleplot(data, tlim = NULL, nt = min(100, length(data)),
  p.or.n = FALSE, alpha = 0.05, ylim = NULL,
  legend.loc = "bottomright", try.thresh = quantile(data, 0.9, na.rm =
  TRUE), main = "Modified Scale Threshold Stability Plot",
  xlab = "Threshold u", ylab = "Modified Scale Parameter", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>vector of sample data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>vector of (lower, upper) limits of range of threshold
to plot MRL, or <code>NULL</code> to use default values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>
<p>number of thresholds for which to evaluate MRL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.or.n</code></td>
<td>
<p>logical, should tail fraction (<code>FALSE</code>) or number of
exceedances (<code>TRUE</code>) be given on upper x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level over range (0, 1), or <code>NULL</code> for no CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim.xi</code></td>
<td>
<p>y-axis limits for shape parameter or <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim.sigmau</code></td>
<td>
<p>y-axis limits for scale parameter or <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.loc</code></td>
<td>
<p>location of legend (see <code>legend</code>) or <code>NULL</code> for no legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try.thresh</code></td>
<td>
<p>vector of thresholds to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the plotting functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-axis limits or <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The MLE of the (modified) GPD scale and shape (xi) parameters are
plotted against a set of possible thresholds. If the GPD is a suitable
model for a threshold <code class="reqn">u</code> then for all higher thresholds <code class="reqn">v &gt; u</code> it
will also be suitable, with the shape and modified scale being
constant. Known as the threshold stability plots (Coles, 2001). The modified
scale parameter is <code class="reqn">\sigma_u - u\xi</code>.
</p>
<p>In practice there is sample uncertainty in the parameter estimates, which
must be taken into account when choosing a threshold.
</p>
<p>The usual asymptotic Wald confidence intervals are shown based on the
observed information matrix to measure this uncertainty. The sampling density
of the Wald normal approximation is shown by a greyscale image, where lighter
greys indicate low density.
</p>
<p>A pre-chosen threshold (or more than one) can be given in <code>try.thresh</code>.
The GPD is fitted to the excesses using maximum likelihood estimation. The
estimated parameters are shown as a horizontal line which is solid above this
threshold, for which they should be the same if the GPD is a good model (upto sample uncertainty).
The threshold should always be chosen to be as low as possible to reduce sample uncertainty.
Therefore, below the pre-chosen threshold, where the GPD should not be a good model, the line
is dashed and the parameter estimates should now deviate from the dashed line
(otherwise a lower threshold could be used).
If no threshold limits are provided <code>tlim = NULL</code> then the lowest threshold is set
to be just below the median data point and the maximum threshold is set to the 11th
largest datapoint. This is a slightly lower order statistic compared to that used in the MRL plot 
<code>mrlplot</code> function to account for the fact the maximum likelihood
estimation is likely to be unreliable with 10 or fewer datapoints.
</p>
<p>The range of permitted thresholds is just below the minimum datapoint and the
second largest value. If there are less unique values of data within the threshold
range than the number of threshold evalations requested, then instead of a sequence
of thresholds they will be set to each unique datapoint, i.e. MLE will only be applied
where there is data.
</p>
<p>The missing (<code>NA</code> and <code>NaN</code>) and non-finite values are ignored.
</p>
<p>The lower x-axis is the threshold and an upper axis either gives the number of 
exceedances (<code>p.or.n = FALSE</code>) or proportion of excess (<code>p.or.n = TRUE</code>).
Note that unlike the <code>gpd</code> related functions the missing values are ignored, so
do not add to the lower tail fraction. But ignoring the missing values is consistent
with all the other mixture model functions.
</p>


<h3>Value</h3>

<p><code>tshapeplot</code> and 
<code>tscaleplot</code> produces the threshold stability plot for the
shape and scale parameter respectively. They also returns a matrix containing columns of
the threshold, number of exceedances, MLE shape/scale
and their standard devation and <code class="reqn">100(1 - \alpha)\%</code> Wald confidence interval if requested. Where the
observed information matrix is not obtainable the standard deviation and confidence intervals
are <code>NA</code>. For the <code>tscaleplot</code> the modified scale quantities
are also provided. <code>tcplot</code> produces both plots on one graph and
outputs a merged dataframe of results.
</p>


<h3>Acknowledgments</h3>

<p>Based on the threshold stability plot function <code>tcplot</code> in the 
<code>evd</code> package for which Stuart Coles' and Alec Stephenson's 
contributions are gratefully acknowledged.
They are designed to have similar syntax and functionality to simplify the transition for users of these packages.
</p>


<h3>Note</h3>

<p>If the user specifies the threshold range, the thresholds above the sixth
largest are dropped. A warning message is given if any thresholds have at most 10
exceedances, in which case the maximum likelihood estimation is unreliable. If there
are less than 10 exceedances of the minimum threshold then the function will stop.
</p>
<p>By default, no legend is included when using <code>tcplot</code> to get
both threshold stability plots.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Yang Hu and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>Coles S.G. (2004). An Introduction to the Statistical Modelling of Extreme Values.
Springer-Verlag: London.
</p>


<h3>See Also</h3>

<p><code>mrlplot</code> and <code>tcplot</code> from 
<code>evd</code> library
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x = rnorm(1000)
tcplot(x)
tshapeplot(x, tlim = c(0, 2))
tscaleplot(x, tlim = c(0, 2), try.thresh = c(0.5, 1, 1.5))
tcplot(x, tlim = c(0, 2), try.thresh = c(0.5, 1, 1.5))

## End(Not run)
</code></pre>


</div>