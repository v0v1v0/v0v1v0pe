<div class="container">

<table style="width: 100%;"><tr>
<td>etas.starting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Guess starting values of ETAS parameters (beta-version). Only from package version 1.2.0</h2>

<h3>Description</h3>

<p><code>etas.starting</code> is a simple function to give starting values of the 7 ETAS parameters for the function <code>etasclass</code>.
</p>
<p>It gives only rough approximations, based on some assumptions, intended to give only the order of magnitude of each parameter (but should be better than nothing).
Returns a list with starting values. In the present version user can give manually the output of this function in the input of <code>etasclass</code>. Otherwise, the function is called by <code>etasclass</code> at first steps, to supply initial values to start estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">etas.starting(cat.orig,
magn.threshold=2.5,
p.start=1,
gamma.start=0.5,
q.start=2,
betacov.start=.7,
longlat.to.km=TRUE,
sectoday=FALSE,
onlytime=FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cat.orig</code></td>
<td>

<p>An  earthquake catalog, possibly an object of class <code>eqcat</code>, or however a <code>data.frame</code> with variables of names <code>time</code>,  <code>lat</code>,   <code>long</code>,  <code>z</code>,     <code>magn1</code>. No missing values are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magn.threshold</code></td>
<td>

<p>Threshold magnitude (only events with a magnitude at least <code>magn.threshold</code> will be used).  Default value = 2.5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.start</code></td>
<td>
<p>Parameter 4  of the ETAS model; the exponent of the Omori law for temporal decay rate of aftershocks; see details. Default value = 1.0.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.start</code></td>
<td>
<p>Parameter 5 (<code class="reqn">\gamma</code>) of the ETAS model; together with  <code>a</code> is related to the efficiency of an event of given magnitude 
in generating aftershocks; see details. Default value = 0.5.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.start</code></td>
<td>
<p>Parameter 7 of the ETAS model; parameter related to the spatial influence of the
mainshock; see details. Default value = 2.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betacov.start</code></td>
<td>
<p>coefficient of the covariate (as default the magnitude). Default value = 0.7.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sectoday</code></td>
<td>
<p> if <code>TRUE</code>, then <code>time</code> variable of <code>cat.orig</code> is converted from seconds to days.  Default value = <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat.to.km</code></td>
<td>
<p> if <code>TRUE</code>, then <code>long</code> and <code>lat</code> variables of <code>cat.orig</code> are treated as geographical coordinates and converted to kilometers.  Default value = <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlytime</code></td>
<td>
<p>if <code>TRUE</code>  then a time process is fitted to data , regardless to space location (in this case <code>is.backconstant</code> is set to <code>TRUE</code> and <code>declustering</code>, <code>flp</code> are set to <code>FALSE</code>). Default value = <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is a beta-version of a very crude method to give 
starting values for the seven parameters of an ETAS  (Epidemic type aftershock sequences) model
for the description of the seismicity of a space-time region. 
These starting values can be used as input for the function <code>etasclass</code> 
<code>sectoday</code> and <code> longlat.to.km</code> flags must the same that will be used in <code>etasclass</code>.
</p>
<p>In this first attempt to give starting values for the ETAS model, many approximations are used 
</p>
<p>It gives only rough approximation, based on some assumptions, intended to give only the order of magnitude of each parameter (but it should be better than nothing). It
returns a list with 7 starting values. With this beta-version user must give manually the output of this function in the input of <code>etasclass</code>. 
</p>
<p>The values of <code>p.start</code>,  <code>gamma.start</code> and  <code>q.start</code> must be however given by the user (we did not find anything reasonable). Default choices for <code>p</code> and <code>q</code> (<code>p.start=1</code>, <code>q.start=2</code>) are strongly reccomended.
</p>
<p><code>c</code> and <code>d</code> are estimated from the emprical distributions of time differences and space distances, respectively.
<code>mu</code> and <code>k0</code> are then estimated given the other starting values, solving the two ML equations, that is derivatives of the whole likelihood with respect to  <code>mu</code> and <code>k0</code> equated to zero. 
In the computation of the likelihood an approximation for the integral of the intensity function is used (quoted also in 
Schoenberg (2013)).
</p>


<h3>Value</h3>

<p>returns a list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu.start</code></td>
<td>
<p>guess value for <code>mu</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k0.start</code></td>
<td>
<p>guess value for <code>k0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.start</code></td>
<td>
<p>guess value for <code>c</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.start</code></td>
<td>
<p>guess value for <code>p</code> (the same as input value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.start</code></td>
<td>
<p>guess value for <code>gamma</code> (the same as input value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.start</code></td>
<td>
<p>guess value for <code>d</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.start</code></td>
<td>
<p>guess value for <code>q</code> (the same as input value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat.to.km</code></td>
<td>
<p><code>longlat.to.km</code> (the same as input value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sectoday</code></td>
<td>
<p><code>sectoday</code> (the same as input value)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The optimization algorithm used in <code>etasclass</code>  depends on the choice of initial values. Some default guess choice is performed in the present beta-version of the function <code>etas.starting</code>. If convergence problem are experienced, a useful strategy can be to start  with an high magnitude threshold value <code class="reqn">m_0</code> (that is, with a smaller catalog with bigger earthquakes), and then using this first output as starting  guess for a running with a lower magnitude threshold value <code class="reqn">m_0</code>. 
In this trial executions avoid declustering (<code>declustering=FALSE</code>) or at least use a small value of <code>ndeclust</code>; small values of <code>iterlim</code> and <code>ntheta</code> can speed first executions.
</p>
<p>Quicker executions are obtained using smaller values of <code>iterlim</code> and <code>ntheta</code> in the input.
</p>
<p>Also a first execution with <code>is.backconstant = TRUE</code>, to fit a first approximation model with constant background, can be useful.
</p>
<p>Some other useful information can be obtained estimating a pure time process, that can give a good guess at least for some  parameters, like  <code class="reqn">\mu, \kappa_0, c,p</code>.
</p>
<p>Input times are expected in days, and so final intensities are expected number of events per day. If input values are in seconds, then set <code>sectoday=TRUE</code>
</p>


<h3>Author(s)</h3>

<p>Marcello Chiodi, Giada Adelfio</p>


<h3>References</h3>

<p>Schoenberg, F. P. (2013).Facilitated Estimation of ETAS. <em>Bulletin of the Seismological Society of America</em>, Vol. 103, No. 1, pp. 601-605, February 2013, doi: 10.1785/0120120146
</p>


<h3>See Also</h3>

 <p><code>etasclass</code></p>


</div>