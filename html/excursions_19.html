<div class="container">

<table style="width: 100%;"><tr>
<td>simconf.inla</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simultaneous confidence regions for latent Gaussian models</h2>

<h3>Description</h3>

<p><code>simconf.inla</code> is used for calculating simultaneous confidence regions
for latent Gaussian models estimated using <code>INLA</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simconf.inla(
  result.inla,
  stack,
  name = NULL,
  tag = NULL,
  ind = NULL,
  alpha,
  method = "NI",
  n.iter = 10000,
  verbose = 0,
  link = FALSE,
  max.threads = 0,
  seed = NULL,
  inla.sample = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>result.inla</code></td>
<td>
<p>Result object from INLA call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stack</code></td>
<td>
<p>The stack object used in the INLA call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The name of the component for which to do the calculation. This
argument should only be used if a stack object is not provided, use the tag
argument otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag</code></td>
<td>
<p>The tag of the component in the stack for which to do the calculation.
This argument should only be used if a stack object is provided, use the name
argument otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>If only a part of a component should be used in the calculations, this
argument specifies the indices for that part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Error probability for the region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for handling the latent Gaussian structure:
</p>

<dl>
<dt>'EB' </dt>
<dd>
<p>Empirical Bayes (Gaussian approximation of posterior).</p>
</dd>
<dt>'NI' </dt>
<dd>
<p>Numerical integration (Calculation based on the Gaussian mixture
approximation of the posterior, as calculated by INLA).</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Number or iterations in the MC sampler that is used for approximating
probabilities. The default value is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to TRUE for verbose mode (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Transform output to the scale of the data using the link function as defined in
the model estimated with INLA (default FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.threads</code></td>
<td>
<p>Decides the number of threads the program can use. Set to 0 for
using the maximum number of threads allowed by the system (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inla.sample</code></td>
<td>
<p>Set to TRUE if inla.posterior.sample should be used for the MC
integration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>simconf</code> for details.
</p>


<h3>Value</h3>

<p>An object of class "excurobj" with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a </code></td>
<td>
<p>The lower bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b </code></td>
<td>
<p>The upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.marginal </code></td>
<td>
<p>The lower bound for pointwise confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.marginal </code></td>
<td>
<p>The upper bound for pointwise confidence bands.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function requires the <code>INLA</code> package, which is not a CRAN package.
See <a href="https://www.r-inla.org/download-install">https://www.r-inla.org/download-install</a> for easy installation instructions.
</p>


<h3>Author(s)</h3>

<p>David Bolin <a href="mailto:davidbolin@gmail.com">davidbolin@gmail.com</a>
</p>


<h3>References</h3>

<p>Bolin et al. (2015) <em>Statistical prediction of global sea level
from global temperature</em>, Statistica Sinica, vol 25, pp 351-367.
</p>
<p>Bolin, D. and Lindgren, F. (2018), <em>Calculating Probabilistic Excursion Sets and Related Quantities Using excursions</em>, Journal of Statistical Software, vol 86, no 1, pp 1-20.
</p>


<h3>See Also</h3>

<p><code>simconf</code>, <code>simconf.mc</code>, <code>simconf.mixture</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
if (require.nowarnings("INLA")) {
  n &lt;- 10
  x &lt;- seq(0, 6, length.out = n)
  y &lt;- sin(x) + rnorm(n)
  mu &lt;- 1:n
  result &lt;- inla(y ~ 1 + f(mu, model = "rw2"),
    data = list(y = y, mu = mu), verbose = FALSE,
    control.compute = list(
      config = TRUE,
      return.marginals.predictor = TRUE
    ),
    num.threads = "1:1"
  )

  res &lt;- simconf.inla(result, name = "mu", alpha = 0.05, max.threads = 1)

  plot(result$summary.random$mu$mean, ylim = c(-2, 2))
  lines(res$a)
  lines(res$b)
  lines(res$a.marginal, col = "2")
  lines(res$b.marginal, col = "2")
}

## End(Not run)

</code></pre>


</div>