<div class="container">

<table style="width: 100%;"><tr>
<td>dgaps_imt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Information matrix test under the <code class="reqn">D</code>-gaps model</h2>

<h3>Description</h3>

<p>Performs an information matrix test (IMT) to diagnose misspecification of
the <code class="reqn">D</code>-gaps model of Holesovsky and Fusek (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgaps_imt(data, u, D = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code>split_by_NAs</code> is
used to divide the data into sequences of non-missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u, D</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of extreme value
thresholds applied to data.  <code>D</code> is a vector of values of the
left-censoring parameter <code class="reqn">D</code>, as defined in Holesovsky and Fusek
(2020). See <code>dgaps</code>.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations. See <code>dgaps</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The general approach follows Suveges and Davison (2010).
The <code class="reqn">D</code>-gaps IMT is performed a over grid of all
combinations of threshold and <code class="reqn">D</code> in the vectors <code>u</code>
and <code>D</code>.  If the estimate of <code class="reqn">\theta</code> is 0 then the
IMT statistic, and its associated <code class="reqn">p</code>-value is <code>NA</code>.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("dgaps_imt", "exdex")</code>
containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>imt </code></td>
<td>
<p>A <code>length(u)</code> by <code>length(D)</code> numeric matrix.
Column i contains, for <code class="reqn">D</code> = <code>D[i]</code>, the values of the
information matrix test statistic for the set of thresholds in
<code>u</code>.  The column names are the values in <code>D</code>.
The row names are the approximate empirical percentage quantile levels
of the thresholds in <code>u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>A <code>length(u)</code> by <code>length(D)</code> numeric matrix
containing the corresponding <code class="reqn">p</code>-values for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>A <code>length(u)</code> by <code>length(D)</code> numeric matrix
containing the corresponding estimates of <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u,D </code></td>
<td>
<p>The input <code>u</code> and <code>D</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
using censored distributions. Extremes 23, 197-213 (2020).
<a href="https://doi.org/10.1007/s10687-020-00374-3">doi:10.1007/s10687-020-00374-3</a>
</p>
<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code>dgaps</code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">D</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- dgaps_imt(newlyn, u = u, D = 1:5)

### S&amp;P 500 index

u &lt;- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- dgaps_imt(sp500, u = u, D = 1:5)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.98, by = 0.025), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt &lt;- dgaps_imt(cheeseboro, u = u, D = 1:5)

### Uccle July temperatures

probs &lt;- c(seq(0.7, 0.98, by = 0.025), 0.99)
u &lt;- quantile(uccle720m, probs = probs, na.rm = TRUE)
imt &lt;- dgaps_imt(uccle720m, u = u, D = 1:5)
</code></pre>


</div>