<div class="container">

<table style="width: 100%;"><tr>
<td>eptransf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ensemble Patch Transform of a Signal</h2>

<h3>Description</h3>

<p>This function performs ensemble patch transform of a signal for a size parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eptransf(tindex = NULL, signal, type = "rectangle", tau,
    process = c("average", "average"), pquantile = c(0, 1), equantile = c(0, 1), 
    gamma = 1, boundary = "symmetric") 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tindex</code></td>
<td>
<p>time index at which a signal is observed. When it is <code>NULL</code>, the signal is supposed to be equally spaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>a set of data or a signal observed at time <code>tindex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>patch type of <code>"rectangle"</code> or <code>"oval"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>size parameter for ensemble patch transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process</code></td>
<td>
<p>specifies transform types for patch and ensemble processes:
<code>process[1]</code> for patch process and process[2] for ensemble process.
Each process has options of <code>"average"</code>, <code>"median"</code>, or <code>"envelope"</code>.
Note that when <code>process[1]</code> is <code>"average"</code> or <code>"median"</code>, <code>process[2]</code> must be <code>"average"</code> or <code>"median"</code>. 
When <code>process[1]</code> is <code>"envelope"</code>, lower and upper envelopes are obtained by <code class="reqn">\code{pquantile[1]} \times 100 \%</code>-quantile 
and <code class="reqn">\code{pquantile[2]} \times 100 \%</code>-quantile of patches, respectively.
When <code>process[2]</code> is <code>"envelope"</code>, ensemble lower and upper envelopes are obtained as 
<code class="reqn">\code{equantile[1]} \times 100 \%</code>-quantile and <code class="reqn">\code{equantile[2]} \times 100 \%</code>-quantile  
of lower and upper envelopes of shifted patches, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pquantile</code></td>
<td>
<p>quantiles for lower and upper envelopes of patch transform. When it is <code>c(0, 1)</code>,
minimum and maximum of a patch are used for lower and upper envelopes, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equantile</code></td>
<td>
<p>quantiles for lower and upper envelopes of ensemble patch transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>controls the amount of envelope magnitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>specifies boundary condition from <code>"symmetric"</code>, <code>"periodic"</code> or <code>"none"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs ensemble patch transform of a signal for a size parameter <code>tau</code>, and 
produces statistics and envelopes for ensemble patch transform.
When <code>process[1]</code> is <code>"average"</code> or <code>"median"</code>, outputs related to envelopes are defined as <code>NULL</code>.
When <code>process[2]</code> is <code>"envelope"</code>, outputs, <code>pstat</code> and <code>Epstat</code>, are defined as <code>NULL</code>.
</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>tindex</code></td>
<td>
<p>time index at which a signal is observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>a set of data or a signal observed at time <code>tindex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pstat</code></td>
<td>
<p>centrality of patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Epstat</code></td>
<td>
<p>centrality of ensemble patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psd</code></td>
<td>
<p>standard deviation of patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Epsd</code></td>
<td>
<p>standard deviation of ensemble patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pL</code></td>
<td>
<p>lower envelope of patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pU</code></td>
<td>
<p>upper envelope of patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pM</code></td>
<td>
<p>mean envelope, <code>(pL + pU) / 2</code>, of patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pR</code></td>
<td>
<p>distance between lower and upper envelopes, <code>(pU - pL)</code>, of patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpL</code></td>
<td>
<p>lower envelope of ensemble patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpU</code></td>
<td>
<p>upper envelope of ensemble patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpM</code></td>
<td>
<p>mean envelope, <code>(EpL + EpU) / 2</code>, of ensemble patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EpR</code></td>
<td>
<p>distance between lower and upper envelopes, <code>(EpU - EpL)</code>, of ensemble patch transform for size parameter <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>a list of input parameters of <code>type</code>, <code>tau</code>, <code>process</code>, <code>pquantile</code>, <code>equantile</code>, <code>gamma</code>, and <code>boundary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevel</code></td>
<td>
<p>the number of size parameter <code>tau</code>. For <code>eptransf()</code> function, <code>nlevel</code> is 1.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>meptransf</code>, <code>eptdecomp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a doppler signal
n &lt;- 256
tindex &lt;- seq(0, 1, length=n)
j &lt;- 5
f &lt;- 10 * sqrt(tindex*(1-tindex)) * sin((2*pi*(1+2^((9-4*j)/5))) / (tindex+2^((9-4*j)/5)))
fnoise &lt;- f + 0.4 * rnorm(n)
  
#### Ensemble statistics
op &lt;- par(mfrow=c(5,3), mar=c(2,2,2,1))
layout(matrix(c(1, 1, 1, 2:13), 5, 3, byrow = TRUE))

plot(f, main="a doppler signal", xlab="", ylab="", type='l', ylim=range(fnoise))
points(fnoise); abline(h=0, lty=3)

#### Ensemble Patch Transform  
taus &lt;- c(5, 10, 20)

out &lt;- list()
for (i in 1:length(taus)) 
    out[[i]] &lt;- eptransf(signal=fnoise, tau=taus[i], process=c("average", "average"))
    
for (i in 1:length(taus)) {
    plot(out[[i]]$Epstat, type="l", xlab="", ylab="",
        main=paste0("ensemble average of patch mean, tau=", taus[i]))
    abline(h=0, lty=3)   
}

for (i in 1:length(taus)) 
    plot(out[[i]]$Epsd, type='l', xlab="", ylab="", 
         main=paste0("ensemble average of standard deviation, tau=", taus[i]))  

out2 &lt;- list()
for (i in 1:length(taus)) 
    out2[[i]] &lt;- eptransf(signal=fnoise, tau=taus[i], process=c("envelope", "average"))
    
for (i in 1:length(taus)) {
    plot(out2[[i]]$EpM, type="l", col="red", xlab="", ylab="", 
         ylim=range(c(out2[[i]]$EpU,out2[[i]]$EpL)),
         main=paste0("ensemble average of mean envelope, tau=", taus[i]))
    points(fnoise, cex=0.1)
    abline(h=0, lty=3); lines(out2[[i]]$EpU); lines(out2[[i]]$EpL)    
}

for (i in 1:length(taus))
    plot(out2[[i]]$EpR, type='l', xlab="", ylab="",
         main=paste0("ensemble average of envelope distance, tau=", taus[i]))
         
par(op)
</code></pre>


</div>