<div class="container">

<table style="width: 100%;"><tr>
<td>par.uncertainty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semi-variogram model parameter uncertainty</h2>

<h3>Description</h3>

<p>Standard error estimates for the nugget effect <code class="reqn">c_0</code>,  partial sill <code class="reqn">\sigma_0^2</code> and
shape parameter <code class="reqn">\phi</code> of a fitted exponential semi-variogram model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">par.uncertainty(
  vario.mod.output,
  mod.nr,
  par.est = NULL,
  data = NULL,
  max.dist = NULL,
  nbins = NULL,
  B = 1000,
  threshold.factor = 3,
  fit.method = 7,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vario.mod.output</code></td>
<td>
<p>An output of the <code>vario.mod</code> function containing the
information of the estimated exponential semi-variogram model of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.nr</code></td>
<td>
<p>The index number specifiying one of the exponential semi-variogram models
listed in the <code>vario.mod.ouput</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.est</code></td>
<td>
<p>A vector of length three containing the estimated parameters:
the nugget effect, the partial sill and the shape parameter
of the estimated exponential semi-variogram model.
It is automatically extracted from the <code>vario.mod.output</code>, if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame or matrix used to estimate the exponential semi-variogram of interest
containing the x-coordinates in meters in the first column,
the y-coordinates in meters in the second column and the data values in the third column.
It is automatically extracted from the vario.mod.output, if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>The maximal distance used for the estimation of the
exponential semi-variogram model of interest.
It is automatically extracted from the vario.mod.output, if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>The number of bins used for the estimation of the exponential
semi-variogram model of interest.
It is automatically extracted from the vario.mod.output, if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of bootstrap repetitions to generate a set of re-estimates
of each parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.factor</code></td>
<td>
<p>The threshold factor specifies the filter within the filtered
bootstrap method (see details). If not specified, a default value of 1.2 is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.method</code></td>
<td>
<p>The fit method used in the semivariogram estimation with the gstat package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>The number of cores used for bootstrapping, utilizing the parallel R-package. More than one core is not supported on windows systems.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Two alternative approaches for the input of the arguments:</strong>
</p>
<p>1. Provide the arguments
vario.mod.output (output object from vario.mod function) and
mod.nr (number of the model in the infotable).
</p>
<p>2. Provide the necessary information manually, namely
<code>par.est</code> (vector with estimated nugget, partial sill and shape parameters),
<code>data</code> (used to estimate the semi-variogram model parameters),
<code>max.dist</code> (semi-variogram parameter, numeric of length 1) and
<code>nbins</code> (semi-variogram parameter, numeric of length 1).
</p>
<p><strong>Filtered bootstrap method</strong>:
</p>
<p>For the semi-variogram model parameter estimation, the weighted least squares method is used
in order to make the numerical calculation possible for large sample sizes.
A filter is set up within the bootstrapping process to remove all
bootstrap estimates for which the estimation algorithm for the semi-variogram
model parameters did not converge.
</p>
<p>The parameter standard errors are estimated using the generalized bootstrap
method with check-based filtering.
The semi-variogram structure from the given model is used to remove the
spatial correlation structure within the original dataset. Then,
classical bootstrap sampling with replacement is used to generate B
bootstrap samples from the uncorrelated data.
Each bootstrap sample inherits the correlation structure back and is used to estimate
the nugget effect, partial sill and shape parameter for an exponential model.
Within the bootstrap repetitions, a test is performed to check whether
the estimated parameters lie within a probable range.
If the total variance of the bootstrap model exceeds the empirical variance
of the data times the treshold factor <code class="reqn">\tau</code>, ie.
</p>
<p style="text-align: center;"><code class="reqn">c_{0 b}^* + \sigma_{0 b}^{2*} &gt; \tau  \widehat{Var(\mathbf{z})}</code>
</p>

<p>for the bth bootstrap estimate, it is discarded. Otherwise, it is saved.
This procedure is performed until B bootstrap estimates have aggregated.
The empirical standard deviation calculated from the bootstrap estimates provides the
uncertainty estimate for each parameter.
</p>
<p>Details about the algorithm used to obtain standard errors for the parameters
of the exponential semi-variogram model are provided in Dyck and Sauzet (2023).
</p>
<p><strong>Reproducibility</strong>:
</p>
<p>In order to generate reproducible bootstrap results, set a random seed with the command <code>set.seed()</code>
before using the <code>par.uncertainty</code> function.
</p>


<h3>Value</h3>

<p>The function returns parameter estimates and corresponding standard error estimates
together and provides a list with the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>A vector of length 3 containing the estimated standard errors of the
nugget effect, the partial sill and the shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unc.table</code></td>
<td>
<p>A matrix containing the parameter estimates and the corresponding standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_estimates</code></td>
<td>
<p>A matrix with B rows containing the set of bootstrap re-estimates for each parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_estimate.mean</code></td>
<td>
<p>A vector containing the mean parameter estimates based on the set of bootstrap re-estimates for each parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The function call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Dyck J, Sauzet O (2023).
“Parameter uncertainty estimation for exponential semivariogram models: Two generalized bootstrap methods with check- and quantile-based filtering.”
Preprint.
<a href="https://arxiv.org/abs/2202.05752">https://arxiv.org/abs/2202.05752</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1
# Estimate semi-variogram models:
mods = vario.mod(data = birth, max.dist = c(1000,600), nbins = 13,
                 shinyresults = FALSE, windowplots = FALSE)
print(mods$infotable)

# Estimate the parameter standard errors:

se.mod1 = par.uncertainty(vario.mod.output = mods, mod.nr = 1, B = 1000)
se.mod2 = par.uncertainty(vario.mod.output = mods, mod.nr = 2, B = 1000)


## Example 2
# Type in the specifications of the estimated exponential semi-variogram manually:

se.mod1.man = par.uncertainty(par.est = c(1021.812, 225440.3, 0),
              data = birth, max.dist = 1000, nbins = 13, B = 1000)

se.mod2.man = par.uncertainty(par.est = c(121895.486, 107232.6, 63.68720),
              data = birth, max.dist = 600, nbins = 13, B = 1000)



</code></pre>


</div>