<div class="container">

<table style="width: 100%;"><tr>
<td>draw_Metropolis_multiple</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw Metropolis multiple</h2>

<h3>Description</h3>

<p>Function to sample the model with a Markov chain (single partition procedure).
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_Metropolis_multiple(
  theta,
  first.partitions,
  presence.tables,
  nodes,
  effects,
  objects,
  burnin,
  thining,
  num.steps,
  neighborhood = c(0.7, 0.3, 0),
  numgroups.allowed,
  numgroups.simulated,
  sizes.allowed,
  sizes.simulated,
  return.all.partitions = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.partitions</code></td>
<td>
<p>starting partition for the Markov chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>presence.tables</code></td>
<td>
<p>matrix indicating which actors were present for each observations (mandatory)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>node set (data frame)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>effects/sufficient statistics (list with a vector "names", and a vector "objects")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objects</code></td>
<td>
<p>objects used for statistics calculation (list with a vector "name", and a vector "object")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>integer for the number of burn-in steps before sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thining</code></td>
<td>
<p>integer for the number of thining steps between sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.steps</code></td>
<td>
<p>number of samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighborhood</code></td>
<td>
<p>= c(0.7,0.3,0), way of choosing partitions: probability vector (2 actors swap, merge/division, single actor move, single pair move, 2 pairs swap, 2 groups reshuffle)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numgroups.allowed</code></td>
<td>
<p>= NULL, # vector containing the number of groups allowed in the partition (now, it only works with vectors like num_min:num_max)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numgroups.simulated</code></td>
<td>
<p>= NULL, # vector containing the number of groups simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizes.allowed</code></td>
<td>
<p>= NULL,  vector of group sizes allowed in sampling (now, it only works for vectors like size_min:size_max)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizes.simulated</code></td>
<td>
<p>= NULL, vector of group sizes allowed in the Markov chain but not necessraily sampled (now, it only works for vectors like size_min:size_max)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.all.partitions</code></td>
<td>
<p>= FALSE, option to return the sampled partitions on top of their statistics (for GOF)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical: should intermediate results during the estimation be printed or not? Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list
</p>


<h3>Examples</h3>

<pre><code class="language-R"># define an arbitrary set of n = 6 nodes with attributes, and an arbitrary covariate matrix
n &lt;- 6 
nodes &lt;- data.frame(label = c("A","B","C","D","E","F"),
                    gender = c(1,1,2,1,2,2),
                    age = c(20,22,25,30,30,31)) 
friendship &lt;- matrix(c(0, 1, 1, 1, 0, 0,
                       1, 0, 0, 0, 1, 0,
                       1, 0, 0, 0, 1, 0,
                       1, 0, 0, 0, 0, 0,
                       0, 1, 1, 0, 0, 1,
                       0, 0, 0, 0, 1, 0), 6, 6, TRUE) 

# specify whether nodes are present at different points of time
presence.tables &lt;- matrix(c(1, 1, 1, 1, 1, 1,
                            0, 1, 1, 1, 1, 1,
                            1, 0, 1, 1, 1, 1), 6, 3)

# choose effects to be included in the estimated model
effects_multiple &lt;- list(names = c("num_groups","same","diff","tie","inertia_1"),
                objects = c("partitions","gender","age","friendship","partitions"),
                objects2 = c("","","","",""))
objects_multiple &lt;- list()
objects_multiple[[1]] &lt;- list(name = "friendship", object = friendship)

# set parameter values for each of these effects
parameters &lt;- c(-0.2,0.2,-0.1,0.5,1)

# set a starting point for the simulation
first.partitions &lt;- matrix(c(1, 1, 2, 2, 2, 3,
                             NA, 1, 1, 2, 2, 2,
                             1, NA, 2, 3, 3, 1), 6, 3) 


# generate the simulated sample
nsteps &lt;- 50
sample &lt;- draw_Metropolis_multiple(theta = parameters, 
                                   first.partitions = first.partitions,
                                   nodes = nodes, 
                                   presence.tables = presence.tables,
                                   effects = effects_multiple, 
                                   objects = objects_multiple, 
                                   burnin = 100, 
                                   thining = 100, 
                                   num.steps = nsteps, 
                                   neighborhood = c(0,1,0), 
                                   numgroups.allowed = 1:n,
                                   numgroups.simulated = 1:n,
                                   sizes.allowed = 1:n,
                                   sizes.simulated = 1:n,
                                   return.all.partitions = TRUE)


</code></pre>


</div>