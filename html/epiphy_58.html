<div class="container">

<table style="width: 100%;"><tr>
<td>BetaBinomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The beta-binomial distribution.</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
the beta-binomial distribution with parameters <code>size</code>, <code>prob</code>,
<code>theta</code>, <code>shape1</code>, <code>shape2</code>. This distribution corresponds to
an overdispersed binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbetabinom(x, size, prob, theta, shape1, shape2, log = FALSE)

pbetabinom(
  q,
  size,
  prob,
  theta,
  shape1,
  shape2,
  lower.tail = TRUE,
  log.p = FALSE
)

qbetabinom(
  p,
  size,
  prob,
  theta,
  shape1,
  shape2,
  lower.tail = TRUE,
  log.p = FALSE
)

rbetabinom(n, size, prob, theta, shape1, shape2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>Vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Number of trials.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Probability of success on each trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Aggregation parameter (theta = 1 / (shape1 + shape2)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1, shape2</code></td>
<td>
<p>Shape parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>Logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>Logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Be aware that in this implementation <code>theta</code> = 1 / (<code>shape1</code> +
<code>shape2</code>). <code>prob</code> and <code>theta</code>, or <code>shape1</code> and
<code>shape2</code> must be specified. if <code>theta</code> = 0, use *binom family
instead.
</p>


<h3>Value</h3>

<p><code>dbetabinom</code> gives the density, <code>pbetabinom</code> gives the distribution
function, <code>qbetabinom</code> gives the quantile function and <code>rbetabinom</code>
generates random deviates.
</p>


<h3>See Also</h3>

<p><code>dbetabinom</code> in the package <strong>emdbook</strong>
where the definition of theta is different.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute P(25 &lt; X &lt; 50) for X following the Beta-Binomial distribution
# with parameters size = 100, prob = 0.5 and theta = 0.35:
sum(dbetabinom(25:50, size = 100, prob = 0.5, theta = 0.35))

# When theta tends to 0, dbetabinom outputs tends to dbinom outputs:
sum(dbetabinom(25:50, size = 100, prob = 0.5, theta = 1e-7))
sum(dbetabinom(25:50, size = 100, shape1 = 1e7, shape2 = 1e7))
sum(dbinom(25:50, size = 100, prob = 0.5))

# Example of binomial and beta-binomial frequency distributions:
n   &lt;- 15
q   &lt;- 0:n
p1  &lt;- dbinom(q, size = n, prob = 0.33)
p2  &lt;- dbetabinom(q, size = n, prob = 0.33, theta = 0.22)
res &lt;- rbind(p1, p2)
dimnames(res) &lt;- list(c("Binomial", "Beta-binomial"), q)
barplot(res, beside = TRUE, legend.text = TRUE, ylab = "Frequency")

# Effect of the aggregation parameter theta on probability density:
thetas &lt;- seq(0.001, 2.5, by = 0.001)
density1 &lt;- rep(sum(dbinom(25:50, size = 100, prob = 0.5)), length(thetas))
density2 &lt;- sapply(thetas, function(theta) {
    sum(dbetabinom(25:50, size = 100, prob = 0.5, theta = theta))
})
plot(thetas, density2, type = "l",
     xlab = expression("Aggregation parameter ("*theta*")"),
     ylab = "Probability density between 25 and 50 (size = 100)")
lines(thetas, density1, lty = 2)

</code></pre>


</div>