<div class="container">

<table style="width: 100%;"><tr>
<td>cpness</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Core-peripheriness measure
</h2>

<h3>Description</h3>

<p>Computation of the cpness measure for a bipartite graph/network
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpness(web, type=c("automatic","binary","integer","float"), plot=TRUE, fastplot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>web</code></td>
<td>
<p>A <code>matrix</code> with elements of a set (e.g., plants) as rows,
elements of a second set (e.g., pollinators) as columns and
number of interactions as entries. Species names can be indicated in
the row or column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of matrix. This should be (an unambiguous
abbreviation of) one of <code>automatic</code> (default),
<code>binary</code>, <code>integer</code> or <code>float</code>. With <code>automatic</code>
(default), the type of matrix is automatically deduced inside the
function. Using <code>binary</code>, the matrix is binarized in any case. See the "Details" section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Plot the matrix reordered according to the core-periphery
partitioning. <code>TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastplot</code></td>
<td>
<p>If <code>TRUE</code>, the matrix plot is performed using the
fast <code>image</code> function instead of the <code>visweb</code> function from the
<code>bipartite</code> package, without species names. Only for large matrices. <code>FALSE</code> by default. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In a matrix displaying a core-periphery structure, there is a species ordering (i.e. an ordering in rows and columns) such that interactions are distributed in an L-shape. This L-shape is composed by four blocks of varying connectance: block C11 represents the core; blocks C12 and C21 include the interactions between core and periphery; block C22 includes the interactions that occur between peripheral species.
</p>
<p>This fonction computes the core-peripheriness (CPness), as
CPness=(E11+E12+E21)/E, where Eij is the number of interactions
(edges)  or the sum of weights for each block (Eij for block ij) or
for the entire network (E).  Here, we rely on a stochastic block model
(SBM) to detect the four groups/blocks C11, C12, C21 and C22 when they
actually exist. However, the SBM can fail in finding these blocks: in
these cases, there is no core-periphery partition and the CPness value is set to <code>NA</code>.
</p>
<p>This function can deal with binary and weighted networks with the appropriate statistical distribution (Bernouilli for <code>binary</code> data, Poisson for <code>integer</code> weights, and Gaussian for <code>float</code> weights). Note that it is often advisable to log-transform float data before running the <code>cpness</code> function.
</p>


<h3>Value</h3>

<p><code>cpness</code> returns an object of class <code>list</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cpness</code></td>
<td>
<p>The value of the core-peripheriness measure.  <code>NA</code> when no  core-periphery partition is found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowmembership</code></td>
<td>
<p>An integer <code>vector</code> indicating the group to which species in rows are belonging. Group 1 is core and group 2 is periphery, unless there is only a single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colmembership</code></td>
<td>
<p>Same as <code>rowmembership</code> for species in columns.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Authors: Vincent Miele
Maintainer: Vincent Miele &lt;vincent.miele@univ-lyon1.fr&gt;
</p>


<h3>References</h3>

<p>Ana M. Martin Gonzalez, Diego P. Vazquez, Rodrigo Ramos-Jiliberto, Sang Hoon Lee &amp; Vincent Miele, Core-periphery structure in mutualistic networks: an epitaph for nestedness? BiorXiv (2020) &lt;doi:10.1101/2020.04.02.021691&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(bipartite)
data(mosquin1967)
result &lt;- cpness(mosquin1967, type="automatic", plot=TRUE)
print(result)

data(junker2013)
result &lt;- cpness(junker2013, type="automatic", plot=TRUE, fastplot=TRUE)
print(result$cpness)
print(table(result$rowmembership))
print(table(result$colmembership))
</code></pre>


</div>