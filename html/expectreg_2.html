<div class="container">

<table style="width: 100%;"><tr>
<td>cdf.qp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculation of the conditional CDF based on expectile curves
</h2>

<h3>Description</h3>

<p>Estimating the CDF of the response for a given value of covariate. Additionally quantiles are computed
from the distribution function which allows for the calculation of regression quantiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cdf.qp(expectreg, x = NA, qout = NA, extrap = FALSE, e0 = NA, eR = NA,
       lambda = 0, var.dat = NA)

cdf.bundle(bundle, qout = NA, extrap = FALSE, quietly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expectreg, bundle</code></td>
<td>

<p>An object of class expectreg or subclass bundle respectively. The number of expectiles should be high enough to ensure accurate estimation. 
One approach would be to take as many expectiles as data points. Also make sure that extreme expectiles are incuded, e.g. expectiles corresponding to very small and large asymmetrie values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The covariate value where the CDF is estimated. By default the first covariate value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qout</code></td>
<td>

<p>Vector of quantiles that will be computed from the CDF.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrap</code></td>
<td>

<p>If TRUE, extreme quantiles will be extrapolated linearly, otherwise the maximum of the CDF is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e0</code></td>
<td>

<p>Scalar number which offers the possibility to specify an artificial minimal expectile (for example the minimum of the data) used for the calculation. By default e0 = e1 + (e1 - e2) where e1 is the actual minimal expectile and e2 the second smallest expectile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eR</code></td>
<td>

<p>Scalar number which offers the possibility to specify an artificial maximal expectile (for example the maximum of the data) used for the calculation. By default eR = eR-1 + (eR-1 - eR-2) where eR-1 is the actual maximal expectile and eR-2 the second largest expectile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Positive Scalar. Penalty parameter steering the smoothness of the fitted CDF. By default equal to 0 which means no penalization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.dat</code></td>
<td>

<p>Positive Scalar. If a penalization is applied (i.e. <code>lambda</code> unequal to 0), this argument can be used to let the penalty depend on the variance of the expectiles (which is the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>

<p>If programm should run quietly.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Expectile curves can describe very well the spread and location of a scatterplot. With
a set of curves they give good impression about the nature of the data. This information
can be used to estimate the conditional density from the expectile curves.
The results of the bundle model are especially suited in this case
as only one density will be estimated which can then be modulated to
over the independent variable x. The 
density estimation can be formulated as penalized least squares problem that results in a smooth non-negative
density.
The theoretical values of a quantile regression at this covariate value
are also returned for adjustable probabilities <code>qout</code>.
</p>


<h3>Value</h3>

<p>A list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> vector of expectiles where the CDF is computed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdf </code></td>
<td>
<p> vector of values of the CDF at the expectiles <code>x</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles </code></td>
<td>
<p> vector of quantile values estimated from the CDF. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qout </code></td>
<td>
<p> vector of probabilities for the calculated quantiles. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Goeran Kauermann, Linda Schulze Waltrup <br>
Ludwig Maximilian University Munich <br><a href="https://www.lmu.de">https://www.lmu.de</a> <br></p>
<p>Fabian Sobotka <br>
Georg August University Goettingen <br><a href="https://www.uni-goettingen.de">https://www.uni-goettingen.de</a> <br></p>
<p>Sabine Schnabel <br>
Wageningen University and Research Centre <br><a href="https://www.wur.nl">https://www.wur.nl</a> <br></p>
<p>Paul Eilers <br>
Erasmus Medical Center Rotterdam <br><a href="https://www.erasmusmc.nl">https://www.erasmusmc.nl</a> <br></p>


<h3>References</h3>

<p>Schnabel SK and Eilers PHC (2010)
<em> A location scale model for non-crossing expectile curves </em>
(working paper)
</p>
<p>Schulze Waltrup L, Sobotka F, Kneib T and Kauermann G (2014)
<em> Expectile and Quantile Regression - David and Goliath? </em>
Statistical Modelling.
</p>


<h3>See Also</h3>

<p><code>expectreg.ls</code>, <code>expectreg.qp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">d = expectreg.ls(dist ~ rb(speed),data=cars,smooth="f",lambda=5,estimate="restricted",
                 expectiles=c(0.0001,0.001,seq(0.01,0.99,0.01),0.999,0.9999))
e = cdf.qp(d,15,extrap=TRUE)
e 
</code></pre>


</div>