<div class="container">

<table style="width: 100%;"><tr>
<td>wandafromx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find weight and scale factor from data if Laplace prior is used.</h2>

<h3>Description</h3>

<p>Given a vector of data and a single value or vector of sampling standard
deviations, find the marginal maximum likelihood choice of both weight
and scale factor under the Laplace prior.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wandafromx(x, s = 1, universalthresh = TRUE)
negloglik.laplace(xpar, xx, ss, tlo, thi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A single value or a vector of standard deviations. If
vector, must have the same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>universalthresh</code></td>
<td>
<p>If <code>universalthresh = TRUE</code>, the thresholds
will be upper bounded by universal threshold; otherwise, the
thresholds can take any non-negative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>
<p>A vector of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpar</code></td>
<td>
<p>Vector of two parameters: <code>xpar[1]</code> : a value between
0 and 1, which will be adjusted to range of w; <code>xpar[2]</code>, 
scale factor "a".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>Vector of standard deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlo</code></td>
<td>
<p>Lower bound of thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thi</code></td>
<td>
<p>Upper bound of thresholds.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameters are found by marginal maximum likelihood.
</p>
<p>The search is over weights corresponding to threshold <code class="reqn">t_i</code> in the
range <code class="reqn">[0, s_i \sqrt{2 \log n}]</code> if
<code>universalthresh=TRUE</code>, where <code class="reqn">n</code> is the length of the data
vector and <code class="reqn">(s_1, ... , s_n)</code> is the vector of sampling standard
deviation of data <code class="reqn">(x_1, ... , x_n)</code>; otherwise, the search is over
<code class="reqn">[0,1]</code>.
</p>
<p>The search uses a nonlinear optimization routine (<code>optim</code> in
<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>) to minimize the negative log likelihood function
<code>negloglik.laplace</code>.  The range over which the scale factor is
searched is (0.04, 3).  For reasons of numerical stability within the
optimization, the prior is parametrized internally by the threshold and
the scale parameter.
</p>


<h3>Value</h3>

<p>A list with values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The estimated weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The estimated scale factor.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bernard Silverman</p>


<h3>References</h3>

<p>See <code>ebayesthresh</code> and
<a href="http://www.bernardsilverman.com">http://www.bernardsilverman.com</a></p>


<h3>See Also</h3>

<p><code>wfromx</code>, <code>tfromw</code></p>


<h3>Examples</h3>

<pre><code class="language-R">wandafromx(rnorm(100, c(rep(0,90),rep(5,10))), s = 1)
</code></pre>


</div>