<div class="container">

<table style="width: 100%;"><tr>
<td>betagpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Beta Bulk and GPD Tail Extreme Value Mixture Model</h2>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and
random number generation for the extreme value mixture model with beta for bulk
distribution upto the threshold and conditional GPD above threshold. The parameters
are the beta shape 1 <code>bshape1</code> and shape 2 <code>bshape2</code>, threshold <code>u</code>
GPD scale <code>sigmau</code> and shape <code>xi</code> and tail fraction <code>phiu</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbetagpd(x, bshape1 = 1, bshape2 = 1, u = qbeta(0.9, bshape1,
  bshape2), sigmau = sqrt(bshape1 * bshape2/(bshape1 +
  bshape2)^2/(bshape1 + bshape2 + 1)), xi = 0, phiu = TRUE,
  log = FALSE)

pbetagpd(q, bshape1 = 1, bshape2 = 1, u = qbeta(0.9, bshape1,
  bshape2), sigmau = sqrt(bshape1 * bshape2/(bshape1 +
  bshape2)^2/(bshape1 + bshape2 + 1)), xi = 0, phiu = TRUE,
  lower.tail = TRUE)

qbetagpd(p, bshape1 = 1, bshape2 = 1, u = qbeta(0.9, bshape1,
  bshape2), sigmau = sqrt(bshape1 * bshape2/(bshape1 +
  bshape2)^2/(bshape1 + bshape2 + 1)), xi = 0, phiu = TRUE,
  lower.tail = TRUE)

rbetagpd(n = 1, bshape1 = 1, bshape2 = 1, u = qbeta(0.9, bshape1,
  bshape2), sigmau = sqrt(bshape1 * bshape2/(bshape1 +
  bshape2)^2/(bshape1 + bshape2 + 1)), xi = 0, phiu = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bshape1</code></td>
<td>
<p>beta shape 1 (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bshape2</code></td>
<td>
<p>beta shape 2 (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>threshold over <code class="reqn">(0, 1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau</code></td>
<td>
<p>scale parameter (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiu</code></td>
<td>
<p>probability of being above threshold <code class="reqn">[0, 1]</code> or <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if TRUE then log density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical, if FALSE then upper tail probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>cumulative probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size (positive integer)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extreme value mixture model combining beta distribution for the bulk
below the threshold and GPD for upper tail.
</p>
<p>The user can pre-specify <code>phiu</code> 
permitting a parameterised value for the tail fraction <code class="reqn">\phi_u</code>. Alternatively, when
<code>phiu=TRUE</code> the tail fraction is estimated as the tail fraction from the
beta bulk model.
</p>
<p>The usual beta distribution is defined over <code class="reqn">[0, 1]</code>, but this mixture is generally
not limited in the upper tail <code class="reqn">[0,\infty]</code>, except for the usual upper tail 
limits for the GPD when <code>xi&lt;0</code> discussed in <code>gpd</code>. 
Therefore, the threshold is limited to <code class="reqn">(0, 1)</code>.
</p>
<p>The cumulative distribution function with tail fraction <code class="reqn">\phi_u</code> defined by the
upper tail fraction of the beta bulk model (<code>phiu=TRUE</code>), upto the 
threshold <code class="reqn">0 \le x \le u &lt; 1</code>, given by:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = H(x)</code>
</p>

<p>and above the threshold <code class="reqn">x &gt; u</code>:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = H(u) + [1 - H(u)] G(x)</code>
</p>

<p>where <code class="reqn">H(x)</code> and <code class="reqn">G(X)</code> are the beta and conditional GPD
cumulative distribution functions (i.e. <code>pbeta(x, bshape1, bshape2)</code> and
<code>pgpd(x, u, sigmau, xi)</code>).
</p>
<p>The cumulative distribution function for pre-specified <code class="reqn">\phi_u</code>, upto the
threshold <code class="reqn">0 \le x \le u &lt; 1</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = (1 - \phi_u) H(x)/H(u)</code>
</p>

<p>and above the threshold <code class="reqn">x &gt; u</code>:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \phi_u + [1 - \phi_u] G(x)</code>
</p>

<p>Notice that these definitions are equivalent when <code class="reqn">\phi_u = 1 - H(u)</code>.
</p>
<p>See <code>gpd</code> for details of GPD upper tail component and 
<code>dbeta</code> for details of beta bulk component.
</p>


<h3>Value</h3>

<p><code>dbetagpd</code> gives the density, 
<code>pbetagpd</code> gives the cumulative distribution function,
<code>qbetagpd</code> gives the quantile function and 
<code>rbetagpd</code> gives a random sample.
</p>


<h3>Note</h3>

<p>All inputs are vectorised except <code>log</code> and <code>lower.tail</code>.
The main inputs (<code>x</code>, <code>p</code> or <code>q</code>) and parameters must be either
a scalar or a vector. If vectors are provided they must all be of the same length,
and the function will be evaluated for each element of vector. In the case of 
<code>rbetagpd</code> any input vector must be of length <code>n</code>.
</p>
<p>Default values are provided for all inputs, except for the fundamentals 
<code>x</code>, <code>q</code> and <code>p</code>. The default sample size for 
<code>rbetagpd</code> is 1.
</p>
<p>Missing (<code>NA</code>) and Not-a-Number (<code>NaN</code>) values in <code>x</code>,
<code>p</code> and <code>q</code> are passed through as is and infinite values are set to
<code>NA</code>. None of these are not permitted for the parameters.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Yang Hu and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://en.wikipedia.org/wiki/Beta_distribution">http://en.wikipedia.org/wiki/Beta_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>MacDonald, A. (2012). Extreme value mixture modelling with medical and
industrial applications. PhD thesis, University of Canterbury, New Zealand.
<a href="http://ir.canterbury.ac.nz/bitstream/10092/6679/1/thesis_fulltext.pdf">http://ir.canterbury.ac.nz/bitstream/10092/6679/1/thesis_fulltext.pdf</a>
</p>


<h3>See Also</h3>

<p><code>gpd</code> and <code>dbeta</code>
</p>
<p>Other betagpd: <code>betagpdcon</code>,
<code>fbetagpdcon</code>, <code>fbetagpd</code>
</p>
<p>Other betagpdcon: <code>betagpdcon</code>,
<code>fbetagpdcon</code>, <code>fbetagpd</code>
</p>
<p>Other fbetagpd: <code>fbetagpd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(2, 2))

x = rbetagpd(1000, bshape1 = 1.5, bshape2 = 2, u = 0.7, phiu = 0.2)
xx = seq(-0.1, 2, 0.01)
hist(x, breaks = 100, freq = FALSE, xlim = c(-0.1, 2))
lines(xx, dbetagpd(xx, bshape1 = 1.5, bshape2 = 2, u = 0.7, phiu = 0.2))

# three tail behaviours
plot(xx, pbetagpd(xx, bshape1 = 1.5, bshape2 = 2, u = 0.7, phiu = 0.2), type = "l")
lines(xx, pbetagpd(xx, bshape1 = 1.5, bshape2 = 2, u = 0.7, phiu = 0.2, xi = 0.3), col = "red")
lines(xx, pbetagpd(xx, bshape1 = 1.5, bshape2 = 2, u = 0.7, phiu = 0.2, xi = -0.3), col = "blue")
legend("bottomright", paste("xi =",c(0, 0.3, -0.3)),
  col=c("black", "red", "blue"), lty = 1)

x = rbetagpd(1000, bshape1 = 2, bshape2 = 0.8, u = 0.7, phiu = 0.5)
hist(x, breaks = 100, freq = FALSE, xlim = c(-0.1, 2))
lines(xx, dbetagpd(xx, bshape1 = 2, bshape2 = 0.6, u = 0.7, phiu = 0.5))

plot(xx, dbetagpd(xx, bshape1 = 2, bshape2 = 0.8, u = 0.7, phiu = 0.5, xi=0), type = "l")
lines(xx, dbetagpd(xx, bshape1 = 2, bshape2 = 0.8, u = 0.7, phiu = 0.5, xi=-0.2), col = "red")
lines(xx, dbetagpd(xx, bshape1 = 2, bshape2 = 0.8, u = 0.7, phiu = 0.5, xi=0.2), col = "blue")
legend("topright", c("xi = 0", "xi = 0.2", "xi = -0.2"),
  col=c("black", "red", "blue"), lty = 1)

## End(Not run)

</code></pre>


</div>