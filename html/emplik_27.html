<div class="container">

<table style="width: 100%;"><tr>
<td>emplikHs.disc2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two sample empirical likelihood ratio for discrete hazards
with right censored, left truncated data. Many constraints.</h2>

<h3>Description</h3>

<p>Use empirical likelihood ratio and Wilks theorem to test 
the null hypothesis that
</p>
<p style="text-align: center;"><code class="reqn"> 
\int{f_1(t) I_{[dH_1 &lt;1]} \log(1-dH_1(t))} -
\int{f_2(t) I_{[dH_2 &lt;1]} \log(1-dH_2(t))} = \theta 
</code>
</p>

<p>where <code class="reqn">H_*(t)</code> are the (unknown) discrete cumulative
hazard functions; <code class="reqn">f_*(t)</code> can be any predictable  
functions of <code class="reqn">t</code>. 
<code class="reqn">\theta</code> is a vector of parameters (dim=q &gt;= 1). 
The given value of <code class="reqn">\theta</code>
in these computation are the value to be tested.
The data can be right censored and left truncated.
</p>
<p>When the given constants <code class="reqn">\theta</code> is too far
away from the NPMLE, there will be no hazard function satisfy this 
constraint and the -2 Log empirical likelihood ratio
will be infinite. In this case the computation will stop.
</p>


<h3>Usage</h3>

<pre><code class="language-R">emplikHs.disc2(x1, d1, y1= -Inf, x2, d2, y2 = -Inf,
          theta, fun1, fun2, maxit=25,tola = 1e-6, itertrace =FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>a vector, the observed survival times, sample 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1</code></td>
<td>
<p>a vector, the censoring indicators, 1-uncensor; 0-censor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>
<p>optional vector, the left truncation times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>a vector, the observed survival times, sample 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2</code></td>
<td>
<p>a vector, the censoring indicators, 1-uncensor; 0-censor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2</code></td>
<td>
<p>optional vector, the left truncation times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun1</code></td>
<td>
<p>a predictable function used to calculate
the weighted discrete hazard in <code class="reqn">H_0</code>. 
<code>fun1(x)</code> must be able to take a vector input (length n)
<code>x</code>, and output a matrix of n x q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun2</code></td>
<td>
<p> Ditto.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tola</code></td>
<td>
<p>an optional positive real number, the tolerance of
iteration error in solve the non-linear equation needed in constrained 
maximization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a given vector of length q. for Ho constraint. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer, maximum number of iteration. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itertrace</code></td>
<td>
<p> Logocal, lower bound for lambda </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The log empirical likelihood been maximized is the ‘binomial empirical likelihood’:
</p>
<p style="text-align: center;"><code class="reqn"> 
\sum D_{1i} \log w_i  + (R_{1i}-D_{1i}) \log [1-w_i] + 
\sum D_{2j} \log v_j  + (R_{2j}-D_{2j}) \log [1-v_j] 
</code>
</p>

<p>where <code class="reqn">w_i = \Delta H_1(t_i)</code> is the jump 
of the cumulative hazard function at <code class="reqn">t_i</code>, 
<code class="reqn">D_{1i}</code> is the number of failures
observed at <code class="reqn">t_i</code>, and <code class="reqn">R_{1i}</code> is 
the number of subjects at risk at
time <code class="reqn">t_i</code> (for sample one). Similar for sample two.
</p>
<p>For discrete distributions, the jump size of the cumulative hazard at
the last jump is always 1. We have to exclude this jump from the 
summation in the constraint calculation
since <code class="reqn"> \log( 1- dH(\cdot))</code> do not make sense.
In the likelihood, this term contribute a zero (0*Inf).
</p>
<p>This function can handle multiple constraints. So dim( <code>theta</code>) = q.
The constants <code>theta</code> must be inside the so called
feasible region for the computation to continue. This is similar to the
requirement that in testing the value of the mean, the value must be
inside the convex hull of the observations.
It is always true that the NPMLE values are feasible. So when the
computation stops, try move the <code>theta</code> closer
to the NPMLE.  When the computation stops, the -2LLR should have value
infinite.
</p>
<p>This code can also be used to compute one sample problems.
You need to artificially supply data for sample two
(with minimal sample size (2q+2)), and supply a function 
<code>fun2</code> that ALWAYS returns zero (zero vector or zero matrix).
In the output, read the -2LLR(sample1).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>times1</code></td>
<td>
<p>the location of the hazard jumps in sample 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times2</code></td>
<td>
<p>the location of the hazard jumps in sample 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the final value of the Lagrange multiplier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"-2LLR"</code></td>
<td>
<p>The -2Log Likelihood ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"-2LLR(sample1)"</code></td>
<td>
<p>The -2Log Likelihood ratio for sample 1 only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niters</code></td>
<td>
<p>number of iterations used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou </p>


<h3>References</h3>

<p>Zhou and Fang (2001). 
“Empirical likelihood ratio for 2 sample problems for censored data”. 
<em>Tech Report, Univ. of Kentucky, Dept of Statistics</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require("boot", quietly = TRUE)) {
####library(boot)
data(channing)
ymale &lt;- channing[1:97,2]
dmale &lt;- channing[1:97,5]
xmale &lt;- channing[1:97,3]
yfemale &lt;- channing[98:462,2]
dfemale &lt;- channing[98:462,5]
xfemale &lt;- channing[98:462,3]
fun1 &lt;- function(x) { as.numeric(x &lt;= 960) }
########################################################
emplikHs.disc2(x1=xfemale, d1=dfemale, y1=yfemale, 
 x2=xmale, d2=dmale, y2=ymale, theta=0.25, fun1=fun1, fun2=fun1)
########################################################
### This time you get "-2LLR" = 1.150098 etc. etc.
##############################################################
fun2 &lt;- function(x){ cbind(as.numeric(x &lt;= 960), as.numeric(x &lt;= 860))}
############ fun2 has matrix output ###############
emplikHs.disc2(x1=xfemale, d1=dfemale, y1=yfemale, 
 x2=xmale, d2=dmale, y2=ymale, theta=c(0.25,0), fun1=fun2, fun2=fun2)
################# you get "-2LLR" = 1.554386, etc ###########
}
</code></pre>


</div>