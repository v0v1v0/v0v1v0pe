<div class="container">

<table style="width: 100%;"><tr>
<td>lMoment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate <code class="reqn">L</code>-Moments
</h2>

<h3>Description</h3>

<p>Estimate the <code class="reqn">r</code>'th <code class="reqn">L</code>-moment from a random sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  lMoment(x, r = 1, method = "unbiased", 
    plot.pos.cons = c(a = 0.35, b = 0), na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>positive integer specifying the order of the moment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying what method to use to compute the 
<code class="reqn">L</code>-moment.  The possible values are <code>"unbiased"</code> 
(method based on the U-statistic; the default), or <code>"plotting.position"</code> 
(method based on the plotting position formula).  See the DETAILS section for 
more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pos.cons</code></td>
<td>

<p>numeric vector of length 2 specifying the constants used in the formula for the 
plotting positions when <code>method="plotting.position"</code>.  The default value is 
<code>plot.pos.cons=c(a=0.35, b=0)</code>.  If this vector has a names attribute with 
the value <code>c("a","b")</code> or <code>c("b","a")</code>, then the elements will be 
matched by name in the formula for computing the plotting positions.  Otherwise, 
the first element is mapped to the name <code>"a"</code> and the second element to the 
name <code>"b"</code>.  See the DETAILS section for more information.  This argument is 
ignored if <code>method="ubiased"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>logical scalar indicating whether to remove missing values from <code>x</code>.  
If <code>na.rm=FALSE</code> (the default) and <code>x</code> contains missing values, 
then a missing value (<code>NA</code>) is returned.  If <code>na.rm=TRUE</code>, missing 
values are removed from <code>x</code> prior to computing the <code class="reqn">L</code>-moment.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Definitions: <code class="reqn">L</code>-Moments and <code class="reqn">L</code>-Moment Ratios</b> <br>
The definition of an <code class="reqn">L</code>-moment given by Hosking (1990) is as follows.  
Let <code class="reqn">X</code> denote a random variable with cdf <code class="reqn">F</code>, and let <code class="reqn">x(p)</code> 
denote the <code class="reqn">p</code>'th quantile of the distribution.  Furthermore, let
</p>
<p style="text-align: center;"><code class="reqn">x_{1:n} \le x_{2:n} \le \ldots \le x_{n:n}</code>
</p>

<p>denote the order statistics of a random sample of size <code class="reqn">n</code> drawn from the 
distribution of <code class="reqn">X</code>.  Then the <code class="reqn">r</code>'th <code class="reqn">L</code>-moment is given by:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_r = \frac{1}{r} \sum^{r-1}_{k=0} (-1)^k {r-1 \choose k} E[X_{r-k:r}]</code>
</p>

<p>for <code class="reqn">r = 1, 2, \ldots</code>.
</p>
<p>Hosking (1990) shows that the above equation can be rewritten as:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_r = \int^1_0 x(u) P^*_{r-1}(u) du</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">P^*_r(u) = \sum^r_{k=0} p^*_{r,k} u^k</code>
</p>

<p style="text-align: center;"><code class="reqn">p^*_{r,k} = (-1)^{r-k} {r \choose k} {r+k \choose k} = \frac{(-1)^{r-k} (r+k)!}{(k!)^2 (r-k)!}</code>
</p>

<p>The first four <code class="reqn">L</code>-moments are given by: 
</p>
<p style="text-align: center;"><code class="reqn">\lambda_1 = E[X]</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_2 = \frac{1}{2} E[X_{2:2} - X_{1:2}]</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_3 = \frac{1}{3} E[X_{3:3} - 2X_{2:3} + X_{1:3}]</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_4 = \frac{1}{4} E[X_{4:4} - 3X_{3:4} + 3X_{2:4} - X_{1:4}]</code>
</p>

<p>Thus, the first <code class="reqn">L</code>-moment is a measure of location, and the second 
<code class="reqn">L</code>-moment is a measure of scale. 
</p>
<p>Hosking (1990) defines the <code class="reqn">L</code>-moment ratios of <code class="reqn">X</code> to be:
</p>
<p style="text-align: center;"><code class="reqn">\tau_r = \frac{\lambda_r}{\lambda_2}</code>
</p>

<p>for <code class="reqn">r = 2, 3, \ldots</code>.  He shows that for a non-degenerate random variable 
with a finite mean, these quantities lie in the interval <code class="reqn">(-1, 1)</code>.  
The quantity
</p>
<p style="text-align: center;"><code class="reqn">\tau_3 = \frac{\lambda_3}{\lambda_2}</code>
</p>

<p>is the <code class="reqn">L</code>-moment analog of the coefficient of skewness, and the quantity
</p>
<p style="text-align: center;"><code class="reqn">\tau_4 = \frac{\lambda_4}{\lambda_2}</code>
</p>

<p>is the <code class="reqn">L</code>-moment analog of the coefficient of kurtosis.  Hosking (1990) also 
defines an <code class="reqn">L</code>-moment analog of the coefficient of variation (denoted the 
<code class="reqn">L</code>-CV) as:
</p>
<p style="text-align: center;"><code class="reqn">\lambda = \frac{\lambda_2}{\lambda_1}</code>
</p>

<p>He shows that for a positive-valued random variable, the <code class="reqn">L</code>-CV lies 
in the interval <code class="reqn">(0, 1)</code>.
</p>
<p><b>Relationship Between <code class="reqn">L</code>-Moments and Probability-Weighted Moments</b> <br>
Hosking (1990) and Hosking and Wallis (1995) show that <code class="reqn">L</code>-moments can be 
written as linear combinations of probability-weighted moments:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_r = (-1)^{r-1} \sum^{r-1}_{k=0} p^*_{r-1,k} \alpha_k = \sum^{r-1}_{j=0} p^*_{r-1,j} \beta_j</code>
</p>

<p>where 
</p>
<p style="text-align: center;"><code class="reqn">\alpha_k = M(1, 0, k) = \frac{1}{k+1} E[X_{1:k+1}]</code>
</p>

<p style="text-align: center;"><code class="reqn">\beta_j = M(1, j, 0) = \frac{1}{j+1} E[X_{j+1:j+1}]</code>
</p>

<p>See the help file for <code>pwMoment</code> for more information on 
probability-weighted moments.
</p>
<p><b>Estimating L-Moments</b> <br>
The two commonly used methods for estimating <code class="reqn">L</code>-moments are the 
“unbiased” method based on U-statistics (Hoeffding, 1948; 
Lehmann, 1975, pp. 362-371), and the “plotting-position” method.  
Hosking and Wallis (1995) recommend using the unbiased method for almost all 
applications.
</p>
<p><em>Unbiased Estimators</em> (<code>method="unbiased"</code>) <br>
Using the relationship between <code class="reqn">L</code>-moments and probability-weighted moments 
explained above, the unbiased estimator of the <code class="reqn">r</code>'th <code class="reqn">L</code>-moment is based on 
unbiased estimators of probability-weighted moments and is given by:
</p>
<p style="text-align: center;"><code class="reqn">l_r = (-1)^{r-1} \sum^{r-1}_{k=0} p^*_{r-1,k} a_k = \sum^{r-1}_{j=0} p^*_{r-1,j} b_j</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">a_k = \frac{1}{n} \sum^{n-k}_{i=1} x_{i:n} \frac{{n-i \choose k}}{{n-1 \choose k}}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_j = \frac{1}{n} \sum^{n}_{i=j+1} x_{i:n} \frac{{i-1 \choose j}}{{n-1 \choose j}}</code>
</p>

<p><em>Plotting-Position Estimators</em> (<code>method="plotting.position"</code>) <br>
Using the relationship between <code class="reqn">L</code>-moments and probability-weighted moments 
explained above, the plotting-position estimator of the <code class="reqn">r</code>'th <code class="reqn">L</code>-moment 
is based on the plotting-position estimators of probability-weighted moments and 
is given by:
</p>
<p style="text-align: center;"><code class="reqn">\tilde{\lambda}_r = (-1)^{r-1} \sum^{r-1}_{k=0} p^*_{r-1,k} \tilde{\alpha}_k = \sum^{r-1}_{j=0} p^*_{r-1,j} \tilde{\beta}_j</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\tilde{\alpha}_k = \frac{1}{n} \sum^n_{i=1} (1 - p_{i:n})^k x_{i:n}</code>
</p>

<p style="text-align: center;"><code class="reqn">\tilde{\beta}_j =  \frac{1}{n} \sum^{n}_{i=1} p^j_{i:n} x_{i:n}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">p_{i:n} = \hat{F}(x_{i:n})</code>
</p>

<p>denotes the plotting position of the <code class="reqn">i</code>'th order statistic in the random 
sample of size <code class="reqn">n</code>, that is, a distribution-free estimate of the cdf of 
<code class="reqn">X</code> evaluated at the <code class="reqn">i</code>'th order statistic.  Typically, plotting 
positions have the form:
</p>
<p style="text-align: center;"><code class="reqn">p_{i:n} = \frac{i-a}{n+b}</code>
</p>

<p>where <code class="reqn">b &gt; -a &gt; -1</code>.  For this form of plotting position, the 
plotting-position estimators are asymptotically equivalent to their 
unbiased estimator counterparts. 
</p>
<p><b>Estimating <code class="reqn">L</code>-Moment Ratios</b> <br><code class="reqn">L</code>-moment ratios are estimated by simply replacing the population 
<code class="reqn">L</code>-moments with the estimated <code class="reqn">L</code>-moments.  The estimated ratios 
based on the unbiased estimators are given by:
</p>
<p style="text-align: center;"><code class="reqn">t_r = \frac{l_r}{l_2}</code>
</p>

<p>and the estimated ratios based on the plotting-position estimators are given by:
</p>
<p style="text-align: center;"><code class="reqn">\tilde{\tau}_r = \frac{\tilde{\lambda}_r}{\tilde{\lambda}_2}</code>
</p>

<p>In particular, the <code class="reqn">L</code>-moment skew is estimated by:
</p>
<p style="text-align: center;"><code class="reqn">t_3 = \frac{l_3}{l_2}</code>
</p>

<p>or 
</p>
<p style="text-align: center;"><code class="reqn">\tilde{\tau}_3 = \frac{\tilde{\lambda}_3}{\tilde{\lambda}_2}</code>
</p>

<p>and the <code class="reqn">L</code>-moment kurtosis is estimated by:
</p>
<p style="text-align: center;"><code class="reqn">t_4 = \frac{l_4}{l_2}</code>
</p>

<p>or 
</p>
<p style="text-align: center;"><code class="reqn">\tilde{\tau}_4 = \frac{\tilde{\lambda}_4}{\tilde{\lambda}_2}</code>
</p>

<p>Similarly, the <code class="reqn">L</code>-moment coefficient of variation can be estimated using 
the unbiased <code class="reqn">L</code>-moment estimators:
</p>
<p style="text-align: center;"><code class="reqn">l = \frac{l_2}{l_1}</code>
</p>

<p>or using the plotting-position L-moment estimators:
</p>
<p style="text-align: center;"><code class="reqn">\tilde{\lambda} = \frac{\tilde{\lambda}_2}{\tilde{\lambda}_1}</code>
</p>



<h3>Value</h3>

<p>A numeric scalar–the value of the <code class="reqn">r</code>'th <code class="reqn">L</code>-moment as defined by Hosking (1990).
</p>


<h3>Note</h3>

<p>Hosking (1990) introduced the idea of <code class="reqn">L</code>-moments, which are expectations 
of certain linear combinations of order statistics, as the basis of a general 
theory of describing theoretical probability distributions, computing summary 
statistics from observed data, estimating distribution parameters and quantiles, 
and performing hypothesis tests.  The theory of <code class="reqn">L</code>-moments parallels the 
theory of conventional moments.  <code class="reqn">L</code>-moments have several advantages over 
conventional moments, including:
</p>

<ul>
<li> <p><code class="reqn">L</code>-moments can characterize a wider range of distributions because 
they always exist as long as the distribution has a finite mean.
</p>
</li>
<li> <p><code class="reqn">L</code>-moments are estimated by linear combinations of order statistics, 
so estimators based on <code class="reqn">L</code>-moments are more robust to the presence of 
outliers than estimators based on conventional moments.
</p>
</li>
<li>
<p> Based on the author's and others' experience, <code class="reqn">L</code>-moment estimators 
are less biased and approximate their asymptotic distribution more closely in 
finite samples than estimators based on conventional moments.
</p>
</li>
<li> <p><code class="reqn">L</code>-moment estimators are sometimes more efficient (smaller RMSE) than 
even maximum likelihood estimators for small samples.
</p>
</li>
</ul>
<p>Hosking (1990) presents a table with formulas for the <code class="reqn">L</code>-moments of common 
probability distributions.  Articles that illustrate the use of <code class="reqn">L</code>-moments 
include Fill and Stedinger (1995), Hosking and Wallis (1995), and 
Vogel and Fennessey (1993).
</p>
<p>Hosking (1990) and Hosking and Wallis (1995) show the relationship between 
probabiity-weighted moments and <code class="reqn">L</code>-moments.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Fill, H.D., and J.R. Stedinger. (1995).  <code class="reqn">L</code> Moment and Probability Plot 
Correlation Coefficient Goodness-of-Fit Tests for the Gumbel Distribution and 
Impact of Autocorrelation.  <em>Water Resources Research</em> <b>31</b>(1), 225–229.
</p>
<p>Hosking, J.R.M. (1990).  L-Moments: Analysis and Estimation of Distributions 
Using Linear Combinations of Order Statistics.  <em>Journal of the Royal 
Statistical Society, Series B</em> <b>52</b>(1), 105–124.
</p>
<p>Hosking, J.R.M., and J.R. Wallis (1995).  A Comparison of Unbiased and 
Plotting-Position Estimators of <code class="reqn">L</code> Moments.  <em>Water Resources Research</em> 
<b>31</b>(8), 2019–2025.
</p>
<p>Vogel, R.M., and N.M. Fennessey. (1993).  <code class="reqn">L</code> Moment Diagrams Should 
Replace Product Moment Diagrams.  <em>Water Resources Research</em> <b>29</b>(6), 
1745–1752.
</p>


<h3>See Also</h3>

<p><code>cv</code>, <code>skewness</code>, <code>kurtosis</code>, 
<code>pwMoment</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Generate 20 observations from a generalized extreme value distribution 
  # with parameters location=10, scale=2, and shape=.25, then compute the 
  # first four L-moments. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(250) 
  dat &lt;- rgevd(20, location = 10, scale = 2, shape = 0.25) 

  lMoment(dat) 
  #[1] 10.59556 

  lMoment(dat, 2) 
  #[1] 1.0014 

  lMoment(dat, 3) 
  #[1] 0.1681165
 
  lMoment(dat, 4) 
  #[1] 0.08732692

  #----------

  # Now compute some L-moments based on the plotting-position estimators:

  lMoment(dat, method = "plotting.position") 
  #[1] 10.59556

  lMoment(dat, 2, method = "plotting.position") 
  #[1] 1.110264 

  lMoment(dat, 3, method="plotting.position", plot.pos.cons = c(.325,1)) 
  #[1] -0.4430792
 
  #----------

  # Clean up
  #---------
  rm(dat)
</code></pre>


</div>