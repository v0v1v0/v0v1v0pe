<div class="container">

<table style="width: 100%;"><tr>
<td>rateplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions to plot rates from a table classified by age and
calendar time (period)
</h2>

<h3>Description</h3>

  
<p>Produces plots of rates versus age, connected within period or cohort
(<code>Aplot</code>), rates versus period connected within age-groups
(<code>Pplot</code>) and rates and rates versus date of birth cohort
(<code>Cplot</code>). <code>rateplot</code> is a wrapper for these, allowing
to produce the four classical displays with a single call. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">rateplot( rates,
          which = c("ap","ac","pa","ca"),
            age = as.numeric( dimnames( rates )[[1]] ),
            per = as.numeric( dimnames( rates )[[2]] ),
           grid = FALSE,
         a.grid = grid,
         p.grid = grid,
         c.grid = grid,
          ygrid = grid,
       col.grid = gray( 0.9 ),
          a.lim = range( age, na.rm=TRUE ) + c(0,diff( range( age ) )/30),
          p.lim = range( per, na.rm=TRUE ) + c(0,diff( range( age ) )/30),
          c.lim = NULL, 
           ylim = range( rates[rates&gt;0], na.rm=TRUE ),
             at = NULL,
         labels = paste( at ),
          a.lab = "Age at diagnosis",
          p.lab = "Date of diagnosis",
          c.lab = "Date of birth",
           ylab = "Rates",
           type = "l",
            lwd = 2,
            lty = 1,
         log.ax = "y",
            las = 1,
            ann = FALSE,
          a.ann = ann,
          p.ann = ann,
          c.ann = ann,
          xannx = 1/20,
        cex.ann = 0.8,
         a.thin = seq( 1, length( age ), 2 ),
         p.thin = seq( 1, length( per ), 2 ),
         c.thin = seq( 2, length( age ) + length( per ) - 1, 2 ),
            col = par( "fg" ),
          a.col = col,
          p.col = col,
          c.col = col,
            ... )

Aplot( rates, age = as.numeric( dimnames( rates )[[1]] ),
       per = as.numeric( dimnames( rates )[[2]] ), grid = FALSE,
       a.grid = grid, ygrid = grid, col.grid = gray( 0.9 ),
       a.lim = range( age, na.rm=TRUE ), ylim = range( rates[rates&gt;0], na.rm=TRUE ),
       at = NULL, labels = paste( at ), a.lab = names( dimnames( rates ) )[1],
       ylab = deparse( substitute( rates ) ), type = "l", lwd = 2, lty = 1,
       col = par( "fg" ), log.ax = "y", las = 1, c.col = col, p.col = col,
       c.ann = FALSE, p.ann = FALSE, xannx = 1/20, cex.ann = 0.8,
       c.thin = seq( 2, length( age ) + length( per ) - 1, 2 ),
       p.thin = seq( 1, length( per ), 2 ), p.lines = TRUE,
       c.lines = !p.lines, ... )

Pplot( rates, age = as.numeric( dimnames( rates )[[1]] ),
       per = as.numeric( dimnames( rates )[[2]] ), grid = FALSE,
       p.grid = grid, ygrid = grid, col.grid = gray( 0.9 ),
       p.lim = range( per, na.rm=TRUE ) + c(0,diff(range(per))/30),
       ylim = range( rates[rates&gt;0], na.rm=TRUE ), p.lab = names( dimnames( rates ) )[2],
       ylab = deparse( substitute( rates ) ), at = NULL, labels = paste( at ),
       type = "l", lwd = 2, lty = 1, col = par( "fg" ), log.ax = "y",
       las = 1, ann = FALSE, cex.ann = 0.8, xannx = 1/20,
       a.thin = seq( 1, length( age ), 2 ), ... )

Cplot( rates, age = as.numeric( rownames( rates ) ),
       per = as.numeric( colnames( rates ) ), grid = FALSE,
       c.grid = grid, ygrid = grid, col.grid = gray( 0.9 ),
       c.lim = NULL, ylim = range( rates[rates&gt;0], na.rm=TRUE ),
       at = NULL, labels = paste( at ), c.lab = names( dimnames( rates ) )[2],
       ylab = deparse( substitute( rates ) ), type = "l", lwd = 2, lty = 1,
       col = par( "fg" ), log.ax = "y", las = 1, xannx = 1/20, ann = FALSE,
       cex.ann = 0.8, a.thin = seq( 1, length( age ), 2 ), ...  )

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rates</code></td>
<td>
<p>A two-dimensional table (or array) with rates to be plotted. It is
assumed that the first dimension is age and the second is period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>A character vector with elements from
<code>c("ap","ac","apc","pa","ca")</code>, indication which plots should
be produced. One plot per element is produced. The first letter
indicates the x-axis of the plot, the remaining which groups
should be connected, i.e. <code>"pa"</code> will plot rates versus
period and connect age-classes, and <code>"apc"</code> will plot rates
versus age, and connect both periods and cohorts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>Numerical vector giving the means of the
age-classes. Defaults to the rownames of <code>rates</code> as numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per</code></td>
<td>
<p>Numerical vector giving the means of the periods. Defaults
to the columnnames of <code>rates</code> as numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical indicating whether a background grid should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.grid</code></td>
<td>
<p>Logical indicating whether a background grid on the
age-axis should be drawn. If numerical it indicates the
age-coordinates of the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.grid</code></td>
<td>
<p>do. for the period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.grid</code></td>
<td>
<p>do. for the cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ygrid</code></td>
<td>
<p>do. for the rate-dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.grid</code></td>
<td>
<p>The colour of the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.lim</code></td>
<td>
<p>Range for the age-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.lim</code></td>
<td>
<p>Range for the period-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.lim</code></td>
<td>
<p>Range for the cohort-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Range for the y-axis (rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>Position of labels on the y-axis (rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Labels to put on the y-axis (rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.lab</code></td>
<td>
<p>Text on the age-axis. Defaults to "Age".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.lab</code></td>
<td>
<p>Text on the period-axis. Defaults to "Date of diagnosis".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.lab</code></td>
<td>
<p>Text on the cohort-axis. Defaults to "Date of birth".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Text on the rate-axis. Defaults to the name of the rate-table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>How should the curves be plotted. Defaults to <code>"l"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Width of the lines. Defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Which type of lines should be used. Defaults to 1, a solid line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.ax</code></td>
<td>
<p>Character with letters from <code>"apcyr"</code>, indicating
which axes should be logarithmic. <code>"y"</code> and <code>"r"</code> both
refer to the rate scale. Defaults to <code>"y"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p>see <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>Should the curves be annotated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.ann</code></td>
<td>
<p>Logical indicating whether age-curves should be annotated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.ann</code></td>
<td>
<p>do. for period-curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.ann</code></td>
<td>
<p>do. for cohort-curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xannx</code></td>
<td>
<p>The fraction that the x-axis is expanded when curves are annotated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.ann</code></td>
<td>
<p>Expansion factor for characters annotating curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.thin</code></td>
<td>
<p>Vector of integers indicating which of the age-classes
should be labelled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.thin</code></td>
<td>
<p>do. for the periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.thin</code></td>
<td>
<p>do. for the cohorts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colours for the curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.col</code></td>
<td>
<p>Colours for the age-curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.col</code></td>
<td>
<p>do. for the period-curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.col</code></td>
<td>
<p>do. for the cohort-curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.lines</code></td>
<td>
<p>Should rates from the same period be connected?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.lines</code></td>
<td>
<p>Should rates from the same cohort be connected?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments pssed on to <code>matlines</code> when
plotting the curves.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Zero values of the rates are ignored. They are neiter in the plot nor in
the calculation of the axis ranges.
</p>


<h3>Value</h3>

<p><code>NULL</code>. The function is used for its side-effect, the plot.
</p>


<h3>Author(s)</h3>

<p>Bendix Carstensen, Steno Diabetes Center,
<a href="http://bendixcarstensen.com">http://bendixcarstensen.com</a>
</p>


<h3>See Also</h3>

<p><code>apc.frame</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( blcaIT )
attach(blcaIT)

# Table of rates:
bl.rate &lt;- tapply( D, list(age,period), sum ) /
           tapply( Y, list(age,period), sum )
bl.rate

# The four classical plots:
par( mfrow=c(2,2) )
rateplot( bl.rate*10^6 )

# The labels on the vertical axis could be nicer:
rateplot( bl.rate*10^6, at=10^(-1:3), labels=c(0.1,1,10,100,1000) ) 

# More bells an whistles
par( mfrow=c(1,3), mar=c(3,3,1,1), oma=c(0,3,0,0), mgp=c(3,1,0)/1.6 )
rateplot( bl.rate*10^6, ylab="", ann=TRUE, which=c("AC","PA","CA"),
                      at=10^(-1:3), labels=c(0.1,1,10,100,1000),
                      col=topo.colors(11), cex.ann=1.2 ) 
</code></pre>


</div>