<div class="container">

<table style="width: 100%;"><tr>
<td>sim.eco</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate ecological data and samples of individual-level data</h2>

<h3>Description</h3>

<p>Simulate ecological data and samples of individual-level data from an 
individual-level logistic regression model, depending on given binary,
categorical or normally-distributed covariates. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.eco(N, ctx, binary, m, data=NULL, S=0, cross=NULL, covnames, ncats,
mu, alpha.c=0, alpha=0, beta=0, sig=0, strata, pstrata, isam = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p> Vector of population sizes, one for each group. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctx</code></td>
<td>
<p> A model formula containing names of group-level, or
contextual, covariates on the right-hand side. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>
<p> A model formula containing names of individual-level
binary covariates on the right-hand side. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Data frame containing the group-level variables given in
<code>ctx</code>.  It should also contain the variables given in <code>binary</code>, interpreted as
proportions of individuals exposed to each of the binary covariates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> A data frame with <code>length(N)</code> rows, containing the
within-area means of a set of normally-distributed continuous
covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p> A data frame with <code>length(N)</code> rows, containing the
within-area standard deviations of a set of normally-distributed
continuous covariates.  For the moment they are assumed to be
independent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cross</code></td>
<td>
<p> A matrix of cross-classifications of individuals in the
area between categories of multiple binary or categorical covariates, defined in
the same way as in <code>eco</code>.   If this is not supplied, the
binary covariates are assumed to be independent, and the probability
of an individual having a certain combination of covariates is
calculated as the product of the relevant marginal probabilities. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covnames</code></td>
<td>
<p> Vector of names of the covariates, if <code>cross</code>
is supplied.  Otherwise the names are taken from <code>binary</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncats</code></td>
<td>
<p> Numeric vector of the number of levels of the
covariates used in <code>cross</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> Regression intercept on the logit scale. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.c</code></td>
<td>
<p> Vector of coefficients for the group-level
covariates in the underlying logistic regression, corresponding to
the columns of <code>ctx</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> Vector of coefficients for the individual-level
binary covariates, corresponding to the columns of
<code>phi</code>. Interactions are not currently supported. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> Vector of coefficients for the individual-level
continuous covariates, corresponding to the columns of <code>m</code> or
<code>S</code>. Interactions are not currently supported. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p> Random-effects standard deviation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p> A matrix with rows representing groups, and columns
representing strata occupancy probabilities.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pstrata</code></td>
<td>
<p> A vector with one element for each stratum, giving
the assumed baseline outcome probabilities for the strata. The
logits of <code>pstrata</code> are used as offsets in the logistic regression. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isam</code></td>
<td>
<p> Number of individuals per group to retain in the
individual-level data. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The simulated aggregate-level response, one for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idata</code></td>
<td>
<p> A data frame containing the retained individual-level
samples. The grouping indicator (with values <code>1</code> to <code>length(N)</code>)
is named <code>group</code>, the response variable is named <code>y</code>, 
the group-level covariates are copied from <code>ctx</code>, and the
binary covariates, with values 1 or 0, are individual-level
equivalents of the proportions given in <code>phi</code>.  </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a> </p>


<h3>See Also</h3>

 <p><code>eco</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- rep(50, 20)
ctx &lt;- cbind(deprivation = rnorm(20), mean.income = rnorm(20))
phi &lt;- cbind(nonwhite = runif(20), smoke = runif(20))
sim.df &lt;- as.data.frame(cbind(ctx, phi))
mu &lt;- qlogis(0.05)  ## Disease with approximate 5% prevalence
## Odds ratios for group-level deprivation and mean imcome
alpha.c &lt;- c(1.01, 1.02)
## Odds ratios for individual-level ethnicity and smoking
alpha &lt;- c(1.5, 2) 
sim.eco(N, ctx = ~ deprivation + mean.income, binary = ~ nonwhite +
        smoke, data=sim.df, mu=mu, alpha.c=alpha.c, alpha=alpha)
sim.eco(N, ctx = ~ deprivation + mean.income, binary = ~ nonwhite +
        smoke, data=sim.df, mu=mu, alpha.c=alpha.c, alpha=alpha, isam=3)
</code></pre>


</div>