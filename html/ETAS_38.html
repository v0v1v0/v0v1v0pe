<div class="container">

<table style="width: 100%;"><tr>
<td>rates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Declustering Probabilities, Background Seismicity Rate and
Clustering Coefficient</h2>

<h3>Description</h3>

<p>Functions to estimate the declustering probabilities, background seismicity
rate and clustering (triggering) coefficient for a fitted ETAS model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  probs(fit)
  rates(fit, lat.range = NULL, long.range = NULL,
        dimyx=NULL, plot.it=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A fitted ETAS model. An object of class <code>"etas"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat.range</code></td>
<td>
<p>Latitude range of the rectangular grid.
A numeric vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long.range</code></td>
<td>
<p>Longitude range of the rectangular grid.
A numeric vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimyx</code></td>
<td>
<p>Dimensions of the rectangular discretization
grid for the geographical study region.
A numeric vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>Logical flag indicating whether to plot the rates or
return them as pixel images.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>probs</code> returns estimates of the declustering probabilities
</p>
<p style="text-align: center;"><code class="reqn">p_j = 1 - \frac{\mu(x_j, y_j)}{lambda(t_j, x_j, y_j|H_{t_j})}</code>
</p>

<p>where <code class="reqn">1-p_j</code> is the probability that event <code class="reqn">j</code>
is a background event.
</p>
<p>The function <code>rates</code> returns kernel estimate of the background
seismicity rate <code class="reqn">\mu(x,y)</code> and the clustering (triggering)
coefficient
</p>
<p style="text-align: center;"><code class="reqn">\omega(x,y)=1-\frac{\mu(x,y)}{\Lambda(x,y)}</code>
</p>

<p>where <code class="reqn">\Lambda(x,y)</code> is the total spatial intensity
function.
</p>
<p>The argument <code>dimyx</code> determines the rectangular discretization
grid dimensions. If it is given, then it must be a numeric vector
of length 2 where the first component <code>dimyx[1]</code> is the
number of subdivisions in the y-direction (latitude) and the
second component <code>dimyx[2]</code> is the number of subdivisions
in the x-direction (longitude). 

</p>


<h3>Value</h3>

<p>If <code>plot.it=TRUE</code>, the function produces plots of the
background seismicity and total spatial rate, clustering coefficient
and conditional intensity function at the end of study period.
</p>
<p>If <code>plot.it=FALSE</code>, it returns a list with components
</p>

<ul>
<li>
<p><b>bkgd</b> the estimated background siesmicity rate
</p>
</li>
<li>
<p><b>total</b> the estimated total spatial rate
</p>
</li>
<li>
<p><b>clust</b> the estimated clustering coefficient
</p>
</li>
<li>
<p><b>lamb</b> the estimated conditional intensity function at
time <code class="reqn">t=t_{\mathrm{start}}</code>
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Abdollah Jalilian
<a href="mailto:jalilian@razi.ac.ir">jalilian@razi.ac.ir</a>
</p>


<h3>References</h3>

<p>Zhuang J, Ogata Y, Vere-Jones D (2002).
Stochastic Declustering of Space-Time Earthquake Occurrences.
<em>Journal of the American Statistical Association</em>,
<b>97</b>(458), 369–380.
<a href="https://doi.org/10.1198/016214502760046925">doi:10.1198/016214502760046925</a>.
</p>
<p>Zhuang J, Ogata Y, Vere-Jones D (2006).
Diagnostic Analysis of Space-Time Branching Processes for Earthquakes.
In <em>Case Studies in Spatial Point Process Modeling</em>,
pp. 275–292. Springer Nature.
<a href="https://doi.org/10.1007/0-387-31144-0_15">doi:10.1007/0-387-31144-0_15</a>.
</p>
<p>Zhuang J (2011).
Next-day Earthquake Forecasts for the Japan Region Generated by
the ETAS Model.
<em>Earth, Planets and Space</em>,
<b>63</b>(3), 207–216.
<a href="https://doi.org/10.5047/eps.2010.12.010">doi:10.5047/eps.2010.12.010</a>.
</p>


<h3>See Also</h3>

<p><code>etas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # preparing the catalog
  iran.cat &lt;- catalog(iran.quakes, time.begin="1973/01/01",
     study.start="1996/01/01", study.end="2016/01/01",
     lat.range=c(25, 42), long.range=c(42, 63), mag.threshold=4.5)

  print(iran.cat)
  ## Not run: 
  plot(iran.cat)
## End(Not run)

  # initial parameters values
  param01 &lt;- c(0.46, 0.23, 0.022, 2.8, 1.12, 0.012, 2.4, 0.35)

  # fitting the model and
  ## Not run: 
  iran.fit &lt;- etas(iran.cat, param0=param01)
## End(Not run)

  # estimating the declustering probabilities
  ## Not run: 
  pr &lt;- probs(iran.fit)
  plot(iran.cat$longlat.coord[,1:2], cex=2 * (1 - pr$prob))
## End(Not run)

  # estimating the  background seismicity rate and clustering coefficient
  ## Not run: 
  rates(iran.fit, dimyx=c(100, 125))
  iran.rates &lt;- rates(iran.fit, dimyx=c(200, 250), plot.it=FALSE)
  summary(iran.rates$background)
## End(Not run)
</code></pre>


</div>