<div class="container">

<table style="width: 100%;"><tr>
<td>percentile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EdSurvey Percentiles</h2>

<h3>Description</h3>

<p>Calculates the percentiles of a numeric variable in an
<code>edsurvey.data.frame</code>, a <code>light.edsurvey.data.frame</code>,
or an <code>edsurvey.data.frame.list</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">percentile(
  variable,
  percentiles,
  data,
  weightVar = NULL,
  jrrIMax = 1,
  varMethod = c("jackknife", "Taylor"),
  alpha = 0.05,
  dropOmittedLevels = TRUE,
  defaultConditions = TRUE,
  recode = NULL,
  returnVarEstInputs = FALSE,
  returnNumberOfPSU = FALSE,
  pctMethod = c("symmetric", "unbiased", "simple"),
  confInt = TRUE,
  dofMethod = c("JR", "WS"),
  omittedLevels = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>the character name of the variable to percentiles computed,
typically a subject scale or subscale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentiles</code></td>
<td>
<p>a numeric vector of percentiles in the range of 0 to 100
(inclusive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an <code>edsurvey.data.frame</code> or an
<code>edsurvey.data.frame.list</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightVar</code></td>
<td>
<p>a character indicating the weight variable to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jrrIMax</code></td>
<td>
<p>a numeric value; when using the jackknife variance estimation method, the default estimation option, <code>jrrIMax=1</code>, uses the
sampling variance from the first plausible value as the component for sampling variance estimation. The <code class="reqn">V_{jrr}</code>
term (see
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf"><em>Statistical Methods Used in EdSurvey</em></a>)
can be estimated with any number of plausible values, and values larger than the number of
plausible values on the survey (including <code>Inf</code>) will result in all plausible values being used.
Higher values of <code>jrrIMax</code> lead to longer computing times and more accurate variance estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varMethod</code></td>
<td>
<p>a character set to <code>jackknife</code> or <code>Taylor</code>
that indicates the variance estimation method used when
constructing the confidence intervals. The jackknife
variance estimation method is always
used to calculate the standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the confidence level.
An <code>alpha</code> value of 0.05 would indicate a 95%
confidence interval and is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropOmittedLevels</code></td>
<td>
<p>a logical value. When set to the default value of
<code>TRUE</code>, drops those levels of
all factor variables that are specified in
<code>achievementVars</code> and <code>aggregatBy</code>.
Use <code>print</code> on an <code>edsurvey.data.frame</code>
to see the omitted levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaultConditions</code></td>
<td>
<p>a logical value. When set to the default value
of <code>TRUE</code>, uses the default
conditions stored in an <code>edsurvey.data.frame</code>
to subset the data.
Use <code>print</code> on an <code>edsurvey.data.frame</code>
to see the default conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recode</code></td>
<td>
<p>a list of lists to recode variables. Defaults to
<code>NULL</code>. Can be set as
<code>recode=</code><code>list(var1=</code> <code>list(from=</code> <code>c("a",</code>
<code>"b",</code> <code>"c"),</code>
<code>to=</code> <code>"d"))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnVarEstInputs</code></td>
<td>
<p>a logical value set to <code>TRUE</code> to return the
inputs to the jackknife and imputation variance
estimates which allows for the computation
of covariances between estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnNumberOfPSU</code></td>
<td>
<p>a logical value set to <code>TRUE</code> to return the number of
primary sampling units (PSUs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pctMethod</code></td>
<td>
<p>one of “unbiased”, “symmetric”, “simple”;
unbiased produces a weighted median unbiased percentile estimate,
whereas simple uses a basic formula that matches previously
published results. Symmetric uses a more basic formula
but requires that the percentile is symetric to multiplying
the quantity by negative one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confInt</code></td>
<td>
<p>a Boolean indicating if the confidence interval should be returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dofMethod</code></td>
<td>
<p>passed to <code>DoFCorrection</code> as the <code>method</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omittedLevels</code></td>
<td>
<p>this argument is deprecated. Use <code>dropOmittedLevels</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Percentiles, their standard errors, and confidence intervals
are calculated according to the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf"><em>Statistical Methods Used in EdSurvey</em></a>.
The standard errors and confidence intervals are based
on separate formulas and assumptions.
</p>
<p>The Taylor series variance estimation procedure is not relevant to percentiles
because percentiles are not continuously differentiable.
</p>


<h3>Value</h3>

<p>The return type depends on whether the class of the <code>data</code> argument is an
<code>edsurvey.data.frame</code> or an <code>edsurvey.data.frame.list</code>.
</p>
<p><strong>The data argument is an edsurvey.data.frame</strong>
When the <code>data</code> argument is an <code>edsurvey.data.frame</code>,
<code>percentile</code> returns an S3 object of class <code>percentile</code>.
This is a <code>data.frame</code> with typical attributes (<code>names</code>,
<code>row.names</code>, and <code>class</code>) and additional attributes as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>number of rows on <code>edsurvey.data.frame</code> before any conditions were applied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nUsed</code></td>
<td>
<p>number of observations with valid data and weights larger than zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPSU</code></td>
<td>
<p>number of PSUs used in the calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call used to generate these results</p>
</td>
</tr>
</table>
<p>The columns of the <code>data.frame</code> are as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>percentile</code></td>
<td>
<p>the percentile of this row</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated value of the percentile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the jackknife standard error of the estimated percentile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confInt.ci_lower</code></td>
<td>
<p>the lower bound
of the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confInt.ci_upper</code></td>
<td>
<p>the upper bound
of the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsmall</code></td>
<td>
<p>the number of units with more extreme results, averaged
across plausible values</p>
</td>
</tr>
</table>
<p>When the <code>confInt</code> argument is set to <code>FALSE</code>, the confidence
intervals are not returned.
</p>
<p><strong>The data argument is an edsurvey.data.frame.list</strong>
When the <code>data</code> argument is an <code>edsurvey.data.frame.list</code>,
<code>percentile</code> returns an S3 object of class <code>percentileList</code>.
This is a data.frame with a <code>call</code> attribute.
The columns in the <code>data.frame</code> are identical to those in the previous
section, but there also are columns from the <code>edsurvey.data.frame.list</code>.
</p>
<table><tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>a column for each column in the <code>covs</code> value of the
<code>edsurvey.data.frame.list</code>.
See Examples.</p>
</td>
</tr></table>
<p>When <code>returnVarEstInputs</code> is <code>TRUE</code>, an attribute
<code>varEstInputs</code> also is returned that includes the variance estimate
inputs used for calculating covariances with <code>varEstToCov</code>.
</p>


<h3>Author(s)</h3>

<p>Paul Bailey
</p>


<h3>References</h3>

<p>Hyndman, R. J., &amp; Fan, Y. (1996). Sample quantiles in statistical packages. <em>American Statistician</em>, <em>50</em>, 361–365.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# read in the example data (generated, not real student data)
sdf &lt;- readNAEP(path=system.file("extdata/data", "M36NT2PM.dat", package="NAEPprimer"))

# get the median of the composite
percentile(variable="composite", percentiles=50, data=sdf)

# get several percentiles
percentile(variable="composite", percentiles=c(0,1,25,50,75,99,100), data=sdf)
# build an edsurvey.data.frame.list
sdfA &lt;- subset(sdf, scrpsu %in% c(5,45,56))
sdfB &lt;- subset(sdf, scrpsu %in% c(75,76,78))
sdfC &lt;- subset(sdf, scrpsu %in% 100:200)
sdfD &lt;- subset(sdf, scrpsu %in% 201:300)

sdfl &lt;- edsurvey.data.frame.list(datalist=list(sdfA, sdfB, sdfC, sdfD),
                                 labels=c("A locations",
                                           "B locations",
                                           "C locations",
                                           "D locations"))
# this shows how these datasets will be described:
sdfl$covs

percentile(variable="composite", percentiles=50, data=sdfl)
percentile(variable="composite", percentiles=c(25, 50, 75), data=sdfl)

## End(Not run)
</code></pre>


</div>