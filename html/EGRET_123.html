<div class="container">

<table style="width: 100%;"><tr>
<td>runGroups</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Runs a comparison of any group of years in the record.</h2>

<h3>Description</h3>

<p><code>runGroups</code> provides comparisons of results, in terms of 
flow-normalized concentration and flow-normalized flux for any groups of years
of years in the water quality record.  Comparison could involve the 
use of the "wall" and/or use of "generalized flow-normalization".  
These two concepts are described in detail in the vignette:
<code>vignette("Enhancements", package = "EGRET")</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runGroups(eList, windowSide, group1firstYear, group1lastYear, group2firstYear,
  group2lastYear, surfaceStart = NA, surfaceEnd = NA, flowBreak = FALSE,
  Q1EndDate = NA, QStartDate = NA, QEndDate = NA, wall = FALSE,
  oldSurface = FALSE, fractMin = 0.75, sample1EndDate = NA,
  sampleStartDate = NA, sampleEndDate = NA, paStart = NA, paLong = NA,
  minNumObs = 100, minNumUncen = 50, windowY = 7, windowQ = 2,
  windowS = 0.5, edgeAdjust = TRUE, verbose = TRUE, saveOutput = FALSE,
  fileName = "temp.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowSide</code></td>
<td>
<p>integer. The width of the flow normalization window on each side of the year being estimated.
A common value is 11, but no default is specified.  If stationary flow normalization is to be used, then windowSide = 0 (this means that 
flow-normalization period for all years is the same).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group1firstYear</code></td>
<td>
<p>decimal year. Starting year of first group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group1lastYear</code></td>
<td>
<p>decimal year. Ending year of first group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group2firstYear</code></td>
<td>
<p>decimal year. Starting year of second group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group2lastYear</code></td>
<td>
<p>decimal year. Ending year of second group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surfaceStart</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the start of the WRTDS model to be estimated and the first of the 
daily outputs to be generated. Default is NA, which means that the surfaceStart is based on the date of the first sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surfaceEnd</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the end of the WRTDS model to be estimated and the last of the daily outputs 
to be generated.  Default is NA, which means that the surfaceEnd is based on the date of the last sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flowBreak</code></td>
<td>
<p>logical. Is there an abrupt break in the discharge record, default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) which is the last day, just before the flowBreak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QStartDate</code></td>
<td>
<p>The first Date (as character in YYYY-MM-DD) used in the  flow normalization method.  Default is 
NA, which makes the QStartDate become the first Date in eList$Daily.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QEndDate</code></td>
<td>
<p>The last Date (as character in YYYY-MM-DD) used in the flow normalization method.  Default is NA, 
which makes the QEndDate become the last Date in eList$Daily.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wall</code></td>
<td>
<p>logical. Whether there is an abrupt break in the concentration versus discharge relationship due to some major change in 
pollution control or water management.  Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldSurface</code></td>
<td>
<p>logical specifying whether to use the original surface, or create a new one. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fractMin</code></td>
<td>
<p>numeric specifying the minimum fraction of the observations required to run the weighted regression, default is 0.75. The
minimum number will be the maximum of minNumObs and fractMin multiplied by total number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the last date just before the wall. Default = NA. 
A date must be specified if wall = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleStartDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the first sample to be used. Default is NA which sets it 
to the first Date in eList$Sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleEndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the last sample to be used. 
Default is NA which sets it to the last Date in eList$Sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12.
Default is NA, which will use the paStart in the eList$INFO data frame. See also <code>setPA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12. 
Default is NA, which will use the paLong in the eList$INFO data frame. See also <code>setPA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveOutput</code></td>
<td>
<p>logical. If <code>TRUE</code>, a text file will be saved in the working directory of the printout of
what is in the console output. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileName</code></td>
<td>
<p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When using generalized flow-normalization, it is best to have the Daily data frame
extend well beyond the years that are in the Sample data frame.  Ideally, 
the Daily data frame would start windowSide years before the
start of the Sample data set, if the data exist to provide for that. Generally
that isn't possible for the end of the record because the Sample data
may end very close to the present. To the extent that is possible therefore, it is better to
include more discharge data after the end of the Sample record. 
Also note that in the case run in the examples don't do that, 
because the data set needs to be appropriate for stationary flow 
normalization as well (and package size considerations make it difficult to
include specialized examples).
</p>


<h3>Value</h3>

<p>Dataframe with 7 columns and 2 rows.  The first row is about trends in concentration (mg/L), the second column is about trends in flux (million kg/year).
The data frame has a number of attributes.
</p>

<table>
<tr>
<td style="text-align: left;">
Column Name </td>
<td style="text-align: left;"> Description </td>
</tr>
<tr>
<td style="text-align: left;">
Total Change </td>
<td style="text-align: left;">   The difference between the results for group2 - group1 (x22 - x11). </td>
</tr>
<tr>
<td style="text-align: left;">
CQTC </td>
<td style="text-align: left;"> CQTC is the "Concentration v. Q Trend Component." It is the component of total change due to the change in the CQR (Concentration Discharge Relationship). (x20 - x10). </td>
</tr>
<tr>
<td style="text-align: left;">
QTC </td>
<td style="text-align: left;"> QTC is the "Q Trend Component." It is the component of total change due to the trend in the QD (Discharge Distribution). (x22 - x11 - x20 + x10). </td>
</tr>
<tr>
<td style="text-align: left;">
x10 </td>
<td style="text-align: left;"> The estimated value based on the CQR computed for the years in group1, integrated over the QD for the entire timespan of the Daily data frame (or the 
period QStartDate and to QEndDate if these are specified).</td>
</tr>
<tr>
<td style="text-align: left;">
x11 </td>
<td style="text-align: left;"> The estimated value based on the CQR for the years in group1, integrated over the QD specified by the user for group1. </td>
</tr>
<tr>
<td style="text-align: left;">
x20 </td>
<td style="text-align: left;"> The estimated value based on the CQR computed for the years in group2, integrated over the QD for the entire period of record. </td>
</tr>
<tr>
<td style="text-align: left;">
x22 </td>
<td style="text-align: left;"> The estimated value based on the CQR for the years in group2, integrated over the QD specified by the user for group2. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">eList &lt;- Choptank_eList


#Option 1:  Use all years for group flow normalization.
groupOut_1 &lt;- runGroups(eList,  windowSide = 0,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005)

# Option 2: Use sliding window.
#                In each case it is a 23 year window (23 = 1 + 2 * 11)

groupOut_2 &lt;- runGroups(eList,  windowSide = 11,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005)

# Option 3: Flow normalization is based on splitting the flow record at 1990-09-30
#                But in years before the break it uses all flow data from before the break,
#                and years after the break uses all flow data after the break

groupOut_3 &lt;- runGroups(eList,  windowSide = 0,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005,
                       flowBreak = TRUE, 
                       Q1EndDate = "1990-09-30")

# Option 4: Flow normalization is based on splitting the flow record at 1990-09-30
#                but before the break uses a 23 year window of years before the break
#                after the break uses a 23 year window of years after the break
groupOut_4 &lt;- runGroups(eList,  windowSide = 11,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005,
                       flowBreak = TRUE, 
                       Q1EndDate = "1990-09-30")


</code></pre>


</div>