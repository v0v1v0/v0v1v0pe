<div class="container">

<table style="width: 100%;"><tr>
<td>el.trun.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical likelihood ratio for mean with left truncated data</h2>

<h3>Description</h3>

<p>This program uses EM algorithm to compute the maximized
(wrt <code class="reqn">p_i</code>) empirical
log likelihood function for left truncated data with 
the MEAN constraint:
</p>
<p style="text-align: center;"><code class="reqn"> \sum  p_i f(x_i)  = \int f(t) dF(t) = \mu ~. </code>
</p>

<p>Where <code class="reqn">p_i = \Delta F(x_i)</code> is a probability.
<code class="reqn">\mu</code> is a given constant. 
It also returns those <code class="reqn">p_i</code> and the <code class="reqn">p_i</code> without
constraint, the Lynden-Bell estimator.
</p>
<p>The log likelihood been maximized is
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{i=1}^n \log \frac{\Delta F(x_i)}{1-F(y_i)} .</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">el.trun.test(y,x,fun=function(t){t},mu,maxit=20,error=1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector containing the left truncation times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector containing the survival times. truncation means x&gt;y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a continuous (weight) function used to calculate
the mean as in <code class="reqn">H_0</code>.
<code>fun(t)</code> must be able to take a vector input <code>t</code>.
Default to the identity function <code class="reqn">f(t)=t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a real number used in the constraint, mean value of <code class="reqn">f(X)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>an optional positive real number specifying the tolerance of
iteration error. This is the bound of the
<code class="reqn">L_1</code> norm of the difference of two successive weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer, used to control maximum number of
iterations. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This implementation is all in R and have several for-loops in it. 
A faster version would use C to do the for-loop part. But it seems
faster enough and is easier to port to Splus.
</p>
<p>When the given constants <code class="reqn">\mu</code> is too far
away from the NPMLE, there will be no distribution
satisfy the constraint.
In this case the computation will stop.
The -2 Log empirical likelihood ratio
should be infinite. 
</p>
<p>The constant <code>mu</code> must be inside 
<code class="reqn">( \min f(x_i) , \max f(x_i) ) </code>
for the computation to continue. 
It is always true that the NPMLE values are feasible. So when the
computation stops, try move the <code>mu</code> closer
to the NPMLE â€” 
</p>
<p style="text-align: center;"><code class="reqn"> \sum_{d_i=1} p_i^0 f(x_i) </code>
</p>
 
<p><code class="reqn">p_i^0</code> taken to be the jumps of the NPMLE of CDF. 
Or use a different <code>fun</code>. 
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"-2LLR"</code></td>
<td>
<p>the maximized empirical log likelihood ratio
under the constraint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPMLE</code></td>
<td>
<p>jumps of NPMLE of CDF at ordered x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPMLEmu</code></td>
<td>
<p>same jumps but for constrained NPMLE.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou </p>


<h3>References</h3>

<p>Zhou, M. (2005). Empirical likelihood ratio with arbitrary censored/truncated data by EM algorithm. 
<em>Journal of Computational and Graphical Statistics</em>, 
<b>14</b>, 643-656.
</p>
<p>Li, G. (1995).
Nonparametric likelihood ratio estimation 
of probabilities for truncated data. 
<em>JASA</em> <b>90</b>, 997-1003.
</p>
<p>Turnbull (1976).
The empirical distribution function with arbitrarily grouped, censored
and truncated data. <em>JRSS</em> B <b>38</b>, 290-295.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example with tied observations
vet &lt;- c(30, 384, 4, 54, 13, 123, 97, 153, 59, 117, 16, 151, 22, 56, 21, 18,
         139, 20, 31, 52, 287, 18, 51, 122, 27, 54, 7, 63, 392, 10)
vetstart &lt;- c(0,60,0,0,0,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
el.trun.test(vetstart, vet, mu=80, maxit=15)
</code></pre>


</div>