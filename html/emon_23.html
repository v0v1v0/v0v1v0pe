<div class="container">

<table style="width: 100%;"><tr>
<td>power.trend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Calculates power by simulation to detect a specified trend.</h2>

<h3>Description</h3>

<p>Calculates power for a specified trend wherethe signal for the trend is specified by xvalues and meanvalues (possibly
generated by generate.trend), and the error distribution is specified by distribution. The statistical method to detect
the trend
is specified by method.The power is the proportion of repeat simulations for which the trend is detected with a p-value
less than alpha (two-sided test).
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.trend(xvalues, reps=1,  meanvalues, distribution="Normal", sd=NA,
  nbsize=NA, method="linear regression", alpha=0.05, nsims=1000, nsims.mk=999,
  randeffect=F, randeffect.sd=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xvalues</code></td>
<td>
<p>Vector of, for example, time points at which the trend is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Vector of number of replicates per time point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanvalues</code></td>
<td>
<p>Vector of mean values that identify the signal of the trend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p> Distribution (must be one of <code>"Normal"</code>, <code>"Poisson"</code> or <code>"Negbin"</code> used to
generate random values based on the signal in <code>meanvalues</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p> Standard deviation if distribution=<code>"Normal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbsize</code></td>
<td>
<p> Size parameter if distribution=<code>"Negbin"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Method used to identify the trend. Can be one of <code>"linear regression"</code>, <code>"mk"</code>, or
<code>"gam"</code>. The last of these fits a Generalised
Additive Model (Wood, 2006) using function <code>gam</code>. It assumes Normal errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> Type 1 error for detecting trend. Values less than <code>alpha</code> cause the null hypothesis of
<code>no trend</code> to be rejected. Tests are 2-sided. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>
<p> The number of simulations to be used in calculating the power. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims.mk</code></td>
<td>
<p> The number of replicate permutations used in calculating the p-value for the Mann-Kendall test
when <code>method=mk</code>. Default is 999.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randeffect</code></td>
<td>
<p>Not working yet</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randeffect.sd</code></td>
<td>
<p>Not working yet</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Mann Kendall tests are approriate only for monotonic increasing or decreasing trends, the linear regression
method is
only approriate for linearly increasing or decreasing trend. The GAM is appropriate for changing trends over time.
</p>
<p>Several powers can be calculated on a single call to this function by placing more than one value in <code>reps</code>.
</p>


<h3>Value</h3>

<p> The power is returned. </p>


<h3>Author(s)</h3>

<p>David Maxwell: david.maxwell@cefas.co.uk
</p>


<h3>References</h3>

<p>Fryer RJ &amp; Nicholson MD (1993) Need paper title. ICES Journal of Marine Science, 50, 161-168.
</p>
<p>Fryer &amp; Nicholson 1999 Using smoothers for comprehensive assessments of contaminant time series in marine biota.
ICES Journal of Marine Science, 56, 779-790.
</p>
<p>Wood S.N. (2006) Generalized Additive Models: An Introduction with R. Chapman and Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code>mannkendall.stat</code>, <code>addnoise</code>,
<code>gam</code>, <code>generate.trend</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mgcv)

# In practice, \code{nsims} would be set to at least 1000

par(mfrow=c(2,2))
lin5 = generate.trend(nyears=10, change=5, type="linear")
plot(lin5$i, lin5$mu)
updown = generate.trend(nyears=15, change=5, type="updown", changeyear=8)
plot(updown$i, updown$mu)

power.trend(xvalues=lin5$i, meanvalues=lin5$mu, distribution="Normal", sd=2,
            method="linear regression", alpha=0.05, nsims=50)
power.trend(xvalues=lin5$i, meanvalues=lin5$mu, distribution="Poisson", method="mk", alpha=0.05,
      nsims=50)
power.trend(xvalues=updown$i, meanvalues=updown$mu, distribution="Normal", sd=2,
            method="gam", alpha=0.05, nsims=50)
</code></pre>


</div>