<div class="container">

<table style="width: 100%;"><tr>
<td>xl_write</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write tables and other objects to an xlsx file with formatting</h2>

<h3>Description</h3>

<p>Note that <code>openxlsx</code> package is required for these functions. It can be
install by printing <code>install.packages('openxlsx')</code> in the console. On
Windows system you also may need to
install <a href="https://cran.r-project.org/bin/windows/Rtools/">rtools</a>. You
can export several tables at once by combining them in a list. See examples.
If you need to write all tables to the single sheet you can use
<code>xl_write_file</code>. It automatically creates workbook, worksheet and save
*.xlsx file for you.
</p>


<h3>Usage</h3>

<pre><code class="language-R">xl_write(obj, wb, sheet, row = 1, col = 1, ...)

xl_write_file(obj, filename, sheetname = "Tables", ...)

## Default S3 method:
xl_write(
  obj,
  wb,
  sheet,
  row = 1,
  col = 1,
  rownames = FALSE,
  colnames = !is.atomic(obj),
  ...
)

## S3 method for class 'list'
xl_write(obj, wb, sheet, row = 1, col = 1, gap = 1, ...)

## S3 method for class 'etable'
xl_write(
  obj,
  wb,
  sheet,
  row = 1,
  col = 1,
  remove_repeated = c("all", "rows", "columns", "none"),
  format_table = TRUE,
  borders = list(borderColour = "black", borderStyle = "thin"),
  header_format = openxlsx::createStyle(fgFill = "#EBEBEB", halign = "left", wrapText =
    FALSE),
  main_format = openxlsx::createStyle(halign = "right", numFmt = format(0, nsmall =
    get_expss_digits())),
  row_labels_format = openxlsx::createStyle(halign = "left"),
  total_format = openxlsx::createStyle(fgFill = "#EBEBEB", border = "TopBottom",
    borderStyle = "thin", halign = "right", numFmt = "0"),
  total_row_labels_format = openxlsx::createStyle(fgFill = "#EBEBEB", border =
    "TopBottom", borderStyle = "thin", halign = "left"),
  top_left_corner_format = header_format,
  row_symbols_to_remove = NULL,
  col_symbols_to_remove = NULL,
  other_rows_formats = NULL,
  other_row_labels_formats = NULL,
  other_cols_formats = NULL,
  other_col_labels_formats = NULL,
  additional_cells_formats = NULL,
  ...
)

## S3 method for class 'with_caption'
xl_write(
  obj,
  wb,
  sheet,
  row = 1,
  col = 1,
  remove_repeated = c("all", "rows", "columns", "none"),
  format_table = TRUE,
  borders = list(borderColour = "black", borderStyle = "thin"),
  header_format = openxlsx::createStyle(fgFill = "#EBEBEB", halign = "left", wrapText =
    FALSE),
  main_format = openxlsx::createStyle(halign = "right", numFmt = format(0, nsmall =
    get_expss_digits())),
  row_labels_format = openxlsx::createStyle(halign = "left"),
  total_format = openxlsx::createStyle(fgFill = "#EBEBEB", border = "TopBottom",
    borderStyle = "thin", halign = "right", numFmt = "0"),
  total_row_labels_format = openxlsx::createStyle(fgFill = "#EBEBEB", border =
    "TopBottom", borderStyle = "thin", halign = "left"),
  top_left_corner_format = header_format,
  row_symbols_to_remove = NULL,
  col_symbols_to_remove = NULL,
  other_rows_formats = NULL,
  other_row_labels_formats = NULL,
  other_cols_formats = NULL,
  other_col_labels_formats = NULL,
  additional_cells_formats = NULL,
  caption_format = openxlsx::createStyle(textDecoration = "bold", halign = "left"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p><code>table</code> - result of cro, fre and etc.
<code>obj</code> also can be data.frame, list or other objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wb</code></td>
<td>
<p>xlsx workbook object, result of createWorkbook function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheet</code></td>
<td>
<p>character or numeric - worksheet name/number in the workbook <code>wb</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row</code></td>
<td>
<p>numeric - starting row for writing data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>numeric - starting column for writing data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments for <code>xl_write</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>A character string naming an xlsx file. For <code>xl_write_file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheetname</code></td>
<td>
<p>A character name for the worksheet. For <code>xl_write_file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rownames</code></td>
<td>
<p>logical should we write data.frame row names?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnames</code></td>
<td>
<p>logical should we write data.frame column names?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p>integer. Number of rows between list elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_repeated</code></td>
<td>
<p>Should we remove duplicated row or column labels in
the rows/columns of the etable? Possible values: "all", "rows", "columns", "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format_table</code></td>
<td>
<p>logical should we format table? If FALSE all format arguments will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borders</code></td>
<td>
<p>list Style of the table borders. List with two named elements:
<code>borderColour</code> and <code>borderStyle</code>. For details see
createStyle function. If it is NULL then no table borders will
be produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header_format</code></td>
<td>
<p>table header format - result of the createStyle function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_format</code></td>
<td>
<p>result of the createStyle function.
Format of the table main area except total rows. Total rows is rows which
row labels contain '#'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_labels_format</code></td>
<td>
<p>result of the createStyle function.
Format of the row labels area except total rows. Total rows is rows which
row labels contain '#'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_format</code></td>
<td>
<p>result of the createStyle function.
Format of the total rows in the table main area. Total rows is rows which
row labels contain '#'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_row_labels_format</code></td>
<td>
<p>result of the createStyle function.
Format of the total rows in the row labels area. Total rows is rows which
row labels contain '#'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top_left_corner_format</code></td>
<td>
<p>result of the createStyle function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_symbols_to_remove</code></td>
<td>
<p>character vector. Perl-style regular expressions
for substrings which will be removed from row labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_symbols_to_remove</code></td>
<td>
<p>character vector. Perl-style regular expressions
for substrings  which will be removed from column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_rows_formats</code></td>
<td>
<p>named list. Names of the list are perl-style
regular expression patterns, items of the list are results of the
createStyle function. Rows in the main area which row
labels contain pattern will be formatted according to the appropriate style.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_row_labels_formats</code></td>
<td>
<p>named list. Names of the list are perl-style
regular expression patterns, items of the list are results of the
createStyle function. Rows in the row labels area which row
labels contain pattern will be formatted according to the appropriate style.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_cols_formats</code></td>
<td>
<p>named list. Names of the list are perl-style
regular expression patterns, items of the list are results of the
createStyle function. Columns in the main area which column
labels contain pattern will be formatted according to the appropriate style.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_col_labels_formats</code></td>
<td>
<p>named list. Names of the list are perl-style
regular expression patterns, items of the list are results of the
createStyle function. Columns in the header area which column
labels contain pattern will be formatted according to the appropriate style.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional_cells_formats</code></td>
<td>
<p>list Each item of the list is list which
consists of two elements. First element is two columns matrix or data.frame
with row number and column numbers in the main area of the table. Such
matrix can be produced with code <code>which(logical_condition, arr.ind =
TRUE)</code>. Instead of matrix one can use function which accepts original table
(<code>obj</code>) and return such matrix. Second element is result of the
createStyle function. Cells in the main area will be
formatted according to this style.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption_format</code></td>
<td>
<p>result of the createStyle function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>invisibly return vector with rows and columns (<code>c(rows,
  columns)</code>) occupied by outputted object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(openxlsx)
data(mtcars)
# add labels to dataset
mtcars = apply_labels(mtcars,
                      mpg = "Miles/(US) gallon",
                      cyl = "Number of cylinders",
                      disp = "Displacement (cu.in.)",
                      hp = "Gross horsepower",
                      drat = "Rear axle ratio",
                      wt = "Weight (lb/1000)",
                      qsec = "1/4 mile time",
                      vs = "Engine",
                      vs = c("V-engine" = 0,
                             "Straight engine" = 1),
                      am = "Transmission",
                      am = c("Automatic" = 0,
                             "Manual"=1),
                      gear = "Number of forward gears",
                      carb = "Number of carburetors"
)

# create table with caption
mtcars_table = cross_cpct(mtcars,
                             cell_vars = list(cyl, gear),
                             col_vars = list(total(), am, vs)
) %&gt;% 
    set_caption("Table 1")


wb = createWorkbook()
sh = addWorksheet(wb, "Tables")
# export table
xl_write(mtcars_table, wb, sh)
saveWorkbook(wb, "table1.xlsx", overwrite = TRUE)

## quick export
xl_write_file(mtcars_table, "table1.xlsx")

## custom cells formatting
wb = createWorkbook()
sh = addWorksheet(wb, "Tables")

# we want to mark cells which are greater than total column
my_formatter = function(tbl){
    greater_than_total = tbl[,-1]&gt;tbl[[2]]
    which(greater_than_total, arr.ind = TRUE)
}
# export table
xl_write(mtcars_table, wb, sh, 
    additional_cells_formats = list(
        list(my_formatter, createStyle(textDecoration =  "bold", fontColour = "blue"))
    )
)
saveWorkbook(wb, "table_with_additional_format.xlsx", overwrite = TRUE)

## automated report generation on multiple variables with the same banner
 
banner = with(mtcars, list(total(), am, vs))

# create list of tables
list_of_tables = lapply(mtcars, function(variable) {
    if(length(unique(variable))&lt;7){
        cro_cpct(variable, banner) %&gt;% significance_cpct()
    } else {
        # if number of unique values greater than seven we calculate mean
        cro_mean_sd_n(variable, banner) %&gt;% significance_means()
        
    }
    
})


wb = createWorkbook()
sh = addWorksheet(wb, "Tables")
# export list of tables with additional formatting
xl_write(list_of_tables, wb, sh, 
         # remove '#' sign from totals 
         col_symbols_to_remove = "#",
         row_symbols_to_remove = "#",
         # format total column as bold
         other_col_labels_formats = list("#" = createStyle(textDecoration = "bold")),
         other_cols_formats = list("#" = createStyle(textDecoration = "bold")),
)
saveWorkbook(wb, "report.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>


</div>