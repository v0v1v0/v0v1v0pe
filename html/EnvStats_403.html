<div class="container">

<table style="width: 100%;"><tr>
<td>plotTTestLnormAltDesign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plots for a Sampling Design Based on a One- or Two-Sample t-Test, Assuming Lognormal Data 
</h2>

<h3>Description</h3>

<p>Create plots involving sample size, power, ratio of means, coefficient of variation, 
and significance level for a one- or two-sample t-test, assuming lognormal data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plotTTestLnormAltDesign(x.var = "n", y.var = "power", range.x.var = NULL, 
    n.or.n1 = 25, n2 = n.or.n1, 
    ratio.of.means = switch(alternative, greater = 2, less = 0.5, 
      two.sided = ifelse(two.sided.direction == "greater", 2, 0.5)), 
    cv = 1, alpha = 0.05, power = 0.95, 
    sample.type = ifelse(!missing(n2), "two.sample", "one.sample"), 
    alternative = "two.sided", two.sided.direction = "greater", approx = FALSE, 
    round.up = FALSE, n.max = 5000, tol = 1e-07, maxiter = 1000, plot.it = TRUE, 
    add = FALSE, n.points = 50, plot.col = "black", plot.lwd = 3 * par("cex"), 
    plot.lty = 1, digits = .Options$digits, cex.main = par("cex"), ..., 
    main = NULL, xlab = NULL, ylab = NULL, type = "l")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.var</code></td>
<td>

<p>character string indicating what variable to use for the x-axis.  
Possible values are <code>"n"</code> (sample size; the default), 
<code>"ratio.of.means"</code> (minimal or maximal detectable ratio of means), 
<code>"cv"</code> (coefficient of variaiton), <code>"power"</code> (power of the test), and 
<code>"alpha"</code> (significance level of the test).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.var</code></td>
<td>

<p>character string indicating what variable to use for the y-axis.  
Possible values are <code>"power"</code> (power of the test; the default), 
<code>"ratio.of.means"</code> (minimal or maximal detectable ratio of means), and 
<code>"n"</code> (sample size). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.x.var</code></td>
<td>

<p>numeric vector of length 2 indicating the range of the x-variable to use 
for the plot.  The default value depends on the value of <code>x.var</code>:
</p>

<ul>
<li>
<p> When <code>x.var="n"</code> the default value is <code>c(2,50)</code>.  
</p>
</li>
<li>
<p> When <code>x.var="ratio.of.means"</code> and <code>alternative="greater"</code> or <br><code>alternative="two.sided"</code> and <code>two.sided.direction="greater"</code>, 
the default value is <code>c(1, 2)</code>.  
</p>
</li>
<li>
<p> When <code>x.var="delta"</code> and <code>alternative="less"</code> or <br><code>alternative="two.sided"</code> and <code>two.sided.direction="less"</code>, 
the default value is <code>c(0.5, 1)</code>.  
</p>
</li>
<li>
<p> When <code>x.var="cv"</code> the default value is <code>c(0.5, 2)</code>.  
</p>
</li>
<li>
<p> When <code>x.var="power"</code> the default value is <br><code>c(alpha + .Machine$double.eps, 0.95)</code>.  
</p>
</li>
<li>
<p> When <code>x.var="alpha"</code>, the default value is <code>c(0.01, 0.2)</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.or.n1</code></td>
<td>

<p>numeric scalar indicating the sample size.  The default value is 
<code>n.or.n1=25</code>.  When <code>sample.type="one.sample"</code>, <code>n.or.n1</code> 
denotes the number of observations in the single sample.  When 
<code>sample.type="two.sample"</code>, <code>n.or.n1</code> denotes the number of 
observations from group 1.  Missing (<code>NA</code>), undefined (<code>NaN</code>), 
and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.  This 
argument is ignored if either <code>x.var="n"</code> or <code>y.var="n"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>

<p>numeric scalar indicating the sample size for group 2.  The default value 
is the value of <code>n.or.n1</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), 
and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.  This 
argument is ignored when <code>sample.type="one.sample"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.of.means</code></td>
<td>

<p>numeric scalar specifying the ratio of the first mean to the second mean.  When 
<code>sample.type="one.sample"</code>, this is the ratio of the population mean to the 
hypothesized mean.  When <code>sample.type="two.sample"</code>, this is the ratio of the 
mean of the first population to the mean of the second population. 
</p>
<p>When <code>alternative="greater"</code> or <code>alternative="two.sided"</code> and <br><code>two.sided.direction="greater"</code>, the default value is <code>ratio.of.means=2</code>.  
When <code>alternative="less"</code> or <br><code>alternative="two.sided"</code> and 
<code>two.sided.direction="less"</code>, the default value is <code>ratio.of.means=0.5</code>.  
This argument is ignored when <br><code>x.var="ratio.of.means"</code> or <code>y.var="ratio.of.means"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>

<p>numeric scalar: a positive value specifying the coefficient of 
variation.  When <code>sample.type="one.sample"</code>, this is the population coefficient 
of variation.  When <code>sample.type="two.sample"</code>, this is the coefficient of 
variation for both the first and second population.  The default value is <code>cv=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric scalar between 0 and 1 indicating the Type I error level 
associated with the hypothesis test.  The default value is <code>alpha=0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>numeric scalar between 0 and 1 indicating the power  
associated with the hypothesis test.  The default value is <code>power=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.type</code></td>
<td>

<p>character string indicating whether to compute power based on a one-sample or 
two-sample hypothesis test.  When <code>sample.type="one.sample"</code>, the computed 
power is based on a hypothesis test for a single mean.  When <br><code>sample.type="two.sample"</code>, the computed power is based on a hypothesis test 
for the difference between two means.  The default value is <br><code>sample.type="one.sample"</code> unless the argument <code>n2</code> is supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>character string indicating the kind of alternative hypothesis.  The possible values 
are <code>"two.sided"</code> (the default), <code>"greater"</code>, and <code>"less"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided.direction</code></td>
<td>

<p>character string indicating the direction (greater than 1 or less than 1) for the 
detectable ratio of means when <code>alternative="two.sided"</code>.  When <br><code>two.sided.direction="greater"</code> (the default), the detectable ratio of means 
is greater than 1.  When <br><code>two.sided.direction="less"</code>, the detectable ratio of 
means is less than 1 (but greater than 0).  This argument is ignored if 
<code>alternative="less"</code> or <br><code>alternative="greater"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>

<p>logical scalar indicating whether to compute the power based on an approximation to 
the non-central t-distribution.  The default value is <code>approx=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round.up</code></td>
<td>

<p>logical scalar indicating whether to round up the values of the computed 
sample size(s) to the next smallest integer.  The default value is 
<code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.max</code></td>
<td>

<p>for the case when <code>y.var="n"</code>, a positive integer greater than 1 indicating 
the maximum sample size when <code>sample.type="one.sample"</code> or the maximum sample 
size for group 1 when <code>sample.type="two.sample"</code>.  The default value is 
<code>n.max=5000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>numeric scalar indicating the toloerance to use in the 
<code>uniroot</code> search algorithm.  
The default value is <code>tol=1e-7</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>positive integer indicating the maximum number of iterations 
argument to pass to the <code>uniroot</code> function.  The default 
value is <code>maxiter=1000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>a logical scalar indicating whether to create a new plot or add to the existing plot 
(see <code>add</code>) on the current graphics device.  If <code>plot.it=FALSE</code>, no plot 
is produced, but a list of (x,y) values is returned (see VALUE).  The default value 
is <code>plot.it=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>a logical scalar indicating whether to add the design plot to the 
existing plot (<code>add=TRUE</code>), or to create a plot from scratch 
(<code>add=FALSE</code>).  The default value is <code>add=FALSE</code>.  
This argument is ignored if <code>plot.it=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>

<p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.  
There are <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>.  The default value is <code>n.points=100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the plotted 
line or points.  The default value is <code>plot.col="black"</code>.  See the 
entry for <code>col</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lwd</code></td>
<td>

<p>a numeric scalar determining the width of the plotted line.  The default value is 
<code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the plotted line.  The default value is 
<code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print out on the plot.  The default 
value is the current setting of <code>options("digits")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main, main, xlab, ylab, type, ...</code></td>
<td>

<p>additional graphical parameters (see <code>par</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help files for <code>tTestLnormAltPower</code>, 
<code>tTestLnormAltN</code>, and <code>tTestLnormAltRatioOfMeans</code> for 
information on how to compute the power, sample size, or ratio of means for a 
one- or two-sample t-test assuming lognormal data.
</p>


<h3>Value</h3>

<p><code>plotTTestLnormAltDesign</code> invisibly returns a list with components 
<code>x.var</code> and <code>y.var</code>, giving coordinates of the points that have 
been or would have been plotted.
</p>


<h3>Note</h3>

<p>See the help files for <code>tTestLnormAltPower</code>, 
<code>tTestLnormAltN</code>, and <code>tTestLnormAltRatioOfMeans</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the help files for <code>tTestLnormAltPower</code>, 
<code>tTestLnormAltN</code>, and <code>tTestLnormAltRatioOfMeans</code>.
</p>


<h3>See Also</h3>

<p><code>tTestLnormAltPower</code>, <code>tTestLnormAltN</code>, 
<code>tTestLnormAltRatioOfMeans</code>, <code>t.test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Look at the relationship between power and sample size for a two-sample t-test, 
  # assuming lognormal data, a ratio of means of 2, a coefficient of variation 
  # of 1, and a 5% significance level:

  dev.new()
  plotTTestLnormAltDesign(sample.type = "two")

  #----------

  # For a two-sample t-test based on lognormal data, plot sample size vs. the 
  # minimal detectable ratio for various levels of power, assuming a coefficient 
  # of variation of 1 and using a 5% significance level:

  dev.new()
  plotTTestLnormAltDesign(x.var = "ratio.of.means", y.var = "n", 
    range.x.var = c(1.5, 2), sample.type = "two", ylim = c(20, 120), main="") 

  plotTTestLnormAltDesign(x.var = "ratio.of.means", y.var = "n", 
    range.x.var = c(1.5, 2), sample.type="two", power = 0.9, 
    add = TRUE, plot.col = "red") 

  plotTTestLnormAltDesign(x.var = "ratio.of.means", y.var = "n", 
    range.x.var = c(1.5, 2), sample.type="two", power = 0.8, 
    add = TRUE, plot.col = "blue") 

  legend("topright", c("95%", "90%", "80%"), lty=1, lwd = 3*par("cex"), 
    col = c("black", "red", "blue"), bty = "n") 

  title(main = paste("Sample Size vs. Ratio of Lognormal Means for", 
    "Two-Sample t-Test, with CV=1, Alpha=0.05 and Various Powers", 
    sep="\n")) 

  #==========

  # The guidance document Soil Screening Guidance: Technical Background Document 
  # (USEPA, 1996c, Part 4) discusses sampling design and sample size calculations 
  # for studies to determine whether the soil at a potentially contaminated site 
  # needs to be investigated for possible remedial action. Let 'theta' denote the 
  # average concentration of the chemical of concern.  The guidance document 
  # establishes the following goals for the decision rule (USEPA, 1996c, p.87):
  #
  #     Pr[Decide Don't Investigate | theta &gt; 2 * SSL] = 0.05
  #
  #     Pr[Decide to Investigate | theta &lt;= (SSL/2)] = 0.2
  #
  # where SSL denotes the pre-established soil screening level.
  #
  # These goals translate into a Type I error of 0.2 for the null hypothesis
  #
  #     H0: [theta / (SSL/2)] &lt;= 1
  #
  # and a power of 95% for the specific alternative hypothesis
  #
  #     Ha: [theta / (SSL/2)] = 4
  #
  # Assuming a lognormal distribution, a coefficient of variation of 2, and the above 
  # values for Type I error and power, create a performance goal diagram 
  # (USEPA, 1996c, p.89) showing the power of a one-sample test versus the minimal 
  # detectable ratio of theta/(SSL/2) when the sample size is 6 and the exact power 
  # calculations are used.

  dev.new()
  plotTTestLnormAltDesign(x.var = "ratio.of.means", y.var = "power", 
    range.x.var = c(1, 5), n.or.n1 = 6, cv = 2, alpha = 0.2, 
    alternative = "greater", approx = FALSE, ylim = c(0.2, 1), 
    xlab = "theta / (SSL/2)") 

  #==========

  # Clean up
  #---------
  graphics.off()
</code></pre>


</div>