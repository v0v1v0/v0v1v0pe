<div class="container">

<table style="width: 100%;"><tr>
<td>histosmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Histogram smoothing with Laplacian-P-splines</h2>

<h3>Description</h3>

<p>This function provides a smooth density estimate to a histogram using
Laplacian-P-splines. The B-spline basis is computed on the midpoints of
the histogram bins. The default number of (cubic) B-splines is 30 and
a third-order penalty is specified. The negative binomial distribution is
used to model the number of observations falling in each bin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">histosmooth(x, xl = min(x), xr = max(x), K = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of real numbers from which the histogram will be constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xl</code></td>
<td>
<p>The left bound for the domain of <code>x</code> which also coincides
with the left bound of the domain of the B-spline basis. The default is
taken to be the minimum of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xr</code></td>
<td>
<p>The right bound for the domain of <code>x</code> which also coincides
with the right bound of the domain of the B-spline basis. The default is
taken to be the maximum of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of B-splines in the basis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the left (<code>xl</code>)
and right (<code>xr</code>) bounds of the domain of the estimated density, the
binwidth and a function to be evaluated between <code>xl</code> and <code>xr</code>.
</p>


<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>
</p>


<h3>References</h3>

<p>Gressani, O. and Lambert, P. (2018). Fast Bayesian inference
using Laplace approximations in a flexible promotion time cure model based
on P-splines. <em>Computational Statistical &amp; Data Analysis</em> <strong>124</strong>:
151-167.
</p>
<p>Gressani, O., Wallinga, J., Althaus, C. L., Hens, N. and Faes, C.
(2022). EpiLPS: A fast and flexible Bayesian tool for estimation of the
time-varying reproduction number. <em>Plos Computational Biology</em>,
<strong>18</strong>(10): e1010618.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Old Faithful geyser application
data(eruptions)
x &lt;- eruptions
ffit &lt;- histosmooth(x, xl = 1, xr = 6)
tt &lt;- seq(ffit$xl, ffit$xr, length = 500)
dtt &lt;- tt[2] - tt[1]
graphics::hist(x, breaks = seq(ffit$xl, ffit$xr, by = ffit$binwidth),
     freq = FALSE, ylim = c(0, 0.8), main = "Old Faithful Geyser",
    xlab = "Eruption time (minutes)")
densfit &lt;- sapply(tt, ffit$fdens)
densfit &lt;- densfit / (sum(densfit * dtt))
graphics::lines(tt, densfit, col = "red", lwd = 2)

</code></pre>


</div>