<div class="container">

<table style="width: 100%;"><tr>
<td>test_procedure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to provide summary and test statistics based on simulation.</h2>

<h3>Description</h3>

<p>Provides summary and test statistics based on simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_procedure(
  pilevel = 0.9,
  nyears = 4,
  enroll_fit = enroll_fit,
  dropout_fit = dropout_fit,
  enroll_prior = NULL,
  event_prior_h0 = NULL,
  event_prior_ha = NULL,
  dropout_prior = NULL,
  target_n,
  target_IA_d,
  target_d,
  ialpha = 0.025,
  falpha,
  lag,
  by_fitted_enroll = FALSE,
  by_fitted_dropout = FALSE,
  treatment_label,
  ngroups = 2,
  alloc = NULL,
  nreps = 500,
  IA_included,
  test = "Superiority",
  test_IA = "Superiority",
  Futility_boundary = 1,
  seed.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pilevel</code></td>
<td>
<p>the confidence interval, the default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyears</code></td>
<td>
<p>the year after data cutoff or follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enroll_fit</code></td>
<td>
<p>an object generated from <code>fitEnrollment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout_fit</code></td>
<td>
<p>an object generated from <code>fitDropout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enroll_prior</code></td>
<td>
<p>The prior of enrollment model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_prior_h0</code></td>
<td>
<p>The prior of event model parameters under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_prior_ha</code></td>
<td>
<p>The prior of event model parameters under alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout_prior</code></td>
<td>
<p>The prior of dropout model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_n</code></td>
<td>
<p>The target number of subjects to enroll in the study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_IA_d</code></td>
<td>
<p>number of events needed for interim analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_d</code></td>
<td>
<p>number of events needed for primary analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ialpha</code></td>
<td>
<p>interim analysis alpha nominal value (only one interim allowed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>falpha</code></td>
<td>
<p>primary analysis alpha nominal value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>a scalar to denote time (days). Hazard ratio before and after this time would be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_fitted_enroll</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict enrollment time with fitted model. By default, it is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_fitted_dropout</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict dropout time with fitted model. By default, it is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment_label</code></td>
<td>
<p>The treatment labels for treatments in a
randomization block for design stage prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngroups</code></td>
<td>
<p>The number of treatment groups for enrollment prediction
at the design stage. By default, it is set to 2.
It is replaced with the actual number of
treatment groups in the observed data if <code>df</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alloc</code></td>
<td>
<p>The treatment allocation in a randomization block.
By default, it is set to <code>NULL</code>, which yields equal allocation
among the treatment groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>The number of replications for simulation. By default,
it is set to 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IA_included</code></td>
<td>
<p>A Boolean variable to control whether or not to
include one interim analysis. By default, it is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a character denotes the test type, includes "Superiority","Futility","Two-sided"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_IA</code></td>
<td>
<p>a character denotes the test type in interim analysis, includes "Efficacy","Futility",or "Efficacy and Futility"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Futility_boundary</code></td>
<td>
<p>a positive number denotes the boundary of the Futility in the scale of hazard ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.num</code></td>
<td>
<p>The number of the random seed. The default is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with following components
</p>

<ul>
<li>
<p> iteration0 - the number of simulations that achieved target number of events in interim analysis and primary analysis under null hypothesis.
</p>
</li>
<li>
<p> iteration1 - the number of simulations that achieved target number of events in interim analysis and primary analysis under alternative hypothesis.
</p>
</li>
<li>
<p> simu_summary - the summary table of number of simulations that achieved or do not achieve target number of events in each analysis under null hypothesis and alternative hypothesis.
</p>
</li>
<li>
<p> power - the alpha and powers from log-rank test and Fleming&amp;Harrington test
</p>
</li>
<li>
<p> samplesize - the counts per arm and total, includes the number of patients,
events at interim analysis and primary analysis, events at interim analysis before delay,
events at primary analysis before delay
</p>
</li>
<li>
<p> hzratio - average hazard ratio at primary analysis and interim analysis
</p>
</li>
<li>
<p> hzrc - Frequencies of hazard ratios in specific zones
</p>
</li>
<li>
<p> hzratio2 - HR before and after delay
</p>
</li>
<li>
<p> median - Medians of survival time at interim analysis and primary analysis
</p>
</li>
<li>
<p> osrate - survival rate at milestones (1, 2 and 4 years)
</p>
</li>
<li>
<p> duration - Study duration for enrollment, interim analysis and primary analysis
</p>
</li>
<li>
<p> duration1 - Durations for interim analysis and primary analysis with 95% CI
</p>
</li>
<li>
<p> textH0 - the summary text of number of simulations that achieved or do not achieve target number of events in primary analysis under null hypothesis.
</p>
</li>
<li>
<p> textHA - the summary text of number of simulations that achieved or do not achieve target number of events in primary analysis under alternative hypothesis.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
fit1 &lt;- list(model = "piecewise uniform",
             theta = -0.58, 
             vtheta=0, accrualTime =0)
fit2&lt;-list()
fit2[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit2[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                 theta = c(-2.2,0,6.5,46,0.65), 
                 vtheta = matrix(0,5,5))
fit3 &lt;-list()
fit3[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit3[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1),
                  vtheta = matrix(0,5,5))
fit4 &lt;-list()

fit4[[1]] &lt;- list(model = "exponential", 
                   theta =log(0.0003), 
                   vtheta=0)
fit4[[2]] &lt;- list(model = "exponential", 
                   theta =log(0.0003), 

                   vtheta=0)
test1&lt;-test_procedure(pilevel=0.9,nyears=4,enroll_fit=fit1,
                      dropout_fit=fit4,enroll_prior=fit1,event_prior_h0=fit3,
                      event_prior_ha=fit2,dropout_prior=NULL,
                      target_n=200,target_IA_d=40,target_d=60,
                      ialpha=0.016,falpha=0.0450,
                      lag=46,by_fitted_enroll=FALSE,
                      by_fitted_dropout=FALSE,treatment_label=c('a','b'),
                      ngroups=2,alloc=c(1,1),nreps=100, IA_included=TRUE)
                       
</code></pre>


</div>