<div class="container">

<table style="width: 100%;"><tr>
<td>varmod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance models for estimating prediction intervals</h2>

<h3>Description</h3>

<p>A <em>variance model</em> estimates the variance of predicted values.
It can be used to estimate prediction intervals.
See the <code>interval</code> argument of <code>predict.earth</code>.
</p>
<p>A variance model is built by <code>earth</code> if <code>earth</code>'s
<code>varmod.method</code> argument is specified.
Results are stored in the <code>$varmod</code> field of the <code>earth</code> model.
See the vignette “<a href="../doc/earth-varmod.pdf">Variance models in earth</a>” for details.
</p>
<p>You probably won't need to directly call
<code>print.varmod</code> or <code>summary.varmod</code>.
They get called internally by <code>summary.earth</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'varmod'
summary(
    object  = stop("no 'object' argument"),
    level   = .95,
    style   = "standard",
    digits  = 2,
    newdata = NULL,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>varmod</code> object.  This is the only required argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>Same as <code>predict.earth</code>'s <code>level</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>

<p>Determines how the coefficients of the <code>varmod</code> are printed
by <code>summary.varmod</code>:<br><code>"standard"</code> (default)<br><code>"unit"</code> for easy comparison normalize the coefficients
by dividing by the first coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>Number of digits to print.  Default is <code>2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>

<p>Default <code>NULL</code>.<br>
Else print the interval coverage table for the new data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Dots are passed on.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>A <code>"varmod"</code> object has the following fields:
</p>

<ul>
<li>
<p><code>call</code>
The call used internally in the parent model to build the <code>varmod</code> object.
</p>
</li>
<li>
<p><code>parent</code> The parent <code>earth</code> model.
</p>
</li>
<li>
<p><code>method</code> Copy of the <code>varmod.method</code> argument to the parent model.
</p>
</li>
<li>
<p><code>package</code> NULL, unless <code>method="gam"</code>, in which case either <code>"gam"</code> or <code>"mgcv"</code>.
</p>
</li>
<li>
<p><code>exponent</code> Copy of the <code>varmod.exponent</code> argument to the parent model.
</p>
</li>
<li>
<p><code>lambda</code> Currently always 1, meaning use absolute residuals.
</p>
</li>
<li>
<p><code>rmethod</code> Currently always "hc2", meaning correct the residuals with <code>1/(1-h_ii)</code>.
</p>
</li>
<li>
<p><code>converged</code> Did the residual submodel IRLS converge?
</p>
</li>
<li>
<p><code>iters</code> Number of residual model IRLS iterations (1 to 50).
</p>
</li>
<li>
<p><code>residmod</code> The residual submodel.
So for example, if <code>varmod.method="lm"</code>, this will be an <code>lm</code> object.
</p>
</li>
<li>
<p><code>min.sd</code>
The predicted residual standard deviation is clamped
so it will always be at least this value.
This prevents prediction of negative or absurdly small variances.
See <code>earth</code>'s <code>varmod.clamp</code> argument.
Clamping takes place in <code>predict.varmod</code>, which is called
by <code>predict.earth</code> when estimating prediction intervals.
</p>
</li>
<li>
<p><code>model.var</code>
An n x 1 matrix.
The <code>model.var</code> for an observation is the estimated model
variance for that observation over all datasets, and is estimated with
repeated cross validation.
It is the variance of the mean out-of-fold prediction for that
observation over <code>ncross</code> repetitions.
</p>
</li>
<li>
<p><code>abs.resids</code>
An n x 1 matrix.
The absolute residuals used to build the residual model.
</p>
</li>
<li>
<p><code>parent.x</code>
An n x p matrix. Parent earth model <code>x</code>.
</p>
</li>
<li>
<p><code>parent.y</code>
An n x 1 matrix. Parent earth model <code>y</code>.
</p>
</li>
<li>
<p><code>iter.rsq</code>
Weighted R-Squared of residual submodel <code>residmod</code>,
after IRLS iteration.
</p>
</li>
<li>
<p><code>iter.stderr</code>
Standard errors of the coefficients of the residual submodel <code>residmod</code>,
after IRLS iteration.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>plot.varmod</code>,
<code>predict.varmod</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ozone1)

set.seed(1) # optional, for cross validation reproducibility

# note: should really use ncross=30 below but for a quick demo we don't

earth.mod &lt;- earth(O3~temp, data=ozone1, nfold=10, ncross=3, varmod.method="lm")

print(summary(earth.mod)) # note additional info on the variance model

old.mfrow &lt;- par(mfrow=c(2,2), mar=c(3, 3, 3, 1), mgp=c(1.5, 0.5, 0))

plotmo(earth.mod, do.par=FALSE, response.col=1, level=.90, main="earth model: O3~temp")

plot(earth.mod, which=3, level=.90) # residual plot: note 90% pred and darker conf intervals

par(par=old.mfrow)
</code></pre>


</div>