<div class="container">

<table style="width: 100%;"><tr>
<td>edgeworth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Edgeworth Approximation</h2>

<h3>Description</h3>

<p>Computes the Edgeworth expansion of either the
standardized mean, the mean or the sum of i.i.d. random variables. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">edgeworth(x, n, rho3, rho4, mu, sigma2, deg=3,
          type = c("standardized", "mean", "sum"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector or array giving the values at which the
approximation should be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a positive integer giving the number of i.i.d. random
variables in the sum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho3</code></td>
<td>
<p>a numeric value giving the standardized 3rd cumulant. May
be missing if <code>deg &lt;= 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho4</code></td>
<td>
<p>a numeric value giving the standardized 4th cumulant. May
be missing if <code>deg &lt;= 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a numeric value giving the mean.
</p>
<p>May be missing if <code>type = "standardized"</code>, since it is
only needed for transformation purposes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>a positive numeric value giving the variance.
</p>
<p>May be missing if <code>type= "standardized"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deg</code></td>
<td>
<p>an integer value giving the order of the approximation:
</p>

<ul>
<li> <p><code>deg=1</code>: corresponds to a normal approximation
</p>
</li>
<li> <p><code>deg=2</code>: takes 3rd cumulant into account
</p>
</li>
<li> <p><code>deg=3</code>: allows for the 4th cumulant as well.
The default value is 3.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>determines which sum should be approximated. Must be one
of (“standardized”, “mean”, “sum”),
representing the shifted and scaled sum, the weighted sum and the
raw sum. Can be abbreviated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Edgeworth approximation (<abbr><span class="acronym">EA</span></abbr>) for the density of the
standardized mean <code class="reqn">Z=\frac{S_n-n\mu}
    {\sqrt{n\sigma^2}}</code>, where
</p>

<ul>
<li> <p><code class="reqn">S_n = Y_1 + \ldots + Y_n</code> denotes the sum of i.i.d. random
variables,
</p>
</li>
<li> <p><code class="reqn">\mu</code> denotes the expected value of <code class="reqn">Y_i</code>,
</p>
</li>
<li> <p><code class="reqn">\sigma^2</code> denotes the variance of <code class="reqn">Y_i</code>
</p>
</li>
</ul>
<p>is given by:
</p>
<p style="text-align: center;"><code class="reqn">f_{Z}(s)=\varphi(s)[ 1 + \frac{\rho_3}{6\sqrt{n}} H_3(s) +
    \frac{\rho_4}{24n} H_4(s) + \frac{\rho_3^2}{72n} H_6(s)],</code>
</p>


<p>with <code class="reqn">\varphi</code> denoting the density of the standard normal
distribution and <code class="reqn">\rho_3</code> and <code class="reqn">\rho_4</code> denoting
the 3rd and the 4th standardized cumulants of <code class="reqn">Y_i</code>
respectively. <code class="reqn">H_n(x)</code> denotes the <code class="reqn">n</code>th Hermite polynomial (see
<code>hermite</code> for details).
</p>
<p>The <abbr><span class="acronym">EA</span></abbr> for the mean and the sum can be obtained by applying
the transformation theorem for densities. In this case, the expected
value <code>mu</code> and the variance <code>sigma2</code> must be given to allow
for an appropriate transformation.
</p>


<h3>Value</h3>

<p><code>edgeworth</code> returns an object of the class
<code>approximation</code>. See <code>approximation</code> for further
details.
</p>


<h3>Author(s)</h3>

<p>Thorn Thaler</p>


<h3>References</h3>

<p>Reid, N. (1991).  Approximations and Asymptotics. <em>Statistical
Theory and Modelling</em>, London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>approximation</code>,<code>hermite</code>,<code>saddlepoint</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Approximation of the mean of n iid Chi-squared(2) variables

n &lt;- 10
df &lt;- 2
mu &lt;- df
sigma2 &lt;- 2*df
rho3 &lt;- sqrt(8/df)
rho4 &lt;- 12/df
x &lt;- seq(max(df-3*sqrt(2*df/n),0), df+3*sqrt(2*df/n), length=1000)
ea &lt;- edgeworth(x, n, rho3, rho4, mu, sigma2, type="mean")
plot(ea, lwd=2)

# Mean of n Chi-squared(2) variables is n*Chi-squared(n*2) distributed
lines(x, n*dchisq(n*x, df=n*mu), col=2)
</code></pre>


</div>