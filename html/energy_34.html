<div class="container">

<table style="width: 100%;"><tr>
<td>mvI.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Independence Coefficient and Test</h2>

<h3>Description</h3>

<p>Computes a type of multivariate nonparametric E-statistic and test of independence
based on independence coefficient <code class="reqn">\mathcal I_n</code>. This coefficient pre-dates and is different from distance covariance or distance correlation.</p>


<h3>Usage</h3>

<pre><code class="language-R">    mvI.test(x, y, R)
    mvI(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> matrix: first sample, observations in rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> matrix: second sample, observations in rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of replicates</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mvI</code> computes the coefficient <code class="reqn">\mathcal I_n</code> and <code>mvI.test</code> performs a nonparametric test of independence. The test decision is obtained via permutation 
bootstrap, with <code>R</code> replicates.
The sample sizes (number of rows) of the two samples must agree, and
samples must not contain missing values. 
</p>
<p>Historically this is the first energy test of independence. The
distance covariance test  <code>dcov.test</code>, distance correlation <code>dcor</code>, and related methods are more recent (2007, 2009).
</p>
<p>The distance covariance test <code>dcov.test</code> and distance correlation test <code>dcor.test</code> are much faster and have  different properties than <code>mvI.test</code>. All are based on a population independence coefficient that characterizes independence and of these tests are statistically consistent. However, dCor is scale invariant while <code class="reqn">I_n</code> is not. In applications <code>dcor.test</code> or <code>dcov.test</code> are the recommended tests. 
</p>
<p>Computing formula from Bakirov, Rizzo, and Szekely (2006), equation (2): 
</p>
<p>Suppose the two samples are <code class="reqn">X_1,\dots,X_n \in R^p</code> and <code class="reqn">Y_1,\dots,Y_n \in R^q</code>. Define <code class="reqn">Z_{kl} = (X_k, Y_l) \in R^{p+q}.</code> 
</p>
<p>The independence coefficient <code class="reqn">\mathcal I_n</code> is defined
</p>
<p style="text-align: center;"><code class="reqn">
\mathcal I_n = \sqrt{\frac{2\bar z - z_d - z}{x + y - z}}, 
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">z_d= \frac{1}{n^2} \sum_{k,l=1}^n |Z_{kk}-Z_{ll}|_{p+q},</code>
</p>

<p style="text-align: center;"><code class="reqn">z= \frac{1}{n^4} \sum_{k,l=1}^n \sum_{i,j=1}^n |Z_{kl}-Z_{ij}|_{p+q},</code>
</p>

<p style="text-align: center;"><code class="reqn">\bar z= \frac{1}{n^3} \sum_{k=1}^n \sum_{i,j=1}^n |Z_{kk}-Z_{ij}|_{p+q},</code>
</p>

<p style="text-align: center;"><code class="reqn">x= \frac{1}{n^2} \sum_{k,l=1}^n |X_{k}-X_{l}|_p,</code>
</p>

<p style="text-align: center;"><code class="reqn">y= \frac{1}{n^2} \sum_{k,l=1}^n |Y_{k}-Y_{l}|_q.</code>
</p>

<p>Some properties:
</p>

<ul>
<li> 
<p><code class="reqn">0 \leq \mathcal I_n \leq 1</code> (Theorem 1).
</p>
</li>
<li> 
<p>Large values of <code class="reqn">n \mathcal I_n^2</code> (or <code class="reqn">\mathcal I_n</code>)  support the alternative hypothesis that the sampled random variables are dependent.
</p>
</li>
<li> <p><code class="reqn">\mathcal I_n</code> is invariant to shifts and orthogonal transformations of X and Y.  
</p>
</li>
<li> <p><code class="reqn">\sqrt{n} \, \mathcal I_n</code> determines a statistically consistent test of independence against all fixed dependent alternatives (Corollary 1).
</p>
</li>
<li>
<p> The population independence coefficient <code class="reqn">\mathcal I</code> is a normalized distance between the joint characteristic function and the product of the marginal characteristic functions. <code class="reqn">\mathcal I_n</code> converges almost surely to <code class="reqn">\mathcal I</code> as <code class="reqn">n \to \infty</code>. X and Y are independent if and only if <code class="reqn">\mathcal I(X, Y) = 0</code>.
See the reference below for more details. 
</p>
</li>
</ul>
<h3>Value</h3>

<p><code>mvI</code> returns the statistic. <code>mvI.test</code> returns
a list with class
<code>htest</code> containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>     method</code></td>
<td>
<p> description of test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>  statistic</code></td>
<td>
<p> observed value of the test statistic <code class="reqn">n\mathcal I_n^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>   estimate</code></td>
<td>
 <p><code class="reqn">\mathcal I_n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> replicates</code></td>
<td>
<p> permutation replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>    p.value</code></td>
<td>
<p> p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>  data.name</code></td>
<td>
<p> description of data</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>On scale invariance: Distance correlation (<code>dcor</code>) has the property that if we change the scale of X from e.g., meters to kilometers, and the scale of Y from e.g. grams to ounces, the statistic and the test are not changed. <code class="reqn">\mathcal I_n</code> does not have this property; it is invariant only under a common rescaling of X and Y by the same constant. Thus, if the units of measurement change for either or both variables, dCor is invariant, but <code class="reqn">\mathcal I_n</code> and possibly the <code>mvI.test</code>  decision changes.   
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Bakirov, N.K., Rizzo, M.L., and Szekely, G.J. (2006), A Multivariate
Nonparametric Test of Independence, <em>Journal of Multivariate Analysis</em> 93/1, 58-80.
</p>
<p>Szekely, G.J., Rizzo, M.L., and Bakirov, N.K. (2007),
Measuring and Testing Dependence by Correlation of Distances,
<em>Annals of Statistics</em>, Vol. 35 No. 6, pp. 2769-2794.
</p>
<p>Szekely, G.J. and Rizzo, M.L. (2009),
Brownian Distance Covariance,
<em>Annals of Applied Statistics</em>,
Vol. 3, No. 4, 1236-1265.
</p>


<h3>See Also</h3>

<p><code> dcov.test </code>
<code> dcov </code>
<code> dcor.test </code>
<code> dcor </code>
<code> dcov2d </code>
<code> dcor2d </code>
<code> indep.test </code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mvI(iris[1:25, 1], iris[1:25, 2])

mvI.test(iris[1:25, 1], iris[1:25, 2], R=99)

</code></pre>


</div>