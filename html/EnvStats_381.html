<div class="container">

<table style="width: 100%;"><tr>
<td>plot.gofGroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot Results of Group Goodness-of-Fit Test
</h2>

<h3>Description</h3>

<p>Plot the results of calling the function <code>gofGroupTest</code>, 
which returns an object of class <code>"gofGroup"</code> when performing a 
goodness-of-fit test to determine whether data in a set of 
groups appear to all come from the same probability distribution 
(with possibly different parameters for each group).  
Five different kinds of plots are available.
</p>
<p>The function <code>plot.gofGroup</code> is automatically called by <code>plot</code> 
when given an object of class <br><code>"gofGroup"</code>.  The names of other functions 
associated with goodness-of-fit test are listed under Goodness-of-Fit Tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gofGroup'
plot(x, plot.type = "Summary", 
    captions = list(QQ = NULL, MDQQ = NULL, ScoresQQ = NULL, ScoresMDQQ = NULL, 
      Results = NULL), 
    x.labels = list(QQ = NULL, MDQQ = NULL, ScoresQQ = NULL, ScoresMDQQ = NULL), 
    y.labels = list(QQ = NULL, MDQQ = NULL, ScoresQQ = NULL, ScoresMDQQ = NULL), 
    same.window = FALSE, ask = same.window &amp; plot.type == "All", add.line = TRUE, 
    digits = ifelse(plot.type == "Summary", 2, .Options$digits), test.result.font = 1, 
    test.result.cex = ifelse(plot.type == "Summary", 0.9, 1) * par("cex"), 
    test.result.mar = c(0, 0, 3, 0) + 0.1, individual.p.values = FALSE, 
    cex.main = ifelse(plot.type == "Summary", 1.2, 1.5) * par("cex"), 
    cex.axis = ifelse(plot.type == "Summary", 0.9, 1) * par("cex"), 
    cex.lab = ifelse(plot.type == "Summary", 0.9, 1) * par("cex"), 
    main = NULL, xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL, add.om.title = TRUE, 
    oma = if (plot.type == "Summary" &amp; add.om.title) c(0, 0, 5, 0) else c(0, 0, 0, 0), 
    om.title = NULL, om.font = 2, om.cex.main = 1.5 * par("cex"), om.line = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>"gofGroup"</code>.  See <code>gofGroup.object</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>character string indicating what kind of plot to create.  Only one particular 
plot type will be created, unless <code>plot.type="All"</code>, in which case all plots 
will be created sequentially.  The possible values of <code>plot.type</code> are: 
<code>"Summary"</code> (the default), <code>"Q-Q Plot"</code> <code>"Tukey M-D Q-Q Plot"</code>, 
<code>"Scores Q-Q Plot"</code>, <code>"Scores Tukey M-D Q-Q Plot"</code>, 
<code>"Test Results"</code>, and <code>"All"</code>.  
See the DETAILS section for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>captions</code></td>
<td>

<p>a list with 1 to 5 components with the names <code>"QQ"</code>, <code>"MDQQ"</code>, 
<code>"ScoresQQ"</code>, <br><code>"ScoresMDQQ"</code>, and/or <code>"Results"</code>.  Each component either has 
the value <code>NULL</code> or else it is a character string containing the title for that 
particular kind of plot.  When the component has the value <code>NULL</code> (the default), 
a default title is used.  This argument is useful when you are creating more than 
one kind of plot with a single call to <code>plot.gofGroup</code> (i.e., when 
<code>plot.type="Summary"</code> or <code>plot.type="All"</code>) and you want to specify titles 
different from the default ones.  If you are creating only one kind of plot, 
then you can just use the <code>main</code> argument to specify a title different 
from the default one. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.labels</code></td>
<td>

<p>a list of 1 to 4 components with the names <code>"QQ"</code>, <code>"MDQQ"</code>, 
<code>"ScoresQQ"</code>, and/or <code>"ScoresMDQQ"</code>.  
Each component either has the value 
<code>NULL</code> or else it is a character string containing the label for the 
<code class="reqn">x</code>-axis for that particular kind of plot.  When the component has the value 
<code>NULL</code> (the default), a default <code class="reqn">x</code>-axis label is used.  
This argument is useful when you are creating more than 
one kind of plot with a single call to <code>plot.gofGroup</code> (i.e., when 
<code>plot.type="Summary"</code> or <code>plot.type="All"</code>) 
and you want to specify <code class="reqn">x</code>-axis 
labels different from the default ones.  If you are creating only one plot, 
then you can just use the <code>xlab</code> argument to 
specify an <code class="reqn">x</code>-axis label different from the default one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.labels</code></td>
<td>

<p>a list of 1 to 4 components with the names <code>"QQ"</code>, <code>"MDQQ"</code>, 
<code>"ScoresQQ"</code>, and/or <code>"ScoresMDQQ"</code>. Each component either has the value 
<code>NULL</code> or else it is a character string containing the label for the 
<code class="reqn">y</code>-axis for that particular kind of plot.  When the component has the value 
<code>NULL</code> (the default), a default <code class="reqn">y</code>-axis label is used.  
This argument is useful when you are creating more than 
one kind of plot with a single call to <code>plot.gofGroup</code> (i.e., when 
<code>plot.type="Summary"</code> or <code>plot.type="All"</code>) 
and you want to specify <code class="reqn">y</code>-axis 
labels different from the default ones.  If you are creating only one plot, 
then you can just use the <code>ylab</code> argument to 
specify a <code class="reqn">y</code>-axis label different from the default one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.window</code></td>
<td>

<p>logical scalar indicating whether to produce all plots in the same graphics 
window (<code>same.window=TRUE</code>), or to create a new graphics 
window for each separate plot (<code>same.window=FALSE</code>; the default).  
The argument is relevant only when <code>plot.type="All"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>

<p>logical scalar supplied to the function <code>devAskNewPage</code>, indicating 
whether to prompt the user before creating a new plot within a single graphics 
window.  The default value is <code>FALSE</code> unless <code>same.window=TRUE</code> and 
<code>plot.type == "All"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.line</code></td>
<td>

<p>logical scalar indicating whether to add a line to the plot.  If <code>add.line=TRUE</code> 
and <code>plot.type="Q-Q Plot"</code> or <code>plot.type="Scores Q-Q Plot"</code>, 
a 0-1 line is added to the plot.  
If <code>add.line=TRUE</code> and <code>plot.type="Tukey M-D Q-Q Plot"</code> or 
<code>plot.type="Scores Tukey M-D Q-Q Plot"</code>, a horizontal 
line at <code class="reqn">y=0</code> is added to the plot.  The default value is <code>add.line=TRUE</code>.  
This argument is ignored if <code>plot.type="Test Results"</code>.
</p>
</td>
</tr>
</table>
<p><b>Arguments associated with <code>plot.type="Test Results"</code></b> <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>scalar indicating how many significant digits to print for the test results 
when <code>plot.type="Summary"</code> or <code>plot.type="Test Results"</code>.  If <br><code>plot.type == "Summary"</code>, the default value is 
<code>digits=2</code>, otherwise it is <br><code>.Options$digits</code> (i.e., the current setting of <code>options("digits")</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual.p.values</code></td>
<td>

<p>logical scalar indicating whether to display the p-values associated with 
each individual group.  The default value is <code>individual.p.values=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.result.font</code></td>
<td>

<p>numeric scalar indicating which font to use to print out the test results.  
The default value is <code>test.result.font=1</code>.  See the description of the 
<code>font</code> argument in the help file for <code>par</code> for more information.  
You may get better results if you use a font number that corresponds to a fixed 
font (e.g., courier).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.result.cex</code></td>
<td>

<p>numeric scalar indicating the value of <code>cex</code> to use to print out the 
test results.  The default value is <code>0.9*par("cex")</code> when 
<code>plot.type="Summary"</code>, otherwise it is <code>par("cex")</code>. 
See the description of the <code>cex</code> argument in the help file for 
<code>par</code> for more information.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.result.mar</code></td>
<td>

<p>numeric vector indicating the value of <code>mar</code> to use to print out the 
test results.  The default value is <code>test.result.mar=c(0, 0, 3, 0)+0.1</code>.  
See the description of the <code>mar</code> argument in the help file for 
<code>par</code> for more information.  
</p>
</td>
</tr>
</table>
<p><b>Arguments associated with <code>plot.type="Summary"</code></b> <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>add.om.title</code></td>
<td>

<p>logical scalar indicating whether to add a title in the outer margin when <br><code>plot.type="Summary"</code>.  The default value is <code>add.om.title=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>om.title</code></td>
<td>

<p>character string containing the outer margin title.  The default value is <br><code>om.title=NULL</code>, which will result in a default title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>om.font</code></td>
<td>

<p>numeric scalar indicating the font to use for the outer margin.  The default 
value is <code>om.font=2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>om.cex.main</code></td>
<td>

<p>numeric scalar indicating the value of <code>cex</code> for the outer margin title.  
The default value is <code>1.5 * par("cex")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>om.line</code></td>
<td>

<p>numeric scalar indicating the line to place the outer margin title on.  The 
default value is <code>om.line=1</code>.
</p>
</td>
</tr>
</table>
<p><b>Graphics parameters:</b> <br></p>
<table><tr style="vertical-align: top;">
<td><code>cex.main, cex.axis, cex.lab, main, xlab, ylab, xlim, ylim, oma, ...</code></td>
<td>

<p>additional graphics parameters.  See the help file for <code>par</code>.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The function <code>plot.gofGroup</code> is a method for the generic function 
<code>plot</code> for the class <code>"gofGroup"</code> (see 
<code>gofGroup.object</code>).  
It can be invoked by calling <code>plot</code> and giving it an object of 
class <code>"gofGroup"</code> as the first argument, or by calling 
<code>plot.gofGroup</code> directly, regardless of the class of the object given 
as the first argument to <code>plot.gofGroup</code>.
</p>
<p>Plots associated with the goodness-of-fit test are produced on the current graphics 
device.  These can be one or all of the following:
</p>

<ul>
<li> <p><code>plot.type="Q-Q Plot"</code>.  
Q-Q Plot of observed p-values vs. quantiles from a 
Uniform [0,1] distribution.  
See the help file for <code>qqPlot</code>. 
</p>
</li>
<li> <p><code>plot.type="Tukey M-D Q-Q Plot"</code>.  
Tukey mean-difference Q-Q plot for observed p-values and 
quantiles from a Uniform [0,1] distribution.  
See the help file for <code>qqPlot</code>.
</p>
</li>
<li> <p><code>plot.type="Scores Q-Q Plot"</code>.  
Q-Q Plot of Normal scores vs. quantiles from a 
Normal(0,1) distribution or 
Q-Q Plot of Chisquare scores vs. quantiles from a 
Chisquare distribution with 2 degrees of freedom.  
See the help file for <code>qqPlot</code>. 
</p>
</li>
<li> <p><code>plot.type="Scores Tukey M-D Q-Q Plot"</code>.  
Tukey mean-difference Q-Q plot based on Normal scores or 
Chisquare scores.  
See the help file for <code>qqPlot</code>.
</p>
</li>
<li>
<p> Results of the goodness-of-fit test (<code>plot.type="Test Results"</code>).  
See the help file for <code>print.gofGroup</code>.
</p>
</li>
</ul>
<p>See the help file for <code>gofGroupTest</code> for more information.
</p>


<h3>Value</h3>

<p><code>plot.gofGroup</code> invisibly returns the first argument, <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992).  <em>Statistical Models in S</em>.  
Wadsworth &amp; Brooks/Cole. 
</p>


<h3>See Also</h3>

<p><code>gofGroupTest</code>, <code>gofGroup.object</code>, 
<code>print.gofGroup</code>, 
Goodness-of-Fit Tests, <code>plot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Create an object of class "gofGroup" then plot it.

  # Example 10-4 of USEPA (2009, page 10-20) gives an example of 
  # simultaneously testing the assumption of normality for nickel 
  # concentrations (ppb) in groundwater collected at 4 monitoring 
  # wells over 5 months.  The data for this example are stored in 
  # EPA.09.Ex.10.1.nickel.df.

  EPA.09.Ex.10.1.nickel.df
  #   Month   Well Nickel.ppb
  #1      1 Well.1       58.8
  #2      3 Well.1        1.0
  #3      6 Well.1      262.0
  #...
  #18     6 Well.4       85.6
  #19     8 Well.4       10.0
  #20    10 Well.4      637.0


  # Test for a normal distribution at each well:
  #--------------------------------------------

  gofGroup.obj &lt;- gofGroupTest(Nickel.ppb ~ Well, 
    data = EPA.09.Ex.10.1.nickel.df)

  dev.new()
  plot(gofGroup.obj)

  # Make your own titles for the summary plot
  #------------------------------------------
  dev.new()
  plot(gofGroup.obj, captions = list(QQ = "Q-Q Plot", 
    ScoresQQ = "Scores Q-Q Plot", Results = "Results"),
    om.title = "Summary Plot")

  # Just the Q-Q Plot
  #------------------
  dev.new()
  plot(gofGroup.obj, plot.type="Q-Q")


  # Make your own title for the Q-Q Plot
  #-------------------------------------
  dev.new()
  plot(gofGroup.obj, plot.type="Q-Q", main = "Q-Q Plot")

  #==========

  # Clean up
  #---------
  rm(gofGroup.obj)
  graphics.off()
</code></pre>


</div>