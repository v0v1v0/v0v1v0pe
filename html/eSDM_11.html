<div class="container">

<table style="width: 100%;"><tr>
<td>overlay_sdm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Overlay SDM predictions onto base geometry</h2>

<h3>Description</h3>

<p>Overlay specified SDM predictions that meet the percent overlap threshold requirement onto base geometry
</p>


<h3>Usage</h3>

<pre><code class="language-R">overlay_sdm(base.geom, sdm, sdm.idx, overlap.perc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>base.geom</code></td>
<td>
<p>object of class <code>sfc</code>; base geometry</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdm</code></td>
<td>
<p>object of class <code>sf</code>; original SDM predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdm.idx</code></td>
<td>
<p>names or indices of column(s) with data to be overlaid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap.perc</code></td>
<td>
<p>numeric; percent overlap threshold,
i.e. percentage of each base geometry polygon must overlap with SDM
prediction polygons for overlaid density value to be calculated and
not set as NA</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the eSDM GUI manual for specifics about the overlay process.
This process is equivalent to areal interpolation (Goodchild and Lam 1980),
where <code>base.geom</code> is the target, <code>sdm</code> is the source, and the data
specified by <code>sdm.idx</code> are spatially intensive.
</p>
<p>Note that <code>overlay_sdm</code> removes rows in <code>sdm</code> that have NA values
in the first column specified in <code>sdm.idx</code> (i.e. <code>sdm.idx[1]</code>),
before the overlay.
Thus, for valid overlay results, all columns of <code>sdm</code> specified in
<code>sdm.idx</code> must either have NA values in the same rows
or contain only NAs.
</p>


<h3>Value</h3>

<p>Object of class <code>sf</code> with the geometry of <code>base.geom</code> and
the data in the <code>sdm.idx</code> columns of <code>sdm</code> overlaid onto that
geometry. Note that this means all columns of <code>sdm</code> not in
<code>sdm.idx</code> will not be in the returned object.
Because the data are considered spatially intensive, the <code>agr</code>
attribute will be set as 'constant' for all columns in the returned object.
</p>
<p>Additionally, the output will match the class of <code>sdm</code>, with regards
to the classes tbl_df, tbl, and data.frame. This means that, in addition to
being an <code>sf</code> object, if <code>sdm</code> is a tibble then the output will
also be a tibble, while if <code>sdm</code> is just a data frame then the output
will not be a tibble.
</p>


<h3>References</h3>

<p>Goodchild, M.F. &amp; Lam, N.S.-N. (1980) Areal interpolation:
a variant of the traditional spatial problem. Geo-Processing, 1, 297-312.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pol1.geom &lt;- sf::st_sfc(
  sf::st_polygon(list(rbind(c(1,1), c(3,1), c(3,3), c(1,3), c(1,1)))),
  crs = sf::st_crs(4326)
)
pol2.geom &lt;- sf::st_sfc(
  sf::st_polygon(list(rbind(c(0,0), c(2,0), c(2,2), c(0,2), c(0,0)))),
  crs = sf::st_crs(4326)
)
pol2.sf &lt;- sf::st_sf(data.frame(Dens = 0.5), geometry = pol2.geom,
                     crs = sf::st_crs(4326))

overlay_sdm(pol1.geom, pol2.sf, 1, 25)

# Output 'Dens' value is NA because of higher overlap.perc value
overlay_sdm(pol1.geom, pol2.sf, 1, 50)


# These examples take longer to run
overlay_sdm(sf::st_geometry(preds.1), preds.2, 1, 50)
overlay_sdm(sf::st_geometry(preds.2), preds.1, "Density", 50)

</code></pre>


</div>