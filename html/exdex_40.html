<div class="container">

<table style="width: 100%;"><tr>
<td>kgaps_confint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence intervals for the extremal index <code class="reqn">\theta</code> for <code>"kgaps"</code>
objects</h2>

<h3>Description</h3>

<p><code>confint</code> method for objects of class <code>c("kgaps", "exdex")</code>.
Computes confidence intervals for <code class="reqn">\theta</code> based on an object returned
from <code>kgaps</code>.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the estimator
of <code class="reqn">\theta</code>, which are symmetric about the point estimate,
and (b) likelihood-based intervals. The <code>plot</code> method plots the
log-likelihood for <code class="reqn">\theta</code>, with the required confidence interval
indicated on the plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'kgaps'
confint(
  object,
  parm = "theta",
  level = 0.95,
  interval_type = c("both", "norm", "lik"),
  conf_scale = c("theta", "log"),
  constrain = TRUE,
  se_type = c("observed", "expected"),
  ...
)

## S3 method for class 'confint_kgaps'
plot(x, ...)

## S3 method for class 'confint_kgaps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>c("kgaps", "exdex")</code>, returned by
<code>kgaps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>Specifies which parameter is to be given a confidence interval.
Here there is only one option: the extremal index <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The confidence level required.  A numeric scalar in (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval_type</code></td>
<td>
<p>A character scalar: <code>"norm"</code> for intervals of
type (a), <code>"lik"</code> for intervals of type (b).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_scale</code></td>
<td>
<p>A character scalar.  If <code>interval_type = "norm"</code> then
<code>conf_scale</code> determines the scale on which we use approximate
large-sample normality of the estimator to estimate confidence intervals.
</p>
<p>If <code>conf_scale = "theta"</code>
then confidence intervals are estimated for <code class="reqn">\theta</code> directly.
If <code>conf_scale = "log"</code> then confidence intervals are first
estimated for <code class="reqn">\log\theta</code> and then transformed back
to the <code class="reqn">\theta</code>-scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrain</code></td>
<td>
<p>A logical scalar.  If <code>constrain = TRUE</code> then
any confidence limits that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  Otherwise,
limits that are greater than 1 may be obtained.
If <code>constrain = TRUE</code> then any lower confidence limits that are
less than 0 are set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_type</code></td>
<td>
<p>A character scalar. Should the confidence intervals for the
<code>interval_type  = "norm"</code> use the estimated standard error based on
the observed information or based on the expected information?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><code>plot.confint_kgaps</code>: further arguments passed to
<code>plot.confint</code>.
</p>
<p><code>print.confint_kgaps</code>: further arguments passed to
<code>print.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>c("confint_kgaps", "exdex")</code>, a result of
a call to <code>confint.kgaps</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two type of interval are calculated: (a) an interval based on the
approximate large sample normality of the estimator of <code class="reqn">\theta</code>
(if <code>conf_scale = "theta"</code>) or of <code class="reqn">\log\theta</code>
(if <code>conf_scale = "log"</code>) and (b) a likelihood-based interval,
based on the approximate large sample chi-squared, with 1 degree of
freedom, distribution of the log-likelihood ratio statistic.
</p>
<p><code>print.confint_kgaps</code> prints the matrix of confidence
intervals for <code class="reqn">\theta</code>.
</p>


<h3>Value</h3>

<p>A list of class c("confint_kgaps", "exdex") containing the
following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cis</code></td>
<td>
<p>A matrix with columns giving the lower and upper confidence
limits. These are labelled as (1 - level)/2 and 1 - (1 - level)/2 in
% (by default 2.5% and 97.5%).
The row names indicate the type of interval:
<code>norm</code> for intervals based on large sample normality and <code>lik</code>
for likelihood-based intervals.
If <code>object$k = 0</code> then both confidence limits are returned as being
equal to the point estimate of <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call to <code>spm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The input object <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The input <code>level</code>.</p>
</td>
</tr>
</table>
<p><code>plot.confint_kgaps</code>: nothing is returned.  If
<code>x$object$k = 0</code> then no plot is produced.
</p>
<p><code>print.confint_kgaps</code>: the argument <code>x</code>, invisibly.
</p>


<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>


<h3>See Also</h3>

<p><code>kgaps</code> for estimation of the extremal index
<code class="reqn">\theta</code> using a semiparametric maxima method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">u &lt;- quantile(newlyn, probs = 0.90)
theta &lt;- kgaps(newlyn, u)
cis &lt;- confint(theta)
cis
plot(cis)
</code></pre>


</div>