<div class="container">

<table style="width: 100%;"><tr>
<td>npf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric Position Formulation</h2>

<h3>Description</h3>

<p><code>npf</code> returns a completed Euclidean Distance Matrix D, with dimension d,
from a partial Euclidean Distance Matrix using the methods of Fang &amp; O'Leary (2012)
</p>


<h3>Usage</h3>

<pre><code class="language-R">npf(
  D,
  A = NA,
  d,
  dmax = (nrow(D) - 1),
  decreaseDim = 1,
  stretch = NULL,
  method = "Linear",
  toler = 1e-08
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>An nxn partial-distance matrix to be completed. D must satisfy a list of conditions (see details), with unkown entries set to NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a weight matrix, with <code class="reqn">h_{ij} = 0</code> implying <code class="reqn">a_{ij}</code> is unknown. Generally, if <code class="reqn">a_{ij}</code> is known, <code class="reqn">h_{ij} = 1</code>, although any non-negative weight is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the dimension of the resulting completion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmax</code></td>
<td>
<p>the maximum dimension to consider during dimension relaxation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreaseDim</code></td>
<td>
<p>during dimension reduction, the number of dimensions to decrease each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stretch</code></td>
<td>
<p>should the distance matrix be multiplied by a scalar constant? If no, stretch = NULL, otherwise stretch is a positive scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for dimension reduction, one of "Linear" or "NLP".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toler</code></td>
<td>
<p>convergence tolerance for the algorithm</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the Nonconvex Position Formulation (npf)
for Euclidean Distance Matrix Completion, as proposed in 'Euclidean 
Distance Matrix Completion Problems' (Fang &amp; O'Leary, 2012).
</p>
<p>The method seeks to minimize the following:
</p>
<p style="text-align: center;"><code class="reqn">||A \cdot (D - K(XX'))||_{F}^{2}</code>
</p>

<p>where the function K() is that described in gram2edm, and the norm is Frobenius. Minimization is over X, the nxp matrix of node locations.
</p>
<p>The matrix D is a partial-distance matrix, meaning some of its entries are unknown. 
It must satisfy the following conditions in order to be completed:
</p>

<ul>
<li>
<p>diag(D) = 0
</p>
</li>
<li>
<p>If <code class="reqn">a_{ij}</code> is known, <code class="reqn">a_{ji} = a_{ij}</code>
</p>
</li>
<li>
<p>If <code class="reqn">a_{ij}</code> is unknown, so is <code class="reqn">a_{ji}</code>
</p>
</li>
<li>
<p>The graph of D must be connected. If D can be decomposed into two (or more) subgraphs, 
then the completion of D can be decomposed into two (or more) independent completion problems.
</p>
</li>
</ul>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>an nxn matrix of the completed Euclidean distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optval</code></td>
<td>
<p>the minimum value achieved of the target function during minimization</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>gram2edm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
D &lt;- matrix(c(0,3,4,3,4,3,
             3,0,1,NA,5,NA,
             4,1,0,5,NA,5,
             3,NA,5,0,1,NA,
             4,5,NA,1,0,5,
             3,NA,5,NA,5,0),byrow=TRUE, nrow=6)
             
A &lt;- matrix(c(1,1,1,1,1,1,
             1,1,1,0,1,0,
             1,1,1,1,0,1,
             1,0,1,1,1,0,
             1,1,0,1,1,1,
             1,0,1,0,1,1),byrow=TRUE, nrow=6)

edmc(D, method="npf", d=3, dmax=5)

</code></pre>


</div>