<div class="container">

<table style="width: 100%;"><tr>
<td>ks_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted KS Test</h2>

<h3>Description</h3>

<p>Weighted Kolmogorov-Smirnov Two-Sample Test with threshold
</p>


<h3>Usage</h3>

<pre><code class="language-R">ks_test(x, y, thresh = 0.05, w_x = rep(1, length(x)), w_y = rep(1, length(y)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of values sampled from the first distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of values sampled from the second distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>The threshold needed to clear between the two cumulative distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_x</code></td>
<td>
<p>The observation weights for x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_y</code></td>
<td>
<p>The observation weights for y</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The usual Kolmogorov-Smirnov test for two vectors <strong>X</strong> and <strong>Y</strong>, of size m
and n rely on the empirical cdfs <code class="reqn">E_x</code> and <code class="reqn">E_y</code> and the test statistic
</p>
<p style="text-align: center;"><code class="reqn">D = sup_{t\in (X, Y)} |E_x(x) - E_y(x))</code>
</p>
<p>.
This modified Kolmogorov-Smirnov test relies on two modifications.
</p>

<ul>
<li>
<p> Using observation weights for both vectors <strong>X</strong> and <strong>Y</strong>: Those
weights are used in two places, while modifying the usual KS test. First, the
empirical cdfs are updates to account for the weights. Secondly, the effective
sample sizes are also modified. This is inspired from
<a href="https://stackoverflow.com/a/55664242/13768995">https://stackoverflow.com/a/55664242/13768995</a>, using Monahan (2011).
</p>
</li>
<li>
<p> Testing against a threshold: the test statistic is thresholded such
that <code class="reqn">D = max(D - thresh, 0)</code>. Since <code class="reqn">0\le D\le 1</code>, the value of
the threshold is also between 0 and 1, representing an effect size for the
difference.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>

<ul>
<li> <p><em>statistic</em> the value of the test statistic.
</p>
</li>
<li> <p><em>p.value</em> the p-value of the test.
</p>
</li>
<li> <p><em>alternative</em> a character string describing the alternative hypothesis.
</p>
</li>
<li> <p><em>method</em> a character string indicating what type of test was performed.
</p>
</li>
<li> <p><em>data.name</em> a character string giving the name(s) of the data.
</p>
</li>
</ul>
<h3>References</h3>

<p>Monahan, J. (2011). <em>Numerical Methods of Statistics</em> (2nd ed.,
Cambridge Series in Statistical and Probabilistic Mathematics). Cambridge:
Cambridge University Press. doi:10.1017/CBO9780511977176
</p>


<h3>Examples</h3>

<pre><code class="language-R"> x &lt;- runif(100)
 y &lt;- runif(100, min = .5, max = .5)
 ks_test(x, y, thresh = .001)
</code></pre>


</div>