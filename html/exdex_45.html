<div class="container">

<table style="width: 100%;"><tr>
<td>kgaps_imt_stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistics for the information matrix test</h2>

<h3>Description</h3>

<p>Calculates the components required to calculate the value of the information
matrix test under the <code class="reqn">K</code>-gaps model, using vector data input.
Called by <code>kgaps_imt</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kgaps_imt_stat(data, theta, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector of raw data.  Missing values are allowed, but
they should not appear between non-missing values, that is, they only be
located at the start and end of the vector.  Missing values are omitted
using <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A numeric scalar. An estimate of the extremal index
<code class="reqn">\theta</code>, produced by <code>kgaps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A numeric scalar.  Run parameter <code class="reqn">K</code>, as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
<code class="reqn">K</code>-gap equal to zero.  Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from censored inter-exceedance times relating to the
first and last observation.  See Attalides (2015) for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list relating the quantities given on pages 18-19 of
Suveges and Davison (2010).  All but the last component are vectors giving
the contribution to the quantity from each <code class="reqn">K</code>-gap, evaluated at the
input value <code>theta</code> of <code class="reqn">\theta</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>ldj</code> </td>
<td>
<p>the derivative of the log-likelihood with respect to
<code class="reqn">\theta</code> (the score)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>Ij</code> </td>
<td>
<p>the observed information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>Jj</code> </td>
<td>
<p>the square of the score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>dj</code> </td>
<td>
<p><code>Jj</code> - <code>Ij</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>Ddj</code> </td>
<td>
<p>the derivative of <code>Jj</code> - <code>Ij</code> with respect
to <code class="reqn">\theta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>n_kgaps</code> </td>
<td>
<p>the number of <code class="reqn">K</code>-gaps that contribute to the
log-likelihood.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


</div>