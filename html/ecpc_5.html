<div class="container">

<table style="width: 100%;"><tr>
<td>createS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Create a generalised penalty matrix
</h2>

<h3>Description</h3>


<p>Create a generalised penalty matrix which can be used as hypershrinkage for 
co-data matrix Z. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">createS(orderPen=2, G=10, categorical=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>orderPen</code></td>
<td>

<p>The order of the difference penalty. If 0, then a ridge penalty matrix is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>

<p>Number of co-data variables to be penalised.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>

<p>If TRUE, a block correlation matrix is returned.
</p>
</td>
</tr>
</table>
<h3>Value</h3>






<p>A (GxG)-dimensional penalty matrix.
</p>


<h3>References</h3>

<p>See for an introduction on p-splines and difference penalties:
</p>
<p>Eilers, P. H., &amp; Marx, B. D. (2021). Practical Smoothing: The Joys of P-splines. Cambridge University Press.
</p>


<h3>See Also</h3>


<p>A difference penalty may be applied for p-spline basis functions created with <code>createZforSplines</code> or for categorical co-data created with <code>createZforGroupset</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">S1 &lt;- createS(orderPen=2,G=10) #second difference penalty matrix
S2 &lt;- createS(orderPen=0,G=10) #zeroth order defined as ridge penalty matrix
S3 &lt;- createS(G=10,categorical=TRUE) #difference penalty for unordered categorical groups
</code></pre>


</div>