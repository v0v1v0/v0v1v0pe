<div class="container">

<table style="width: 100%;"><tr>
<td>dcov2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast dCor and dCov for bivariate data only</h2>

<h3>Description</h3>

<p>For bivariate data only, these are fast O(n log n) implementations of distance
correlation and distance covariance statistics. The U-statistic for dcov^2 is unbiased; 
the V-statistic is the original definition in SRB 2007. These algorithms do not
store the distance matrices, so they are suitable for large samples. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">dcor2d(x, y, type = c("V", "U"))
dcov2d(x, y, type = c("V", "U"), all.stats = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> "V" or "U", for V- or U-statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.stats</code></td>
<td>
<p> logical</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The unbiased (squared) dcov is documented in <code>dcovU</code>, for multivariate data in arbitrary, not necessarily equal dimensions. <code>dcov2d</code> and <code>dcor2d</code> provide a faster O(n log n) algorithm for bivariate (x, y) only (X and Y are real-valued random vectors). The O(n log n) algorithm was proposed by Huo and Szekely (2016). The algorithm is faster above a certain sample size n. It does not store the distance matrix so the sample size can be very large. 
</p>


<h3>Value</h3>

<p>By default, <code>dcov2d</code> returns the V-statistic <code class="reqn">V_n = dCov_n^2(x, y)</code>, and if type="U", it returns the U-statistic, unbiased for <code class="reqn">dCov^2(X, Y)</code>. The argument all.stats=TRUE is used internally when the function is called from <code>dcor2d</code>. 
</p>
<p>By default, <code>dcor2d</code> returns <code class="reqn">dCor_n^2(x, y)</code>, and if type="U", it returns a bias-corrected estimator of squared dcor equivalent to <code>bcdcor</code>.
</p>
<p>These functions do not store the distance matrices so they are helpful when sample size is large and the data is bivariate. 
</p>


<h3>Note</h3>

<p>The U-statistic <code class="reqn">U_n</code> can be negative in the lower tail so 
the square root of the U-statistic is not applied.
Similarly, <code>dcor2d(x, y, "U")</code> is bias-corrected and can be
negative in the lower tail, so we do not take the
square root. The original definitions of dCov and dCor 
(SRB2007, SR2009) were based on V-statistics, which are non-negative,
and defined using the square root of V-statistics.
</p>
<p>It has been suggested that instead of taking the square root of the U-statistic, one could take the root of <code class="reqn">|U_n|</code> before applying the sign, but that introduces more bias than the original dCor, and should never be used. 
</p>


<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Huo, X. and Szekely, G.J. (2016). Fast computing for 
distance covariance. Technometrics, 58(4), 435-447.
</p>
<p>Szekely, G.J. and Rizzo, M.L. (2014),
Partial Distance Correlation with Methods for Dissimilarities.
<em>Annals of Statistics</em>, Vol. 42 No. 6, 2382-2412.
</p>
<p>Szekely, G.J., Rizzo, M.L., and Bakirov, N.K. (2007),
Measuring and Testing Dependence by Correlation of Distances,
<em>Annals of Statistics</em>, Vol. 35 No. 6, pp. 2769-2794.
<br><a href="https://doi.org/10.1214/009053607000000505">doi:10.1214/009053607000000505</a>
</p>


<h3>See Also</h3>

<p><code>dcov</code> <code>dcov.test</code>  <code>dcor</code> <code>dcor.test</code> (multivariate statistics and permutation test) 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
    ## these are equivalent, but 2d is faster for n &gt; 50
    n &lt;- 100
    x &lt;- rnorm(100)
    y &lt;- rnorm(100)
    all.equal(dcov(x, y)^2, dcov2d(x, y), check.attributes = FALSE)
    all.equal(bcdcor(x, y), dcor2d(x, y, "U"), check.attributes = FALSE)

    x &lt;- rlnorm(400)
    y &lt;- rexp(400)
    dcov.test(x, y, R=199)    #permutation test
    dcor.test(x, y, R=199)
      
</code></pre>


</div>