<div class="container">

<table style="width: 100%;"><tr>
<td>fitmweibullgpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLE Fitting of Weibull Bulk and GPD Tail Interval Transition Mixture Model</h2>

<h3>Description</h3>

<p>Maximum likelihood estimation for fitting the extreme valeu 
mixture model with the Weibull bulk and GPD tail interval transition mixture model.
With options for profile likelihood estimation for threshold and interval half-width,
which can both be fixed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitmweibullgpd(x, eseq = NULL, useq = NULL, fixedeu = FALSE,
  pvector = NULL, std.err = TRUE, method = "BFGS",
  control = list(maxit = 10000), finitelik = TRUE, ...)

litmweibullgpd(x, wshape = 1, wscale = 1, epsilon = sqrt(wscale^2 *
  gamma(1 + 2/wshape) - (wscale * gamma(1 + 1/wshape))^2),
  u = qweibull(0.9, wshape, wscale), sigmau = sqrt(wscale^2 * gamma(1 +
  2/wshape) - (wscale * gamma(1 + 1/wshape))^2), xi = 0, log = TRUE)

nlitmweibullgpd(pvector, x, finitelik = FALSE)

profleuitmweibullgpd(eu, pvector, x, method = "BFGS",
  control = list(maxit = 10000), finitelik = TRUE, ...)

nleuitmweibullgpd(pvector, epsilon, u, x, finitelik = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of sample data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eseq</code></td>
<td>
<p>vector of epsilons (or scalar) to be considered in profile likelihood or
<code>NULL</code> for no profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useq</code></td>
<td>
<p>vector of thresholds (or scalar) to be considered in profile likelihood or
<code>NULL</code> for no profile likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedeu</code></td>
<td>
<p>logical, should threshold and epsilon be fixed
(at either scalar value in <code>useq</code> and <code>eseq</code>,
or estimated from maximum of profile likelihood evaluated at
grid of thresholds and epsilons in <code>useq</code> and <code>eseq</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvector</code></td>
<td>
<p>vector of initial values of parameters or <code>NULL</code> for default
values, see below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>logical, should standard errors be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimisation method (see <code>optim</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>optimisation control list (see <code>optim</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>finitelik</code></td>
<td>
<p>logical, should log-likelihood return finite value for invalid parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional inputs passed to <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wshape</code></td>
<td>
<p>scalar Weibull shape (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wscale</code></td>
<td>
<p>scalar Weibull scale (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>interval half-width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>scalar threshold value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau</code></td>
<td>
<p>scalar scale parameter (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>scalar shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if <code>TRUE</code> then log-likelihood rather than likelihood is output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eu</code></td>
<td>
<p>vector of epsilon and threshold pair considered in profile likelihood</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The extreme value mixture model with the Weibull bulk and GPD tail with interval
transition is fitted to the entire dataset using maximum likelihood estimation.
The estimated parameters, variance-covariance matrix and their standard errors are automatically
output.
</p>
<p>See <code>ditmweibullgpd</code> for explanation of Weibull-GPD interval
transition model, including mixing functions.
</p>
<p>See also help for <code>fnormgpd</code> for mixture model fitting details.
Only the different features are outlined below for brevity.
</p>
<p>The full parameter vector is
(<code>wshape</code>, <code>wscale</code>, <code>epsilon</code>, <code>u</code>, <code>sigmau</code>, <code>xi</code>)
if threshold and interval half-width are both estimated and
(<code>wshape</code>, <code>wscale</code>, <code>sigmau</code>, <code>xi</code>)
for profile likelihood or fixed threshold and epsilon approach.
</p>
<p>If the profile likelihood approach is used, then it is applied to both the threshold and
epsilon parameters together. A grid search over all combinations of epsilons and thresholds
are considered. The combinations which lead to less than 5 on either side of the interval are 
not considered.
</p>
<p>A fixed threshold and epsilon approach is acheived by setting a single scalar value to each in 
<code>useq</code> and <code>eseq</code> respectively.
</p>
<p>If the profile likelihood approach is used, then a grid search over all combinations of epsilon and threshold
are carried out. The combinations which lead to less than 5 in any any interval are not considered.
</p>
<p>Negative data are ignored.
</p>


<h3>Value</h3>

<p>Log-likelihood is given by <code>litmweibullgpd</code> and it's
wrappers for negative log-likelihood from <code>nlitmweibullgpd</code>
and <code>nluitmweibullgpd</code>. Profile likelihood for
threshold and interval half-width given by <code>profluitmweibullgpd</code>.
Fitting function <code>fitmweibullgpd</code> returns a simple list
with the following elements
</p>

<table>
<tr>
<td style="text-align: left;">
 <code>call</code>:      </td>
<td style="text-align: left;"> <code>optim</code> call</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>x</code>:         </td>
<td style="text-align: left;"> data vector <code>x</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>init</code>:      </td>
<td style="text-align: left;"> <code>pvector</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>fixedeu</code>:   </td>
<td style="text-align: left;"> fixed epsilon and threshold, logical</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>useq</code>:      </td>
<td style="text-align: left;"> threshold vector for profile likelihood or scalar for fixed threshold</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>eseq</code>:      </td>
<td style="text-align: left;"> epsilon vector for profile likelihood or scalar for fixed epsilon</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>nllheuseq</code>: </td>
<td style="text-align: left;"> profile negative log-likelihood at each combination in (eseq, useq)</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>optim</code>:     </td>
<td style="text-align: left;"> complete <code>optim</code> output</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>mle</code>:       </td>
<td style="text-align: left;"> vector of MLE of parameters</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>cov</code>:       </td>
<td style="text-align: left;"> variance-covariance matrix of MLE of parameters</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>se</code>:        </td>
<td style="text-align: left;"> vector of standard errors of MLE of parameters</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>nllh</code>:      </td>
<td style="text-align: left;"> minimum negative log-likelihood</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>n</code>:         </td>
<td style="text-align: left;"> total sample size</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>wshape</code>:    </td>
<td style="text-align: left;"> MLE of Weibull shape</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>wscale</code>:    </td>
<td style="text-align: left;"> MLE of Weibull scale</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>epsilon</code>:   </td>
<td style="text-align: left;"> MLE of transition half-width</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>u</code>:         </td>
<td style="text-align: left;"> threshold (fixed or MLE)</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>sigmau</code>:    </td>
<td style="text-align: left;"> MLE of GPD scale</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>xi</code>:        </td>
<td style="text-align: left;"> MLE of GPD shape</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Acknowledgments</h3>

<p>See Acknowledgments in
<code>fnormgpd</code>, type <code>help fnormgpd</code>.
</p>


<h3>Note</h3>

<p>When <code>pvector=NULL</code> then the initial values are:
</p>

<ul>
<li>
<p> MLE of Weibull parameters assuming entire population is Weibull; and
</p>
</li>
<li>
<p> epsilon is MLE of Weibull standard deviation;
</p>
</li>
<li>
<p> threshold 90% quantile (not relevant for profile likelihood for threshold or fixed threshold approaches);
</p>
</li>
<li>
<p> MLE of GPD parameters above threshold. 
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Alfadino Akbar and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://www.math.canterbury.ac.nz/~c.scarrott/evmix">http://www.math.canterbury.ac.nz/~c.scarrott/evmix</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Weibull_distribution">http://en.wikipedia.org/wiki/Weibull_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p>Holden, L. and Haug, O. (2013). A mixture model for unsupervised tail
estimation. arxiv:0902.4137
</p>


<h3>See Also</h3>

<p><code>dweibull</code>,
<code>fgpd</code> and <code>gpd</code>
</p>
<p>Other weibullgpd: <code>fweibullgpdcon</code>,
<code>fweibullgpd</code>, <code>itmweibullgpd</code>,
<code>weibullgpdcon</code>, <code>weibullgpd</code>
</p>
<p>Other itmweibullgpd: <code>fweibullgpdcon</code>,
<code>fweibullgpd</code>, <code>itmweibullgpd</code>,
<code>weibullgpdcon</code>, <code>weibullgpd</code>
</p>
<p>Other fitmweibullgpd: <code>itmweibullgpd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(1, 1))

x = rweibull(1000, shape = 1, scale = 2)
xx = seq(-0.2, 10, 0.01)
y = dweibull(xx, shape = 1, scale = 2)

# MLE for complete parameter set
fit = fitmweibullgpd(x)
hist(x, breaks = seq(0, 20, 0.1), freq = FALSE, xlim = c(-0.2, 10))
lines(xx, y)
with(fit, lines(xx, ditmweibullgpd(xx, wshape, wscale, epsilon, u, sigmau, xi), col="red"))
abline(v = fit$u + fit$epsilon * seq(-1, 1), col = "red")
  
# Profile likelihood for threshold which is then fixed
fitfix = fitmweibullgpd(x, eseq = seq(0, 2, 0.1), useq = seq(0.5, 4, 0.1), fixedeu = TRUE)
with(fitfix, lines(xx, ditmweibullgpd(xx, wshape, wscale, epsilon, u, sigmau, xi), col="blue"))
abline(v = fitfix$u + fitfix$epsilon * seq(-1, 1), col = "blue")
legend("topright", c("True Density", "Weibull-GPD ITM", "Profile likelihood"),
  col=c("black", "red", "blue"), lty = 1)

## End(Not run)
  
</code></pre>


</div>