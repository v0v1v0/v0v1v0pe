<div class="container">

<table style="width: 100%;"><tr>
<td>plot.uvevd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Diagnostics for a Univariate EVD Object</h2>

<h3>Description</h3>

<p>Four plots (selectable by <code>which</code>) are currently provided:
a P-P plot, a Q-Q plot, a density plot and a return level plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'uvevd'
plot(x, which = 1:4, main, ask = nb.fig &lt;
    length(which) &amp;&amp; dev.interactive(), ci = TRUE, cilwd = 1,
    a = 0, adjust = 1, jitter = FALSE, nplty = 2, ...)
## S3 method for class 'gumbelx'
plot(x, interval, which = 1:4, main, ask = nb.fig &lt;
    length(which) &amp;&amp; dev.interactive(), ci = TRUE, cilwd = 1,
    a = 0, adjust = 1, jitter = FALSE, nplty = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object that inherits from class <code>"uvevd"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If a subset of the plots is required, specify a
subset of the numbers <code>1:4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title of each plot. If given, must be a character
vector with the same length as <code>which</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the user is asked before
each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Logical; if <code>TRUE</code> (the default), plot simulated
95% confidence intervals for the P-P, Q-Q and return level
plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cilwd</code></td>
<td>
<p>Line width for confidence interval lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Passed through to <code>ppoints</code> for empirical estimation.
Larger values give less probability for extreme events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust, jitter, nplty</code></td>
<td>
<p>Arguments to the density plot.
The density of the fitted model is plotted with a rug plot and
(optionally) a non-parameteric estimate. The argument
<code>adjust</code> controls the smoothing bandwidth for the
non-parametric estimate (see <code>density</code>).
<code>jitter</code> is logical; if <code>TRUE</code>, the (possibly
transformed) data are jittered to produce the rug plot.
This need only be used if the data contains repeated
values. <code>nplty</code> is the line type of the non-parametric
estimate. To omit the non-parametric estimate set <code>nplty</code>
to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>A vector of length two, for the gumbelx (maximum 
of two Gumbels) model. This is passed to the uniroot function to
calculate quantiles for the Q-Q and return level plots. The interval
should be large enough to contain all plotted quantiles or an error
from uniroot will occur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed through to plotting
functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following discussion assumes that the fitted model is
stationary. For non-stationary generalized extreme value
models the data are transformed to stationarity. The plot
then corresponds to the distribution obtained when all
covariates are zero.
</p>
<p>The P-P plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">\{(G_n(z_i), G(z_i)), i = 1,\ldots,m\}</code>
</p>

<p>where <code class="reqn">G_n</code> is the empirical distribution function
(defined using <code>ppoints</code>), G is the model based
estimate of the distribution (generalized extreme value
or generalized Pareto), and <code class="reqn">z_1,\ldots,z_m</code> are the data
used in the fitted model, sorted into ascending order.
</p>
<p>The Q-Q plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">\{(G^{-1}(p_i), z_i), i = 1,\ldots,m\}</code>
</p>

<p>where <code class="reqn">G^{-1}</code> is the model based estimate of the quantile
function (generalized extreme value or generalized Pareto),
<code class="reqn">p_1,\ldots,p_m</code> are plotting points defined by
<code>ppoints</code>, and <code class="reqn">z_1,\ldots,z_m</code> are the data
used in the fitted model, sorted into ascending order.
</p>
<p>The return level plot for generalized extreme value models
is defined as follows.
</p>
<p>Let <code class="reqn">G</code> be the generalized extreme value distribution
function, with location, scale and shape parameters <code class="reqn">a</code>,
<code class="reqn">b</code> and <code class="reqn">s</code> respectively.
Let <code class="reqn">z_t</code> be defined by <code class="reqn">G(z_t) = 1 - 1/t</code>.
In common terminology, <code class="reqn">z_t</code> is the return level
associated with the return period <code class="reqn">t</code>.
</p>
<p>Let <code class="reqn">y_t = -1/\log(1 - 1/t)</code>.
It follows that
</p>
<p style="text-align: center;"><code class="reqn">z_t = a + b(y_t^s - 1)/s.</code>
</p>

<p>When <code class="reqn">s = 0</code>, <code class="reqn">z_t</code> is defined by continuity, so that
</p>
<p style="text-align: center;"><code class="reqn">z_t = a + b\log(y_t).</code>
</p>

<p>The curve within the return level plot is <code class="reqn">z_t</code> plotted
against <code class="reqn">y_t</code> on a logarithmic scale, using maximum likelihood
estimates of <code class="reqn">(a,b,s)</code>. If the estimate of <code class="reqn">s</code> is zero, the
curve will be linear.
For large values of <code class="reqn">t</code>, <code class="reqn">y_t</code> is approximately equal
to the return period <code class="reqn">t</code>. It is usual practice to label the
x-axis as the return period.  
</p>
<p>The points on the plot are  
</p>
<p style="text-align: center;"><code class="reqn">\{(-1/\log(p_i), z_i), i = 1,\ldots,m\}</code>
</p>

<p>where <code class="reqn">p_1,\ldots,p_m</code> are plotting points defined by
<code>ppoints</code>, and <code class="reqn">z_1,\ldots,z_m</code> are the data
used in the fitted model, sorted into ascending order.
For a good fit the points should lie “close” to the curve.
</p>
<p>The return level plot for peaks over threshold models is
defined as follows.
</p>
<p>Let <code class="reqn">G</code> be the generalized Pareto distribution function,
with location, scale and shape parameters <code class="reqn">u</code>, <code class="reqn">b</code>
and <code class="reqn">s</code> respectively, where <code class="reqn">u</code> is the model threshold.
Let <code class="reqn">z_m</code> denote the <code class="reqn">m</code> period return level
(see <code>fpot</code> and the notation therein).
It follows that 
</p>
<p style="text-align: center;"><code class="reqn">z_m = u + b((pmN)^s - 1)/s.</code>
</p>

<p>When <code class="reqn">s = 0</code>, <code class="reqn">z_m</code> is defined by continuity, so that
</p>
<p style="text-align: center;"><code class="reqn">z_m = u + b\log(pmN).</code>
</p>

<p>The curve within the return level plot is <code class="reqn">z_m</code> plotted
against <code class="reqn">m</code> on a logarithmic scale, using maximum likelihood
estimates of <code class="reqn">(b,s,p)</code>. If the estimate of <code class="reqn">s</code> is zero,
the curve will be linear.  
</p>
<p>The points on the plot are  
</p>
<p style="text-align: center;"><code class="reqn">\{(1/(pN(1-p_i)), z_i), i = 1,\ldots,m\}</code>
</p>

<p>where <code class="reqn">p_1,\ldots,p_m</code> are plotting points defined by
<code>ppoints</code>, and <code class="reqn">z_1,\ldots,z_m</code> are the data
used in the fitted model, sorted into ascending order.
For a good fit the points should lie “close” to the curve.
</p>


<h3>See Also</h3>

<p><code>plot.bvevd</code>, <code>density</code>,
<code>jitter</code>, <code>rug</code>, <code>ppoints</code></p>


<h3>Examples</h3>

<pre><code class="language-R">uvdata &lt;- rgev(100, loc = 0.13, scale = 1.1, shape = 0.2)
M1 &lt;- fgev(uvdata)
## Not run: par(mfrow = c(2,2))
## Not run: plot(M1)

uvdata &lt;- rgpd(100, loc = 0, scale = 1.1, shape = 0.2)
M1 &lt;- fpot(uvdata, 1)
## Not run: par(mfrow = c(2,2))
## Not run: plot(M1)
</code></pre>


</div>