<div class="container">

<table style="width: 100%;"><tr>
<td>predIntNormSimultaneousK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute the Value of <code class="reqn">K</code> for a Simultaneous Prediction Interval for a Normal Distribution
</h2>

<h3>Description</h3>

<p>Compute the value of <code class="reqn">K</code> (the multiplier of estimated standard deviation) used
to construct a simultaneous prediction interval based on data from a
normal distribution.
The function <br><code>predIntNormSimultaneousK</code> is called by <code>predIntNormSimultaneous</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  predIntNormSimultaneousK(n, df = n - 1, n.mean = 1, k = 1, m = 2, r = 1,
    rule = "k.of.m", delta.over.sigma = 0, pi.type = "upper", conf.level = 0.95,
    K.tol = .Machine$double.eps^0.5, integrate.args.list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>a positive integer greater than 2 indicating the sample size upon which the
prediction interval is based.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>the degrees of freedom associated with the prediction interval.  The default is
<code>df=n-1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mean</code></td>
<td>

<p>positive integer specifying the sample size associated with the future averages.
The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all
future averages must be based on the same sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), a positive integer
specifying the minimum number of observations (or averages) out of <code class="reqn">m</code>
observations (or averages) (all obtained on one future sampling “occassion”)
the prediction interval should contain with confidence level <code>conf.level</code>.
The default value is <code>k=1</code>.  This argument is ignored when the argument
<code>rule</code> is not equal to <code>"k.of.m"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>positive integer specifying the maximum number of future observations (or
averages) on one future sampling “occasion”.
The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which
case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>positive integer specifying the number of future sampling “occasions”.
The default value is <code>r=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>

<p>character string specifying which rule to use.  The possible values are
<code>"k.of.m"</code> (<code class="reqn">k</code>-of-<code class="reqn">m</code> rule; the default), <code>"CA"</code> (California rule),
and <code>"Modified.CA"</code> (modified California rule).
See the DETAILS section below for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.over.sigma</code></td>
<td>

<p>numeric scalar indicating the ratio <code class="reqn">\Delta/\sigma</code>.  The quantity
<code class="reqn">\Delta</code> (delta) denotes the difference between the mean of the population
that was sampled to construct the prediction interval, and the mean of the
population that will be sampled to produce the future observations.  The quantity
<code class="reqn">\sigma</code> (sigma) denotes the population standard deviation for both populations.
See the DETAILS section below for more information.  The default value is
<code>delta.over.sigma=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.type</code></td>
<td>

<p>character string indicating what kind of prediction interval to compute.  
The possible values are <code>pi.type="upper"</code> (the default), and 
<code>pi.type="lower"</code>.  <b>NOTE:</b> In Versions 2.4.0 - 2.8.1 of <em>EnvStats</em>, 
the value <code>pi.type="two-sided"</code> was allowed, but these two-sided simultaneous 
prediction intervals were based on faulty assumptions and were <b>NOT</b> valid.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a scalar between 0 and 1 indicating the confidence level of the prediction interval.
The default value is <code>conf.level=0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.tol</code></td>
<td>

<p>numeric scalar indicating the tolerance to use in the nonlinear search algorithm to
compute <code class="reqn">K</code>.  The default value is <code>K.tol=.Machine$double.eps^(1/2)</code>.
For many applications, the value of <code class="reqn">K</code> needs to be known only to the second
decimal place, in which case setting <code>K.tol=1e-4</code> will speed up computation a
bit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate.args.list</code></td>
<td>

<p>a list of arguments to supply to the <code>integrate</code> function.  The
default value is <code>integrate.args.list=NULL</code> which means that the
default values of <code>integrate</code> are used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>What is a Simultaneous Prediction Interval?</b> <br>
A prediction interval for some population is an interval on the real line constructed
so that it will contain <code class="reqn">k</code> future observations from that population
with some specified probability <code class="reqn">(1-\alpha)100\%</code>, where
<code class="reqn">0 &lt; \alpha &lt; 1</code> and <code class="reqn">k</code> is some pre-specified positive integer.
The quantity <code class="reqn">(1-\alpha)100\%</code> is called
the confidence coefficient or confidence level associated with the prediction
interval.  The function <code>predIntNorm</code> computes a standard prediction
interval based on a sample from a normal distribution.
</p>
<p>The function <code>predIntNormSimultaneous</code> computes a simultaneous prediction
interval that will contain a certain number of future observations with probability
<code class="reqn">(1-\alpha)100\%</code> for each of <code class="reqn">r</code> future sampling “occasions”,
where <code class="reqn">r</code> is some pre-specified positive integer.  The quantity <code class="reqn">r</code> may
refer to <code class="reqn">r</code> distinct future sampling occasions in time, or it may for example
refer to sampling at <code class="reqn">r</code> distinct locations on one future sampling occasion,
assuming that the population standard deviation is the same at all of the <code class="reqn">r</code>
distinct locations.
</p>
<p>The function <code>predIntNormSimultaneous</code> computes a simultaneous prediction
interval based on one of three possible rules:
</p>

<ul>
<li>
<p> For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>), at least <code class="reqn">k</code> of
the next <code class="reqn">m</code> future observations will fall in the prediction
interval with probability <code class="reqn">(1-\alpha)100\%</code> on each of the <code class="reqn">r</code> future
sampling occasions.  If obserations are being taken sequentially, for a particular
sampling occasion, up to <code class="reqn">m</code> observations may be taken, but once
<code class="reqn">k</code> of the observations fall within the prediction interval, sampling can stop.
Note:  When <code class="reqn">k=m</code> and <code class="reqn">r=1</code>, the results of <code>predIntNormSimultaneous</code>
are equivalent to the results of <code>predIntNorm</code>.
</p>
</li>
<li>
<p> For the California rule (<code>rule="CA"</code>), with probability
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either
the first observation will fall in the prediction interval, or else all of the next
<code class="reqn">m-1</code> observations will fall in the prediction interval. That is, if the first
observation falls in the prediction interval then sampling can stop.  Otherwise,
<code class="reqn">m-1</code> more observations must be taken.
</p>
</li>
<li>
<p> For the Modified California rule (<code>rule="Modified.CA"</code>), with probability
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either the
first observation will fall in the prediction interval, or else at least 2 out of
the next 3 observations will fall in the prediction interval.  That is, if the first
observation falls in the prediction interval then sampling can stop.  Otherwise, up
to 3 more observations must be taken.
</p>
</li>
</ul>
<p>Simultaneous prediction intervals can be extended to using averages (means) in place
of single observations (USEPA, 2009, Chapter 19).  That is, you can create a
simultaneous prediction interval
that will contain a specified number of averages (based on which rule you choose) on
each of <code class="reqn">r</code> future sampling occassions, where each each average is based on
<code class="reqn">w</code> individual observations.  For the functions
<code>predIntNormSimultaneous</code> and <code>predIntNormSimultaneousK</code>,
the argument <code>n.mean</code> corresponds to <code class="reqn">w</code>.
<br></p>
<p><em>The Form of a Prediction Interval for 1 Future Observation</em> <br>
Let <code class="reqn">\underline{x} = x_1, x_2, \ldots, x_n</code> denote a vector of <code class="reqn">n</code>
observations from a normal distribution with parameters
<code>mean=</code><code class="reqn">\mu</code> and <code>sd=</code><code class="reqn">\sigma</code>.  Also, let <code class="reqn">w</code> denote the
sample size associated with the future averages (i.e., <code>n.mean=</code><code class="reqn">w</code>).
When <code class="reqn">w=1</code>, each average is really just a single observation, so in the rest of
this help file the term “averages” will sometimes replace the phrase
“observations or averages”.
</p>
<p>For a normal distribution, the form of a two-sided <code class="reqn">(1-\alpha)100\%</code>
simultaneous prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)</code>
</p>

<p>where <code class="reqn">\bar{x}</code> denotes the sample mean:
</p>
<p style="text-align: center;"><code class="reqn">\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)</code>
</p>

<p><code class="reqn">s</code> denotes the sample standard deviation:
</p>
<p style="text-align: center;"><code class="reqn">s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)</code>
</p>

<p>and <code class="reqn">K</code> denotes a constant that depends on the sample size <code class="reqn">n</code>, the
confidence level, the number of future sampling occassions <code class="reqn">r</code>, and the
sample size associated with the future averages, <code class="reqn">w</code>.  Do not confuse the
constant <code class="reqn">K</code> (uppercase K) with the number of future averages <code class="reqn">k</code>
(lowercase k) in the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule.  The symbol <code class="reqn">K</code> is used here
to be consistent with the notation used for tolerance intervals
(see <code>tolIntNorm</code>).
</p>
<p>Similarly, the form of a one-sided lower prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)</code>
</p>

<p>and the form of a one-sided upper prediction interval is:
</p>
<p style="text-align: center;"><code class="reqn">[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)</code>
</p>

<p>The derivation of the constant <code class="reqn">K</code> for 1 future observation is 
explained in the help file for <code>predIntNormK</code>.
<br></p>
<p><em>The Form of a Simultaneous Prediction Interval</em> <br>
For <b>simultaneous</b> prediction intervals, only lower 
(<code>pi.type="lower"</code>) and upper (<code>pi.type="upper"</code>) prediction
intervals are available.  Two-sided simultaneous prediction intervals were 
available in Versions 2.4.0 - 2.8.1 of <em>EnvStats</em>, but these prediction 
intervals were based on an incorrect algorithm for <code class="reqn">K</code>.
</p>
<p>Equations (4) and (5) above hold for simultaneous prediction intervals, but the 
derivation of the constant <code class="reqn">K</code> is more difficult, and is explained below.
<br></p>
<p><b>The Derivation of K for Future Observations</b> <br>
First we will show the derivation based on future observations (i.e.,
<code class="reqn">w=1</code>, <code>n.mean=1</code>), and then extend the formulas to future averages.
</p>
<p><em>The Derivation of K for the k-of-m Rule</em> (<code>rule="k.of.m"</code>) <br>
For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule (<code>rule="k.of.m"</code>) with <code class="reqn">w=1</code>
(i.e., <code>n.mean=1</code>), at least <code class="reqn">k</code> of the next <code class="reqn">m</code> future
observations will fall in the prediction interval
with probability <code class="reqn">(1-\alpha)100\%</code> on each of the <code class="reqn">r</code> future sampling
occasions.  If observations are being taken sequentially, for a particular
sampling occasion, up to <code class="reqn">m</code> observations may be taken, but once <code class="reqn">k</code>
of the observations fall within the prediction interval, sampling can stop.
Note: When <code class="reqn">k=m</code> and <code class="reqn">r=1</code>, this kind of simultaneous prediction
interval becomes the same as a standard prediction interval for the next
<code class="reqn">k</code> observations (see <code>predIntNorm</code>).
</p>
<p>For the case when <code class="reqn">r=1</code> future sampling occasion, both Hall and Prairie (1973)
and Fertig and Mann (1977) discuss the derivation of <code class="reqn">K</code>.  Davis and McNichols
(1987) extend the derivation to the case where <code class="reqn">r</code> is a positive integer.  They
show that for a one-sided upper prediction interval (<code>pi.type="upper"</code>), the
probability <code class="reqn">p</code> that at least <code class="reqn">k</code> of the next <code class="reqn">m</code> future observations
will be contained in the interval given in Equation (5) above, for each of <code class="reqn">r</code>
future sampling occasions, is given by:
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r[I(v; k, m+1-k)]^{r-1} [\frac{v^{k-1}(1-v)^{m-k}}{B(k, m+1-k)}] dv \;\;\;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">T(x; \nu, \delta)</code> denotes the cdf of the
non-central Student's t-distribution with parameters
<code>df=</code><code class="reqn">\nu</code> and <code>ncp=</code><code class="reqn">\delta</code> evaluated at <code class="reqn">x</code>;
<code class="reqn">\Phi(x)</code> denotes the cdf of the standard normal distribution
evaluated at <code class="reqn">x</code>; <code class="reqn">I(x; \nu, \omega)</code> denotes the cdf of the
beta distribution with parameters <code>shape1=</code><code class="reqn">\nu</code> and
<code>shape2=</code><code class="reqn">\omega</code>; and <code class="reqn">B(\nu, \omega)</code> denotes the value of the
beta function with parameters <code>a=</code><code class="reqn">\nu</code> and
<code>b=</code><code class="reqn">\omega</code>.
</p>
<p>The quantity <code class="reqn">\Delta</code> (upper case delta) denotes the difference between the
mean of the population that was sampled to construct the prediction interval, and
the mean of the population that will be sampled to produce the future observations.
The quantity <code class="reqn">\sigma</code> (sigma) denotes the population standard deviation of both
of these populations.  Usually you assume <code class="reqn">\Delta=0</code> unless you are interested
in computing the power of the rule to detect a change in means between the
populations (see <code>predIntNormSimultaneousTestPower</code>).
</p>
<p>For given values of the confidence level (<code class="reqn">p</code>), sample size (<code class="reqn">n</code>),
minimum number of future observations to be contained in the interval per
sampling occasion (<code class="reqn">k</code>), number of future observations per sampling occasion
(<code class="reqn">m</code>), and number of future sampling occasions (<code class="reqn">r</code>), Equation (6) can
be solved for <code class="reqn">K</code>.  The function <code>predIntNormSimultaneousK</code> uses the
<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>nlminb</code> to solve Equation (6) for <code class="reqn">K</code>.
</p>
<p>When <code>pi.type="lower"</code>, the same value of <code class="reqn">K</code> is used as when
<code>pi.type="upper"</code>, but Equation (4) is used to construct the prediction
interval.
<br></p>
<p><em>The Derivation of K for the California Rule</em> (<code>rule="CA"</code>) <br>
For the California rule (<code>rule="CA"</code>), with probability <code class="reqn">(1-\alpha)100\%</code>,
for each of the <code class="reqn">r</code> future sampling occasions, either the first observation will
fall in the prediction interval, or else all of the next <code class="reqn">m-1</code> observations will
fall in the prediction interval.  That is, if the first observation falls in the
prediction interval then sampling can stop.  Otherwise, <code class="reqn">m-1</code> more observations
must be taken.
</p>
<p>The formula for <code class="reqn">K</code> is the same as for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule, except that
Equation (6) becomes the following (Davis, 1998b):
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r\{v[1+v^{m-2}(1-v)]\}^{r-1} [1+v^{m-2}(m-1-mv)] dv \;\;\;\;\;\; (7)</code>
</p>

<p><br></p>
<p><em>The Derivation of K for the Modified California Rule</em> (<code>rule="Modified.CA"</code>) <br>
For the Modified California rule (<code>rule="Modified.CA"</code>), with probability
<code class="reqn">(1-\alpha)100\%</code>, for each of the <code class="reqn">r</code> future sampling occasions, either the
first observation will fall in the prediction interval, or else at least 2 out of
the next 3 observations will fall in the prediction interval.  That is, if the first
observation falls in the prediction interval then sampling can stop.  Otherwise, up
to 3 more observations must be taken.
</p>
<p>The formula for <code class="reqn">K</code> is the same as for the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule, except that
Equation (6) becomes the following (Davis, 1998b):
</p>
<p style="text-align: center;"><code class="reqn">p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r\{v[1+v(3-v[5-2v])]\}^{r-1} \{1+v[6-v(15-8v)]\} dv \;\;\;\;\;\; (8)</code>
</p>

<p><br></p>
<p><b>The Derivation of K for Future Means</b> <br>
For each of the above rules, if we are interested in using averages instead of
single observations, with <code class="reqn">w \ge 1</code> (i.e., <code>n.mean</code><code class="reqn">\ge 1</code>), the first
term in the integral in Equations (6)-(8) that involves the cdf of the
non-central Student's t-distribution becomes:
</p>
<p style="text-align: center;"><code class="reqn">T(\sqrt{n}K; n-1, \frac{\sqrt{n}}{\sqrt{w}}[\Phi^{-1}(v) + \frac{\sqrt{w}\Delta}{\sigma}]) \;\;\;\;\;\; (9)</code>
</p>



<h3>Value</h3>

<p>A numeric scalar equal to <code class="reqn">K</code>, the multiplier of estimated standard
deviation that is used to construct the simultaneous prediction interval.
</p>


<h3>Note</h3>

<p><em>Motivation</em> <br>
Prediction and tolerance intervals have long been applied to quality control and
life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973).  In the context of
environmental statistics, prediction intervals are useful for analyzing data from
groundwater detection monitoring programs at hazardous and solid waste facilities.
</p>
<p>One of the main statistical problems that plague groundwater monitoring programs at
hazardous and solid waste facilities is the requirement of testing several wells and
several constituents at each well on each sampling occasion.  This is an obvious
multiple comparisons problem, and the naive approach of using a standard t-test at
a conventional <code class="reqn">\alpha</code>-level (e.g., 0.05 or 0.01) for each test leads to a
very high probability of at least one significant result on each sampling occasion,
when in fact no contamination has occurred.  This problem was pointed out years ago
by Millard (1987) and others.
</p>
<p>Davis and McNichols (1987) proposed simultaneous prediction intervals as a way of
controlling the facility-wide false positive rate (FWFPR) while maintaining adequate
power to detect contamination in the groundwater.  Because of the ubiquitous presence
of spatial variability, it is usually best to use simultaneous prediction intervals
at each well (Davis, 1998a).  That is, by constructing prediction intervals based on
background (pre-landfill) data on each well, and comparing future observations at a
well to the prediction interval for that particular well.  In each of these cases,
the individual <code class="reqn">\alpha</code>-level at each well is equal to the FWFRP divided by the
product of the number of wells and constituents.
</p>
<p>Often, observations at downgradient wells are not available prior to the
construction and operation of the landfill.  In this case, upgradient well data can
be combined to create a background prediction interval, and observations at each
downgradient well can be compared to this prediction interval.  If spatial
variability is present and a major source of variation, however, this method is not
really valid (Davis, 1994; Davis, 1998a).
</p>
<p>Chapter 19 of USEPA (2009) contains an extensive discussion of using the
<code class="reqn">1</code>-of-<code class="reqn">m</code> rule and the Modified California rule.
</p>
<p>Chapters 1 and 3 of Gibbons et al. (2009) discuss simultaneous prediction intervals
for the normal and lognormal distributions, respectively.
<br></p>
<p><em>The k-of-m Rule</em> <br>
For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule, Davis and McNichols (1987) give tables with
“optimal” choices of <code class="reqn">k</code> (in terms of best power for a given overall
confidence level) for selected values of <code class="reqn">m</code>, <code class="reqn">r</code>, and <code class="reqn">n</code>.  They found
that the optimal ratios of <code class="reqn">k</code> to <code class="reqn">m</code> (i.e., <code class="reqn">k/m</code>) are generally small,
in the range of 15-50%.
<br></p>
<p><em>The California Rule</em> <br>
The California rule was mandated in that state for groundwater monitoring at waste
disposal facilities when resampling verification is part of the statistical program
(Barclay's Code of California Regulations, 1991).  The California code mandates a
“California” rule with <code class="reqn">m \ge 3</code>.  The motivation for this rule may have
been a desire to have a majority of the observations in bounds (Davis, 1998a).  For
example, for a <code class="reqn">k</code>-of-<code class="reqn">m</code> rule with <code class="reqn">k=1</code> and <code class="reqn">m=3</code>, a monitoring
location will pass if the first observation is out of bounds, the second resample
is out of bounds, but the last resample is in bounds, so that 2 out of 3 observations
are out of bounds.  For the California rule with <code class="reqn">m=3</code>, either the first
observation must be in bounds, or the next 2 observations must be in bounds in order
for the monitoring location to pass.
</p>
<p>Davis (1998a) states that if the FWFPR is kept constant, then the California rule
offers little increased power compared to the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule, and can
actually decrease the power of detecting contamination.
<br></p>
<p><em>The Modified California Rule</em> <br>
The Modified California Rule was proposed as a compromise between a 1-of-<code class="reqn">m</code>
rule and the California rule.  For a given FWFPR, the Modified California rule
achieves better power than the California rule, and still requires at least as many
observations in bounds as out of bounds, unlike a 1-of-<code class="reqn">m</code> rule.
<br></p>
<p><em>Different Notations Between Different References</em> <br>
For the <code class="reqn">k</code>-of-<code class="reqn">m</code> rule described in this help file, both
Davis and McNichols (1987) and USEPA (2009, Chapter 19) use the variable <code class="reqn">p</code> instead of <code class="reqn">k</code> to represent the minimum number
of future observations the interval should contain on each of the <code class="reqn">r</code> sampling
occasions.
</p>
<p>Gibbons et al. (2009, Chapter 1) presents extensive lists of the value of
<code class="reqn">K</code> for both <code class="reqn">k</code>-of-<code class="reqn">m</code> rules and California rules.  Gibbons et al.'s
notation reverses the meaning of <code class="reqn">k</code> and <code class="reqn">r</code> compared to the notation used
in this help file.  That is, in Gibbons et al.'s notation, <code class="reqn">k</code> represents the
number of future sampling occasions or monitoring wells, and <code class="reqn">r</code> represents the
minimum number of observations the interval should contain on each sampling occasion.
</p>
<p>USEPA (2009, Chapter 19) uses <code class="reqn">p</code> in place of <code class="reqn">k</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p><b>Barclay's California Code of Regulations</b>. (1991). Title 22,
Section 66264.97 [concerning hazardous waste facilities] and Title 23,
Section 2550.7(e)(8) [concerning solid waste facilities].
Barclay's Law Publishers, San Francisco, CA.
</p>
<p>Davis, C.B. (1998a).  <em>Ground-Water Statistics &amp; Regulations:  Principles,
Progress and Problems</em>.  Second Edition.  Environmetrics &amp; Statistics Limited,
Henderson, NV.
</p>
<p>Davis, C.B. (1998b). Personal Communication, September 3, 1998.
</p>
<p>Davis, C.B., and R.J. McNichols. (1987).  One-sided Intervals for at Least <code class="reqn">p</code>
of <code class="reqn">m</code> Observations from a Normal Population on Each of <code class="reqn">r</code> Future Occasions.
<em>Technometrics</em> <b>29</b>, 359–370.
</p>
<p>Fertig, K.W., and N.R. Mann. (1977).  One-Sided Prediction Intervals for at Least
<code class="reqn">p</code> Out of <code class="reqn">m</code> Future Observations From a Normal Population.
<em>Technometrics</em> <b>19</b>, 167–177.
</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
<em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
John Wiley &amp; Sons, Hoboken.
</p>
<p>Hahn, G.J. (1969). Factors for Calculating Two-Sided Prediction Intervals for
Samples from a Normal Distribution.
<em>Journal of the American Statistical Association</em> <b>64</b>(327), 878-898.
</p>
<p>Hahn, G.J. (1970a). Additional Factors for Calculating Prediction Intervals for
Samples from a Normal Distribution.
<em>Journal of the American Statistical Association</em> <b>65</b>(332), 1668-1676.
</p>
<p>Hahn, G.J. (1970b). Statistical Intervals for a Normal Population, Part I: Tables,
Examples and Applications. <em>Journal of Quality Technology</em> <b>2</b>(3), 115-125.
</p>
<p>Hahn, G.J. (1970c). Statistical Intervals for a Normal Population, Part II:
Formulas, Assumptions, Some Derivations. <em>Journal of Quality Technology</em>
<b>2</b>(4), 195-206.
</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for
Practitioners</em>.  John Wiley and Sons, New York.
</p>
<p>Hahn, G., and W. Nelson. (1973). A Survey of Prediction Intervals and Their
Applications.  <em>Journal of Quality Technology</em> <b>5</b>, 178-188.
</p>
<p>Hall, I.J., and R.R. Prairie. (1973).  One-Sided Prediction Intervals to Contain at
Least <code class="reqn">m</code> Out of <code class="reqn">k</code> Future Observations.
<em>Technometrics</em> <b>15</b>, 897–914.
</p>
<p>Millard, S.P. (1987).  Environmental Monitoring, Statistics, and the Law:  Room for
Improvement (with Comment).  <em>The American Statistician</em> <b>41</b>(4), 249–259.
</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
CRC Press, Boca Raton, Florida.
</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
U.S. Environmental Protection Agency, Washington, D.C.
</p>


<h3>See Also</h3>

<p><code>predIntNormSimultaneous</code>,
<code>predIntNormSimultaneousTestPower</code>,
<code>predIntNorm</code>, <code>predIntNormK</code>,
<code>predIntLnormSimultaneous</code>, <code>tolIntNorm</code>,
Normal, <code>estimate.object</code>, <code>enorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Compute the value of K for an upper 95% simultaneous prediction 
  # interval to contain at least 1 out of the next 3 observations 
  # given a background sample size of n=8.

  predIntNormSimultaneousK(n = 8, k = 1, m = 3)
  #[1] 0.5123091

  #----------

  # Compare the value of K for a 95% 1-of-3 upper prediction interval to 
  # the value for the California and Modified California rules.  
  # Note that the value of K for the Modified California rule is between 
  # the value of K for the 1-of-3 rule and the California rule. 

  predIntNormSimultaneousK(n = 8, k = 1, m = 3) 
  #[1] 0.5123091 
 
  predIntNormSimultaneousK(n = 8, m = 3, rule = "CA")
  #[1] 1.252077

  predIntNormSimultaneousK(n = 8, rule = "Modified.CA")
  #[1] 0.8380233

  #----------

  # Show how the value of K for an upper 95% simultaneous prediction 
  # limit increases as the number of future sampling occasions r increases.  
  # Here, we'll use the 1-of-3 rule.

  predIntNormSimultaneousK(n = 8, k = 1, m = 3)
  #[1] 0.5123091 


  predIntNormSimultaneousK(n = 8, k = 1, m = 3, r = 10)
  #[1] 1.363002

  #==========

  # Example 19-1 of USEPA (2009, p. 19-17) shows how to compute an 
  # upper simultaneous prediction limit for the 1-of-3 rule for 
  # r = 2 future sampling occasions.  The data for this example are 
  # stored in EPA.09.Ex.19.1.sulfate.df.

  # We will pool data from 4 background wells that were sampled on 
  # a number of different occasions, giving us a sample size of 
  # n = 25 to use to construct the prediction limit.

  # There are 50 compliance wells and we will monitor 10 different 
  # constituents at each well at each of the r=2 future sampling 
  # occasions.  To determine the confidence level we require for 
  # the simultaneous prediction interval, USEPA (2009) recommends 
  # setting the individual Type I Error level at each well to 
 
  # 1 - (1 - SWFPR)^(1 / (Number of Constituents * Number of Wells))
  
  # which translates to setting the confidence limit to 

  # (1 - SWFPR)^(1 / (Number of Constituents * Number of Wells))

  # where SWFPR = site-wide false positive rate.  For this example, we 
  # will set SWFPR = 0.1.  Thus, the confidence level is given by:

  nc &lt;- 10
  nw &lt;- 50
  SWFPR &lt;- 0.1
  conf.level &lt;- (1 - SWFPR)^(1 / (nc * nw))

  conf.level
  #[1] 0.9997893

  #----------

  # Compute the value of K for the upper simultaneous prediction 
  # limit for the 1-of-3 plan.

  predIntNormSimultaneousK(n = 25, k = 1, m = 3, r = 2, 
    rule = "k.of.m", pi.type = "upper", conf.level = conf.level)
  #[1] 2.014365


 #==========

  ## Not run: 
  # Try to compute K for a two-sided simultaneous prediction interval:

  predIntNormSimultaneousK(n = 25, k = 1, m = 3, r = 2,
   rule = "k.of.m", pi.type = "two-sided", conf.level = conf.level)
  #Error in predIntNormSimultaneousK(n = 25, k = 1, m = 3, r = 2, rule = "k.of.m",  : 
  #  Two-sided simultaneous prediction intervals are not currently available.
  # NOTE: Two-sided simultaneous prediction intervals computed using
  # Versions 2.4.0 - 2.8.1 of EnvStats are *NOT* valid.
  
## End(Not run)

  #==========

  # Cleanup
  #--------

  rm(nc, nw, SWFPR, conf.level)
</code></pre>


</div>