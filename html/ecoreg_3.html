<div class="container">

<table style="width: 100%;"><tr>
<td>integrate.gh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Univariate Gauss-Hermite integration</h2>

<h3>Description</h3>

<p>Computes the integral of a univariate function, or several univariate
functions simultaneously, using Gauss-Hermite quadrature. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">integrate.gh(h, n=1, points = 10, mu = 0, scale = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p> The function to be integrated. May either have a scalar
first argument and return a scalar result, or have a first argument of
length <code>n</code> and return a vector of <code>n</code> results, corresponding to <code>n</code>
independent functions.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The dimension of the result returned by <code>h</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p> Number of Gauss-Hermite quadrature points.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> Mode of the function, to centre the quadrature points
around. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> Scale of the quadrature points. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Other arguments to be passed to <code>h</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The integral is more accurate if the standard quadrature points are
shifted and scaled to match the mode and scale of <code class="reqn">g(x)</code>, that is
the objective function divided by the standard normal density.  The
scale is estimated by
<code class="reqn">1/\sqrt{-H}</code>, where H is the Hessian at the maximum
of <code class="reqn">g(x)</code>.
</p>


<h3>Value</h3>

<p>The integral of <code class="reqn">h(x)</code> between <code>-Inf</code> and <code>Inf</code>, of length
<code>n</code>.  In the usual application of Gauss-Hermite quadrature,
<code class="reqn">h(x)</code> is equivalent to a function <code class="reqn">g(x)\phi(x)</code>, where
<code class="reqn">\phi(x)</code> is the standard normal density function. 
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>
<p>The Gauss-Hermite polynomial values and weights are calculated using
the <code>gauss.hermite</code> function copied from the <span class="pkg">rmutil</span>
package by J. K. Lindsey. 
</p>


<h3>References</h3>

<p>Liu, Q. and Pierce, D. A. (1994) <em>A note on Gauss-Hermite
quadrature</em>. Biometrika, 81 (624-629)
</p>


<h3>See Also</h3>

<p><code>gauss.hermite</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Want the integral of h over the real line
g &lt;- function(x) 4 * exp( - ((1 - x)^2 + 1))
h &lt;- function(x) g(x) * dnorm(x)
integrate(h, -Inf, Inf)
integrate.gh(h)
## Not very accurate with default 10 points. Either use more quadrature points, 
integrate.gh(h, points=30)
## or shift and scale the points.
opt &lt;- nlm(function(x) -g(x), 0, hessian=TRUE)
integrate.gh(h, mu=opt$estimate, scale=1/sqrt(opt$hessian))

</code></pre>


</div>