<div class="container">

<table style="width: 100%;"><tr>
<td>plot_expirest_wisle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Illustrating the what-if (approach for) shelf life estimate (wisle)</h2>

<h3>Description</h3>

<p>The function <code>plot_expirest_wisle()</code> makes a graphical display of the
shelf life estimate done by the <code>expirest_wisle()</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_expirest_wisle(
  model,
  rl_index = 1,
  show_grouping = "yes",
  response_vbl_unit = NULL,
  x_range = NULL,
  y_range = NULL,
  scenario = "standard",
  mtbs = "verified",
  plot_option = "full",
  ci_app = "line"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>An ‘<code>expirest_wisle</code>’ object, i.e. a list returned
by the <code>expirest_wisle()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rl_index</code></td>
<td>
<p>A positive integer that specifies which of the release limit
values that have been handed over to <code>expirest_wisle()</code> should
be displayed. The default value is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_grouping</code></td>
<td>
<p>'r lifecycle::badge("deprecated")'
'show_grouping = \"yes\" or \"no\"' is no longer supported. Use the
<code>mtbs</code> parameter instead which allows choosing a specific model,
i.e. also the <em>common intercept / common slope case</em> model which
was the default model when <code>show_grouping</code> was <code>"no"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_vbl_unit</code></td>
<td>
<p>A character string that specifies the unit
associated with the response variable. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_range</code></td>
<td>
<p>A numeric vector of the form <code>c(min, max)</code> that
specifies the range of the time variable to be plotted. The default is
<code>NULL</code> and the <code class="reqn">x</code> range is calculated automatically on the basis
of the estimated shelf life.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_range</code></td>
<td>
<p>A numeric vector of the form <code>c(min, max)</code> that
specifies the range of the response variable to be plotted. The default
is <code>NULL</code> and the <code class="reqn">y</code> range is calculated automatically on the
basis of the time course of the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenario</code></td>
<td>
<p>A character string that specifies if the plot should be
extended (with respect to the <code class="reqn">x</code> axis) up to the “standard
scenario” (<code>"standard"</code>) or up to the “worst case scenario”
(<code>"worst"</code>). The default is <code>"standard"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtbs</code></td>
<td>
<p>A character string that specifies the “model to be shown”,
i.e. either <code>verified</code>, which is the default, or one of <code>cics</code>,
<code>dics</code>, <code>dids</code> or <code>dids.pmse</code>. The <code>verified</code> model
is the model that was identified through the poolability check. It is
thus also one of the possible optional models. The <code>dids</code> model
represents the case where a separate model is fitted to the data of each
individual batch while the <code>dids.pmse</code> model is the interaction
model which includes the <code class="reqn">batch</code> variable as main effect and in the
interaction term with the <code class="reqn">time</code> variable (<code class="reqn">batch \times time</code>),
i.e. a model where the mean square error is pooled across batches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_option</code></td>
<td>
<p>A character string of either <code>"full"</code>,
<code>"lean1"</code>, <code>"lean2"</code>, <code>"basic1"</code> and <code>"basic2"</code>
that specifies if additional information should be shown in the plot
(option <code>"full"</code>) or only basic information (options <code>"lean"</code>
and <code>"basic"</code>). Full means the data points, the fitted regression
line with the confidence or prediction interval, the specification
limit(s) and the estimated shelf life. The default is <code>"full"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_app</code></td>
<td>
<p>A character string of either <code>"line"</code> or <code>"ribbon"</code>,
that specifies the appearance of the confidence interval, i.e. if the
limits should be plotted as lines (option <code>"line"</code>) or as a shaded
ribbon (option <code>"ribbon"</code>). The default is <code>"line"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>plot_expirest_wisle()</code> uses the data and the
information about the linear model that was used for the estimation of
the shelf life by aid of the <code>expirest_wisle()</code> function. It
plots a graph of the time course of a parameter, a linear regression line
fitted to the data and the associated confidence or prediction interval.
In addition, it shows features of the worst case scenario shelf life
estimation.
</p>
<p>For plotting, the <code>ggplot()</code> function from the
‘<code>ggplot2</code>’ package is used. The various arguments can be
used to control the appearance of the plot. The ‘<code>ggplot2</code>’
object of the generated plot is contained in the <code>Graph</code> element of
the list that is returned by <code>plot_expirest_wisle()</code> and can be
used to modify the appearance of the graph.
</p>


<h3>Value</h3>

<p>An object of class ‘<code>plot_expirest_wisle</code>’ is returned
invisibly consisting of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The ‘<code>expirest_wisle</code>’ object that was passed via
the <code>model</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Expiery</code></td>
<td>
<p>A data frame of type <code>expiry</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph</code></td>
<td>
<p>A ‘<code>ggplot2</code>’ object for the graphical display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prediction</code></td>
<td>
<p>A data frame of the predicted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>A data frame of the text elements on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hlines</code></td>
<td>
<p>A data frame of the horizontal line elements on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vlines</code></td>
<td>
<p>A data frame of the vertical line elements on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>
<p>A data frame of segment line elements on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow</code></td>
<td>
<p>A data frame of arrow elements on the plot.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>expirest_wisle</code>, <code>expirest_osle</code>,
<code>plot_expirest_osle</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Start by making a "what-if (approach for) shelf life estimation" (wisle)
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

# Pass the 'expirest_wisle' object on to the plot_expirest_wisle() function.
# This function does not produce any output. It returns a 'plot_expirest_wisle'
# object that is essentially an 'expirest_wisle' object augmented by a 'ggplot'
# object.
gg1 &lt;- plot_expirest_wisle(
  model = res1, rl_index = 1, response_vbl_unit = "%", x_range = NULL,
  y_range = c(93, 105), scenario = "standard", mtbs = "verified",
  plot_option = "full", ci_app = "line")

## Not run: 
  gg1

  # Since the element gg1$Graph is a 'ggplot' object it can be used for further
  # manipulation by aid of 'ggplot2' functions.
  if (requireNamespace("ggplot2")) {
    library(ggplot2)

    gg1$Graph + labs(title = "What-if Shelf Life Estimation (WISLE)",
                     x = "Time [months]", y = "Potency [% LC]") +
      scale_x_continuous(limits = c(-5, 31), breaks = seq(0, 30, 6))
  }

## End(Not run)

# Repeat this for a different intercept / different slope (dids) model.
res2 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

gg2 &lt;- plot_expirest_wisle(
  model = res2, rl_index = 1, response_vbl_unit = "%", x_range = c(0, 26),
  y_range = c(89, 107),  scenario = "standard",  mtbs = "verified",
  plot_option = "full", ci_app = "ribbon")
## Not run: 
  gg2

## End(Not run)

# In case of different intercept / different slope models, individually fit
# linear models are shown by default, i.e. with the 'mtbs' parameter set
# as "verified". To get the different intercept / different slope model
# displayed where the mean square error is pooled across batches, i.e. the
# dids.pmse model, the 'mtbs' parameter has to be set accordingly.

gg3 &lt;- plot_expirest_wisle(
  model = res2, rl_index = 1, response_vbl_unit = "%", x_range = c(0, 26),
  y_range = c(89, 107),  scenario = "standard",  mtbs = "dids.pmse",
  plot_option = "full", ci_app = "ribbon")
## Not run: 
  gg3

## End(Not run)
</code></pre>


</div>