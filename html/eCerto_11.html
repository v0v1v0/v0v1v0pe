<div class="container">

<table style="width: 100%;"><tr>
<td>eCerto_R6Class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A reactive class based on an R6 object.</h2>

<h3>Description</h3>

<p>Builds a class, which allows only restricted access to the
contained 'reactiveValues'. Elements should be accessed via <code>getValue()</code>.
Possible advantages are that (1) structure of 'reactiveValues' is clear
from the beginning (no function like "addVariable" should exist!) and that
(2) functions to calculate the mean or plot current data can be implemented
here directly.
</p>
<p>General access to data object (so data object can maybe get
changed without that much code edit)
</p>
<p>Returns element. If 'key' is used, reactivity not working correctly.
Preferable way for calling <code>getValue(df, key)</code>, see example
</p>


<h3>Usage</h3>

<pre><code class="language-R">setValue(df, key, value)

getValue(df, key = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>An object of class R6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>Key value within R6 object 'df'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Value to set.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Nothing. The R6 object is updated automatically.
</p>
<p>Value of 'key' from 'df'.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>cur_an</code></dt>
<dd>
<p>Set or return the current analyte (reactiveVal) via an active binding.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-eCerto-new"><code>eCerto$new()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-get"><code>eCerto$get()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-set"><code>eCerto$set()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-c_plot"><code>eCerto$c_plot()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-c_lab_means"><code>eCerto$c_lab_means()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-c_analytes"><code>eCerto$c_analytes()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-c_lab_codes"><code>eCerto$c_lab_codes()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-a_p"><code>eCerto$a_p()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-e_present"><code>eCerto$e_present()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-c_fltData"><code>eCerto$c_fltData()</code></a>
</p>
</li>
<li> <p><a href="#method-eCerto-clone"><code>eCerto$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-eCerto-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Write the (reactive) value of element 'keys' from list 'l'.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$new(rv)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>rv</code></dt>
<dd>
<p>'reactiveValues' object.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new 'eCerto' object.
</p>


<hr>
<a id="method-eCerto-get"></a>



<h4>Method <code>get()</code>
</h4>

<p>Read the value of field element of R6 object.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$get(keys = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>keys</code></dt>
<dd>
<p>Name of list element.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Current value of field.
</p>


<hr>
<a id="method-eCerto-set"></a>



<h4>Method <code>set()</code>
</h4>

<p>Set element of R6 object defined by 'keys' to new value.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$set(keys = NULL, value)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>keys</code></dt>
<dd>
<p>Name(s) of list element.</p>
</dd>
<dt><code>value</code></dt>
<dd>
<p>New value.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>New value of element (invisible).
</p>


<hr>
<a id="method-eCerto-c_plot"></a>



<h4>Method <code>c_plot()</code>
</h4>

<p>Plot the certification data either provided by the user or from the private slot of self.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$c_plot(data, annotate_id = FALSE, filename_labels = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt>
<dd>
<p>data.frame containing columns 'value', 'Lab' and 'L_flt' for a specific analyte.</p>
</dd>
<dt><code>annotate_id</code></dt>
<dd>
<p>T/F to overlay the plot with ID as text if column 'ID' is present.</p>
</dd>
<dt><code>filename_labels</code></dt>
<dd>
<p>T/F to use imported file names as labels on x-axes.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A plot.
</p>


<hr>
<a id="method-eCerto-c_lab_means"></a>



<h4>Method <code>c_lab_means()</code>
</h4>

<p>Compute the analyte means for a data set filtered for a specific analyte.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$c_lab_means(data)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt>
<dd>
<p>data.frame containing columns 'analyte', 'value', 'Lab', 'S_flt' and 'L_flt'.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A data.frame of lab means.
</p>


<hr>
<a id="method-eCerto-c_analytes"></a>



<h4>Method <code>c_analytes()</code>
</h4>

<p>Return analyte names currently in apm.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$c_analytes()</pre></div>



<h5>Returns</h5>

<p>A named character vector.
</p>


<hr>
<a id="method-eCerto-c_lab_codes"></a>



<h4>Method <code>c_lab_codes()</code>
</h4>

<p>Return lab codes currently in C data.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$c_lab_codes()</pre></div>



<h5>Returns</h5>

<p>A named character vector.
</p>


<hr>
<a id="method-eCerto-a_p"></a>



<h4>Method <code>a_p()</code>
</h4>

<p>Return currently specified values of a type for all analytes.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$a_p(
  val = c("precision", "precision_export", "pooling", "confirmed", "unit", "name")
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>val</code></dt>
<dd>
<p>A character value indicating the item of the apm list to be extracted</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A named vector.
</p>


<hr>
<a id="method-eCerto-e_present"></a>



<h4>Method <code>e_present()</code>
</h4>

<p>Return modules with existing data.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$e_present()</pre></div>



<h5>Returns</h5>

<p>A named logical vector.
</p>


<hr>
<a id="method-eCerto-c_fltData"></a>



<h4>Method <code>c_fltData()</code>
</h4>

<p>Filter the full data set for a specific analyte and remove all 'S_flt' but keep 'L_flt'.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$c_fltData(recalc = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>recalc</code></dt>
<dd>
<p>If TRUE triggers a recalculation and returns current object if FALSE..</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A data.frame with filtered data of a single analyte.
</p>


<hr>
<a id="method-eCerto-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>eCerto$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
if (interactive()) {
  # establish new Shiny session and new eCerto object
  ShinySession &lt;- shiny::MockShinySession$new()
  test &lt;- eCerto::eCerto$new()
  # view current value stored in specific eCerto slot and register observer
  shiny::isolate(eCerto::getValue(test, c("Certification", "data")))
  shiny::observeEvent(eCerto::getValue(test, c("Certification", "data")), {
    message("Certification$data changed:", eCerto::getValue(test, "Certification")$data)
  })
  # change value of specific eCerto slot and flush reactivity to trigger observer
  shiny::isolate(eCerto::setValue(test, c("Certification", "data"), 5))
  ShinySession$flushReact()
  shiny::isolate(eCerto::getValue(test, c("Certification", "data")))
}
tmp &lt;- eCerto$new()
shiny::isolate(tmp$c_plot())
shiny::isolate(tmp$c_lab_means())
tmp$c_analytes()
tmp$c_lab_codes()
tmp$a_p()
tmp$a_p("pooling")
ca &lt;- shiny::isolate(tmp$cur_an)
tmp$a_p("pooling")[ca]
shiny::isolate(tmp$e_present())
tmp$c_fltData()
shiny::isolate(tmp$cur_an &lt;- "Fe")
shiny::isolate(tmp$cur_an)
tmp$c_fltData()
x &lt;- shiny::isolate(eCerto::getValue(tmp, c("General", "apm")))
x[[shiny::isolate(tmp$cur_an)]][["lab_filter"]] &lt;- "L2"
shiny::isolate(eCerto::setValue(tmp, c("General", "apm"), x))
tmp$c_fltData()
tmp$c_fltData(recalc = TRUE)

# Only run examples in interactive R sessions
if (interactive()) {
  rv &lt;- eCerto$new(init_rv())
  setValue(rv, c("Certification", "data"), 5)
  getValue(rv, c("Certification", "data")) # is 5?
  setValue(rv, c("General", "user"), "Franz")
  getValue(rv, c("General", "user"))
}
</code></pre>


</div>