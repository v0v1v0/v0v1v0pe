<div class="container">

<table style="width: 100%;"><tr>
<td>coxre</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox Proportional Hazards Model with Random Effect</h2>

<h3>Description</h3>

<p><code>coxre</code> fits a Cox proportional hazards model to event history
data using a gamma distribution random effect. The parameter, gamma,
is the variance of this mixing distribution.
</p>
<p>If a matrix of response times is supplied, the model can be stratified
by columns, i.e. a different intensity function is fitted for each
column. To fit identical intensity functions to all response types,
give the times as a vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxre(response, censor, nest=NULL, cov=NULL, stratified=FALSE,
	cumul=FALSE,estimate=1, iter=10, print.level=0, ndigit=10,
	gradtol=0.00001, steptol=0.00001, iterlim=100, fscale=1,
	typsize=abs(estimate), stepmax=estimate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Vector or matrix of times to events, with one column
per type of response (or subunit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>Corresponding vector or matrix of censoring indicators.
If NULL all values are set to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nest</code></td>
<td>
<p>Vector indicating to which unit each observation belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>One covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratified</code></td>
<td>
<p>If TRUE, a model stratified on type of response
(the columns of response) is fitted instead of proportional intensities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumul</code></td>
<td>
<p>Set to TRUE if response times are from a common origin
instead of times to (or between) events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Initial estimate of the frailty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Maximum number of iterations allowed for the inner EM loop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>D.G. Clayton and J.K. Lindsey</p>


<h3>References</h3>

<p>Clayton, D. (1987) The analysis of event history data: a review of
progress and outstanding problems.  Statistics in Medicine 7: 819-841
</p>


<h3>See Also</h3>

<p><code>kalsurv</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 11 individuals, each with 5 responses
y &lt;- matrix(c(51,36,50,35,42,
	27,20,26,17,27,
	37,22,41,37,30,
	42,36,32,34,27,
	27,18,33,14,29,
	43,32,43,35,40,
	41,22,36,25,38,
	38,21,31,20,16,
	36,23,27,25,28,
	26,31,31,32,36,
	29,20,25,26,25),ncol=5,byrow=TRUE)
# Different intensity functions
coxre(response=y, censor=matrix(rep(1,55),ncol=5), nest=1:11,
	est=0.7, stratified=TRUE)
# Proportional intensity functions for the five responses
coxre(response=y, censor=matrix(rep(1,55),ncol=5), nest=1:11,
	est=0.7, stratified=FALSE)
# Identical intensity functions
coxre(response=as.vector(t(y)), censor=rep(1,55),
	nest=rep(1:11,rep(5,11)), est=0.7)
</code></pre>


</div>