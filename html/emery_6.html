<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_ML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate maximum likelihood accuracy statistics by expectation maximization</h2>

<h3>Description</h3>

<p><code>estimate_ML()</code> is a general function for estimating the maximum likelihood accuracy
statistics for a set of methods with no known reference value, i.e. "truth", or
"gold standard".
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_ML(
  type = c("binary", "ordinal", "continuous"),
  data,
  init = list(NULL),
  max_iter = 1000,
  tol = 1e-07,
  save_progress = TRUE,
  ...
)

estimate_ML_binary(
  data,
  init = list(prev_1 = NULL, se_1 = NULL, sp_1 = NULL),
  max_iter = 100,
  tol = 1e-07,
  save_progress = TRUE
)

estimate_ML_continuous(
  data,
  init = list(prev_1 = NULL, mu_i1_1 = NULL, sigma_i1_1 = NULL, mu_i0_1 = NULL,
    sigma_i0_1 = NULL),
  max_iter = 100,
  tol = 1e-07,
  save_progress = TRUE
)

estimate_ML_ordinal(
  data,
  init = list(pi_1_1 = NULL, phi_1ij_1 = NULL, phi_0ij_1 = NULL, n_level = NULL),
  level_names = NULL,
  max_iter = 1000,
  tol = 1e-07,
  save_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string specifying the data type of the methods under evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An <code>n_obs</code> by <code>n_method</code> <code>matrix</code> containing the
observed values for each method. If the dimensions are named, row names will
be used to name each observation (<code>obs_names</code>) and column names will be used
to name each measurement method (<code>method_names</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>An optional list of initial values used to seed the EM algorithm.
If initial values are not provided, the <code>pollinate_ML()</code> function will be
called on the data to estimate starting values. It is recommended to try several
sets of starting parameters to ensure that the algorithm converges to the same
results. This is to verify that the result does not represent a local extrema.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>The maximum number of EM algorithm iterations to compute before
reporting a result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The minimum change in statistic estimates needed to continue
iterating the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_progress</code></td>
<td>
<p>A logical indication of whether to save interim
calculations used in the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level_names</code></td>
<td>
<p>An optional, ordered, character vector of unique names corresponding to
the levels of the methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The lack of an infallible reference method is referred to
as an imperfect gold standard (GS). Accuracy statistics which rely on a GS
method, such as sensitivity, specificity, and AUC,
can be estimated using imperfect gold standards by iteratively estimating the
maximum likelihood values of these statistics while the conditional independence
assumption holds. <code>estimate_ML()</code> relies on a collection of expectation maximization (EM) algorithms
to achieve this. The EM algorithms used in this function are based on those presented in
<em>Statistical Methods in Diagnostic Medicine, Second Edition</em>
(Zhou et al. 2011) and have been validated on
several examples therein. Additional details about these algorithms can be found
for binary (Walter and Irwig 1988), ordinal (Zhou et al. 2005),
and continuous (Hsieh et al. 2009) methods.
Minor changes to the literal calculations have been
made for efficiency, code readability, and the like, but the underlying steps
remain functionally unchanged.
</p>


<h3>Value</h3>

<p><code>estimate_ML()</code> returns an S4 object of class "MultiMethodMLEstimate"
containing the maximum likelihood accuracy statistics calculated by EM.
</p>


<h3>References</h3>

<p>Zhou X, Obuchowski NA, McClish DK (2011).
<em>Statistical Methods in Diagnostic Medicine</em>.
Wiley.
<a href="https://doi.org/10.1002/9780470906514">doi:10.1002/9780470906514</a>.
</p>
<p>Walter SD, Irwig LM (1988).
“Estimation of test error rates, disease prevalence and relative risk from misclassified data: a review.”
<em>J. Clin. Epidemiol.</em>, <b>41</b>(9), 923–937.
<a href="https://doi.org/10.1016/0895-4356%2888%2990110-2">doi:10.1016/0895-4356(88)90110-2</a>.
</p>
<p>Zhou X, Castelluccio P, Zhou C (2005).
“Nonparametric estimation of ROC curves in the absence of a gold standard.”
<em>Biometrics</em>, <b>61</b>(2), 600–609.
<a href="https://doi.org/10.1111/j.1541-0420.2005.00324.x">doi:10.1111/j.1541-0420.2005.00324.x</a>.
</p>
<p>Hsieh H, Su H, Zhou X (2009).
“Interval Estimation for the Difference in Paired Areas under the ROC Curves in the Absense of a Gold Standard Test.”
<em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.3661">https://doi.org/10.1002/sim.3661</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Set seed for this example
set.seed(11001101)

# Generate data for 4 binary methods
my_sim &lt;- generate_multimethod_data(
  "binary",
  n_obs = 75,
  n_method = 4,
  se = c(0.87, 0.92, 0.79, 0.95),
  sp = c(0.85, 0.93, 0.94, 0.80),
  method_names = c("alpha", "beta", "gamma", "delta"))

# View the data
my_sim$generated_data

# View the parameters used to generate the data
my_sim$params

# Estimate ML accuracy values by EM algorithm
my_result &lt;- estimate_ML(
  "binary",
  data = my_sim$generated_data,
  save_progress = FALSE # this reduces the data stored in the resulting object
)

# View results of ML estimate
my_result@results

</code></pre>


</div>