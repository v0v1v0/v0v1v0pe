<div class="container">

<table style="width: 100%;"><tr>
<td>rankEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical Bayes parameter ranking for parallel estimation scenarios</h2>

<h3>Description</h3>

<p>Empirical Bayes ranking applicable to parallel-estimation settings where the estimated parameters are asymptotically unbiased and normal, with known standard errors.  A mixture normal prior for each parameter is estimated using Empirical Bayes methods, subsequentially ranks for each parameter are simulated from the resulting joint posterior over all parameters (The marginal posterior densities for each parameter are assumed independent). Finally, experiments are ordered by expected posterior  rank, although computations minimizing other plausible rank-loss functions are also given.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rankEM(betahat, sebeta, Jmin = 1, Jmax = 4, maxiter = 200, tol = 1e-05,
  nsim = 10000, cutoff = 0.5, maxpar = 40000, multiplestart = FALSE,
  sigmabig = 10, fixedcluster2 = TRUE, penfactor = 5000, fudge = 0.001,
  alpha = 0.05, FDR_BH = 0.05, topvec = c(10, 100, 1000, 10000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>betahat</code></td>
<td>
<p>estimated effect sizes for each experiment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sebeta</code></td>
<td>
<p>standard error of estimated effect sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jmin</code></td>
<td>
<p>minimum number of non-null clusters fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jmax</code></td>
<td>
<p>maximum number of non-null clusters fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations for EM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>EM algorithm is considered to have converged if the sum of the squared Euclidean distances between the parameter estimates on 2 iterations is less than tol</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations from posterior distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>controls which experiments are included for posterior rank simulation. If a numeric between 0 and 1, it specifies the minimum posterior probability for inclusion in posterior rank simulations. If equal to 'f' then experiements in posterior rank simulation had p-values that were significant according to a Benjamini Hochberg correction at BH_FDR, if equal to 'b' posterior simulations correspond to experiments with Bonferoni significant p-values at level alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpar</code></td>
<td>
<p>maximum number of experiments to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplestart</code></td>
<td>
<p>if TRUE, multiple start points are used for the EM-algorithm based fitting of the mixture normals (for a given number of clusters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmabig</code></td>
<td>
<p>the standard deviation for the 1st non-null cluster component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedcluster2</code></td>
<td>
<p>TRUE if the standard deviation for the 1st non-null cluster of the marginal distribution is fixed at sigmabig and its mean is fixed at 0.  If set to FALSE, the estimated mean and standard deviation of cluster 2 are free to vary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penfactor</code></td>
<td>
<p>factor for dirichlet penalization for cluster probabilities at each step of the EM algorithm. The larger this is, the smaller the Dirichlet penalization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fudge</code></td>
<td>
<p>small constant added to cluster probabilies at each EM step to ensure stability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>represents Bonferroni-corrected significance threshold when cutoff="b"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR_BH</code></td>
<td>
<p>represents FDR-corrected significance threshold when cutoff="f"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topvec</code></td>
<td>
<p>a vector representing values for K such that posterior probabilities that the parameter for each experiment is within the set of K parameters having the largest absolute values are given.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the top ranked experiments
</p>


<h3>Examples</h3>

<pre><code class="language-R">truetheta &lt;- c(rep(0,900),rnorm(100))
setheta &lt;- pmax(rexp(1000,1),.1)
esttheta &lt;- rnorm(length(truetheta),mean=truetheta,sd=setheta)
# just rank experiments that are significant at 5% FDR
stuff &lt;- rankEM(esttheta,setheta,cutoff='f',FDR_BH=.05)
# rank all experiments (slower)
# stuff &lt;- rankEM(esttheta,setheta,cutoff='f',FDR_BH=1)
</code></pre>


</div>