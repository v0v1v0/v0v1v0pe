<div class="container">

<table style="width: 100%;"><tr>
<td>chiplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dependence Measure Plots</h2>

<h3>Description</h3>

<p>Plots of estimates of the dependence measures chi and chi-bar
for bivariate data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">chiplot(data, nq = 100, qlim = NULL, which = 1:2, conf = 0.95, trunc =
    TRUE, spcases = FALSE, lty = 1, cilty = 2, col = 1, cicol = 1,
    xlim = c(0,1), ylim1 = c(-1,1), ylim2 = c(-1,1), main1 = "Chi Plot",
    main2 = "Chi Bar Plot", xlab = "Quantile", ylab1 = "Chi", ylab2 =
    "Chi Bar", ask = nb.fig &lt; length(which) &amp;&amp; dev.interactive(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data frame with two columns. Rows
(observations) with missing values are stripped from
the data before any computations are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>
<p>The number of quantiles at which the measures
are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qlim</code></td>
<td>
<p>The limits of the quantiles at which the measures
are evaluated (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If only one plot is required, specify <code>1</code>
for chi and <code>2</code> for chi-bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>The confidence coefficient of the plotted confidence
intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>Logical; truncate the estimates at their theoretical
upper and lower bounds?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spcases</code></td>
<td>
<p>If <code>TRUE</code>, plots greyed lines corresponding
to the special cases of perfect positive/negative dependence
and exact independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, cilty</code></td>
<td>
<p>Line types for the estimates of the measures and
for the confidence intervals respectively. Use zero to supress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, cicol</code></td>
<td>
<p>Colour types for the estimates of the measures
and for the confidence intervals respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, xlab</code></td>
<td>
<p>Limits and labels for the x-axis; they apply
to both plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim1</code></td>
<td>
<p>Limits for the y-axis of the chi plot. If this
is <code>NULL</code> (the default) the upper limit is one, and the
lower limit is the minimum of zero and the smallest plotted
value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim2</code></td>
<td>
<p>Limits for the y-axis of the chi-bar plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main1, main2</code></td>
<td>
<p>The plot titles for the chi and chi-bar plots
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab1, ylab2</code></td>
<td>
<p>The y-axis labels for the chi and chi-bar plots
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the user is asked before
each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to <code>matplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These measures are explained in full detail in Coles, Heffernan
and Tawn (1999). A brief treatment is also given in Section
8.4 of Coles(2001).
A short summary is given as follows.
We assume that the data are <em>iid</em> random vectors with common
bivariate distribution function <code class="reqn">G</code>, and we define the random
vector <code class="reqn">(X,Y)</code> to be distributed according to <code class="reqn">G</code>.
</p>
<p>The chi plot is a plot of <code class="reqn">q</code> against empirical estimates of
</p>
<p style="text-align: center;"><code class="reqn">\chi(q) = 2 - \log(\Pr(F_X(X) &lt; q, F_Y(Y) &lt; q)) / \log(q)</code>
</p>

<p>where <code class="reqn">F_X</code> and <code class="reqn">F_Y</code> are the marginal distribution
functions, and where <code class="reqn">q</code> is in the interval (0,1).
The quantity <code class="reqn">\chi(q)</code> is bounded by
</p>
<p style="text-align: center;"><code class="reqn">2 - \log(2u - 1)/\log(u) \leq \chi(q) \leq 1</code>
</p>

<p>where the lower bound is interpreted as <code>-Inf</code> for
<code class="reqn">q \leq 1/2</code> and zero for <code class="reqn">q = 1</code>.
These bounds are reflected in the corresponding estimates.
</p>
<p>The chi bar plot is a plot of <code class="reqn">q</code> against empirical estimates of
</p>
<p style="text-align: center;"><code class="reqn">\bar{\chi}(q) = 2\log(1-q)/\log(\Pr(F_X(X) &gt; q, F_Y(Y) &gt; q)) - 1</code>
</p>

<p>where <code class="reqn">F_X</code> and <code class="reqn">F_Y</code> are the marginal distribution
functions, and where <code class="reqn">q</code> is in the interval (0,1).
The quantity <code class="reqn">\bar{\chi}(q)</code> is bounded by
<code class="reqn">-1 \leq \bar{\chi}(q) \leq 1</code>
and these bounds are reflected in the corresponding estimates.
</p>
<p>Note that the empirical estimators for <code class="reqn">\chi(q)</code> and
<code class="reqn">\bar{\chi}(q)</code> are undefined near <code class="reqn">q=0</code> and <code class="reqn">q=1</code>. By
default the function takes the limits of <code class="reqn">q</code> so that the plots
depicts all values at which the estimators are defined. This can be
overridden by the argument <code>qlim</code>, which must represent a subset
of the default values (and these can be determined using the
component <code>quantile</code> of the invisibly returned list; see
<b>Value</b>).
</p>
<p>The confidence intervals within the plot assume that observations are
independent, and that the marginal distributions are estimated exactly.
The intervals are constructed using the delta method; this may
lead to poor interval estimates near <code class="reqn">q=0</code> and <code class="reqn">q=1</code>.
</p>
<p>The function <code class="reqn">\chi(q)</code> can be interpreted as a quantile
dependent measure of dependence. In particular, the sign of
<code class="reqn">\chi(q)</code> determines whether the variables are positively
or negatively associated at quantile level <code class="reqn">q</code>.
By definition, variables are said to be asymptotically independent
when <code class="reqn">\chi(1)</code> (defined in the limit) is zero.
For independent variables, <code class="reqn">\chi(q) = 0</code> for all
<code class="reqn">q</code> in (0,1).
For perfectly dependent variables, <code class="reqn">\chi(q) = 1</code>
for all <code class="reqn">q</code> in (0,1).
For bivariate extreme value distributions, <code class="reqn">\chi(q) =
    2(1-A(1/2))</code>
for all <code class="reqn">q</code> in (0,1), where <code class="reqn">A</code> is the dependence function,
as defined in <code>abvevd</code>. If a bivariate threshold model
is to be fitted (using <code>fbvpot</code>), this plot can therefore
act as a threshold identification plot, since e.g. the use of 95%
marginal quantiles as threshold values implies that <code class="reqn">\chi(q)</code>
should be approximately constant above <code class="reqn">q = 0.95</code>.
</p>
<p>The function <code class="reqn">\bar{\chi}(q)</code> can again be interpreted
as a quantile dependent measure of dependence; it is most useful
within the class of asymptotically independent variables.
For asymptotically dependent variables (i.e. those for which
<code class="reqn">\chi(1) &lt; 1</code>), we have <code class="reqn">\bar{\chi}(1) = 1</code>, where
<code class="reqn">\bar{\chi}(1)</code> is again defined in the limit.
For asymptotically independent variables, <code class="reqn">\bar{\chi}(1)</code> provides a measure that increases with dependence strength.
For independent variables <code class="reqn">\bar{\chi}(q) = 0</code> for
all <code class="reqn">q</code> in (0,1), and hence <code class="reqn">\bar{\chi}(1) = 0</code>.
</p>


<h3>Value</h3>

<p>A list with components <code>quantile</code>, <code>chi</code> (if <code>1</code> is in
<code>which</code>) and <code>chibar</code> (if <code>2</code> is in <code>which</code>)
is invisibly returned.
The components <code>quantile</code> and <code>chi</code> contain those objects
that were passed to the formal arguments <code>x</code> and <code>y</code> of
<code>matplot</code> in order to create the chi plot.
The components <code>quantile</code> and <code>chibar</code> contain those objects
that were passed to the formal arguments <code>x</code> and <code>y</code> of
<code>matplot</code> in order to create the chi-bar plot.
</p>


<h3>Author(s)</h3>

<p>Jan Heffernan and Alec Stephenson</p>


<h3>References</h3>

<p>Coles, S. G., Heffernan, J. and Tawn, J. A. (1999)
Dependence measures for extreme value analyses.
<em>Extremes</em>, <b>2</b>, 339–365.
</p>
<p>Coles, S. G. (2001)
<em>An Introduction to Statistical Modelling of Extreme Values</em>,
London: Springer–Verlag.  
</p>


<h3>See Also</h3>

<p><code>fbvevd</code>, <code>fbvpot</code>,
<code>matplot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">par(mfrow = c(1,2))
smdat1 &lt;- rbvevd(1000, dep = 0.6, model = "log")
smdat2 &lt;- rbvevd(1000, dep = 1, model = "log")
chiplot(smdat1)
chiplot(smdat2)
</code></pre>


</div>