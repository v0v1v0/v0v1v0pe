<div class="container">

<table style="width: 100%;"><tr>
<td>GenSimpson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generalized Simpson's Entropy and Diversity
</h2>

<h3>Description</h3>

<p>Calculates the Generalized Simpson's entropy of order <code class="reqn">r</code> of a probability or abundance vector, and its effective number of species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GenSimpson(NorP, r = 1, ...)
bcGenSimpson(Ns, r = 1, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
GenSimpson(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
GenSimpsonD(NorP, r = 1, ...)
bcGenSimpsonD(Ns, r = 1, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
GenSimpsonD(NorP, r = 1, ...,
  CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
GenSimpsonD(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
GenSimpsonD(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
GenSimpsonD(NorP, r = 1, ..., 
  CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code>AbdVector</code>) or a probability vector (<code>ProbaVector</code>). Contains either abundances or probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>A number: the order of diversity. Default is 1 for Simpson's diversity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments. Unused.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Generalized Simpson's Entropy (Zhang and Zhou, 2010) of order <code class="reqn">r</code> is, in the species accumulation curve, the probability for the individual sampled in rank <code class="reqn">r+1</code> to belong to a new species. It is a measure of diversity so long as <code class="reqn">r</code> is lower than the number of species (Grabchak <em>et al.</em>, 2016). 
</p>
<p>Bias correction requires the number of individuals. Use <code>bcGenSimpson</code>. It is limited to orders <code class="reqn">r</code> less than or equal to the number of individuals in the community.
</p>
<p>The effective number of species <code>GenSimpsonD</code> (explicit diversity) has been derived by Grabchak <em>et al.</em> (2016).
</p>
<p>The functions are designed to be used as simply as possible. <code>GenSimpson</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcGenSimpson</code> is called. Explicit calls to <code>bcGenSimpson</code> (with bias correction) or to <code>GenSimpson.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>


<h3>Value</h3>

<p>A named number equal to the calculated index or diversity. The name is either "Biased" or "Unbiased", depending on the estimator used.
</p>


<h3>Note</h3>

<p>The unbiased estimator is calculated by the <code>GenSimp.z</code> function of the <code>EntropyEstimation</code> package. 
</p>


<h3>References</h3>

<p>Grabchak, M., Marcon, E., Lang, G., and Zhang, Z. (2017). The Generalized Simpson's Entropy is a Measure of Biodiversity. <em>Plos One</em>, 12(3): e0173305.
</p>
<p>Zhang Z. and Zhou J. (2010). Re-parameterization of multinomial distributions and diversity indices. <em>Journal of Statistical Planning and Inference</em> 140(7): 1731-1738.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)

# Calculate GenSimpson entropy of order 1, equal to Simpson's index of diversity
GenSimpson(Ps, 1) 
# Calculate an unbiased estimator of GenSimpson diversity of order 100
GenSimpsonD(Ns, 100)
</code></pre>


</div>