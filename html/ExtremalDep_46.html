<div class="container">

<table style="width: 100%;"><tr>
<td>plot_ExtDep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical summaries of parametric representations of extremal dependence.</h2>

<h3>Description</h3>

<p>This function displays the angular density, Pickands dependence function and return levels for bivariate and trivariate extreme values models.</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_ExtDep(object="angular", model, par, log=TRUE, data=NULL, contour=TRUE, 
            style, labels, cex.dat=1, cex.lab=1, cex.cont=1, 
            Q.fix, Q.range, Q.range0, cond=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A character string indicating which graphical summary to plot. Takes value <code>"angular"</code> (default) <code>"pickands"</code> or<code>"returns"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string with the name of the model considered. Takes value <code>"PB"</code> (Pairwise Beta), <code>"HR"</code> (Husler-Reiss), <code>"ET"</code> (Extremal-t), <code>"EST"</code> (Extremal Skew-t), <code>TD</code> (Tilted Dirichlet) or <code>AL</code> (Asymmetric Logistic) when evaluating the angular density. Restricted to <code>"HR"</code>, <code>"ET"</code> and <code>"EST"</code> for the Pickands dependence function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>A vector representing the parameters of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>A logical value specifying if the log density is computed. Required when <code>object="angular"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix representing angular data to be added to the density plot. Required when <code>object="angular"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>A logical value; if <code>TRUE</code> the contour levels are displayed. Required for trivariate models only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>A character string indicating the plotting style of the data. Takes value <code>"hist"</code> or <code>"ticks"</code>. See <b>details</b>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>A vector of character strings indicating the labels. Must be of length <code class="reqn">1</code> for bivariate models and <code class="reqn">3</code> for trivariate models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.dat</code></td>
<td>
<p>A positive real indicating the size of the data points. Required for the trivariate angular density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>A positive real indicating the size of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.cont</code></td>
<td>
<p>A positive real indicating the size of the contour labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.fix</code></td>
<td>
<p>A vector of length the dimension of the model, indicating some fixed quantiles to compute joint return levels. Must contain <code>NA</code> (maximum 2) for components whose quantiles are allowed to vary. Required when <code>object="returns"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.range</code></td>
<td>
<p>A vector or matrix indicating quantile values on the unit Frechet scale, for the components that are allowed to vary. Must be a vector or a one-column matrix if there is one <code>NA</code> in <code>Q.fix</code>. Must be a two-column matrix if there are two <code>NA</code>s in <code>Q.fix</code>. Required when <code>object="returns"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.range0</code></td>
<td>
<p>A object of the same format as <code>Q.range</code>, corresponding to the quantiles on the original scale. Required when <code>object="returns"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p>A logical value; if <code>TRUE</code> then conditional return levels are computed where the conditional event is the fixed event. Default if <code>FALSE</code>. Required when <code>object="returns"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional graphical arguments for the <code>hist()</code> and <code>plot()</code> functions respectively used to compute the bivariate angular density and Pickands dependence function as well as for the <code>plot()</code> and <code>contour()</code> functionswhen <code>object="returns"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The angular density is computed using the function <code>dExtDep</code> with arguments <code>method="Parametric"</code> and <code>angular=TRUE</code>. The Pickands dependence function is computed using the function <code>index.ExtDep</code> with argument <code>object="pickands"</code>.
</p>
<p>When displaying the bivariate angular density and some data are provided (a 2-column matrix is specified for <code>data</code>), there is the choice to summarise the data using a histogram (<code>style="hist"</code>) or to display the observations using tick marks (<code>style="ticks"</code>). 
</p>
<p>When displaying return levels, there are two possibilities: univariate and bivariate return levels. Since the model dimensions are restricted to a maximum of three, in that case, aunivariate return level corresponds to fixing two components while a bivariate return level fixes only one component. The choice of the fixed component is decided by the position of the <code>NA</code> value(s) in the <code>Q.fix</code> argument. If <code>par</code> is a vector then the corresponding return level(s) are printed. However if <code>par</code> is a matrix then the return level(s) are evaluated for each value of the parameter vector and the mean, and empirical <code class="reqn">95\%</code> empirical interval are displayed. Typically this is used when posterior samples are available. When <code>par</code> is a matrix with only two rows, resulting plots may not provide much information.  
</p>
<p>When contours are displayed, levels are chosen to be the deciles. 
</p>


<h3>Value</h3>

<p>A graph depending on argument <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>See Also</h3>

<p><code>dExtDep</code>, <code>index.ExtDep</code>. </p>


<h3>Examples</h3>

<pre><code class="language-R">
data(pollution)

###############################
### Trivariate Husler-Reiss ###
###############################


  f.hr &lt;- fExtDep(method="PPP", data=PNS, model="HR", par.start=rep(1,3))

  plot_ExtDep(object="angular", model="HR", par=f.hr$par, data=PNS, 
              labels=c(expression(PM[10]), expression(NO), expression(SO[2])), 
              cex.lab=2)
      
  plot_ExtDep(object="pickands", model="HR", par=f.hr$par, data=PNS, 
              labels=c(expression(PM[10]), expression(NO), expression(SO[2])), 
              cex.lab=2) # Takes time!      


###############################
### Bivariate Husler-Reiss ###
###############################            


  PN &lt;- na.omit(Leeds.frechet[,1:2])
  PN &lt;- cbind(PN, rowSums(PN))
  PN &lt;- PN[order(PN[,3], decreasing = TRUE)[1:100],]
  PN &lt;- PN[,1:2]/PN[,3]

  f.hr2 &lt;- fExtDep(method="PPP", data=PN, model = "HR", par.start = 1)
  plot_ExtDep(model="HR", par=f.hr2$par, log=FALSE, data=PN, style="hist")
  plot_ExtDep(model="HR", par=f.hr2$par, log=FALSE, data=PN, style="ticks") 
  plot_ExtDep(object="pickands", model="HR", par=f.hr2$par) 


            
</code></pre>


</div>