<div class="container">

<table style="width: 100%;"><tr>
<td>KRDetect.outliers.controlchart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identification of outliers using control charts</h2>

<h3>Description</h3>

<p>Identification of outliers in environmental data using two-step method based on kernel smoothing and control charts (Campulova et al., 2017).
The outliers are identified as observations corresponding to segments of smoothing residuals exceeding control charts limits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KRDetect.outliers.controlchart(x, perform.smoothing = TRUE,
  bandwidth.type = "local", bandwidth.value = NULL, kernel.order = 2,
  method = "range", group.size.x = 3, group.size.R = 3,
  group.size.s = 3, L.x = 3, L.R = 3, L.s = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li>
<p>a numeric vector
</p>
</li>
<li>
<p>a time series object <code>ts</code>
</p>
</li>
<li>
<p>a time series object <code>xts</code>
</p>
</li>
<li>
<p>a time series object <code>zoo</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perform.smoothing</code></td>
<td>
<p>a logical value specifying if data smoothing is performed. If <code>TRUE</code> (default), data are smoothed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth.type</code></td>
<td>
<p>a character string specifying the type of bandwidth.
</p>
<p>Possible options are
</p>

<ul>
<li>
<p><code>"local"</code> (default) to use local bandwidth
</p>
</li>
<li>
<p><code>"global"</code> to use global bandwidth
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth.value</code></td>
<td>
<p>a local bandwidth array (for <code>bandwidth.type = "local"</code>) or global bandwidth value (for <code>bandwidth.type = "global"</code>) for kernel regression estimation. If <code>bandwidth.type = "NULL"</code> (default) a data-adaptive local plug-in (Herrmann, 1997) (for <code>bandwidth.type = "local"</code>) or data-adaptive global plug-in (Gasser et al., 1991) (for <code>bandwidth.type = "global"</code>) bandwidth is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.order</code></td>
<td>
<p>a nonnegative integer giving the order of the optimal kernel (Gasser et al., 1985) used for smoothing.
</p>
<p>Possible options are
</p>

<ul>
<li>
<p><code>kernel.order = 2</code> (default)
</p>
</li>
<li>
<p><code>kernel.order = 4</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the preferred estimate of standard deviation parameter.
</p>
<p>Possible options are
</p>

<ul>
<li>
<p><code>"range"</code> (default) for estimation based on sample ranges
</p>
</li>
<li>
<p><code>"sd"</code> for estimation based on sample standard deviations
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.size.x</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of <em>x</em> chart control limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis. Default is <code>group.size.x = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.size.R</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of <em>R</em> chart control limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis. Default is <code>group.size.R = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.size.s</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of <em>s</em> chart control limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis. Default is <code>group.size.s = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L.x</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of <em>x</em> chart control limits. Default is <code>L.x = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L.R</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of <em>R</em> chart control limits. Default is <code>L.R = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L.s</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of <em>s</em> chart control limits. Default is <code>L.s = 3</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function identifies outliers in environmental data using two-step procedure (Campulova et al., 2017).
The procedure consists of kernel smoothing and subsequent identification of observations corresponding to segments of smoothing residuals exceeding control charts limits.
This way the method does not identify individual outliers but segments of observations, where the outliers occur.
The output of the method are three logical vectors specyfing the outliers identified based on each of the three control charts.
Beside that logical vector specyfing the outliers identified based on at least one type of control limits is returned.
Crucial for the method is the choice of paramaters <code>L.x</code>, <code>L.R</code> and <code>L.s</code> specifying the width of control limits.
Different values of the parameters determine different criteria for outlier detection. For more information see (Campulova et al., 2017).
</p>


<h3>Value</h3>

<p>A <code>"KRDetect"</code> object which contains a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method.type</code></td>
<td>
<p>a character string giving the type of method used for outlier idetification</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a numeric vector of index design points assigned to individual observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothed</code></td>
<td>
<p>a numeric vector of estimates of the kernel regression function (smoothed data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.x</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on limits of control chart <em>x</em>, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.R</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on limits of control chart <em>R</em>, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.s</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on limits of control chart <em>s</em>, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on at least one type of control limits. <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LCL.x</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>x</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UCL.x</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>x</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LCL.s</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>s</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UCL.s</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>s</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LCL.R</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>R</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UCL.R</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>R</em></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Campulova M, Veselik P, Michalek J (2017). Control chart and Six sigma based algorithms for identification of outliers in experimental data, with an application to particulate matter PM10. Atmospheric Pollution Research. Doi=10.1016/j.apr.2017.01.004.
</p>
<p>Shewhart W (1931). Quality control chart. Bell System Technical Journal, 5, 593–603.
</p>
<p>SAS/QC User's Guide, Version 8, 1999. SAS Institute, Cary, N.C.
</p>
<p>Wild C, Seber G (2000). Chance encounters: A first course in data analysis and inference. New York: John Wiley.
</p>
<p>Joglekar, Anand M. Statistical methods for six sigma: in R&amp;D and manufacturing. Hoboken, NJ: Wiley-Interscience. ISBN sbn0-471-20342-4.
</p>
<p>Gasser T, Kneip A, Kohler W (1991). A flexible and fast method for automatic smoothing. Journal of the American Statistical Association, 86, 643–652.
</p>
<p>Herrmann E (1997). Local bandwidth choice in kernel regression estimation. Journal of Computational and Graphical Statistics, 6(1), 35–54.
</p>
<p>Eva Herrmann; Packaged for R and enhanced by Martin Maechler (2016). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-8. https://CRAN.R-project.org/package=lokern
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
result = KRDetect.outliers.controlchart(x)
summary(result)
plot(result)
plot(result, plot.type = "x")
plot(result, plot.type = "R")
plot(result, plot.type = "s")
</code></pre>


</div>