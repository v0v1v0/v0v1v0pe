<div class="container">

<table style="width: 100%;"><tr>
<td>kgaps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood estimation for the <code class="reqn">K</code>-gaps model</h2>

<h3>Description</h3>

<p>Calculates maximum likelihood estimates of the extremal index <code class="reqn">\theta</code>
based on the <code class="reqn">K</code>-gaps model for threshold inter-exceedances times of
Suveges and Davison (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">kgaps(data, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code>split_by_NAs</code> is
used to divide the data further into sequences of non-missing values,
stored in different columns in a matrix.  Again, the log-likelihood
is constructed as a sum of contributions from different columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A numeric scalar.  Extreme value threshold applied to data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A non-negative numeric scalar. Run parameter <code class="reqn">K</code>, as defined in
Suveges and Davison (2010).  Threshold inter-exceedances times that are
not larger than <code>k</code> units are assigned to the same cluster, resulting
in a <code class="reqn">K</code>-gap equal to zero. Specifically, the <code class="reqn">K</code>-gap <code class="reqn">S</code>
corresponding to an inter-exceedance time of <code class="reqn">T</code> is given by
<code class="reqn">S = \max(T - K, 0)</code>.  In practice, <code class="reqn">k</code> should
be no smaller than 1, because when <code class="reqn">k</code> is less than 1 the estimate
of <code class="reqn">\theta</code> is always equal to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times, relating to the
first and last observations.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.
If <code>data</code> has multiple columns then there will be right-censored
first and last inter-exceedance times for each column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>inc_cens = FALSE</code> then the maximum likelihood estimate of
the extremal index <code class="reqn">\theta</code> under the <code class="reqn">K</code>-gaps model of
Suveges and Davison (2010) is calculated.
</p>
<p>If <code>inc_cens = TRUE</code> then information from right-censored
first and last inter-exceedance times is also included in the likelihood
to be maximized, following Attalides (2015).  The form of the
log-likelihood is given in the <strong>Details</strong> section of
<code>kgaps_stat</code>.
</p>
<p>It is possible that the estimate of <code class="reqn">\theta</code> is equal to 1, and also
possible that it is equal to 0. <code>kgaps_stat</code> explains the
respective properties of the data that cause these events to occur.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("kgaps", "exdex")</code> containing
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>theta</code> </td>
<td>
<p>The maximum likelihood estimate (MLE) of
<code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>se</code> </td>
<td>
<p>The estimated standard error of the MLE, calculated
using an algebraic expression for the observed information.
If <code>k = 0</code> then <code>se</code> is returned as <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>se_exp</code> </td>
<td>
<p>The estimated standard error of the MLE,
calculated using an algebraic expression for the expected information.
If the estimate of <code class="reqn">\theta</code> is 0 or 1 then <code>se_exp</code> is
<code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>ss</code> </td>
<td>
<p>The list of summary statistics returned from
<code>kgaps_stat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>k, u, inc_cens</code> </td>
<td>
<p>The input values of <code>k</code>,
<code>u</code> and <code>inc_cens</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_loglik </code></td>
<td>
<p>The value of the log-likelihood at the MLE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The call to <code>kgaps</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code>kgaps_confint</code> to estimate confidence intervals
for <code class="reqn">\theta</code>.
</p>
<p><code>kgaps_methods</code> for S3 methods for <code>"kgaps"</code>
objects.
</p>
<p><code>kgaps_imt</code> for the information matrix test, which
may be used to inform the choice of the pair (<code>u, k</code>).
</p>
<p><code>choose_uk</code> for a diagnostic plot based on
<code>kgaps_imt</code>.
</p>
<p><code>kgaps_stat</code> for the calculation of sufficient
statistics for the <code class="reqn">K</code>-gaps model.
</p>
<p><code>kgaps_post</code> in the
<code>revdbayes</code> package for Bayesian inference
about <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### S&amp;P 500 index

u &lt;- quantile(sp500, probs = 0.60)
theta &lt;- kgaps(sp500, u)
theta
summary(theta)
coef(theta)
nobs(theta)
vcov(theta)
logLik(theta)

### Newlyn sea surges

u &lt;- quantile(newlyn, probs = 0.60)
theta &lt;- kgaps(newlyn, u, k = 2)
theta
summary(theta)

### Cheeseboro wind gusts

theta &lt;- kgaps(cheeseboro, 45, k = 3)
theta
summary(theta)
</code></pre>


</div>