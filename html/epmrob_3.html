<div class="container">

<table style="width: 100%;"><tr>
<td>epmrob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Fit of Probit Model with Endogeneity
</h2>

<h3>Description</h3>

<p>Fits the endogenous probit model using a robust two-stage estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">epmrob(reduced, outcome, data, control = rob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reduced</code></td>
<td>

<p>formula, the reduced equation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>

<p>formula, the outcome equation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>epmrob</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameterse for controlling the fitting process.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute robust two-step estimates of the endogenous probit model. The robust linear regression is fitted in the first stage. In the second stage a Mallows-type M-estimator is used instead of the probit MLE. 
The values of the tuning constants and the robustness weights can be modified in <code>rob.control</code>.
</p>


<h3>Value</h3>

<p>Object of class "epmrob".
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage1</code></td>
<td>
<p>object of class <code>rlm</code> that contains first stage robust fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage2</code></td>
<td>
<p>object of class <code>glmrob</code> that contains second stage robust probit fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov</code> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>variance matrix of the second stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Andre Bik, Andrea Naghi
</p>


<h3>References</h3>

<p>Naghi, A. A., Varadi, M., and Zhelonkin, M. (2022). Robust Estimation of Probit Models with Endogeneity. <em>Econometrics and Statistics</em>. <a href="https://doi.org/10.1016/j.ecosta.2022.05.001">doi:10.1016/j.ecosta.2022.05.001</a>
</p>


<h3>See Also</h3>

<p><code>rlm</code>, <code>rob.control</code>
</p>


</div>