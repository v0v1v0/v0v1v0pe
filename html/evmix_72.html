<div class="container">

<table style="width: 100%;"><tr>
<td>evmix.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic Plots for Extreme Value Mixture Models</h2>

<h3>Description</h3>

<p>The classic four diagnostic plots for evaluating extreme value mixture models: 
1) return level plot, 2) Q-Q plot, 3) P-P plot and 4) density plot. Each plot is available
individually or as the usual 2x2 collection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evmix.diag(modelfit, upperfocus = TRUE, alpha = 0.05, N = 1000,
  legend = FALSE, ...)

rlplot(modelfit, upperfocus = TRUE, alpha = 0.05, N = 1000,
  legend = TRUE, rplim = NULL, rllim = NULL, ...)

qplot(modelfit, upperfocus = TRUE, alpha = 0.05, N = 1000,
  legend = TRUE, ...)

pplot(modelfit, upperfocus = TRUE, alpha = 0.05, N = 1000,
  legend = TRUE, ...)

densplot(modelfit, upperfocus = TRUE, legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modelfit</code></td>
<td>
<p>fitted extreme value mixture model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperfocus</code></td>
<td>
<p>logical, should plot focus on upper tail?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level over range (0, 1), or <code>NULL</code> for no CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of Monte Carlo simulation for CI (N&gt;=10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>logical, should legend be included</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the plotting functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rplim</code></td>
<td>
<p>return period range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rllim</code></td>
<td>
<p>return level range</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model diagnostics are available for all the fitted extreme mixture models in the 
<code>evmix</code> package. These <code>modelfit</code> is output by all the fitting 
functions, e.g. <code>fgpd</code> and <code>fnormgpd</code>.
</p>
<p>Consistent with <code>plot</code> function in the 
<code>evd</code> library the <code>ppoints</code> to 
estimate the empirical cumulative probabilities. The default behaviour of this
function is to use </p>
<p style="text-align: center;"><code class="reqn">(i-0.5)/n</code>
</p>
<p> as the estimate for the <code class="reqn">i</code>th order statistic of
the given sample of size <code class="reqn">n</code>.
</p>
<p>The return level plot has the quantile (<code class="reqn">q</code> where <code class="reqn">P(X \ge q)=p</code> on
the <code class="reqn">y</code>-axis, for a particular survival probability <code class="reqn">p</code>. The return period
<code class="reqn">t=1/p</code> is shown on the <code class="reqn">x</code>-axis. The return level is given by:
</p>
<p style="text-align: center;"><code class="reqn">q = u + \sigma_u [(\phi_u t)^\xi - 1]/\xi</code>
</p>

<p>for <code class="reqn">\xi\ne 0</code>. But in the case of <code class="reqn">\xi = 0</code> this simplifies to 
</p>
<p style="text-align: center;"><code class="reqn">q = u + \sigma_u log(\phi_u t)</code>
</p>

<p>which is linear when plotted against the return period on a logarithmic scale. The special
case of exponential/Type I (<code class="reqn">\xi=0</code>) upper tail behaviour will be linear on
this scale. This is the same tranformation as in the GPD/POT diagnostic plot function
<code>plot.uvevd</code> in the <code>evd</code> package,
from which these functions were derived.
</p>
<p>The crosses are the empirical quantiles/return levels (i.e. the ordered sample data)
against their corresponding transformed empirical return period (from 
<code>ppoints</code>). The solid line is the theoretical return level
(quantile) function using the estimated parameters. The estimated threshold 
<code>u</code> and tail fraction <code>phiu</code> are shown. For the two tailed models both
thresholds <code>ul</code> and <code>ur</code> and corresponding tail fractions 
<code>phiul</code> and <code>phiur</code> are shown. The approximate pointwise confidence intervals
for the quantiles are obtained by Monte Carlo simulation using the estimated parameters.
Notice that these intervals ignore the parameter estimation uncertainty.
</p>
<p>The Q-Q and P-P plots have the empirical values on the <code class="reqn">y</code>-axis and theoretical values
from the fitted model on the <code class="reqn">x</code>-axis.
</p>
<p>The density plot provides a histogram of the sample data overlaid with the fitted density
and a standard kernel density estimate using the <code>density</code>
function. The default settings for the <code>density</code> function are used.
Note that for distributions with bounded support (e.g. GPD) with high density near the
boundary standard kernel density estimators exhibit a negative bias due to leakage past
the boundary. So in this case they should not be taken too seriously.
</p>
<p>For the kernel density estimates (i.e. <code>kden</code> and <code>bckden</code>) there is no threshold, 
so no upper tail focus is carried out.
</p>
<p>See <code>plot.uvevd</code> for more detailed explanations of these
types of plots.
</p>


<h3>Value</h3>

<p><code>rlplot</code> gives the return level plot, 
<code>qplot</code> gives the Q-Q plot,
<code>pplot</code> gives the P-P plot,
<code>densplot</code> gives density plot and
<code>evmix.diag</code> gives the collection of all 4.
</p>


<h3>Acknowledgments</h3>

<p>Based on the GPD/POT diagnostic function <code>plot.uvevd</code> in the <code>evd</code> package for which Stuart Coles' and Alec Stephenson's 
contributions are gratefully acknowledged.
They are designed to have similar syntax and functionality to simplify the transition for users of these packages.
</p>


<h3>Note</h3>

<p>For all mixture models the missing values are removed by the fitting functions 
(e.g. <code>fnormgpd</code> and <code>fgng</code>).
However, these are retained in the GPD fitting <code>fgpd</code>, as they 
are interpreted as values below the threshold.
</p>
<p>By default all the plots focus in on the upper tail, but they can be used to display 
the fit over the entire range of support.
</p>
<p>You cannot pass <code>xlim</code> or <code>ylim</code> to the plotting functions via <code>...</code>
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Yang Hu and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://en.wikipedia.org/wiki/Q-Q_plot">http://en.wikipedia.org/wiki/Q-Q_plot</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/P-P_plot">http://en.wikipedia.org/wiki/P-P_plot</a>
</p>
<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>Coles S.G. (2004). An Introduction to the Statistical Modelling of Extreme Values.
Springer-Verlag: London.
</p>


<h3>See Also</h3>

<p><code>ppoints</code>, <code>plot.uvevd</code> and
<code>gpd.diag</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)

x = sort(rnorm(1000))
fit = fnormgpd(x)
evmix.diag(fit)

# repeat without focussing on upper tail
par(mfrow=c(2,2))
rlplot(fit, upperfocus = FALSE)
qplot(fit, upperfocus = FALSE)
pplot(fit, upperfocus = FALSE)
densplot(fit, upperfocus = FALSE)

## End(Not run)

</code></pre>


</div>