<div class="container">

<table style="width: 100%;"><tr>
<td>sim.multi.OU</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate multivariate Ornstein-Uhlenbeck evolutionary sequence data sets</h2>

<h3>Description</h3>

<p>Function to simulate a multivariate Ornstein-Uhlenbeck evolutionary sequence data set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.multi.OU(
  ns = 30,
  anc = c(0, 0),
  optima = c(3, 2),
  A = matrix(c(7, 0, 0, 6), nrow = 2, byrow = TRUE),
  R = matrix(c(0.05, 0, 0, 0.05), nrow = 2, byrow = TRUE),
  vp = 0.1,
  nn = rep(30, ns),
  tt = 0:(ns - 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>number of samples in time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anc</code></td>
<td>
<p>the ancestral trait values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optima</code></td>
<td>
<p>the optimal trait values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>the pull matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the drift matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vp</code></td>
<td>
<p>within-population trait variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>vector of the number of individuals in each sample (identical sample sizes for all time-series is assumed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>vector of sample ages, increases from oldest to youngest</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A multivariate evolutionary sequence (time-series) data set.
</p>


<h3>Note</h3>

<p>The Ornstein Uhlenbeck model is reduced to an Unbiased Random Walk when the alpha parameter is zero. It is therefore possible to let a trait evolve as an Unbiased Random Walk by setting the diagonal element for that trait to a value close to zero (e.g. 1e-07). Elements in the diagonal of A cannot be exactly zero as this will result in a singular variance-covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Kjetil Lysne Voje
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Define the A and R matrices

A_matrix&lt;-matrix(c(4,-2,0,3), nrow=2, byrow = TRUE)
R_matrix&lt;-matrix(c(4,0.2,0.2,4), nrow=2, byrow = TRUE)

## Generate an evoTS object by simulating a multivariate dataset
data_set&lt;-sim.multi.OU(40, optima = c(1.5,2),A=A_matrix , R = R_matrix)

## plot the data
plotevoTS.multivariate(data_set)

</code></pre>


</div>