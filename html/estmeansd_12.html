<div class="container">

<table style="width: 100%;"><tr>
<td>qe.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile estimation fitting</h2>

<h3>Description</h3>

<p>This function fits several parametric families of distributions from summary data in the following forms: </p>

<ul>
<li>
<p> S1: median, minimum and maximum values, and sample size
</p>
</li>
<li>
<p> S2: median, first and third quartiles, and sample size
</p>
</li>
<li>
<p> S3: median, minimum and maximum values, first and third quartiles, and sample size
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">qe.fit(
  min.val,
  q1.val,
  med.val,
  q3.val,
  max.val,
  n,
  two.sample.default = FALSE,
  qe.fit.control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>min.val</code></td>
<td>
<p>numeric value giving the sample minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1.val</code></td>
<td>
<p>numeric value giving the sample first quartile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med.val</code></td>
<td>
<p>numeric value giving the sample median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q3.val</code></td>
<td>
<p>numeric value giving the sample third quartile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.val</code></td>
<td>
<p>numeric value giving the sample maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric value giving the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sample.default</code></td>
<td>
<p>logical scalar. If set to <code>TRUE</code>, the candidate distributions, initial values, and box constraints are set to that of McGrath et al. (2020a). If set to <code>FALSE</code>, the candidate distributions, initial values, and box constraints are set to that of McGrath et al. (2020b). The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qe.fit.control</code></td>
<td>
<p>optional list of control parameters for the minimization algorithm. </p>

<table>
<tr>
<td style="text-align: left;">
<code>norm.mu.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the <code class="reqn">\mu</code> parameter of the normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>norm.sigma.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the <code class="reqn">\sigma</code> parameter of the normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>lnorm.mu.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the <code class="reqn">\mu</code> parameter of the log-normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>lnorm.sigma.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the <code class="reqn">\sigma</code> parameter of the log-normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>gamma.shape.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the shape parameter of the gamma distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>gamma.rate.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the rate parameter of the gamma distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>weibull.shape.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the shape parameter of the Weibull distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>weibull.scale.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the scale parameter of the Weibull distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.shape1.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the shape1 (i.e., <code class="reqn">\alpha</code>) parameter of the beta distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.shape2.start</code> </td>
<td style="text-align: left;"> numeric value giving the starting value for the shape2 (i.e., <code class="reqn">\beta</code>) parameter of the beta distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>norm.mu.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the <code class="reqn">\mu</code> parameter of the normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>norm.sigma.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the <code class="reqn">\sigma</code> parameter of the normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>lnorm.mu.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the <code class="reqn">\mu</code> parameter of the the log-normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>lnorm.sigma.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the <code class="reqn">\sigma</code> parameter of the log-normal distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>gamma.shape.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the shape parameter of the gamma distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>gamma.rate.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the rate parameter of the gamma distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>weibull.shape.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the shape parameter of the Weibull distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>weibull.scale.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the scale parameter of the Weibull distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.shape1.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the shape1 (i.e., <code class="reqn">\alpha</code>) parameter of the beta distribution. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.shape2.bounds</code> </td>
<td style="text-align: left;"> vector giving the bounds on the shape2 (i.e., <code class="reqn">\beta</code>) parameter of the beta distribution. </td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Distributions are fit by minimizing the distance between observed and distribution quantiles in the L2-norm. The limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS-M) algorithm implemented in the <code>optim</code> function is used for minimization.
</p>
<p>Two different conventions may be used for setting the candidate distributions, parameter starting values, and parameter constraints, which is controlled by the <code>two.sample.default</code> argument. If the convention of McGrath et al. (2020a) is used, the candidate distributions are the normal, log-normal, gamma, and Weibull distributions. If the convention of McGrath et al. (2020b) is used, the beta distribution is also included. In either case, if a negative value is provided (e.g., for the minimum value or the first quartile value), only the normal distribution is fit.
</p>


<h3>Value</h3>

<p>A object of class <code>qe.fit</code>. The object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>norm.par</code></td>
<td>
<p>Estimated parameters of the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnorm.par</code></td>
<td>
<p>Estimated parameters of the log-normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.par</code></td>
<td>
<p>Estimated parameters of the gamma distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weibull.par</code></td>
<td>
<p>Estimated parameters of the Weibull distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.par</code></td>
<td>
<p>Estimated parameters of the beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Values of the objective functions evaluated at the estimated paramters of each candidate distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other elements.</p>
</td>
</tr>
</table>
<p>The results are printed with the <code>print.qe.fit</code> function. The results can be visualized by using the <code>plot.qe.fit</code> function.
</p>


<h3>References</h3>

<p>McGrath S., Sohn H., Steele R., and Benedetti A. (2020a). Meta-analysis of the difference of medians. <em>Biometrical Journal</em>, <strong>62</strong>, 69-98.
</p>
<p>McGrath S., Zhao X., Steele R., Thombs B.D., Benedetti A., and the DEPRESsion Screening Data (DEPRESSD) Collaboration. (2020b). Estimating the sample mean and standard deviation from commonly reported quantiles in meta-analysis. <em>Statistical Methods in Medical Research</em>. <strong>29</strong>(9):2520-2537.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate S2 summary data
set.seed(1)
n &lt;- 100
x &lt;- stats::rlnorm(n, 2.5, 1)
quants &lt;- stats::quantile(x, probs = c(0.25, 0.5, 0.75))

## Fit distributions
qe.fit(q1.val = quants[1], med.val = quants[2], q3.val = quants[3], n = n)

</code></pre>


</div>