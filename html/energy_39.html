<div class="container">

<table style="width: 100%;"><tr>
<td>normal.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Energy Test of Univariate Normality</h2>

<h3>Description</h3>

<p>Performs the energy test of univariate normality
for the composite hypothesis Case 4, estimated parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normal.test(x, method=c("mc","limit"), R)
normal.e(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> univariate data vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> method for p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of replications if Monte Carlo method</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method="mc"</code> this test function applies the parametric
bootstrap method implemented in <code>mvnorm.test</code>. 
</p>
<p>If <code>method="limit"</code>, the p-value of the test is computed from 
the asymptotic distribution of the test statistic under the null 
hypothesis. The asymptotic 
distribution is a quadratic form of centered Gaussian random variables, 
which has the form
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k=1}^\infty \lambda_k Z_k^2,</code>
</p>

<p>where <code class="reqn">\lambda_k</code> are positive constants (eigenvalues) and
<code class="reqn">Z_k</code> are iid standard normal variables. Eigenvalues are
pre-computed and stored internally. 
A p-value is computed using Imhof's method as implemented in the
<span class="pkg">CompQuadForm</span> package. 
</p>
<p>Note that the "limit" method is intended for moderately large
samples because it applies the asymptotic distribution.  
</p>
<p>The energy test of normality was proposed
and implemented by Szekely and Rizzo (2005). 
See <code>mvnorm.test</code>
for more details. 
</p>


<h3>Value</h3>

<p><code>normal.e</code> returns the energy goodness-of-fit statistic for
a univariate sample. 
</p>
<p><code>normal.test</code> returns a list with class <code>htest</code> containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>observed value of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>sample estimates: mean, sd</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>description of data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Maria L. Rizzo <a href="mailto:mrizzo@bgsu.edu">mrizzo@bgsu.edu</a> and
Gabor J. Szekely
</p>


<h3>References</h3>

<p>Szekely, G. J. and Rizzo, M. L. (2005) A New Test for
Multivariate Normality, <em>Journal of Multivariate Analysis</em>,
93/1, 58-80,
<a href="https://doi.org/10.1016/j.jmva.2003.12.002">doi:10.1016/j.jmva.2003.12.002</a>.
</p>
<p>Mori, T. F., Szekely, G. J. and Rizzo, M. L. "On energy tests of normality." Journal of Statistical Planning and Inference 213 (2021): 1-15. 
</p>
<p>Rizzo, M. L. (2002). A New Rotation Invariant Goodness-of-Fit Test,
Ph.D. dissertation, Bowling Green State University.
</p>
<p>J. P. Imhof (1961). Computing the Distribution of Quadratic Forms in 
Normal Variables, <em>Biometrika</em>, Volume 48, Issue 3/4,
419-426.
</p>


<h3>See Also</h3>

<p><code>mvnorm.test</code> and <code>mvnorm.e</code> for the
energy test of multivariate normality and the test statistic
for multivariate samples.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- iris[1:50, 1]
  normal.e(x)
  normal.test(x, R=199)
  normal.test(x, method="limit")
</code></pre>


</div>