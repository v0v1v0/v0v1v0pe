<div class="container">

<table style="width: 100%;"><tr>
<td>findLnew</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the Wilks Confidence Interval Lower Bound from the Given (empirical) Likelihood Ratio Function</h2>

<h3>Description</h3>

<p>This function is similar to <code>findUL2</code> but here the seeking of lower and upper bound are
separate (the other half is <code>findUnew</code>).
</p>
<p>The reason for this is: sometime we need to supply the <code>fun</code>
with different nuisance parameter(s) values when seeking Lower or Upper bound.
For example <code>fun</code> returns the -2LLR for a given parameter of interest, 
but there are additional nuisance parameter need to be profiled out, and we 
need to give a range of the nuisance parameter to be max/min over. This range can be 
very different for parameter near Upper bound vs near Lower bound. In the <code>findUL2</code>,
you have to supply a range really wide that (hopefully) works for both Upper and Lower
bound. Here, with separate <code>findLnew</code> and <code>findUnew</code> we can tailor the range
for one end of the confidence interval.
</p>
<p>Those nuisance parameter(s)
are supplied via the ... input of this function.
</p>
<p>Another improvement is that we used the "extendInt" option of the <code>uniroot</code>.
So now we can and did used a smaller default step input, compare to <code>findUL2</code>.
</p>
<p>This program uses uniroot( ) to find (only) the lower (Wilks) confidence
limit based on the -2 log likelihood ratio, which the required 
input <code>fun</code> is supposed to supply.
</p>
<p>Basically, starting from <code>MLE</code>, we search on lower
direction, by <code>step</code> away
from <code>MLE</code>, until we find values that have -2LLR = level.
(the value of -2LLR at MLE is supposed to be zero.)
</p>
<p>At curruent implimentation, only handles one dimesional parameter, i.e. only
confidence intervals, not confidence regions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findLnew(step=0.003, initStep=0, fun, MLE, level=3.84146, tol=.Machine$double.eps^0.5,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>a positive number. The starting step size of the search. Reasonable value should be about 1/5 of the SD of MLE. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initStep</code></td>
<td>
<p>a nonnegative number. The first step size of the search. Sometimes, you may want to put a larger innitStep to speed the search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a function that returns a list. One of the item in the list should be "-2LLR", which is the -2 log (empirical) likelihood ratio. 
The first input of <code>fun</code> must be the parameter for which we are seeking the confidence interval. (The MLE or NPMLE of this parameter should be supplied as in the input MLE). The rest of the input to <code>fun</code> are typically the data.
If the first input of <code>fun</code> is set to MLE, then the returned -2LLR should be 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MLE</code></td>
<td>
<p>The MLE of the parameter. No need to be exact, as long as it is inside the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional positive number, controls the confidence level. Default to 3.84146 = chisq(0.95, df=1). 
Change to 2.70=chisq(0.90, df=1) to get a 90% confidence interval. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Error bound of the final result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, if any, to pass to <code>fun</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Basically we repeatedly testing the value of the parameter, until we find those
which the -2 log likelihood value is equal to 3.84146 (or other level, if set differently).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Low</code></td>
<td>
<p>the lower limit of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FstepL</code></td>
<td>
<p>the final step size when search lower limit. An indication of the precision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lvalue</code></td>
<td>
<p>The -2LLR value of the final <code>Low</code> value. Should be approximately equal to level. If larger than level, 
than the confidence interval limit <code>Low</code> is wrong.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Mai Zhou </p>


<h3>References</h3>

<p>Zhou, M. (2016). Empirical Likelihood Method in Survival Analysis. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example with tied observations. Kaplan-Meier mean=4.0659.
## For more examples see vignettes.
x &lt;- c(1, 1.5, 2, 3, 4, 5, 6, 5, 4, 1, 2, 4.5)
d &lt;- c(1,   1, 0, 1, 0, 1, 1, 1, 1, 0, 0,  1)
myfun6 &lt;- function(theta, x, d) {
el.cen.EM2(x, d, fun=function(t){t}, mu=theta)
}
findLnew(step=0.1, fun=myfun6, MLE=4.0659, x=x, d=d)
</code></pre>


</div>