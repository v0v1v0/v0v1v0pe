<div class="container">

<table style="width: 100%;"><tr>
<td>xmgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-Mantel correlogram </h2>

<h3>Description</h3>

<p>Calculates simple Mantel correlograms from cross-distance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">xmgram(species.xd, space.xd, breaks, nclass, stepsize, equiprobable = FALSE, nperm = 1000,
    mrank = FALSE, alternative = "two.sided", trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>species.xd</code></td>
<td>
<p> non-symmetric square cross-distance matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space.xd</code></td>
<td>
<p> non-symmetric square matrix of geographic distances. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p> locations of class breaks. If specified, overrides nclass and stepsize. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p> number of distance classes. If not specified, Sturge's rule will be used
to determine an appropriate number of classes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p> width of each distance class. If not specified, nclass and the range of space.d will be used to calculate an appropriate default. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equiprobable</code></td>
<td>
<p> if TRUE, create nclass classes of equal number of distances; if FALSE, create nclass classes of equal width </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p> number of permutations to use. If set to 0, the permutation test will be omitted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mrank</code></td>
<td>
<p> if this is set to FALSE (the default option), Pearson correlations will be used. If
set to TRUE, the Spearman correlation (correlation ranked distances) will be used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> default is "two.sided", and returns p-values for H0: rM = 0. The alternative is "one.sided", which returns p-values for H0: rM &lt;= 0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> if TRUE, returns progress indicators. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates cross-Mantel correlograms. The Mantel correlogram is essentially a multivariate autocorrelation function.
The Mantel r represents the dissimilarity in variable composition  (often
species composition) at a particular lag distance.
Note that the cross-dissimilarity functions are for research purposes, and are not well-tested.
</p>


<h3>Value</h3>

<p>Returns an object of class mgram, which is a list with two elements.
mgram is a matrix with one row for each distance class and 6 columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lag </code></td>
<td>
<p>midpoint of the distance class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngroup </code></td>
<td>
<p>number of distances in that class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mantelr </code></td>
<td>
<p>Mantel r value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval </code></td>
<td>
<p>p-value for the test chosen.</p>
</td>
</tr>
</table>
<p>resids is NA for objects calculated by mgram().
</p>


<h3>Author(s)</h3>

<p> Sarah Goslee </p>


<h3>References</h3>

<p> Legendre, P. and M. Fortin. 1989. Spatial pattern and ecological analysis.
Vegetatio 80:107-138. </p>


<h3>See Also</h3>

<p><code>xdistance</code> <code>xmantel</code>, <code>plot.mgram</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Need to develop a cross-dissimilarity example
data(graze)

### EXAMPLE 1: Square matrices

# take two subsets of sites with different dominant grass abundances
# use cut-offs that produce equal numbers of sites
dom1 &lt;- subset(graze, POPR &gt; 50 &amp; DAGL &lt; 20) #  8 sites
dom2 &lt;- subset(graze, POPR &lt; 50 &amp; DAGL &gt; 20) #  8 sites

# first two columns are site info
dom.xd &lt;- xdistance(dom1[, -c(1,2)], dom2[, -c(1,2)], "bray")

# environmental and spatial distances; preserve rownames
forest.xd &lt;- xdistance(dom1[, "forestpct", drop=FALSE], 
    dom2[, "forestpct", drop=FALSE])
sitelocation.xd &lt;- xdistance(dom1[, "sitelocation", drop=FALSE], 
    dom2[, "sitelocation", drop=FALSE])

# permutes rows and columns of full nonsymmetric matrix
xmantel(dom.xd ~ forest.xd)
xmantel(dom.xd ~ forest.xd + sitelocation.xd)

plot(xmgram(dom.xd, sitelocation.xd))


### EXAMPLE 2: Non-square matrices

# take two subsets of sites with different dominant grass abundances
# this produces a non-square matrix

dom1 &lt;- subset(graze, POPR &gt; 45 &amp; DAGL &lt; 20) # 13 sites
dom2 &lt;- subset(graze, POPR &lt; 45 &amp; DAGL &gt; 20) #  8 sites

# first two columns are site info
dom.xd &lt;- xdistance(dom1[, -c(1,2)], dom2[, -c(1,2)], "bray")

# environmental and spatial distances; preserve rownames
forest.xd &lt;- xdistance(dom1[, "forestpct", drop=FALSE], 
    dom2[, "forestpct", drop=FALSE])
sitelocation.xd &lt;- xdistance(dom1[, "sitelocation", drop=FALSE], 
    dom2[, "sitelocation", drop=FALSE])

# permutes rows and columns of full nonsymmetric matrix
xmantel(dom.xd ~ forest.xd, dims=c(13, 8))
xmantel(dom.xd ~ forest.xd + sitelocation.xd, dims=c(13, 8))

plot(xmgram(dom.xd, sitelocation.xd))
</code></pre>


</div>