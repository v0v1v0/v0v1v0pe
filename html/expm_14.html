<div class="container">

<table style="width: 100%;"><tr>
<td>matStig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stig's "infamous" Example Matrix</h2>

<h3>Description</h3>

<p>Stig Mortensen wrote on Oct 22, 2007 to the authors of the <span class="pkg">Matrix</span>
package with subject “Strange result from expm”.
There, he presented the following <code class="reqn">8 \times 8</code> matrix for
which the Matrix <code>expm()</code> gave a “strange” result.
As we later researched, the result indeed was wrong: the correct
entries were wrongly permuted.  The reason has been in the underlying
source code in Octave from which it had been ported to <span class="pkg">Matrix</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(matStig)</code></pre>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>Examples</h3>

<pre><code class="language-R">data(matStig)

as(matStig, "sparseMatrix") # since that prints more nicely.

## For more compact printing:
op &lt;- options(digits = 4)

E1 &lt;- expm(matStig, "Ward77", preconditioning="buggy") # the wrong result
as(E1, "sparseMatrix")
str(E2 &lt;- expm(matStig, "Pade"))# the correct one (has "accuracy" attribute)
as(E2, "sparseMatrix")
attr(E2,"accuracy") &lt;- NULL   # don't want it below
E3 &lt;- expm(matStig, "R_Eigen")  # even that is fine here
all.equal(E1,E2) # not at all equal (rel.difference &gt;~= 1.)
stopifnot(all.equal(E3,E2)) # ==

##________ The "proof" that "Ward77" is wrong _________
M &lt;- matStig
Et1 &lt;- expm(t(M), "Ward77", precond= "buggy")
Et2 &lt;- expm(t(M), "Pade"); attr(Et2,"accuracy") &lt;- NULL
all.equal(Et1, t(E1)) # completely different (rel.diff ~ 1.7 (platform dep.))
stopifnot(all.equal(Et2, t(E2))) # the same (up to tolerance)

options(op)
</code></pre>


</div>