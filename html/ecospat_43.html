<div class="container">

<table style="width: 100%;"><tr>
<td>ecospat.niche.dynIndexProjGeo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Projection of niche dynamic indices to the Geography</h2>

<h3>Description</h3>

<p>Creates a SpatRaster in geography with each pixel containing a
niche dynamic index (stability, expansion, or unfilling) extracted
from 2 niches generated with <code>ecospat.grid.clim.dyn</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">ecospat.niche.dynIndexProjGeo(z1, z2, proj, env)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>
<p>Species 1 occurrence density grid created
by <code>ecospat.grid.clim.dyn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z2</code></td>
<td>
<p>Species 2 occurrence density grid created
by <code>ecospat.grid.clim.dyn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj</code></td>
<td>
<p>type of projection (0,1 or 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>A SpatRaster of environmental variables
corresponding to the background (<code>glob</code>
in <code>ecospat.grid.clim.dyn</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extracts the niche dynamic index of objects created
by <code>ecospat.niche.dyn.index</code> for each background point
(<code>glob</code>) using <code>extract</code> from the terra package. The values
are projected to the geographic coordinates of <code>env</code> and returned
as a SpatRaster layer. If proj=0, the common background for z1 and z2 (<code>glob</code>)
is used. If proj=1, the background (<code>glob1</code>) of z1 is used. If proj=2, 
the background (<code>glob1</code>) of z2 is used.
</p>


<h3>Value</h3>

<p>a SpatRaster with cell values 0-3. 1: unfilling
(habitat occupied by species 1); 2: expansion (habitat occupied only
by species 2); 3: stability (habitat occupied by both species); and 0
(unoccupied habitat).</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>, Tyler
Smith <a href="mailto:tyler@plantarum.ca">tyler@plantarum.ca</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B.
Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C.
Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring
ecological niche overlap from occurrence and spatial environmental
data. <em>Global Ecology and Biogeography</em>, <b>21</b>:481-497.
</p>
<p>Petitpierre, B., C. Kueffer, O. Broennimann, C. Randin, C. Daehler and
A. Guisan. 2012. Climatic niche shifts are rare among terrestrial
plant invaders. <em>Science</em>, <b>335</b>:1344-1348.
</p>


<h3>See Also</h3>

<p><code>ecospat.plot.niche.dyn</code>,
<code>ecospat.niche.dyn.index</code>,
<code>ecospat.niche.zProjGeo</code></p>


<h3>Examples</h3>

<pre><code class="language-R">

library(ade4)
library(terra)

data(ecospat.testNiche)
spp &lt;- ecospat.testNiche
xy.sp1 &lt;- subset(spp, species=="sp1")[2:3] #Bromus_erectus
xy.sp2 &lt;- subset(spp, species=="sp4")[2:3] #Pritzelago_alpina

env&lt;-terra::rast(system.file("extdata","ecospat.testEnv.tif",package="ecospat"))

env.sp1 &lt;- terra::extract(env, xy.sp1)[,-1]
env.sp2 &lt;- terra::extract(env, xy.sp2)[,-1]
env.bkg &lt;- na.exclude(terra::values(env))

#####################
## PCA-ENVIRONMENT ##
#####################

library(ade4)
pca.cal &lt;- ade4::dudi.pca(env.bkg, center = TRUE, scale = TRUE,
                    scannf = FALSE, nf = 2)

# predict the scores on the axes
scores.bkg &lt;- pca.cal$li  #scores for background climate
scores.sp1 &lt;- ade4::suprow(pca.cal,env.sp1)$lisup  #scores for sp1
scores.sp2 &lt;- ade4::suprow(pca.cal,env.sp2)$lisup  #scores for sp2

# calculation of occurence density (niche z)
  
z1 &lt;- ecospat.grid.clim.dyn(scores.bkg, scores.bkg,
                            scores.sp1, R = 100)
z2 &lt;- ecospat.grid.clim.dyn(scores.bkg, scores.bkg,
                            scores.sp2, R = 100)

plot(z1$z.uncor)
points(scores.sp1, pch = 21, bg = "green")

plot(z2$z.uncor)
points(scores.sp2, pch = 21, bg = "red")

ecospat.plot.niche.dyn(z1, z2)
points(scores.sp1, pch = 21, bg = "green")
points(scores.sp2, pch = 21, bg = "red")
ecospat.niche.overlap(z1,z2 ,cor = TRUE)

##############################
## dynamic indices in space ##
##############################

geozS &lt;- ecospat.niche.dynIndexProjGeo(z1, z2, proj=0, env)

plot(geozS, col = c("grey", "green", "red", "blue"),
     legend = FALSE)
points(xy.sp1, bg = "green", pch = 21)
points(xy.sp2, bg = "red", pch = 21)
</code></pre>


</div>