<div class="container">

<table style="width: 100%;"><tr>
<td>ddjnonparam_ews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Drift Diffusion Jump Nonparametrics Early Warning Signals</h2>

<h3>Description</h3>

<p><code>ddjnonparam_ews</code> is used to compute nonparametrically conditional variance, drift, diffusion and jump intensity in a timeseries and it also interpolates to obtain the evolution of the nonparametric statistics in time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ddjnonparam_ews(
  timeseries,
  bandwidth = 0.6,
  na = 500,
  logtransform = TRUE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>is the bandwidht of the kernel regressor (must be numeric). Default is 0.6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>is the number of points for computing the kernel (must be numeric). Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The approach is based on estimating terms of a drift-diffusion-jump model as a surrogate for the unknown true data generating process: <code class="reqn">dx = f(x,\theta)dt + g(x,\theta)dW + dJ</code>. Here x is the state variable, f() and g() are nonlinear functions, dW is a Wiener process and dJ is a jump process. Jumps are large, one-step, positive or negative shocks that are uncorrelated in time. In addition, <code>ddjnonparam_ews</code> returns a first plot with the original timeseries and the residuals after first-differencing. A second plot shows the nonparametric conditional variance, total variance, diffusion and jump intensity over the data, and a third plot the same nonparametric statistics over time.
</p>


<h3>Value</h3>

<p><code>ddjnonparam_ews</code> returns an object with elements:
avec is the mesh for which values of the nonparametric statistics are estimated.
S2.vec is the conditional variance of the timeseries <code>x</code> over <code>avec</code>.
TotVar.dx.vec is the total variance of <code>dx</code> over <code>avec</code>.
Diff2.vec is the diffusion estimated as <code>total variance - jumping intensity</code> vs <code>avec</code>.
LamdaZ.vec is the jump intensity over <code>avec</code>.
Tvec1 is the timeindex.
S2.t is the conditional variance of the timeseries <code>x</code> data over <code>Tvec1</code>.
TotVar.t is the total variance of <code>dx</code> over <code>Tvec1</code>.
Diff2.t is the diffusion over <code>Tvec1</code>.
Lamda.t is the jump intensity over <code>Tvec1</code>.
</p>


<h3>Author(s)</h3>

<p>S. R. Carpenter, modified by V. Dakos and L. Lahti
</p>


<h3>References</h3>

<p>Carpenter, S. R. and W. A. Brock (2011). 'Early warnings of unknown nonlinear shifts: a nonparametric approach.' <em>Ecology</em> 92(12): 2196-2201
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>See Also</h3>

<p><code>generic_ews</code>; <code>ddjnonparam_ews</code>; <code>bdstest_ews</code>; <code>sensitivity_ews</code>;<code>surrogates_ews</code>; <code>ch_ews</code>; <code>movpotential_ews</code>; <code>livpotential_ews</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(foldbif)
output&lt;-ddjnonparam_ews(foldbif,bandwidth=0.6,na=500,
logtransform=TRUE,interpolate=FALSE)
</code></pre>


</div>