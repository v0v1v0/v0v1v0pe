<div class="container">

<table style="width: 100%;"><tr>
<td>lognormgpdcon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log-Normal Bulk and GPD Tail Extreme Value Mixture Model with Single Continuity Constraint</h2>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and
random number generation for the extreme value mixture model with log-normal for bulk
distribution upto the threshold and conditional GPD above threshold with continuity
at threshold. The parameters
are the log-normal mean <code>lnmean</code> and standard deviation <code>lnsd</code>, threshold <code>u</code>
GPD shape <code>xi</code> and tail fraction <code>phiu</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dlognormgpdcon(x, lnmean = 0, lnsd = 1, u = qlnorm(0.9, lnmean,
  lnsd), xi = 0, phiu = TRUE, log = FALSE)

plognormgpdcon(q, lnmean = 0, lnsd = 1, u = qlnorm(0.9, lnmean,
  lnsd), xi = 0, phiu = TRUE, lower.tail = TRUE)

qlognormgpdcon(p, lnmean = 0, lnsd = 1, u = qlnorm(0.9, lnmean,
  lnsd), xi = 0, phiu = TRUE, lower.tail = TRUE)

rlognormgpdcon(n = 1, lnmean = 0, lnsd = 1, u = qlnorm(0.9, lnmean,
  lnsd), xi = 0, phiu = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnmean</code></td>
<td>
<p>mean on log scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnsd</code></td>
<td>
<p>standard deviation on log scale (positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiu</code></td>
<td>
<p>probability of being above threshold <code class="reqn">[0, 1]</code> or <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if TRUE then log density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical, if FALSE then upper tail probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>cumulative probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size (positive integer)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extreme value mixture model combining log-normal distribution for the bulk
below the threshold and GPD for upper tailwith continuity
at threshold.
</p>
<p>The user can pre-specify <code>phiu</code> 
permitting a parameterised value for the tail fraction <code class="reqn">\phi_u</code>. Alternatively, when
<code>phiu=TRUE</code> the tail fraction is estimated as the tail fraction from the
log-normal bulk model.
</p>
<p>The cumulative distribution function with tail fraction <code class="reqn">\phi_u</code> defined by the
upper tail fraction of the log-normal bulk model (<code>phiu=TRUE</code>), upto the 
threshold <code class="reqn">0 &lt; x \le u</code>, given by:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = H(x)</code>
</p>

<p>and above the threshold <code class="reqn">x &gt; u</code>:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = H(u) + [1 - H(u)] G(x)</code>
</p>

<p>where <code class="reqn">H(x)</code> and <code class="reqn">G(X)</code> are the log-normal and conditional GPD
cumulative distribution functions (i.e. <code>plnorm(x, lnmean, lnsd)</code> and
<code>pgpd(x, u, sigmau, xi)</code>) respectively.
</p>
<p>The cumulative distribution function for pre-specified <code class="reqn">\phi_u</code>, upto the
threshold <code class="reqn">0 &lt; x \le u</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = (1 - \phi_u) H(x)/H(u)</code>
</p>

<p>and above the threshold <code class="reqn">x &gt; u</code>:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \phi_u + [1 - \phi_u] G(x)</code>
</p>

<p>Notice that these definitions are equivalent when <code class="reqn">\phi_u = 1 - H(u)</code>.
</p>
<p>The log-normal is defined on the positive reals, so the threshold must be positive.
</p>
<p>The continuity constraint means that <code class="reqn">(1 - \phi_u) h(u)/H(u) = \phi_u g(u)</code>
where <code class="reqn">h(x)</code> and <code class="reqn">g(x)</code> are the log-normal and conditional GPD
density functions (i.e. <code>dlnorm(x, lnmean, lnsd)</code> and
<code>dgpd(x, u, sigmau, xi)</code>) respectively. The resulting GPD scale parameter is then:
</p>
<p style="text-align: center;"><code class="reqn">\sigma_u = \phi_u H(u) / [1 - \phi_u] h(u)</code>
</p>
<p>.
In the special case of where the tail fraction is defined by the bulk model this reduces to
</p>
<p style="text-align: center;"><code class="reqn">\sigma_u = [1 - H(u)] / h(u)</code>
</p>
<p>. 
</p>
<p>See <code>gpd</code> for details of GPD upper tail component and 
<code>dlnorm</code> for details of log-normal bulk component.
</p>


<h3>Value</h3>

<p><code>dlognormgpdcon</code> gives the density, 
<code>plognormgpdcon</code> gives the cumulative distribution function,
<code>qlognormgpdcon</code> gives the quantile function and 
<code>rlognormgpdcon</code> gives a random sample.
</p>


<h3>Note</h3>

<p>All inputs are vectorised except <code>log</code> and <code>lower.tail</code>.
The main inputs (<code>x</code>, <code>p</code> or <code>q</code>) and parameters must be either
a scalar or a vector. If vectors are provided they must all be of the same length,
and the function will be evaluated for each element of vector. In the case of 
<code>rlognormgpdcon</code> any input vector must be of length <code>n</code>.
</p>
<p>Default values are provided for all inputs, except for the fundamentals 
<code>x</code>, <code>q</code> and <code>p</code>. The default sample size for 
<code>rlognormgpdcon</code> is 1.
</p>
<p>Missing (<code>NA</code>) and Not-a-Number (<code>NaN</code>) values in <code>x</code>,
<code>p</code> and <code>q</code> are passed through as is and infinite values are set to
<code>NA</code>. None of these are not permitted for the parameters.
</p>
<p>Error checking of the inputs (e.g. invalid probabilities) is carried out and
will either stop or give warning message as appropriate.
</p>


<h3>Author(s)</h3>

<p>Yang Hu and Carl Scarrott <a href="mailto:carl.scarrott@canterbury.ac.nz">carl.scarrott@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p><a href="http://en.wikipedia.org/wiki/Log-normal_distribution">http://en.wikipedia.org/wiki/Log-normal_distribution</a>
</p>
<p><a href="http://en.wikipedia.org/wiki/Generalized_Pareto_distribution">http://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>
<p>Scarrott, C.J. and MacDonald, A. (2012). A review of extreme value
threshold estimation and uncertainty quantification. REVSTAT - Statistical
Journal 10(1), 33-59. Available from <a href="http://www.ine.pt/revstat/pdf/rs120102.pdf">http://www.ine.pt/revstat/pdf/rs120102.pdf</a>
</p>
<p>Solari, S. and Losada, M.A. (2004). A unified statistical model for
hydrological variables including the selection of threshold for the peak over
threshold method. Water Resources Research. 48, W10541.
</p>


<h3>See Also</h3>

<p><code>gpd</code> and <code>dlnorm</code>
</p>
<p>Other lognormgpd: <code>flognormgpdcon</code>,
<code>flognormgpd</code>, <code>lognormgpd</code>
</p>
<p>Other lognormgpdcon: <code>flognormgpdcon</code>,
<code>flognormgpd</code>, <code>lognormgpd</code>
</p>
<p>Other normgpd: <code>fgng</code>, <code>fhpd</code>,
<code>fitmnormgpd</code>, <code>flognormgpd</code>,
<code>fnormgpdcon</code>, <code>fnormgpd</code>,
<code>gngcon</code>, <code>gng</code>,
<code>hpdcon</code>, <code>hpd</code>,
<code>itmnormgpd</code>, <code>lognormgpd</code>,
<code>normgpdcon</code>, <code>normgpd</code>
</p>
<p>Other flognormgpdcon: <code>flognormgpdcon</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
par(mfrow = c(2, 2))

x = rlognormgpdcon(1000)
xx = seq(-1, 10, 0.01)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 10))
lines(xx, dlognormgpdcon(xx))

# three tail behaviours
plot(xx, plognormgpdcon(xx), type = "l")
lines(xx, plognormgpdcon(xx, xi = 0.3), col = "red")
lines(xx, plognormgpdcon(xx, xi = -0.3), col = "blue")
legend("bottomright", paste("xi =",c(0, 0.3, -0.3)),
  col=c("black", "red", "blue"), lty = 1)

x = rlognormgpdcon(1000, u = 2, phiu = 0.2)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 10))
lines(xx, dlognormgpdcon(xx, u = 2, phiu = 0.2))

plot(xx, dlognormgpdcon(xx, u = 2, xi=0, phiu = 0.2), type = "l")
lines(xx, dlognormgpdcon(xx, u = 2, xi=-0.2, phiu = 0.2), col = "red")
lines(xx, dlognormgpdcon(xx, u = 2, xi=0.2, phiu = 0.2), col = "blue")
legend("topright", c("xi = 0", "xi = 0.2", "xi = -0.2"),
  col=c("black", "red", "blue"), lty = 1)

## End(Not run)

</code></pre>


</div>