<div class="container">

<table style="width: 100%;"><tr>
<td>probtrans_fft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute subject-specific transition probabilities
using a convolution algorithm based on the Fast Fourier transform.</h2>

<h3>Description</h3>

<p>Compute subject-specific transition probabilities
using a convolution algorithm based on the Fast Fourier transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">probtrans_fft(initial_state, cumhaz, max_time, nr_steps = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>initial_state</code></td>
<td>
<p>The present function 
estimates state occupation probabilities from the state given
in this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumhaz</code></td>
<td>
<p>An <code>msfit</code> object created by running
<code>mstate</code> or <code>mstate_generic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_time</code></td>
<td>
<p>The maximum time for which transition probabilities
are estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_steps</code></td>
<td>
<p>The number of steps in the convolution algorithm
(larger increases precision but makes it slower)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>time</code> argument is crucial for precision.
The density of time points and
the upper time limit should
be increased until the estimated curves become stable.
A useful rule of thumb is to set the upper time limit
to a time point in which the
probability of each transient state is zero and the probability of
each absorbing state is constant.
</p>
<p>For the same approximation grid, <code>probtrans_fft</code> doesnâ€™t
always yield the same result as <code>probtrans_ebmstate</code>
(semi-Markov version), even though they are meant to approximate
exactly the same convolution. <code>probtrans_ebmstate</code> is
sensitive to the grid interval size, but not such much to the
maximum grid time. <code>probtrans_fft</code> is sensitive to both
these parameters, as referred above.
</p>
<p>The algorithm behind <code>probtrans_ebmstate</code> is based
on the convolution of density and survival functions and
is suitable for processes with a tree-like transition
structure only.
</p>


<h3>Value</h3>

<p>An object of class 'probtrans'. See the 'value' 
section in the help page of <code>mstate::probtrans</code>.
</p>


<h3>Author(s)</h3>

<p>Rui Costa
</p>


<h3>See Also</h3>

<p><code>probtrans</code>; <code>probtrans_ebmstate</code>
</p>


</div>