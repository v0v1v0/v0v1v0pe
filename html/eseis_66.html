<div class="container">

<table style="width: 100%;"><tr>
<td>signal_spectrogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate spectrograms (power spectral density estimates) from time series.</h2>

<h3>Description</h3>

<p>This function creates spectrograms from seismic signals. It supports the
standard spectrogram approach and the Welch method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">signal_spectrogram(
  data,
  time,
  dt,
  Welch = FALSE,
  window,
  overlap = 0.5,
  window_sub,
  overlap_sub = 0.5,
  method = "periodogram",
  cpu = NULL,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>Numeric</code> vector or list of vectors, seismic signal to 
be processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p><code>POSIX.ct</code> vector with time values. If omitted, an 
artificial time vector will be created, based on <code>dt</code>. Only needed 
if <code>data</code> is no <code>eseis</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p><code>Numeric</code> value, sampling period. If omitted, either 
estimated from <code>time</code> or set to 0.01 s (i.e., f = 100 Hz). Only needed 
if <code>data</code> is no <code>eseis</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Welch</code></td>
<td>
<p><code>Logical</code> value, option to use the Welch method for
calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> value, time window length in seconds used to 
calculate individual spectra. Set to 1 percent of the time series length 
by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p><code>Numeric</code> value, fraction of window overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_sub</code></td>
<td>
<p><code>Numeric</code> value, length of the sub-window in seconds 
used to calculate spectra. Only relevant if <code>Welch = TRUE</code>. If omitted, 
the sub-window length is set to 10 percent of the main window length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap_sub</code></td>
<td>
<p><code>Numeric</code> value, fraction of sub-window overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>Character</code> value, method to calculate the spectra. 
One out of <code>"periodogram"</code> and <code>"autoregressive"</code>. 
Default is <code>"periodogram"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu</code></td>
<td>
<p><code>Numeric</code> value between 0 and 1, fraction of CPU cores to 
use. If omitted, only one CPU is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>Logical</code> value, toggle plot output. Default is
<code>FALSE</code>. For more customised plotting see <code>plot_spectrogram</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data containing <code>NA</code> values is replaced by zeros and set to NA in the 
output data set.
</p>


<h3>Value</h3>

<p><code>List</code> with spectrogram matrix, time and frequency vectors.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load example data set
data("earthquake")

## calculate and plot PSD straight away
P &lt;- signal_spectrogram(data = s$BHZ, 
                               time = t, 
                               dt = 1 / 200, 
                               plot = TRUE)

## calculate and plot PSD with defined window sizes and the Welch method
P &lt;- signal_spectrogram(data = s$BHZ, 
                               time = t, 
                               dt = 1 / 200, 
                               window = 5, 
                               overlap = 0.9, 
                               window_sub = 3, 
                               overlap_sub = 0.9, 
                               Welch = TRUE,
                               plot = TRUE)
                      
</code></pre>


</div>