<div class="container">

<table style="width: 100%;"><tr>
<td>festLASSO</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ‘Future Loss’ Ridge or LASSO Estimates</h2>

<h3>Description</h3>

<p>Computes a ridge or LASSO estimate for a given regression problem, with penalty parameter chosen to minimize bias and variance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">festLASSO(
  X,
  y,
  loss = c("fMSE", "fMBV", "both"),
  ind = 1,
  lseq,
  B = 500,
  penalize,
  rescale.lambda = TRUE,
  scale = FALSE,
  returnMSE = FALSE,
  postsamp,
  returnPS = FALSE,
  nPost = 1000,
  se.version = c("varExp", "full", "none"),
  ...
)

festRidge(
  X,
  y,
  loss = c("fMSE", "fMBV", "both"),
  ind = 1,
  lseq,
  penalize,
  scale = FALSE,
  returnMSE = FALSE,
  postsamp,
  returnPS = FALSE,
  nPost = 1000,
  se.version = c("varExp", "full", "none"),
  XtXlamIinv = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix for the regression. Assumed to contain only numeric values, so 
any factors should be coded according to desired contrast (e.g., via <code>model.matrix</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Outcome vector. Unless <code>X</code> contains an intercept column, this should typically be centered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>Loss function for choosing the penalty parameter. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Vector of integers or logicals indicating which coefficients the loss is to be computed on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lseq</code></td>
<td>
<p>Sequence of penalty values to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of future datasets to simulate for each point in posterior sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize</code></td>
<td>
<p>See <code>estRidge</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale.lambda</code></td>
<td>
<p>If <code>TRUE</code>, then lambda is rescaled to account for the 
default re-scaling done by <code>glmnet</code>. Can also be a scalar scaling factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical indicating whether the design matrix X be scaled. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnMSE</code></td>
<td>
<p>Logical indicating whether mse object should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postsamp</code></td>
<td>
<p>List containing posterior sample (from <code>samplePosterior</code>). If
missing, then a posterior sample is drawn.  Currently checks on the provided
<code>postsamp</code> are limited, so use with caution.  Designed to facilitate
simulations or other scenarios where it may be pre-computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnPS</code></td>
<td>
<p>logical indicating whether or not the full posterior sample should
be included in output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPost</code></td>
<td>
<p>Size of posterior sample to compute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.version</code></td>
<td>
<p>String indicating which version of standard errors to use. See <code>vcovfestRidge</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>samplePosterior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XtXlamIinv</code></td>
<td>
<p>explicit value of (X'X + diag(penalty))^-1.  Useful
for simulations to save computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The value of the ridge or LASSO penalty is selected by minimizing the 
posterior expectation of the loss function, which is chosen by the argument
<code>loss</code>. Possible options are <code>fMBV</code>, which uses the loss function
<code class="reqn">fMBV = max(Bias(\beta)^2, Var(\beta))</code> and <code>fMSE</code>, which uses the loss function
<code class="reqn">fMSE = Bias(\beta)^2 +  Var(\beta)</code>. 
</p>
<p>To balance the influence of covariates, it is recommended
that the design matrix be standardized.  This can be done by
the user or via the argument <code>scale</code>.  If <code>scale=TRUE</code>,
then coefficient and standard error estimates are back-transformed.
</p>
<p>Use the <code>XtXlamIinv</code> argument with caution. No checks are done on the provided
value. Note that <code>lseq</code> is re-ordered to be decreasing, and provided values
of <code>XtXlamIinv</code> must account for this.
</p>


<h3>See Also</h3>

<p><code>mseRidge,vcovfestRidge, simLASSO, check_CIbound</code>
</p>


</div>