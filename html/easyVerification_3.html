<div class="container">

<table style="width: 100%;"><tr>
<td>convert2prob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert to Probability / Category Forecast</h2>

<h3>Description</h3>

<p><code>convert2prob</code> Converts the continuous ensemble forecast to
counts of ensemble members per category. The categories can be defined
relative to the ensemble distribution (using <code>prob</code>) or relative to
absolute values for the category thresholds (using <code>threshold</code>, see
details). <code>prob2thresh</code> converts the relative threshold to absolute
thresholds for later processing. <code>expandthresh</code> expands the vector or
matrix of thresholds to fit the input data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convert2prob(
  x,
  prob = NULL,
  threshold = NULL,
  ref.ind = NULL,
  multi.model = FALSE
)

prob2thresh(x, prob, ref.ind = NULL, multi.model = FALSE)

expandthresh(threshold, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input vector or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>thresholds for categorical forecasts (defaults to NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>absolute thresholds for categorical forecasts (defaults to
NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.ind</code></td>
<td>
<p>list of forecast/obs instances to be used to estimate
percentile thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi.model</code></td>
<td>
<p>logical, are we dealing with initial condition (the
default) or multi-model ensembles (see details)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In case both <code>prob</code> and <code>threshold</code> are set to
<code>NULL</code>, the function returns the input <code>x</code> without modification.
If <code>prob</code> is set, a matrix with the number of occurrences per class for
a given quantile of the full distribution (e.g. temperature above/below the
median). If <code>threshold</code> is set, the classes are defined based on the
absolute value (e.g. temperature above/below 13 deg. C). Multiple classes
are
</p>
<p>Only certain formats of <code>threshold</code> and <code>prob</code> are supported.
<code>prob</code> has to be a vector with percentile thresholds separating the
different classes. <code>threshold</code> can be a vector, matrix or array with
the first entry corresponding to the different classes, and the last to the
different ensemble members (if present). Thereby, time/forecast varying
thresholds can potentially be supplied (although I am not sure this is
useful or needed).
</p>
<p>If <code>ref.ind</code> is specified, only the specified indices of the input
variables are used to estimate the percentile thresholds (<code>prob</code>). If
used with <code>threshold</code>, or without anything, <code>ref.ind</code> has no effect.
</p>
<p>If <code>multi.model = TRUE</code>, the relative thresholds supplied by
<code>prob</code> are ensemble member specific, i.e. are estimated for each
ensemble member separately. This is in particular applicable for
multi-model ensembles with model dependent biases.
</p>


<h3>Value</h3>

<p>Matrix of occurences per class (i.e. the number of ensemble members
per class, or an indicator for the observations)
</p>


<h3>See Also</h3>

<p><code>veriApply</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tm &lt;- toymodel()

## convert to tercile forecasts (only display first forecast and obs)
convert2prob(tm$fcst, prob = 1:2 / 3)[1, ]
convert2prob(tm$obs, prob = 1:2 / 3)[1, ]

## convert to category forecasts (smaller and larger than 1)
convert2prob(tm$fcst, threshold = 1)[1, ]
convert2prob(tm$obs, threshold = 1)[1, ]

</code></pre>


</div>