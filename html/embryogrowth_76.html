<div class="container">

<table style="width: 100%;"><tr>
<td>weightmaxentropy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search for the weights of the nests which maximize the entropy of nest temperatures distribution</h2>

<h3>Description</h3>

<p>Search for the weights of the nests which maximize the entropy of nest temperatures distribution. Entropy is measured by Shanon index.<br>
Entropy method must be entropy.empirical because it is the only method insensitive to scaling.<br>
If no weight is given, the initial weight is uniformly distributed.<br>
Use control_optim=list(trace=0) for not show progress of search report.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weightmaxentropy(
  temperatures = stop("Temperature data must be provided !"),
  weight = NULL,
  entropy.method = entropy::entropy.empirical,
  plot = TRUE,
  control_optim = list(trace = 0, maxit = 500),
  control_plot = NULL,
  control_entropy = NULL,
  col = c("black", "red")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>temperatures</code></td>
<td>
<p>Timeseries of temperatures formated using FormatNests()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>A named vector of the initial weight search for each nest for likelihood estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entropy.method</code></td>
<td>
<p>Entropy function, for example entropy::entropy.empirical. See package entropy for description</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Do the plot of temperatures before and after weight must be shown ? TRUE or FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_optim</code></td>
<td>
<p>A list with control paramaters for optim function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_plot</code></td>
<td>
<p>A list with control paramaters for plot function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_entropy</code></td>
<td>
<p>A list with control paramaters for entropy function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colors for unweighted and weighted distributions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Search for the weights of the nests which maximize the entropy of nest temperatures distribution
</p>


<h3>Value</h3>

<p>A named vector of weights
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
w &lt;- weightmaxentropy(formated, control_plot=list(xlim=c(20,36)))
x &lt;- structure(c(120.940334922916, 467.467455887442,  
	306.176613681557, 117.857995419495),  
	.Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_weight &lt;- searchR(parameters=x,  
	fixed.parameters=pfixed, temperatures=formated,  
	integral=integral.Gompertz, M0=1.7, hatchling.metric=c(Mean=39.33, SD=1.92),  
	method = "BFGS", weight=w)
data(resultNest_4p_weight)
plotR(resultNest_4p_weight, ylim=c(0,0.50), xlim=c(15, 35))
# Standard error of parameters can use the GRTRN_MHmcmc() function

## End(Not run)
</code></pre>


</div>