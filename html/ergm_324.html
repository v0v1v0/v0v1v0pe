<div class="container">

<table style="width: 100%;"><tr>
<td>gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct Goodness-of-Fit Diagnostics on a Exponential Family Random Graph
Model</h2>

<h3>Description</h3>

<p><code>gof()</code> calculates <code class="reqn">p</code>-values for geodesic distance, degree,
and reachability summaries to diagnose the goodness-of-fit of exponential
family random graph models.  See <code>ergm()</code> for more information on
these models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gof(object, ...)

## S3 method for class 'ergm'
gof(
  object,
  ...,
  coef = coefficients(object),
  GOF = NULL,
  constraints = object$constraints,
  control = control.gof.ergm(),
  verbose = FALSE
)

## S3 method for class 'formula'
gof(
  object,
  ...,
  coef = NULL,
  GOF = NULL,
  constraints = ~.,
  basis = eval_lhs.formula(object),
  control = NULL,
  unconditional = TRUE,
  verbose = FALSE
)

## S3 method for class 'gof'
print(x, ...)

## S3 method for class 'gof'
plot(
  x,
  ...,
  cex.axis = 0.7,
  plotlogodds = FALSE,
  main = "Goodness-of-fit diagnostics",
  normalize.reachability = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Either a formula or an <code>ergm</code> object.
See documentation for <code>ergm()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments, to be passed to lower-level functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>When given either a formula or an object of class ergm,
<code>coef</code> are the parameters from which the sample is drawn. By default
set to a vector of 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF</code></td>
<td>
<p>formula; an formula object, of the form <code>~ &lt;model terms&gt;</code>
specifying the statistics to use to diagnosis the goodness-of-fit of the
model.  They do not need to be in the model formula specified in
<code>formula</code>, and typically are not.  Currently supported terms are the
degree distribution (“degree” for undirected graphs,
“idegree” and/or “odegree” for directed graphs, and “b1degree” and “b2degree” for bipartite undirected graphs), geodesic
distances (“distance”), shared partner distributions
(“espartners” and “dspartners”), the triad census
(“triadcensus”), and the terms of the original model
(“model”). The default formula for undirected networks is <code>~
degree + espartners + distance + model</code>, and the default formula for
directed networks is <code>~ idegree + odegree + espartners + distance +
model</code>.  By default a “model” term is added to the formula.  It is a
very useful overall validity check and a reminder of the statistical
variation in the estimates of the mean value parameters.  To omit the
“model” term, add “- model” to the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>
<p>A one-sided formula specifying one or more constraints on
the support of the distribution of the networks being modeled. See the help
for similarly-named argument in <code>ergm()</code> for more information. For
<code>gof.formula</code>, defaults to unconstrained. For <code>gof.ergm</code>, defaults
to the constraints with which <code>object</code> was fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters for algorithm tuning,
typically constructed with <code>control.gof.formula()</code> or <code>control.gof.ergm()</code>, which have different
defaults. Their documentation gives the the list of recognized
control parameters and their meaning. The more generic utility
<code>snctrl()</code> (StatNet ConTRoL) also provides argument completion
for the available control functions and limited argument name
checking.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical or an integer to control the amount of
progress and diagnostic information to be printed. <code>FALSE</code>/<code>0</code>
produces minimal output, with higher values producing more
detail. Note that very high values (5+) may significantly slow
down processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>a value (usually a <code>network</code>) to override the LHS of the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>logical; if <code>TRUE</code>, the simulation is
unconditional on the observed dyads.  if not <code>TRUE</code>, the simulation is
conditional on the observed dyads. This is primarily used internally when
the network has missing data and a conditional GoF is produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>gof</code> for printing or plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>Character expansion of the axis labels relative to that for
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotlogodds</code></td>
<td>
<p>Plot the odds of a dyad having given characteristics
(e.g., reachability, minimum geodesic distance, shared partners). This is an
alternative to the probability of a dyad having the same property.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title for the goodness-of-fit plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize.reachability</code></td>
<td>
<p>Should the reachability proportion be
normalized to make it more comparable with the other geodesic distance
proportions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A sample of graphs is randomly drawn from the specified model.  The first
argument is typically the output of a call to <code>ergm()</code> and the
model used for that call is the one fit.
</p>
<p>For <code>GOF = ~model</code>, the model's observed sufficient statistics are
plotted as quantiles of the simulated sample. In a good fit, the observed
statistics should be near the sample median (0.5).
</p>
<p>By default, the sample consists of 100 simulated networks, but this sample
size (and many other settings) can be changed using the <code>control</code>
argument described above.
</p>


<h3>Value</h3>

<p><code>gof()</code>, <code>gof.ergm()</code>, and
<code>gof.formula()</code> return an object of class <code>gof.ergm</code>, which inherits from class <code>gof</code>.  This
is a list of the tables of statistics and <code class="reqn">p</code>-values.  This is typically
plotted using <code>plot.gof()</code>.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>gof(ergm)</code>: Perform simulation to evaluate goodness-of-fit for
a specific <code>ergm()</code> fit.
</p>
</li>
<li> <p><code>gof(formula)</code>: Perform simulation to evaluate goodness-of-fit for
a model configuration specified by a <code>formula</code>, coefficient,
constraints, and other settings.
</p>
</li>
</ul>
<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(gof)</code>: <code>print.gof()</code> summaries the diagnostics such as the
degree distribution, geodesic distances, shared partner
distributions, and reachability for the goodness-of-fit of
exponential family random graph models. (<code>summary.gof</code> is a deprecated
alias that may be repurposed in the future.)
</p>
</li>
<li> <p><code>plot(gof)</code>: <code>plot.gof()</code> plots diagnostics such as the degree
distribution, geodesic distances, shared partner distributions, and
reachability for the goodness-of-fit of exponential family random graph
models.
</p>
</li>
</ul>
<h3>Note</h3>

<p>For <code>gof.ergm</code> and <code>gof.formula</code>, default behavior depends on the
directedness of the network involved; if undirected then degree, espartners,
and distance are used as default properties to examine.  If the network in
question is directed, “degree” in the above is replaced by idegree
and odegree.
</p>


<h3>See Also</h3>

<p><code>ergm()</code>, <code>network()</code>, <code>simulate.ergm()</code>, <code>summary.ergm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(florentine)
gest &lt;- ergm(flomarriage ~ edges + kstar(2))
gest
summary(gest)

# test the gof.ergm function
gofflo &lt;- gof(gest)
gofflo

# Plot all three on the same page
# with nice margins
par(mfrow=c(1,3))
par(oma=c(0.5,2,1,0.5))
plot(gofflo)

# And now the log-odds
plot(gofflo, plotlogodds=TRUE)

# Use the formula version of gof
gofflo2 &lt;-gof(flomarriage ~ edges + kstar(2), coef=c(-1.6339, 0.0049))
plot(gofflo2)


</code></pre>


</div>