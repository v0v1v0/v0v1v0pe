<div class="container">

<table style="width: 100%;"><tr>
<td>plot.enve.RecPlot2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Enveomics: Recruitment Plot (2)</h2>

<h3>Description</h3>

<p>Plots an <code>enve.RecPlot2</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'enve.RecPlot2'
plot(
  x,
  layout = matrix(c(5, 5, 2, 1, 4, 3), nrow = 2),
  panel.fun = list(),
  widths = c(1, 7, 2),
  heights = c(1, 2),
  palette = grey((100:0)/100),
  underlay.group = TRUE,
  peaks.col = "darkred",
  use.peaks,
  id.lim = range(x$id.breaks),
  pos.lim = range(x$pos.breaks),
  pos.units = c("Mbp", "Kbp", "bp"),
  mar = list(`1` = c(5, 4, 1, 1) + 0.1, `2` = c(ifelse(any(layout == 1), 1, 5), 4, 4, 1)
    + 0.1, `3` = c(5, ifelse(any(layout == 1), 1, 4), 1, 2) + 0.1, `4` =
    c(ifelse(any(layout == 1), 1, 5), ifelse(any(layout == 2), 1, 4), 4, 2) + 0.1, `5` =
    c(5, 3, 4, 1) + 0.1, `6` = c(5, 4, 4, 2) + 0.1),
  pos.splines = 0,
  id.splines = 1/2,
  in.lwd = ifelse(is.null(pos.splines) || pos.splines &gt; 0, 1/2, 2),
  out.lwd = ifelse(is.null(pos.splines) || pos.splines &gt; 0, 1/2, 2),
  id.lwd = ifelse(is.null(id.splines) || id.splines &gt; 0, 1/2, 2),
  in.col = "darkblue",
  out.col = "lightblue",
  id.col = "black",
  breaks.col = "#AAAAAA40",
  peaks.opts = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>enve.RecPlot2</code> object to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>Matrix indicating the position of the different panels in the layout,
where:
</p>

<ul>
<li>
<p> 0: Empty space
</p>
</li>
<li>
<p> 1: Counts matrix
</p>
</li>
<li>
<p> 2: position histogram (sequencing depth)
</p>
</li>
<li>
<p> 3: identity histogram
</p>
</li>
<li>
<p> 4: Populations histogram (histogram of sequencing depths)
</p>
</li>
<li>
<p> 5: Color scale for the counts matrix (vertical)
</p>
</li>
<li>
<p> 6: Color scale of the counts matrix (horizontal)
</p>
</li>
</ul>
<p>Only panels indicated here will be plotted. To plot only one panel
simply set this to the number of the panel you want to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel.fun</code></td>
<td>
<p>List of functions to be executed after drawing each panel. Use the
indices in <code>layout</code> (as characters) as keys. Functions for indices
missing in <code>layout</code> are ignored. For example, to add a vertical line
at the 3Mbp mark in both the position histogram and the counts matrix:
<code>list('1'=function() abline(v=3), '2'=function() abline(v=3))</code>.
Note that the X-axis in both panels is in Mbp by default. To change
this behavior, set <code>pos.units</code> accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widths</code></td>
<td>
<p>Relative widths of the columns of <code>layout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heights</code></td>
<td>
<p>Relative heights of the rows of <code>layout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>Colors to be used to represent the counts matrix, sorted from no hits
to the maximum sequencing depth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>underlay.group</code></td>
<td>
<p>If TRUE, it indicates the in-group and out-group areas couloured based
on <code>in.col</code> and <code>out.col</code>. Requires support for semi-transparency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks.col</code></td>
<td>
<p>If not <code>NA</code>, it attempts to represent peaks in the population histogram
in the specified color. Set to <code>NA</code> to avoid peak-finding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.peaks</code></td>
<td>
<p>A list of <code>enve.RecPlot2.Peak</code> objects, as returned by
<code>enve.recplot2.findPeaks</code>. If passed, <code>peaks.opts</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.lim</code></td>
<td>
<p>Limits of identities to represent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.lim</code></td>
<td>
<p>Limits of positions to represent (in bp, regardless of <code>pos.units</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.units</code></td>
<td>
<p>Units in which the positions should be represented (powers of 1,000
base pairs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>Margins of the panels as a list, with the character representation of
the number of the panel as index (see <code>layout</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.splines</code></td>
<td>
<p>Smoothing parameter for the splines in the position histogram. Zero
(0) for no splines. Use <code>NULL</code> to automatically detect by leave-one-out
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.splines</code></td>
<td>
<p>Smoothing parameter for the splines in the identity histogram. Zero
(0) for no splines. Use <code>NULL</code> to automatically detect by leave-one-out
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.lwd</code></td>
<td>
<p>Line width for the sequencing depth of in-group matches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.lwd</code></td>
<td>
<p>Line width for the sequencing depth of out-group matches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.lwd</code></td>
<td>
<p>Line width for the identity histogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.col</code></td>
<td>
<p>Color associated to in-group matches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.col</code></td>
<td>
<p>Color associated to out-group matches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.col</code></td>
<td>
<p>Color for the identity histogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks.col</code></td>
<td>
<p>Color of the vertical lines indicating sequence breaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks.opts</code></td>
<td>
<p>Options passed to <code>enve.recplot2.findPeaks</code>,
if <code>peaks.col</code> is not <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any other graphic parameters (currently ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of <code>enve.RecPlot2.Peak</code> objects (see
<code>enve.recplot2.findPeaks</code>). If <code>peaks.col=NA</code> or
<code>layout</code> doesn't include 4, returns <code>NA</code>.
</p>


<h3>Author(s)</h3>

<p>Luis M. Rodriguez-R [aut, cre]
</p>


</div>