<div class="container">

<table style="width: 100%;"><tr>
<td>qqPlotGestalt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Develop Gestalt of Q-Q Plots for Specific Distributions
</h2>

<h3>Description</h3>

<p>Produce a series of quantile-quantile (Q-Q) plots (also called probability plots) 
or Tukey mean-difference Q-Q plots for a user-specified distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  qqPlotGestalt(distribution = "norm", param.list = list(mean = 0, sd = 1), 
    estimate.params = FALSE, est.arg.list = NULL, sample.size = 10, num.pages = 2, 
    num.plots.per.page = 4, nrow = ceiling(num.plots.per.page/2), plot.type = "Q-Q", 
    plot.pos.con = switch(dist.abb, norm = , lnorm = , lnormAlt = , lnorm3 = 0.375, 
      evd = 0.44, 0.4), equal.axes = (qq.line.type == "0-1" || estimate.params), 
    margin.title = NULL, add.line = FALSE, qq.line.type = "least squares", 
    duplicate.points.method = "standard", points.col = 1, line.col = 1, 
    line.lwd = par("cex"), line.lty = 1, digits = .Options$digits, 
    same.window = TRUE, ask = same.window &amp; num.pages &gt; 1, 
    mfrow = c(nrow, num.plots.per.page/nrow), 
    mar = c(4, 4, 1, 1) + 0.1, oma = c(0, 0, 7, 0), mgp = c(2, 0.5, 0), ..., 
    main = NULL, xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>

<p>a character string denoting the distribution abbreviation.  The default value is 
<code>distribution="norm"</code>.  See the help file for <code>Distribution.df</code> for a 
list of possible distribution abbreviations.  This argument is ignored if <code>y</code> 
is supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.list</code></td>
<td>

<p>a list with values for the parameters of the distribution.  The default value is 
<code>param.list=list(mean=0, sd=1)</code>.  See the help file for <code>Distribution.df</code> 
for the names and possible values of the parameters associated with each distribution.  
This argument is ignored if <code>estimate.params=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate.params</code></td>
<td>

<p>a logical scalar indicating whether to compute quantiles based on estimating the 
distribution parameters (<code>estimate.params=TRUE</code>) or using the known 
distribution parameters specified in <code>param.list</code> (<code>estimate.params=FALSE</code>, 
the default).  The default value of <code>estimate.params</code> 
is <code>FALSE</code> because the default configuration is to generate random numbers 
from a standard normal (mean=0, sd=1) distribution and produce a standard 
normal Q-Q plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.arg.list</code></td>
<td>

<p>a list whose components are optional arguments associated with the function used 
to estimate the parameters of the assumed distribution (see the help file 
Estimating Distribution Parameters).  
For example, all functions used to estimate distribution parameters have an optional argument 
called <code>method</code> that specifies the method to use to estimate the parameters.  
(See the help file for <code>Distribution.df</code> for a list of available estimation 
methods for each distribution.)  To override the default estimation method, supply the argument <br><code>est.arg.list</code> with a component called <code>method</code>; for example <br><code>est.arg.list=list(method="mle")</code>.  The default value is 
<code>est.arg.list=NULL</code> so that all default values for the estimating function are used.  
This argument is ignored if <code>estimate.params=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>

<p>numeric scalar indicating the number of observations to generate for each Q-Q plot.  
The default value is <code>sample.size=10</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.pages</code></td>
<td>

<p>numeric scalar indicating the number of pages of plots to generate.  
The default value is <code>num.pages=2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.plots.per.page</code></td>
<td>

<p>numeric scalar indicating the number of plots per page.  
The default value is <code>num.pages=4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>

<p>numeric scalar indicating the number of rows of plots on each page.  
The default value is the smallest integer greater than or equal to 
<code>num.plots.per.page/2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>a character string denoting the kind of plot.  Possible values are <code>"Q-Q"</code> 
(Quantile-Quantile plot, the default) and <code>"Tukey Mean-Difference Q-Q"</code> 
(Tukey mean-difference Q-Q plot).  This argument may be abbreviated (e.g., 
<code>plot.type="T"</code> to indicate a Tukey mean-difference Q-Q plot).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pos.con</code></td>
<td>

<p>numeric scalar between 0 and 1 containing the value of the plotting position constant.  
The default value of <code>plot.pos.con</code> depends on the value of the argument 
<code>distribution</code>.  For the normal, lognormal, three-parameter lognormal, 
zero-modified normal, and zero-modified lognormal distributions, the default 
value is <code>plot.pos.con=0.375</code>.  For the Type I extreme value (Gumbel) 
distribution (<code>distribution="evd"</code>), the default value is 
<code>plot.pos.con=0.44</code>.  For all other distributions, the default value is 
<code>plot.pos.con=0.4</code>.  See the help file for <code>qqPlot</code> for the 
motivation behind these values for plotting positions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.axes</code></td>
<td>

<p>logical scalar indicating whether to use the same range on the <code class="reqn">x</code>- and 
<code class="reqn">y</code>-axes when <code>plot.type="Q-Q"</code>.  The default value is <code>TRUE</code> if 
<code>qq.line.type="0-1"</code> or <code>estimate.params=TRUE</code>, otherwise it is 
<code>FALSE</code>.  This argument is ignored if 
<code>plot.type="Tukey Mean-Difference Q-Q"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin.title</code></td>
<td>

<p>character string indicating the title printed in the top margin on each page of 
plots.  The default value indicates the kind of Q-Q plot, the probability 
distribution, the sample size, and the estimation method used (if any).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.line</code></td>
<td>

<p>logical scalar indicating whether to add a line to the plot.  
If <code>add.line=TRUE</code> and <code>plot.type="Q-Q"</code>, a line determined by the 
value of <code>qq.line.type</code> is added to the plot.  
If <code>add.line=TRUE</code> and <br><code>plot.type="Tukey Mean-Difference Q-Q"</code>, a horizontal line at 
<code class="reqn">y=0</code> is added to the plot.  The default value is <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qq.line.type</code></td>
<td>

<p>character string determining what kind of line to add to the Q-Q plot.  
Possible values are <code>"least squares"</code> (the default), <code>"0-1"</code> and 
<code>"robust"</code>.  For the value 
<code>"least squares"</code>, a least squares line is fit and added.  For the value <code>"0-1"</code>, 
a line with intercept 0 and slope 1 is added.  For the value <code>"robust"</code>, a line is fit through 
the first and third quartiles of the <code>x</code> and <code>y</code> data.  
This argument is ignored if 
<code>add.line=FALSE</code> or <code>plot.type="Tukey Mean-Difference Q-Q"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duplicate.points.method</code></td>
<td>

<p>character string denoting how to plot points with duplicate <code class="reqn">(x,y)</code> values.  
Possible values are <code>"standard"</code> (the default), <code>"jitter"</code>, and <code>"number"</code>.  For the value 
<code>"standard"</code>, a single plotting symbol is plotted (this is the default behavior of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>).  
For the value <code>"jitter"</code>, a separate plotting symbol is plotted for each duplicate point, where 
the plotting symbols cluster around the true value of <code class="reqn">x</code> and <code class="reqn">y</code>.  For the value 
<code>"number"</code>, a single number is plotted at <code class="reqn">(x,y)</code> that represents how many duplicate points 
are at that <code class="reqn">(x,y)</code> coordinate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.col</code></td>
<td>

<p>numeric scalar or character string determining the color of the points in the plot.  
The default value is <code>points.col=1</code>.  See the entry for <code>col</code> in the 
help file for <code>par</code> for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>

<p>numeric scalar or character string determining the color of the line in the plot.  
The default value is <code>points.col=1</code>.  See the entry for <code>col</code> in the 
help file for <code>par</code> for more information.  This argument is ignored 
if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lwd</code></td>
<td>

<p>numeric scalar determining the width of the line in the plot.  The default value is 
<code>line.lwd=par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.  This argument is ignored if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the line in the plot.  The default value is 
<code>line.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.  This argument is ignored if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print for the distribution 
parameters.  The default value is <code>digits=.Options$digits</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.window</code></td>
<td>

<p>logical scalar indicating whether to produce all plots in the same graphics 
window (<code>same.window=TRUE</code>; the default), or to create a new graphics 
window for each separate plot (<code>same.window=FALSE</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>

<p>logical scalar supplied to the function <code>devAskNewPage</code>, indicating 
whether to prompt the user before creating a new plot within a single graphics 
window.  The default value is <code>TRUE</code> if <code>same.window=TRUE</code> and 
<code>num.pages &gt; 1</code>, otherwise it is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow, mar, oma, mgp, main, xlab, ylab, xlim, ylim, ...</code></td>
<td>

<p>additional graphical parameters (see <code>par</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>qqPlotGestalt</code> allows the user to display several Q-Q plots or 
Tukey mean-difference Q-Q plots for a specified probability distribution.  
The distribution is specified with the arguments <code>distribution</code> and 
<code>param.list</code>.  By default, normal (Gaussian) 
Q-Q plots are produced.
</p>
<p>If <code>estimate.params=FALSE</code> (the default), the theoretical quantiles on the 
<code class="reqn">x</code>-axis are computed using the known distribution parameters specified in 
<code>param.list</code>.  If <code>estimate.params=TRUE</code>, the distribution parameters 
are estimated based on the sample, and these estimated parameters are then used 
to compute the theoretical quantiles.  For distributions that can be specified 
by a location and scale parameter (e.g., Normal, Logistic, extreme value, etc.), 
the value of <code>estimate.params</code> will not affect the general shape of the 
plot, only the values recorded on the <code class="reqn">x</code>-axis.  For distributions that cannot 
be specified by a location and scale parameter (e.g., exponential, gamma, etc.), it 
is recommended that <code>estimate.params</code> be set to <code>TRUE</code> since in pracitice 
the values of the distribution parameters are not known but must be estimated from 
the sample.
</p>
<p>The purpose of <code>qqPlotGestalt</code> is to allow the user to build-up a visual 
memory of “typical” Q-Q plots.  A Q-Q plot is a graphical tool that allows 
you to assess how well a particular set of observations fit a particular 
probability distribution.  The value of this tool depends on the user having an 
internal reference set of Q-Q plots with which to compare the current Q-Q plot.
</p>
<p>See the help file for <code>qqPlot</code> for more information.
</p>


<h3>Value</h3>

<p>The <code>NULL</code> value is returned.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>See the REFERENCES section for <code>qqPlot</code>.
</p>


<h3>See Also</h3>

<p><code>qqPlot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Look at eight typical normal (Gaussian) Q-Q plots for random samples 
  # of size 10 from a N(0,1) distribution 
  # Are you surprised by the variability in the plots?
  #
  # (Note:  you must use set.seed if you want to reproduce the exact 
  #         same plots more than once.)

  set.seed(298)
  qqPlotGestalt(same.window = FALSE)

  # Add lines to these same Q-Q plots
  #----------------------------------
  set.seed(298)
  qqPlotGestalt(same.window = FALSE, add.line = TRUE)

  # Add lines to different Q-Q plots
  #---------------------------------
  qqPlotGestalt(same.window = FALSE, add.line = TRUE)

  ## Not run: 
  # Look at 4 sets of plots all in the same graphics window
  #--------------------------------------------------------
  qqPlotGestalt(add.line = TRUE, num.pages = 4)
  
## End(Not run)

  #==========

  # Look at Q-Q plots for a gamma distribution
  #-------------------------------------------

  qqPlotGestalt(dist = "gammaAlt", 
    param.list = list(mean = 10, cv = 1), 
    estimate.params = TRUE, num.pages = 3, 
    same.window = FALSE, add.line = TRUE)


  # Look at Tukey Mean Difference Q-Q plots 
  # for a gamma distribution
  #----------------------------------------

  qqPlotGestalt(dist = "gammaAlt", 
    param.list = list(mean = 10, cv = 1), 
    estimate.params = TRUE, num.pages = 3, 
    plot.type = "Tukey", same.window = FALSE, add.line = TRUE)

  #==========

  # Clean up
  #---------
  graphics.off()
</code></pre>


</div>