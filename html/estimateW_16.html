<div class="container">

<table style="width: 100%;"><tr>
<td>sdmw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Markov Chain Monte Carlo (MCMC) sampler for the panel spatial Durbin model (SDM) with unknown spatial weight matrix</h2>

<h3>Description</h3>

<p>The sampler uses independent Normal-inverse-Gamma priors for the slope and variance parameters, as well as a four-parameter
beta prior for the spatial autoregressive parameter <code class="reqn">\rho</code>. It is a wrapper around <code>W_sampler</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sdmw(
  Y,
  tt,
  X = matrix(0, nrow(Y), 0),
  Z = matrix(1, nrow(Y), 1),
  niter = 100,
  nretain = 50,
  W_prior = W_priors(n = nrow(Y)/tt),
  rho_prior = rho_priors(),
  beta_prior = beta_priors(k = ncol(X) * 2 + ncol(Z)),
  sigma_prior = sigma_priors()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>numeric <code class="reqn">N \times 1</code> matrix containing the dependent variables, where <code class="reqn">N = nT</code> is the number of
spatial (<code class="reqn">n</code>) times the number of time observations (<code class="reqn">T</code>, with <code>tt=T</code>). Note that the observations
have organized such that <code class="reqn">Y = [Y_1',...,Y_T']'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>single number greater or equal to 1. Denotes the number of time observations. <code class="reqn">tt = T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>numeric <code class="reqn">N \times k_1</code> design matrix of independent variables. These will be
automatically spatially lagged. If no spatially lagged variable is included in the model
a matrix with <code class="reqn">N</code> rows and zero columns should be supplied (the default value). Note:
either <code class="reqn">X</code> or <code class="reqn">Z</code> has to be a matrix with at least one column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>numeric <code class="reqn">N \times k_3</code> design matrix of independent variables which are not
spatially lagged. The default value is a <code class="reqn">N \times 1</code> vector of ones (i.e. an intercept for the model).
Note: either <code class="reqn">X</code> or <code class="reqn">Z</code> has to be a matrix with at least one column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>single number greater or equal to 1, indicating the total number of draws.
Will be automatically coerced to integer. The default value is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nretain</code></td>
<td>
<p>single number greater or equal to 0, indicating the number of draws
kept after the burn-in. Will be automatically coerced to integer. The default value is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W_prior</code></td>
<td>
<p>list containing prior settings for estimating the spatial weight matrix <code class="reqn">W</code>.
Generated by the smart constructor <code>W_priors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_prior</code></td>
<td>
<p>list of prior settings for estimating <code class="reqn">\rho</code>,
generated by the smart constructor <code>rho_priors</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_prior</code></td>
<td>
<p>list containing priors for the slope coefficients <code class="reqn">\beta</code>,
generated by the smart constructor <code>beta_priors</code>. The ordering of the priors is:
(1) priors of <code class="reqn">X</code>, (2) priors of spatially lagged <code class="reqn">X</code>, (3) priors of <code class="reqn">Z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_prior</code></td>
<td>
<p>list containing priors for the error variance <code class="reqn">\sigma^2</code>,
generated by the smart constructor <code>sigma_priors</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The considered panel spatial Durbin model (SDM) with unknown (<code class="reqn">n</code> by <code class="reqn">n</code>) spatial weight
matrix <code class="reqn">W</code> takes the form:
</p>
<p style="text-align: center;"><code class="reqn">
 Y_t = \rho W Y_t + X_t \beta_1 + W X_t \beta_2 + Z \beta_3 + \varepsilon_t,
 </code>
</p>

<p>with <code class="reqn">\varepsilon_t \sim N(0,I_n \sigma^2)</code> and <code class="reqn">W = f(\Omega)</code>. The <code class="reqn">n</code> by <code class="reqn">n</code>
matrix <code class="reqn">\Omega</code> is an unknown binary adjacency matrix with zeros on the main diagonal and
<code class="reqn">f(\cdot)</code> is the (optional) row-standardization function. <code class="reqn">\rho</code> is a scalar spatial autoregressive parameter.
</p>
<p><code class="reqn">Y_t</code> (<code class="reqn">n \times 1</code>) collects the <code class="reqn">n</code> cross-sectional (spatial) observations for time
<code class="reqn">t=1,...,T</code>. <code class="reqn">X_t</code> (<code class="reqn">n \times k_1</code>) and <code class="reqn">Z_t</code> (<code class="reqn">n \times k_2</code>) are
matrices of explanatory variables, where the former will also be spatially lagged. <code class="reqn">\beta_1</code>
(<code class="reqn">k_1 \times 1</code>), <code class="reqn">\beta_2</code> (<code class="reqn">k_1 \times 1</code>) and <code class="reqn">\beta_3</code> (<code class="reqn">k_2 \times 1</code>)
are unknown slope parameter vectors.
</p>
<p>After vertically staking the <code class="reqn">T</code> cross-sections  <code class="reqn">Y=[Y_1',...,Y_T']'</code> (<code class="reqn">N \times 1</code>),
<code class="reqn">X=[X_1',...,X_T']'</code> (<code class="reqn">N \times k_1</code>) and <code class="reqn">Z=[Z_1', ..., Z_T']'</code> (<code class="reqn">N \times k_2</code>),
with <code class="reqn">N=nT</code>. The final model can be expressed as:
</p>
<p style="text-align: center;"><code class="reqn">
 Y = \rho \tilde{W}Y + X \beta_1 + \tilde{W} X \beta_2 + Z \beta_3 + \varepsilon,
</code>
</p>

<p>where <code class="reqn">\tilde{W}=I_T \otimes W</code> and <code class="reqn">\varepsilon \sim N(0,I_N \sigma^2)</code>. Note that the input
data matrices have to be ordered first by the cross-sectional spatial units and then stacked by time.
</p>
<p>Estimation usually even works well in cases of <code class="reqn">n &gt;&gt; T</code>. However, note that for applications with <code class="reqn">n &gt; 200</code> the
estimation process becomes computationally demanding and slow. Consider in this case reducing <code>niter</code> and
<code>nretain</code> and carefully check whether the posterior chains have converged.
</p>


<h3>Value</h3>

<p>List with posterior samples for the slope parameters, <code class="reqn">\rho</code>, <code class="reqn">\sigma^2</code>, <code class="reqn">W</code>,
and average direct, indirect, and total effects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 20; tt = 10
dgp_dat = sim_dgp(n =n, tt = tt, rho = .75, beta1 = c(.5,1),beta2 = c(-1,.5),
            beta3 = c(1.5), sigma2 = .05,n_neighbor = 3,intercept = TRUE)
res = sdmw(Y = dgp_dat$Y,tt = tt,X = dgp_dat$X,Z = dgp_dat$Z,niter = 20,nretain = 10)
</code></pre>


</div>