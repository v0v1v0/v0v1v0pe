<div class="container">

<table style="width: 100%;"><tr>
<td>metropSB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metropolis-Szymura-Barton algorithm</h2>

<h3>Description</h3>

<p>Stochastic global optimization using the Metropolis-Szymura-Barton
algorithm. New parameters are chosen from a uniform candidate
distribution with an adaptively tuned scale, and accepted or rejected
according to a Metropolis rule.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metropSB(fn, start, deltap = NULL, scale = 1, rptfreq = -1, acceptscale
= 1.01, rejectscale = 0.99, nmax = 10000,
retvals = FALSE, retfreq = 100, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>Objective function, taking a vector of parameters as its
first argument.  The function is minimized, so it should be a
negative log-likelihood or a negative log-posterior density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Vector of starting values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltap</code></td>
<td>
<p>Starting jump size; half-width of uniform distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scaling factor for acceptance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rptfreq</code></td>
<td>
<p>Frequency for reporting interim results (&lt;0 means no reporting)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acceptscale</code></td>
<td>
<p>Amount to inflate candidate distribution if last
jump was accepted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rejectscale</code></td>
<td>
<p>Amount to shrink candidate distribution if last
jump was rejected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retvals</code></td>
<td>
<p>Return detailed statistics?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retfreq</code></td>
<td>
<p>Sampling frequency for detailed statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print status?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to <code>fn</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Metropolis-Szymura-Barton algorithm: given function and starting value, try to find
parameters that minimize the function
Algorithm: at a given step,
1. pick a new set of parameters, each of which is uniformly distributed
in (p[i]-deltap[i],p[i]+deltap[i])
2. calculate function value at new parameter values
3. if f(new)&lt;f(old), accept
4. if f(new)&gt;f(old), accept with probability (exp(-scale*(f(new)-f(old)))
5. if accept, increase all deltap values by acceptscale; if reject, decrease by rejectscale
6. if better than min so far, save function and parameter values
7. if reject, restore old values
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p>minimum value achieved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>parameters corresponding to minimum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funcalls</code></td>
<td>
<p>number of function evaluations</p>
</td>
</tr>
</table>
<p>If <code>retvals=TRUE</code>:
</p>
<table><tr style="vertical-align: top;">
<td><code>retvals</code></td>
<td>
<p>matrix of periodic samples including parameters,
jump scale, current value, and minimum achieved value</p>
</td>
</tr></table>
<h3>Note</h3>

<p>  If <code>scale=1</code> the algorithm satisfies MCMC rules, provided
that the other properties of the MC (irreducibility and aperiodicity)
are satisfied.</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>References</h3>

<p>Szymura and Barton (1986) Genetic analysis of a hybrid zone
between the fire-bellied toads,Bombina bombina and B. variegata, near
Cracow in southern Poland. Evolution 40(6):1141-1159.
</p>


<h3>See Also</h3>

<p><code>optim</code>, <code>MCMCmetrop1R</code> (<code>MCMCpack</code> package)</p>


</div>