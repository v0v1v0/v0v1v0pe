<div class="container">

<table style="width: 100%;"><tr>
<td>semd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical Empirical Mode Decomposition</h2>

<h3>Description</h3>

<p>This function performs empirical mode decomposition using spline smoothing not interpolation for sifting process.
The smoothing parameter is automatically detemined by cross-validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semd(xt, tt=NULL, cv.kfold, cv.tol=0.1^1, cv.maxiter=20, 
    emd.tol=sd(xt)*0.1^2, max.sift=20, stoprule="type1", boundary="periodic", 
    smlevels=1, max.imf=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xt</code></td>
<td>
<p>observation or signal observed at time <code>tt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>observation index or time index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.kfold</code></td>
<td>
<p>the number of fold of cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.tol</code></td>
<td>
<p>tolerance for cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.maxiter</code></td>
<td>
<p>maximum iteration for cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emd.tol</code></td>
<td>
<p>tolerance for stopping rule of sifting. If <code>stoprule=type5</code>, the number of iteration for S stoppage criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sift</code></td>
<td>
<p>the maximum number of sifting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stoprule</code></td>
<td>
<p>stopping rule of sifting. The <code>type1</code> stopping rule indicates that absolute values of envelope mean must be less than the user-specified tolerance level 
in the sense that the local average of upper and lower envelope is zero.
The stopping rules <code>type2</code>, <code>type3</code>, <code>type4</code> and <code>type5</code> are the stopping rules given by equation (5.5) of Huang et al. (1998), equation (11a), 
equation (11b) and S stoppage of Huang and Wu (2008), respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>specifies boundary condition from “none", “wave", “symmetric", “periodic" or “evenodd". See Zeng and He (2004) for <code>evenodd</code> boundary condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smlevels</code></td>
<td>
<p>specifies which level of the IMF is obtained by smoothing spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.imf</code></td>
<td>
<p>the maximum number of IMF's</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs empirical mode decomposition using spline smoothing not interpolation for sifting process.
The smoothing parameter is automatically detemined by cross-validation.
Optimization is done by golden section search. See Kim et al. (2012) for details.
</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>imf</code></td>
<td>
<p>IMF's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residue</code></td>
<td>
<p>residue signal after extracting IMF's from observations <code>xt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nimf</code></td>
<td>
<p>the number of IMF's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optlambda</code></td>
<td>
<p>smoothing parameter minimizing prediction errors of cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaconv</code></td>
<td>
<p>a sequence of smoothing parameters for searching optimal smoothing papameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perr</code></td>
<td>
<p>prediction errors of cross-validation according to <code>lambdaconv</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Huang, N. E., Shen, Z., Long, S. R., Wu, M. L. Shih, H. H.,
Zheng, Q., Yen, N. C., Tung, C. C. and Liu, H. H. (1998) The empirical
mode decomposition and Hilbert spectrum for nonlinear and
nonstationary time series analysis. <em>Proceedings of the Royal
Society London A</em>, <b>454</b>, 903–995.
</p>
<p>Huang, N. E. and Wu, Z. (2008) A review on Hilbert-Huang Transform: Method and its applications to geophysical studies.
<em>Reviews of Geophysics</em>, <b>46</b>, RG2006.
</p>
<p>Kim, D., Kim, K.-O. and Oh, H.-S. (2012) Extending the Scope of Empirical Mode Decomposition using Smoothing.
<em>EURASIP Journal on Advances in Signal Processing</em>, <b>2012:168</b>, doi: 10.1186/1687-6180-2012-168.
</p>
<p>Zeng, K and He, M.-X. (2004) A simple boundary process technique for empirical mode decomposition.
<em>Proceedings of 2004 IEEE International Geoscience and Remote Sensing Symposium</em>, <b>6</b>, 4258–4261.
</p>


<h3>See Also</h3>

<p><code>extractimf</code>, <code>emd</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ndata &lt;- 2048
tt &lt;- seq(0, 9, length=ndata)                 
xt &lt;- sin(pi * tt) + sin(2* pi * tt) + sin(6 * pi * tt)  + 0.5 * tt 
set.seed(1)
xt &lt;- xt + rnorm(ndata, 0, sd(xt)/5)

## Not run: 
### Empirical Mode Decomposition by Interpolation
emdbyint &lt;- emd(xt, tt, max.imf = 5, boundary = "wave")
### Empirical Mode Decomposition by Smoothing
emdbysm &lt;- semd(xt, tt, cv.kfold=4, boundary="wave", smlevels=1, max.imf=5)

par(mfcol=c(6,2), mar=c(2,2,2,1), oma=c(0,0,2,0))                              
rangext &lt;- range(xt); rangeimf &lt;- rangext - mean(rangext)
plot(tt, xt, xlab="", ylab="", main="signal", ylim=rangext, type="l")
mtext("Decomposition by EMD", side = 3, line = 2, cex=0.85, font=2)
plot(tt, emdbyint$imf[,1], xlab="", ylab="", main="imf 1", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbyint$imf[,2], xlab="", ylab="", main="imf 2", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbyint$imf[,3], xlab="", ylab="", main="imf 3", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbyint$imf[,4], xlab="", ylab="", main="imf 4", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbyint$imf[,5]+emdbyint$residue, xlab="", ylab="", main="remaining signal",
    ylim=rangext, type="l")

plot(tt, xt, xlab="", ylab="", main="signal", ylim=rangext, type="l")
mtext("Decomposition by SEMD", side = 3, line = 2, cex=0.85, font=2)
plot(tt, emdbysm$imf[,1], xlab="", ylab="", main="noise", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbysm$imf[,2], xlab="", ylab="", main="imf 1", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbysm$imf[,3], xlab="", ylab="", main="imf 2", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbysm$imf[,4], xlab="", ylab="", main="imf 3", ylim=rangeimf,  type="l")
abline(h=0, lty=2)
plot(tt, emdbysm$residue, xlab="", ylab="", main="residue", ylim=rangext, type="l")
## End(Not run)
</code></pre>


</div>