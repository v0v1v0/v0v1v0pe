<div class="container">

<table style="width: 100%;"><tr>
<td>Empirical</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Empirical Distribution Based on a Set of Observations
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and random generation for 
the empirical distribution based on a set of observations
</p>


<h3>Usage</h3>

<pre><code class="language-R">  demp(x, obs, discrete = FALSE, density.arg.list = NULL)
  pemp(q, obs, discrete = FALSE, 
    prob.method = ifelse(discrete, "emp.probs", "plot.pos"), 
    plot.pos.con = 0.375) 
  qemp(p, obs, discrete = FALSE, 
    prob.method = ifelse(discrete, "emp.probs", "plot.pos"), 
    plot.pos.con = 0.375)
  remp(n, obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>sample size.  If <code>length(n)</code> is larger than 1, then <code>length(n)</code> 
random values are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>

<p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and 
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>

<p>logical scalar indicating whether the assumed parent distribution of <code>x</code> is 
discrete (<code>discrete=TRUE</code>) or continuous (<code>discrete=FALSE</code>).  The 
default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.arg.list</code></td>
<td>

<p>list with arguments to the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>density</code> function.  The default value is 
<code>NULL</code>.  (See the help file for <code>density</code> 
for more information on the arguments to density.)  The argument 
<code>density.arg.list</code> is ignored if <code>discrete=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.method</code></td>
<td>

<p>character string indicating what method to use to compute the empirical 
probabilities.  Possible values are <code>"emp.probs"</code> (empirical probabilities, 
default if <code>discrete=TRUE</code>) and <code>"plot.pos"</code> (plotting positions, 
default if <code>discrete=FALSE</code>).  See the DETAILS section for more explanation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pos.con</code></td>
<td>

<p>numeric scalar between 0 and 1 containing the value of the plotting position 
constant.  The default value is <code>plot.pos.con=0.375</code>.  See the DETAILS 
section for more information. This argument is ignored if 
<code>prob.method="emp.probs"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">x_1, x_2, \ldots, x_n</code> denote a random sample of n observations 
from some unknown probability distribution (i.e., the elements of the argument 
<code>obs</code>), and let <code class="reqn">x_{(i)}</code> denote the <code class="reqn">i^{th}</code> order statistic, that is, 
the <code class="reqn">i^{th}</code> largest observation, for <code class="reqn">i = 1, 2, \ldots, n</code>.
</p>
<p><em>Estimating Density</em> <br>
The function <code>demp</code> computes the empirical probability density function.  If 
the observations are assumed to come from a discrete distribution, the probability 
density (mass) function is estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{f}(x) = \widehat{Pr}(X = x) = \frac{\sum^n_{i=1} I_{[x]}(x_i)}{n}</code>
</p>

<p>where <code class="reqn">I</code> is the indicator function: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">I_{[x]}(y) =</code> </td>
<td style="text-align: left;"> <code class="reqn">1</code> </td>
<td style="text-align: left;"> if <code class="reqn">y = x</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                       </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> if <code class="reqn">y \ne x</code> 
  </td>
</tr>
</table>
<p>That is, the estimated probability of observing the value <code class="reqn">x</code> is simply the 
observed proportion of observations equal to <code class="reqn">x</code>.
</p>
<p>If the observations are assumed to come from a continuous distribution, the 
function <code>demp</code> calls the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>density</code> to compute the 
estimated density based on the values specified in the argument <code>obs</code>, 
and then uses linear interpolation to estimate the density at the values 
specified in the argument <code>x</code>.  See the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> help file for 
<code>density</code> for more information on how the empirical density is 
computed in the continuous case.
</p>
<p><em>Estimating Probabilities</em> <br>
The function <code>pemp</code> computes the estimated cumulative distribution function 
(cdf), also called the empirical cdf (ecdf).  If the observations are assumed to 
come from a discrete distribution, the value of the cdf evaluated at the <code class="reqn">i^{th}</code> 
order statistic is usually estimated by: 
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \widehat{Pr}(X \le x_{(i)}) = \hat{p}_i = 
    \frac{\sum^n_{j=1} I_{(-\infty, x_{(i)}]}(x_j)}{n}</code>
</p>

<p>where: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">I_{(-\infty, x]}(y) =</code> </td>
<td style="text-align: left;"> <code class="reqn">1</code> </td>
<td style="text-align: left;"> if <code class="reqn">y \le x</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                                </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: left;"> if <code class="reqn">y &gt; x</code> 
  </td>
</tr>
</table>
<p>(D'Agostino, 1986a).  That is, the estimated value of the cdf at the <code class="reqn">i^{th}</code> 
order statistic is simply the observed proportion of observations less than or 
equal to the <code class="reqn">i^{th}</code> order statistic.  This estimator is sometimes called the 
“empirical probabilities” estimator and is intuitively appealing.  
The function <code>pemp</code> uses the above equations to compute the empirical cdf when 
<code>prob.method="emp.probs"</code>.
</p>
<p>For any general value of <code class="reqn">x</code>, when the observations are assumed to come from a 
discrete distribution, the value of the cdf is estimated by:  
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{F}(x) =</code> </td>
<td style="text-align: left;"> <code class="reqn">0</code>         </td>
<td style="text-align: left;"> if <code class="reqn">x &lt; x_{(1)}</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                       </td>
<td style="text-align: left;"> <code class="reqn">\hat{p}_i</code> </td>
<td style="text-align: left;"> if <code class="reqn">x_{(i)} \le x &lt; x_{(i+1)}</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                       </td>
<td style="text-align: left;"> <code class="reqn">1</code>         </td>
<td style="text-align: left;"> if <code class="reqn">x \ge x_{(n)}</code> 
  </td>
</tr>
</table>
<p>The function <code>pemp</code> uses the above equation when <code>discrete=TRUE</code>.
</p>
<p>If the observations are assumed to come from a continuous distribution, the value 
of the cdf evaluated at the <code class="reqn">i^{th}</code> order statistic is usually estimated by: 
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \hat{p}_i = \frac{i - a}{n - 2a + 1}</code>
</p>

<p>where <code class="reqn">a</code> denotes the plotting position constant and <code class="reqn">0 \le a \le 1</code> 
(Cleveland, 1993, p.18; D'Agostino, 1986a, pp.8,25).  The estimators defined by 
the above equation are called <em>plotting positions</em> and are used to construct 
probability plots.  The function <code>pemp</code> uses the above equation 
when <br><code>prob.method="plot.pos"</code>.
</p>
<p>For any general value of <code class="reqn">x</code>, the value of the cdf is estimated by linear 
interpolation: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{F}(x) =</code> </td>
<td style="text-align: left;"> <code class="reqn">\hat{p}_1</code> </td>
<td style="text-align: left;"> if <code class="reqn">x &lt; x_{(1)}</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                       </td>
<td style="text-align: left;"> <code class="reqn">(1 - r)\hat{p}_i + r\hat{p}_{i+1}</code> </td>
<td style="text-align: left;"> if <code class="reqn">x_{(i)} \le x &lt; x_{(i+1)}</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                       </td>
<td style="text-align: left;"> <code class="reqn">\hat{p}_n</code> </td>
<td style="text-align: left;"> if <code class="reqn">x \ge x_{(n)}</code> 
  </td>
</tr>
</table>
<p>where
</p>
<p style="text-align: center;"><code class="reqn">r = \frac{x - x_{(i)}}{x_{(i+1)} - x_{(i)}}</code>
</p>

<p>(Chambers et al., 1983).  The function <code>pemp</code> uses the above two equations 
when <code>discrete=FALSE</code>.
</p>
<p><em>Estimating Quantiles</em> <br>
The function <code>qemp</code> computes the estimated quantiles based on the observed 
data.  If the observations are assumed to come from a discrete distribution, the 
<code class="reqn">p^{th}</code> quantile is usually estimated by: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{x}_p =</code> </td>
<td style="text-align: left;"> <code class="reqn">x_{(1)}</code> </td>
<td style="text-align: left;"> if <code class="reqn">p \le \hat{p}_1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                      </td>
<td style="text-align: left;"> <code class="reqn">x_{(i)}</code> </td>
<td style="text-align: left;"> if <code class="reqn">\hat{p}_{i-1} &lt; p \le \hat{p}_i</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                      </td>
<td style="text-align: left;"> <code class="reqn">x_n</code>     </td>
<td style="text-align: left;"> if <code class="reqn">p &gt; \hat{p}_n</code> 
  </td>
</tr>
</table>
<p>The function <code>qemp</code> uses the above equation when <code>discrete=TRUE</code>.
</p>
<p>If the observations are assumed to come from a continuous distribution, the 
<code class="reqn">p^{th}</code> quantile is usually estimated by linear interpolation: 
</p>

<table>
<tr>
<td style="text-align: left;">
    <code class="reqn">\hat{x}_p =</code> </td>
<td style="text-align: left;"> <code class="reqn">x_{(1)}</code> </td>
<td style="text-align: left;"> if <code class="reqn">p \le \hat{p}_1</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                      </td>
<td style="text-align: left;"> <code class="reqn">(1 - r)x_{(i-1)} + rx_{(i)}</code> </td>
<td style="text-align: left;"> if <code class="reqn">\hat{p}_{i-1} &lt; p \le \hat{p}_i</code>, </td>
</tr>
<tr>
<td style="text-align: left;">
                      </td>
<td style="text-align: left;"> <code class="reqn">x_n</code> </td>
<td style="text-align: left;"> if <code class="reqn">p &gt; \hat{p}_n</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>where
</p>
<p style="text-align: center;"><code class="reqn">r = \frac{p - \hat{p}_{i-1}}{\hat{p}_i - \hat{p}_{i-1}}</code>
</p>

<p>The function <code>qemp</code> uses the above two equations when <code>discrete=FALSE</code>.
</p>
<p><em>Generating Random Numbers From the Empirical Distribution</em> <br>
The function <code>remp</code> simply calls the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>sample</code> to 
sample the elements of <code>obs</code> with replacement.
</p>


<h3>Value</h3>

<p>density (<code>demp</code>), probability (<code>pemp</code>), quantile (<code>qemp</code>), or 
random sample (<code>remp</code>) for the empirical distribution based on the data 
contained in the vector <code>obs</code>.
</p>


<h3>Note</h3>

<p>The function <code>demp</code> let's you perform nonparametric density estimation.  
The function <code>pemp</code> computes the value of the empirical cumulative 
distribution function (ecdf) for user-specified quantiles.  The ecdf is a 
nonparametric estimate of the true cdf (see <code>ecdfPlot</code>).  The 
function <code>qemp</code> computes nonparametric estimates of quantiles 
(see the help files for <code>eqnpar</code> and <code>quantile</code>).  
The function <code>remp</code> let's you sample a set of observations with replacement, 
which is often done while bootstrapping or performing some other kind of 
Monte Carlo simulation.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J.M., W.S. Cleveland, B. Kleiner, and P.A. Tukey. (1983).  
<em>Graphical Methods for Data Analysis</em>.  Duxbury Press, Boston, MA, 
pp.11–16.
</p>
<p>Cleveland, W.S. (1993).  <em>Visualizing Data</em>.  Hobart Press, Summit, 
New Jersey, 360pp.
</p>
<p>D'Agostino, R.B. (1986a).  Graphical Analysis.  
In: D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>. 
Marcel Dekker, New York, Chapter 2, pp.7–62.
</p>
<p>Scott, D. W. (1992).  
<em>Multivariate Density Estimation:  Theory, Practice and Visualization</em>.  
John Wiley and Sons, New York. 
</p>
<p>Sheather, S. J. and Jones M. C. (1991).  A Reliable Data-Based Bandwidth Selection 
Method for Kernel Density Estimation.  
<em>Journal of the Royal Statististical Society B</em>, 683–690. 
</p>
<p>Silverman, B.W. (1986).  <em>Density Estimation for Statistics and Data Analysis</em>.  
Chapman and Hall, London.
</p>
<p>Wegman, E.J. (1972).  Nonparametric Probability Density Estimation.  
<em>Technometrics</em> <b>14</b>, 533-546.
</p>


<h3>See Also</h3>

<p><code>density</code>, <code>approx</code>, <code>epdfPlot</code>, 
<code>ecdfPlot</code>, <code>cdfCompare</code>, <code>qqplot</code>, 
<code>eqnpar</code>, <code>quantile</code>, <code>sample</code>, <br><code>simulateVector</code>, <code>simulateMvMatrix</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Create a set of 100 observations from a gamma distribution with 
  # parameters shape=4 and scale=5. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(3) 
  obs &lt;- rgamma(100, shape=4, scale=5)

  # Now plot the empirical distribution (with a histogram) and the true distribution:

  dev.new()
  hist(obs, col = "cyan", xlim = c(0, 65), freq = FALSE, 
    ylab = "Relative Frequency") 

  pdfPlot('gamma', list(shape = 4, scale = 5), add = TRUE) 

  box()

  # Now plot the empirical distribution (based on demp) with the 
  # true distribution:

  x &lt;- qemp(p = seq(0, 1, len = 100), obs = obs) 
  y &lt;- demp(x, obs) 

  dev.new()
  plot(x, y, xlim = c(0, 65), type = "n", 
    xlab = "Value of Random Variable", 
    ylab = "Relative Frequency") 
  lines(x, y, lwd = 2, col = "cyan") 

  pdfPlot('gamma', list(shape = 4, scale = 5), add = TRUE)

  # Alternatively, you can create the above plot with the function 
  # epdfPlot:

  dev.new()
  epdfPlot(obs, xlim = c(0, 65), epdf.col = "cyan", 
    xlab = "Value of Random Variable", 
    main = "Empirical and Theoretical PDFs")

  pdfPlot('gamma', list(shape = 4, scale = 5), add = TRUE)

  


  # Clean Up
  #---------
  rm(obs, x, y)

</code></pre>


</div>