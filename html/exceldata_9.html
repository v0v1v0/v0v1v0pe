<div class="container">

<table style="width: 100%;"><tr>
<td>importExcelData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import Excel Data based on the specifications in a data dictionary</h2>

<h3>Description</h3>

<p>This function reads in a data dictionary and data entry table and converts
code and category variables to factors as outlined in the dictionary. See the
examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">importExcelData(
  excelFile,
  dictionarySheet = "DataDictionary",
  dataSheet = "DataEntry",
  id,
  saveWarnings = TRUE,
  setErrorsMissing = TRUE,
  use_labels = TRUE,
  range,
  colnames,
  origin,
  timeUnit = "month"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>excelFile</code></td>
<td>
<p>path and filename of the data file containing the data and
dictionary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dictionarySheet</code></td>
<td>
<p>name of the sheet containing the data dictionary,
defaults to 'DataDictionary'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataSheet</code></td>
<td>
<p>name of the data entry sheet within the file, defaults to
'DataEntry'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>String indicating the ID variable, to display errors by ID instead
of row number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveWarnings</code></td>
<td>
<p>Boolean, if TRUE and there are any warnings then the
function will return a list with the data frame and the import warnings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setErrorsMissing</code></td>
<td>
<p>Boolean, if TRUE all values out of range will be set
to NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_labels</code></td>
<td>
<p>should variable descriptions be added as variable label
attributes, default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>Optional, Range of Excel sheet to restrict import to (ie.
range="A1:F6")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnames</code></td>
<td>
<p>Optional, Column names of the dictionary, defaults to those
used in the Excel template: c('VariableName', 'Description (optional)',
'Type', 'Minimum', 'Maximum', 'Levels')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>Optional, the date origin of Excel dates, defaults to 30
December 1899</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeUnit</code></td>
<td>
<p>Character specifying the unit of time that should be used
when creating survival type variables. Allowed values are from lubridate
(ex: 'day' 'week' 'month' 'year')</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The exceldata package was designed around the DataDictionary.xlsm template.
More documentation and the current downloadable template can be found at:
</p>
<p>https://github.com/biostatsPMH/exceldata#readme
Note that as of release 0.1.1.1 the log file will give row numbers
corresponding to the row number in Excel, as opposed to the row number in the
data frame
</p>
<p>Warning: If SetErrorsMissing = TRUE then a subsequent call to checkData will
not return any errors, because the errors have already been set to missing.
</p>
<p>NOTE: This function will only read in those columns present in the
DataDictionary
</p>


<h3>Value</h3>

<p>A list containing two data frames: the data dictionary and the data
table
</p>

<ul>
<li>
<p> dictionary - A data frame with entries for each variable
</p>
</li>
<li>
<p> data - A data frame containing the imported data
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">exampleDataFile &lt;- system.file("extdata", "exampleData.xlsx", package = "exceldata")
import &lt;- importExcelData(exampleDataFile,
dictionarySheet = 'DataDictionary',dataSheet = 'DataEntry')

# The imported data dictionary
dictionary &lt;- import$dictionary
head(dictionary)

# The imported data, with calculated variables
data &lt;- import$data
head(data)

# Simple univariate plots with outliers
plots &lt;- plotVariables(data=data,dictionary=dictionary,IDvar = 'ID')

</code></pre>


</div>