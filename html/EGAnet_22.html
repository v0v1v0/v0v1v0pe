<div class="container">

<table style="width: 100%;"><tr>
<td>EBICglasso.qgraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>EBICglasso</code> from <code>qgraph</code> 1.4.4</h2>

<h3>Description</h3>

<p>This function uses the <code>glasso</code> package
(Friedman, Hastie and Tibshirani, 2011) to compute a
sparse gaussian graphical model with the graphical lasso
(Friedman, Hastie &amp; Tibshirani, 2008).
The tuning parameter is chosen using the Extended Bayesian Information criterion
(EBIC) described by Foygel &amp; Drton (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">EBICglasso.qgraph(
  data,
  n = NULL,
  corr = c("auto", "cor_auto", "cosine", "pearson", "spearman"),
  na.data = c("pairwise", "listwise"),
  gamma = 0.5,
  penalize.diagonal = FALSE,
  nlambda = 100,
  lambda.min.ratio = 0.1,
  returnAllResults = FALSE,
  penalizeMatrix,
  countDiagonal = FALSE,
  refit = FALSE,
  model.selection = c("EBIC", "JSD"),
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Matrix or data frame.
Should consist only of variables to be used in the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Numeric (length = 1).
Sample size if <code>data</code> provided is a correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>Character (length = 1).
Method to compute correlations.
Defaults to <code>"auto"</code>.
Available options:
</p>

<ul>
<li> <p><code>"auto"</code> — Automatically computes appropriate correlations for
the data using Pearson's for continuous, polychoric for ordinal,
tetrachoric for binary, and polyserial/biserial for ordinal/binary with
continuous. To change the number of categories that are considered
ordinal, use <code>ordinal.categories</code>
(see <code>polychoric.matrix</code> for more details)
</p>
</li>
<li> <p><code>"cor_auto"</code> — Uses <code>cor_auto</code> to compute correlations.
Arguments can be passed along to the function
</p>
</li>
<li> <p><code>"cosine"</code> — Uses <code>cosine</code> to compute cosine similarity
</p>
</li>
<li> <p><code>"pearson"</code> — Pearson's correlation is computed for all
variables regardless of categories
</p>
</li>
<li> <p><code>"spearman"</code> — Spearman's rank-order correlation is computed
for all variables regardless of categories
</p>
</li>
</ul>
<p>For other similarity measures, compute them first and input them
into <code>data</code> with the sample size (<code>n</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.data</code></td>
<td>
<p>Character (length = 1).
How should missing data be handled?
Defaults to <code>"pairwise"</code>.
Available options:
</p>

<ul>
<li> <p><code>"pairwise"</code> — Computes correlation for all available
cases between two variables
</p>
</li>
<li> <p><code>"listwise"</code> — Computes correlation for all complete
cases in the dataset
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric (length = 1)
EBIC tuning parameter.
Defaults to <code>0.50</code> and is generally a good choice.
Setting to <code>0</code> will cause regular BIC to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.diagonal</code></td>
<td>
<p>Boolean (length = 1).
Should the diagonal be penalized?
Defaults to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>Numeric (length = 1).
Number of lambda values to test.
Defaults to <code>100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.min.ratio</code></td>
<td>
<p>Numeric (length = 1).
Ratio of lowest lambda value compared to maximal lambda.
Defaults to <code>0.1</code>.
<strong>NOTE</strong> <code>qgraph</code> sets the default to <code>0.01</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnAllResults</code></td>
<td>
<p>Boolean (length = 1).
Whether all results should be returned.
Defaults to <code>FALSE</code> (network only).
Set to <code>TRUE</code> to access <code>glassopath</code> output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalizeMatrix</code></td>
<td>
<p>Boolean matrix.
Optional logical matrix to indicate which elements are penalized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>countDiagonal</code></td>
<td>
<p>Boolean (length = 1).
Should diagonal be counted in EBIC computation?
Defaults to <code>FALSE</code>.
Set to <code>TRUE</code> to mimic <code>qgraph</code> &lt; 1.3 behavior (not recommended!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit</code></td>
<td>
<p>Boolean (length = 1).
Should the optimal graph be refitted without LASSO regularization?
Defaults to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.selection</code></td>
<td>
<p>Character (length = 1).
How lambda should be selected within GLASSO.
Defaults to <code>"EBIC"</code>.
<code>"JSD"</code> is experimental and should not be used otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean (length = 1).
Whether messages and (insignificant) warnings should be output.
Defaults to <code>FALSE</code> (silent calls).
Set to <code>TRUE</code> to see all messages and warnings for every function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments sent to <code>glasso</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The glasso is run for 100 values of the tuning parameter logarithmically
spaced between the maximal value of the tuning parameter at which all edges are zero,
lambda_max, and lambda_max/100. For each of these graphs the EBIC is computed and
the graph with the best EBIC is selected. The partial correlation matrix
is computed using <code>wi2net</code> and returned.
</p>


<h3>Value</h3>

<p>A partial correlation matrix
</p>


<h3>Author(s)</h3>

<p>Sacha Epskamp; for maintanence,
Hudson Golino &lt;hfg9s at virginia.edu&gt; and Alexander P. Christensen &lt;alexpaulchristensen at gmail.com&gt;
</p>


<h3>References</h3>

<p><strong>Instantiation of GLASSO</strong> <br>
Friedman, J., Hastie, T., &amp; Tibshirani, R. (2008).
Sparse inverse covariance estimation with the graphical lasso.
<em>Biostatistics</em>, <em>9</em>, 432-441.
</p>
<p><strong>glasso + EBIC</strong> <br>
Foygel, R., &amp; Drton, M. (2010).
Extended Bayesian information criteria for Gaussian graphical models.
<em>In Advances in neural information processing systems</em> (pp. 604-612).
</p>
<p><strong>glasso package</strong> <br>
Friedman, J., Hastie, T., &amp; Tibshirani, R. (2011).
glasso: Graphical lasso-estimation of Gaussian graphical models.
R package version 1.7.
</p>
<p><strong>Tutorial on EBICglasso</strong> <br>
Epskamp, S., &amp; Fried, E. I. (2018).
A tutorial on regularized partial correlation networks.
<em>Psychological Methods</em>, <em>23</em>(4), 617–634.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Obtain data
wmt &lt;- wmt2[,7:24]

# Compute graph with tuning = 0 (BIC)
BICgraph &lt;- EBICglasso.qgraph(data = wmt, gamma = 0)

# Compute graph with tuning = 0.5 (EBIC)
EBICgraph &lt;- EBICglasso.qgraph(data = wmt, gamma = 0.5)

</code></pre>


</div>