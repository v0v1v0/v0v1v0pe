<div class="container">

<table style="width: 100%;"><tr>
<td>runDBN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Setup and run the MCMC simulation.</h2>

<h3>Description</h3>

<p>This function initialises the variabes for the MCMC simulation, runs the
simulation and returns the output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runDBN(targetdata, preddata = NULL, q, n, multipleVar = TRUE,
  minPhase = 2, niter = 20000, scaling = TRUE, method = "poisson",
  prior.params = NULL, self.loops = TRUE, k = 15, options = NULL,
  outputFile = ".", fixed.edges = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>targetdata</code></td>
<td>
<p>Target input data: A matrix of dimensions NumNodes by
NumTimePoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preddata</code></td>
<td>
<p>Optional: Input response data, if different from the target
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Number of nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of timepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multipleVar</code></td>
<td>
<p><code>TRUE</code> when a specific variance is estimated for
each segment, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPhase</code></td>
<td>
<p>Minimal segment length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>If <code>TRUE</code>, scale the input data to mean 0 and standard
deviation 1, else leave it unchanged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Network structure prior to use: <code>'poisson'</code> for a sparse
Poisson prior (no information sharing), <code>'exp_hard'</code> or
<code>'exp_soft'</code> for the exponential information sharing prior with hard or
soft node coupling, <code>'bino_hard'</code> or <code>'bino_soft'</code> with hard or
soft node coupling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.params</code></td>
<td>
<p>Initial hyperparameters for the information sharing
prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.loops</code></td>
<td>
<p>If <code>TRUE</code>, allow self-loops in the network, if
<code>FALSE</code>, disallow self-loops.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Initial value for the level-2 hyperparameter of the exponential
information sharing prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>MCMC options as obtained e.g. by the function
<code>defaultOptions</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputFile</code></td>
<td>
<p>File where the output of the MCMC simulation should be
saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.edges</code></td>
<td>
<p>Matrix of size NumNodes by NumNodes, with 
<code>fixed.edges[i,j]==1|0</code> if the edge between nodes i and j is fixed, and 
-1 otherwise. Defaults to <code>NULL</code> (no edges fixed).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the results of the MCMC simulation: network
samples, changepoint samples and hyperparameter samples. For details, see
<code>output</code>.
</p>


<h3>Author(s)</h3>

<p>Sophie Lebre
</p>
<p>Frank Dondelinger
</p>


<h3>References</h3>

<p>For more information about the MCMC simulations, see:
</p>
<p>Dondelinger et al. (2012), "Non-homogeneous dynamic Bayesian networks with
Bayesian regularization for inferring gene regulatory networks with
gradually time-varying structure", Machine Learning.
</p>


<h3>See Also</h3>

<p><code>output</code>
</p>


</div>