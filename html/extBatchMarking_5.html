<div class="container">

<table style="width: 100%;"><tr>
<td>batchMarkOptim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Marked model only.</h2>

<h3>Description</h3>

<p>batchMarkOptim function optimizes <code>batchMarkHmmLL</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">batchMarkOptim(
  par = NULL,
  data,
  covariate_phi = NULL,
  covariate_p = NULL,
  choiceModel = c("model1", "model2", "model3", "model4"),
  method = c("Nelder-Mead", "BFGS", "CG", "L-BFGS-B"),
  lowerBound = -Inf,
  control,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Initial values for the parameters to be optimized over.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A capture-recapture data matrix or data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate_phi</code></td>
<td>
<p>This covariate placeholder for the parameter phi_t</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate_p</code></td>
<td>
<p>This covariate placeholder for the parameter p_t</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choiceModel</code></td>
<td>
<p>This chooses among different models and allow for model selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method to be used. See <code>optim</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerBound</code></td>
<td>
<p>Lower bounds on the variables for the "L-BFGS-B" <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters. See optim for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed by user which goes into the <code>optim</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that arguments after ... must be matched exactly.
<code>batchMarkOptim</code> depends on <code>optim</code> function to optimize the parameters of the marked model only. By default optim performs minimization.
</p>


<h3>Value</h3>

<p>For <code>batchMarkOptim</code>, a list with components:
</p>

<dl>
<dt>phi</dt>
<dd>
<p>The survival probability and remaining in the population between occasion t and t+1.</p>
</dd>
<dt>p</dt>
<dd>
<p>The capture probability at occasion time t.</p>
</dd>
<dt>ll</dt>
<dd>
<p>The optimized log-likelihood value of marked model.</p>
</dd>
<dt>SE</dt>
<dd>
<p>The standard error for each parameter.</p>
</dd>
<dt>AIC</dt>
<dd>
<p>The Akaike Information Criteria for model selection.</p>
</dd>
</dl>
<h3>References</h3>

<p>Laura L. E. Cowen, Panagiotis Besbeas, Byron J. T. Morgan, 2017.: Hidden Markov Models for Extended Batch Data,
Biometrics, 73, 1321-1331. DOI: 10.1111/biom.12701.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the package
library(extBatchMarking)

# Load the WeatherLoach data from Cowen et al., 2017.
data(WeatherLoach)

# Initial parameter values
theta &lt;- c(0, -1)


mod1 &lt;- batchMarkOptim(
           par           = theta,
           data          = WeatherLoach,
           choiceModel   = "model4",
           method        = "BFGS",
           control       = list(trace = 1),
           covariate_phi = NULL,
           covariate_p   = NULL)

 # print(mod1)

 # Survival probability
 mod1$phi
 # Capture probability
 mod1$p
 # Optimized log-likelihood
 mod1$ll
 # The Aikaike Information Criteria
 mod1$AIC
 

 
 mod2 &lt;- batchMarkOptim(
           par           = theta,
           data          = WeatherLoach,
           choiceModel   = "model4",
           method        = "L-BFGS-B",
           control       = list(trace = 1),
           covariate_phi = NULL,
           covariate_p   = NULL)

 # print(mod2)
 # Survival probability
 mod2$phi
 # Capture probability
 mod2$p
 # Optimized log-likelihood
 mod2$ll
 # The Akaike Information Criteria
 mod2$AIC
 
</code></pre>


</div>