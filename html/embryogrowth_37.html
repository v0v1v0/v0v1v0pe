<div class="container">

<table style="width: 100%;"><tr>
<td>plot.NestsResult</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the embryo growth</h2>

<h3>Description</h3>

<p>Plot the embryo growth from one or several nests.<br>
The embryo.stages is a named vector with relative size as compared to final size at the beginning of the stage. Names are the stages.<br>
For example for SCL in Caretta caretta:<br>
embryo.stages=structure(c(8.4, 9.4, 13.6, 13.8, 18.9, 23.5, 32.2, 35.2, 35.5, 38.5)/39.33), <br>
.Names = c("21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31"))<br>
indicates that the stages 21 begins at the relative size of 8.4/39.33.<br>
Series can be indicated as the name of the series, its number or succesion of TRUE or FALSE. "all" indicates that all series must be printed.<br>
show.fioritures parameter does not affect show.hatchling.metric option.<br>
Note: Four species have predefined embryo stages. embryo.stages parameter can take the values:<br></p>

<ul>
<li> <p><code>Caretta caretta.SCL</code>
</p>
</li>
<li> <p><code>Chelonia mydas.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.mass</code>
</p>
</li>
<li> <p><code>Podocnemis expansa.SCL</code>
</p>
</li>
<li> <p><code>Lepidochelys olivacea.SCL</code>
</p>
</li>
<li> <p><code>Generic.ProportionDevelopment</code>
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'NestsResult'
plot(
  x,
  ...,
  parameters = NULL,
  fixed.parameters = NULL,
  resultmcmc = NULL,
  hessian = NULL,
  SE = NULL,
  temperatures = NULL,
  integral = NULL,
  derivate = NULL,
  hatchling.metric = NULL,
  stop.at.hatchling.metric = FALSE,
  M0 = NULL,
  weight = NULL,
  series = "all",
  TSP.borders = NULL,
  embryo.stages = NULL,
  STRN = NULL,
  TSP.begin = 0,
  TSP.end = 0.5,
  replicate.CI = 100,
  metric.end.incubation = "observed",
  col.stages = "blue",
  col.PT = "red",
  col.TSP = "gray",
  col.temperatures = "green",
  col.S = "black",
  lty.temperatures = 1,
  lwd.temperatures = 2,
  ylimT = NULL,
  ylimS = NULL,
  xlim = NULL,
  show.stages = TRUE,
  show.TSP = TRUE,
  show.third = TRUE,
  GTRN.CI = NULL,
  show.metric = TRUE,
  show.fioritures = TRUE,
  show.temperatures = TRUE,
  show.PT = TRUE,
  PT = c(mean = NA, SE = NA),
  show.hatchling.metric = TRUE,
  add = FALSE,
  lab.third = "2nd third of incubation",
  at.lab.third = 10,
  lab.PT = "PT",
  lab.stages = "Stages",
  at.lab.TSP = 8,
  lab.TSP = "TSP",
  mar = c(4, 5, 4, 5) + 0.3,
  xlab = "Days of incubation",
  ylabT = expression("Temperature in " * degree * "C"),
  ylabS = "Embryo metric",
  progress = TRUE,
  parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A result file generated by searchR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters for plot()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A set of parameters if result is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.parameters</code></td>
<td>
<p>Another set of parameters if result is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resultmcmc</code></td>
<td>
<p>A mcmc result. Will be used rather than SE if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>An Hessian matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Standard error for each parameter if result is not provided, or replace the one in NestsResult. Use SE=NA to remove SE from NestResult</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperatures</code></td>
<td>
<p>Timeseries of temperatures formatted using formatNests(). Will replace the one in result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivate</code></td>
<td>
<p>Function used to fit embryo growth: dydt.Gompertz, dydt.exponential or dydt.linear. It will replace the one in NestsResult.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatchling.metric</code></td>
<td>
<p>Mean and SD of size of hatchlings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.at.hatchling.metric</code></td>
<td>
<p>TRUE or FALSE. If TRUE, the model stops when proxy of size reached the mean hatchling.metric size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M0</code></td>
<td>
<p>Measure of hatchling size proxi at laying date</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Weights of the different nests to estimate likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>The name or number of the series to be displayed. Only one series can be displayed at a time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSP.borders</code></td>
<td>
<p>The limits of TSP in stages. See embryo.stages parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embryo.stages</code></td>
<td>
<p>The embryo stages. At least TSP.borders stages must be provided to estimate TSP borders. See note.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>STRN</code></td>
<td>
<p>An object obtained from STRN()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSP.begin</code></td>
<td>
<p>Where TSP begin during the stage of beginning? In relative proportion of the stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSP.end</code></td>
<td>
<p>Where TSP begin during the stage of ending? In relative proportion of the stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicate.CI</code></td>
<td>
<p>Number of replicates to estimate CI. If 1, no CI is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric.end.incubation</code></td>
<td>
<p>The expected metric at the end of incubation. Used to calibrate TSP size. If NULL, take the maximum Mean of the hatchling.metric parameter. If NA, use the actual final size. Can be a vector and is recycled if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.stages</code></td>
<td>
<p>The color of the stages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.PT</code></td>
<td>
<p>The color of the pivotal temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.TSP</code></td>
<td>
<p>The color of the TSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.temperatures</code></td>
<td>
<p>The color of the temperatures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.S</code></td>
<td>
<p>The color of the size or mass. Can be a vector (useful when series="all" option).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.temperatures</code></td>
<td>
<p>Type of line for temperatures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.temperatures</code></td>
<td>
<p>Width of line for temperatures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimT</code></td>
<td>
<p>Range of temperatures to be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimS</code></td>
<td>
<p>Range of size to be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Range of incubation days to be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.stages</code></td>
<td>
<p>TRUE or FALSE, does the embryo stages should be displayed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.TSP</code></td>
<td>
<p>TRUE or FALSE, does the TSP boders should be displayed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.third</code></td>
<td>
<p>TRUE or FALSE, does the first and second third boders should be displayed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GTRN.CI</code></td>
<td>
<p>How to estimate CI; can be NULL, "SE", "MCMC", or "Hessian"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.metric</code></td>
<td>
<p>TRUE or FALSE, does the plot of embryo metric is shown?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.fioritures</code></td>
<td>
<p>If FALSE, set show.PT, show.temperatures, show.stages, show.TSP, show.third to FALSE, GTRN.CI to NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.temperatures</code></td>
<td>
<p>TRUE or FALSE, does the temperatures should be displayed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.PT</code></td>
<td>
<p>TRUE or FALSE, does the pivotal temperature should be displayed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PT</code></td>
<td>
<p>Value for pivotal temperature, mean and SE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.hatchling.metric</code></td>
<td>
<p>TRUE or FALSE, does the hatchling size should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>If TRUE, all the curves are shown on the same graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.third</code></td>
<td>
<p>Label for 2nd third of incubation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.lab.third</code></td>
<td>
<p>Position of Label for 2nd third of incubation [default=10]; y-lim is scaled by at.lab.third</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.PT</code></td>
<td>
<p>Label for Pivotal Temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.stages</code></td>
<td>
<p>Label for Stages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.lab.TSP</code></td>
<td>
<p>Position of Label for TSP [default=8]; y-lim is scaled by at.lab.third</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.TSP</code></td>
<td>
<p>Label for the TSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>Parameter mar used for plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabT</code></td>
<td>
<p>Label for temperature axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabS</code></td>
<td>
<p>Label for size axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>If FALSE, the progress bar is not shown (useful for use with sweave or knitr)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Should parallel computing be used ? TRUE or FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NestsResult</code></td>
<td>
<p>A NestsResult file generated by searchR</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>plot.NestsResult Plot the embryo growth
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1,  
	    SE=c(DHA=1.396525, DHH=4.101217, T12H=0.04330405, Rho25=1.00479), 
	    GTRN.CI = "SE", replicate.CI = 100, 
	    embryo.stages="Caretta caretta.SCL")
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1, 
	    GTRN.CI = "Hessian", replicate.CI = 100, 
	    embryo.stages="Caretta caretta.SCL")
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1,  
     resultmcmc = resultNest_mcmc_4p_SSM, 
	    GTRN.CI = "MCMC", replicate.CI = 100, 
     embryo.stages="Caretta caretta.SCL")
# to plot all the nest at the same time, use
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45),  
	    series="all", show.fioritures=FALSE, add=TRUE, 
	    embryo.stages="Caretta caretta.SCL")
# to use color different for series
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), add=TRUE, 
	    series="all", show.fioritures=FALSE, col.S=c(rep("black", 5), rep("red", 6)), 
	    embryo.stages="Caretta caretta.SCL")
	    
# to plot all the temperature profiles

par(mar=c(4, 4, 1, 1))
plot(resultNest_4p_SSM$data[[1]][, 1]/60/24,
     resultNest_4p_SSM$data[[1]][, 2], bty="n", 
     las=1, xlab="Days of incubation", 
     ylab=expression("Temperatures in "*degree*"C"), 
     type="l", xlim=c(0,70),ylim=c(20, 35))
     
     for (i in 2:21) {
          par(new=TRUE)
          plot(resultNest_4p_SSM$data[[i]][, 1]/60/24,
          resultNest_4p_SSM$data[[i]][, 2], bty="n", 
          las=1, xlab="", ylab="", type="l", xlim=c(0,70),
          ylim=c(20, 35), axes = FALSE)
     }

## End(Not run)
</code></pre>


</div>