<div class="container">

<table style="width: 100%;"><tr>
<td>gevrFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter estimation for the GEVr distribution model</h2>

<h3>Description</h3>

<p>This function provides maximum likelihood estimation for the GEVr model, with the option of probability weighted moment and maximum product
spacing estimation for block maxima (GEV1) data. It also allows generalized linear modeling of the parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gevrFit(
  data,
  method = c("mle", "mps", "pwm"),
  information = c("expected", "observed"),
  locvars = NULL,
  scalevars = NULL,
  shapevars = NULL,
  locform = ~1,
  scaleform = ~1,
  shapeform = ~1,
  loclink = identity,
  scalelink = identity,
  shapelink = identity,
  gumbel = FALSE,
  start = NULL,
  opt = "Nelder-Mead",
  maxit = 10000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data should be a matrix from the GEVr distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method of estimation - maximum likelihood (mle), maximum product spacings (mps), and probability weighted moments (pwm). Uses mle by default.
For <code class="reqn">r &gt; 1</code>, only mle can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>
<p>Whether standard errors should be calculated via observed or expected (default) information. For probability weighted moments,
only expected information will be used if possible. In the case with covariates, only observed information is available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locvars, scalevars, shapevars</code></td>
<td>
<p>A dataframe of covariates to use for modeling of the each parameter. Parameter
intercepts are automatically handled by the function. Defaults to NULL for the stationary model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locform, scaleform, shapeform</code></td>
<td>
<p>An object of class ‘formula’ (or one that can be coerced into that class), specifying the model
of each parameter. By default, assumes stationary (intercept only) model. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loclink, scalelink, shapelink</code></td>
<td>
<p>A link function specifying the relationship between the covariates and each parameter. Defaults to the identity function. For
the stationary model, only the identity link should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gumbel</code></td>
<td>
<p>Whether to fit the Gumbel (type I) extreme value distribution (i.e. shape parameter equals zero). Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Option to provide a set of starting parameters to optim; a vector of location, scale, and shape, in that order. Otherwise, the routine attempts
to find good starting parameters. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>Optimization method to use with optim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Number of iterations to use in optimization, passed to optim. Defaults to 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to optim.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the stationary case (no covariates), starting parameters for mle and mps estimation are the probability weighted moment estimates.
In the case where covariates are used, the starting intercept parameters are the probability weighted moment estimates from the stationary case
and the parameters based on covariates are initially set to zero. For non-stationary parameters, the first reported estimate refers to the
intercept term. Covariates are centered and scaled automatically to speed up optimization, and then transformed back to original scale. <br>
Formulas for generalized linear modeling of the parameters should be given in the form '~ var1 + var2 + <code class="reqn">\cdots</code>'. Essentially, specification
here is the same as would be if using function ‘lm’ for only the right hand side of the equation. Interactions, polynomials, etc. can be
handled as in the ‘formula’ class. <br>
Intercept terms are automatically handled by the function. By default, the link functions are the identity function and the covariate dependent
scale parameter estimates are forced to be positive. For some link function <code class="reqn">f(\cdot)</code> and for example, scale
parameter <code class="reqn">\sigma</code>, the link is written as <code class="reqn">\sigma = f(\sigma_1 x_1 + \sigma_2 x_2 + \cdots + \sigma_k x_k)</code>. <br>
Maximum likelihood estimation can be used in all cases. Probability weighted moment estimation can only be used if <code class="reqn">r = 1</code> and data is
assumed to be stationary. Maximum product spacings estimation can be used in the non-stationary case, but only if <code class="reqn">r = 1</code>.
</p>


<h3>Value</h3>

<p>A list describing the fit, including parameter estimates and standard errors for the mle and mps methods. Returns as a class
object ‘gevrFit’ to be used with diagnostic plots.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(7)
x1 &lt;- rgevr(500, 1, loc = 0.5, scale = 1, shape = 0.3)
result1 &lt;- gevrFit(x1, method = "mps")

# A linear trend in the location and scale parameter
n &lt;- 100
r &lt;- 10
x2 &lt;- rgevr(n, r, loc = 100 + 1:n / 50,  scale = 1 + 1:n / 300, shape = 0)

covs &lt;- as.data.frame(seq(1, n, 1))
names(covs) &lt;- c("Trend1")
# Create some unrelated covariates
covs$Trend2 &lt;- rnorm(n)
covs$Trend3 &lt;- 30 * runif(n)
result2 &lt;- gevrFit(data = x2, method = "mle", locvars = covs, locform = ~ Trend1 + Trend2*Trend3,
scalevars = covs, scaleform = ~ Trend1)

# Show summary of estimates
result2

</code></pre>


</div>