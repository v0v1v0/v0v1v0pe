<div class="container">

<table style="width: 100%;"><tr>
<td>EnBinSeg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An S4 method to detect the change-points in an irregularly spaced time series using Ensemble Binary Segmentation.</h2>

<h3>Description</h3>

<p>An S4 method to detect the change-points in an irregularly spaced time series using the Ensemble Binary Segmentation methodology described in Korkas (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">EnBinSeg(
  H,
  thresh = "universal",
  q = 0.99,
  p = 1,
  start.values = c(0.9, 0.6),
  dampen.factor = "auto",
  epsilon = 1e-05,
  LOG = TRUE,
  process = "acd",
  thresh2 = 0.05,
  num_ens = 500,
  min_dist = 0.005,
  pp = 1,
  do.parallel = 2,
  b = NULL,
  acd_p = 0,
  acd_q = 1
)

## S4 method for signature 'ANY'
EnBinSeg(
  H,
  thresh = "universal",
  q = 0.99,
  p = 1,
  start.values = c(0.9, 0.6),
  dampen.factor = "auto",
  epsilon = 1e-05,
  LOG = TRUE,
  process = "acd",
  thresh2 = 0.05,
  num_ens = 500,
  min_dist = 0.005,
  pp = 1,
  do.parallel = 2,
  b = NULL,
  acd_p = 0,
  acd_q = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The input irregular time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>The threshold parameter which acts as a stopping rule to detect further change-points and has the form C log(sample). If "universal" then C is data-independent and preselected using the approach described in Korkas (2020). If "boot" it uses the data-dependent method <code>boot_thresh</code>. Default is "universal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The universal threshold simulation quantile or the bootstrap distribution quantile. Default is 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The support of the CUSUM statistic. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.values</code></td>
<td>
<p>Warm starts for the optimizers of the likelihood functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dampen.factor</code></td>
<td>
<p>The dampen factor in the denominator of the residual process. Default is "auto".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>A parameter added to ensure the boundness of the residual process. Default is  1e-5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOG</code></td>
<td>
<p>Take the log of the residual process. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process</code></td>
<td>
<p>Choose between "acd" or "hawkes" or "additive" (signal +iid noise). Default is "acd".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh2</code></td>
<td>
<p>Keep only the change-points that appear more than thresh2 M times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_ens</code></td>
<td>
<p>Number of ensembles denoted by M in the paper. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_dist</code></td>
<td>
<p>The minimum distance as percentage of sample size to use in the post-processing. Default is 0.005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>Post-process the change-points based on the distance from the highest ranked change-points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.parallel</code></td>
<td>
<p>Choose the number of cores for parallel computation. If 0 no parallelism is done. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A parameter to control how close the random end points are to the start points. A large value will on average return shorter random intervals. If NULL all points have an equal chance to be selected (uniformly distributed). Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acd_p</code></td>
<td>
<p>The p order of the ACD model. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acd_q</code></td>
<td>
<p>The q order of the ACD model. Default is 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the detected change-points and the frequency table of the ensembles across <code>M</code> applications.
</p>


<h3>References</h3>

<p>Korkas Karolos. "Ensemble Binary Segmentation for irregularly spaced data with change-points" Preprint &lt;arXiv:2003.03649&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pw.acd.obj &lt;- new("simACD")
pw.acd.obj@cp.loc &lt;- seq(0.1,0.95,by=0.025)
pw.acd.obj@lambda_0 &lt;- rep(c(0.5,2),1+length(pw.acd.obj@cp.loc)/2)
pw.acd.obj@alpha &lt;- rep(0.2,1+length(pw.acd.obj@cp.loc))
pw.acd.obj@beta &lt;- rep(0.4,1+length(pw.acd.obj@cp.loc))
pw.acd.obj@N &lt;- 5000
pw.acd.obj &lt;- pc_acdsim(pw.acd.obj)
ts.plot(pw.acd.obj@x,main="Ensemble BS");abline(v=EnBinSeg(pw.acd.obj@x)[[1]],col="red")
#real change-points in grey
abline(v=floor(pw.acd.obj@cp.loc*pw.acd.obj@N),col="grey",lty=2) 
ts.plot(pw.acd.obj@x,main="Standard BS");abline(v=BinSeg(pw.acd.obj@x)[[1]],col="blue")
#real change-points in grey
abline(v=floor(pw.acd.obj@cp.loc*pw.acd.obj@N),col="grey",lty=2)
</code></pre>


</div>