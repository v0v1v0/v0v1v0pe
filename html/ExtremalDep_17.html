<div class="container">

<table style="width: 100%;"><tr>
<td>ellipse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Level sets for bivariate normal, student-t and skew-normal distributions probability densities.</h2>

<h3>Description</h3>

<p>Level sets of the bivariate normal, student-t and skew-normal distributions probability densities for a given probability.</p>


<h3>Usage</h3>

<pre><code class="language-R">	ellipse(center=c(0,0), alpha=c(0,0), sigma=diag(2), df=1,
	prob=0.01, npoints=250, pos=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>A vector of length 2 corresponding to the location of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector of length 2 corresponding to the skewness of the skew-normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A 2 by 2 variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>An integer corresponding to the degree of freedom of the student-t distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>The probability level. See <code>details</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>The maximum number of points at which it is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>If <code>pos=TRUE</code> only the region on the positive quadrant is kept.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Level sets are defined as
</p>
<p><code class="reqn">R(f_\alpha)=\{ x: f(x) \geq f_\alpha \} </code>
</p>
<p>where <code class="reqn">f_\alpha</code> is the largest constant such that
</p>
<p><code class="reqn">P(X \in R(f_\alpha)) \geq 1-\alpha</code>.
Here we consider <code class="reqn">f(x)</code> to be the bivariate normal, student-t or skew-normal density.
</p>


<h3>Value</h3>

<p>Returns a bivariate vector of <code class="reqn">250</code> rows if <code>pos=FALSE</code>, and half otherwise.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mvtnorm)

# Data simulation (Bivariate-t on positive quadrant)
rho &lt;- 0.5
sigma &lt;- matrix(c(1,rho,rho,1), ncol=2)
df &lt;- 2

set.seed(101)
n &lt;- 1500
data &lt;- rmvt(5*n, sigma=sigma, df=df)
data &lt;- data[data[,1]&gt;0 &amp; data[,2]&gt;0, ]
data &lt;- data[1:n, ]

P &lt;- c(1/750, 1/1500, 1/3000)

ell1 &lt;- ellipse(prob=1-P[1], sigma=sigma, df=df, pos=TRUE)
ell2 &lt;- ellipse(prob=1-P[2], sigma=sigma, df=df, pos=TRUE)
ell3 &lt;- ellipse(prob=1-P[3], sigma=sigma, df=df, pos=TRUE)

plot(data, xlim=c(0,max(data[,1],ell1[,1],ell2[,1],ell3[,1])),
     ylim=c(0,max(data[,2],ell1[,2],ell2[,2],ell3[,2])), pch=19)
points(ell1, type="l", lwd=2, lty=1)
points(ell2, type="l", lwd=2, lty=1)
points(ell3, type="l", lwd=2, lty=1)

</code></pre>


</div>