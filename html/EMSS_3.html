<div class="container">

<table style="width: 100%;"><tr>
<td>EMSS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM type Estimation Methods for the Heckman's Sample Selection Model</h2>

<h3>Description</h3>

<p>Some algorithms: <code>ECM</code>, <code>ECMnr</code> and <code>ECME</code> can be used to estimate parameters
in Heckman selection model and contain the advantages of the <code>EM</code> algorithm: easy
implementation and numerical stability. <code>"ECMnr"</code> stands for Expectation/Conditioncal
Maximization with Newton-Raphson, and <code>"ECME"</code> for Expectation/Conditional Maximization Either.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMSS(
  response,
  selection,
  data,
  method = "ECM",
  initial.param = NULL,
  eps = 10^(-10)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>a formula for the response equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>
<p>a formula for the selection equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame and data has to be included with the form of <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character indicating which method to be used. <code>ECM</code> stands for Expectation Conditional Maximization, and
<code>ECMnr</code> stands for Expectation Conditioncal Maximization with Newton-Raphson, and <code>ECME</code> for Expectation Conditional Maximization Either.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.param</code></td>
<td>
<p>a vector, initial parameter values for the estimation. The length of the initial parameters has to
be same as the length of parameters, which are to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a numerical error value for the end of the loop. A minimum value that can be arbitrarily set
to terminate the iteration of the function, in order to find the optimal parameter estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dependent variable of the selection equation (specified by argument selection) must have exactly
two levels (e.g., 'FALSE' and 'TRUE', or '0' and '1'). The default argument method is "ECM" and the
default start values ("NULL") are obtained by two-step estimation of this model through the command
<code>selection</code> from the package <code>sampleSelection</code>. NA's are allowed in the data. These are
ignored if the corresponding outcome is unobserved, otherwise observations which contain NA
(either in selection or outcome) are changed to 0.
</p>


<h3>Value</h3>

<p><code>ECM</code> returns an object of class <code>"ECM"</code>.
The object class <code>"ECM"</code> is a list
containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_response</code></td>
<td>
<p>estimated regression coefficients for the response formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_selection</code></td>
<td>
<p>estimated regression coefficients for the sample selection formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_sigma</code></td>
<td>
<p>an estimated scale paramter for the bivariate normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_rho</code></td>
<td>
<p>an estimated correlation coefficient for the bivariate normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian_mat</code></td>
<td>
<p>hessian matrix for parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp_leng</code></td>
<td>
<p>the numbers of coefficients for the response formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_leng</code></td>
<td>
<p>the numbers of coefficients for the selection formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_value</code></td>
<td>
<p>the vallue of the Q function for EM type algorithms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names_response</code></td>
<td>
<p>names of regression coefficients for the reponse formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names_selection</code></td>
<td>
<p>names of regression coefficients for the selection formula.</p>
</td>
</tr>
</table>
<h3>Background</h3>

<p>Heckman selection model is classic to deal with the data where the outcome is partially observed and
the missing part is not at random. Heckman (1979) developed <code>2-step</code> and maximum likelihood
estimation (<code>MLE</code>) to do the estimation for this selection model. And these two method are
described in R package <code>sampleSelection</code> by Toomet and Henningsen (2008). Zhelonkin et al. (2016)
developed robust 2-stage method which performs more robustly than the 2-step method to deal with the
data where outlying observations exist and <code>ssmrob</code> package is available. Zhao et al. (2020) extended
EM algorithm to more general cases resulting in three algorithms: ECM, ECM(NR), and ECME. They also own
EM algorithm's main advantages, namely, stability and ease of implementation.
</p>


<h3>References</h3>

<p>Heckman, J. (1979) Sample selection bias as a specication error. <em>Econometrica</em>, 47, 153-161.
</p>
<p>Toomet, O. and Henningsen, A. (2008) Sample selection models in R:Package sampleSelection. <em>Journal of Statistical Software</em>, 27, 1-23.
</p>
<p>Zhao,J., Kim, H.-J. and Kim, H.-M. (2020) New EM-type algorithms for the Heckman selection model. <em>Computational Statistics and Data Analysis</em>, 146, https://doi.org/10.1016/j.csda.2020.106930.
</p>
<p>Zhelonkin, M., Genton, M.G. and Ronchetti, E. (2016) Robust inference in sample selection models. <em>Journal of the Royal Statistical Society Series B</em>, 78, 805-827.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Smoke, package = "EMSS")
ex1 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection = smoker ~ educ + age,
           data = Smoke)
print(ex1)

data(Smoke, package = "EMSS")
ex2 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection =  smoker ~ educ + age,
           data = Smoke, method="ECMnr")
print(ex2)

## example using random numbers with exclusion restriction

N &lt;- 1000
errps &lt;- mvtnorm::rmvnorm(N,c(0,0),matrix(c(1,0.5,0.5,1),2,2) )
xs &lt;- runif(N)
ys &lt;- xs+errps[,1]&gt;0
xo &lt;- runif(N)
yo &lt;- (xo+errps[,2])*(ys&gt;0)
ex3 &lt;- EMSS(response = yo ~ xo,
           selection = ys ~ xs,
           initial.param = c(rep(0,4), 0.3, 0.6), method="ECMnr")
print(ex3)

</code></pre>


</div>