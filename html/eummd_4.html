<div class="container">

<table style="width: 100%;"><tr>
<td>mediandiff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the median difference between pairs of values</h2>

<h3>Description</h3>

<p>Compute the median of all differences between distinct
pairs in vectors or matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mediandiff(X, Y = NULL, kernel = c("Laplacian", "Gaussian"), fast = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric vector or matrix of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric vector or matrix of length <code>m</code>, or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>String, either <code>"Laplacian"</code> or <code>"Gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>Boolean; if <code>TRUE</code> will run <code class="reqn">O(N \log N)</code> algorithm,
where <code>N = n + m</code>,
but if <code>FALSE</code> (default)
will run naive <code class="reqn">O(N^2 \log N)</code> algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The median difference is defined as follows:
</p>
<p><code class="reqn">Z</code> is the combined <code class="reqn">X</code> and <code class="reqn">Y</code> values into a single vector
or matrix.
Number of columns is the dimension, and these need to be equal
for <code class="reqn">X</code> and <code class="reqn">Y</code>. Then, if the Laplacian kernel is used,
</p>
<p style="text-align: center;"><code class="reqn"> m = \textnormal{median} \{ || x_i - x_j ||_1; \,\, i&gt;j, \,\, 
        i=1, 2,\dots, n+m,\,\,\textnormal{ and } j=1, 2,\dots, i-1 \}, </code>
</p>

<p>where <code class="reqn"> || z_i - z_j ||_1</code> is the 1-norm, and so if the data
are <code>d</code>-dimensional then
</p>
<p style="text-align: center;"><code class="reqn"> || z_i - z_j ||_1 = \sum_{k=1}^{d} |z_{i,k} - z_{j,k}|. </code>
</p>

<p>If the Gaussian kernel is specified, then the square of the two-norm is
used.
</p>
<p>The median heuristic is defined as <code>beta = 1/m</code>.
</p>
<p>Naive method will compute all distinct pairs, of which there are
<code class="reqn">N(N+1)/2</code> differences. These are then sorted using
a <code class="reqn">O(N \log N)</code> algorithm, so overall <code class="reqn">O(N^2 \log N)</code>.
</p>
<p>The fast method is <code class="reqn">O(N \log N)</code> is from Croux and Rousseeuw (1992),
which is based on Johnson and Mizoguchi (1978).
</p>


<h3>Value</h3>

<p>A scalar, the median of all pairwise differences.
</p>


<h3>References</h3>

<p>Croux, C. and Rousseeuw, P. J. (1992),
"Time-Efficient Algorithms for Two Highly Robust Estimators of Scale"
In Computational Statistics: Volume 1: Proceedings of the 10th
Symposium on Computational Statistics (pp. 411-428).
</p>
<p>Johnson, D.B., and Mizoguchi, T. (1978),
"Selecting the Kth Element in X + Y and X_1 + X_2 + ... + X_m",
SIAM Journal of Computing, 7, 147-153.
</p>


<h3>See Also</h3>

<p><code>medianheuristic</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
X &lt;- c(7.1, 1.2, 4.3, 0.4)
Y &lt;- c(5.5, 2.6, 8.7)
#using fast method, Laplacian kernel, loglinear in number of observations
md &lt;- mediandiff(X, Y, fast=TRUE)

#using fast method, Gaussian kernel, loglinear in number of observations
md &lt;- mediandiff(X, Y, fast=TRUE, kernel="Gaussian")

#using naive method (default), with Laplacian kernel
md &lt;- mediandiff(X, Y)

</code></pre>


</div>