<div class="container">

<table style="width: 100%;"><tr>
<td>step_discretize_cart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Discretize numeric variables with CART</h2>

<h3>Description</h3>

<p><code>step_discretize_cart()</code> creates a <em>specification</em> of a recipe step that will
discretize numeric data (e.g. integers or doubles) into bins in a supervised
way using a CART model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">step_discretize_cart(
  recipe,
  ...,
  role = NA,
  trained = FALSE,
  outcome = NULL,
  cost_complexity = 0.01,
  tree_depth = 10,
  min_n = 20,
  rules = NULL,
  skip = FALSE,
  id = rand_id("discretize_cart")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>recipe</code></td>
<td>
<p>A recipe object. The step will be added to the sequence of
operations for this recipe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>One or more selector functions to choose which variables are
affected by the step. See <code>selections()</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>role</code></td>
<td>
<p>Defaults to <code>"predictor"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trained</code></td>
<td>
<p>A logical to indicate if the quantities for preprocessing have
been estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>A call to <code>vars</code> to specify which variable is used as the
outcome to train CART models in order to discretize explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost_complexity</code></td>
<td>
<p>The regularization parameter. Any split that does not
decrease the overall lack of fit by a factor of <code>cost_complexity</code> is not
attempted. Corresponds to <code>cp</code> in <code>rpart::rpart()</code>. Defaults to 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree_depth</code></td>
<td>
<p>The <em>maximum</em> depth in the final tree. Corresponds to
<code>maxdepth</code> in  <code>rpart::rpart()</code>. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n</code></td>
<td>
<p>The number of data points in a node required to continue
splitting. Corresponds to <code>minsplit</code> in  <code>rpart::rpart()</code>. Defaults to 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rules</code></td>
<td>
<p>The splitting rules of the best CART tree to retain for each
variable. If length zero, splitting could not be used on that column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>A logical. Should the step be skipped when the recipe is baked by
<code>recipes::bake()</code>? While all operations are baked when <code>recipes::prep()</code> is
run, some operations may not be able to be conducted on new data (e.g.
processing the outcome variable(s)). Care should be taken when using <code>skip = TRUE</code> as it may affect the computations for subsequent operations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A character string that is unique to this step to identify it.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>step_discretize_cart()</code> creates non-uniform bins from numerical variables by
utilizing the information about the outcome variable and applying a CART
model.
</p>
<p>The best selection of buckets for each variable is selected using the
standard cost-complexity pruning of CART, which makes this discretization
method resistant to overfitting.
</p>
<p>This step requires the <span class="pkg">rpart</span> package. If not installed, the step will
stop with a note about installing the package.
</p>
<p>Note that the original data will be replaced with the new bins.
</p>


<h3>Value</h3>

<p>An updated version of <code>recipe</code> with the new step added to the
sequence of any existing operations.
</p>


<h3>Tidying</h3>

<p>When you <code>tidy()</code> this step, a tibble is retruned with
columns <code>terms</code>, <code>value</code>, and <code>id</code>:
</p>

<dl>
<dt>terms</dt>
<dd>
<p>character, the selectors or variables selected</p>
</dd>
<dt>value</dt>
<dd>
<p>numeric, location of the splits</p>
</dd>
<dt>id</dt>
<dd>
<p>character, id of this step</p>
</dd>
</dl>
<h3>Tuning Parameters</h3>

<p>This step has 3 tuning parameters:
</p>

<ul>
<li> <p><code>cost_complexity</code>: Cost-Complexity Parameter (type: double, default: 0.01)
</p>
</li>
<li> <p><code>tree_depth</code>: Tree Depth (type: integer, default: 10)
</p>
</li>
<li> <p><code>min_n</code>: Minimal Node Size (type: integer, default: 20)
</p>
</li>
</ul>
<h3>Case weights</h3>

<p>This step performs an supervised operation that can utilize case weights.
To use them, see the documentation in recipes::case_weights and the examples on
<code>tidymodels.org</code>.
</p>


<h3>See Also</h3>

<p><code>step_discretize_xgb()</code>, <code>recipes::recipe()</code>,
<code>recipes::prep()</code>, <code>recipes::bake()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(modeldata)
data(ad_data)
library(rsample)

split &lt;- initial_split(ad_data, strata = "Class")

ad_data_tr &lt;- training(split)
ad_data_te &lt;- testing(split)

cart_rec &lt;-
  recipe(Class ~ ., data = ad_data_tr) %&gt;%
  step_discretize_cart(
    tau, age, p_tau, Ab_42,
    outcome = "Class", id = "cart splits"
  )

cart_rec &lt;- prep(cart_rec, training = ad_data_tr)

# The splits:
tidy(cart_rec, id = "cart splits")

bake(cart_rec, ad_data_te, tau)

</code></pre>


</div>