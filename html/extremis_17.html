<div class="container">

<table style="width: 100%;"><tr>
<td>khetmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>K-Means Clustering for Heteroscedastic Extremes</h2>

<h3>Description</h3>

<p>This function performs k-means clustering for heteroscedastic extremes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  khetmeans(y, centers, iter.max = 10, alpha = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>data frame from which the estimate is to be computed; first
column corresponds to time and the second to the remainder of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>the number of clusters or a set of initial (distinct)
cluster centres. If a number, a random set of (distinct) rows in
<code>y</code> is chosen as the initial centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>the maximum number of iterations allowed. The
default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the tuning parameter. The default is 0.5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The intermediate sequence <code class="reqn">\kappa_T</code> is chosen
proportional to <code class="reqn">T/\log T</code>.
</p>


<h3>Value</h3>

<p>khetmeans returns an object of class "<code>khetmeans</code>" which has a
fitted method. It is a list with at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mus.new</code></td>
<td>
<p>cluster center scedasis density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mugamma.new</code></td>
<td>
<p>cluster center extreme value index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>cluster allocation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.clust</code></td>
<td>
<p>number of clusters.</p>
</td>
</tr>
</table>
<p>The <code>plot</code> method depicts the k-means clustering for
heteroscedastic extremes. If <code>c.c</code> is <code>TRUE</code>, the method
displays the cluster means.
</p>


<h3>Author(s)</h3>

<p>Miguel de Carvalho, Rodrigo Rubio.</p>


<h3>References</h3>

<p>Rubio, R., de Carvalho, M. and Huser, R. (2018) 
Similarity-Based Clustering of Extreme Losses from the London Stock
Exchange. Submitted.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Example 1  (Scenario B, T = 5000)
## This example requires package evd 
require(evd)
set.seed(12)
T &lt;- 5000
n &lt;- 30
b &lt;- 0.1
gamma1 &lt;- 0.7
gamma2 &lt;- 1
grid &lt;- seq(0, 1, length = 100)
c2 &lt;- function(s)
    dbeta(s, 2, 5)
c3 &lt;- function(s)
    dbeta(s, 5, 2)
X &lt;- matrix(0, ncol = T, nrow = n)
for(i in 1:5)
  for(j in 1:T)
    X[i,  j] &lt;- rgev(1, c2(j / T), c2(j / T), gamma1)
for(i in 6:15)
  for(j in 1:T)
    X[i,  j] &lt;- rgev(1, c2(j / T), c2(j / T), gamma2)
for(i in 16:20)
  for(j in 1:T)
    X[i,  j] &lt;- rgev(1, c3(j / T), c3(j / T), gamma1)
for(i in 21:30)
  for(j in 1:T)
    X[i,  j] &lt;- rgev(1, c3(j / T), c3(j / T), gamma2)
Y &lt;- t(X)
fit &lt;- khetmeans(Y, centers = 4)
plot(fit, c.c = TRUE)
lines(grid, c2(grid), type = 'l', lwd = 8, col = 'black')
lines(grid, c3(grid), type = 'l', lwd = 8, col = 'black')

## End(Not run)

## Not run: 
## Example 2 (Overlapping version of Fig. 5 in Supplementary Materials)
data(lse)
attach(lse)
y &lt;- -apply(log(lse[, -1]), 2, diff)
fit &lt;- khetmeans(y, centers = 3)
plot(fit, c.c = TRUE, ylim = c(0, 3))

## End(Not run)
</code></pre>


</div>