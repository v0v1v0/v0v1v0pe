<div class="container">

<table style="width: 100%;"><tr>
<td>ei.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ecological regression</h2>

<h3>Description</h3>

<p> Estimate an ecological regression using least squares. </p>


<h3>Usage</h3>

<pre><code class="language-R">ei.reg(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An R formula object of the form <code>cbind(c1, c2, ...)
    ~ cbind(r1, r2, ...)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the variables specified in <code>formula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>lm</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code class="reqn">i \in 1,\ldots,C</code>, C regressions of the form
<code>c_i ~ cbind(r1, r2, ...)</code> are performed.
</p>
<p>These regressions make use of the accounting identities
and the constancy assumption, that <code class="reqn">\beta_{rci} =
    \beta_{rc}</code> for all <code class="reqn">i</code>.
</p>
<p>The accounting identities include
</p>

<ul>
<li>
<p>–defining the population cell fractions
<code class="reqn">\beta_{rc}</code> such that <code class="reqn">\sum_{c=1}^{C} \beta_{rc}
      =  1</code> for every <code class="reqn">r</code>
</p>
</li>
<li>
<p>–<code class="reqn">\sum_{c=1}^{C} \beta_{rci}  =  1</code> for <code class="reqn">r = 1, \ldots, R</code> and <code class="reqn">i = 1, \ldots,
      n</code>
</p>
</li>
<li>
<p>–<code class="reqn">T_{ci} = \sum_{r=1}^R \beta_{rci}X_{ri}</code> for <code class="reqn">c = 1,\ldots,C</code> and <code class="reqn">i =
      1\ldots,n</code>
</p>
</li>
</ul>
<p>Then regressing </p>
<p style="text-align: center;"><code class="reqn">T_{ci} = \beta_{rc} X_{ri} + \epsilon_{ci}</code>
</p>
<p> for <code class="reqn">c = 1,\dots,C</code>
recovers the population parameters <code class="reqn">\beta_{rc}</code> when the
standard linear regression assumptions apply, including
<code class="reqn">E[\epsilon_{ci}] = 0</code> and
<code class="reqn">Var[\epsilon_{ci}] = \sigma_c^2</code> for
all <code class="reqn">i</code>.
</p>


<h3>Value</h3>

<p>A list containing 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call to <code>ei.reg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>an <code class="reqn">R \times C</code> matrix of estimated
population cell fractions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>an <code class="reqn">R \times C</code> matrix of standard errors
for <code>coefficients</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.matrices</code></td>
<td>
<p>A list of the <code class="reqn">C</code> scaled variance-covariance
matrices for each of the ecological regressions</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Olivia Lau &lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt; and Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>References</h3>

<p>Leo Goodman. 1953. “Ecological Regressions and the Behavior of Individuals.”
<em>American Sociological Review</em> 18:663–664.
</p>


</div>