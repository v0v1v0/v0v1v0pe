<div class="container">

<table style="width: 100%;"><tr>
<td>gofN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear model diagnostics for multinetwork linear models</h2>

<h3>Description</h3>

<p><code>gofN()</code> performs a simulation to obtain Pearson residuals for the
multivariate linear model for ERGM parameters, which can then be
used for a variety of diagnostics and diagnostic plots developed by
Krivitsky et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofN(
  object,
  GOF = NULL,
  subset = TRUE,
  control = control.gofN.ergm(),
  save_stats = FALSE,
  ...
)

## S3 method for class 'gofN'
x[i, j, ..., drop = FALSE]

## S3 method for class 'gofN'
augment(x, ...)

## S3 method for class 'gofN'
summary(object, by = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>ergm</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF</code></td>
<td>
<p>a one-sided <code>ergm</code> formula specifying network
statistics whose goodness of fit to test, or <code>NULL</code>; if <code>NULL</code>,
uses the original model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>argument for the <code>N</code> term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>See <code>control.gofN.ergm()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_stats</code></td>
<td>
<p>If <code>TRUE</code>, save the simulated network statistics;
defaults to <code>FALSE</code> to save memory and disk space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to functions (<code>simulate.ergm()</code>
and <code>summary.ergm_model()</code>) for the constructor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>gofN</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>for the indexing operator, index of statistics to be kept in the subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>for the indexing operator, index of networks to be kept in the subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>whether the indexing operator should drop attributes and return simply a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>a numeric or character vector, or a formula whose RHS gives an expression in terms of network attributes, used as a grouping variable for summarizing the values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gofN</code>: a named list containing a list
for every statistic in the specified <code>GOF</code> formula with the
following elements vectors of length equal to the number of
subnetworks:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>For completely observed networks, their value of
the statistic. For partially observed networks, the expected value
of their imputations under the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>Expected value of the statistic under the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Variance of the statistic under the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.obs</code></td>
<td>
<p>Conditional variance under imputation statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pearson</code></td>
<td>
<p>The Pearson residual computed from the above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats,stats.obs</code></td>
<td>
<p>If <code>save_stats</code> control parameter is <code>TRUE</code>, the simulated statistics.</p>
</td>
</tr>
</table>
<p>In addition, the following <code>attr</code>-style attributes are included:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nw</code></td>
<td>
<p>The observed multinetwork object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A logical vector giving the subset of networks that were used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Control parameters passed.</p>
</td>
</tr>
</table>
<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>[</code>: Extract a subset of statistics for which goodness-of-fit had been computed.
</p>
</li>
<li> <p><code>augment(gofN)</code>: a method for constructing a <code>tibble</code> of network attributes augmented with goodness of fit information. Columns include:</p>

<dl>
<dt>network attributes</dt>
<dd>
<p>the attributes of each of the networks</p>
</dd>
<dt><code>.stat_name</code></dt>
<dd>
<p>name of the simulated statistic</p>
</dd>
<dt><code>.stat_id</code></dt>
<dd>
<p>index of the simulated statistic in the <code>gofN</code> object</p>
</dd>
<dt><code>.network_id</code></dt>
<dd>
<p>index of the network in the networks for which <code>gofN</code> was run (excluding those not in the subset)</p>
</dd>
<dt><code>.fitted</code></dt>
<dd>
<p>predicted value for the statistic</p>
</dd>
<dt><code>.observed</code></dt>
<dd>
<p>either the observed (for completely observed networks) or the predicted conditional on observed (for partially observed networks) value of the statistic</p>
</dd>
<dt><code>.pearson</code></dt>
<dd>
<p>the standardised Pearson residual</p>
</dd>
<dt>
<code>.var</code>, <code>.var.obs</code>
</dt>
<dd>
<p>estimated unconditional and average conditional variance of the statistic</p>
</dd>
<dt><code>.weight</code></dt>
<dd>
<p>inverse of the variance of the residual</p>
</dd>
</dl>
</li>
<li> <p><code>summary(gofN)</code>: A simple summary function.
</p>
</li>
</ul>
<h3>References</h3>

<p>Krivitsky PN, Coletti P, Hens N (2023).
“A Tale of Two Datasets: Representativeness and Generalisability of Inference for Samples of Networks.”
<em>Journal of the American Statistical Association</em>, <b>118</b>(544), 2213-2224.
<a href="https://doi.org/10.1080/01621459.2023.2242627">doi:10.1080/01621459.2023.2242627</a>.
</p>


<h3>See Also</h3>

<p><code>plot.gofN()</code> and <code>autoplot.gofN()</code> for plotting <code>gofN</code>
objects to make residual plots; <code>ergm::gof()</code> for single-network
goodness-of-fit simulations in <a href="https://CRAN.R-project.org/package=ergm"><span class="pkg">ergm</span></a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(samplk)
monks &lt;- Networks(samplk1, samplk2, samplk3,samplk1, samplk2, samplk3,samplk1, samplk2, samplk3)
fit &lt;- ergm(monks~N(~edges+nodematch("group")))
fit.gof &lt;- gofN(fit) # GOF = original model
summary(fit.gof)
plot(fit.gof)
fit.gof &lt;- gofN(fit, GOF=~triangles)
summary(fit.gof)
plot(fit.gof)


samplk1[1,]&lt;-NA
samplk2[,2]&lt;-NA
monks &lt;- Networks(samplk1, samplk2, samplk3,samplk1, samplk2, samplk3,samplk1, samplk2, samplk3)
fit &lt;- ergm(monks~N(~edges+nodematch("group")))
fit.gof &lt;- gofN(fit) # GOF = original model
summary(fit.gof)
plot(fit.gof)
fit.gof &lt;- gofN(fit, GOF=~triangles)
summary(fit.gof)
plot(fit.gof)
plot(fit.gof, against=~log(.fitted)) # Plot against transformed fitted values.


### If 'ggplot2' and 'ggrepel' are installed, illustrate the autoplot() method.
if(require("ggplot2") &amp;&amp; requireNamespace("ggrepel")){
  autoplot(fit.gof)
}

# Default is good enough in this case, but sometimes, we might want to set it higher. E.g.,
## Not run: 
fit.gof &lt;- gofN(fit, GOF=~edges, control=control.gofN.ergm(nsim=400))

## End(Not run)


### If 'generics' is installed, illustrate the augment() method.
if(require("generics")){
  augment(fit.gof)
}

</code></pre>


</div>