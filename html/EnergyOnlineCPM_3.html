<div class="container">

<table style="width: 100%;"><tr>
<td>maxEnergyCPMv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric Multivariate Control Chart based on Energy Test
</h2>

<h3>Description</h3>

<p>This R function centers on nonparametric Phase II multiple change points detection for high dimensional time series. Three highlights are included in the function. Firstly, the new model is
nonparametric which does not require any distributional pre-knowledge about the process. The test
is based on the maximum energy statistic (see [1] Gabor J. Szekely and Maria L. Rizzo 2004, Testing
for Equal Distributions in High Dimension) and permutation samples. Secondly, the model is a
Phase II change point model (see [2]) which is used for online detection of stream data not for batch data.
Phase II set-up has practical meaning in time series change detection. Thirdly, it is concentrated on
high dimensional data, i.e. multivariate context. An important remark is that the data used in this
function must be independent, i.e. every row in the N*d matrix must be an independent observation.
If your data set contains not-independent observations then you need to handle the data using some
filter functions, e.g. multivariate time series model to filter out the residuals which are theoretically independent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxEnergyCPMv(data1, wNr, permNr, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data1</code></td>
<td>

<p>an N*d matrix, N is the number of observations and d the dimensions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wNr</code></td>
<td>

<p>a scalar of warm-up.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permNr</code></td>
<td>

<p>a scalar of times of permutation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>a scalar of significant level
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function returns ONLY ONE vector containing even number components, where the first half stands for detection time vector and the rest half stands for the vector of change time locations.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>a vector of locations of detection time in the first half, locations of change time in the second half.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Yafei Xu &lt;yafei.xu@hotmail.de&gt;
</p>


<h3>References</h3>

<p>[1] Szekely, G. J. &amp; Rizzo, M. L. (2004). Testing for equal distributions in high dimension, InterStat.
</p>
<p>[2] Hawkins, D. M., Qiu, P. &amp; Kang, C. W. (2003). The changepoint model for statistical process control, Journal of Quality Technology.
</p>
<p>[3] Xu, Y. F. (2017). Reference manual: An R package "EnergyOnlineCPM".
</p>
<p>see URL: https://sites.google.com/site/EnergyOnlineCPM/
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# simulate 300 length time series
simNr=300

# simulate 300 length 5 dimensonal standard Gaussian series
Sigma2 &lt;- matrix(c(1,0,0,0,0,  0,1,0,0,0,   0,0,1,0,0,  0,0,0,1,0,  0,0,0,0,1),5,5)
Mean2=rep(1,5)
sim2=(mvrnorm(n = simNr, Mean2, Sigma2)) 

# simulate 300 length 5 dimensonal standard Gaussian series
Sigma3 &lt;- matrix(c(1,0,0,0,0,  0,1,0,0,0,   0,0,1,0,0,  0,0,0,1,0,  0,0,0,0,1),5,5)
Mean3=rep(0,5)
sim3=(mvrnorm(n = simNr, Mean3, Sigma3))

# construct a data set of length equal to 35.
# first 20 points are from standard Gaussian. 
# second 15 points from a Gaussian with a mean shift with 555.
data1=sim6=rbind(sim2[1:20,],(sim3+555)[1:15,])

# set warm-up number as 20, permutation 200 times, significant level 0.005
wNr=20
permNr=200
alpha=1/200
maxEnergyCPMv(data1,wNr,permNr,alpha)

</code></pre>


</div>