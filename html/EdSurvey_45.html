<div class="container">

<table style="width: 100%;"><tr>
<td>getData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read Data to a Data Frame</h2>

<h3>Description</h3>

<p>Reads in selected columns to a <code>data.frame</code> or a
<code>light.edsurvey.data.frame</code>. On an <code>edsurvey.data.frame</code>,
the data are stored on disk.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getData(
  data,
  varnames = NULL,
  drop = FALSE,
  dropUnusedLevels = TRUE,
  dropOmittedLevels = TRUE,
  defaultConditions = TRUE,
  formula = NULL,
  recode = NULL,
  includeNaLabel = FALSE,
  addAttributes = FALSE,
  returnJKreplicates = TRUE,
  omittedLevels = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an <code>edsurvey.data.frame</code> or
a <code>light.edsurvey.data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>a character vector of variable names that will be returned.
When both <code>varnames</code> and
a <code>formula</code> are specified, variables associated with both are
returned. Set to <code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>a logical value. When set to the default value of <code>FALSE</code>,
when a single column is returned, it is still represented as a
<code>data.frame</code> and is not converted to a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropUnusedLevels</code></td>
<td>
<p>a logical value. When set to the default value of
<code>TRUE</code>, drops unused levels of all factor
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropOmittedLevels</code></td>
<td>
<p>a logical value. When set to the default value of
<code>TRUE</code>, drops those levels of all factor variables
that are specified in an <code>edsurvey.data.frame</code>. Use
<code>print</code> on an <code>edsurvey.data.frame</code> to see
the omitted levels. The omitted levels also can be
adjusted with <code>setAttributes</code>; see Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaultConditions</code></td>
<td>
<p>a logical value. When set to the default value of
<code>TRUE</code>, uses the default conditions stored in
an <code>edsurvey.data.frame</code> to subset the data. Use
<code>print</code> on an <code>edsurvey.data.frame</code> to
see the default conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code>.
When included, <code>getData</code> returns data associated with
all variables of the <code>formula</code>. When both <code>varnames</code> and a
formula are specified, the variables associated with both are
returned. Set to <code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recode</code></td>
<td>
<p>a list of lists to recode variables. Defaults to <code>NULL</code>.
Can be set as <code>recode</code> <code>=</code> <code>list(var1</code>
<code>=</code> <code>list(from</code> <code>=</code> <code>c("a","b","c"), to</code>
<code>=</code> <code>"d"))</code>. See Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includeNaLabel</code></td>
<td>
<p>a logical value to indicate if <code>NA</code> (missing) values are
returned as literal <code>NA</code> values or as factor levels
coded as <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addAttributes</code></td>
<td>
<p>a logical value set to <code>TRUE</code> to get a
<code>data.frame</code> that can be used in calls to
other functions that usually would take an
<code>edsurvey.data.frame</code>. This <code>data.frame</code> also is called a <code>light.edsurvey.data.frame</code>.
See Description section in <code>edsurvey.data.frame</code> for
more information on <code>light.edsurvey.data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnJKreplicates</code></td>
<td>
<p>a logical value indicating if JK replicate weights
should be returned. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omittedLevels</code></td>
<td>
<p>this argument is deprecated. Use <code>dropOmittedLevels</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, an <code>edsurvey.data.frame</code> does not have data read
into memory until <code>getData</code> is called and returns a data frame.
This structure allows <code>EdSurvey</code> to have a minimal memory footprint.
To keep the footprint small, you need to limit <code>varnames</code> to just
the necessary variables.
</p>
<p>There are two methods of attaching survey attributes to a <code>data.frame</code>
to make it usable by the functions in the <code>EdSurvey</code> package (e.g., <code>lm.sdf</code>):
(a) setting the <code>addAttributes</code> argument to <code>TRUE</code> at in the call to <code>getData</code>
or (b) by appending the attributes to the data frame with <code>rebindAttributes</code>.
</p>
<p>When <code>getData</code> is called, it returns a data frame. Setting the
<code>addAttributes</code> argument to <code>TRUE</code> adds the survey attributes and
changes the resultant <code>data.frame</code> to a <code>light.edsurvey.data.frame</code>.
</p>
<p>Alternatively, a <code>data.frame</code> can be coerced into a <code>light.edsurvey.data.frame</code>
using <code>rebindAttributes</code>. See Examples in the <code>rebindAttributes</code> documentation.
</p>
<p>If both <code>formula</code> and <code>varnames</code> are populated, the
variables on both will be included.
</p>
<p>See the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-getData.pdf"><em>Using the <code>getData</code> Function in EdSurvey</em></a>
for long-form documentation on this function.
</p>


<h3>Value</h3>

<p>When <code>addAttributes</code> is <code>FALSE</code>, <code>getData</code> returns a
<code>data.frame</code> containing data associated with the requested
variables. When <code>addAttributes</code> is <code>TRUE</code>, <code>getData</code> returns a
<code>light.edsurvey.data.frame</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Fink, Paul Bailey, and Ahmad Emad
</p>


<h3>See Also</h3>

<p><code>rebindAttributes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# read in the example data (generated, not real student data)
sdf &lt;- readNAEP(path=system.file("extdata/data", "M36NT2PM.dat", package = "NAEPprimer"))

# get two variables, without weights
df &lt;- getData(data=sdf, varnames=c("dsex", "b017451"))
table(df)

# example of using recode
df2 &lt;- getData(data=sdf, varnames=c("dsex", "t088301"),
               recode=list(t088301=list(from=c("Yes, available","Yes, I have access"),
                                        to=c("Yes")),
                           t088301=list(from=c("No, have no access"),
                                        to=c("No"))))
table(df2)

# when readNAEP is called on a data file, it appends a default 
# condition to the edsurvey.data.frame. You can see these conditions
# by printing the sdf
sdf

# As per the default condition specified, getData restricts the data to only
# Reporting Sample. This behavior can be changed as follows:
df2 &lt;- getData(data=sdf, varnames=c("dsex", "b017451"), defaultConditions = FALSE)
table(df2)

# similarly, the default behavior of omitting certain levels specified
# in the edsurvey.data.frame can be changed as follows:
df2 &lt;- getData(data=sdf, varnames=c("dsex", "b017451"), omittedLevels = FALSE)
table(df2)

# omittedLevels can also be edited with setAttributes()
# here, the omitted level "Multiple" is removed from the list
sdfIncludeMultiple &lt;- setAttributes(data=sdf, attribute="omittedLevels", value=c(NA, "Omitted"))
# check that it was set
getAttributes(data=sdfIncludeMultiple, attribute="omittedLevels")
# notice that omittedLevels is TRUE, removing NA and "Omitted" still
dfIncludeMultiple &lt;- getData(data=sdfIncludeMultiple, varnames=c("dsex", "b017451"))
table(dfIncludeMultiple)

# the variable "c052601" is from the school-level data file; merging is handled automatically.
# returns a light.edsurvey.data.frame using addAttributes=TRUE argument
gddat &lt;- getData(data=sdf, 
                 varnames=c("composite", "dsex", "b017451","c052601"),
                 addAttributes = TRUE)
class(gddat)
# look at the first few lines
head(gddat)

# get a selection of variables, recode using ifelse, and reappend attributes
# with rebindAttributes so that it can be used with EdSurvey analysis functions
df0 &lt;- getData(data=sdf, varnames=c("composite", "dsex", "b017451", "origwt"))
df0$sex &lt;- ifelse(df0$dsex=="Male", "boy", "girl")
df0 &lt;- rebindAttributes(data=df0, attributeData=sdf)

# getting all the data can use up all the memory and is generally a bad idea
df0 &lt;- getData(data=sdf, varnames=colnames(sdf),
               omittedLevels=FALSE, defaultConditions=FALSE)

## End(Not run)
</code></pre>


</div>