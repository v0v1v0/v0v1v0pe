<div class="container">

<table style="width: 100%;"><tr>
<td>weightByDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Proximity-based weighting for occurrences to correct for spatial bias</h2>

<h3>Description</h3>

<p>This function calculates weights for points based on proximity to other points and the distance of spatial autocorrelation.<br><br></p>


<h3>Usage</h3>

<pre><code class="language-R">weightByDist(x, maxDist, alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A spatial points object of class <code>SpatVector</code> or <code>sf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxDist</code></td>
<td>
<p>Maximum distance beyond which a two neighboring points are assumed to have no effect on one another for calculation of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Scaling parameter (see equations above).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Weights can be used, for example, to account for spatial bias in the manner in which the points were observed. Weighting is calculated on the assumption that if two points fell exactly on top of one another, they should each have a weight of 1/2. If three points had the exact same coordinates, then their weights should be 1/3, and so on.  Increasing distance between points should increase their weight, up to the distance at which there is no "significant" spatial autocorrelation, beyond which a point should have a weight of 1. This distance needs to be supplied by the user, as it will depend on the intended use of the weights. The distance can be calculated from "standard" metrics of spatial autocorrelation (e.g., a variogram), or on the basis of knowledge of the system (e.g., maximum dispersal distance of an organism). <br><br>
For a given point <code class="reqn">i</code>, the weight is defined as </p>
<p style="text-align: center;"><code class="reqn">w_i = 1 / (1 + \epsilon)</code>
</p>
<p> where </p>
<p style="text-align: center;"><code class="reqn">\epsilon = \sum_{n=1}^{N}((1 - d_n)/d_sac)^\alpha</code>
</p>
<p> in which <code class="reqn">N</code> is the total number of points closer than the maximum distance (<code class="reqn">d_sac</code>) of point <code class="reqn">i</code>, and <code class="reqn">d_n</code> the distance between focal point <code class="reqn">i</code> and point <code class="reqn">n</code>.  <code class="reqn">\alpha</code> is a weighting factor. By default, this is set to 1, but can be changed by the user to augment or diminish the effect that neighboring points have on the weight of a focal cell. When <code class="reqn">\alpha</code> is &lt;1, neighboring points will reduce the weight of the focal point relative to the default, and when <code class="reqn">\alpha</code> is &gt;1, they will have less effect relative to the default. When all neighboring points are at or beyond the maximum distance of spatial autocorrelation, then the focal point gets a weight <code class="reqn">w_i</code> of 1. When at least neighboring one point is less than this distance away, the weight of the focal point will be &gt;0 but &lt;1.
</p>


<h3>Value</h3>

<p>A numeric vector of weights.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(sf)

# lemur occurrence data
data(lemurs)
wgs84 &lt;- getCRS('WGS84')
occs &lt;- lemurs[lemurs$species == 'Eulemur fulvus', ]
occs &lt;- sf::st_as_sf(occs, coords=c('longitude', 'latitude'), crs=wgs84)

# weights
maxDist &lt;- 30000 # in meters, for this example
w &lt;- weightByDist(occs, maxDist)

# plot
plot(st_geometry(occs), cex=5 * w, main='point size ~ weight')
plot(st_geometry(mad0), col='gainsboro', border='gray70', add=TRUE)
plot(st_geometry(occs), cex=5 * w, add=TRUE)

</code></pre>


</div>