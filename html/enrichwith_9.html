<div class="container">

<table style="width: 100%;"><tr>
<td>enrich.glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Enrich objects of class <code>glm</code>
</h2>

<h3>Description</h3>

<p>Enrich objects of class <code>glm</code> with any or all of a set
of auxiliary functions, the maximum likelihood estimate of the
dispersion parameter, the expected or observed information at the
maximum likelihood estimator, and the first term in the expansion
of the bias of the maximum likelihood estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'glm'
enrich(object, with = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class glm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with</code></td>
<td>
<p>a character vector of options for the enrichment of <code>object</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments to be passed to the
<code>compute_*</code> functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>auxiliary_functions</code> component consists of any or all of the following functions:
</p>

<ul>
<li> <p><code>score</code>: the log-likelihood derivatives as a function of the model parameters; see <code>get_score_function.glm</code>
</p>
</li>
<li> <p><code>information</code>: the expected or observed information as a function of the model parameters; see <code>get_information_function.glm</code>
</p>
</li>
<li> <p><code>bias</code>: the first-order term in the expansion of the bias of the maximum likelihood estimator as a function of the model parameters; see <code>get_bias_function.glm</code>
</p>
</li>
<li> <p><code>simulate</code>: a <code>simulate</code> function for <code>glm</code> objects that can simulate variates from the model at user-supplied parameter values for the regression parameters and the dispersion (default is the maximum likelihood estimates); see <code>get_simulate_function.glm</code>
</p>
</li>
<li> <p><code>dmodel</code>: computes densities or probability mass functions under the model at user-supplied <code>data.frame</code>s and at user-supplied values for the regression parameters and the dispersion, if any (default is at the maximum likelihood estimates); see <code>get_dmodel_function.glm</code>
</p>
</li>
<li> <p><code>pmodel</code>: computes distribution functions under the model at user-supplied <code>data.frame</code>s and at user-supplied values for the regression parameters and the dispersion, if any (default is at the maximum likelihood estimates); see <code>get_pmodel_function.glm</code>
</p>
</li>
<li> <p><code>qmodel</code>: computes quantile functions under the model at user-supplied <code>data.frame</code>s and at user-supplied values for the regression parameters and the dispersion, if any (default is at the maximum likelihood estimates); see <code>get_qmodel_function.glm</code>
</p>
</li>
</ul>
<h3>Value</h3>

<p>The object <code>object</code> of class <code>glm</code> with extra
components. See <code>get_enrichment_options.glm()</code> for the
components and their descriptions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# A Gamma example, from McCullagh &amp; Nelder (1989, pp. 300-2)
clotting &lt;- data.frame(
   u = c(5,10,15,20,30,40,60,80,100, 5,10,15,20,30,40,60,80,100),
   time = c(118,58,42,35,27,25,21,19,18,69,35,26,21,18,16,13,12,12),
   lot = factor(c(rep(1, 9), rep(2, 9))))
cML &lt;- glm(time ~ lot*log(u), data = clotting, family = Gamma)

# The simulate method for the above fit would simulate at coef(cML)
# for the regression parameters and MASS::gamma.dispersion(cML) for
# the dispersion. It is not possible to simulate at different
# parameter values than those, at least not, without "hacking" the
# cML object.

# A general simulator for cML results via its enrichment with
# auxiliary functions:
cML_functions &lt;- get_auxiliary_functions(cML)
# which is a shorthand for
# enriched_cML &lt;- enrich(cML, with = "auxiliary functions")
# cML_functions &lt;- enriched_cML$auxiliary_functions

# To simulate 2 samples at the maximum likelihood estimator do
dispersion_mle &lt;- MASS::gamma.dispersion(cML)
cML_functions$simulate(coef = coef(cML),
                       dispersion = dispersion_mle,
                       nsim = 2, seed = 123)
# To simulate 5 samples at c(0.1, 0.1, 0, 0) and dispersion 0.2 do
cML_functions$simulate(coef = c(0.1, 0.1, 0, 0),
                       dispersion = 0.2,
                       nsim = 5, seed = 123)


## End(Not run)

## Not run: 

## Reproduce left plot in Figure 4.1 in Kosimdis (2007)
## (see http://www.ucl.ac.uk/~ucakiko/files/ikosmidis_thesis.pdf)
mod &lt;- glm(1 ~ 1, weights = 10, family = binomial())
enriched_mod &lt;- enrich(mod, with = "auxiliary functions")
biasfun &lt;- enriched_mod$auxiliary_functions$bias
probabilities &lt;- seq(1e-02, 1 - 1e-02, length = 100)
biases &lt;- Vectorize(biasfun)(qlogis(probabilities))
plot(probabilities, biases, type = "l", ylim = c(-0.5, 0.5),
     xlab = expression(pi), ylab = "first-order bias")
abline(h = 0, lty = 2); abline(v = 0.5, lty = 2)
title("First-order bias of the MLE of the log-odds", sub = "m = 10")

## End(Not run)
</code></pre>


</div>