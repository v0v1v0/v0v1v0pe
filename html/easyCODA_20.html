<div class="container">

<table style="width: 100%;"><tr>
<td>LRA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Logratio analysis
</h2>

<h3>Description</h3>

<p>Computation of weighted or unweighted logratio analysis of a samples-by-parts compositional data table.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LRA(data, nd = 2, weight = TRUE, suprow = NA, row.wt = NA, amalg = NA, supamalg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame or matrix of compositional data, with no zero values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd</code></td>
<td>

<p>Number of dimensions for summary solution if not 2 (default)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>TRUE (default) for part weighting, FALSE for unweighted analysis, or a vector of user-defined part weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suprow</code></td>
<td>

<p>Indices of rows that are supplementary points
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.wt</code></td>
<td>

<p>Optional user-defined set of positive weights for the rows (samples) (default: equal weights)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amalg</code></td>
<td>

<p>Optional list of amalgamated parts 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supamalg</code></td>
<td>

<p>FALSE (default) when amalgamations are active and their subparts supplementary, TRUE when amalgamations are supplementary and their parts active  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>LRA</code> computes a log-ratio analysis of a table of compositional data based on the singular value decomposition. 
By default the weighted log-ratio analysis is computed (Greenacre &amp; Lewi 2009). 
For the unweighted logratio analysis (Aitchison &amp; Greenacre 2002), specify the option <code>weight=FALSE</code>. 
</p>
<p>User-specified weights can be supplied, for the rows and/or the columns.
Usually row weights are not specified, and are equal unless intentional weighting of the samples is desired.
Default column weights (if <code>weight = TRUE</code>) are the part means of the true compositional table, thus summing to 1.
User-specified part weights can be provided using the same <code>weight</code> option. 
</p>
<p>Supplementary rows can be declared (also known as passive points) â€“ these do not contribute to the solution but are positioned on the solution axes.
</p>
<p>Amalgamations can be defined and can either replace their constituent parts (default) or be declared supplementary using the <code>supamalg</code> option: <code>supamalg = FALSE</code> (default), <code>= TRUE</code> if all declared amalgamations are supplementary.
</p>
<p>The function borrows the structure and functions of the <code>ca</code> package, which is required, and produces a <code>ca</code> object, and the same <code>print</code>, <code>summary</code> and <code>plot</code> methods can be used, as for a <code>ca</code> object.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sv        </code></td>
<td>
<p>Singular values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd        </code></td>
<td>
<p>Number of dimensions in solution results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rownames  </code></td>
<td>
<p>Row names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowmass   </code></td>
<td>
<p>Row weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowdist   </code></td>
<td>
<p>Row logratio distances to centroid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowinertia</code></td>
<td>
<p>Row inertias</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowcoord  </code></td>
<td>
<p>Row standard coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowpcoord </code></td>
<td>
<p>Row principal coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowsup    </code></td>
<td>
<p>Indices of row supplementary points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnames  </code></td>
<td>
<p>Column names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colmass   </code></td>
<td>
<p>Column weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coldist   </code></td>
<td>
<p>Column logratio distances to centroid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colinertia</code></td>
<td>
<p>Column inertias</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colcoord  </code></td>
<td>
<p>Column standard coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpcoord </code></td>
<td>
<p>Column principal coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N         </code></td>
<td>
<p>The compositional data table</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Greenacre
</p>


<h3>References</h3>

<p>Aitchison, J. and Greenacre, M. (2002), Biplots of compositional data, Applied Statistics 51, 375-392.<br>
Greenacre, M. and Lewi, P.J. (2009), Distributional equivalence and subcompositional coherence in the analysis of compositional data, contingency tables and ratio scale measurements. Journal of Classification 26, 29-54.
Greenacre, M. (2020), Amalgamations are valid in compositional data analysis, can be used in agglomerative clustering, and their logratios have an inverse transformation. Applied Computing and Geosciences 5, 100017.
</p>


<h3>See Also</h3>

<p><code>plot.ca</code>, <code>summary.ca</code>, <code>print.ca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># (weighted) LRA of the RomanCups data set, showing default symmetric map
data("cups")
PLOT.LRA(LRA(cups))
# (unweighted) LRA of the RomanCups data set, showing default symmetric map
# the solution is completely different
PLOT.LRA(LRA(cups, weight=FALSE))
</code></pre>


</div>