<div class="container">

<table style="width: 100%;"><tr>
<td>bbinompdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability density for a hierarchical prior setup for the elements of the adjacency matrix based on the beta binomial distribution</h2>

<h3>Description</h3>

<p>A hierarchical prior setup can be used in <code>W_priors</code> to anchor the prior
number of expected neighbors. Assuming a <em>fixed</em> prior inclusion probability <code class="reqn">\underline{p}=1/2</code>
for the off-diagonal entries in the binary <code class="reqn">n</code> by <code class="reqn">n</code> adjacency matrix <code class="reqn">\Omega</code> implies
that the number of neighbors (i.e. the row sums of <code class="reqn">\Omega</code>) follows a Binomial distribution
with a prior expected number of neighbors for the <code class="reqn">n</code> spatial observations of <code class="reqn">(n-1)\underline{p}</code>.
However, such a prior structure has the potential undesirable effect of promoting a relatively large
number of neighbors. To put more prior weight on parsimonious neighborhood structures and promote sparsity
in <code class="reqn">\Omega</code>, the beta binomial prior accounts for the number of neighbors in each row of <code class="reqn">\Omega</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bbinompdf(x, nsize, a, b, min_k = 0, max_k = nsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Number of neighbors (scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsize</code></td>
<td>
<p>Number of potential neighbors: <code>nsize</code><code class="reqn">=(n-1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Scalar prior parameter <code class="reqn">a</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Scalar prior parameter <code class="reqn">b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_k</code></td>
<td>
<p>Minimum prior number of neighbors (defaults to 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_k</code></td>
<td>
<p>Maximum prior number of neighbors (defaults to <code>nsize</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The beta-binomial distribution is the result of treating the prior inclusion probability <code class="reqn">\underline{p}</code>
as random (rather than being fixed) by placing a hierarchical beta prior on it.
For the number of neighbors <code class="reqn">x</code>, the resulting prior on the elements of <code class="reqn">\Omega</code>, <code class="reqn">\omega_{ij}</code>,
can be written as:
</p>
<p style="text-align: center;"><code class="reqn">
 p(\omega_{ij} = 1 | x)\propto \Gamma\left(a+ x \right)\Gamma\left(b+(n-1)-x\right),
 </code>
</p>

<p>where <code class="reqn">\Gamma(\cdot )</code> is the Gamma function, and <code class="reqn">a</code> and
<code class="reqn">b</code> are hyperparameters from the beta prior. In the case of <code class="reqn">a = b = 1</code>, the prior takes the
form of a discrete uniform distribution over the number of neighbors. By fixing <code class="reqn">a = 1</code>
the prior can be anchored around the expected number of neighbors <code class="reqn">m</code> through
<code class="reqn">b=[(n-1)-m]/m</code> (see Ley and Steel, 2009).
</p>
<p>The prior can be truncated by setting a minimum (<code>min_k</code>) and/or a maximum number of
neighbors (<code>max_k</code>). Values outside this range have zero prior support.
</p>


<h3>Value</h3>

<p>Prior density evaluated at <code>x</code>.
</p>


<h3>References</h3>

<p>Ley, E., &amp; Steel, M. F. (2009). On the effect of prior assumptions in Bayesian
model averaging with applications to growth regression. <em>Journal of Applied Econometrics</em>,
<b>24(4)</b>. <a href="https://doi.org/10.1002/jae.1057">doi:10.1002/jae.1057</a>.
</p>


</div>