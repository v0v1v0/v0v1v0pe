<div class="container">

<table style="width: 100%;"><tr>
<td>overall_infectivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Overall Infectivity Due To Previously Infected Individuals</h2>

<h3>Description</h3>

<p><code>overall_infectivity</code> computes the overall infectivity due to previously
infected individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">overall_infectivity(incid, si_distr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>incid</code></td>
<td>
<p>One of the following </p>
 <ul>
<li>
<p>A vector (or a dataframe
with a single column) of non-negative integers containing an incidence time
series </p>
</li>
<li>
<p>A dataframe of non-negative integers with two columns, so
that <code>incid$local</code> contains the incidence of cases due to local
transmission and <code>incid$imported</code> contains the incidence of imported
cases (with <code>incid$local + incid$imported</code> the total incidence). </p>
</li>
</ul>
<p>Note that the cases from the first time step are always all assumed to be
imported cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si_distr</code></td>
<td>
<p>Vector of probabilities giving the discrete distribution of
the serial interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The overall infectivity <code class="reqn">\lambda_t</code> at time step <code class="reqn">t</code> is
equal to the sum of the previously infected individuals (given by the
incidence vector <code class="reqn">I</code>, with <code>I = incid$local + incid$imported</code> if
<code class="reqn">I</code> is a matrix), weigthed by their infectivity at time <code class="reqn">t</code> (given by
the discrete serial interval distribution <code class="reqn">w_k</code>). In mathematical terms: 
<br><code class="reqn">\lambda_t = \sum_{k=1}^{t-1}I_{t-k}w_k</code> <br></p>


<h3>Value</h3>

<p>A vector which contains the overall infectivity <code class="reqn">\lambda_t</code> at
each time step
</p>


<h3>Author(s)</h3>

<p>Anne Cori <a href="mailto:a.cori@imperial.ac.uk">a.cori@imperial.ac.uk</a>
</p>


<h3>References</h3>

<p>Cori, A. et al. A new framework and software to estimate
time-varying reproduction numbers during epidemics (AJE 2013).
</p>


<h3>See Also</h3>

<p><code>discr_si</code>, <code>estimate_R</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data on pandemic flu in a school in 2009
data("Flu2009")

## compute overall infectivity
lambda &lt;- overall_infectivity(Flu2009$incidence, Flu2009$si_distr)
par(mfrow=c(2,1))
plot(Flu2009$incidence, type = "s", xlab = "time (days)", ylab = "incidence")
title(main = "Epidemic curve")
plot(lambda, type = "s", xlab = "time (days)", ylab = "Infectivity")
title(main = "Overall infectivity")
</code></pre>


</div>