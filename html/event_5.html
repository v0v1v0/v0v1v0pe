<div class="container">

<table style="width: 100%;"><tr>
<td>ehr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression Models for Event History Intensity Functions</h2>

<h3>Description</h3>

<p><code>ehr</code> fits an intensity function to event histories, where point is
produced by <code>point &lt;- pp(y)</code> and <code>lambda</code> is the user-defined
log intensity function.
</p>
<p>Nonlinear regression models for <code>lambda</code> can be supplied as
formulae where parameters are unknowns. Factor variables cannot be
used and parameters must be scalars. (See <code>finterp</code>.)
</p>


<h3>Usage</h3>

<pre><code class="language-R">ehr(point, lambda=NULL, linear=NULL, plambda=NULL, delta=1,
	envir=parent.frame(), print.level=0, typsize=rep(1,length(plambda)),
	ndigit=10, gradtol=0.00001, iterlim=100, fscale=1,
	stepmax=max(10*sqrt(plambda%*%plambda),10), steptol=0.0004)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>
<p>A point process vector produced by <code>pp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>User-specified function of <code>p</code>, and possibly
<code>linear</code>, giving the regression equation for the intensity or a
formula beginning with ~, specifying either a linear regression
function in the Wilkinson and Rogers notation or a general function
with named unknown parameters. The function may contain a
linear part that must simply be given the name, <code>linear</code>, in the
function. If no function is supplied, the intensity is taken to be
constant (a homogeneous Poisson process).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear</code></td>
<td>
<p>A formula beginning with ~ specifying the linear part of
the regression function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plambda</code></td>
<td>
<p>Vector of initial parameter estimates. If <code>lambda</code>
is a formula with unknown parameters, their estimates must be supplied
either in their order of appearance in the expression or in a named list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>If any time intervals are different from unity, a vector
of time intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>Environment in which model formulae are to be
interpreted or a data object of class, repeated, tccov, or tvcov.
If <code>point</code> has class <code>repeated</code>, it is used as the
environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p><code>nlm</code> control options.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>J.K. Lindsey</p>


<h3>References</h3>

<p>Lindsey, J.K. (1995) Fitting parametric counting processes by
using log linear models. Journal of the Royal Statistical
Society C44, 201-212.
</p>


<h3>See Also</h3>

<p><code>bp</code>, <code>finterp</code>,
<code>ident</code>, <code>pp</code>,
<code>tccov</code>, <code>tpast</code>,
<code>ttime</code>, <code>tvcov</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- c(5,3,2,4)
# event indicator
py &lt;- pp(y)
# time since previous event
ptime &lt;- tpast(y)
# individual ID
i &lt;- c(1,1,2,2)
id &lt;- ident(y, i)
# times and corresponding covariate values
tx &lt;- c(2,3,1,2,2,2,2)
x &lt;- c(1,2,2,1,2,2,1)
zcov &lt;- tvcov(y, x, tx)
# Poisson process
ehr(py, plambda=1)
# Weibull process
lambda1 &lt;- function(p) p[1]+p[2]*log(ptime)
ehr(py, lambda=lambda1, plambda=c(1,1))
# or
ehr(py, lambda=~log(ptime), plambda=c(1,1))
# or
ehr(py, lambda=~b0+b1*log(ptime), plambda=list(b0=1,b1=1))
# Poisson process with time-varying covariate
lambda2 &lt;- function(p) p[1]+p[2]*zcov
ehr(py, lambda=lambda2, plambda=c(1,1))
# or
ehr(py, lambda=~zcov, plambda=c(1,1))
# or
ehr(py, lambda=~c0+c1*zcov, plambda=list(c0=1,c1=1))
# Weibull process with time-varying covariate
lambda3 &lt;- function(p) p[1]+p[2]*log(ptime)+p[3]*zcov
ehr(py, lambda=lambda3, plambda=c(1,1,1))
# or
ehr(py, lambda=~log(ptime)+zcov, plambda=c(1,1,1))
# or
ehr(py, lambda=~c0+b1*log(ptime)+c1*zcov, plambda=list(c0=1,c1=1,b1=1))
# gamma process with time-varying covariate
lambda4 &lt;- function(p) hgamma(ptime, p[1], exp(p[2]+p[3]*zcov))
ehr(py, lambda=lambda4, plambda=c(1,1,1))
# or
ehr(py, lambda=~hgamma(ptime, b1, exp(c0+c1*zcov)),
	plambda=list(c0=1,c1=1,b1=1))
# or
lambda5 &lt;- function(p, linear) hgamma(ptime, p[1], exp(linear))
ehr(py, lambda=lambda5, linear=~zcov, plambda=c(1,1,1))
</code></pre>


</div>