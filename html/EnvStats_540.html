<div class="container">

<table style="width: 100%;"><tr>
<td>stat_test_text</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add Text to a ggplot2 Plot Indicating the Results of a Hypothesis Test  
</h2>

<h3>Description</h3>

<p>For a strip plot or scatterplot produced using the package ggplot2
(e.g., with <code>geom_point</code>), 
add text indicating the results of a hypothesis test comparing locations 
betweeen groups, where the groups are defined based on the unique <code class="reqn">x</code>-values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  stat_test_text(mapping = NULL, data = NULL, 
    geom = ifelse(text.box, "label", "text"), position = "identity", 
    na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, 
    y.pos = NULL, y.expand.factor = 0.35, test = "parametric", 
    paired = FALSE, test.arg.list = list(), two.lines = TRUE, 
    p.value.digits = 3, p.value.digit.type = "round", 
    location.digits = 1, location.digit.type = "round", 
    nsmall = ifelse(location.digit.type == "round", location.digits, 0), 
    text.box = FALSE, alpha = 1, angle = 0, color = "black", 
    family = "", fontface = "plain", hjust = 0.5, 
    label.padding = ggplot2::unit(0.25, "lines"), 
    label.r = ggplot2::unit(0.15, "lines"), label.size = 0.25, 
    lineheight = 1.2, size = 4, vjust = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapping, data, position, na.rm, show.legend, inherit.aes</code></td>
<td>

<p>See the help file for <code>geom_text</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom</code></td>
<td>

<p>Character string indicating which <code>geom</code> to use to display the text.   
Setting <code>geom="text"</code> will use <code>geom_text</code> to display the text, and 
setting <code>geom="label"</code> will use <code>geom_label</code> to display the text.  
The default value is <code>geom="text"</code> unless the user sets <code>text.box=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.pos</code></td>
<td>

<p>Numeric scalar indicating the <code class="reqn">y</code>-position of the text (i.e., the value of the 
argument <code>y</code> that will be used in the call to <code>geom_text</code> or 
<code>geom_label</code>).  The default value is <code>y.pos=NULL</code>, in which 
case <code>y.pos</code> is set to the maximum value of all <code class="reqn">y</code>-values plus 
a proportion of the range of all <code class="reqn">y</code>-values, where the proportion is 
determined by the argument <code>y.expand.factor</code> (see below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.expand.factor</code></td>
<td>

<p>For the case when <code>y.pos=NULL</code>, a numeric scalar indicating the proportion 
by which the range of all <code class="reqn">y</code>-values should be multiplied by before adding 
this value to the maximum value of all <code class="reqn">y</code>-values in order to compute the 
value of the argument <code>y.pos</code> (see above).  
The default value is <code>y.expand.factor=0.35</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>A character string indicating whether to use a standard parametric test 
(<code>test="parametric"</code>, the default) or nonparametric test 
(<code>test="nonparametric"</code>) to compare groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>

<p>For the case of two groups, a logical scalar indicating whether the data 
should be considered to be paired.  The default value is <code>paired=FALSE</code>.
</p>
<p>NOTE: if the argument <code>test.arg.list</code> is supplied and it includes a 
component named <code>paired</code>, the value of that component 
is overriden by the value of the argument <code>paired</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.arg.list</code></td>
<td>

<p>An optional list of arguments to pass to the function used to test for 
group differences in location.  The default value is an empty list:  
<code>test.arg.list=list()</code>.  In particular, when there are two groups, 
<code>ci.and.test="parametric"</code>, and <code>ci.arg.list</code> does not contain 
a component specifying the value for <code>var.equal</code>, this argument is 
updated to include the component <code>var.equal=TRUE</code>, which is <b>not</b> 
the default behavior of <code>t.test</code>.
</p>
<p>NOTE: If <code>test.arg.list</code> contains a component named <code>"paired"</code>, 
the value of that component is set to the value of the argument <code>paired</code> 
(see above).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.lines</code></td>
<td>

<p>For the case of one or two groups, a logical scalar indicating whether the 
associated confidence interval should be be displayed on a second line 
instead of on the same line as the p-value.  The default is <code>two.lines=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.digits</code></td>
<td>

<p>An integer indicating the number of digits to use for displaying the 
p-value.  When <code>p.value.digit.type="round"</code> (see below) 
the argument <code>p.value.digits</code> indicates the number of digits to round to, 
and when <code>p.value.digit.type="signif"</code> the argument <code>p.value.digits</code> 
indicates the number of significant digits to display.  
The default value is <code>p.value.digits=3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.digit.type</code></td>
<td>

<p>A character string indicating whether the <code>p.value.digits</code> argument (see above) 
refers to significant digits (<code>p.value.digit.type="signif"</code>), or how many decimal 
places to round to (<code>p.value.digit.type="round"</code>, the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location.digits</code></td>
<td>

<p>For the case of one or two groups, an integer indicating the number of digits 
to use for displaying the associated confidence interval.    
When <code>location.digit.type="round"</code> (see below) 
the argument <code>location.digits</code> indicates the number of digits to round to, 
and when <code>location.digit.type="signif"</code> the argument <code>location.digits</code> 
indicates the number of significant digits to display.  
The default value is <code>location.digits=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location.digit.type</code></td>
<td>

<p>For the case of one or two groups, a character string indicating 
whether the <code>location.digits</code> argument (see above) 
refers to significant digits <br>
(<code>location.digit.type="signif"</code>), or how many decimal 
places to round to (<code>location.digit.type="round"</code>; the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsmall</code></td>
<td>

<p>For the case of one or two groups, an integer passed to the function 
<code>format</code> indicating the the minimum number of digits to use 
to the right of the decimal point for the associated confidence interval.
The default value is <code>nsmall=digits</code> when <code>digit.type="round"</code> and 
<code>nsmall=0</code> when <code>digit.type="signif"</code>.  When <code>nsmall</code> is greater than 0, 
the two confidence limits will have the same number of digits to the 
right of the decimal point (including, possibly, trailing zeros). 
To omit trailing zeros, set <code>nsmall=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.box</code></td>
<td>

<p>Logical scalar indicating whether to surround the text with a text box (i.e., 
whether to use <code>geom_label</code> instead of 
<code>geom_text</code>).  This argument can be overridden by simply 
specifying the argument <code>geom</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, angle, color, family, fontface, hjust, vjust, lineheight, size</code></td>
<td>

<p>See the help file for <code>geom_text</code> and 
the vignette <b>Aesthetic specifications</b> at 
<a href="https://cran.r-project.org/package=ggplot2/vignettes/ggplot2-specs.html">https://cran.r-project.org/package=ggplot2/vignettes/ggplot2-specs.html</a>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.padding, label.r, label.size</code></td>
<td>

<p>See the help file for <code>geom_text</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments passed on to <code>layer</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The table below shows which hypothesis tests are performed based on the number of groups 
and the values of the arguments <code>test</code> and <code>paired</code>.
</p>

<table>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>Function</b>                   </td>
</tr>
<tr>
<td style="text-align: center;">
    <b># Groups</b> </td>
<td style="text-align: left;"> <code>test</code>            </td>
<td style="text-align: left;"> <code>paired</code> </td>
<td style="text-align: left;"> <b>Name</b>               </td>
<td style="text-align: left;"> <b>Called</b>                     </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
         1          </td>
<td style="text-align: left;"> <code>"parametric"</code>    </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> One-Sample t-test         </td>
<td style="text-align: left;"> <code>t.test</code>       </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;"> <code>"nonparametric"</code> </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> Wilcoxon Signed Rank Test </td>
<td style="text-align: left;"> <code>wilcox.test</code>  </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
         2          </td>
<td style="text-align: left;"> <code>"parametric"</code>    </td>
<td style="text-align: left;"> <code>FALSE</code>  </td>
<td style="text-align: left;"> Two-Sample t-test         </td>
<td style="text-align: left;"> <code>t.test</code>       </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;"> <code>TRUE</code>   </td>
<td style="text-align: left;"> Paired t-test             </td>
<td style="text-align: left;"> <code>t.test</code>       </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;"> <code>"nonparametric"</code> </td>
<td style="text-align: left;"> <code>FALSE</code>  </td>
<td style="text-align: left;"> Wilcoxon Rank Sum Test    </td>
<td style="text-align: left;"> <code>wilcox.test</code>  </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;"> <code>TRUE</code>   </td>
<td style="text-align: left;"> Wilcoxon Signed Rank Test </td>
<td style="text-align: left;"> <code>wilcox.test</code>  </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> on Paired Differences     </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
    <code class="reqn">\ge</code> 3     </td>
<td style="text-align: left;"> <code>"parametric"</code>    </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> Analysis of Variance      </td>
<td style="text-align: left;"> <code>aov</code>          </td>
</tr>
<tr>
<td style="text-align: center;"> 
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <code>summary.aov</code>  </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;">                        </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                                   </td>
</tr>
<tr>
<td style="text-align: center;">
                    </td>
<td style="text-align: left;"> <code>"nonparametric"</code> </td>
<td style="text-align: left;">               </td>
<td style="text-align: left;"> Kruskal-Wallis Test       </td>
<td style="text-align: left;"> <code>kruskal.test</code> </td>
</tr>
<tr>
<td style="text-align: center;"> 
  </td>
</tr>
</table>
<p>See the help file for <code>geom_text</code> for details about how 
<code>geom_text</code> and <code>geom_label</code> work.
</p>
<p>See the vignette <b>Extending ggplot2</b> at  
<a href="https://cran.r-project.org/package=ggplot2/vignettes/extending-ggplot2.html">https://cran.r-project.org/package=ggplot2/vignettes/extending-ggplot2.html</a> 
for information on how to create a new stat.
</p>


<h3>Note</h3>

<p>The function <code>stat_test_text</code> is called by the function <code>geom_stripchart</code>.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Wickham, H. (2016).  <em>ggplot2:  Elegant Graphics for Data Analysis (Use R!)</em>.  
Second Edition.  Springer. 
</p>


<h3>See Also</h3>

<p><code>geom_stripchart</code>, <code>stat_mean_sd_text</code>, 
<code>stat_median_iqr_text</code>, <code>stat_n_text</code>, 
<code>geom_text</code>, <code>geom_label</code>, 
<code>t.test</code>, <code>wilcox.test</code>, 
<code>aov</code>, <code>summary.aov</code>, 
<code>kruskal.test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # First, load and attach the ggplot2 package.
  #--------------------------------------------

  library(ggplot2)

  #==========

  # Example 1:

  # Using the built-in data frame mtcars, 
  # plot miles per gallon vs. number of cylinders
  # using different colors for each level of the number of cylinders.
  #------------------------------------------------------------------

  p &lt;- ggplot(mtcars, aes(x = factor(cyl), y = mpg, color = factor(cyl))) + 
    theme(legend.position = "none")

  p + geom_point(show.legend = FALSE) + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")


  # Now add text indicating the sample size and 
  # mean and standard deviation for each level of cylinder, and 
  # test for the difference in means between groups.
  #------------------------------------------------------------

  dev.new()
  p + geom_point() + 
    stat_n_text() + stat_mean_sd_text() + 
    stat_test_text() + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")
  
  #==========

  # Example 2:

  # Repeat Example 1, but show text indicating the median and IQR, 
  # and use the nonparametric test.
  #---------------------------------------------------------------

  dev.new()
  p + geom_point() + 
    stat_n_text() + stat_median_iqr_text() + 
    stat_test_text(test = "nonparametric") + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")
 
  #==========

  # Example 3:

  # Repeat Example 1, but use only the groups with 
  # 4 and 8 cylinders.
  #-----------------------------------------------

  p &lt;- ggplot(subset(mtcars, cyl %in% c(4, 8)), 
    aes(x = factor(cyl), y = mpg, color = cyl)) + 
    theme(legend.position = "none")

  dev.new()
  p + geom_point() + 
    stat_n_text() + stat_mean_sd_text() + 
    stat_test_text() + 
    labs(x = "Number of Cylinders", y = "Miles per Gallon")

  #==========

  # Example 4:

  # Repeat Example 3, but 
  # 1) facet by transmission type,
  # 2) make the text smaller,
  # 3) put the text for the test results in a text box
  #    and make them blue.
  #---------------------------------------------------

  dev.new()
  p + geom_point() + 
    stat_n_text(size = 3) + stat_mean_sd_text(size = 3) + 
    stat_test_text(size = 3, text.box = TRUE, color = "blue") +
    facet_wrap(~ am, labeller = label_both) +  
    labs(x = "Number of Cylinders", y = "Miles per Gallon")

  #==========

  # Clean up
  #---------

  graphics.off()
  rm(p)
</code></pre>


</div>