<div class="container">

<table style="width: 100%;"><tr>
<td>compute.EPI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of EPI</h2>

<h3>Description</h3>

<p>Estimates the extremal pattern index (EPI) from either the 'm' principle components after a PCA
or left- and right expansion coefficients after an SVD. In case of a SVD,
the threshold-based EPI (TEPI) can optionally be calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute.EPI(coeff, m = 1:10, q = 0.98)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>A list, containing the t x n dimensional principle components/expansion coefficients of TPDM.
Can also be output of function 'est.tpdm'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>numeric vector: Containing the Principle Components from which EPI shall be computed (e.g. with modes = c(1:10), the EPI is calculated on first ten principle components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Optional: A threshold for computation of TEPI</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the first 'm' modes of principle components u and eigenvalues after a PCA, the EPI is given as:
</p>
<p style="text-align: center;"><code class="reqn">EPI_t^{u} = \sqrt{\sum_{k=1}^m (u_{t,k}^2)/\sum_{j=1}^m e_j}.</code>
</p>

<p>Given the first 'm' modes of expansion coefficients u and v and singular values e after a SVD, the EPI and TEPI are given as:
</p>
<p style="text-align: center;"><code class="reqn">EPI_t^{u, v} = \sqrt{\sum_{k=1}^m (u_{t,k}^2 + v_{t,k}^2)/\sum_{j=1}^m e_j}.</code>
</p>

<p style="text-align: center;"><code class="reqn">TEPI_t^{u, v} = \sqrt{(\sum_{k=1}^m (u_{t,k}^2 + v_{t,k}^2)/\sum_{j=1}^m e_j) |_{(|u_{t,k}| &gt; q_u , |v{t,k}| &gt; q_v)}}.</code>
</p>



<h3>Value</h3>

<p>An array of length t, containing EPI. TEPI is computed if if q &gt; 0.
</p>


<h3>References</h3>

<p>Szemkus &amp; Friederichs (2023)
</p>


<h3>Examples</h3>

<pre><code class="language-R">data    &lt;- precipGER

data.alpha2  &lt;- to.alpha.2(data$pr)
Sigma   &lt;- est.tpdm(data.alpha2,anz_cores =1)
res.pca &lt;- pca.tpdm(Sigma, data.alpha2)
EPI &lt;- compute.EPI(res.pca, m = 1:10)

plot(data$date, EPI, type='l')
</code></pre>


</div>