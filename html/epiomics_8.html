<div class="container">

<table style="width: 100%;"><tr>
<td>owas_qgcomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform omics wide association study using qgcomp</h2>

<h3>Description</h3>

<p>Omics wide association study using quantile-based g-Computation
(as described by Keil et al., (2019) <a href="https://doi.org/10.1289/EHP5838">doi:10.1289/EHP5838</a>) to examine
associations of exposure mixtures with each individual 'omics feature as an
outcome 'omics data as either the dependent variable. Allows for either
continuous or dichotomous outcomes, and provides the option to adjust for
covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">owas_qgcomp(
  df,
  expnms,
  omics,
  covars = NULL,
  q = 4,
  confidence_level = 0.95,
  family = "gaussian",
  rr = TRUE,
  run.qgcomp.boot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expnms</code></td>
<td>
<p>Name of the exposures. Can be either continuous or
dichotomous. For dichotomous variables, must set <code>q</code> to
"NULL", and values must be either 0/1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omics</code></td>
<td>
<p>Names of all omics features in the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>Names of covariates (can be NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>NULL or number of quantiles used to create quantile indicator
variables representing the exposure variables. Defaults to 4If NULL, then
qgcomp proceeds with un-transformed version of exposures in the input
datasets (useful if data are already transformed, or for performing standard
g-computation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence_level</code></td>
<td>
<p>Confidence level for marginal significance
(defaults to 0.95, or an alpha of 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Currently only "gaussian" (default) for linear models (via lm)
or "binomial" for logistic. Default is "gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rr</code></td>
<td>
<p>see <code>qgcomp()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run.qgcomp.boot</code></td>
<td>
<p>Should the model be fit with qgcomp.boot? See
package qgcomp.boot for details. Default is TRUE.
Setting to FALSE decreases computational time.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with the following columns:
feature: name of the omics feature
psi: the model estimate for the feature. For linear models, this is the
beta; for logistic models, this is the log odds.
lcl_psi: the lower confidence interval.
ucl_psi: the upper confidence interval.
p_value: p-value for the estimate
test_statistic: t-statistic for psi coefficient
adjusted_pval: FDR adjusted p-value
threshold: Marginal significance, based on unadjusted p-values
covariates: the names of covariates in the model, if any
coef_exposure: the individual coefficient of each exposure
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Example Data
data("example_data")

# Get names of omics
colnames_omic_fts &lt;- colnames(example_data)[grep("feature_",
                                              colnames(example_data))][1:5]

# Names of exposures in mixture
 exposure_names = c("exposure1", "exposure2", "exposure3")

# Run function without covariates
out &lt;- owas_qgcomp(df = example_data,
                   expnms = exposure_names,
                   omics = colnames_omic_fts,
                   q = 4, 
                   confidence_level = 0.95) 


# Run analysis with covariates
out &lt;- owas_qgcomp(df = example_data,
                   expnms = c("exposure1", "exposure2", "exposure3"),
                   covars = c("weight", "age", "sex"),
                   omics = colnames_omic_fts,
                   q = 4, 
                   confidence_level = 0.95) 
 
</code></pre>


</div>