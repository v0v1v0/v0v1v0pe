<div class="container">

<table style="width: 100%;"><tr>
<td>beed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bernstein Polynomials Based Estimation of Extremal Dependence</h2>

<h3>Description</h3>

<p>Estimates the Pickands dependence function corresponding to multivariate data on the basis of a Bernstein polynomials approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beed(data, x, d = 3, est = c("ht","cfg","md","pick"),
     margin = c("emp","est","exp","frechet","gumbel"),
     k = 13, y = NULL, beta = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code class="reqn">(n \times d)</code> matrix of component-wise maxima. <code>d</code> is the number of variables and <code>n</code> is the number of replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code class="reqn">(m \times d)</code> design matrix where the dependence
function is evaluated (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>positive integer greater than or equal to two indicating the number of variables (<code>d = 3</code> by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>string, indicating the estimation method (<code>est="md"</code> by default, see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>string, denoting the type marginal distributions (<code>margin="emp"</code> by default, see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>postive integer, indicating the order of Bernstein
polynomials (<code>k=13</code> by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector (of size <code>m</code>) with an initial estimate of the Pickands function. If <code>NULL</code>, the initial estimate is computed using the estimation method denoted in <code>est</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of polynomial coefficients (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if <code>TRUE</code> and <code>d&lt;=3</code>, the estimated Pickands dependence function is plotted (<code>FALSE</code> by default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The routine returns an estimate of the Pickands dependence function using the Bernstein polynomials approximation
proposed in Marcon et al. (2017).
The method is based on a preliminary empirical estimate of the Pickands dependence function.
If you do not provide such an estimate, this is computed by the routine. In this case, you can select one of the empirical methods
available. <code>est = 'ht'</code> refers to the Hall-Tajvidi estimator (Hall and Tajvidi 2000).
With <code>est = 'cfg'</code> the method proposed by Caperaa et al. (1997) is considered. Note that in the multivariate case the adjusted  version of Gudendorf and Segers (2011) is used. Finally, with <code>est = 'md'</code> the estimate is based on the madogram defined in Marcon et al. (2017).
</p>
<p>Each row of the <code class="reqn">(m \times d)</code> design matrix <code>x</code> is a point in the unit <code>d</code>-dimensional simplex,
</p>
<p><code class="reqn">
S_d := \left\{ (w_1,\ldots, w_d) \in [0,1]^{d}: \sum_{i=1}^{d} w_i = 1 \right\}.
</code>
</p>
<p>With this "regularization"" method, the final estimate satisfies the neccessary conditions in order to be a Pickands dependence function.
</p>
<p><code class="reqn">A(\bold{w}) = \sum_{\bold{\alpha} \in \Gamma_k} \beta_{\bold{\alpha}} b_{\bold{\alpha}} (\bold{w};k).</code>
</p>
<p>The estimates are obtained by solving an optimization quadratic problem subject to the constraints. The latter are represented
by the following conditions:
<code class="reqn">A(e_i)=1; \max(w_i)\leq A(w) \leq 1; \forall i=1,\ldots,d;</code> (convexity).
</p>
<p>The order of polynomial <code>k</code> controls the smoothness of the estimate. The higher <code>k</code> is, the smoother the final estimate is.
Higher values are better with strong dependence (e. g. <code>k = 23</code>), whereas small values (e.g. <code>k = 6</code> or <code>k = 10</code>) are enough with mild or weak dependence.
</p>
<p>An empirical transformation of the marginals is performed when <code>margin="emp"</code>. A max-likelihood fitting of the GEV distributions is implemented when <code>margin="est"</code>. Otherwise it refers to marginal parametric GEV theorethical distributions (<code>margin = "exp", "frechet", "gumbel"</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of polynomial coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>numeric vector of the estimated Pickands dependence function <code class="reqn">A</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Anonconvex</code></td>
<td>
<p>preliminary non-convex function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extind</code></td>
<td>
<p>extremal index</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The number of coefficients depends on both the order of polynomial <code>k</code> and the dimension <code>d</code>. The number of parameters is explained in Marcon et al. (2017).
</p>
<p>The size of the vector <code>beta</code> must be compatible with the polynomial order <code>k</code> chosen.
</p>
<p>With the estimated polynomial coefficients, the extremal coefficient, i.e. <code class="reqn">d*A(1/d,\ldots,1/d)</code> is computed.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>


<h3>See Also</h3>

<p><code>beed.confband</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- simplex(2)
data &lt;- evd::rbvevd(50, dep = 0.4, model = "log", mar1 = c(1,1,1))

Amd &lt;- beed(data, x, 2, "md", "emp", 20, plot=TRUE)
Acfg &lt;- beed(data, x, 2, "cfg", "emp", 20)
Aht &lt;- beed(data, x, 2, "ht", "emp", 20)

lines(x[,1], Aht$A, lty = 1, col = 3)
lines(x[,1], Acfg$A, lty = 1, col = 2)

##################################
# Trivariate case
##################################


x &lt;- simplex(3)

data &lt;- evd::rmvevd(50, dep = 0.8, model = "log", d = 3, mar = c(1,1,1))

op &lt;- par(mfrow=c(1,3))
Amd &lt;- beed(data, x, 3, "md", "emp", 18, plot=TRUE)
Acfg &lt;- beed(data, x, 3, "cfg", "emp", 18, plot=TRUE)
Aht &lt;- beed(data, x, 3, "ht", "emp", 18, plot=TRUE)

par(op)


</code></pre>


</div>