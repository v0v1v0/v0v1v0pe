<div class="container">

<table style="width: 100%;"><tr>
<td>eBsc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Empirical Bayes Smoothing Splines with Correlated Errors
</h2>

<h3>Description</h3>

<p>Empirical Bayes smoothing splines with correlated errors. The method uses a recursive algorithm for signal extraction with a non-parametric estimation of the correlation matrix of the errors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eBsc(y, q, method, parallel, R0, zero_range, ARpMAq, trace, tol.lambda, tol.rho, max.iter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Is a univariate numeric vector without missing values. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Is the value of q if known. If left empty the method considers all possibles q's between 1 and 6 and selects the best one according to the Tq criteria. q=NULL is the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Is a method used for the fit. It can take the values "D" (deterministic fit), "P" (parametric fit) and "N" (non-parametric fit).  For example: i) to fit a model with known correlation matrix R.known one should select method = "D" and R0 = R.known; ii) to fit a model with a nonparametric estimation of the correlation and a starting correlation matrix R.start, one should select  method = "N" and R0 = R.start; and iii) to fit a model with an ARMA parametric structure R.ARMA, one should select method="P" and ARpMAq=c(1,0). method = "N" is the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Is a logical parameter indicating if parallel computation should be used. parallel=FALSE is the default.  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p>Is the starting correlation matrix. If method = "D" this matrix is not changed by the algorithm.  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_range</code></td>
<td>
<p>Is the interval to look for zeros in the estimating equation for the smoothing parameter (lambda).  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARpMAq</code></td>
<td>
<p>Is the desired ARMA structure for the noise process.  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If true, the process of the algorithm is traced and reported.  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.lambda</code></td>
<td>
<p>Tolerance level for lambda.  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.rho</code></td>
<td>
<p>Tolerance level for rho.  	  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Maximum number of iterations.  	  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method assumes the data is equidistant. 
</p>


<h3>Value</h3>

<p>A list object of class <code>eBsc</code> containing the following information.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>q.hat</code></td>
<td>
<p>estimadted q</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.hat</code></td>
<td>
<p>estimated lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.hat</code></td>
<td>
<p>estimated correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.hat</code></td>
<td>
<p>estimated function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cb.hat</code></td>
<td>
<p>estimated condidence bands at a 95% confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.hat</code></td>
<td>
<p>estimated variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etq.hat</code></td>
<td>
<p>estimating equation for q</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data used to fit the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Call of eBsc</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francisco Rosales, Paulo Serra, Tatyana Krivobokova
</p>


<h3>References</h3>

<p>Serra, P. and Krivobokova, T. (2015)<br>
Adaptive Empirical Bayesian Smoothing Splines
</p>


<h3>See Also</h3>

<p><code>stl</code> (package stats),
<code>HoltWinters</code> (package stats)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(eBsc)
n &lt;- 250
sigma &lt;- 0.05
beta &lt;- function(x,p,q){
  gamma(p+q)/(gamma(p)*gamma(q))*x^(p-1)*(1-x)^(q-1)
}
x &lt;- seq(0, 1, length.out = n)
mu &lt;- (6 * beta(x, 30, 17) + 4 * beta(x, 3, 11))/10;
mu &lt;- (mu - min(mu))/(max(mu) - min(mu))
noise &lt;- rnorm(n)
y &lt;- mu + sigma * noise

#q assumed known and equal to 3, and correlation unknown
fit &lt;- eBsc(y, method = "N", q=3)
plot(fit, full = FALSE)

</code></pre>


</div>