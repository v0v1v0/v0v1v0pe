<div class="container">

<table style="width: 100%;"><tr>
<td>redundancy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use Redundancy Rule to Simulate Ecological Diversification of a Biota.</h2>

<h3>Description</h3>

<p>Implement Monte Carlo simulation of a biota undergoing ecological
diversification using the redundancy rule.
</p>


<h3>Usage</h3>

<pre><code class="language-R">redundancy(nreps = 1, Sseed, Smax, ecospace, strength = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>Vector of integers (such as a sequence) specifying sample number
produced. Only used when function is applied within <code>lapply</code> or
related function. Default <code>nreps = 1</code> or any other integer produces a
single sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sseed</code></td>
<td>
<p>Integer giving number of species (or other taxa) to use at start
of simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Smax</code></td>
<td>
<p>Maximum number of species (or other taxa) to include in
simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecospace</code></td>
<td>
<p>An ecospace framework (functional trait space) of class
<code>ecospace</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strength</code></td>
<td>
<p>Strength parameter controlling probability that redundancy
rule is followed during simulation. Values must range between
<code>strength = 1</code> (default, rules always implemented) and <code>strength = 0</code>
(rules never implemented).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulations are implemented as Monte Carlo processes in which
species are added iteratively to assemblages, with all added species having
their character states specified by the model rules, here the 'redundancy'
rule. Simulations begin with the seeding of <code>Sseed</code> number of species,
chosen at random (with replacement) from either the species pool (if
provided in the <code>weight.file</code> when building the ecospace framework
using <code>create_ecospace</code>) or following the neutral-rule algorithm (if a
pool is not provided). Once seeded, the simulations proceed iteratively
(character-by-character, species-by-species) by following the appropriate
algorithm, as explained below, until terminated at <code>Smax</code>.
</p>
<p><strong>Redundancy rule algorithm:</strong> Pick one existing species at random and
create a new species using that species' characters as a template. A
character is modified (using a random multinomial draw from the ecospace
framework) according to the <code>strength</code> parameter. Default
<code>strength = 1</code> always implements the redundancy rule, whereas
<code>strength = 0</code> never implements it (essentially making the simulation
follow the <code>neutral</code> rule.) Because new character states can be
any allowed by the ecospace framework, there is the possibility of
obtaining redundancy greater than that specified by a strength parameter
less than 1 (if, for example, the new randomly chosen character states are
identical to those of the template species).
</p>
<p>Redundancy rules tend to produce ecospaces with discrete clusters of
functionally similar species. Additional details on the redundancy
simulation are provided in Novack-Gottshall (2016a,b), including
sensitivity to ecospace framework (functional trait space) structure,
recommendations for model selection, and basis in ecological and
evolutionary theory.
</p>


<h3>Value</h3>

<p>Returns a data frame with <code>Smax</code> rows (representing species) and
as many columns as specified by number of characters/states (functional
traits) in the ecospace framework. Columns will have the same data type
(numeric, factor, ordered numeric, or ordered factor) as specified in the
ecospace framework.
</p>


<h3>Note</h3>

<p>The function has been written to allow usage (using
<code>lapply</code> or some other list-apply function) in 'embarrassingly
parallel' implementations in a high-performance computing environment.
</p>


<h3>Author(s)</h3>

<p>Phil Novack-Gottshall <a href="mailto:pnovack-gottshall@ben.edu">pnovack-gottshall@ben.edu</a>
</p>


<h3>References</h3>

<p>Bush, A. and P.M. Novack-Gottshall. 2012. Modelling the
ecological-functional diversification of marine Metazoa on geological time
scales. <em>Biology Letters</em> 8: 151-155.
</p>
<p>Novack-Gottshall, P.M. 2016a. General models of ecological
diversification. I. Conceptual synthesis. <em>Paleobiology</em> 42: 185-208.
</p>
<p>Novack-Gottshall, P.M. 2016b. General models of ecological
diversification. II. Simulations and empirical applications.
<em>Paleobiology</em> 42: 209-239.
</p>


<h3>See Also</h3>

<p><code>create_ecospace</code>, <code>neutral</code>,
<code>partitioning</code>, <code>expansion</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create an ecospace framework with 15 3-state factor characters
# Can also accept following character types: "numeric", "ord.num", "ord.fac"
nchar &lt;- 15
ecospace &lt;- create_ecospace(nchar = nchar, char.state = rep(3, nchar),
  char.type = rep("factor", nchar))

# Single (default) sample produced by redundancy function (with strength = 1):
Sseed &lt;- 5
Smax &lt;- 50
x &lt;- redundancy(Sseed = Sseed, Smax = Smax, ecospace = ecospace)
head(x, 10)

# Plot results, showing order of assembly
# (Seed species in red, next 5 in black, remainder in gray)
# Notice the redundancy model produces an ecospace with discrete clusters of life habits
seq &lt;- seq(nchar)
types &lt;- sapply(seq, function(seq) ecospace[[seq]]$type)
if(any(types == "ord.fac" | types == "factor")) pc &lt;- prcomp(FD::gowdis(x)) else
  pc &lt;- prcomp(x)
plot(pc$x, type = "n", main = paste("Redundancy model,\n", Smax, "species"))
text(pc$x[,1], pc$x[,2], labels = seq(Smax), col = c(rep("red", Sseed), rep("black", 5),
  rep("slategray", (Smax - Sseed - 5))), pch = c(rep(19, Sseed), rep(21, (Smax - Sseed))),
  cex = .8)

# Change strength parameter so new species are 95% identical:
x &lt;- redundancy(Sseed = Sseed, Smax = Smax, ecospace = ecospace, strength = 0.95)
if(any(types == "ord.fac" | types == "factor")) pc &lt;- prcomp(FD::gowdis(x)) else
  pc &lt;- prcomp(x)
plot(pc$x, type = "n", main = paste("Redundancy model,\n", Smax, "species"))
text(pc$x[,1], pc$x[,2], labels = seq(Smax), col = c(rep("red", Sseed), rep("black", 5),
  rep("slategray", (Smax - Sseed - 5))), pch = c(rep(19, Sseed), rep(21, (Smax - Sseed))),
  cex = .8)

# Create 5 samples using multiple nreps and lapply (can be slow)
nreps &lt;- 1:5
samples &lt;- lapply(X = nreps, FUN = redundancy, Sseed = 5, Smax = 50, ecospace)
str(samples)

</code></pre>


</div>