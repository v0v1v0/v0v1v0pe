<div class="container">

<table style="width: 100%;"><tr>
<td>cumulants</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cumulants Class For Saddlepoint Approximations</h2>

<h3>Description</h3>

<p>A <code>cumulants</code> object contains all the cumulant functions that are needed to
calculate the saddlepoint approximation.
</p>
<p>The predefined functions
</p>

<ul>
<li> <p><code>gammaCumulants</code>,
</p>
</li>
<li> <p><code>gaussianCumulants</code> and
</p>
</li>
<li> <p><code>inverseGaussianCumulants</code>
</p>
</li>
</ul>
<p>compute the cumulant functions for the normal, gamma and inverse
gaussian distribution, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cumulants(saddlef, cgf = NULL, kappa2f = NULL, rho3f = NULL,
          rho4f = NULL, cgf.deriv = NULL,
          domain = interval(-Inf, Inf), ...)

gammaCumulants(shape, scale)
gaussianCumulants(mu, sigma2)
inverseGaussianCumulants(lambda, nu)

## S3 method for class 'cumulants'
check(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>saddlef</code></td>
<td>
<p>the saddlepoint function. Corresponds to the inverse of
the first derivative of the cumulant generating function (<abbr><span class="acronym">cgf</span></abbr>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cgf, cgf.deriv</code></td>
<td>
<p><code>cgf</code> is the cumulant generating
function. If <code>NULL</code> (the default),  it will be derived from
<code>cgf.deriv</code> (the generic derivative function of  the cgf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa2f</code></td>
<td>
<p>the variance function. If <code>NULL</code> (the default), it will be
derived from the function <code>cgf.deriv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho3f, rho4f</code></td>
<td>
<p>the 3rd and the 4th standardized cumulant function,
respectively. If <code>NULL</code> (the default), the functions will be
derived from <code>cgf.deriv</code> if supplied. If neither the cumulants
nor <code>cgf.deriv</code> are supplied, a warning will be 
displayed and a flag is set in the output. In this case, saddlepoint
approximations cannot make use of the correction term (see
<code>saddlepoint</code> for further details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>an object of type <code>interval</code> giving the domain of
the random variable. Will be needed to calculate the normalizing
factor. See <code>interval</code> for further
information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to the cumulant
functions, respectively function <code>check</code>.
See section ‘Details’ for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape, scale</code></td>
<td>
<p>shape and scale parameter for the gamma
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu, sigma2</code></td>
<td>
<p>mean and variance parameter for the normal
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda, nu</code></td>
<td>
<p>parameters for the inverse Gaussian distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object to be tested whether or not it meets the
formal requirements.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Basically, there are two ways to specify the cumulant functions using
<code>cumulants</code>. The first one is to specify each of the following
functions seperately:
</p>

<ul>
<li> <p><code>cgf</code>
</p>
</li>
<li> <p><code>kappa2f</code>
</p>
</li>
<li> <p><code>rho3f</code>
</p>
</li>
<li> <p><code>rho4f</code>
</p>
</li>
</ul>
<p>Since the functions may (and probably will) depend on some additional
parameters, it is necessary to include these parameters in the
respective argument lists. Thus, these additional parameters
must be passed to <code>cumulants</code> as <em>named</em> parameters as
well. To be more specific, if one of the above functions has an extra
parameter <code>z</code>, say, the particular value of <code>z</code> must be
passed to the function <code>cumulants</code> as well (see the example). In
any case, the first argument of the cumulant functions must be the
value at which the particular function will be evaluated. 
</p>
<p>The other way to specify the cumulant functions is to specify the
generic derivative of the <abbr><span class="acronym">cgf</span></abbr> <code>cgf.deriv</code>. Its first
argument  must be the order of the derivative and its second the value
at which it should be evaluated, followed by supplementary
arguments. <code>cgf.deriv</code> must be capable to return the
<abbr><span class="acronym">cgf</span></abbr> itself, which corresponds to the zeroth derivative.
</p>
<p>The function <code>cumulants</code> performs a basic check to test if all
needed additional parameters are supplied and displays a warning if
there are extra arguments in the cumulant functions, which are not
specified.
</p>
<p>The generic function <code>check</code> for the class <code>cumulants</code> tests if 
</p>

<ul>
<li>
<p> an object has the same fields as an <code>cumulants</code> object
and 
</p>
</li>
<li>
<p> the cumulant functions are properly vectorized, i.e. if they
return a vector whenever the argument is a vector.
</p>
</li>
</ul>
<h3>Value</h3>

<p><code>cumulants</code> returns an object of class <code>cumulants</code>
containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the cumulant function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.inv</code></td>
<td>
<p>the saddlepoint function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa2</code></td>
<td>
<p>the variance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho3, rho4</code></td>
<td>
<p>the 3rd and the 4th standardized cumulant functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>an interval giving the domain of the random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra.params</code></td>
<td>
<p>extra parameter passed to <code>cumulants</code>,
typically parameters of the underlying distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string equating either to “explicit” or
“implicit” indicating whether the cumulant functions were
passed explicitly or were derived from the generic derivative of
the <abbr><span class="acronym">cgf</span></abbr>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>logical. If <code>TRUE</code>, the 3rd and/or the 4th
cumulant function were not defined.</p>
</td>
</tr>
</table>
<p><code>gammaCumulants</code>, <code>gaussianCumulants</code> and
<code>inverseGaussianCumulants</code> return a <code>cumulants</code> object
representing the cumulant functions of the particular distribution.
</p>


<h3>Note</h3>

<p>If it happens that one of the cumulant functions <code>f</code>, say, does
not need any extra arguments while the others do, one have to define
these extra arguments for <code>f</code> nonetheless. The reason is that
<code>cumulants</code> passes any additional arguments to all defined
cumulant functions and it would end up in an error, if a function is
not capable of dealing with additional arguments.
</p>
<p>Hence, it is good practice to define all cumulant functions for the
same set of arguments, needed or not. An alternative is to add
<code>...</code> to the argument list in order to absorb any additional
arguments.
</p>
<p>The functions must be capable of handling vector input properly.
</p>
<p>Supplementary arguments <em>must not</em> be named similar to the arguments of
<code>cumulants</code> (especially any abbreviation must be avoided),
for the argument matching may match an argument (thought to be an extra
argument for one of the cumulant function) to an argument of
<code>cumulants</code>. The same problem may arise, if additional cumulant
function parameters are not named.
</p>


<h3>Author(s)</h3>

<p>Thorn Thaler</p>


<h3>References</h3>

<p>Reid, N. (1991).  Approximations and Asymptotics. <em>Statistical
Theory and Modelling</em>, London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>edgeworth</code>,
<code>saddlepoint</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Define cumulant functions for the normal distribution

saddlef &lt;- function(x, mu, sigma2) (x-mu)/sigma2
cgf &lt;- function(x, mu, sigma2) mu*x+sigma2*x^2/2

## Not run: 

# cgf, saddlef, kappa2, rho3 and rho4 must have the same argument lists! 
# Functions are _not_ properly vectorized!
kappa2 &lt;- function(x, sigma2) sigma2 
rho3 &lt;- function(x) 0                 
rho4 &lt;- function(x) 0

cc &lt;- cumulants(saddlef, cgf, kappa2, rho3, rho4, mu=0, sigma2=1)

check(cc) # FALSE


## End(Not run)

kappa2 &lt;- function(x, mu, sigma2)
    rep(sigma2, length(x)) 
rho3 &lt;- function(x, mu, sigma2)   # or function(x, ...)
    rep(0, length(x))        
rho4 &lt;- function(x, mu, sigma2)   # or function(x, ...)
    rep(0, length(x))        

cc &lt;- cumulants(saddlef, cgf, kappa2, rho3, rho4, mu=0, sigma2=1)

cc$K(1:2)       # 0.5 2
cc$kappa2(1:2)  # 1 1
cc$mu.inv(1:2)  # 1 2
cc$rho3(1:2)    # 0 0
cc$rho4(1:2)    # 0 0

check(cc) # TRUE

# The same using the generic derivative of the cgf

K.deriv &lt;- function(n, x, mu, sigma2) {
  if (n &lt;= 2) {
    switch(n + 1,
           return(mu * x + sigma2 * x ^ 2 / 2), # n == 0
           return(mu + sigma2 * x),             # n == 1
           return(rep(sigma2, length(x))))      # n == 2
  } else {
    return(rep(0, length(x)))                   # n &gt;= 3
  }
}

cc &lt;- cumulants(saddlef, cgf.deriv=K.deriv, mu=0, sigma2=1)

cc$K(1:2)       # 0.5 2
cc$kappa2(1:2)  # 1 1
cc$mu.inv(1:2)  # 1 2
cc$rho3(1:2)    # 0 0
cc$rho4(1:2)    # 0 0

check(cc) # TRUE

# The same using a predefined function
cc &lt;- gaussianCumulants(0, 1)

cc$K(1:2)       # 0.5 2
cc$kappa2(1:2)  # 1 1
cc$mu.inv(1:2)  # 1 2
cc$rho3(1:2)    # 0 0
cc$rho4(1:2)    # 0 0

check(cc) # TRUE

</code></pre>


</div>