<div class="container">

<table style="width: 100%;"><tr>
<td>epi.ssdxtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size to validate a diagnostic test in the absence of a gold standard
</h2>

<h3>Description</h3>

<p>Sample size to validate a diagnostic test in the absence of a gold standard. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">epi.ssdxtest(pi, se, sp, epsilon.api, epsilon.ase, epsilon.asp, epsilon.asesp, 
    r = 1, nfractional = FALSE, verbose = FALSE, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>vector of length two, the expected prevalence of the outcome of interest in the two populations (0 to 1), respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>vector of length two, the expected diagnostic sensitivity of the first and second test (0 to 1), respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>vector of length two, the expected diagnostic specificity of the first and second test (0 to 1), respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon.api</code></td>
<td>
<p>vector of length two, the absolute error for the prevalence of the outcome of interest in the first and second study populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon.ase</code></td>
<td>
<p>vector of length two, the absolute error for the sensitivity estimate of the first and second test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon.asp</code></td>
<td>
<p>vector of length two, the absolute error for the specificity estimate of the first and second test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon.asesp</code></td>
<td>
<p>vector of length two, the absolute error for the difference in the two sensitivity and specificity estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>scalar, the required number in the second population divided by the number in the first population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfractional</code></td>
<td>
<p>logical, return fractional sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, return sample size estimates for <code>se</code>, <code>sp</code>, and <code>pi</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>scalar, defining the level of confidence in the computed result.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hui and Walter (1980) describe an approach for estimating the sensitivity and specificity of a diagnostic test in the absence of a gold standard. Their method involves testing individuals from two populations with two conditionally independent diagnostic tests (neither of which is a gold standard). With such data, all six parameters of interest (two sensitivities, two specificities and two prevalences) can be estimated since there are six degrees of freedom available. The methodology in this function follows the sample size calculation methods described by Georgiadis et al. (2005).
</p>
<p>In their paper Georgiadis et al. (2005) parameterise the uncertainty in the prevalence, sensitivity and specificity estimates in terms of the width of the confidence interval. For consistency with the other sample size calculation functions in <span class="pkg">epiR</span> the amount of uncertainty in the prevalence, sensitivity and specificity is parameterised in absolute terms. Using this approach, if we set <code>se = c(0.80,0.90)</code> and <code>epsilon.ase = c(0.05,0.10)</code> the number of subjects to return an estimate of <code>se1</code> that is between <code>0.75</code> and <code>0.85</code> and <code>se2</code> that is between <code>0.80</code> and <code>1.0</code> will be returned.   
</p>


<h3>Value</h3>

<p>When <code>verbose = TRUE</code> a data frame listing the required sample size to estimate:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>the prevalence of the outcome of interest in population 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>the prevalence of the outcome of interest in population 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se1</code></td>
<td>
<p>the sensitivity of the first diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se2</code></td>
<td>
<p>the sensitivity of the second diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp1</code></td>
<td>
<p>the specificity of the first diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp2</code></td>
<td>
<p>the specificity of the second diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se1.se2</code></td>
<td>
<p>the difference in the sensitivities of the two diagnostic tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp1.sp2</code></td>
<td>
<p>the difference in the specificities of the two diagnostic tests.</p>
</td>
</tr>
</table>
<p>When <code>verbose = FALSE</code> a data frame listing the maximum of the sample size estimates listed when <code>verbose = TRUE</code>. 
</p>


<h3>References</h3>

<p>Georgiadis M, Johnson W, Gardner I (2005) Sample size determination for estimation of the accuracy of two conditionally independent tests in the absence of a gold standard. Preventive Veterinary Medicine 71, 1 - 10. DOI: 10.1016/j.prevetmed.2005.04.004.
</p>
<p>Hui SL, Walter SD (1980) Estimating the error rates of diagnostic tests. Biometrics 36, 167 - 171.
</p>
<p>Nielsen SS, Gronbaek C, Agger JF, Houe H (2002) Maximum-likelihood estimation of sensitivity and specificity of ELISAs and faecal culture for diagnosis of paratuberculosis. Preventive Veterinary Medicine 53, 191 - 204. DOI: 10.1016/s0167-5877(01)00280-x.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## EXAMPLE 1 (from Georgiadis et al. 2005, pp. 5):
## Nielsen et al. (2002) present data from the evaluation of a milk 
## antibody ELISA and faecal culture for the diagnosis of Mycobacterium avium 
## subsp. paratuberculosis infection in cattle. Because the ELISA detects 
## antibodies and culture is based on isolation of the bacterium in faeces 
## we can reasonably assume that the two tests are conditionally independent.

## How many cattle need to be sampled if we wanted to be 95% certain that
## our estimate of diagnostic sensitivity and specificity of the two tests 
## is within 0.05 of the true population value assuming the number sampled 
## in the second population divided by the number sampled in the first 
## population is 0.817? The prevalence of Mycobacterium avium subsp. 
## paratuberculosis is thought to be 0.093 and 0.204, respectively. Assume 
## the sensitivity of the the ELISA and faecal culture is 0.349 and 0.534, 
## respectively. Assume the specificity of the ELISA and faecal culture is 
## 0.995 and 0.894, respectively.

epi.ssdxtest(pi = c(0.093,0.204), se = c(0.349,0.534), sp = c(0.995,0.894), 
   epsilon.api = c(0.05,0.05), epsilon.ase = c(0.05,0.05), 
   epsilon.asp = c(0.05,0.05), epsilon.asesp = c(0.05,0.05), 
    r = 0.817, nfractional = FALSE, verbose = FALSE, conf.level = 0.95)

## A total of 63,887 cattle need to be sampled (35,161 from population 1 and
## 28,726 from population 2) to meet the requirements of the study.

</code></pre>


</div>