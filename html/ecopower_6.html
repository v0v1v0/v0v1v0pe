<div class="container">

<table style="width: 100%;"><tr>
<td>equivtest.cord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate equivalence testing</h2>

<h3>Description</h3>

<p><code>equivtest</code> takes in a copula model fitted to data and a matrix of effect sizes to execute a
a multivariate equivalence test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cord'
equivtest(
  object,
  coeffs,
  term = NULL,
  object0 = NULL,
  stats = NULL,
  test = "LR",
  nsim = 999,
  ncores = detectCores() - 1,
  show.time = TRUE
)

equivtest(
  object,
  coeffs,
  term = NULL,
  object0 = NULL,
  stats = NULL,
  test = "LR",
  nsim = 999,
  ncores = detectCores() - 1,
  show.time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>objects of class <code>cord</code>, typically the result of a call to <code>cord</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeffs</code></td>
<td>
<p>Coefficient matrix for a <code>manyglm</code> object that characterises the size of effects to be simulated.
See <code>effect_alt</code> for help in producing this matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p>Name of predictor of interest in quotes. Defaults to <code>NULL</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object0</code></td>
<td>
<p>object of class <code>cord</code> that specifies the null hypothesis. Defaults to <code>NULL</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>Statistics simulated under the null hypothesis. Optional, defaults to <code>NULL</code>. If not <code>NULL</code>, <code>equivtest</code> will not
simulate test statistics and use the <code>stats</code> specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Test statistic for computing p-value. Defaults to <code>"LR"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations for p-value estimate to be based upon. Defaults to <code>999</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores for parallel computing. Defaults to the total number of cores available on the
machine minus 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.time</code></td>
<td>
<p>Logical. Displays time elapsed. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>equivtest</code> takes a <code>cord</code> object and a coefficient matrix <code>coeffs</code> which specifies an effect size of
interest to perform an equivalence test.
</p>
<p>First, marginal parameters of the data are obtained from a <code>manyglm</code> object. Next, a copula model is fitted
using <code>cord</code> to estimate the factor analytic covariance structure of the data. The <code>cord</code> function uses two
factors by default. The p-value is then obtained by parsing the <code>cord</code> object into <code>extend</code>,
<code>nsim</code> times with an effect size specified by <code>coeffs</code>.
</p>
<p>The test statistics are simulated under the hypothesis that the effect size equals a certain threshold.
The p-value is computed as the proportion of times the simulated test statistics are less than the observed
statistic. Equivalence is declared if the estimated effect is less than the threshold.
</p>
<p><code>equivtest</code> can handle any user-defined null hypothesis, so only the fitted null model (<code>object0</code>) or the predictor of
interest (<code>term</code>) needs to be specified. If both <code>object0</code> and <code>term</code> are <code>NULL</code>, <code>equivtest</code> will
automatically set the predictor of interest as the last term in the fitted <code>object</code> model or drop the only term in the model
to obtain the intercept model.
</p>
<p>Simulations are computed in parallel using the "socket" approach, which uses all available cores minus 1 for clustering
to improve computation efficiency. Using 1 less than the number of available cores for your
machine (<code>detectCores()-1</code>) is recommended to leave one core available for other computer processes.
</p>


<h3>Value</h3>

<p>Equivalence test results, and;
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>p-value;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat_obs</code></td>
<td>
<p>observed statistic;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>simulated statistics.</p>
</td>
</tr>
</table>
<h3>Functions</h3>


<ul><li> <p><code>equivtest()</code>: Multivariate equivalence testing
</p>
</li></ul>
<h3>See Also</h3>

<p><code>effect_alt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(ecoCopula)
library(mvabund)
data(spider)
spiddat = mvabund(spider$abund)
X = data.frame(spider$x)

# Specify increasers and decreasers
increasers = c("Alopacce", "Arctlute", "Arctperi", "Pardnigr", "Pardpull")
decreasers = c("Alopcune", "Alopfabr", "Zoraspin")

# Equivalence test for continuous predictor at effect_size=1.5
fit.glm = manyglm(spiddat~bare.sand, family="negative.binomial", data=X)
threshold = effect_alt(fit.glm, effect_size=1.5,
       increasers, decreasers, term="bare.sand")
fit.cord = cord(fit.glm)
equivtest(fit.cord, coeffs=threshold, term="bare.sand", nsim=99, ncores=2)

# Equivalence test for categorical predictor with 4 levels at effect_size=1.5
X$Treatment = rep(c("A","B","C","D"),each=7)
fit_factors.glm = manyglm(spiddat~Treatment, family="negative.binomial", data=X)
threshold = effect_alt(fit_factors.glm, effect_size=1.5,
       increasers, decreasers, term="Treatment")
fit_factors.cord = cord(fit_factors.glm)
equivtest(fit_factors.cord, coeffs=threshold, term="Treatment", nsim=99, ncores=2)

# Specify object0
object0.glm = manyglm(spiddat~1, family="negative.binomial")
object0.cord = cord(object0.glm)
equivtest(fit_factors.cord, coeffs=threshold, object0=object0.cord, nsim=99, ncores=2)

</code></pre>


</div>