<div class="container">

<table style="width: 100%;"><tr>
<td>Emas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Epigenome-Wide Mediation Analysis Study</h2>

<h3>Description</h3>

<p>This function can perform the Epigenome-Wide Mediation Analysis Study (EMAS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Emas(
  data,
  M.matrix,
  id = "",
  x = "",
  y = "",
  x.cov = c(),
  y.cov = c(),
  m.cov = c(),
  mem.sav = FALSE,
  p.th = 0.1,
  ini.sims = 100,
  boot = FALSE,
  cl.n = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame included id, x, y, x.cov, y.cov, m.cov.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M.matrix</code></td>
<td>
<p>A matrix with the epigenome-wide CpG information, maybe a M-value matrix or a beta value matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Variable name of the id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Variable name of exposure(x) and outcome(y).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.cov</code></td>
<td>
<p>Variable names of covariates related to exposure(x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.cov</code></td>
<td>
<p>Variable names of covariates related to outcome(y).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.cov</code></td>
<td>
<p>Variable names of covariates related to mediator(m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mem.sav</code></td>
<td>
<p>A logical value. If 'TRUE', the memory required for the function will decrease, but the speed will also decrease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.th</code></td>
<td>
<p>Sobel indirect effects P-value threshold for subsequent nonparametric bootstrap or quasi-Bayesian approximation mediation analyses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini.sims</code></td>
<td>
<p>Initial number of Monte Carlo draws for nonparametric bootstrap or quasi-Bayesian approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>A logical value. If 'FALSE' a quasi-Bayesian approximation is used for confidence intervals; if 'TRUE' nonparametric bootstrap will be used. Default is 'FALSE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl.n</code></td>
<td>
<p>Number of cores used for parallel computing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>makeCluster</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can perform the Epigenome-Wide Mediation Analysis Study (EMAS) to explore the potential mediating CpG sites of exposure variables affecting outcome variables within the epigenome-wide.
</p>


<h3>Value</h3>

<p><code>Emas</code> returns a data.frame with the average mediation effects(AME), 
average direct effects(ADE), total effects, mediation proportion.
</p>

<ul>
<li>
<p>AMEEst: Point estimates for average mediation effects under the exposure conditions.
</p>
</li>
<li>
<p>AMElow95, AMEupp95: 95 percentage confidence intervals for average mediation effects.
</p>
</li>
<li>
<p>AME.P: Two-sided p-values for average mediation effects.
</p>
</li>
<li>
<p>ADEEst: Point estimates for average direct effect under the exposure conditions.
</p>
</li>
<li>
<p>ADElow95, ADEupp95: 95 percentage confidence intervals for average direct effects.
</p>
</li>
<li>
<p>ADE.P: Two-sided p-values for average direct effects.
</p>
</li>
<li>
<p>TotEst: Point estimate for total effect.
</p>
</li>
<li>
<p>Totlow95, Totupp95: 95 percentage confidence interval for total effect.
</p>
</li>
<li>
<p>Tot.P: Two-sided p-values for total effect.
</p>
</li>
<li>
<p>PropEst: The "proportions mediated", or the size of the average mediation effects relative to the total effect.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Xiuquan Nie, niexiuquan1995@foxmail.com
</p>


<h3>References</h3>

<p>Tingley, D., Yamamoto, T., Hirose, K., Imai, K. and Keele, L. (2014). mediation: R package for Causal Mediation Analysis.
<em>Journal of Statistical Software</em>, 59(5), 1â€“38. doi: <a href="https://doi.org/10.18637/jss.v059.i05">10.18637/jss.v059.i05</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data.m)
data(Mvalue)
E.result &lt;- Emas(data.m, Mvalue, id = "ID", x = "x", y = "y",
                 x.cov = c("age", "gender"),
                 y.cov = c("age", "gender"),
                 m.cov = c("age", "gender", "CD8T", "CD4T"), 
                 p.th = 0.1, ini.sims = 100, boot = FALSE, cl.n = 1)
</code></pre>


</div>