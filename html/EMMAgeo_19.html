<div class="container">

<table style="width: 100%;"><tr>
<td>robust.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract robust end-members</h2>

<h3>Description</h3>

<p>This function takes a list object with potential end-member loadings and 
extracts those with modes in specified limits to describe them by mean and
standard deviation and use these descriptions to propagate the uncertainties
to end-member scores.
</p>


<h3>Usage</h3>

<pre><code class="language-R">robust.EM(
  em,
  limits,
  classunits,
  amount,
  l,
  mc_n,
  type = "mean",
  qt = c(0.25, 0.75),
  cores = 1,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>em</code></td>
<td>
<p><code>List</code> of class <code>"EMMAgeo_empot"</code>, i.e. the outout of 
<code>model.em()</code> or <code>test.robustness()</code>, containing potential 
end-members, both in unscaled and rescaled version as well as further 
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p><code>Numeric</code> matrix with two columns, defining the class 
limits for the robust end-members to calculate. The first column defines the 
lower limits, the second column the upper limits. End-members are organised 
in rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classunits</code></td>
<td>
<p><code>Numeric</code> vector, optional class units 
(e.g. micrometers or phi-units) of the same length as columns of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amount</code></td>
<td>
<p><code>Numeric</code> matrix with two columns, defining the minimum 
and maximum amount of the modal class for each end-member.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p><code>Numeric</code> scalar, weight transformation limit for 
modelling the average end-member output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc_n</code></td>
<td>
<p><code>Numeric</code> scalar, number of Monte Carlo simulations to 
estimate end-member scores uncertainty. The default setting is ten times the 
product of number of end-members and number of weight transformation limits. 
The latter is inherited from <code>model.em()</code>. To disable modelling of 
scores uncertainty, set <code>mc_n = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>Character</code> scalar, type of oadings statistics. One out of 
<code>"mean"</code> and <code>"median"</code>. Default is <code>"mean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qt</code></td>
<td>
<p><code>Numeric</code> vector of length two, quantiles to describe 
end-member loadings. Default is <code>c(0.25, 0.75)</code> (i.e., the quartile 
range).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p><code>Numeric</code> scalar, number of CPU cores to be used for 
calculations. Only useful in multicore architectures. Default is <code>1</code> 
(single core).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>Logical</code> scalar, option for plot output. Default is 
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>EMMA</code> and <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is used to extract potential end-member loadings based on their
mode positions and, optionally the height of the mode class, and use them to 
infer mean and stanard deviation of all 
end-members that match the group criteria defined by <code>limits</code>. These 
information are then used to model the uncertainty of the corresponding
end-member scores. The function uses input from two preceeding approaches. 
In a compact protocol <code>model.em</code> delivers these data in a predefined 
way. In the extended protocol <code>test.robustness</code> does this.
</p>


<h3>Value</h3>

<p><code>List</code> with statistic descriptions of end-member loadings 
and scores.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze, Elisabeth Dietze
</p>


<h3>See Also</h3>

<p><code>robust.loadings</code>, <code>robust.scores</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

## load example data set
data(example_X)

## get weight transformation limit vector
l &lt;- get.l(X = X)

## get minimum and maximum number of end-members
q &lt;- get.q(X = X, l = l)

## get all potential model scenarios
EM_pot &lt;- model.EM(X = X, q = q, plot = TRUE)

## define end-member mode class limits
limits &lt;- cbind(c(61, 74, 95, 102), 
                c(64, 76, 100, 105))

## get robust end-members in the default way, with plot output
rem &lt;- robust.EM(em = EM_pot,
                 limits = limits,
                 plot = TRUE)
                    
## get robust end-members by only modelling uncertainty in loadings
robust_EM &lt;- robust.EM(em = EM_pot, 
                       limits = limits, 
                       plot = TRUE)


## End(Not run)
                    
</code></pre>


</div>