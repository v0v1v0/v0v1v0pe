<div class="container">

<table style="width: 100%;"><tr>
<td>kgaps_imt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Information matrix test under the <code class="reqn">K</code>-gaps model</h2>

<h3>Description</h3>

<p>Performs the information matrix test (IMT) of Suveges and Davison (2010) to
diagnose misspecification of the <code class="reqn">K</code>-gaps model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kgaps_imt(data, u, k = 1, inc_cens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or numeric matrix of raw data.  If <code>data</code>
is a matrix then the log-likelihood is constructed as the sum of
(independent) contributions from different columns. A common situation is
where each column relates to a different year.
</p>
<p>If <code>data</code> contains missing values then <code>split_by_NAs</code> is
used to divide the data into sequences of non-missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u, k</code></td>
<td>
<p>Numeric vectors.  <code>u</code> is a vector of extreme value
thresholds applied to data.  <code>k</code> is a vector of values of the run
parameter <code class="reqn">K</code>, as defined in Suveges and Davison (2010).
See <code>kgaps</code> for more details.
</p>
<p>Any values in <code>u</code> that are greater than all the observations in
<code>data</code> will be removed without a warning being given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_cens</code></td>
<td>
<p>A logical scalar indicating whether or not to include
contributions from censored inter-exceedance times, relating to the
first and last observations.  See Attalides (2015) for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">K</code>-gaps IMT is performed a over grid of all
combinations of threshold and <code class="reqn">K</code> in the vectors <code>u</code>
and <code>k</code>.  If the estimate of <code class="reqn">\theta</code> is 0 then the
IMT statistic, and its associated <code class="reqn">p</code>-value is <code>NA</code>.
</p>
<p>For details of the IMT see Suveges and Davison
(2010).  There are some typing errors on pages 18-19 that have been
corrected in producing the code: the penultimate term inside <code>{...}</code>
in the middle equation on page 18 should be <code class="reqn">(c_j(K))^2</code>, as should
the penultimate term in the first equation on page 19; the <code>{...}</code>
bracket should be squared in the 4th equation on page 19; the factor
<code class="reqn">n</code> should be <code class="reqn">N-1</code> in the final equation on page 19.
</p>


<h3>Value</h3>

<p>An object (a list) of class <code>c("kgaps_imt", "exdex")</code>
containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>imt </code></td>
<td>
<p>A <code>length(u)</code> by <code>length(k)</code> numeric matrix.
Column i contains, for <code class="reqn">K</code> = <code>k[i]</code>, the values of the
information matrix test statistic for the set of thresholds in
<code>u</code>.  The column names are the values in <code>k</code>.
The row names are the approximate empirical percentage quantile levels
of the thresholds in <code>u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>A <code>length(u)</code> by <code>length(k)</code> numeric matrix
containing the corresponding <code class="reqn">p</code>-values for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>A <code>length(u)</code> by <code>length(k)</code> numeric matrix
containing the corresponding estimates of <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u,k </code></td>
<td>
<p>The input <code>u</code> and <code>k</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Suveges, M. and Davison, A. C. (2010) Model
misspecification in peaks over threshold analysis, <em>Annals of
Applied Statistics</em>, <strong>4</strong>(1), 203-221.
<a href="https://doi.org/10.1214/09-AOAS292">doi:10.1214/09-AOAS292</a>
</p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
PhD thesis, University College London.
<a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code>kgaps</code> for maximum likelihood estimation of the
extremal index <code class="reqn">\theta</code> using the <code class="reqn">K</code>-gaps model.
</p>
<p><code>choose_uk</code> for graphical diagnostic to aid the choice
of the threshold <code class="reqn">u</code> and the run parameter <code class="reqn">K</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Newlyn sea surges

u &lt;- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- kgaps_imt(newlyn, u = u, k = 1:5)

### S&amp;P 500 index

u &lt;- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1))
imt &lt;- kgaps_imt(sp500, u = u, k = 1:5)

### Cheeseboro wind gusts (a matrix containing some NAs)

probs &lt;- c(seq(0.5, 0.98, by = 0.025), 0.99)
u &lt;- quantile(cheeseboro, probs = probs, na.rm = TRUE)
imt &lt;- kgaps_imt(cheeseboro, u = u, k = 1:5)
</code></pre>


</div>