<div class="container">

<table style="width: 100%;"><tr>
<td>epi2newick</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prints a transmission tree in Newick format.</h2>

<h3>Description</h3>

<p>Prints a simulated or inferred transmission tree in Newick format.</p>


<h3>Usage</h3>

<pre><code class="language-R">epi2newick(epi)

epi2newickmcmc(mcmcoutput, index = dim(mcmcoutput$transtree)[2])</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epi</code></td>
<td>
<p>a simulated epidemic, in the form of the
output produced by <code>SEIR.simulator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmcoutput</code></td>
<td>
<p>output from <code>epinet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a number indicating which of the MCMC
samples to plot. Defaults to the final sample in the chain.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>Converts the epinet epidemic format into a transmssion tree represented as a Newick string which is the standard tree format used in phylogenetics.  There are many packages available to analyse Newick format trees such as the ape package, IcyTree and FigTree. 
</p>


<h3>Value</h3>

<p>A character string representing the epidemic transmission tree in Newick format.  Note that this string contains control characters that can be removed by using <code>cat</code></p>


<h3>Author(s)</h3>

<p> David Welch <a href="mailto:david.welch@auckland.ac.nz">david.welch@auckland.ac.nz</a>,
Chris Groendyke <a href="mailto:cgroendyke@gmail.com">cgroendyke@gmail.com</a> </p>


<h3>References</h3>

<p>Rambaut A. 2014. FigTree v1.4. <a href="http://tree.bio.ed.ac.uk/software/figtree/">http://tree.bio.ed.ac.uk/software/figtree/</a>.
Vaughan T. 2015. IcyTree <a href="https://icytree.org">https://icytree.org</a>.
</p>


<h3>See Also</h3>

<p><code>epinet</code> for generating posterior samples of the parameters, 
<code>print.epinet</code> and <code>summary.epinet</code> for printing basic
summary information about an epinet object, <code>write.epinet</code> for
writing parameter and transmission tree posterior samples to file, and
<code>plot.epinet</code> for plotting the posterior samples of the transmission tree.</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate an epidemic through a network of 30
set.seed(3)
N &lt;- 30
# Build dyadic covariate matrix (X)
# Have a single covariate for overall edge density; this is the Erdos-Renyi model
nodecov &lt;- matrix(1:N, nrow = N)
dcm &lt;- BuildX(nodecov)
# Simulate network and then simulate epidemic over network
examplenet &lt;- SimulateDyadicLinearERGM(N, dyadiccovmat = dcm, eta = -1.8)
exampleepidemic &lt;- SEIR.simulator(examplenet, N = 30, 
    beta = 0.3, ki = 2, thetai = 5, latencydist="gamma")
cat(epi2newick(exampleepidemic))

## Not run: 
# Build covariates
set.seed(1)
N &lt;- 50
mycov &lt;- data.frame(id = 1:N, xpos = runif(N), ypos = runif(N))
dyadCov &lt;- BuildX(mycov,binaryCol = list(c(2, 3)),binaryFunc = c("euclidean"))
# Build network
eta &lt;- c(0, -7)
net &lt;- SimulateDyadicLinearERGM(N = N,dyadiccovmat = dyadCov,eta = eta)
# Simulate epidemic
epi &lt;- SEIR.simulator(M=net,N=N,beta=1,ki=3,thetai=7,ke=3,latencydist="gamma")
# Run MCMC routine on simulated epidemic
mcmcinput &lt;- MCMCcontrol(nsamp = 1000000, thinning = 100, etapropsd = c(1, 1))
priors &lt;- priorcontrol(bprior = c(0, 4), tiprior = c(1, 15), teprior = c(1, 15), 
	etaprior = c(0, 10, 0, 10), kiprior = c(1, 7), keprior = c(1, 7), priordists = "uniform")
out &lt;- epinet(~ xpos.ypos.L2Dist, epidata = epi, dyadiccovmat = dyadCov,
	mcmcinput = mcmcinput, priors = priors)
cat(epi2newickmcmc(out))
## End(Not run)
</code></pre>


</div>