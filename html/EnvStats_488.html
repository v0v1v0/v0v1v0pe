<div class="container">

<table style="width: 100%;"><tr>
<td>qqPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Quantile-Quantile (Q-Q) Plot
</h2>

<h3>Description</h3>

<p>Produces a quantile-quantile (Q-Q) plot, also called a probability plot.  
The <code>qqPlot</code> function is a modified version of the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> functions 
<code>qqnorm</code> and <code>qqplot</code>.  
The <span class="pkg">EnvStats</span> function <code>qqPlot</code> allows the user to specify a number of 
different distributions in addition to the normal distribution, and to optionally 
estimate the distribution parameters of the fitted distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  qqPlot(x, y = NULL, distribution = "norm", param.list = list(mean = 0, sd = 1), 
    estimate.params = plot.type == "Tukey Mean-Difference Q-Q", 
    est.arg.list = NULL, plot.type = "Q-Q", plot.pos.con = NULL, plot.it = TRUE, 
    equal.axes = qq.line.type == "0-1" || estimate.params, add.line = FALSE, 
    qq.line.type = "least squares", duplicate.points.method = "standard", 
    points.col = 1, line.col = 1, line.lwd = par("cex"), line.lty = 1, 
    digits = .Options$digits, ..., main = NULL, xlab = NULL, ylab = NULL, 
    xlim = NULL, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of observations.  When <code>y</code> is not supplied, <code>x</code> represents a sample 
from the hypothesized distribution specifed by <code>distribution</code>.  When <code>y</code> is supplied, 
the distribution of <code>x</code> is compared with the distribuiton of <code>y</code>.  
Missing (<code>NA</code>), undefined (<code>NaN</code>), and 
infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>optional numeric vector of observations (not necessarily the same lenght as <code>x</code>).  
Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
values are allowed but will be removed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>

<p>when <code>y</code> is not supplied, 
a character string denoting the distribution abbreviation.  The default value is 
<code>distribution="norm"</code>.  See the help file for <br><code>Distribution.df</code> for a 
list of possible distribution abbreviations.  This argument is ignored if <code>y</code> 
is supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.list</code></td>
<td>

<p>when <code>y</code> is not supplied, 
a list with values for the parameters of the distribution.  The default value is 
<code>param.list=list(mean=0, sd=1)</code>.  See the help file for <code>Distribution.df</code> 
for the names and possible values of the parameters associated with each distribution.  
This argument is ignored if <code>y</code> is supplied or <code>estimate.params=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate.params</code></td>
<td>

<p>when <code>y</code> is not supplied, 
a logical scalar indicating whether to compute quantiles based on estimating the 
distribution parameters (<code>estimate.params=TRUE</code>) or using the known 
distribution parameters specified in <code>param.list</code> <br>
(<code>estimate.params=FALSE</code>).  The default value of <code>estimate.params</code> 
is <code>FALSE</code> if <code>plot.type="Q-Q"</code> because the default configuration is a standard normal 
(mean=0, sd=1) Q-Q plot, which will yield roughly a straight line if the observations in 
<code>x</code> are from any normal distribution.  The default value of <code>estimate.params</code> 
is <code>TRUE</code> if <code>plot.type="Tukey Mean-Difference Q-Q"</code>.  The argument <br><code>estimate.params</code> 
is ignored if <code>y</code> is supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.arg.list</code></td>
<td>

<p>when <code>y</code> is not supplied and <code>estimate.params=TRUE</code>, 
a list whose components are optional arguments associated with the function used to estimate 
the parameters of the assumed distribution (see the help file 
Estimating Distribution Parameters).  
For example, all functions used to estimate distribution parameters have an optional argument 
called <code>method</code> that specifies the method to use to estimate the parameters.  
(See the help file for <code>Distribution.df</code> for a list of available estimation 
methods for each distribution.)  To override the default estimation method, supply the argument 
<code>est.arg.list</code> with a component called <code>method</code>; for example 
<code>est.arg.list=list(method="mle")</code>.  The default value is 
<code>est.arg.list=NULL</code> so that all default values for the estimating function are used.  
This argument is ignored if <code>estimate.params=FALSE</code> or <code>y</code> is supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>a character string denoting the kind of plot.  Possible values are <code>"Q-Q"</code> 
(Quantile-Quantile plot, the default) and <code>"Tukey Mean-Difference Q-Q"</code> 
(Tukey mean-difference Q-Q plot).  This argument may be abbreviated (e.g., 
<code>plot.type="T"</code> to indicate a Tukey mean-difference Q-Q plot).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pos.con</code></td>
<td>

<p>numeric scalar between 0 and 1 containing the value of the plotting position constant.  
The default value of <code>plot.pos.con</code> depends on whether the argument <code>y</code> is supplied, 
and if not the value of the argument <code>distribution</code>.  When <code>y</code> is supplied, the default 
value is <code>plot.pos.con=0.5</code>, corresponding to Hazen plotting positions.  When <code>y</code> is 
not supplied, for the normal, lognormal, three-parameter lognormal, zero-modified normal, and 
zero-modified lognormal distributions, the default value is <code>plot.pos.con=0.375</code>.  
For the Type I extreme value (Gumbel) distribution (<code>distribution="evd"</code>), 
the default value is <br><code>plot.pos.con=0.44</code>.  For all other distributions, the default value is <br><code>plot.pos.con=0.4</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>

<p>a logical scalar indicating whether to create a plot on the current graphics device.   
The default value is <code>plot.it=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.axes</code></td>
<td>

<p>a logical scalar indicating whether to use the same range on the <code class="reqn">x</code>- and <code class="reqn">y</code>-axes 
when <code>plot.type="Q-Q"</code>.  The default value is <code>TRUE</code> if <code>qq.line.type="0-1"</code> or 
<code>estimate.params=TRUE</code>, otherwise it is <code>FALSE</code>.  This argument is ignored if 
<code>plot.type="Tukey Mean-Difference Q-Q"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.line</code></td>
<td>

<p>a logical scalar indicating whether to add a line to the plot.  If <code>add.line=TRUE</code> and 
<code>plot.type="Q-Q"</code>, a line determined by the value of <code>qq.line.type</code> is added to the plot.  
If <code>add.line=TRUE</code> and <br><code>plot.type="Tukey Mean-Difference Q-Q"</code>, a horizontal line at 
<code class="reqn">y=0</code> is added to the plot.  The default value is <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qq.line.type</code></td>
<td>

<p>character string determining what kind of line to add to the Q-Q plot.  Possible values are 
<code>"least squares"</code> (the default), <code>"0-1"</code> and <code>"robust"</code>.  For the value 
<code>"least squares"</code>, a least squares line is fit and added.  For the value <code>"0-1"</code>, 
a line with intercept 0 and slope 1 is added.  For the value <code>"robust"</code>, a line is fit through 
the first and third quartiles of the <code>x</code> and <code>y</code> data.  This argument is ignored if 
<code>add.line=FALSE</code> or <code>plot.type="Tukey Mean-Difference Q-Q"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duplicate.points.method</code></td>
<td>

<p>a character string denoting how to plot points with duplicate <code class="reqn">(x,y)</code> values.  Possible values 
are <code>"standard"</code> (the default), <code>"jitter"</code>, and <code>"number"</code>.  For the value 
<code>"standard"</code>, a single plotting symbol is plotted (this is the default behavior of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>).  
For the value <code>"jitter"</code>, a separate plotting symbol is plotted for each duplicate point, where 
the plotting symbols cluster around the true value of <code class="reqn">x</code> and <code class="reqn">y</code>.  For the value 
<code>"number"</code>, a single number is plotted at <code class="reqn">(x,y)</code> that represents how many duplicate points 
are at that <code class="reqn">(x,y)</code> coordinate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the points in the plot.  
The default value is <code>points.col=1</code>.  See the entry for <code>col</code> in the help file for 
<code>par</code> for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>

<p>a numeric scalar or character string determining the color of the line in the plot.  
The default value is <code>points.col=1</code>.  See the entry for <code>col</code> in the help file for 
<code>par</code> for more information.  This argument is ignored if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lwd</code></td>
<td>

<p>a numeric scalar determining the width of the line in the plot.  The default value is 
<code>line.lwd=par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code>par</code> 
for more information.  This argument is ignored if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lty</code></td>
<td>

<p>a numeric scalar determining the line type of the line in the plot.  The default value is 
<code>line.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code>par</code> 
for more information.  This argument is ignored if <code>add.line=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>a scalar indicating how many significant digits to print for the distribution parameters.  
The default value is <code>digits=.Options$digits</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab, xlim, ylim, ...</code></td>
<td>

<p>additional graphical parameters (see <code>par</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>y</code> is not supplied, the vector <code>x</code> is assumed to be a sample from the probability 
distribution specified by the argument <code>distribution</code> (and <code>param.list</code> if 
<code>estimate.params=FALSE</code>).  When <code>plot.type="Q-Q"</code>, the quantiles of <code>x</code> are 
plotted on the <code class="reqn">y</code>-axis against the quantiles of the assumed distribution on the <code class="reqn">x</code>-axis.  
</p>
<p>If <code>y</code> is supplied and <code>plot.type="Q-Q"</code>, the empirical quantiles of <code>y</code> are 
plotted against the empirical quantiles of <code>x</code>.  
</p>
<p>When <code>plot.type="Tukey Mean-Difference Q-Q"</code>, the difference of the quantiles is plotted on 
the <code class="reqn">y</code>-axis against the mean of the quantiles on the <code class="reqn">x</code>-axis. 
</p>
<p><b>Special Distributions</b> <br>
When <code>y</code> is not supplied and the argument <code>distribution</code> specifies one of the 
following distributions, the function <code>qqPlot</code> behaves in the manner described below.
</p>

<dl>
<dt><code>"lnorm"</code></dt>
<dd>
<p><em>Lognormal Distribution</em>.  The log-transformed quantiles are 
plotted against quantiles from a Normal (Gaussian) distribution.</p>
</dd>
<dt><code>"lnormAlt"</code></dt>
<dd>
<p><em>Lognormal Distribution (alternative parameterization).</em>  
The untransformed quantiles are plotted against quantiles from a 
Lognormal distribution.</p>
</dd>
<dt><code>"lnorm3"</code></dt>
<dd>
<p><em>Three-Parameter Lognormal Distribution</em>.  The quantiles of 
<code>log(x-threshold)</code> are plotted against quantiles from a Normal (Gaussian) distribution.  
The value of <code>threshold</code> is either specified in the argument <code>param.list</code>, or, 
if <code>estimate.params=TRUE</code>, then it is estimated.</p>
</dd>
<dt><code>"zmnorm"</code></dt>
<dd>
<p><em>Zero-Modified Normal Distribution</em>.  The quantiles of the 
non-zero values (i.e., <code>x[x!=0]</code>) are plotted against quantiles from a Normal 
(Gaussian) distribution.</p>
</dd>
<dt><code>"zmlnorm"</code></dt>
<dd>
<p><em>Zero-Modified Lognormal Distribution</em>.  The quantiles of the 
log-transformed positive values (i.e., <code>log(x[x&gt;0])</code>) are plotted against quantiles 
from a Normal (Gaussian) distribution.</p>
</dd>
<dt><code>"zmlnormAlt"</code></dt>
<dd>
<p><em>Lognormal Distribution (alternative parameterization).</em>  
The quantiles of the untransformed positive values (i.e., <code>x[x&gt;0]</code>) are 
plotted against quantiles from a Lognormal distribution.</p>
</dd>
</dl>
<p><b>Explanation of Q-Q Plots</b> <br>
A <b><em>probability plot</em></b> or <b><em>quantile-quantile (Q-Q) plot</em></b> 
is a graphical display invented by Wilk and Gnanadesikan (1968) to compare a 
data set to a particular probability distribution or to compare it to another 
data set. The idea is that if two population distributions are exactly the same, 
then they have the same quantiles (percentiles), so a plot of the quantiles for 
the first distribution vs. the quantiles for the second distribution will fall 
on the 0-1 line (i.e., the straight line <code class="reqn">y = x</code> with intercept 0 and slope 1).  
If the two distributions have the same shape and spread but different locations, 
then the plot of the quantiles will fall on the line <code class="reqn">y = x + b</code> 
(parallel to the 0-1 line) where <code class="reqn">b</code> denotes the difference in locations.  
If the distributions have different locations and differ by a multiplicative 
constant <code class="reqn">m</code>, then the plot of the quantiles will fall on the line 
<code class="reqn">y = mx + b</code> (D'Agostino, 1986a, p. 25; Helsel and Hirsch, 1986, p. 42).  
Various kinds of differences between distributions will yield various kinds of 
deviations from a straight line.
<br></p>
<p><em>Comparing Observations to a Hypothesized Distribution</em> <br>
Let <code class="reqn">\underline{x} = x_1, x_2, \ldots, x_n</code> denote the observations 
in a random sample of size <code class="reqn">n</code> from some unknown distribution with 
cumulative distribution function <code class="reqn">F()</code>, and let 
<code class="reqn">x_{(1)}, x_{(2)}, \ldots, x_{(n)}</code> denote the ordered observations.   
Depending on the particular formula used for the empirical cdf 
(see <code>ecdfPlot</code>), the <code class="reqn">i</code>'th order statistic is an 
estimate of the <code class="reqn">i/(n+1)</code>'th, <code class="reqn">(i-0.5)/n</code>'th, etc., quantile.  
For the moment, assume the <code class="reqn">i</code>'th order statistic is an estimate of the 
<code class="reqn">i/(n+1)</code>'th quantile, that is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}[x_{(i)}] = \hat{p}_i = \frac{i}{n+1} \;\;\;\;\;\; (1)</code>
</p>

<p>so
</p>
<p style="text-align: center;"><code class="reqn">x_{(i)} \approx F^{-1}(\hat{p}_i) \;\;\;\;\;\; (2)</code>
</p>

<p>If we knew the form of the true cdf <code class="reqn">F</code>, then the plot of 
<code class="reqn">x_{(i)}</code> vs. <code class="reqn">F^{-1}(\hat{p}_i)</code> would form approximately 
a straight line based on Equation (2) above.  A probability plot is a plot of
<code class="reqn">x_{(i)}</code> vs. <code class="reqn">F_0^{-1}(\hat{p}_i)</code>, where <code class="reqn">F_0</code> denotes the 
cdf associated with the hypothesized distribution.  The probability plot 
should fall roughly on the line <code class="reqn">y=x</code> if <code class="reqn">F=F_0</code>.  If <code class="reqn">F</code> and <code class="reqn">F_0</code> 
merely differ by a shift in location and scale, that is, if 
<code class="reqn">F[(x - \mu) / \sigma] = F_0(x)</code>, then the plot should fall roughly on the 
line <code class="reqn">y = \sigma x + \mu</code>.
</p>
<p>The quantity <code class="reqn">\hat{p}_i = i/(n+1)</code> in Equation (1) above is called the 
<b><em>plotting position</em></b> for the probability plot.  This particular 
formula for the plotting position is appealing because it can be shown that 
for any continuous distribution
</p>
<p style="text-align: center;"><code class="reqn">E\{F[x_{(i)}]\} = \frac{i}{n+1} \;\;\;\;\;\; (3)</code>
</p>

<p>(Nelson, 1982, pp. 299-300; Stedinger et al., 1993).  That is, the <code class="reqn">i</code>'th 
plotting position defined as in Equation (1) is the expected value of the true 
cdf evaluated at the <code class="reqn">i</code>'th order statistic.  Many authors and practitioners, 
however, prefer to use a plotting position that satisfies:
</p>
<p style="text-align: center;"><code class="reqn">F^{-1}(\hat{p}_i) = E[x_{(i)}] \;\;\;\;\;\; (4)</code>
</p>

<p>or one that satisfies
</p>
<p style="text-align: center;"><code class="reqn">F^{-1}(\hat{p}_i) = M[x_{(i)}] = F^{-1}\{M[u_{(i)}]\} \;\;\;\;\;\; (5)</code>
</p>

<p>where <code class="reqn">M[x_{(i)}]</code> denotes the median of the distribution of the <code class="reqn">i</code>'th 
order statistic, and <code class="reqn">u_{(i)}</code> denotes the <code class="reqn">i</code>'th order statistic in a 
random sample of <code class="reqn">n</code> uniform (0,1) random variates.
</p>
<p>The plotting positions in Equation (4) are often approximated since the expected 
value of the <code class="reqn">i</code>'th order statistic is often difficult and time-consuming 
to compute.  Note that these plotting positions will differ for different 
distributions.
</p>
<p>The plotting positions in Equation (5) were recommended by Filliben (1975) because 
they require computing or approximating only the medians of 
uniform (0,1) order statistics, no matter what the form 
of the assumed cdf <code class="reqn">F_0</code>.  Also, the median may be preferred as a measure of 
central tendency because the distributions of most order statistics are skewed.
</p>
<p>Most plotting positions can be written as:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_i = \frac{i - a}{n - 2a + 1} \;\;\;\;\;\; (6)</code>
</p>

<p>where <code class="reqn">0 \le a \le 1</code> (D'Agostino, 1986a, p.25; Stedinger et al., 1993).  
The quantity <code class="reqn">a</code> is sometimes called the “plotting position constant”, and 
is determined by the argument <code>plot.pos.con</code> in the function <code>qqPlot</code>.  
The table below, adapted from Stedinger et al. (1993), displays commonly used 
plotting positions based on equation (6) for several distributions.
</p>

<table>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;"> <b>Distribution</b> </td>
<td style="text-align: left;">                     </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;"> <b>Often Used</b>   </td>
<td style="text-align: left;">                     </td>
</tr>
<tr>
<td style="text-align: left;">
  <b>Name</b> </td>
<td style="text-align: left;"> <b><em>a</em></b> </td>
<td style="text-align: left;"> <b>With</b>         </td>
<td style="text-align: left;"> <b>References</b>   </td>
</tr>
<tr>
<td style="text-align: left;">
  Weibull     </td>
<td style="text-align: left;"> 0               </td>
<td style="text-align: left;"> Weibull,            </td>
<td style="text-align: left;"> Weibull (1939),     </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;"> Uniform             </td>
<td style="text-align: left;"> Stedinger et al. (1993) </td>
</tr>
<tr>
<td style="text-align: left;">
  Median      </td>
<td style="text-align: left;"> 0.3175          </td>
<td style="text-align: left;"> Several             </td>
<td style="text-align: left;"> Filliben (1975), </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;">                     </td>
<td style="text-align: left;"> Vogel (1986) </td>
</tr>
<tr>
<td style="text-align: left;">
  Blom        </td>
<td style="text-align: left;"> 0.375           </td>
<td style="text-align: left;"> Normal              </td>
<td style="text-align: left;"> Blom (1958), </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;"> and Others          </td>
<td style="text-align: left;"> Looney and Gulledge (1985) </td>
</tr>
<tr>
<td style="text-align: left;">
  Cunnane     </td>
<td style="text-align: left;"> 0.4             </td>
<td style="text-align: left;"> Several             </td>
<td style="text-align: left;"> Cunnane (1978), </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;">                     </td>
<td style="text-align: left;"> Chowdhury et al. (1991) </td>
</tr>
<tr>
<td style="text-align: left;">
  Gringorten  </td>
<td style="text-align: left;"> 0.44            </td>
<td style="text-align: left;"> Gumbel              </td>
<td style="text-align: left;"> Gringorton (1963), </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;">                     </td>
<td style="text-align: left;"> Vogel (1986) </td>
</tr>
<tr>
<td style="text-align: left;">
  Hazen       </td>
<td style="text-align: left;"> 0.5             </td>
<td style="text-align: left;"> Several             </td>
<td style="text-align: left;"> Hazen (1914), </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;">                     </td>
<td style="text-align: left;"> Chambers et al. (1983), </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">                 </td>
<td style="text-align: left;">                     </td>
<td style="text-align: left;"> Cleveland (1993) 
  </td>
</tr>
</table>
<p>For moderate and large sample sizes, there is very little difference in 
visual appearance of the Q-Q plot for different choices of plotting positions.
<br></p>
<p><em>Comparing Two Data Sets</em> <br>
Let <code class="reqn">\underline{x} = x_1, x_2, \ldots, x_n</code> denote the observations 
in a random sample of size <code class="reqn">n</code> from some unknown distribution with 
cumulative distribution function <code class="reqn">F()</code>, and let 
<code class="reqn">x_{(1)}, x_{(2)}, \ldots, x_{(n)}</code> denote the ordered observations.  Similarly, 
let <code class="reqn">\underline{y} = y_1, y_2, \ldots, y_m</code> denote the observations 
in a random sample of size <code class="reqn">m</code> from some unknown distribution with 
cumulative distribution function <code class="reqn">G()</code>, and let 
<code class="reqn">y_{(1)}, y_{(2)}, \ldots, y_{(m)}</code> denote the ordered observations.
Suppose we are interested in investigating whether the shape of the distribution 
with cdf <code class="reqn">F</code> is the same as the shape of the distribution with cdf <code class="reqn">G</code> 
(e.g., <code class="reqn">F</code> and <code class="reqn">G</code> may both be normal distributions but differ in mean 
and standard deviation).
</p>
<p>When <code class="reqn">n = m</code>, we can visually explore this question by plotting 
<code class="reqn">y_{(i)}</code> vs. <code class="reqn">x_{(i)}</code>, for <code class="reqn">i = 1, 2, \ldots, n</code>.  
The values in <code class="reqn">\underline{y}</code> are spread out in a certain way depending 
on the true distribution:  they may be more or less symmetric about some value 
(the population mean or median) or they may be skewed to the right or left; 
they may be concentrated close to the mean or median (platykurtic) or there may 
be several observations “far away” from the mean or median on either side 
(leptokurtic).  Similarly, the values in <code class="reqn">\underline{x}</code> are spread out in a 
certain way.  If the values in <code class="reqn">\underline{x}</code> and <code class="reqn">\underline{y}</code> are 
spread out in the same way, then the plot of <code class="reqn">y_{(i)}</code> vs. <code class="reqn">x_{(i)}</code> 
will be approximately a straight line.  If the cdf <code class="reqn">F</code> is exactly the same 
as the cdf <code class="reqn">G</code>, then the plot of <code class="reqn">y_{(i)}</code> vs. <code class="reqn">x_{(i)}</code> will fall 
roughly on the straight line <code class="reqn">y = x</code>.  If <code class="reqn">F</code> and <code class="reqn">G</code> differ by a 
shift in location and scale, that is, if <code class="reqn">F[(x-\mu)/\sigma] = G(x)</code>, then 
the plot will fall roughly on the line <code class="reqn">y = \sigma x + \mu</code>.
</p>
<p>When <code class="reqn">n &gt; m</code>, a slight adjustment has to be made to produce the plot. Let 
<code class="reqn">\hat{p}_1, \hat{p}_2, \ldots, \hat{p}_m</code> denote the plotting positions 
corresponding to the <code class="reqn">m</code> empirical quantiles for the <code class="reqn">y</code>'s and let
<code class="reqn">\hat{p}^*_1, \hat{p}^*_2, \ldots, \hat{p}^*_n</code> denote the plotting positions 
corresponding the <code class="reqn">n</code> empirical quantiles for the <code class="reqn">x</code>'s. Then we plot
<code class="reqn">y_{(j)}</code> vs. <code class="reqn">x^*_{(j)}</code> for <code class="reqn">j = 1, 2, \ldots, m</code> where
</p>
<p style="text-align: center;"><code class="reqn">x^*_{(j)} = (1 - r) x_{(i)} + r x_{(i+1)} \;\;\;\;\;\; (7)</code>
</p>

<p style="text-align: center;"><code class="reqn">r = \frac{\hat{p}_j - \hat{p}^*_i}{\hat{p}^*_{i+1} - \hat{p}^*_i} \;\;\;\;\;\; (8)</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{p}^*_i \le \hat{p}_j \le \hat{p}^*_{i+1} \;\;\;\;\;\; (9)</code>
</p>

<p>That is, the values for the <code class="reqn">x^*_{(j)}</code>'s are determined by linear interpolation 
based on the values of the plotting positions for <code class="reqn">\underline{x}</code> and 
<code class="reqn">\underline{y}</code>.  
</p>
<p>A similar adjustment is made when <code class="reqn">n &lt; m</code>.
</p>
<p>Note that the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>qqplot</code> uses a different method than 
the one in Equation (7) above; it uses linear interpolation based on 
<code>1:n</code> and <code>m</code> by calling the <code>approx</code> function.
</p>


<h3>Value</h3>

<p><code>qqPlot</code> returns a list with components <code>x</code> and <code>y</code>, giving the <code class="reqn">(x,y)</code> 
coordinates of the points that have been or would have been plotted.  There are four cases to 
consider:
</p>
<p>1. The argument <code>y</code> is not supplied and <code>plot.type="Q-Q"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the quantiles from the theoretical distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the observed quantiles (order statistics) based on the data in the argument <code>x</code>.</p>
</td>
</tr>
</table>
<p><br></p>
<p>2. The argument <code>y</code> is not supplied and <code>plot.type="Tukey Mean-Difference Q-Q"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the averages of the observed and theoretical quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the differences between the observed quantiles (order statistics) and the theoretical quantiles.</p>
</td>
</tr>
</table>
<p><br></p>
<p>3. The argument <code>y</code> is supplied and <code>plot.type="Q-Q"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the observed quantiles based on the data in the argument <code>x</code>.  
Note that these are adjusted quantiles if the number of observations in the 
argument <code>x</code> is greater then the number of observations in the argument <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the observed quantiles based on the data in the argument <code>y</code>.  
Note that these are adjusted quantiles if the number of observations in the 
argument <code>y</code> is greater then the number of observations in the argument <code>x</code>.</p>
</td>
</tr>
</table>
<p><br></p>
<p>4. The argument <code>y</code> is supplied and <code>plot.type="Tukey Mean-Difference Q-Q"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the averages of the quantiles based on the argument <code>x</code> and the quantiles based 
on the argument <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the differences between the quantiles based on the argument <code>x</code> and the quantiles based 
on the argument <code>y</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>A <em>quantile-quantile (Q-Q) plot</em>, also called a <em>probability plot</em>, is a plot of the observed 
order statistics from a random sample (the empirical quantiles) against their (estimated) 
mean or median values based on an assumed distribution, or against the empirical quantiles 
of another set of data (Wilk and Gnanadesikan, 1968).  Q-Q plots are used to assess whether 
data come from a particular distribution, or whether two datasets have the same parent 
distribution.  If the distributions have the same shape (but not necessarily the same 
location or scale parameters), then the plot will fall roughly on a straight line.  If the 
distributions are exactly the same, then the plot will fall roughly on the straight line <code class="reqn">y=x</code>.
</p>
<p>A <em>Tukey mean-difference Q-Q plot</em>, also called an <em>m-d plot</em>, is a modification of a 
Q-Q plot. Rather than plotting observed quantiles vs. theoretical quantiles or observed 
<code class="reqn">y</code>-quantiles vs. observed <code class="reqn">x</code>-quantiles, a Tukey mean-difference Q-Q plot plots 
the difference between the quantiles on the <code class="reqn">y</code>-axis vs. the average of the quantiles on 
the <code class="reqn">x</code>-axis (Cleveland, 1993, pp.22-23).  If the two sets of quantiles come from the same 
parent distribution, then the points in this plot should fall roughly along the horizontal line 
<code class="reqn">y=0</code>.  If one set of quantiles come from the same distribution with a shift in median, then 
the points in this plot should fall along a horizontal line above or below the line <code class="reqn">y=0</code>.  
A Tukey mean-difference Q-Q plot enhances our perception of how the points in the Q-Q plot deviate 
from a straight line, because it is easier to judge deviations from a horizontal line than from a 
line with a non-zero slope.
</p>
<p>In a Q-Q plot, the extreme points have more variability than points toward the center.  A U-shaped 
Q-Q plot indicates that the underlying distribution for the observations on the <code class="reqn">y</code>-axis is 
skewed to the right relative to the underlying distribution for the observations on the <code class="reqn">x</code>-axis.  
An upside-down-U-shaped Q-Q plot indicates the <code class="reqn">y</code>-axis distribution is skewed left relative to 
the <code class="reqn">x</code>-axis distribution.  An S-shaped Q-Q plot indicates the <code class="reqn">y</code>-axis distribution has 
shorter tails than the <code class="reqn">x</code>-axis distribution.  Conversely, a plot that is bent down on the 
left and bent up on the right indicates that the <code class="reqn">y</code>-axis distribution has longer tails than 
the <code class="reqn">x</code>-axis distribution.
</p>


<h3>Author(s)</h3>

<p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)
</p>


<h3>References</h3>

<p>Chambers, J.M., W.S. Cleveland, B. Kleiner, and P.A. Tukey. (1983). 
<em>Graphical Methods for Data Analysis</em>. Duxbury Press, Boston, MA, pp.11-16.
</p>
<p>Cleveland, W.S. (1993). <em>Visualizing Data</em>. Hobart Press, Summit, New Jersey, 360pp.
</p>
<p>D'Agostino, R.B. (1986a). Graphical Analysis. 
In: D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>. 
Marcel Dekker, New York, Chapter 2, pp.7-62.
</p>


<h3>See Also</h3>

<p><code>ppoints</code>, <code>ecdfPlot</code>, <code>Distribution.df</code>, 
<code>qqPlotGestalt</code>, <code>qqPlotCensored</code>, <code>qqnorm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # The guidance document USEPA (1994b, pp. 6.22--6.25) 
  # contains measures of 1,2,3,4-Tetrachlorobenzene (TcCB) 
  # concentrations (in parts per billion) from soil samples 
  # at a Reference area and a Cleanup area.  These data are strored 
  # in the data frame EPA.94b.tccb.df.  
  #
  # Create an Q-Q plot for the reference area data first assuming a 
  # normal distribution, then a lognormal distribution, then a 
  # gamma distribution.
  
  # Assume a normal distribution
  #-----------------------------

  dev.new()
  with(EPA.94b.tccb.df, qqPlot(TcCB[Area == "Reference"]))

  dev.new()
  with(EPA.94b.tccb.df, qqPlot(TcCB[Area == "Reference"], add.line = TRUE))

  dev.new()
  with(EPA.94b.tccb.df, qqPlot(TcCB[Area == "Reference"], 
    plot.type = "Tukey", add.line = TRUE))


  # The Q-Q plot based on assuming a normal distribution shows a U-shape,
  # indicating the Reference area TcCB data are skewed to the right
  # compared to a normal distribuiton.

  # Assume a lognormal distribution
  #--------------------------------

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "lnorm", 
      digits = 2, points.col = "blue", add.line = TRUE))

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "lnorm", 
      digits = 2, plot.type = "Tukey", points.col = "blue", 
      add.line = TRUE))

  # Alternative parameterization

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "lnormAlt", 
      estimate.params = TRUE, digits = 2, points.col = "blue", 
      add.line = TRUE))

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "lnormAlt", 
      digits = 2, plot.type = "Tukey", points.col = "blue", 
      add.line = TRUE))


  # The lognormal distribution appears to be an adequate fit.
  # Now look at a Q-Q plot assuming a gamma distribution.
  #----------------------------------------------------------

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "gamma", 
      estimate.params = TRUE, digits = 2, points.col = "blue", 
      add.line = TRUE))

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "gamma", 
      digits = 2, plot.type = "Tukey", points.col = "blue", 
      add.line = TRUE))

  # Alternative Parameterization

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "gammaAlt", 
      estimate.params = TRUE, digits = 2, points.col = "blue", 
      add.line = TRUE))

  dev.new()
  with(EPA.94b.tccb.df, 
    qqPlot(TcCB[Area == "Reference"], dist = "gammaAlt", 
      digits = 2, plot.type = "Tukey", points.col = "blue", 
      add.line = TRUE))

  #-------------------------------------------------------------------------------------

  # Generate 20 observations from a gamma distribution with parameters 
  # shape=2 and scale=2, then create a normal (Gaussian) Q-Q plot for these data. 
  # (Note: the call to set.seed simply allows you to reproduce this example.)

  set.seed(357) 
  dat &lt;- rgamma(20, shape=2, scale=2) 
  dev.new()
  qqPlot(dat, add.line = TRUE)

  # Now assume a gamma distribution and estimate the parameters
  #------------------------------------------------------------

  dev.new()
  qqPlot(dat, dist = "gamma", estimate.params = TRUE, add.line = TRUE)

  # Clean up
  #---------
  rm(dat)
  graphics.off()
</code></pre>


</div>