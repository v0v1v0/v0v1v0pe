<div class="container">

<table style="width: 100%;"><tr>
<td>fitBMAgamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
BMA wind speed model fit to a training set
</h2>

<h3>Description</h3>

<p>Fits a Bayesian Modeling Averaging mixture of gammas.
Intended for wind speed forecasts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitBMAgamma( ensembleData, control = controlBMAgamma(), exchangeable = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and 
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included. This is the training set for the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAgamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters within each group.
If supplied, this argument will override any specification of 
exchangeability in <code>ensembleData</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a BMA model to a training data set. <br>
It is called by <code>ensembleBMAgamma</code>, which can produce a sequence
of fits over a larger precipitation data set.  <br>
Methods available for the output of <code>fitBMA</code> include:
<code>cdf</code>, <code>quantileForecast</code>, and 
<code>modelParameters</code>. 
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>biasCoefs</code></td>
<td>

<p>The fitted coefficients in the model for the mean of nonzero observations
for each member of the ensemble (used for bias correction).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varCoefs</code></td>
<td>

<p>The fitted coefficients for the model for the variance of nonzero 
observations (these are the same for all members of the ensemble).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the gamma components for each ensemble member.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIter</code></td>
<td>

<p>The number of EM iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>A scalar value giving to the power by which the data was transformed
to fit the models for the  point mass at 0 and the bias model. 
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25â€“35, 2010</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code>ensembleData</code>, 
<code>controlBMAgamma</code>, 
<code>ensembleBMAgamma</code>,
<code>cdf</code>,
<code>quantileForecast</code>,
<code>modelParameters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("MAXWSP10","obs", sep = ".")
  ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")

  winsTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                startupSpeed = 1,
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  winsTrain &lt;- trainingData( winsTestData, trainingDays = 30,
                             date = "2008010100")

## End(Not run)

# for quick run only; use more training days for forecasting
  winsTrain &lt;- trainingData( winsTestData, trainingDays = 10,
                             date = "2008010100")

  winsTrainFit &lt;- fitBMAgamma( winsTrain)

## equivalent to
##    winsTrainFit &lt;- fitBMA( winsTrain, model = "gamma")
</code></pre>


</div>