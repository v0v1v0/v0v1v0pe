<div class="container">

<table style="width: 100%;"><tr>
<td>isqrtfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inverse square-root of a matrix based on its factor decomposition.</h2>

<h3>Description</h3>

<p>This function is not supposed to be called directly by users. It is needed in functions <code>erpfatest</code> and <code>erpFtest</code> implementing factor-adjusted testing methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">isqrtfa(Psi, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>m-vector of specific variances, where m is the number of rows and columns of the matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>mxq matrix of loadings, where q is the number of factors</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If Sigma has the q-factor decomposition Sigma=diag(Psi)+BB', then the function returns a matrix Omega such that Sigma^-1 = Omega Omega'. Equivalently,
Omega' Sigma Omega = I.</p>


<h3>Value</h3>

<p>The mxm matrix Omega (see the details Section).
</p>


<h3>Author(s)</h3>

<p>David Causeur, IRMAR, UMR 6625 CNRS, Agrocampus Ouest, Rennes, France.
</p>


<h3>References</h3>

<p>Woodbury, M.A. (1949) The Stability of Out-Input Matrices. Chicago, Ill., 5 pp</p>


<h3>See Also</h3>

<p><code>emfa</code>, <code>ifa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(impulsivity)
erpdta = as.matrix(impulsivity[,5:505])   # erpdta contains the whole set of ERP curves     
fa = emfa(erpdta,nbf=20)          # 20-factor modelling of the ERP curves in erpdta
Sfa = diag(fa$Psi)+tcrossprod(fa$B) # Factorial estimation of the variance 
iSfa = ifa(fa$Psi,fa$B)$iS        # Matrix inversion    
isqrtSfa = isqrtfa(fa$Psi,fa$B)   # Inverse square-root of Sfa
max(abs(tcrossprod(isqrtSfa)-iSfa)) # Checks that isqrtSfa x t(isqrtSfa) = iSfa
</code></pre>


</div>