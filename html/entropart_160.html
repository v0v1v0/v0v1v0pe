<div class="container">

<table style="width: 100%;"><tr>
<td>PhyloEntropy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Phylogenetic Entropy of a community
</h2>

<h3>Description</h3>

<p>Calculates the phylogenetic entropy of order <code class="reqn">q</code> of a probability vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, ...)
bcPhyloEntropy(Ns, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  SampleCoverage = NULL, CheckArguments = TRUE)
## S3 method for class 'ProbaVector'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, 
  ..., CheckArguments = TRUE, Ps = NULL)
## S3 method for class 'AbdVector'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'integer'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  ..., CheckArguments = TRUE, Ns = NULL)
## S3 method for class 'numeric'
PhyloEntropy(NorP, q = 1, Tree, Normalize = TRUE, Correction = "Best", 
  ..., CheckArguments = TRUE, Ps = NULL, Ns = NULL) 
is.PhyloEntropy(x)
## S3 method for class 'PhyloEntropy'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ps</code></td>
<td>

<p>A probability vector, summing to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ns</code></td>
<td>

<p>A numeric vector containing species abundances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NorP</code></td>
<td>

<p>A numeric vector, an integer vector, an abundance vector (<code>AbdVector</code>) or a probability vector (<code>ProbaVector</code>). Contains either abundances or probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A number: the order of entropy. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tree</code></td>
<td>

<p>An object of class <code>hclust</code>, "phylo" (see <code>read.tree</code>), <code>phylog</code> or <code>PPtree</code>. The tree must be ultrametric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Normalize</code></td>
<td>

<p>If <code>TRUE</code> (default), the <code>Total</code> entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice).<br>
If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correction</code></td>
<td>

<p>A string containing one of the possible corrections supported by <code>Tsallis</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampleCoverage</code></td>
<td>

<p>The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object to be tested or plotted
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>PhyloEntropy</code> object to be summarized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to the generic methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The phylogenetic entropy is its generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p>Calculation relies on <code>Tsallis</code> and <code>PhyloApply</code>.
</p>
<p>Intervals separate two cuts in a tree: no node is found at heights contained in an interval.
</p>
<p>Bias correction requires the number of individuals to estimate sample <code>Coverage</code>. Use <code>bcPhyloEntropy</code> and choose the <code>Correction</code>.
</p>
<p>The functions are designed to be used as simply as possible. <code>PhyloEntropy</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloEntropy</code> is called. Explicit calls to <code>bcPhyloEntropy</code> (with bias correction) or to <code>PhyloEntropy.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<p>The size of a metacommunity (see <code>MetaCommunity</code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. Then, classical bias-correction methods do not apply. Providing the <code>SampleCoverage</code> argument allows applying the <code>"ChaoShen"</code> and <code>"Grassberger"</code> corrections to estimate quite well the entropy. <code>DivPart</code> and <code>GammaEntropy</code> functions use this tweak.
</p>


<h3>Value</h3>

<p>An object of class <code>PhyloEntropy</code> is a list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Distribution</code></td>
<td>
<p>The distribution used to calculate entropy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Function</code></td>
<td>
<p>The function used to calculate entropy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tree</code></td>
<td>
<p>The functional or phylogenetic tree used to calculate entropy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Normalized</code></td>
<td>
<p>Logical. Indicates whether phyloentropy is normalized or proportional to the height of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>
<p>The type of entropy ("alpha", "beta" or "gamma").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Order</code></td>
<td>
<p>The order of entropy <code class="reqn">q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cuts</code></td>
<td>
<p>A named vector containing values of neutral entropy along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Total</code></td>
<td>
<p>A value equal the total entropy multiplied by the tree height if <code>Normalize</code> is FALSE.</p>
</td>
</tr>
</table>
<p><code>is.PhyloEntropy</code> returns <code>TRUE</code> if the object is of class <code>PhyloEntropy</code>.
</p>
<p><code>summary.PhyloEntropy</code> returns a summary of the object's value.
</p>
<p><code>PhyloEntropy</code> objects can be plotted by <code>plot.PhyloValue</code> because <code>PhyloEntropy</code> objects are also of class <code>PhyloValue</code>.
</p>


<h3>Note</h3>

<p>The tree must contain all species of the probability vector. If it contains extra species, computation time will just be increased.
</p>


<h3>References</h3>

<p>Marcon, E., Herault, B. (2015). Decomposing  Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p>Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>


<h3>See Also</h3>

<p><code>Tsallis</code>, <code>PhyloDiversity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Calculate the phylogenetic Shannon entropy of the plot
summary(PhyloEntropy(Ps, 1, Paracou618.Taxonomy) -&gt; e)
plot(e)

# Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Calculate the phylogenetic Shannon entropy of the plot
summary(bcPhyloEntropy(Ns, 1, Paracou618.Taxonomy, Correction = "Best") -&gt; e)
plot(e)
</code></pre>


</div>